{"segments": [{"Time_Start": 0.0, "Time_End": 6.96, "Text": " working on random other projects and we do this on our side neither of us do"}, {"Time_Start": 6.96, "Time_End": 11.64, "Text": " this for work he does use it work I don't really we both work in the security"}, {"Time_Start": 11.64, "Time_End": 16.86, "Text": " industry I'm also a student and this is about exploit frameworks in general and about"}, {"Time_Start": 16.86, "Time_End": 21.48, "Text": " new exploit technology that we and other people have been working on along the road"}, {"Time_Start": 21.48, "Time_End": 29.6, "Text": " of metisploit so all right"}, {"Time_Start": 30.0, "Time_End": 33.0, "Text": " Okay, thank you."}, {"Time_Start": 33.0, "Time_End": 37.0, "Text": " Thank you."}, {"Time_Start": 60.0, "Time_End": 64.0, "Text": " digital defense, video risk assessment services, yada yada yada, yada, yada, spam."}, {"Time_Start": 64.0, "Time_End": 69.0, "Text": " What this talks about is exploit frameworks in general, the metasplate framework in particular,"}, {"Time_Start": 69.0, "Time_End": 73.0, "Text": " and kind of showing you that all the technologies for hacking like in the movies, like, you know,"}, {"Time_Start": 73.0, "Time_End": 77.0, "Text": " watching the net or watching, like, you know, hackers or sneakers is already there."}, {"Time_Start": 77.0, "Time_End": 79.0, "Text": " Now there's the whole flying through the cities with the Gibson's and stuff."}, {"Time_Start": 79.0, "Time_End": 82.0, "Text": " But you can do it if you want to, but why waste a CPU on it?"}, {"Time_Start": 82.0, "Time_End": 85.0, "Text": " I mean, so some of things we're going to show off today will be things like the..."}, {"Time_Start": 85.0, "Time_End": 86.0, "Text": " Do I? Cool."}, {"Time_Start": 86.0, "Time_End": 87.0, "Text": " Cool."}, {"Time_Start": 87.0, "Time_End": 89.98, "Text": " Somethings we're going to show off today will be things like the VNC shell code, where it doesn't"}, {"Time_Start": 90.0, "Time_End": 95.0, "Text": " touch the disk at all, but it gets us a remote and interactive desktop with the system we're attacking, things like that."}, {"Time_Start": 95.0, "Time_End": 96.0, "Text": " So..."}, {"Time_Start": 96.0, "Time_End": 102.0, "Text": " Yeah, we'll start with an injection, and then we know this is two hours, a lot of people have other things that they may want to do."}, {"Time_Start": 102.0, "Time_End": 106.0, "Text": " So we sort of split it into, like, two different sections."}, {"Time_Start": 106.0, "Time_End": 110.0, "Text": " So we go through the first thing and do some demos, and then go more in-depth and do some more demos."}, {"Time_Start": 110.0, "Time_End": 113.0, "Text": " So we'll start with some background information on exploit framework,"}, {"Time_Start": 113.0, "Time_End": 119.0, "Text": " not necessarily specific to Metafloit, but just what's out there now and what the current state of things are."}, {"Time_Start": 120.0, "Time_End": 123.0, "Text": " So, what is an exploit framework?"}, {"Time_Start": 123.0, "Time_End": 125.0, "Text": " It's an interface for launching exploits."}, {"Time_Start": 125.0, "Time_End": 127.0, "Text": " There's a lot of reasons to use one."}, {"Time_Start": 127.0, "Time_End": 129.0, "Text": " It allows you to have standardized exploit modules."}, {"Time_Start": 129.0, "Time_End": 132.0, "Text": " It allows you to have a suite of reliable shell code."}, {"Time_Start": 132.0, "Time_End": 136.0, "Text": " At least in our framework, you can specify a different shell code,"}, {"Time_Start": 136.0, "Time_End": 140.0, "Text": " that's not necessarily the same for all other frameworks."}, {"Time_Start": 140.0, "Time_End": 144.0, "Text": " You know, library of common routines, that includes a lot of per features."}, {"Time_Start": 144.0, "Time_End": 148.0, "Text": " A lot of this is really good from the exploit developers' point of view."}, {"Time_Start": 148.0, "Time_End": 149.0, "Text": " A lot of code reuse."}, {"Time_Start": 149.0, "Time_End": 155.0, "Text": " A lot of code reuse, a lot of things that you don't have to do that you would have to do in a standalone C program."}, {"Time_Start": 155.0, "Time_End": 161.0, "Text": " And also a lot of it shows in using it, having a standardized interface to use other different things"}, {"Time_Start": 161.0, "Time_End": 166.0, "Text": " and having a lot of advanced features that you wouldn't have in a normal standalone exploit."}, {"Time_Start": 166.0, "Time_End": 170.0, "Text": " So why are exploit frameworks needed?"}, {"Time_Start": 170.0, "Time_End": 176.0, "Text": " Well, as anyone's aware who's been going to Packet Storm or other public security websites to get exports for the last few years,"}, {"Time_Start": 176.0, "Time_End": 178.0, "Text": " just about everything you download is a piece of crap."}, {"Time_Start": 178.0, "Time_End": 179.0, "Text": " I mean, honestly, I think you know,"}, {"Time_Start": 179.0, "Time_End": 183.0, "Text": " that you're able to find publicly as far as exploit code, 90% of the stuff just sucks."}, {"Time_Start": 183.0, "Time_End": 188.0, "Text": " Even worse, if we start looking at this code, you know, half the code is borrowed, but it's copying pages to someplace else."}, {"Time_Start": 188.0, "Time_End": 195.0, "Text": " You know, how many times you've seen the same T-s steel shell handler being copied from the same decomm export to decom exploit to serve you after a row?"}, {"Time_Start": 195.0, "Time_End": 196.0, "Text": " All in a row."}, {"Time_Start": 196.0, "Time_End": 197.0, "Text": " I mean, it's kind of gross out there."}, {"Time_Start": 197.0, "Time_End": 198.0, "Text": " No one can really code."}, {"Time_Start": 198.0, "Time_End": 203.0, "Text": " The people who are letting exploits aren't really programmers, so people who know just enough about security and programming to get the code done and working."}, {"Time_Start": 203.0, "Time_End": 206.0, "Text": " And that's kind of what we're running against."}, {"Time_Start": 206.0, "Time_End": 209.0, "Text": " If you're doing a penthouse and you need to, you know, reliably export a system,"}, {"Time_Start": 209.0, "Time_End": 213.0, "Text": " and say that's what you're using is hard-code to a blind shell or reverse shell,"}, {"Time_Start": 213.0, "Time_End": 215.0, "Text": " and you need to use the opposite type of payload,"}, {"Time_Start": 215.0, "Time_End": 219.0, "Text": " well, you're going to have to have to have someone else's ugly assee trying to get it all working."}, {"Time_Start": 219.0, "Time_End": 223.0, "Text": " So the goal of the framework is to be able to provide you a consistent interface for exploiting a system"}, {"Time_Start": 223.0, "Time_End": 226.0, "Text": " in a way that you don't really have to worry about what the payloads are, who wrote it,"}, {"Time_Start": 226.0, "Time_End": 231.0, "Text": " or, you know, whether you need to, you know, convert 1-32 socket calls to running socket calls"}, {"Time_Start": 231.0, "Time_End": 233.0, "Text": " or remove WSA startup sequences."}, {"Time_Start": 233.0, "Time_End": 234.0, "Text": " So..."}, {"Time_Start": 234.0, "Time_End": 238.0, "Text": " One thing that's point about this is, for the last point, nobody posts code for old bugs."}, {"Time_Start": 238.0, "Time_End": 239.0, "Text": " This is one of the last point."}, {"Time_Start": 239.0, "Time_End": 242.0, "Text": " something a lot of penthouseers will admit to that it's very important."}, {"Time_Start": 242.0, "Time_End": 245.0, "Text": " There's a lot of bugs that may be three years old,"}, {"Time_Start": 245.0, "Time_End": 248.0, "Text": " but there's still a lot of expertable machines running it."}, {"Time_Start": 248.0, "Time_End": 251.0, "Text": " And the thing is that people aren't now going and revising old exploits"}, {"Time_Start": 251.0, "Time_End": 253.0, "Text": " with new techniques and new technologies."}, {"Time_Start": 253.0, "Time_End": 255.0, "Text": " They're not retrofitting old code."}, {"Time_Start": 255.0, "Time_End": 259.0, "Text": " So something we've done has gone through and we've written a lot of important exploits."}, {"Time_Start": 259.0, "Time_End": 261.0, "Text": " And also just the fact that it's in the framework itself,"}, {"Time_Start": 261.0, "Time_End": 263.0, "Text": " when we come up with new technologies,"}, {"Time_Start": 263.0, "Time_End": 266.0, "Text": " we can use that then in older exports."}, {"Time_Start": 269.0, "Time_End": 272.0, "Text": " Right now, there's two public export projects."}, {"Time_Start": 272.0, "Time_End": 275.0, "Text": " There's a few public export projects."}, {"Time_Start": 275.0, "Time_End": 276.0, "Text": " There's two commercial projects."}, {"Time_Start": 276.0, "Time_End": 281.0, "Text": " These projects are, you know, Coors, impact product, and immunity use canvas product."}, {"Time_Start": 281.0, "Time_End": 286.0, "Text": " For those, we're not aware, in about 2001, 2002,"}, {"Time_Start": 286.0, "Time_End": 289.0, "Text": " company called CoreSD released the automated Pentest Toolkit,"}, {"Time_Start": 289.0, "Time_End": 292.0, "Text": " essentially there's a giant GUI interface that had tons of exports in it"}, {"Time_Start": 292.0, "Time_End": 294.0, "Text": " where you can just drag and drop root shells."}, {"Time_Start": 294.0, "Time_End": 297.0, "Text": " Now that's great and all, and it's nice, it worked pretty well,"}, {"Time_Start": 297.0, "Time_End": 298.0, "Text": " they've got some really sharp guys working on it,"}, {"Time_Start": 298.0, "Time_End": 299.0, "Text": " but they've got some really sharp guys working on it."}, {"Time_Start": 299.0, "Time_End": 301.0, "Text": " $15,000 a license."}, {"Time_Start": 301.0, "Time_End": 305.0, "Text": " And I don't know about you guys, but I can't afford $15,000 for an export, so."}, {"Time_Start": 305.0, "Time_End": 310.0, "Text": " The other product is Canvas by Immunity, and we keep mispliedies to Acupolities Today by television"}, {"Time_Start": 310.0, "Time_End": 313.0, "Text": " in the audience, but his companies called Immunity."}, {"Time_Start": 313.0, "Time_End": 315.0, "Text": " His product is kind of a cut-down version of impact."}, {"Time_Start": 315.0, "Time_End": 319.0, "Text": " It has a different focus in that it provides, you know, lots of exploits and a lot of actually"}, {"Time_Start": 319.0, "Time_End": 323.0, "Text": " undisclosed or unpublished exports, and it actually runs on Linux and 1-32 at once."}, {"Time_Start": 323.0, "Time_End": 327.0, "Text": " And finally, you have the Metisplite framework, which is, you know, our project, open source,"}, {"Time_Start": 327.0, "Time_End": 328.0, "Text": " and it's not really meant to be directly competitive."}, {"Time_Start": 328.0, "Time_End": 331.0, "Text": " to be directly competitive with these commercial projects, but there's different goals."}, {"Time_Start": 331.0, "Time_End": 334.0, "Text": " And we're going to kind of talk about some of the goals in the next section."}, {"Time_Start": 334.0, "Time_End": 338.0, "Text": " Yeah, we're going to kind of go with core impact and new use canvas,"}, {"Time_Start": 338.0, "Time_End": 340.0, "Text": " a little detail in the next level slides."}, {"Time_Start": 340.0, "Time_End": 342.0, "Text": " So, first core impact."}, {"Time_Start": 342.0, "Time_End": 344.0, "Text": " It was the first real exploit framework."}, {"Time_Start": 344.0, "Time_End": 347.0, "Text": " I think it came around 2000 or maybe a little bit later."}, {"Time_Start": 347.0, "Time_End": 348.0, "Text": " And they were the first to do a lot of things."}, {"Time_Start": 348.0, "Time_End": 351.0, "Text": " They were the first to have a functioning system called proxy,"}, {"Time_Start": 351.0, "Time_End": 355.0, "Text": " and a lot of the, kind of set the standard for a lot of the technologies."}, {"Time_Start": 355.0, "Time_End": 357.0, "Text": " They're priceier than other solutions, but they were the first to do a lot of things."}, {"Time_Start": 357.0, "Time_End": 360.3, "Text": " other solutions, but they're extremely complete."}, {"Time_Start": 360.3, "Time_End": 366.9, "Text": " The tool is written in Python as C++, and the tool itself only runs on 1-32, but you can"}, {"Time_Start": 366.9, "Time_End": 372.14, "Text": " obviously own and pivot through non-Winds boxes."}, {"Time_Start": 372.14, "Time_End": 373.24, "Text": " You can pivot through own boxes."}, {"Time_Start": 373.24, "Time_End": 376.56, "Text": " Basically, the way that works is a FU compromised machine."}, {"Time_Start": 376.56, "Time_End": 380.64, "Text": " You can launch airtacks through impact through that machine, so if you own a box on the perimeter,"}, {"Time_Start": 380.64, "Time_End": 384.34, "Text": " you could then use that box and start owning things on the internal network, et cetera."}, {"Time_Start": 384.34, "Time_End": 386.98, "Text": " And they also have a syscall proxing parallel system."}, {"Time_Start": 387.0, "Time_End": 391.0, "Text": " which is how they implement pivoting, a lot of other things like upload, download file,"}, {"Time_Start": 391.0, "Time_End": 396.0, "Text": " a lot of other advanced payload techniques or payload features."}, {"Time_Start": 396.0, "Time_End": 403.0, "Text": " Unity Canvas. This is written by Dave Idle, and I think he started running it in early 2002."}, {"Time_Start": 403.0, "Time_End": 405.0, "Text": " It might have been before that and just wasn't aware of it."}, {"Time_Start": 405.0, "Time_End": 408.0, "Text": " It was the second commercial framework out there when everyone saw his product were like,"}, {"Time_Start": 408.0, "Time_End": 412.0, "Text": " wow, look, he's competing in its core impact, and kind of curious how it's going to happen and how it's going to work out."}, {"Time_Start": 412.0, "Time_End": 414.0, "Text": " And it ends up that they went along pretty well."}, {"Time_Start": 414.0, "Time_End": 416.98, "Text": " Like, no one tends to see which of his exploits, so you often find exploits that are in."}, {"Time_Start": 417.0, "Time_End": 419.0, "Text": " canvas than on anything else."}, {"Time_Start": 419.0, "Time_End": 422.0, "Text": " And that's kind of what Dave and the rest of the community team kind of rides themselves on."}, {"Time_Start": 422.0, "Time_End": 425.0, "Text": " It supports limited Cisco proxing."}, {"Time_Start": 425.0, "Time_End": 428.0, "Text": " It uses, it kind of, it has one payload."}, {"Time_Start": 428.0, "Time_End": 433.0, "Text": " Instead of having a reverse shell or a bind shell, it uses all reverse shells, as far as I know,"}, {"Time_Start": 433.0, "Time_End": 436.0, "Text": " or it can use bindstocks for other things as well."}, {"Time_Start": 436.0, "Time_End": 439.0, "Text": " And the actual payload is kind of a multi-connect payload."}, {"Time_Start": 439.0, "Time_End": 443.0, "Text": " You can upload files, download files, manage the system, you know, create new connections,"}, {"Time_Start": 443.0, "Time_End": 446.0, "Text": " do other things through that one payload."}, {"Time_Start": 446.0, "Time_End": 447.0, "Text": " It may actually be able to be able to put."}, {"Time_Start": 447.0, "Time_End": 450.0, "Text": " pivot in near future where you can actually compromise one host, then export another host,"}, {"Time_Start": 450.0, "Time_End": 453.0, "Text": " you know, directly afterwards like Spoon was talking about a second ago."}, {"Time_Start": 453.0, "Time_End": 454.0, "Text": " It's less extensive than impact."}, {"Time_Start": 454.0, "Time_End": 456.0, "Text": " I think it has somewhere between 70 to 80 modules,"}, {"Time_Start": 456.0, "Time_End": 460.0, "Text": " as opposed to core impacts, like, you know, around 300 or so."}, {"Time_Start": 460.0, "Time_End": 463.0, "Text": " And it runs for about $1,000 a pop instead of $15,000."}, {"Time_Start": 463.0, "Time_End": 467.0, "Text": " So if you're a small shop, you need a commercial exploit framework, it's not a bad thing to use."}, {"Time_Start": 467.0, "Time_End": 475.0, "Text": " So the current capabilities, we actually did this talk at Black Hat too,"}, {"Time_Start": 475.0, "Time_End": 476.0, "Text": " and I've been quoted a lot in new."}, {"Time_Start": 476.0, "Time_End": 481.0, "Text": " quoted a lot in news articles from saying point-click route, so we're going to repeat it."}, {"Time_Start": 481.0, "Time_End": 486.0, "Text": " So the current capability is we've really gotten down exploitation to point-click and root."}, {"Time_Start": 486.0, "Time_End": 490.0, "Text": " You can put it through the boxes after you own them, watching attacks is from the box,"}, {"Time_Start": 490.0, "Time_End": 491.0, "Text": " you just compromised."}, {"Time_Start": 491.0, "Time_End": 494.0, "Text": " Automatic payload and coding, avoiding things like that character."}, {"Time_Start": 494.0, "Time_End": 496.0, "Text": " So it's something more in the background that you don't see."}, {"Time_Start": 496.0, "Time_End": 498.0, "Text": " But it's definitely important."}, {"Time_Start": 498.0, "Time_End": 501.0, "Text": " And we also have dynamic shell code creation systems."}, {"Time_Start": 501.0, "Time_End": 505.0, "Text": " Canvas has MoStaff, which is Davitell's Python-based compilation."}, {"Time_Start": 505.0, "Time_End": 508.0, "Text": " compilations for compiler and assembler."}, {"Time_Start": 508.0, "Time_End": 514.0, "Text": " And impact has inline egg, which is, I guess,"}, {"Time_Start": 514.0, "Time_End": 516.0, "Text": " they have a greater system called egg."}, {"Time_Start": 516.0, "Time_End": 518.0, "Text": " But that's what they do."}, {"Time_Start": 518.0, "Time_End": 521.0, "Text": " Similar dynamic shell code creation."}, {"Time_Start": 521.0, "Time_End": 522.0, "Text": " Cool."}, {"Time_Start": 522.0, "Time_End": 524.0, "Text": " Excuse me."}, {"Time_Start": 524.0, "Time_End": 526.0, "Text": " The next section is the Metispoly framework."}, {"Time_Start": 526.0, "Time_End": 527.0, "Text": " I give you an idea what the project's about,"}, {"Time_Start": 527.0, "Time_End": 530.0, "Text": " where it's going, kind of what it can do right now."}, {"Time_Start": 530.0, "Time_End": 532.0, "Text": " We've got the project is stable enough right now."}, {"Time_Start": 532.0, "Time_End": 534.0, "Text": " Of course, people will be using it in their organizations"}, {"Time_Start": 534.0, "Time_End": 535.0, "Text": " to, you know, verify vulnerabilities."}, {"Time_Start": 535.0, "Time_End": 537.0, "Text": " assessments to do pen test work, things like that."}, {"Time_Start": 537.0, "Time_End": 541.0, "Text": " We can actually be using professionally for about a year or so now, so it's definitely ready."}, {"Time_Start": 541.0, "Time_End": 546.0, "Text": " Okay, so just a brief introduction."}, {"Time_Start": 546.0, "Time_End": 548.0, "Text": " It's an open source expert framework."}, {"Time_Start": 548.0, "Time_End": 551.0, "Text": " I believe it's the, pretty much the only one out there."}, {"Time_Start": 551.0, "Time_End": 556.0, "Text": " There's some other projects that sort of concentrated on subsets of things that are"}, {"Time_Start": 556.0, "Time_End": 559.0, "Text": " like payload systems, etc."}, {"Time_Start": 559.0, "Time_End": 563.0, "Text": " But this is the only open source total exploit framework."}, {"Time_Start": 563.0, "Time_End": 564.0, "Text": " We also think of it more."}, {"Time_Start": 564.0, "Time_End": 568.0, "Text": " of it more as an exploit development environment."}, {"Time_Start": 568.0, "Time_End": 572.0, "Text": " All of us are security researchers really do a lot of development work."}, {"Time_Start": 572.0, "Time_End": 575.0, "Text": " So we're really using it more for that than actually for going out,"}, {"Time_Start": 575.0, "Time_End": 577.0, "Text": " and using it for pen tests."}, {"Time_Start": 577.0, "Time_End": 581.0, "Text": " So it really, I would consider it more of an expert development platform"}, {"Time_Start": 581.0, "Time_End": 584.0, "Text": " than Core Impact or Canvas, which are sold as products,"}, {"Time_Start": 584.0, "Time_End": 587.0, "Text": " not really as environments for you to be writing things in."}, {"Time_Start": 587.0, "Time_End": 590.0, "Text": " Although you can, but that's not really the main goal."}, {"Time_Start": 590.0, "Time_End": 593.0, "Text": " It's written in Pearl, which is a very"}, {"Time_Start": 593.0, "Time_End": 596.0, "Text": " which is a choice we've made and have gotten flacked for,"}, {"Time_Start": 596.0, "Time_End": 600.0, "Text": " but we stand behind it strongly and it's been working out really well for us."}, {"Time_Start": 600.0, "Time_End": 602.0, "Text": " It runs on most modern platforms."}, {"Time_Start": 602.0, "Time_End": 606.0, "Text": " Right now we can run it on H-Pox and Sawara straight out of the box."}, {"Time_Start": 606.0, "Time_End": 609.0, "Text": " Runs on Windows 32 under the Cigrant environment."}, {"Time_Start": 609.0, "Time_End": 612.0, "Text": " Runs on Linux and BSD and pretty much everything else."}, {"Time_Start": 612.0, "Time_End": 614.0, "Text": " HD has it running on its source."}, {"Time_Start": 614.0, "Time_End": 616.0, "Text": " So, I mean, it's really pretty portable if you look at it."}, {"Time_Start": 616.0, "Time_End": 619.0, "Text": " It's been able to walk into an office building with a device"}, {"Time_Start": 619.0, "Time_End": 622.0, "Text": " about the size of your hand and have a list of about 30-40X boys"}, {"Time_Start": 622.0, "Time_End": 623.0, "Text": " you can start owning boxes as well."}, {"Time_Start": 623.0, "Time_End": 628.0, "Text": " nice little Wi-Fi card, so it really reduces the amount of time it takes to, you know,"}, {"Time_Start": 628.0, "Time_End": 630.0, "Text": " go into an un-owned environment and really start rolling with it."}, {"Time_Start": 630.0, "Time_End": 633.0, "Text": " And even though we don't really support pivoting with the project right now,"}, {"Time_Start": 633.0, "Time_End": 636.0, "Text": " you can literally just copy the framework over another host and start running it"}, {"Time_Start": 636.0, "Time_End": 640.0, "Text": " because we do have 132 installers, and it does run about every modern UX platform."}, {"Time_Start": 640.0, "Time_End": 644.0, "Text": " And we're mostly focused on improving technology,"}, {"Time_Start": 644.0, "Time_End": 648.0, "Text": " not so much things that may be as important from the user's perspective,"}, {"Time_Start": 648.0, "Time_End": 652.0, "Text": " but a lot of the backend things like shell coding, coders,"}, {"Time_Start": 652.0, "Time_End": 653.0, "Text": " and just really trying to improve some of the technology."}, {"Time_Start": 653.0, "Time_End": 658.5, "Text": " some of the things that are more important to us as developers than maybe someone as a user."}, {"Time_Start": 658.5, "Time_End": 662.0, "Text": " But that doesn't mean that it's not good for you using too."}, {"Time_Start": 662.0, "Time_End": 664.0, "Text": " So..."}, {"Time_Start": 664.0, "Time_End": 668.0, "Text": " The project history, about a year ago, I started working on a network game with the front line."}, {"Time_Start": 668.0, "Time_End": 672.0, "Text": " There was this cheesy little endcurs client that looked kind of like the BDS game Overkill."}, {"Time_Start": 672.0, "Time_End": 675.0, "Text": " I don't know who else has played that, but it's kind of a fun little game."}, {"Time_Start": 675.0, "Time_End": 679.0, "Text": " You have little text screen, you kind of use arrow keys and we'll go around, go north, go west, that kind of stuff."}, {"Time_Start": 679.0, "Time_End": 682.0, "Text": " And we actually coupled that with a vulnerability scanner with a tiny,"}, {"Time_Start": 682.0, "Time_End": 687.0, "Text": " framework and as you pop boxes it would install a little demon that would then report your score and who run the box."}, {"Time_Start": 687.0, "Time_End": 693.0, "Text": " So when I scan, you can determine what the score the system was, and we decided, well, you know, we started writing this game and we wanted to start running X-Play modules for it."}, {"Time_Start": 693.0, "Time_End": 696.0, "Text": " The problem is all the exploit models had to work the same way."}, {"Time_Start": 696.0, "Time_End": 701.0, "Text": " They did the same inputs, same outputs, be able to take the same payload or be able to handle firewalls, things like that."}, {"Time_Start": 701.0, "Time_End": 704.0, "Text": " As we started working in the game, we're like, wait a minute, this is actually useful for a whole lot of the stuff,"}, {"Time_Start": 704.0, "Time_End": 707.0, "Text": " and we can actually use the same concept as development of the framework."}, {"Time_Start": 707.0, "Time_End": 711.0, "Text": " We started rewriting the project in about, I think, August 2003."}, {"Time_Start": 711.0, "Time_End": 717.0, "Text": " We dropped 1.0 out just kind of as a, you know, testing the water, see if anyone was actually interested in it."}, {"Time_Start": 717.0, "Time_End": 719.0, "Text": " And oddly enough, I'm sort of actually using it."}, {"Time_Start": 719.0, "Time_End": 724.0, "Text": " And it could have been because we included three or four exploits that didn't really work well anywhere else."}, {"Time_Start": 724.0, "Time_End": 730.0, "Text": " I'm slowly kind of involved in an open source project, and Spoon started helping out, I think in November, December of last year."}, {"Time_Start": 730.0, "Time_End": 733.0, "Text": " And I pushed out and said, eh, that sucks, I'm going to write it better."}, {"Time_Start": 733.0, "Time_End": 734.0, "Text": " And I was like, okay, go for it."}, {"Time_Start": 734.0, "Time_End": 736.0, "Text": " And he did. So that's a spoon."}, {"Time_Start": 736.0, "Time_End": 740.0, "Text": " Yeah, we have four primary developers right now."}, {"Time_Start": 740.0, "Time_End": 747.0, "Text": " worked pretty much on the framework code. And we also have Matt Miller, who's probably here somewhere, who's done a lot of really great work."}, {"Time_Start": 747.0, "Time_End": 750.0, "Text": " He did a lot of the DL injection stuff you'll see you later."}, {"Time_Start": 750.0, "Time_End": 753.0, "Text": " And also working on actually some of the code going to Metisploit."}, {"Time_Start": 753.0, "Time_End": 759.0, "Text": " And we also have Optics who's doing a lot of the backend shell code and exploits on Solaris and stuff like that."}, {"Time_Start": 759.0, "Time_End": 762.0, "Text": " So that's basically the Metisploit team."}, {"Time_Start": 762.0, "Time_End": 769.0, "Text": " We also have a handful of other contributors to people sending us exploits and different payloads."}, {"Time_Start": 769.0, "Time_End": 776.0, "Text": " So, a quick overview of the development status. We have about 35 exploits and 40 payloads right now as of released 2.2."}, {"Time_Start": 776.0, "Time_End": 779.0, "Text": " We have a stable exploit and payload API."}, {"Time_Start": 779.0, "Time_End": 787.0, "Text": " That was one thing that 2.2 set out to do was to sort of freeze the API so we can safely tell other people to start writing things from at a"}, {"Time_Start": 787.0, "Time_End": 790.0, "Text": " exploit and not have them not work in future releases."}, {"Time_Start": 790.0, "Time_End": 795.0, "Text": " It's widely used as we're slowly finding out by a lot of security firms and a lot of other groups."}, {"Time_Start": 795.0, "Time_End": 798.0, "Text": " And it's increasingly used by system admins and other people's preferred."}, {"Time_Start": 798.0, "Time_End": 800.0, "Text": " people's food, verifying network scans."}, {"Time_Start": 800.0, "Time_End": 804.0, "Text": " HD can talk more about this stuff because he does a lot more of it at work than I do."}, {"Time_Start": 804.0, "Time_End": 808.0, "Text": " I actually just want to see a lot of large software companies using the product to test off their products."}, {"Time_Start": 808.0, "Time_End": 810.0, "Text": " They'll have a vulnerability report in their product,"}, {"Time_Start": 810.0, "Time_End": 812.0, "Text": " they'll just, you know, test X white 4 that demonstrates it,"}, {"Time_Start": 812.0, "Time_End": 815.0, "Text": " and they actually use either the Metispoit client interface"}, {"Time_Start": 815.0, "Time_End": 819.0, "Text": " or the actual API itself to ultimately test for that during the regression testing process."}, {"Time_Start": 819.0, "Time_End": 823.0, "Text": " There's another large company that provides security products and specifically host production products,"}, {"Time_Start": 823.0, "Time_End": 827.0, "Text": " like this mentioned by, I think another talk at this con covered those."}, {"Time_Start": 827.0, "Time_End": 828.0, "Text": " And they actually used."}, {"Time_Start": 828.0, "Time_End": 832.0, "Text": " meta-spoly along with different types of payloads to verify that their production system actually works correctly."}, {"Time_Start": 832.0, "Time_End": 836.0, "Text": " And what you'll notice with a lot of the host production systems on the Windows environment,"}, {"Time_Start": 836.0, "Time_End": 839.0, "Text": " instead of doing memory type production, we actually look for the permissions of the page,"}, {"Time_Start": 839.0, "Time_End": 842.0, "Text": " they just try to prevent you for doing certain types of things in your shell code."}, {"Time_Start": 842.0, "Time_End": 847.0, "Text": " So they'll look for people calling Load Library A from a memory segment that is writable, things like that,"}, {"Time_Start": 847.0, "Time_End": 850.0, "Text": " or from a stack address, and we're starting to hear more reports,"}, {"Time_Start": 850.0, "Time_End": 852.0, "Text": " people actually using this to do that type of testing."}, {"Time_Start": 852.0, "Time_End": 855.0, "Text": " Version 2.2 was the first development-friendly release."}, {"Time_Start": 855.0, "Time_End": 857.98, "Text": " In other words, if you pick up 2.2, once we released it next week, or"}, {"Time_Start": 858.0, "Time_End": 861.0, "Text": " from the secret blackout URL that you'll find the back end of the slides."}, {"Time_Start": 861.0, "Time_End": 867.0, "Text": " You can actually use it to develop that exploits so that should work in all future versions of 2.2,"}, {"Time_Start": 867.0, "Time_End": 868.0, "Text": " with any modifications."}, {"Time_Start": 868.0, "Time_End": 872.0, "Text": " An important thing quick about the increasing use by security firms,"}, {"Time_Start": 872.0, "Time_End": 874.0, "Text": " the people after volume scans."}, {"Time_Start": 874.0, "Time_End": 877.0, "Text": " It's one thing for a security tester to come in and say,"}, {"Time_Start": 877.0, "Time_End": 880.0, "Text": " you know, we scanned your host and we have one on Petched box,"}, {"Time_Start": 880.0, "Time_End": 885.0, "Text": " and a lot of people are realizing that it's much more impactful and useful to actually go in"}, {"Time_Start": 885.0, "Time_End": 887.98, "Text": " and then maybe if you have good notes on an exploit, you know what we'll know where"}, {"Time_Start": 888.0, "Time_End": 891.0, "Text": " crash the box and stuff, actually go in and own it, and then you can say,"}, {"Time_Start": 891.0, "Time_End": 895.0, "Text": " you know, not only there was this box unpassed, but you also had, you know, your payroll sitting"}, {"Time_Start": 895.0, "Time_End": 898.0, "Text": " in an Excel spreadsheet on the desktop."}, {"Time_Start": 898.0, "Time_End": 902.0, "Text": " So I think a lot of people are realizing this, and that's why it's a lot of,"}, {"Time_Start": 902.0, "Time_End": 905.0, "Text": " that's why I think VesPen's really useful for people in that sort of area,"}, {"Time_Start": 905.0, "Time_End": 913.0, "Text": " because it's a nice tool to follow up after a vault assessment and, uh..."}, {"Time_Start": 913.0, "Time_End": 914.0, "Text": " There's a..."}, {"Time_Start": 914.0, "Time_End": 916.0, "Text": " The Metispey frame is actually made up of a ton of little components."}, {"Time_Start": 916.0, "Time_End": 917.0, "Text": " If you look at the list of files, there's something right."}, {"Time_Start": 917.0, "Time_End": 922.0, "Text": " to buy was something like, you know, 200 odd pole modules, scripts, source code, things like that in there."}, {"Time_Start": 922.0, "Time_End": 927.0, "Text": " It's a combination of like, you know, pearls, see, assembler, there's some Python stuff for supporting inline egg."}, {"Time_Start": 927.0, "Time_End": 931.0, "Text": " It's really kind of a hodgepodgepodge of stuff where you pick the best language for whatever the job happened to be."}, {"Time_Start": 931.0, "Time_End": 937.0, "Text": " There's actually the set of interfaces, there's three different user interfaces in the project right now, which we'll cover in the next section a little bit."}, {"Time_Start": 937.0, "Time_End": 942.0, "Text": " You have your exploits, you've got your payload encoders that are responsible for taking the raw shell code"}, {"Time_Start": 942.0, "Time_End": 946.0, "Text": " and actually translating into something that doesn't have a certain set of characters into it, which is useful for, you know, if you're like,"}, {"Time_Start": 946.0, "Time_End": 950.0, "Text": " know, if you're attacking a, you know, web server and you have to put the exploit screen,"}, {"Time_Start": 950.0, "Time_End": 954.0, "Text": " or you have to the shell code into the URL itself, they'd avoid certain characters to make it a valid request still."}, {"Time_Start": 954.0, "Time_End": 956.0, "Text": " You've got the actual payloads themselves."}, {"Time_Start": 956.0, "Time_End": 960.0, "Text": " Those things have the actual shell code, what actually runs in the box, and the exploit works correctly."}, {"Time_Start": 960.0, "Time_End": 965.0, "Text": " We've got stuff ranging from bind shells, connect shells, executive to just all kinds of random weird things,"}, {"Time_Start": 965.0, "Time_End": 968.0, "Text": " like things that will actually reset a signal handle to be something else,"}, {"Time_Start": 968.0, "Time_End": 972.0, "Text": " and we've got a lot of special case payloads that we use to get around certain tasks."}, {"Time_Start": 972.0, "Time_End": 976.0, "Text": " And because of the design of the framework, you can create your own payload, drop it into the system,"}, {"Time_Start": 976.0, "Time_End": 978.0, "Text": " system and have it run with any of the exploits already there."}, {"Time_Start": 978.0, "Time_End": 982.0, "Text": " You don't have to go through it and actually have to patch all your silly, you know, dot-c exploits"}, {"Time_Start": 982.0, "Time_End": 986.0, "Text": " so that they all use your new payload and then have to adjust the size of the role and whatnot."}, {"Time_Start": 986.0, "Time_End": 987.0, "Text": " It happens automatically."}, {"Time_Start": 987.0, "Time_End": 991.0, "Text": " Finally, for the payloads themselves, each payload has a handler."}, {"Time_Start": 991.0, "Time_End": 997.0, "Text": " People don't think about this too much because it seems to be automatic, but if say your exploit will create a bind shell,"}, {"Time_Start": 997.0, "Time_End": 999.0, "Text": " well, you have to write a bunch of code to connect to the bind shell,"}, {"Time_Start": 999.0, "Time_End": 1003.0, "Text": " or you have to write, you know, to type telmap, blah, blah, blah, blah, to connect to the host."}, {"Time_Start": 1003.0, "Time_End": 1004.0, "Text": " Well, we think that's kind of so."}, {"Time_Start": 1004.0, "Time_End": 1006.0, "Text": " There's no reason to force the user to, you know,"}, {"Time_Start": 1006.0, "Time_End": 1009.0, "Text": " connect to, you know, use an external program to connect to the shell."}, {"Time_Start": 1009.0, "Time_End": 1013.0, "Text": " There's no reason to have the same boilerplate code written, you know, repeatedly in each and every exploit."}, {"Time_Start": 1013.0, "Time_End": 1017.0, "Text": " So we've got a handler system where for every single payload, it defines how it handles that payload itself."}, {"Time_Start": 1017.0, "Time_End": 1022.0, "Text": " If it's a reverse connection, for instance, the own box connects back to you, it'll create a listener,"}, {"Time_Start": 1022.0, "Time_End": 1023.0, "Text": " then bind that to a console."}, {"Time_Start": 1023.0, "Time_End": 1026.0, "Text": " And that console could be the actual standard input output."}, {"Time_Start": 1026.0, "Time_End": 1028.5, "Text": " It could be a telnet server that actually runs a different port."}, {"Time_Start": 1028.5, "Time_End": 1033.5, "Text": " And if you've actually seen the MSF web console, it actually creates a proxy telemet server then puts a command shell on that,"}, {"Time_Start": 1033.5, "Time_End": 1035.98, "Text": " and then redirects your browser to a telnet, colon, colon,"}, {"Time_Start": 1036.0, "Time_End": 1038.0, "Text": " slash those links to the poxed server."}, {"Time_Start": 1038.0, "Time_End": 1042.0, "Text": " And finally, you have the NOPS system."}, {"Time_Start": 1042.0, "Time_End": 1045.0, "Text": " And as you know, NOPS used to pad the payload space."}, {"Time_Start": 1045.0, "Time_End": 1049.0, "Text": " Because the way that we're able to do interchangible payloads"}, {"Time_Start": 1049.0, "Time_End": 1051.0, "Text": " is we tend to hard code the amount of space to actually use by the payloads"}, {"Time_Start": 1051.0, "Time_End": 1053.0, "Text": " on a per Xpload basis."}, {"Time_Start": 1053.0, "Time_End": 1056.0, "Text": " So you can have, you know, 1X4 has room for about 512 bytes of payload."}, {"Time_Start": 1056.0, "Time_End": 1059.0, "Text": " You just have to be the space for that payload to be 512."}, {"Time_Start": 1059.0, "Time_End": 1061.0, "Text": " If your payload you're using is only 200 bytes,"}, {"Time_Start": 1061.0, "Time_End": 1064.0, "Text": " it had been padded 300 bytes in front of that with whatever NOPS"}, {"Time_Start": 1064.0, "Time_End": 1065.0, "Text": " whatever NOPS off that platform."}, {"Time_Start": 1065.0, "Time_End": 1066.0, "Text": " platform."}, {"Time_Start": 1066.0, "Time_End": 1070.24, "Text": " You can actually set environment variables to randomize the knob slides themselves."}, {"Time_Start": 1070.24, "Time_End": 1072.24, "Text": " You can actually specify a minimum napslads."}, {"Time_Start": 1072.24, "Time_End": 1076.24, "Text": " So if you're doing a brief force attack and you require a certain amount of knobs to be there,"}, {"Time_Start": 1076.24, "Time_End": 1078.76, "Text": " it'll always make sure that that amount of knobs are there."}, {"Time_Start": 1078.76, "Time_End": 1084.76, "Text": " Additionally, each exploit can define which registers have to be preserved during the knapslet itself."}, {"Time_Start": 1084.76, "Time_End": 1088.2, "Text": " So if you're using a randomized nops slide and you need to make sure that EBX registers never"}, {"Time_Start": 1088.2, "Time_End": 1091.88, "Text": " touch because use that to get back to your payload, you can define that in your exploit and an option"}, {"Time_Start": 1091.88, "Time_End": 1093.76, "Text": " to automatically walk around that."}, {"Time_Start": 1093.76, "Time_End": 1097.76, "Text": " Yeah, I just want to preach on the handle part, because it's actually really important,"}, {"Time_Start": 1097.76, "Time_End": 1101.76, "Text": " and one of the reasons we've been able to do a lot of the cool stuff, like the VNC eject,"}, {"Time_Start": 1101.76, "Time_End": 1103.76, "Text": " and some of our staged payloads."}, {"Time_Start": 1103.76, "Time_End": 1107.76, "Text": " Just the way it's designed, it's really easy to back on a lot of the handlers already written,"}, {"Time_Start": 1107.76, "Time_End": 1113.76, "Text": " for example, if you were going to write a reverse connection shell that does a simple one-byte XOR."}, {"Time_Start": 1113.76, "Time_End": 1119.76, "Text": " It would be a matter of writing a payload and adding two sub-functions to filter the outbound and inbound traffic to do the XOR."}, {"Time_Start": 1119.76, "Time_End": 1122.76, "Text": " So it's really a matter of, you know, an extra six lines or something in the payload."}, {"Time_Start": 1122.76, "Time_End": 1127.26, "Text": " and you can already back already on the shell and MSF lab and any other"}, {"Time_Start": 1127.26, "Time_End": 1131.26, "Text": " consoles that we have already written and this actually comes in the play a lot when we do"}, {"Time_Start": 1131.26, "Time_End": 1134.76, "Text": " we'll show the VNC stuff and all of it was really really simple to implement just because"}, {"Time_Start": 1134.76, "Time_End": 1138.66, "Text": " of our payload system and the way the handlers all work so a lot of it's hidden for"}, {"Time_Start": 1138.66, "Time_End": 1141.0, "Text": " me but there's a lot of times there's some pretty complicated stuff going on in the"}, {"Time_Start": 1141.0, "Time_End": 1144.66, "Text": " back end but as a user if you didn't have a handler system to do it would be really"}, {"Time_Start": 1144.66, "Time_End": 1147.9, "Text": " annoying you know dubbing that cats sitting there trying to figure out which one's"}, {"Time_Start": 1147.9, "Time_End": 1152.74, "Text": " read which one's right and a lot of stuff like that so this is actually more important than it may"}, {"Time_Start": 1152.76, "Time_End": 1156.84, "Text": " and it's pretty hidden from the user but all the magic going on is a lot"}, {"Time_Start": 1156.84, "Time_End": 1166.92, "Text": " because of this. So this is a brief layout of sort of the design of MetaSpray. You have"}, {"Time_Start": 1166.92, "Time_End": 1171.96, "Text": " the interfaces which is extracted from the framework code and it's really trivial"}, {"Time_Start": 1171.96, "Time_End": 1176.7, "Text": " to run a new interface. We just have three simple ones. We have the console interface which"}, {"Time_Start": 1176.7, "Time_End": 1181.86, "Text": " is the supported client and what we do all of our development work on. We have a command line"}, {"Time_Start": 1181.8600000000001, "Time_End": 1186.7800000000002, "Text": " interface which is good for scripting and parsing then we also have the"}, {"Time_Start": 1186.7800000000002, "Time_End": 1192.66, "Text": " web interface which is sort of the flashy proof-of-concept demo interface we also"}, {"Time_Start": 1192.66, "Time_End": 1196.6000000000001, "Text": " I don't know if you want to touch on some of this stuff we have we explained some of the"}, {"Time_Start": 1196.6000000000001, "Time_End": 1200.92, "Text": " modules before we have four types of modules the handlers we were talking about"}, {"Time_Start": 1200.92, "Time_End": 1205.68, "Text": " before are considered part of the payloads we have some libraries for example we have a lot"}, {"Time_Start": 1205.68, "Time_End": 1211.8400000000001, "Text": " of code in packs for example we have an S&B stack we have a lot of stuff in MSF we have"}, {"Time_Start": 1211.8600000000001, "Time_End": 1215.2600000000002, "Text": " lot of core classes, UEUTILs and stuff like that."}, {"Time_Start": 1215.2600000000002, "Time_End": 1219.16, "Text": " The nice thing is that all those modules all inherit from those bottom classes."}, {"Time_Start": 1219.16, "Time_End": 1222.96, "Text": " So we have some, probably the strangest Paul OO you've ever seen before in your life."}, {"Time_Start": 1222.96, "Time_End": 1226.66, "Text": " You start looking the way that's going to implement some of this stuff, you actually have payloads"}, {"Time_Start": 1226.66, "Time_End": 1231.7600000000002, "Text": " that import from one class and then tell the imported class who is its parent is."}, {"Time_Start": 1231.7600000000002, "Time_End": 1235.8000000000002, "Text": " So it gets pretty tweaked as far as what payload inherits, what other class, but the end point"}, {"Time_Start": 1235.8000000000002, "Time_End": 1240.5200000000002, "Text": " is you can actually have a payload which handles a command shell with input output and be able"}, {"Time_Start": 1240.5200000000002, "Time_End": 1241.8400000000001, "Text": " to find whether it's a bind shell or version shell or version."}, {"Time_Start": 1241.8600000000001, "Time_End": 1246.3200000000002, "Text": " shell, fine sock, or whether it goes through some other encrypted channel through ICMP or whatever have you."}, {"Time_Start": 1246.64, "Time_End": 1252.42, "Text": " But because of the way it's designed, you can actually replace the parent handles, excuse me, the handler's parents on the fly."}, {"Time_Start": 1253.0600000000002, "Time_End": 1258.96, "Text": " And one that's important is because, for example, we have a staging system for the window stuff."}, {"Time_Start": 1258.96, "Time_End": 1266.2800000000002, "Text": " And if you're not familiar with what a stage pilot is, basically, if you want to, say, get a reverse connection and then get a command shell, that may be 300 bytes."}, {"Time_Start": 1266.6200000000001, "Time_End": 1271.8400000000001, "Text": " But if you just get a reverse connection and then have code that or read in more code and execute it, that may be 200 bytes."}, {"Time_Start": 1271.8600000000001, "Time_End": 1280.8600000000001, "Text": " So for space problems, you can then do the staging, and it's also nicer just, for a lot of reasons, then you can have really big payloads and stuff like that, and we have a lot of staging going on."}, {"Time_Start": 1282.8600000000001, "Time_End": 1294.4, "Text": " So because of how that works, you can just write a stage, which is really independent of the stager, and then you can build stages by just saying, I want a stage, and a reverse stage, or I want a stage, and a bind stage, or I want a stage, and a fine sock stager."}, {"Time_Start": 1294.4, "Time_End": 1301.8400000000001, "Text": " And you can sort of, like, you know, build your payloads together, and with a lot of code reuse, and a lot of backing on stuff like that."}, {"Time_Start": 1301.8600000000001, "Time_End": 1305.94, "Text": " So, click into the command line interface."}, {"Time_Start": 1305.94, "Time_End": 1309.5400000000002, "Text": " This is actually the same sort of interface that's been around there since version 1-0."}, {"Time_Start": 1309.5400000000002, "Time_End": 1317.18, "Text": " But apparently used to do MSF, CLI, give it the, you know, some string that will match the type of the name of the payload, excuse me, the export that you want to use."}, {"Time_Start": 1317.18, "Time_End": 1320.18, "Text": " So you want to explore with the LSASS, used to do LAS would match."}, {"Time_Start": 1320.18, "Time_End": 1322.38, "Text": " You don't have to do that full module name."}, {"Time_Start": 1322.38, "Time_End": 1326.3000000000002, "Text": " You can do, you know, dump the summary, which dumps all kinds of information about exploit."}, {"Time_Start": 1326.3000000000002, "Time_End": 1329.6200000000001, "Text": " One of the biggest problems with public exploits is you don't really know what the hell of the exploit does."}, {"Time_Start": 1329.6200000000001, "Time_End": 1331.8400000000001, "Text": " And you can go through and look at the comments, you can assume that the"}, {"Time_Start": 1331.8600000000001, "Time_End": 1335.66, "Text": " the usage is actually correct, you can verify that, you know, whatever advisor they thought"}, {"Time_Start": 1335.66, "Time_End": 1339.2400000000002, "Text": " that exploit reference is actually the vulnerability that it affects, but we put all the information"}, {"Time_Start": 1339.2400000000002, "Time_End": 1342.66, "Text": " directly in the exploit module itself. If you look at most of the exploit model, at least half"}, {"Time_Start": 1342.66, "Time_End": 1346.72, "Text": " the code is just meta information. It's, I mean, these things are only like four or five hundred"}, {"Time_Start": 1346.72, "Time_End": 1352.16, "Text": " lines long at the most, with some being, you know, only like 200 lines. And about half of that is just"}, {"Time_Start": 1352.16, "Time_End": 1356.7, "Text": " like, you know, what the exploit is, what it affects, some references to it, some URLs, things like that,"}, {"Time_Start": 1356.88, "Time_End": 1361.18, "Text": " and kind of give you some information about what the export actually is. You can see this information"}, {"Time_Start": 1361.18, "Time_End": 1363.5800000000002, "Text": " with the summary option. This is kind of consistent through the rest of the interfaces."}, {"Time_Start": 1364.88, "Time_End": 1368.5, "Text": " You don't see what options are available, like if there's an advanced, excuse me, if there's an option for,"}, {"Time_Start": 1368.8, "Time_End": 1371.8600000000001, "Text": " you know, the host you're going to attack, or the port you want to tap, or whether you enable"}, {"Time_Start": 1371.8600000000001, "Time_End": 1375.28, "Text": " S's all for giving an attack, things like that. It's ultimately through the environment, and you can"}, {"Time_Start": 1375.28, "Time_End": 1378.04, "Text": " look at those options through that. There's an advanced section, et cetera, et cetera."}, {"Time_Start": 1378.18, "Time_End": 1381.22, "Text": " So we'll probably cover these more in detail, but if you have a idea, you put them all"}, {"Time_Start": 1381.22, "Time_End": 1384.44, "Text": " on the command line, you run up the console with a client interface, and you can script this"}, {"Time_Start": 1384.44, "Time_End": 1389.3600000000001, "Text": " really easy. Yeah, and the important thing to think about is MSCLI is like, I don't"}, {"Time_Start": 1389.3600000000001, "Time_End": 1394.6000000000001, "Text": " or something, a lot of that user interface code is back in the framework and we"}, {"Time_Start": 1394.6000000000001, "Time_End": 1398.9, "Text": " you sort of stick code in front of it, for example, the console interface, the majority of the code"}, {"Time_Start": 1398.9, "Time_End": 1404.1200000000001, "Text": " is handling nice stuff like tab completion, a lot of all of the session logging and the environments"}, {"Time_Start": 1404.1200000000001, "Time_End": 1408.2800000000002, "Text": " are handled actually on the back end and really user interface independent."}, {"Time_Start": 1408.2800000000002, "Time_End": 1416.5200000000002, "Text": " So brief review of the console interface, HD worked a lot on getting really rad tab completion, so there's"}, {"Time_Start": 1416.5200000000002, "Time_End": 1418.1200000000001, "Text": " pretty much tab completion on everything."}, {"Time_Start": 1418.1200000000001, "Time_End": 1422.44, "Text": " They'll store a cache of IP addresses that you've used, and you can tap complete IP addresses,"}, {"Time_Start": 1422.44, "Time_End": 1425.18, "Text": " commands, payloads, pretty much everything."}, {"Time_Start": 1425.18, "Time_End": 1429.5200000000002, "Text": " It's about session logging, which is really important for people doing pen testing."}, {"Time_Start": 1429.5200000000002, "Time_End": 1433.96, "Text": " You can, you know, if you want to remember what you set your back to our password to a couple of weeks"}, {"Time_Start": 1433.96, "Time_End": 1438.22, "Text": " later, you can go through and look through the logs, and it keeps a full time stamped a record"}, {"Time_Start": 1438.22, "Time_End": 1443.5600000000002, "Text": " of not only the export attempts and whether those are successful or not, but also the log all"}, {"Time_Start": 1443.5600000000002, "Time_End": 1446.0600000000002, "Text": " of the data sent through our handler system."}, {"Time_Start": 1446.06, "Time_End": 1450.02, "Text": " So if you get a shell and a log, all of the shell activity, this is off by default, by the"}, {"Time_Start": 1450.02, "Time_End": 1451.9199999999998, "Text": " way, it's optional."}, {"Time_Start": 1451.9199999999998, "Time_End": 1453.3, "Text": " And, well, of course."}, {"Time_Start": 1453.3, "Time_End": 1459.44, "Text": " But along all that, along with time stamps, and then we have a tool MSF log dump that"}, {"Time_Start": 1459.44, "Time_End": 1462.94, "Text": " can go through and, you know, gives you red and blue output, so you can go through and after, you"}, {"Time_Start": 1462.94, "Time_End": 1466.24, "Text": " can see all the logs, and if you wanted to, it's all time stamped, so you could go through"}, {"Time_Start": 1466.24, "Time_End": 1467.24, "Text": " and replay it."}, {"Time_Start": 1467.24, "Time_End": 1471.84, "Text": " And this is really good if you're pen testing or something and you have, you know, a customer"}, {"Time_Start": 1471.84, "Time_End": 1475.82, "Text": " that come back and said, you know, our system crashed at 5 o'clock, blah, blah, blah, blah, blah,"}, {"Time_Start": 1475.82, "Time_End": 1481.54, "Text": " can come back and be like, well, we owned it at 4, we were out by 415, so it wasn't us."}, {"Time_Start": 1481.54, "Time_End": 1486.1399999999999, "Text": " So, I mean, this is something that's definitely very valuable."}, {"Time_Start": 1486.1399999999999, "Time_End": 1491.1399999999999, "Text": " It has history, it's read line, so it's very familiar if anybody's, like, used to bash,"}, {"Time_Start": 1491.1399999999999, "Time_End": 1495.54, "Text": " it uses the same library, so you know you can do opt and down for history, you can do tab"}, {"Time_Start": 1495.54, "Time_End": 1499.06, "Text": " completion, all sort of that."}, {"Time_Start": 1499.06, "Time_End": 1505.46, "Text": " Metisplay back at, or the Metisplay interface is very invent-driven, environment-driven, so we have access"}, {"Time_Start": 1505.46, "Time_End": 1510.0, "Text": " to the complete environment from MSF, and it's very much like you'd use to solve something,"}, {"Time_Start": 1510.0, "Time_End": 1515.46, "Text": " stack commands, you can see the environment, unset of environmental variables, stuff like that."}, {"Time_Start": 1515.46, "Time_End": 1520.96, "Text": " Class interface was kind of written as a joke, but we thought it was funny enough to keep it in there."}, {"Time_Start": 1520.96, "Time_End": 1524.7, "Text": " Essentially, it starts a little built-in web server on the system, and you can just browse"}, {"Time_Start": 1524.7, "Time_End": 1526.96, "Text": " to this web interface and gives you a list of all these different exploits."}, {"Time_Start": 1526.96, "Time_End": 1530.3600000000001, "Text": " You just kind of click along, you click the exploit, and it gives you list, okay, here's what the exploit"}, {"Time_Start": 1530.3600000000001, "Time_End": 1534.22, "Text": " does, you can click the select payload, pick whatever payload you feel like using, go to the next"}, {"Time_Start": 1534.22, "Time_End": 1535.44, "Text": " action where it fills in all the form."}, {"Time_Start": 1535.46, "Time_End": 1538.46, "Text": " values for all the options that are set, and finally just hit exploit."}, {"Time_Start": 1538.46, "Time_End": 1542.16, "Text": " And what actually happens is it does everything that the console, the CLI would possibly do"}, {"Time_Start": 1542.16, "Time_End": 1546.46, "Text": " in terms of actually, you know, breaking into the box, connecting to whatever the payload itself was."}, {"Time_Start": 1546.46, "Time_End": 1550.46, "Text": " It was a bind shell, the web server then connect into the server to the port that the shell is on,"}, {"Time_Start": 1550.46, "Time_End": 1553.46, "Text": " connect into it, there's a verse connect over and listen for the connection, et cetera,"}, {"Time_Start": 1553.46, "Time_End": 1555.46, "Text": " bind sock, you know, all about the same thing."}, {"Time_Start": 1555.46, "Time_End": 1559.46, "Text": " And when it actually has a connection, it then starts a separate a separate server on the web server itself,"}, {"Time_Start": 1559.46, "Time_End": 1562.46, "Text": " and then redirects the user's browser, actually I think right now just gives you a link to it,"}, {"Time_Start": 1562.46, "Time_End": 1564.46, "Text": " so I tell them that URL to the port itself."}, {"Time_Start": 1564.46, "Time_End": 1569.46, "Text": " So pretty much you just click through the web interface until it says, got show, and then you click that and pops up a little X term with your shell."}, {"Time_Start": 1569.46, "Time_End": 1571.46, "Text": " And it all goes through the web store itself."}, {"Time_Start": 1571.46, "Time_End": 1577.46, "Text": " So you can have a single system on whatever network you're running on that's running MSF webinar face and export every system through that box."}, {"Time_Start": 1577.46, "Time_End": 1579.46, "Text": " So it's kind of nice."}, {"Time_Start": 1579.46, "Time_End": 1580.46, "Text": " It's kind of broke."}, {"Time_Start": 1580.46, "Time_End": 1582.46, "Text": " It could be written better."}, {"Time_Start": 1582.46, "Time_End": 1583.46, "Text": " It's probably better way to put it."}, {"Time_Start": 1583.46, "Time_End": 1587.46, "Text": " But it's functional right now, and we don't recommend if we use it from production environments,"}, {"Time_Start": 1587.46, "Time_End": 1589.46, "Text": " but it's a fun thing to play with and do demos for management and whatnot."}, {"Time_Start": 1589.46, "Time_End": 1592.46, "Text": " And this is another something you can attest to the handler system."}, {"Time_Start": 1592.46, "Time_End": 1594.46, "Text": " I think writing MSF lab would,"}, {"Time_Start": 1594.46, "Time_End": 1600.46, "Text": " is the matter of changing one backend method to be able to do the connection proxing instead of actually dropping into a shell."}, {"Time_Start": 1600.46, "Time_End": 1603.46, "Text": " So that's another cool thing that the design."}, {"Time_Start": 1603.46, "Time_End": 1608.46, "Text": " The screen on the, excuse me, the slide on the screen right now is actually showing an XO encrypted shell,"}, {"Time_Start": 1608.46, "Time_End": 1612.46, "Text": " but the telemet connection to the proxy server itself is completely clear text."}, {"Time_Start": 1612.46, "Time_End": 1617.46, "Text": " So in other words, the NSF web server handles the connection in whatever way it needs to,"}, {"Time_Start": 1617.46, "Time_End": 1620.46, "Text": " including actually encoding the data as it goes back and forth across the network,"}, {"Time_Start": 1620.46, "Time_End": 1623.46, "Text": " and the connection back to the tunnel itself is just like being a remote console on the system."}, {"Time_Start": 1623.46, "Time_End": 1624.46, "Text": " on the system."}, {"Time_Start": 1624.46, "Time_End": 1630.46, "Text": " So this is more of a development tool."}, {"Time_Start": 1630.46, "Time_End": 1632.46, "Text": " I mean, it's not more of a development tool, it is a development tool."}, {"Time_Start": 1632.46, "Time_End": 1635.46, "Text": " So it's something that just a user of MetaSpoit probably isn't familiar with,"}, {"Time_Start": 1635.46, "Time_End": 1638.46, "Text": " and it's sort of the one tool that isn't really part,"}, {"Time_Start": 1638.46, "Time_End": 1643.46, "Text": " I mean, it is part of the framework, but it isn't really part of a normal user's use of Metispoit."}, {"Time_Start": 1643.46, "Time_End": 1645.46, "Text": " What this is, is, if anybody's ever written,"}, {"Time_Start": 1645.46, "Time_End": 1649.46, "Text": " experts for Windows, you know, it's very important to be able to find code"}, {"Time_Start": 1649.46, "Time_End": 1652.46, "Text": " and D allows to return to and then to return into your code."}, {"Time_Start": 1652.46, "Time_End": 1653.46, "Text": " into your code."}, {"Time_Start": 1653.46, "Time_End": 1660.68, "Text": " So this will scan PE images offline, either DL or executable, and they'll find arbitrary matches."}, {"Time_Start": 1660.68, "Time_End": 1662.38, "Text": " You can do regular expressions."}, {"Time_Start": 1662.38, "Time_End": 1666.96, "Text": " You can then take those regular expressions and pump them through a disassembler with one commandment"}, {"Time_Start": 1666.96, "Time_End": 1667.96, "Text": " option."}, {"Time_Start": 1667.96, "Time_End": 1671.46, "Text": " And you can go through and, you know, build things looking for certain instructions that you"}, {"Time_Start": 1671.46, "Time_End": 1673.46, "Text": " want in the DL space."}, {"Time_Start": 1673.46, "Time_End": 1677.46, "Text": " We use this a lot and we find some very good universal return addresses."}, {"Time_Start": 1677.46, "Time_End": 1678.46, "Text": " It's very easy to script."}, {"Time_Start": 1678.46, "Time_End": 1680.46, "Text": " The output is pretty much universal."}, {"Time_Start": 1680.46, "Time_End": 1681.46, "Text": " It's very easy to parse."}, {"Time_Start": 1681.46, "Time_End": 1688.46, "Text": " And one example of using it, this is, for example, the ServU exploit."}, {"Time_Start": 1688.46, "Time_End": 1693.46, "Text": " There was something like six different installers from version 3 through 5 something."}, {"Time_Start": 1693.46, "Time_End": 1695.46, "Text": " So we just took all the installers."}, {"Time_Start": 1695.46, "Time_End": 1698.46, "Text": " You can use cab extract because the installers are just cab files."}, {"Time_Start": 1698.46, "Time_End": 1700.46, "Text": " Pull all the DLs out of them, right M."}, {"Time_Start": 1700.46, "Time_End": 1704.46, "Text": " FPE scan over all of them, got output for each one, then did correlation,"}, {"Time_Start": 1704.46, "Time_End": 1708.46, "Text": " and we had a universal return address in a matter of a few minutes."}, {"Time_Start": 1708.46, "Time_End": 1710.46, "Text": " And that actually ends up working for every version of Servue."}, {"Time_Start": 1710.46, "Time_End": 1713.46, "Text": " serve you from NT through 2003."}, {"Time_Start": 1713.46, "Time_End": 1716.46, "Text": " So you can see that a tool like this is very useful."}, {"Time_Start": 1716.46, "Time_End": 1720.46, "Text": " The nice thing about this is that we never had to boot Windows at all in this process to do it."}, {"Time_Start": 1720.46, "Time_End": 1722.46, "Text": " So something you'll notice if we start using the framework"}, {"Time_Start": 1722.46, "Time_End": 1725.46, "Text": " is that none of the tools that are included with it really have to run Windows in the first place."}, {"Time_Start": 1725.46, "Time_End": 1730.46, "Text": " So we really don't really want to have to run, you know, Windows desktop to do exploit dev for Windows Box."}, {"Time_Start": 1730.46, "Time_End": 1733.46, "Text": " And that's really why we've gone through and, you know, written our own S&B class,"}, {"Time_Start": 1733.46, "Time_End": 1735.46, "Text": " written on DCRPC class."}, {"Time_Start": 1735.46, "Time_End": 1739.46, "Text": " I'm not sure enough, but got it."}, {"Time_Start": 1739.46, "Time_End": 1740.46, "Text": " So, okay."}, {"Time_Start": 1740.46, "Time_End": 1741.46, "Text": " Okay."}, {"Time_Start": 1741.46, "Time_End": 1745.46, "Text": " And, you know, things like our DCCOM exploit where it's actually one request that exploits three different"}, {"Time_Start": 1745.46, "Time_End": 1751.46, "Text": " systems at once are kind of nice, and we did that with the help of an MSPE scan."}, {"Time_Start": 1751.46, "Time_End": 1753.46, "Text": " There's actually a couple other help utilities included."}, {"Time_Start": 1753.46, "Time_End": 1758.46, "Text": " Besides just the user interfaces and MSPE scan, we included a couple other, just, you know, nifty"}, {"Time_Start": 1758.46, "Time_End": 1760.46, "Text": " things we found useful at one point."}, {"Time_Start": 1760.46, "Time_End": 1765.46, "Text": " There's MSF DL Debug, which is a tool for downloading the debugging symbols for any given file."}, {"Time_Start": 1765.46, "Time_End": 1770.44, "Text": " So if you have a kernel 32 DOL from a system you're trying to break into and you're able to obtain, you know, the DOL from"}, {"Time_Start": 1770.46, "Time_End": 1774.46, "Text": " a similar system or running whatever the service pack or operating system or version of that it is,"}, {"Time_Start": 1774.46, "Time_End": 1780.46, "Text": " you can take that DOL, when MSDL to download the PDF files directly from Microsoft symbol server."}, {"Time_Start": 1780.46, "Time_End": 1783.46, "Text": " And you can just do you on disassembling the PDB files themselves."}, {"Time_Start": 1783.46, "Time_End": 1787.46, "Text": " So it's a nice way to be able to obtain the symbol files for any given executable,"}, {"Time_Start": 1787.46, "Time_End": 1789.46, "Text": " but I don't have to load a window bug or anything like that."}, {"Time_Start": 1789.46, "Time_End": 1792.46, "Text": " This is all done in Pure Pearl with a PD class parser and whatnot."}, {"Time_Start": 1792.46, "Time_End": 1795.46, "Text": " Another utility what we find pretty useful is emmolive payload."}, {"Time_Start": 1795.46, "Time_End": 1798.46, "Text": " Every single payload that's included in the database platform,"}, {"Time_Start": 1798.46, "Time_End": 1800.46, "Text": " but you can actually extract out of it through MSF payload."}, {"Time_Start": 1800.46, "Time_End": 1804.46, "Text": " So if you want to go back to writing an exploit in C for whatever a lot reason, or you're running something in Python,"}, {"Time_Start": 1804.46, "Time_End": 1810.46, "Text": " or you just don't like the framework at all and you think it's crap, you can actually use MSF payload to generate payloads from it anyways."}, {"Time_Start": 1810.46, "Time_End": 1814.46, "Text": " So if you want to use our Linux Reverse Connect shell, if you want to use a 132 bind shell,"}, {"Time_Start": 1814.46, "Time_End": 1819.46, "Text": " you can just run MSF payload with the right options, it'll dump out a nice pretty, you know, C-formatted or pearl-formatted buffer for you."}, {"Time_Start": 1819.46, "Time_End": 1822.46, "Text": " If you want to do this through the web, there's a CGI version of this."}, {"Time_Start": 1822.46, "Time_End": 1826.46, "Text": " You can install on your web server and just be able to go to the website and you know and dump payloads all day long."}, {"Time_Start": 1826.46, "Time_End": 1829.46, "Text": " If you need to encode the payload to remove certain character sets, like you can't have a lot."}, {"Time_Start": 1829.46, "Time_End": 1835.46, "Text": " set, like you can't have a null on your payload, or you need to avoid a certain, you know, a slash character to do, web exploit, what not."}, {"Time_Start": 1835.46, "Time_End": 1841.46, "Text": " You can run through the MSF encoder system, which actually uses all the different encoders in the point where to encode it in whatever way it will possibly do."}, {"Time_Start": 1841.46, "Time_End": 1848.46, "Text": " You can specify a specific encoder if you want to, or ultimately figure it out based on the bad characters and architecture and OSU specify."}, {"Time_Start": 1848.46, "Time_End": 1853.46, "Text": " For instance, you say, I want to avoid all moles and, you know, this character set, it'll then try, you know,"}, {"Time_Start": 1853.46, "Time_End": 1858.46, "Text": " one of about 15 different XD6 decoders, trying to find some way to avoid that character."}, {"Time_Start": 1858.46, "Time_End": 1859.44, "Text": " And as each one thing, you know,"}, {"Time_Start": 1859.46, "Time_End": 1863.46, "Text": " it will then fall through the next one until it'll probably land on alpha numeric before it's finished."}, {"Time_Start": 1863.46, "Time_End": 1867.46, "Text": " at which point you'll have a payload, which is, you know, twice the size, but it's all uppercase letters."}, {"Time_Start": 1867.46, "Time_End": 1874.46, "Text": " And the MSF payload and MSF encode actually, like MSF payload won't actually do encoding,"}, {"Time_Start": 1874.46, "Time_End": 1880.46, "Text": " but MSF payload.CGI is sort of a combination of those MSF payload and MSF encode in a web version."}, {"Time_Start": 1880.46, "Time_End": 1883.46, "Text": " So you can go in and you can just pick any payload that we have in Metisplate."}, {"Time_Start": 1883.46, "Time_End": 1885.46, "Text": " It actually just worked right out of our framework build."}, {"Time_Start": 1885.46, "Time_End": 1889.46, "Text": " So you can say, you know, Linux fine saw code or, you know, Linux,"}, {"Time_Start": 1889.46, "Time_End": 1894.46, "Text": " on port 4444, and it will build it, optionally encode it, you just put your bad characters right there on the web interface."}, {"Time_Start": 1894.46, "Time_End": 1899.46, "Text": " You're a nice little, you know, blob ready to put in C code, you know, a car, shell code."}, {"Time_Start": 1899.46, "Time_End": 1903.46, "Text": " So for some reason, you do have to be writing exploits, not in MetaSpoit for whatever reason."}, {"Time_Start": 1903.46, "Time_End": 1908.46, "Text": " You can go through here and still have advantage of using some of the payload work that we have unique to Metasploit."}, {"Time_Start": 1908.46, "Time_End": 1910.46, "Text": " You want to talk about MSSIP?"}, {"Time_Start": 1910.46, "Time_End": 1911.46, "Text": " Oh, sure."}, {"Time_Start": 1911.46, "Time_End": 1914.46, "Text": " As a version 2.2, you can actually automatically update the entire framework online."}, {"Time_Start": 1914.46, "Time_End": 1918.46, "Text": " So, and no it's not just a doctor, it's a way for you'd actually get in the latest exploits and whatnot, too."}, {"Time_Start": 1918.46, "Time_End": 1919.46, "Text": " whatnot too."}, {"Time_Start": 1919.46, "Time_End": 1922.6000000000001, "Text": " So if you go through, you're loving to go through and look at the code and verify things before we"}, {"Time_Start": 1922.6000000000001, "Time_End": 1924.1000000000001, "Text": " install it, et cetera, et cetera."}, {"Time_Start": 1924.1000000000001, "Time_End": 1927.08, "Text": " But essentially it'll do a, you know, NB5 Sum and all the files to pull it against your remote"}, {"Time_Start": 1927.08, "Time_End": 1929.22, "Text": " version, download any new files that you want."}, {"Time_Start": 1929.22, "Time_End": 1932.32, "Text": " And then it does it all through, you know, our own custom CA cert."}, {"Time_Start": 1932.32, "Time_End": 1936.1200000000001, "Text": " We actually define the OpenSEL search directory and do you just put everything we possibly can"}, {"Time_Start": 1936.1200000000001, "Time_End": 1939.06, "Text": " and pull the verify it's really the right system through SSO."}, {"Time_Start": 1939.06, "Time_End": 1941.7, "Text": " But, you know, you get your own risk as all's."}, {"Time_Start": 1941.7, "Time_End": 1948.22, "Text": " Okay, so then just a summary of that, you might just put it."}, {"Time_Start": 1948.46, "Time_End": 1952.3, "Text": " project would be a stable exploit development platform."}, {"Time_Start": 1952.3, "Time_End": 1956.7, "Text": " We've been working on it for a year, and a lot of other people in the end of our work has been"}, {"Time_Start": 1956.7, "Time_End": 1960.6200000000001, "Text": " coming in, and we've been sort of dragging people in and being like, hey, you know, try to write"}, {"Time_Start": 1960.6200000000001, "Time_End": 1963.96, "Text": " your exploit and medisploit, and they'll come back and be like, yeah, it's great, you know, I mean."}, {"Time_Start": 1963.96, "Time_End": 1968.22, "Text": " So we've had a lot of work, and it's now a very stable exploit development platform."}, {"Time_Start": 1968.22, "Time_End": 1973.5, "Text": " It's designed to use with pen tests, admins can use it to verify scan results."}, {"Time_Start": 1973.5, "Time_End": 1976.96, "Text": " And another thing is we're focused on technology, not money."}, {"Time_Start": 1976.96, "Time_End": 1978.44, "Text": " We don't have customers."}, {"Time_Start": 1978.46, "Time_End": 1981.96, "Text": " so we're not worried about, you know, getting the latest and greatest exploit."}, {"Time_Start": 1981.96, "Time_End": 1983.96, "Text": " We're not worried about, you know, this and that."}, {"Time_Start": 1983.96, "Time_End": 1986.46, "Text": " We're not worried about, you know, making a great glee on it."}, {"Time_Start": 1986.46, "Time_End": 1987.46, "Text": " That's not our main goals."}, {"Time_Start": 1987.46, "Time_End": 1991.46, "Text": " Right now we're working on just building a really good foundation, a lot of really good back-end technology."}, {"Time_Start": 1991.46, "Time_End": 1995.96, "Text": " And, you know, if it means working on something that we think is more important than"}, {"Time_Start": 1995.96, "Time_End": 1999.8600000000001, "Text": " working on the newest greatest exploit, you know, that was just advised, there was just an advisory"}, {"Time_Start": 1999.8600000000001, "Time_End": 2001.46, "Text": " for, then we'll probably do that."}, {"Time_Start": 2001.46, "Time_End": 2006.46, "Text": " And as of right now, we have $17 of donations for the last year at Vohman effort and bought us a pizza,"}, {"Time_Start": 2006.46, "Time_End": 2007.46, "Text": " so we're already happy with it, so, you know."}, {"Time_Start": 2007.46, "Time_End": 2007.96, "Text": " So, you know."}, {"Time_Start": 2007.96, "Time_End": 2008.46, "Text": " That's it."}, {"Time_Start": 2008.46, "Time_End": 2011.46, "Text": " We have $2 of donations left."}, {"Time_Start": 2011.46, "Time_End": 2015.46, "Text": " So there's been a lot of people working on this for about a year."}, {"Time_Start": 2015.46, "Time_End": 2019.46, "Text": " So if you use it or if your company uses it, feel free to donate."}, {"Time_Start": 2019.46, "Time_End": 2020.46, "Text": " We have a link on our website."}, {"Time_Start": 2020.46, "Time_End": 2022.46, "Text": " Now it goes straight into, you know, buy another spark station."}, {"Time_Start": 2022.46, "Time_End": 2026.46, "Text": " Do solar or your platform of choice if you specified in an email?"}, {"Time_Start": 2026.46, "Time_End": 2027.46, "Text": " So."}, {"Time_Start": 2027.46, "Time_End": 2031.46, "Text": " All right."}, {"Time_Start": 2031.46, "Time_End": 2034.46, "Text": " The next section is Expo Technology and we have a giant ninja on it."}, {"Time_Start": 2034.46, "Time_End": 2036.46, "Text": " So, yeah."}, {"Time_Start": 2036.46, "Time_End": 2039.46, "Text": " Yeah, it's kind of squished, but it's supposed to be Ninja."}, {"Time_Start": 2039.46, "Time_End": 2041.46, "Text": " Monkey Ninja, got it."}, {"Time_Start": 2041.46, "Time_End": 2045.46, "Text": " So mostly the interesting part of the framework,"}, {"Time_Start": 2045.46, "Time_End": 2047.46, "Text": " I'm sure everyone's probably heard something about,"}, {"Time_Start": 2047.46, "Time_End": 2049.46, "Text": " is the remote DOL injection."}, {"Time_Start": 2049.46, "Time_End": 2052.46, "Text": " This is nice and evil because it drops the DOL"}, {"Time_Start": 2052.46, "Time_End": 2055.46, "Text": " into the exploited process as a new thread."}, {"Time_Start": 2055.46, "Time_End": 2057.46, "Text": " It never touches the hard drive, and if you look at the process"}, {"Time_Start": 2057.46, "Time_End": 2059.46, "Text": " you're not going to see anything at all."}, {"Time_Start": 2059.46, "Time_End": 2062.46, "Text": " Antivirus people hate us for this because they can't do any scanning of it"}, {"Time_Start": 2062.46, "Time_End": 2064.46, "Text": " because they scan on access."}, {"Time_Start": 2064.46, "Time_End": 2065.46, "Text": " And since there is no access to the file itself,"}, {"Time_Start": 2065.46, "Time_End": 2066.46, "Text": " to the file itself."}, {"Time_Start": 2066.46, "Time_End": 2067.46, "Text": " They don't see anything all."}, {"Time_Start": 2067.46, "Time_End": 2068.46, "Text": " And my phone is really annoying."}, {"Time_Start": 2068.46, "Time_End": 2069.46, "Text": " Sorry."}, {"Time_Start": 2069.46, "Time_End": 2070.46, "Text": " Oh."}, {"Time_Start": 2070.46, "Time_End": 2071.46, "Text": " Okay."}, {"Time_Start": 2071.46, "Time_End": 2072.46, "Text": " I guess that doesn't like files the disk."}, {"Time_Start": 2072.46, "Time_End": 2074.46, "Text": " It was actually written by Jarko and Matt Miller."}, {"Time_Start": 2074.46, "Time_End": 2075.46, "Text": " Matt Miller."}, {"Time_Start": 2075.46, "Time_End": 2078.46, "Text": " Matt Miller is probably similar in those crowds."}, {"Time_Start": 2078.46, "Time_End": 2083.46, "Text": " If you see him at the anomaly table, you know, say, you know, hey, your code rocks."}, {"Time_Start": 2083.46, "Time_End": 2085.46, "Text": " There he is."}, {"Time_Start": 2085.46, "Time_End": 2086.46, "Text": " Got him."}, {"Time_Start": 2086.46, "Time_End": 2087.46, "Text": " Okay."}, {"Time_Start": 2087.46, "Time_End": 2091.46, "Text": " The nice thing about writing DOLP payroll is you've got full access"}, {"Time_Start": 2091.46, "Time_End": 2094.46, "Text": " of the Windows API inside the exploited process."}, {"Time_Start": 2094.46, "Time_End": 2095.46, "Text": " One of the big things."}, {"Time_Start": 2095.46, "Time_End": 2100.46, "Text": " and some of the core ST guys were talking about with the Cisco proxy code is that when you exploit a process in the windows,"}, {"Time_Start": 2100.46, "Time_End": 2104.46, "Text": " if you just work a command shell, you're throwing away half your privileges."}, {"Time_Start": 2104.46, "Time_End": 2108.46, "Text": " A lot of times if you exploit something like a web server or an FTP server for another process,"}, {"Time_Start": 2108.46, "Time_End": 2111.46, "Text": " that process actually has access to a lot more resources than you would have"}, {"Time_Start": 2111.46, "Time_End": 2113.46, "Text": " if you just execute a command shell itself."}, {"Time_Start": 2113.46, "Time_End": 2117.46, "Text": " In other words, it probably has access to another, an impersonation thread,"}, {"Time_Start": 2117.46, "Time_End": 2121.46, "Text": " excuse me, impersonation token in one of its threads inside the primary token itself,"}, {"Time_Start": 2121.46, "Time_End": 2124.46, "Text": " inside the primary token of the process itself."}, {"Time_Start": 2124.46, "Time_End": 2125.46, "Text": " And with that token,"}, {"Time_Start": 2125.46, "Time_End": 2129.32, "Text": " you could probably gain system access or access to one of the network users in the system."}, {"Time_Start": 2129.32, "Time_End": 2133.06, "Text": " And if you just have seen a command shell, like everyone's doing in the exports like DCCOM and whatnot,"}, {"Time_Start": 2133.06, "Time_End": 2135.26, "Text": " you're losing what other privileges you have there."}, {"Time_Start": 2135.26, "Time_End": 2138.96, "Text": " So by running a DL, which takes advantage of those privileges, by scanning all processes,"}, {"Time_Start": 2138.96, "Time_End": 2142.86, "Text": " by, you know, iterating through all processes, trying to open them up and grab the primary tokens,"}, {"Time_Start": 2142.86, "Time_End": 2146.46, "Text": " and then taking over those tokens, you can actually do a lot more evil things on the Windows platform"}, {"Time_Start": 2146.46, "Time_End": 2148.46, "Text": " by using DRL injection instead."}, {"Time_Start": 2148.46, "Time_End": 2151.96, "Text": " And you can easily convert any code that's written in C or C++ to a payload."}, {"Time_Start": 2151.96, "Time_End": 2155.44, "Text": " We've actually done DL development from XMINGW on a Linux."}, {"Time_Start": 2155.46, "Time_End": 2159.46, "Text": " box and then use those payloads directly on a Windows server as the RDRL payloads."}, {"Time_Start": 2159.46, "Time_End": 2163.46, "Text": " And you can definitely read as existing code like the next slide is going to show you."}, {"Time_Start": 2163.46, "Time_End": 2168.46, "Text": " And one important thing about the full access to the Windows API is instead of having to re-implement a lot of stuff in shell code,"}, {"Time_Start": 2168.46, "Time_End": 2174.46, "Text": " or just in shell code generally when you're trying to access the Windows API, it isn't necessarily the most nice thing to do."}, {"Time_Start": 2174.46, "Time_End": 2176.46, "Text": " It's sort of a pain to write."}, {"Time_Start": 2176.46, "Time_End": 2178.46, "Text": " So we have access to the full Windows API."}, {"Time_Start": 2178.46, "Time_End": 2182.46, "Text": " So for example, crypto, we can just open one of the Windows Crypto libraries, you know, download a file from the web,"}, {"Time_Start": 2182.46, "Time_End": 2185.46, "Text": " you know, they have libraries for that, SSL, I mean,"}, {"Time_Start": 2185.46, "Time_End": 2187.46, "Text": " Windows has libraries for a lot of things."}, {"Time_Start": 2187.46, "Time_End": 2189.46, "Text": " So by writing your code as a visual,"}, {"Time_Start": 2189.46, "Time_End": 2193.46, "Text": " running your code as a DRL, you can literally write your code right in Visual Studio,"}, {"Time_Start": 2193.46, "Time_End": 2195.46, "Text": " compile it down to a DL, and shovel it across the network."}, {"Time_Start": 2195.46, "Time_End": 2197.46, "Text": " So you have access to anything you would"}, {"Time_Start": 2197.46, "Time_End": 2201.46, "Text": " as if you're writing applications on the Windows platform just as an executable."}, {"Time_Start": 2201.46, "Time_End": 2209.46, "Text": " So one of the coolest things we've actually done using this DL injection technology"}, {"Time_Start": 2209.46, "Time_End": 2212.46, "Text": " is the Windows VNC server inject."}, {"Time_Start": 2212.46, "Time_End": 2214.46, "Text": " The VNC server is a new thread."}, {"Time_Start": 2214.46, "Time_End": 2219.46, "Text": " thread, uses the existing payload connection, it doesn't require a new connection, doesn't listen on a port."}, {"Time_Start": 2219.46, "Time_End": 2223.46, "Text": " It's based on the real VNC source code. This was actually a really fast process. They went out,"}, {"Time_Start": 2223.46, "Time_End": 2228.46, "Text": " grabbed the real VNC source code, hacked on a little bit. I mean, it was compiling down to DL very quickly."}, {"Time_Start": 2228.46, "Time_End": 2233.46, "Text": " It's a little slow right now because of the way the hooking has to be done since the DRL isn't on disk."}, {"Time_Start": 2233.46, "Time_End": 2237.46, "Text": " But it's very functional, as you'll see in a few minutes, and it was a pretty quick process."}, {"Time_Start": 2237.46, "Time_End": 2243.46, "Text": " They did some hacks, for example, the hijacked locked rear stations and hijacked workstations that aren't logged in."}, {"Time_Start": 2243.46, "Time_End": 2247.46, "Text": " in. This is adapted by Scape and HD."}, {"Time_Start": 2247.46, "Time_End": 2249.46, "Text": " As I said, it breaks lock, dusttops."}, {"Time_Start": 2249.46, "Time_End": 2252.46, "Text": " And, I mean, it's pretty cool that you can just go out and grab an open source project"}, {"Time_Start": 2252.46, "Time_End": 2255.46, "Text": " and, you know, back on all of this work and make a totally rad payload."}, {"Time_Start": 2255.46, "Time_End": 2257.46, "Text": " And we're not installing VNC, you know."}, {"Time_Start": 2257.46, "Time_End": 2259.46, "Text": " I mean, we're not, we're actually, it's completely never touching disk,"}, {"Time_Start": 2259.46, "Time_End": 2262.46, "Text": " it's never leaving memory, and it's just in the process that we're exporting,"}, {"Time_Start": 2262.46, "Time_End": 2265.46, "Text": " not creating any new process or anything."}, {"Time_Start": 2265.46, "Time_End": 2266.46, "Text": " Question, bye."}, {"Time_Start": 2266.46, "Time_End": 2267.46, "Text": " Sorry."}, {"Time_Start": 2273.46, "Time_End": 2282.46, "Text": " The thing that for the worm development, the thing is, we actually had some concerns when the people who wrote it,"}, {"Time_Start": 2282.46, "Time_End": 2285.46, "Text": " originally wanted to release it, especially because from an antiviracy perspective,"}, {"Time_Start": 2285.46, "Time_End": 2289.46, "Text": " it's very hard without actually being inside of the process which antiviruses aren't."}, {"Time_Start": 2289.46, "Time_End": 2293.46, "Text": " So because it's not doing a lot of the normal things in loading the library,"}, {"Time_Start": 2293.46, "Time_End": 2296.46, "Text": " it can actually circumvent a lot of different antivirus techniques."}, {"Time_Start": 2296.46, "Time_End": 2300.46, "Text": " But the thing is right now, it's integrated in Metisplate, and it's actually a three-stage process."}, {"Time_Start": 2300.46, "Time_End": 2302.46, "Text": " We have a stager, we have the VNC loader, and we have a BNC DOL."}, {"Time_Start": 2302.46, "Time_End": 2303.46, "Text": " The VNC."}, {"Time_Start": 2303.46, "Time_End": 2305.46, "Text": " CDL is like, you know, 400K."}, {"Time_Start": 2305.46, "Time_End": 2307.46, "Text": " There's a lot of clues the architecture that comes along with it."}, {"Time_Start": 2307.46, "Time_End": 2310.46, "Text": " And it's all written in Pearl, and it's not really something"}, {"Time_Start": 2310.46, "Time_End": 2314.46, "Text": " that you're going to be able to take and stick in a worm, really, at all."}, {"Time_Start": 2314.46, "Time_End": 2316.46, "Text": " We're not too worried about that."}, {"Time_Start": 2316.46, "Time_End": 2318.46, "Text": " We've thought a lot about it before we released the technology."}, {"Time_Start": 2318.46, "Time_End": 2325.46, "Text": " And, you could, I guess, in theory, but I don't expect to see it any time soon."}, {"Time_Start": 2325.46, "Time_End": 2331.46, "Text": " And there's not really any point you don't need that much technology for a worm that's really just overhead."}, {"Time_Start": 2331.46, "Time_End": 2332.46, "Text": " I mean, they have a, usually a small."}, {"Time_Start": 2332.46, "Time_End": 2336.7, "Text": " have usually a small, specific task that they can just write and do anyway."}, {"Time_Start": 2336.7, "Time_End": 2344.46, "Text": " If you look at things like the slam worm or whatnot, I mean, it was like 400 bytes or so that was just in memory, never charged a disc, not the same issue, which is a lot smaller."}, {"Time_Start": 2344.46, "Time_End": 2350.46, "Text": " If someone who's a really, really bad virus writer wanted to write a worm and they couldn't fit it into, you know, a couple thousand bytes,"}, {"Time_Start": 2350.46, "Time_End": 2355.46, "Text": " and they might do something like DLL injection to do it, but it's really just a statement that they can't write the code small enough."}, {"Time_Start": 2355.46, "Time_End": 2358.46, "Text": " I'm sorry, did you have a question as well?"}, {"Time_Start": 2358.46, "Time_End": 2361.46, "Text": " Okay, sorry."}, {"Time_Start": 2361.46, "Time_End": 2365.46, "Text": " I pretty much repeated the question by answering it."}, {"Time_Start": 2365.46, "Time_End": 2371.46, "Text": " He asked if we thought about using the DRL injection for worm development."}, {"Time_Start": 2371.46, "Time_End": 2376.46, "Text": " So, we'll go ahead and show a VNC demo."}, {"Time_Start": 2376.46, "Time_End": 2380.46, "Text": " Right now on the screen, you see the Mac."}, {"Time_Start": 2380.46, "Time_End": 2385.46, "Text": " We're actually going to own Windows box through the LSASS S plug from the Mac."}, {"Time_Start": 2385.46, "Time_End": 2390.46, "Text": " It's going to own it, use, create a reverse connection, on that connection we're going to send a"}, {"Time_Start": 2390.46, "Time_End": 2395.46, "Text": " On that connection, we're going to send a VNC injection code, and then the DOL."}, {"Time_Start": 2395.46, "Time_End": 2401.46, "Text": " And then we're going to set a local proxy on our side, so then we're just going to connect a local host for a VNC client,"}, {"Time_Start": 2401.46, "Time_End": 2404.46, "Text": " and we'll have VNC access remotely to the machine that we just owned."}, {"Time_Start": 2404.46, "Time_End": 2406.46, "Text": " So we'll go ahead and demo right now."}, {"Time_Start": 2406.46, "Time_End": 2410.46, "Text": " And watch the desktop that the VNC server gets installed on, notice no one's logged into it,"}, {"Time_Start": 2410.46, "Time_End": 2414.46, "Text": " and it's really funny to see what happens to this desktop after you hit it with the VNC server."}, {"Time_Start": 2414.46, "Time_End": 2419.46, "Text": " Anyone walking at the console might be a little bit confused, but just wait."}, {"Time_Start": 2420.46, "Time_End": 2427.46, "Text": " Probably bump the font a little bit."}, {"Time_Start": 2427.46, "Time_End": 2432.46, "Text": " Okay."}, {"Time_Start": 2432.46, "Time_End": 2433.46, "Text": " Okay."}, {"Time_Start": 2433.46, "Time_End": 2436.46, "Text": " There's the reason."}, {"Time_Start": 2436.46, "Time_End": 2440.46, "Text": " I'm trying to get the font in this you can actually see it."}, {"Time_Start": 2440.46, "Time_End": 2443.46, "Text": " And ignore that."}, {"Time_Start": 2443.46, "Time_End": 2444.46, "Text": " Okay."}, {"Time_Start": 2444.46, "Time_End": 2449.46, "Text": " So we're just going to head and start MSF console here and set up, I'll learn, navigate, well,"}, {"Time_Start": 2449.46, "Time_End": 2452.46, "Text": " navigate while, or narrate while HD navigates."}, {"Time_Start": 2452.46, "Time_End": 2455.46, "Text": " So you can just go ahead and we're going to start MSF console,"}, {"Time_Start": 2455.46, "Time_End": 2458.46, "Text": " which is, again, they're saying the preferred interface."}, {"Time_Start": 2458.46, "Time_End": 2460.46, "Text": " You can see this is the metisport running on this side,"}, {"Time_Start": 2460.46, "Time_End": 2464.46, "Text": " and that's the machine that's about to get owned on the left side."}, {"Time_Start": 2464.46, "Time_End": 2467.46, "Text": " So we're spreading the console interface."}, {"Time_Start": 2467.46, "Time_End": 2473.46, "Text": " Then let's just go ahead and use export when you use LSAS, for example."}, {"Time_Start": 2473.46, "Time_End": 2477.46, "Text": " So, oh, and Navo Python's as well."}, {"Time_Start": 2477.46, "Time_End": 2478.46, "Text": " But we have Python support enabled right now."}, {"Time_Start": 2478.46, "Time_End": 2481.46, "Text": " support enabled right now, it's enabled by default, so it's a little bit slower."}, {"Time_Start": 2481.46, "Time_End": 2483.46, "Text": " So then just like a show options."}, {"Time_Start": 2483.46, "Time_End": 2486.46, "Text": " Show options will show the options."}, {"Time_Start": 2486.46, "Time_End": 2491.46, "Text": " Right now, everything was saved, and we had options already set up."}, {"Time_Start": 2491.46, "Time_End": 2494.46, "Text": " And because the environment, you can save the environment to disk,"}, {"Time_Start": 2494.46, "Time_End": 2496.46, "Text": " it's going to automatically fill the options back in."}, {"Time_Start": 2496.46, "Time_End": 2498.46, "Text": " You can save from show options."}, {"Time_Start": 2498.46, "Time_End": 2502.46, "Text": " You'll see all the options that are available, both of the exploit,"}, {"Time_Start": 2502.46, "Time_End": 2505.46, "Text": " and then when you set up payload, the payload has its own set of options."}, {"Time_Start": 2505.46, "Time_End": 2507.46, "Text": " So, example, on the top you have the export options."}, {"Time_Start": 2507.46, "Time_End": 2512.46, "Text": " options, and on the bottom of the options, which are specific to the VNC injection code."}, {"Time_Start": 2512.46, "Time_End": 2529.46, "Text": " There's a good debugging set, so we're turning it off, so it's a little nicer output."}, {"Time_Start": 2529.46, "Time_End": 2534.46, "Text": " So then you can see these are the options set up, ready to go."}, {"Time_Start": 2534.46, "Time_End": 2536.46, "Text": " We have a remote hose setup."}, {"Time_Start": 2536.46, "Time_End": 2538.46, "Text": " remote port that we're attacking."}, {"Time_Start": 2538.46, "Time_End": 2539.46, "Text": " Those are the top options."}, {"Time_Start": 2539.46, "Time_End": 2542.46, "Text": " And then the bottom options, we have the parent information,"}, {"Time_Start": 2542.46, "Time_End": 2545.46, "Text": " the IP address that they're going to connect back to,"}, {"Time_Start": 2545.46, "Time_End": 2549.46, "Text": " the port we're going to set the VNC listener on our side on,"}, {"Time_Start": 2549.46, "Time_End": 2553.46, "Text": " the reload port they're going to connect back on to the VNC connection,"}, {"Time_Start": 2553.46, "Time_End": 2556.46, "Text": " and then the location of the VNC DOL."}, {"Time_Start": 2556.46, "Time_End": 2560.46, "Text": " So we're also going to show targets, and you can see that the target list"}, {"Time_Start": 2560.46, "Time_End": 2565.46, "Text": " zero is automatic, or automatically detect the LSOSS and exploit based on the response from the S&B."}, {"Time_Start": 2565.46, "Time_End": 2568.46, "Text": " the S&B transaction."}, {"Time_Start": 2568.46, "Time_End": 2571.46, "Text": " Otherwise, you may only go in and set Ether 2,000 or XP,"}, {"Time_Start": 2571.46, "Time_End": 2574.46, "Text": " but should hopefully work automatic."}, {"Time_Start": 2574.46, "Time_End": 2592.46, "Text": " Okay."}, {"Time_Start": 2592.46, "Time_End": 2594.46, "Text": " Okay."}, {"Time_Start": 2594.46, "Time_End": 2595.46, "Text": " Okay."}, {"Time_Start": 2595.46, "Time_End": 2601.46, "Text": " We owned, we got the connection back, we sent the DOL loader, we sent the DOL loader,"}, {"Time_Start": 2601.46, "Time_End": 2604.46, "Text": " we sent the DOL, everything worked."}, {"Time_Start": 2604.46, "Time_End": 2615.46, "Text": " A new session here."}, {"Time_Start": 2615.46, "Time_End": 2619.46, "Text": " Just local host."}, {"Time_Start": 2619.46, "Time_End": 2620.46, "Text": " Tada!"}, {"Time_Start": 2625.46, "Time_End": 2628.46, "Text": " around so they can see the login box behind it."}, {"Time_Start": 2628.46, "Time_End": 2632.46, "Text": " So another cool thing is it will actually hijack whoever's logged in."}, {"Time_Start": 2632.46, "Time_End": 2637.46, "Text": " So if you have a nonprivaged user login, for example, Bob, but you own the box's system,"}, {"Time_Start": 2637.46, "Time_End": 2639.46, "Text": " you don't want to lose your system privileges."}, {"Time_Start": 2639.46, "Time_End": 2642.46, "Text": " So we open a command window at the top that runs his system."}, {"Time_Start": 2642.46, "Time_End": 2646.46, "Text": " So if you're hijacking Bob's desktop, you still have access to system because we pop up a system command box."}, {"Time_Start": 2646.46, "Time_End": 2648.46, "Text": " We just go ahead, open to explore."}, {"Time_Start": 2648.46, "Time_End": 2653.46, "Text": " We can configure the server if we want, but I think we'll skip that for demonstration purposes."}, {"Time_Start": 2653.46, "Time_End": 2654.46, "Text": " Of course, he's doing this from the Mac."}, {"Time_Start": 2654.46, "Time_End": 2659.46, "Text": " this from the Mac, as you can see here, and you can see the actual VMO over there."}, {"Time_Start": 2659.46, "Time_End": 2663.46, "Text": " So, this is all in memory."}, {"Time_Start": 2663.46, "Time_End": 2665.46, "Text": " Nothing got wrote to this."}, {"Time_Start": 2665.46, "Time_End": 2668.46, "Text": " The DOL is nowhere except inside of LSS right now."}, {"Time_Start": 2668.46, "Time_End": 2673.46, "Text": " If you do a task list for everything, there's no new processes, it's just LSSSS."}, {"Time_Start": 2673.46, "Time_End": 2676.46, "Text": " And then if you apply some other techniques with DL stuff,"}, {"Time_Start": 2676.46, "Time_End": 2681.46, "Text": " like anti-debugging or anti-paging, this is really a forensics nightmare."}, {"Time_Start": 2681.46, "Time_End": 2687.46, "Text": " Anyone walk into the console of the system, is you going to see a desktop on the box that's not logged in?"}, {"Time_Start": 2687.46, "Time_End": 2691.46, "Text": " In the case that they actually do make control out delete, it still works."}, {"Time_Start": 2691.46, "Time_End": 2694.46, "Text": " They can actually log into the box if they want to and get their own desktop."}, {"Time_Start": 2694.46, "Time_End": 2698.46, "Text": " And then when they switch back and log back off, they end it back on the desktop of the system again."}, {"Time_Start": 2698.46, "Time_End": 2702.46, "Text": " So the thing is if you actually log off from this desktop, the box goes into kind of a,"}, {"Time_Start": 2702.46, "Time_End": 2704.46, "Text": " Windows doesn't like it very much."}, {"Time_Start": 2704.46, "Time_End": 2705.46, "Text": " It doesn't really know what to do."}, {"Time_Start": 2705.46, "Time_End": 2708.46, "Text": " You've got a mouse and all kinds of random, weird flickering windows,"}, {"Time_Start": 2708.46, "Time_End": 2710.46, "Text": " but it doesn't really know what to do with them."}, {"Time_Start": 2710.46, "Time_End": 2711.46, "Text": " So if you have a box, you have a mouse."}, {"Time_Start": 2711.46, "Time_End": 2712.46, "Text": " it's a fun thing to play."}, {"Time_Start": 2712.46, "Time_End": 2716.46, "Text": " And then since we're doing DL stuff, we have a lot of access to the Windows API."}, {"Time_Start": 2716.46, "Time_End": 2719.46, "Text": " We were thinking about some other techniques, for example, like, you know,"}, {"Time_Start": 2719.46, "Time_End": 2723.46, "Text": " disabling the video driver actually on the hardware, so, you know, the screen sort of goes into power-saving mode"}, {"Time_Start": 2723.46, "Time_End": 2726.46, "Text": " while we're out there, we're viewing in, and then we can enable, let us we leave."}, {"Time_Start": 2726.46, "Time_End": 2730.46, "Text": " Something that, from the way we're talking about, is if you take a screenshot of the desktop"}, {"Time_Start": 2730.46, "Time_End": 2735.46, "Text": " before we install the shell on it by using the VNC's display capture,"}, {"Time_Start": 2735.46, "Time_End": 2738.46, "Text": " then forcing that to be the display of the system that we're attacking,"}, {"Time_Start": 2738.46, "Time_End": 2740.46, "Text": " while we're actually doing our own thing."}, {"Time_Start": 2740.46, "Time_End": 2741.46, "Text": " So they never notice the desktop."}, {"Time_Start": 2741.46, "Time_End": 2742.46, "Text": " doing anything whatsoever."}, {"Time_Start": 2742.46, "Time_End": 2745.7, "Text": " But we're still in the process trying to hit where we'll actually implement that and, you know,"}, {"Time_Start": 2745.7, "Time_End": 2747.7, "Text": " it's Windows API, it's other."}, {"Time_Start": 2747.7, "Time_End": 2751.9, "Text": " And besides just flashy demos, this is actually useful in a lot of different levels."}, {"Time_Start": 2751.9, "Time_End": 2754.7, "Text": " For example, hijacking the desktop can be very, very valuable."}, {"Time_Start": 2754.7, "Time_End": 2758.26, "Text": " Like, for example, I mean, getting system isn't always what you want."}, {"Time_Start": 2758.26, "Time_End": 2761.54, "Text": " For example, if someone's logged in with domain credentials, owning system isn't going to"}, {"Time_Start": 2761.54, "Time_End": 2762.54, "Text": " get you those domain credentials."}, {"Time_Start": 2762.54, "Time_End": 2767.06, "Text": " It could lead to that by, you know, doing some stuff and hijacking a login session or something."}, {"Time_Start": 2767.06, "Time_End": 2769.2200000000003, "Text": " But with this, you could just actually get the user that was logged in."}, {"Time_Start": 2769.2200000000003, "Time_End": 2771.06, "Text": " For example, you know, a banking scenario where, you know, a banking scenario where you're"}, {"Time_Start": 2771.06, "Time_End": 2775.06, "Text": " where you have a client who may be logged in to a domain and they're sitting there with a"}, {"Time_Start": 2775.06, "Time_End": 2778.06, "Text": " thick app, you know, a custom written app that they use for transactions."}, {"Time_Start": 2778.06, "Time_End": 2781.06, "Text": " You can just own it and get there, and now you have this software, you have everything,"}, {"Time_Start": 2781.06, "Time_End": 2784.06, "Text": " and you can just view and see the real remote and watch them for a couple of days."}, {"Time_Start": 2784.06, "Time_End": 2786.06, "Text": " You know, and they can see what they do, collect information,"}, {"Time_Start": 2786.06, "Time_End": 2791.06, "Text": " and you can come back and have access to a lot of those things that getting a system prop just doesn't do."}, {"Time_Start": 2791.06, "Time_End": 2799.06, "Text": " So, I mean, besides just flashy dumbas, this has a ton of very, very practical, cool uses for Penn tests and, you know, that sort of purposes."}, {"Time_Start": 2799.06, "Time_End": 2803.06, "Text": " Are there any questions on this sort of stuff?"}, {"Time_Start": 2803.06, "Time_End": 2805.06, "Text": " Yep."}, {"Time_Start": 2805.06, "Time_End": 2811.06, "Text": " What happens is that we get the initial connection back"}, {"Time_Start": 2811.06, "Time_End": 2814.06, "Text": " back, which is a stageer, like I was talking about,"}, {"Time_Start": 2814.06, "Time_End": 2821.06, "Text": " and we send the stage, which is the VNC loader written by Matt Miller."}, {"Time_Start": 2821.06, "Time_End": 2824.06, "Text": " And what that does is it expects a DL coming over the wire."}, {"Time_Start": 2824.06, "Time_End": 2826.06, "Text": " So that same connection, we then actually just send,"}, {"Time_Start": 2826.06, "Time_End": 2828.06, "Text": " read, and send the physical DL,"}, {"Time_Start": 2828.06, "Time_End": 2832.06, "Text": " 100% complete to, we send a size first and then send the DOL,"}, {"Time_Start": 2832.06, "Time_End": 2837.06, "Text": " to the VNC inject code, then is running on a server,"}, {"Time_Start": 2837.06, "Time_End": 2840.06, "Text": " or on the own machine, and then it actually goes through,"}, {"Time_Start": 2840.06, "Time_End": 2843.06, "Text": " and we'll take that raw DL and mapped into memory and everything like that."}, {"Time_Start": 2843.06, "Time_End": 2845.06, "Text": " So that's what the VNC loader does."}, {"Time_Start": 2845.06, "Time_End": 2850.06, "Text": " What do you mean?"}, {"Time_Start": 2850.06, "Time_End": 2853.06, "Text": " It will actually create new thread and start the VNC,"}, {"Time_Start": 2853.06, "Time_End": 2856.06, "Text": " it will call the start method on the VNC,"}, {"Time_Start": 2856.06, "Time_End": 2857.06, "Text": " on the DL we're loading."}, {"Time_Start": 2857.06, "Time_End": 2858.06, "Text": " DLR we're loading."}, {"Time_Start": 2858.06, "Time_End": 2862.06, "Text": " So we set here through that and actually start the DLR we inject."}, {"Time_Start": 2862.06, "Time_End": 2863.06, "Text": " Okay."}, {"Time_Start": 2863.06, "Time_End": 2868.06, "Text": " If it goes, the actual connection itself it uses is whatever the original connection was."}, {"Time_Start": 2868.06, "Time_End": 2871.06, "Text": " So if you use it when a bind shell, it will then do the V&C across the same connection."}, {"Time_Start": 2871.06, "Time_End": 2873.06, "Text": " If you use a reverse shell, it does that as well."}, {"Time_Start": 2873.06, "Time_End": 2878.06, "Text": " The question in the back of the end of the glasses."}, {"Time_Start": 2878.06, "Time_End": 2886.06, "Text": " The question was, is, was it a new process or a new thread or?"}, {"Time_Start": 2886.06, "Time_End": 2887.06, "Text": " Yeah."}, {"Time_Start": 2887.06, "Time_End": 2888.06, "Text": " It's just a new thread."}, {"Time_Start": 2888.06, "Time_End": 2892.06, "Text": " So right now, you know, LSA-SS may normally have like five threads and now it has six."}, {"Time_Start": 2892.06, "Time_End": 2894.06, "Text": " So we're just starting a new thread inside of LSSS."}, {"Time_Start": 2894.06, "Time_End": 2898.06, "Text": " We're completely inside of LSS right now, which is used for a lot of other techniques."}, {"Time_Start": 2898.06, "Time_End": 2904.06, "Text": " Say if you had some DOL code that could maybe, you know, get secrets out of LSS because that's what LSA does."}, {"Time_Start": 2904.06, "Time_End": 2909.06, "Text": " So, you know, maybe you have VNC that actually could use whatever you're exploiting for some reason."}, {"Time_Start": 2909.06, "Time_End": 2912.06, "Text": " So we're actually staying completely in the original process."}, {"Time_Start": 2912.06, "Time_End": 2913.06, "Text": " We're not destroying it."}, {"Time_Start": 2913.06, "Time_End": 2916.06, "Text": " It's intact for the most part depending on the exploit, and it's still running."}, {"Time_Start": 2916.06, "Time_End": 2917.06, "Text": " It's still running."}, {"Time_Start": 2917.06, "Time_End": 2919.06, "Text": " LSSS."}, {"Time_Start": 2919.06, "Time_End": 2921.06, "Text": " One of the other DOLs we're using for testing right now,"}, {"Time_Start": 2921.06, "Time_End": 2923.06, "Text": " we'll actually list all available processes,"}, {"Time_Start": 2923.06, "Time_End": 2926.06, "Text": " tell you the primary token owner of that process,"}, {"Time_Start": 2926.06, "Time_End": 2928.06, "Text": " like the user that each process is associated with,"}, {"Time_Start": 2928.06, "Time_End": 2930.06, "Text": " and give the ability to launch a process as that user."}, {"Time_Start": 2930.06, "Time_End": 2932.06, "Text": " So if we inject a thread inside LSSS,"}, {"Time_Start": 2932.06, "Time_End": 2935.06, "Text": " since LSS is access to everything, including LSS"}, {"Time_Start": 2935.06, "Time_End": 2938.06, "Text": " secrets itself and memory, we can actually whip those memory secrets"}, {"Time_Start": 2938.06, "Time_End": 2940.06, "Text": " out and dump them out to the remote attacker,"}, {"Time_Start": 2940.06, "Time_End": 2943.06, "Text": " or we can just hijack any other process so that process can access."}, {"Time_Start": 2943.06, "Time_End": 2945.06, "Text": " So that, Toby?"}, {"Time_Start": 2945.06, "Time_End": 2963.06, "Text": " The question was whether by exploring LOSS we can actually hijack and listen to all the log-on requests in the system."}, {"Time_Start": 2963.06, "Time_End": 2968.06, "Text": " And actually, yeah, because OSSSS uses the GINA DOL to actually do the password authentication,"}, {"Time_Start": 2968.06, "Time_End": 2975.06, "Text": " we can just bypass that by patching LSS directly in memory or hijacking the actual NT port it uses on an underlying system to actually sniff LSISS"}, {"Time_Start": 2975.06, "Time_End": 2977.06, "Text": " request, or stuff log on requests."}, {"Time_Start": 2977.06, "Time_End": 2978.06, "Text": " Oh, sorry."}, {"Time_Start": 2978.06, "Time_End": 2982.06, "Text": " And also because this is a real DL and it's being loaded correctly,"}, {"Time_Start": 2982.06, "Time_End": 2985.06, "Text": " you have access to a lot of things, you know, you can import other DOLs,"}, {"Time_Start": 2985.06, "Time_End": 2988.06, "Text": " you can access a lot of the, you know, things are set up correctly inside of the process"}, {"Time_Start": 2988.06, "Time_End": 2992.06, "Text": " for you as a DOL who will do a lot of things inside the process."}, {"Time_Start": 2992.06, "Time_End": 2994.06, "Text": " This, of course, would be custom things."}, {"Time_Start": 2994.06, "Time_End": 2995.06, "Text": " We don't have anything."}, {"Time_Start": 2995.06, "Time_End": 2997.06, "Text": " You know, I mean, I have the experts can be only a different process,"}, {"Time_Start": 2997.06, "Time_End": 2999.06, "Text": " and everything's going to be different based on the process."}, {"Time_Start": 2999.06, "Time_End": 3002.06, "Text": " But you have the ability to do a lot of really cool stuff,"}, {"Time_Start": 3002.06, "Time_End": 3005.06, "Text": " and you're writing your stuff in a DOL, and you're writing your stuff in a DOL, and, and, you know,"}, {"Time_Start": 3005.06, "Time_End": 3006.06, "Text": " and that's pretty much it."}, {"Time_Start": 3006.06, "Time_End": 3007.06, "Text": " Yeah."}, {"Time_Start": 3007.06, "Time_End": 3010.06, "Text": " So, the BAT server is you've actually in memory,"}, {"Time_Start": 3010.06, "Time_End": 3014.06, "Text": " and it's supposed to use power-free routes, it's gone on them?"}, {"Time_Start": 3014.06, "Time_End": 3018.06, "Text": " Well, yeah, of course, but you can just own it again, so."}, {"Time_Start": 3018.06, "Time_End": 3023.06, "Text": " Yeah, of course, it's not, you know, we're not setting it in startup scripts,"}, {"Time_Start": 3023.06, "Time_End": 3025.06, "Text": " we're not auto-starting or anything like that."}, {"Time_Start": 3025.06, "Time_End": 3028.06, "Text": " You could, of course, do it if your goal was to have some sort of long-term root kit."}, {"Time_Start": 3028.06, "Time_End": 3030.06, "Text": " But that isn't what this is."}, {"Time_Start": 3030.06, "Time_End": 3033.06, "Text": " This is, you know, a temporary, you know, a temporary, you know, shell."}, {"Time_Start": 3033.06, "Time_End": 3035.06, "Text": " Well, the only things about pen dosing is."}, {"Time_Start": 3035.06, "Time_End": 3039.06, "Text": " if you're installing a VNC server under a client system during a pent test, it's really annoying"}, {"Time_Start": 3039.06, "Time_End": 3041.06, "Text": " to go through and remove those files after you're done with it."}, {"Time_Start": 3041.06, "Time_End": 3044.06, "Text": " A lot of times because if you start the VNC server, so you can't delete the files,"}, {"Time_Start": 3044.06, "Time_End": 3047.06, "Text": " you stop the service again, the files are in use, and it's like a billion different"}, {"Time_Start": 3047.06, "Time_End": 3051.06, "Text": " things that it really annoy you when you're trying to install remote administration services in a compromised system."}, {"Time_Start": 3051.06, "Time_End": 3055.06, "Text": " With using it in shell code like this, after you're done, after you've exited your shell, that's it,"}, {"Time_Start": 3055.06, "Time_End": 3058.06, "Text": " there's no memory trace, there's nothing left from the box or so that you've ever been there."}, {"Time_Start": 3058.06, "Time_End": 3064.06, "Text": " The nice thing about the VNC DOL payload itself is that if you don't have system access and it tries pretty hard to"}, {"Time_Start": 3064.06, "Time_End": 3065.86, "Text": " and it tries pretty hard to get system access."}, {"Time_Start": 3065.86, "Time_End": 3069.06, "Text": " Like we're outing some more public escalation techniques into the near future,"}, {"Time_Start": 3069.06, "Time_End": 3070.7599999999998, "Text": " it'll actually alert to read-only mode."}, {"Time_Start": 3070.7599999999998, "Time_End": 3073.86, "Text": " So if you're exploiting an IAS bug, an IAS as well as an I user,"}, {"Time_Start": 3073.86, "Time_End": 3076.52, "Text": " you know, I user account, which has been a person named from I-WAM account,"}, {"Time_Start": 3076.52, "Time_End": 3078.46, "Text": " it'll do really work itself a good I-WAM user,"}, {"Time_Start": 3078.46, "Time_End": 3081.7599999999998, "Text": " and then for more it can actually has read access to the desktop."}, {"Time_Start": 3081.7599999999998, "Time_End": 3086.36, "Text": " So you can't actually read the keys of the desktop if we're not system yet,"}, {"Time_Start": 3086.36, "Time_End": 3088.7599999999998, "Text": " but we'll work in different ways to manipulate the API"}, {"Time_Start": 3088.7599999999998, "Time_End": 3091.96, "Text": " to get further into the system even if we're not in a system."}, {"Time_Start": 3091.96, "Time_End": 3092.92, "Text": " So we'll see how things go."}, {"Time_Start": 3092.92, "Time_End": 3094.04, "Text": " Hopefully the next few months, we can ask from"}, {"Time_Start": 3094.06, "Time_End": 3098.06, "Text": " really nice ways to either immediately get system access or do other bad things from a"}, {"Time_Start": 3098.06, "Time_End": 3099.06, "Text": " non-provised user account."}, {"Time_Start": 3099.06, "Time_End": 3102.06, "Text": " We're working on another system called a interpreter, which we'll talk about a little bit later."}, {"Time_Start": 3102.06, "Time_End": 3104.06, "Text": " That's more of a complete payload solution."}, {"Time_Start": 3104.06, "Time_End": 3106.06, "Text": " This is just our flash-y demo with E&C stuff."}, {"Time_Start": 3106.06, "Time_End": 3111.06, "Text": " It was actually put together very quickly, which goes to a test the very cool technology that it is."}, {"Time_Start": 3111.06, "Time_End": 3114.06, "Text": " Is there any way to do this on protected?"}, {"Time_Start": 3114.06, "Time_End": 3119.06, "Text": " We're going to go to a..."}, {"Time_Start": 3119.06, "Time_End": 3121.06, "Text": " Well, we're not pop up a show."}, {"Time_Start": 3121.06, "Time_End": 3124.04, "Text": " Well, we actually, the first thing we wanted to look at was actually creating a hearing"}, {"Time_Start": 3124.06, "Time_End": 3127.64, "Text": " background desktop on the system and actually provide any BNC access to that background"}, {"Time_Start": 3127.64, "Time_End": 3131.06, "Text": " desktop. What we ran into though and what actually what Matt found out when he started"}, {"Time_Start": 3131.06, "Time_End": 3134.94, "Text": " investigating this stuff was that there's limitation of the Windows system itself. You cannot"}, {"Time_Start": 3134.94, "Time_End": 3138.94, "Text": " read the screen of the non-interactive desktop. So the only desktop you can actually read the display"}, {"Time_Start": 3138.94, "Time_End": 3142.2999999999997, "Text": " of is the interactive desktop and there's only one of those on the system and that's what the physical"}, {"Time_Start": 3142.2999999999997, "Time_End": 3146.06, "Text": " mouse and keyboard are hooked into. The exception to that is terminal services."}, {"Time_Start": 3146.06, "Time_End": 3149.68, "Text": " But the thing is, the Microsoft designed the API in purpose that way, so you can't let your"}, {"Time_Start": 3149.68, "Time_End": 3154.0, "Text": " own custom terminal services services and compete against someone licensing. So it was a direct"}, {"Time_Start": 3154.06, "Time_End": 3157.34, "Text": " I mean, the capabilities are there to have multiple desktops and on most services"}, {"Time_Start": 3157.34, "Time_End": 3158.9, "Text": " create their own Windows station and desktop."}, {"Time_Start": 3158.9, "Time_End": 3162.5, "Text": " But you can't interact with that desktop, it was not the current input desktop."}, {"Time_Start": 3162.5, "Time_End": 3166.06, "Text": " So it drove us freaking nuts for like three days trying to figure out why we couldn't have access"}, {"Time_Start": 3166.06, "Time_End": 3167.2999999999997, "Text": " to this backend desktop."}, {"Time_Start": 3167.2999999999997, "Time_End": 3171.58, "Text": " And Matt actually wrote his own custom vance implementation on the back end where put bitmaps into"}, {"Time_Start": 3171.58, "Time_End": 3174.24, "Text": " into different desktops, tried to bring them back out, and we try to get it pretty hard."}, {"Time_Start": 3174.24, "Time_End": 3178.18, "Text": " We couldn't find a way to create our own custom hidden desktop and still interact with it."}, {"Time_Start": 3178.18, "Time_End": 3181.62, "Text": " And owning the actual real desktop is very useful."}, {"Time_Start": 3181.62, "Time_End": 3184.04, "Text": " And something like the interpreter stuff,"}, {"Time_Start": 3184.06, "Time_End": 3187.02, "Text": " talk about, you could, for example, have a module that, you know, you can see if there's"}, {"Time_Start": 3187.02, "Time_End": 3190.66, "Text": " any mouse movement or keystrokes or something, you know, and say 20 minutes, right?"}, {"Time_Start": 3190.66, "Time_End": 3192.72, "Text": " So you can say it's probably clear it owns with the mouse."}, {"Time_Start": 3192.72, "Time_End": 3194.56, "Text": " You can go and wait and then launch V&C."}, {"Time_Start": 3194.56, "Time_End": 3200.24, "Text": " You know, so you don't need to do it as the first stage, and that's what the more involved systems"}, {"Time_Start": 3200.24, "Time_End": 3202.24, "Text": " that will show later are kind of designed to address."}, {"Time_Start": 3202.24, "Time_End": 3208.24, "Text": " The next time we're going to talk about is the interchangeable payloads."}, {"Time_Start": 3208.24, "Time_End": 3211.66, "Text": " We mentioned this earlier, but essentially any exploit inside the framework, you can put any"}, {"Time_Start": 3211.66, "Time_End": 3212.94, "Text": " payload you feel like putting into it."}, {"Time_Start": 3212.94, "Time_End": 3217.58, "Text": " In other words, if for some reason you, you know, you've got a custom payload that works around"}, {"Time_Start": 3217.58, "Time_End": 3221.8, "Text": " the Kino system, the Cisco security agent, what happens to be, or you've got a payload that"}, {"Time_Start": 3221.8, "Time_End": 3225.06, "Text": " does something, you know, predefined, you really need to just do this one thing, like delete this file"}, {"Time_Start": 3225.06, "Time_End": 3226.76, "Text": " from the system and you don't want to do anything else."}, {"Time_Start": 3226.76, "Time_End": 3228.94, "Text": " You don't want to try to see the command shell, you don't want to do anything, you know,"}, {"Time_Start": 3228.94, "Time_End": 3232.8, "Text": " nifty, you just want to do one specific task, you can drop in a payload that does just that."}, {"Time_Start": 3232.8, "Time_End": 3237.32, "Text": " Additionally, if you have a payload which bypasses is not yes or, you know, what"}, {"Time_Start": 3237.32, "Time_End": 3240.08, "Text": " happens to be, or you're just, you know, writing a new shell code, you want to make sure"}, {"Time_Start": 3240.08, "Time_End": 3242.66, "Text": " it works correctly, you can take your shell code, drop it into it and go."}, {"Time_Start": 3242.66, "Time_End": 3247.3599999999997, "Text": " This approach has given us an advantage over commercial products, just core impact and"}, {"Time_Start": 3247.3599999999997, "Time_End": 3250.46, "Text": " immunity canvas, because they really only support their own payload."}, {"Time_Start": 3250.8599999999997, "Time_End": 3255.04, "Text": " What we really try to do is provide a way to do research and do testing of third-party"}, {"Time_Start": 3255.04, "Time_End": 3257.08, "Text": " payloads and help with the development process in a way."}, {"Time_Start": 3257.3799999999997, "Time_End": 3259.72, "Text": " You can actually, you know, verify that what you're writing works."}, {"Time_Start": 3260.3199999999997, "Time_End": 3263.3799999999997, "Text": " Because of that, we actually have a lot of redundant payloads, and those are actually on purpose."}, {"Time_Start": 3263.8599999999997, "Time_End": 3267.3799999999997, "Text": " We've got payloads to do a reverse connect one way, but they're able to reverse connect in the stage"}, {"Time_Start": 3267.3799999999997, "Time_End": 3267.7799999999997, "Text": " system."}, {"Time_Start": 3268.24, "Time_End": 3270.46, "Text": " We're at ones that are actually the same payloads as written in different ways."}, {"Time_Start": 3272.66, "Time_End": 3275.52, "Text": " I was just going to stay, we have an hour left, so I know some people are leaving,"}, {"Time_Start": 3275.62, "Time_End": 3278.58, "Text": " but just to make sure that people realize we do, we have a lot of other stuff."}, {"Time_Start": 3278.62, "Time_End": 3280.54, "Text": " We showed some of the flashy stuff first, but we'll go in depth,"}, {"Time_Start": 3280.7999999999997, "Time_End": 3285.1, "Text": " and we have some other demos, for example, owning OSX, which we're the first public exploits for"}, {"Time_Start": 3285.1, "Time_End": 3285.8999999999996, "Text": " and some other things."}, {"Time_Start": 3286.08, "Time_End": 3286.74, "Text": " So we're going to go ahead."}, {"Time_Start": 3286.74, "Time_End": 3287.96, "Text": " Well, it was, but they didn't work right."}, {"Time_Start": 3288.06, "Time_End": 3289.18, "Text": " So we'll go under them a little bit."}, {"Time_Start": 3290.16, "Time_End": 3293.72, "Text": " But just think we've got, you know, we include the universe bind, find exact, you know,"}, {"Time_Start": 3293.74, "Time_End": 3296.48, "Text": " exact payloads, the encrypted X-Oar command gels."}, {"Time_Start": 3296.58, "Time_End": 3301.3199999999997, "Text": " We actually took the inline egg sample provided by CoreC for the inline egg Python system"}, {"Time_Start": 3301.3199999999997, "Time_End": 3302.44, "Text": " and took it out."}, {"Time_Start": 3302.66, "Time_End": 3303.74, "Text": " straight into Metisboard and it works."}, {"Time_Start": 3304.18, "Time_End": 3307.3999999999996, "Text": " You have to be minimal modifications to get inline-Egg, payload,"}, {"Time_Start": 3307.7, "Time_End": 3309.7, "Text": " written in Python, working at the Metisport framework and Pearl,"}, {"Time_Start": 3310.08, "Time_End": 3311.72, "Text": " because we have our support for external payloads."}, {"Time_Start": 3312.12, "Time_End": 3314.1, "Text": " You can take any program that generates shell code output"}, {"Time_Start": 3314.1, "Time_End": 3316.18, "Text": " and integrate it in as a payload into the Metispray framework."}, {"Time_Start": 3316.64, "Time_End": 3318.52, "Text": " So if you've got a really nifty tool that you're working on"}, {"Time_Start": 3318.52, "Time_End": 3320.22, "Text": " and you don't want to write it in Pearl, that's cool."}, {"Time_Start": 3320.24, "Time_End": 3320.8199999999997, "Text": " You can still use it."}, {"Time_Start": 3321.46, "Time_End": 3324.64, "Text": " So, for example, we get back on Inline Egg is very similar to David Tells."}, {"Time_Start": 3324.8399999999997, "Time_End": 3328.12, "Text": " For example, if you had some sort of MoStf bill that you wanted to write,"}, {"Time_Start": 3328.46, "Time_End": 3330.3599999999997, "Text": " or, you know, your own payload system,"}, {"Time_Start": 3330.3599999999997, "Time_End": 3332.2, "Text": " or for somebody's and you want to do some sort of other"}, {"Time_Start": 3332.2000000000003, "Time_End": 3336.94, "Text": " complication dynamic generation of shell code, and it isn't written in parallel"}, {"Time_Start": 3336.94, "Time_End": 3340.1200000000003, "Text": " and you can't or don't want to integrate it directly into MetaSpoly, you can just"}, {"Time_Start": 3340.1200000000003, "Time_End": 3343.9, "Text": " have as an external program and we actually have a class called external payload that"}, {"Time_Start": 3343.9, "Time_End": 3347.44, "Text": " makes it very easy to do exactly the sort of stuff that we do with inline egg."}, {"Time_Start": 3351.44, "Time_End": 3354.4600000000005, "Text": " Oh, sorry, one thing that we've actually come up with with with Rehnick is, you know,"}, {"Time_Start": 3354.5600000000004, "Time_End": 3356.1400000000003, "Text": " sort of unique and somewhat interesting."}, {"Time_Start": 3356.6000000000004, "Time_End": 3358.78, "Text": " There's a lot of exports out there that a lot of I see the command show."}, {"Time_Start": 3359.36, "Time_End": 3361.92, "Text": " And, you know, okay, great, you can run a command, what it happens to be."}, {"Time_Start": 3362.2000000000003, "Time_End": 3365.38, "Text": " a lot of times you can't see the output, and people are voted doing things like, you know,"}, {"Time_Start": 3365.38, "Time_End": 3371.1400000000003, "Text": " an X-term dash display to get their shell back, or doing a, you know, a telmet pipe to bin"}, {"Time_Start": 3371.1400000000003, "Time_End": 3374.38, "Text": " shell, pipe to telmet again, and those are all great, but they're quite a lot of work in"}, {"Time_Start": 3374.38, "Time_End": 3378.34, "Text": " the user's part to set up, and, you know, it's just, it's really annoying to do in the first part."}, {"Time_Start": 3378.34, "Time_End": 3381.76, "Text": " What we've going to do is all the command exec payloads that we've included with the, excuse"}, {"Time_Start": 3381.76, "Time_End": 3386.2000000000003, "Text": " me, all the command execution payloads, where you're actually just injecting a command"}, {"Time_Start": 3386.2000000000003, "Time_End": 3387.6400000000003, "Text": " of natural shell code."}, {"Time_Start": 3387.6400000000003, "Time_End": 3390.82, "Text": " We've actually created a set of command underscore payloads, and that's just the name of them,"}, {"Time_Start": 3390.82, "Time_End": 3392.1800000000003, "Text": " so we're using this terminology for it."}, {"Time_Start": 3392.2000000000003, "Time_End": 3396.44, "Text": " that do things like a reverse connect or a bind shell or an executive or a lot of other little things."}, {"Time_Start": 3396.44, "Time_End": 3404.2000000000003, "Text": " And they actually implement like telnet, pipe, shell, pipe, telnet to be able to do a reverse connect style console,"}, {"Time_Start": 3404.2000000000003, "Time_End": 3406.2000000000003, "Text": " but all with a single unified console."}, {"Time_Start": 3406.2000000000003, "Time_End": 3413.2000000000003, "Text": " For instance, used, the Solaris, S-adminD export, including the framework, it'll actually cause solar, you know, with the Unix reverse generic payload."}, {"Time_Start": 3413.2000000000003, "Time_End": 3418.2000000000003, "Text": " What it will do is it does, it executes telnet to the system exploiting it on the IP address in the port,"}, {"Time_Start": 3418.2000000000003, "Time_End": 3422.1800000000003, "Text": " pipe, and then it calls, you know, bin shell again, then pipe, telmet, back,"}, {"Time_Start": 3422.2000000000003, "Time_End": 3427.2000000000003, "Text": " to the host on the same port again, and when the MSF console sees that, it then says, okay,"}, {"Time_Start": 3427.2000000000003, "Time_End": 3429.7400000000002, "Text": " I've got two connections coming in, I'm going to write some data to one of them to see which"}, {"Time_Start": 3429.7400000000002, "Time_End": 3430.4, "Text": " it ends it comes out."}, {"Time_Start": 3430.9, "Time_End": 3431.7400000000002, "Text": " And it sees that data coming out."}, {"Time_Start": 3431.78, "Time_End": 3435.3, "Text": " One of them says, okay, I know where my inputs and outputs are, and it glues those two handles together"}, {"Time_Start": 3435.3, "Time_End": 3436.94, "Text": " into a single unified console in front of you."}, {"Time_Start": 3437.34, "Time_End": 3441.34, "Text": " So in other words, if you're exploiting a system that's an IIS server and you pop over the roof shell and you've got a nice console,"}, {"Time_Start": 3441.6800000000003, "Time_End": 3444.82, "Text": " then you do an S-idmin-D exploit, you won't notice a difference at all in the console."}, {"Time_Start": 3444.9, "Time_End": 3447.9800000000005, "Text": " They work exactly the same because the way the console has been abstracted and used."}, {"Time_Start": 3448.42, "Time_End": 3451.9600000000005, "Text": " So if you've got a nice way to getting a command shell back to yourself or you want to do, like, you know,"}, {"Time_Start": 3451.96, "Time_End": 3458.42, "Text": " Instead of Telmet pipe shell, Telmet, you want to do a Telmet pipe shell, you know, run it through the TR command,"}, {"Time_Start": 3458.48, "Time_End": 3463.06, "Text": " a WOT 13-year output of it, you could do that, you know, trivially, just by adding a filter to the handler side of the payload."}, {"Time_Start": 3463.76, "Time_End": 3467.06, "Text": " So it's really easy to add, you know, custom command payloads do things like PSP exploits,"}, {"Time_Start": 3467.38, "Time_End": 3471.98, "Text": " SQL injection exploits, things like that, in a way that actually gives the user the ability to pick different types of payloads"}, {"Time_Start": 3471.98, "Time_End": 3474.68, "Text": " and still integrate them with weird command injection exploits."}, {"Time_Start": 3475.18, "Time_End": 3477.3, "Text": " Okay, so, yeah, this is for those bugs."}, {"Time_Start": 3477.4, "Time_End": 3480.98, "Text": " We're not actually executing arbitrary code, but you can somehow inject a command."}, {"Time_Start": 3480.98, "Time_End": 3482.82, "Text": " For example, webbugs and stuff like this."}, {"Time_Start": 3483.86, "Time_End": 3488.22, "Text": " Not just the coolness of metasport, but it's actually just a good resource."}, {"Time_Start": 3488.36, "Time_End": 3492.44, "Text": " There wasn't a lot of public, you know, I sat down and figured out that these are, you know,"}, {"Time_Start": 3492.44, "Time_End": 3493.68, "Text": " commands to run and stuff."}, {"Time_Start": 3493.9, "Time_End": 3497.96, "Text": " It's actually sat down and thought a lot about how to do, you know, a good, generic Unix reverse shell,"}, {"Time_Start": 3498.28, "Time_End": 3502.52, "Text": " you know, with pipes and common program, or with, you know, telnet and pipes and other common utilities."}, {"Time_Start": 3503.84, "Time_End": 3504.88, "Text": " This is a good collection."}, {"Time_Start": 3505.0, "Time_End": 3508.22, "Text": " A lot of times, you know, when people have an arbitrary, you know, command execution,"}, {"Time_Start": 3508.36, "Time_End": 3510.76, "Text": " they just will be, like, you know, W, get, semi-colon, GCC."}, {"Time_Start": 3510.98, "Time_End": 3517.68, "Text": " or something, and we don't have that, I mean, even if you found a bug, you know, in, say you found a bug"}, {"Time_Start": 3517.68, "Time_End": 3522.08, "Text": " in an ASP page or something where you could execute command, you can just drop it in a mess with"}, {"Time_Start": 3522.08, "Time_End": 3526.7, "Text": " very easily, and then the command, you can just, you know, instead of, the command just returns the"}, {"Time_Start": 3526.7, "Time_End": 3529.64, "Text": " actual command as a payload, so then when you're putting in your payload, you're actually just"}, {"Time_Start": 3529.64, "Time_End": 3534.5, "Text": " have this command, so it's, it's really, really cool actually, to be able to just take any sort of"}, {"Time_Start": 3534.5, "Time_End": 3538.4, "Text": " arbitrary bug and get shells back with really no work at all."}, {"Time_Start": 3538.4, "Time_End": 3540.96, "Text": " One of other annoying things you might find with command ejection payloads is,"}, {"Time_Start": 3540.98, "Time_End": 3541.98, "Text": " is limited characters."}, {"Time_Start": 3541.98, "Time_End": 3545.4, "Text": " For instance, you can't have a space inside your command injection payload."}, {"Time_Start": 3545.4, "Time_End": 3548.66, "Text": " And, you know, not having a space and your W-O-gate command kind of limits what you can W-GET"}, {"Time_Start": 3548.66, "Time_End": 3550.98, "Text": " get, and as in other words, it'll just be one long command."}, {"Time_Start": 3550.98, "Time_End": 3555.66, "Text": " You can use tricks like the IFS sequence part, the IFS separator, bash command, environment"}, {"Time_Start": 3555.66, "Time_End": 3557.66, "Text": " option, to actually represent a space."}, {"Time_Start": 3557.66, "Time_End": 3560.92, "Text": " There's a lot of tricks you can use to actually encode your command in a way that it still"}, {"Time_Start": 3560.92, "Time_End": 3564.04, "Text": " is actually a valid shell command, but bypasses where the restrictions are."}, {"Time_Start": 3564.04, "Time_End": 3565.16, "Text": " And this does it all for you two."}, {"Time_Start": 3565.16, "Time_End": 3568.98, "Text": " We've actually got a payload design explicitly for getting around spaces and slash requirements"}, {"Time_Start": 3568.98, "Time_End": 3570.96, "Text": " when you're exploiting bugs like the N-dquose 1 and and, and it's"}, {"Time_Start": 3570.98, "Time_End": 3572.98, "Text": " a big OUyxOS, we're going to release in about a month."}, {"Time_Start": 3572.98, "Time_End": 3577.98, "Text": " Sorry, but, you know, it's still on the advisory process."}, {"Time_Start": 3577.98, "Time_End": 3579.98, "Text": " You didn't hear it here."}, {"Time_Start": 3579.98, "Time_End": 3584.98, "Text": " Okay, so I guess we can just go ahead and do some payloads demos."}, {"Time_Start": 3584.98, "Time_End": 3589.98, "Text": " We'll do some Axor shells, go ahead and throw up with Yario or something,"}, {"Time_Start": 3589.98, "Time_End": 3591.98, "Text": " so you guys can actually see that it is indeed axoid."}, {"Time_Start": 3591.98, "Time_End": 3595.98, "Text": " We'll do some inline egg stuff, some reverse and fine sock,"}, {"Time_Start": 3595.98, "Time_End": 3599.98, "Text": " and just go ahead and show you some of what that actually looks like in the wire,"}, {"Time_Start": 3599.98, "Time_End": 3601.98, "Text": " and, you know, why that's good."}, {"Time_Start": 3629.98, "Time_End": 3631.98, "Text": " Thank you very much."}, {"Time_Start": 3631.98, "Time_End": 3633.98, "Text": " Okay."}, {"Time_Start": 3633.98, "Time_End": 3635.98, "Text": " at the bottom issue in that."}, {"Time_Start": 3663.98, "Time_End": 3667.98, "Text": " You have to go down a font?"}, {"Time_Start": 3667.98, "Time_End": 3668.98, "Text": " Yeah."}, {"Time_Start": 3668.98, "Time_End": 3669.98, "Text": " One."}, {"Time_Start": 3669.98, "Time_End": 3673.98, "Text": " So, one."}, {"Time_Start": 3673.98, "Time_End": 3679.98, "Text": " Trying to find a font that will actually work so you can see it that's big enough and so you can see it that's big enough."}, {"Time_Start": 3679.98, "Time_End": 3683.98, "Text": " And also, you know, still on now, so be able to type to manage all things scrolling off all funny."}, {"Time_Start": 3683.98, "Time_End": 3685.98, "Text": " So, one second."}, {"Time_Start": 3685.98, "Time_End": 3687.98, "Text": " Okay, so is that pretty decent?"}, {"Time_Start": 3687.98, "Time_End": 3690.98, "Text": " I'm not how good, show how the protectors are and stuff."}, {"Time_Start": 3690.98, "Time_End": 3692.98, "Text": " So, um, we're going to, for example, use, uh, the soft."}, {"Time_Start": 3692.98, "Time_End": 3695.98, "Text": " use the Samba Trends 2 open bug."}, {"Time_Start": 3695.98, "Time_End": 3700.98, "Text": " And you can see in the prompt we have in parentheses the payload that's currently selected."}, {"Time_Start": 3700.98, "Time_End": 3702.98, "Text": " You can change the payload and that prompt will change."}, {"Time_Start": 3702.98, "Time_End": 3705.98, "Text": " So then there's top options of the options specific from the exploit, for example,"}, {"Time_Start": 3705.98, "Time_End": 3711.98, "Text": " the remote host in this case, 1916850.12, you know, the remote port,"}, {"Time_Start": 3711.98, "Time_End": 3715.98, "Text": " the port we're connecting back to the XO key in this case, because we're going to do an XO reverse,"}, {"Time_Start": 3715.98, "Time_End": 3719.98, "Text": " which is actually an inline egg payload, and then the port to connect back to."}, {"Time_Start": 3722.98, "Time_End": 3729.98, "Text": " All right, so we'll go ahead and exploit this."}, {"Time_Start": 3729.98, "Time_End": 3738.98, "Text": " So you can see now it's proofforcing, and hopefully we will be successful one minute."}, {"Time_Start": 3738.98, "Time_End": 3741.98, "Text": " Okay, so, um, hit it a couple times."}, {"Time_Start": 3741.98, "Time_End": 3746.98, "Text": " Yeah, so we got the shell back, um, we usually want to make a payload and do an interactive bash."}, {"Time_Start": 3746.98, "Time_End": 3749.98, "Text": " You actually have a nice bash prompt as rude."}, {"Time_Start": 3749.98, "Time_End": 3751.98, "Text": " Um, so that was all done for you."}, {"Time_Start": 3751.98, "Time_End": 3752.98, "Text": " You actually see."}, {"Time_Start": 3752.98, "Time_End": 3754.98, "Text": " on the network wire."}, {"Time_Start": 3754.98, "Time_End": 3756.98, "Text": " This is what the data is looking like."}, {"Time_Start": 3756.98, "Time_End": 3759.98, "Text": " I don't know if you want to follow TCP session or something."}, {"Time_Start": 3759.98, "Time_End": 3762.98, "Text": " But, so we'll do, you know, PSAUX output."}, {"Time_Start": 3762.98, "Time_End": 3765.98, "Text": " You see it's obviously fine for us."}, {"Time_Start": 3765.98, "Time_End": 3767.98, "Text": " And, uh, yeah."}, {"Time_Start": 3767.98, "Time_End": 3773.98, "Text": " So this is what the TCP stream actually looks like."}, {"Time_Start": 3773.98, "Time_End": 3777.98, "Text": " You can see that, you know, it's obviously isn't great security,"}, {"Time_Start": 3777.98, "Time_End": 3780.98, "Text": " but just for an IDS perspective and stuff."}, {"Time_Start": 3780.98, "Time_End": 3782.98, "Text": " As we can show with some of our, our, uh, our,"}, {"Time_Start": 3782.98, "Time_End": 3788.98, "Text": " know snort evasion stuff later that a lot of them signatures, for example, ID output and stuff like that,"}, {"Time_Start": 3788.98, "Time_End": 3790.98, "Text": " they will not be triggered by this."}, {"Time_Start": 3794.98, "Time_End": 3800.98, "Text": " The XR is done specific to the payload, so we're using an XO payload."}, {"Time_Start": 3800.98, "Time_End": 3803.98, "Text": " So yeah, if we wanted to use non-XO payload, it wouldn't be doing X-Wing."}, {"Time_Start": 3803.98, "Time_End": 3807.98, "Text": " So, and then we also, the key was one of the options if you looked in the payload options."}, {"Time_Start": 3807.98, "Time_End": 3809.98, "Text": " You could set a different XO key."}, {"Time_Start": 3809.98, "Time_End": 3811.98, "Text": " You can set it to zero if you wanted to avoid X-Wring."}, {"Time_Start": 3811.98, "Time_End": 3819.98, "Text": " So, okay, so does anybody have any sort of questions about that?"}, {"Time_Start": 3819.98, "Time_End": 3822.98, "Text": " To talk before about injecting, you know,"}, {"Time_Start": 3822.98, "Time_End": 3826.98, "Text": " what about, instead of this chance, we'll come back to,"}, {"Time_Start": 3826.98, "Time_End": 3830.98, "Text": " we're projecting it's open a stage server, so that you stand back and encrypted."}, {"Time_Start": 3830.98, "Time_End": 3835.98, "Text": " Right, well, we are working on some library injection technology for Linux."}, {"Time_Start": 3835.98, "Time_End": 3838.98, "Text": " Obviously, the DL injection is specific to Windows,"}, {"Time_Start": 3838.98, "Time_End": 3840.98, "Text": " and we'll be working on things like Linux and will come in the future."}, {"Time_Start": 3840.98, "Time_End": 3842.98, "Text": " It will come to the future."}, {"Time_Start": 3842.98, "Time_End": 3845.98, "Text": " So, really something you can do."}, {"Time_Start": 3845.98, "Time_End": 3846.98, "Text": " You can do a lot of things."}, {"Time_Start": 3846.98, "Time_End": 3849.98, "Text": " We're actually looking at more complicated payments and so you can do stuff"}, {"Time_Start": 3849.98, "Time_End": 3852.98, "Text": " like Diffney Hellman and then do some sort of, if you know,"}, {"Time_Start": 3852.98, "Time_End": 3854.98, "Text": " asymmetric and then symmetric crypto."}, {"Time_Start": 3854.98, "Time_End": 3856.98, "Text": " The tricky part in that has been finding an API that we can use on the"}, {"Time_Start": 3856.98, "Time_End": 3859.98, "Text": " client side and the server side, that's easy to use in Perl."}, {"Time_Start": 3859.98, "Time_End": 3860.98, "Text": " Like we don't want to have to, you know,"}, {"Time_Start": 3860.98, "Time_End": 3864.98, "Text": " we install some random C library on the Pearl side to be able to handle the encryption,"}, {"Time_Start": 3864.98, "Time_End": 3867.98, "Text": " and most of the Microsoft C API stuff doesn't work quite the same as open itself,"}, {"Time_Start": 3867.98, "Time_End": 3869.98, "Text": " so we're still trying to find a better way to do it."}, {"Time_Start": 3869.98, "Time_End": 3870.98, "Text": " Yeah."}, {"Time_Start": 3870.98, "Time_End": 3874.98, "Text": " Yeah, you have a question?"}, {"Time_Start": 3874.98, "Time_End": 3877.98, "Text": " Transports is in the payloads?"}, {"Time_Start": 3877.98, "Time_End": 3879.98, "Text": " Transports is in the payloads?"}, {"Time_Start": 3879.98, "Time_End": 3885.98, "Text": " No, they're not actually using Talmud."}, {"Time_Start": 3885.98, "Time_End": 3890.98, "Text": " They're not passing Talmud options."}, {"Time_Start": 3890.98, "Time_End": 3892.98, "Text": " These are all just raw connections."}, {"Time_Start": 3892.98, "Time_End": 3895.98, "Text": " For example, using NetCat or just raw TCP stock options."}, {"Time_Start": 3895.98, "Time_End": 3897.98, "Text": " So you're exactly using that cat."}, {"Time_Start": 3897.98, "Time_End": 3899.98, "Text": " You could use Telmo as a client."}, {"Time_Start": 3899.98, "Time_End": 3904.98, "Text": " as a client, but no example, like Telmet supported payloads, not a Telmet server."}, {"Time_Start": 3904.98, "Time_End": 3912.98, "Text": " So we'll move on on doing an example of a Fine Sock over Samba, since we already have,"}, {"Time_Start": 3912.98, "Time_End": 3916.98, "Text": " TheoO Open, and you can see that the No, right now you can see that this connection"}, {"Time_Start": 3916.98, "Time_End": 3920.98, "Text": " was on 4-321, so it actually opened a new connection for that payloads."}, {"Time_Start": 3920.98, "Time_End": 3925.98, "Text": " So now we'll just do it over the original connection, so now we'll see that our shell will be over 4-139."}, {"Time_Start": 3929.98, "Time_End": 3932.98, "Text": " I'm sure."}, {"Time_Start": 3932.98, "Time_End": 3933.98, "Text": " Thank you."}, {"Time_Start": 3933.98, "Time_End": 3934.98, "Text": " I."}, {"Time_Start": 3934.98, "Time_End": 3938.98, "Text": " You have to put on, I can't be a lot."}, {"Time_Start": 3938.98, "Time_End": 3943.98, "Text": " I'm not going to walk in."}, {"Time_Start": 3943.98, "Time_End": 3944.98, "Text": " Okay, cool."}, {"Time_Start": 3944.98, "Time_End": 3957.98, "Text": " Okay, cool."}, {"Time_Start": 3957.98, "Time_End": 3958.98, "Text": " Okay, cool."}, {"Time_Start": 3959.98, "Time_End": 3968.98, "Text": " So this exploits the Sombaz trans to open bug."}, {"Time_Start": 3968.98, "Time_End": 3973.98, "Text": " It affects something like 228 and below and is patched by 228."}, {"Time_Start": 3973.98, "Time_End": 3981.98, "Text": " And usually it goes a lot faster, but because we have, we've enabled the Python payloads in the Mac OS,"}, {"Time_Start": 3981.98, "Time_End": 3985.98, "Text": " it doesn't really catch wide and it kind of takes forward to load up all the payloads and stuff."}, {"Time_Start": 3985.98, "Time_End": 3988.98, "Text": " Usually we're just able to about default, so it goes a lot quicker when you're using it for real."}, {"Time_Start": 3988.98, "Time_End": 3995.98, "Text": " And as you can see, now in the parallel options, we don't actually have a connect back IP address because we're not actually connecting back."}, {"Time_Start": 3995.98, "Time_End": 3997.98, "Text": " We're reusing the existing connection."}, {"Time_Start": 3997.98, "Time_End": 3999.98, "Text": " Another thing that would be important to explain about"}]}