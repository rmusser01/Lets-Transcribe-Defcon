{
  "segments": [
    {
      "Time_Start": 0.0,
      "Time_End": 12.76,
      "Text": "This text was transcribed using whisper model: large-v2\n\n Thank you so much for checking out this presentation."
    },
    {
      "Time_Start": 12.76,
      "Time_End": 16.92,
      "Text": " We're going to be talking about an open source tool and research that Andi and I did called"
    },
    {
      "Time_Start": 16.92,
      "Time_End": 19.68,
      "Text": " Cloud Console Cartographer."
    },
    {
      "Time_Start": 19.68,
      "Time_End": 23.240000000000002,
      "Text": " Tapping into mapping is greater than slogging through logging."
    },
    {
      "Time_Start": 23.240000000000002,
      "Time_End": 27.16,
      "Text": " I'll do a brief introduction talking about some different aspects of event logs, and"
    },
    {
      "Time_Start": 27.16,
      "Time_End": 30.16,
      "Text": " then we'll shift to looking at cloud logs and some of the ways that they're different"
    },
    {
      "Time_Start": 30.16,
      "Time_End": 34.88,
      "Text": " from more traditional on-prem, host-based, or network logs, and then we're going to really"
    },
    {
      "Time_Start": 34.88,
      "Time_End": 43.08,
      "Text": " expose the problem of noisy logs, particularly in specific cloud vendors, UI management consoles,"
    },
    {
      "Time_Start": 43.08,
      "Time_End": 47.92,
      "Text": " and then the problem that poses defenders, incident responders, threat hunters, et cetera,"
    },
    {
      "Time_Start": 47.92,
      "Time_End": 53.120000000000005,
      "Text": " for making sense of what the actual input action was to produce a plethora of those"
    },
    {
      "Time_Start": 53.120000000000005,
      "Time_End": 54.120000000000005,
      "Text": " event logs."
    },
    {
      "Time_Start": 54.120000000000005,
      "Time_End": 58.480000000000004,
      "Text": " Then we'll look at the solution, which is all the details we implemented in this tool"
    },
    {
      "Time_Start": 58.480000000000004,
      "Time_End": 62.64,
      "Text": " to make sense of these noisy logs, and then we'll end with a tool demo."
    },
    {
      "Time_Start": 62.64,
      "Time_End": 65.12,
      "Text": " Good afternoon, everyone."
    },
    {
      "Time_Start": 65.12,
      "Time_End": 67.60000000000001,
      "Text": " Short presentation about me."
    },
    {
      "Time_Start": 67.60000000000001,
      "Time_End": 69.48,
      "Text": " My name is Andi Ahmete."
    },
    {
      "Time_Start": 69.48,
      "Time_End": 71.12,
      "Text": " I'm from Kosovo."
    },
    {
      "Time_Start": 71.12,
      "Time_End": 78.52000000000001,
      "Text": " I started the journey of cybersecurity at Permiso as an associate threat researcher"
    },
    {
      "Time_Start": 78.52000000000001,
      "Time_End": 80.80000000000001,
      "Text": " almost a year ago."
    },
    {
      "Time_Start": 80.8,
      "Time_End": 87.64,
      "Text": " And during this time, I've developed an open-source detection framework tool, which is called"
    },
    {
      "Time_Start": 87.64,
      "Time_End": 96.56,
      "Text": " Cloud Grappler, also a big Lakers fan."
    },
    {
      "Time_Start": 96.56,
      "Time_End": 97.84,
      "Text": " And my name is Daniel Bohannon."
    },
    {
      "Time_Start": 97.84,
      "Time_End": 100.84,
      "Text": " I'm a principal threat researcher with Permiso Security."
    },
    {
      "Time_Start": 100.84,
      "Time_End": 105.16,
      "Text": " We're a cloud-based detection response startup company based in the U.S."
    },
    {
      "Time_Start": 105.16,
      "Time_End": 106.92,
      "Text": " I've been a defender my whole life."
    },
    {
      "Time_Start": 106.92,
      "Time_End": 112.04,
      "Text": " I have quite an obsession with obfuscation and evasion research, so a lot of people assume"
    },
    {
      "Time_Start": 112.04,
      "Time_End": 113.52,
      "Text": " I have a lot of offensive experience."
    },
    {
      "Time_Start": 113.52,
      "Time_End": 118.12,
      "Text": " I actually don't, but I really love the time I've spent with red teamers at my time at"
    },
    {
      "Time_Start": 118.12,
      "Time_End": 119.12,
      "Text": " Mandiant."
    },
    {
      "Time_Start": 119.12,
      "Time_End": 124.28,
      "Text": " And yeah, this is a really special conference, and so if this is your first time here, then"
    },
    {
      "Time_Start": 124.28,
      "Time_End": 131.0,
      "Text": " this is my third time, and I really appreciate it more and more as I travel and do conference"
    },
    {
      "Time_Start": 131.0,
      "Time_End": 132.16,
      "Text": " presentations around the world."
    },
    {
      "Time_Start": 132.16,
      "Time_End": 137.16,
      "Text": " There's something really special about this conference in the warmness of the people and"
    },
    {
      "Time_Start": 137.16,
      "Time_End": 140.44,
      "Text": " the conversations that you have, and I feel like there's just a really healthy respect"
    },
    {
      "Time_Start": 140.44,
      "Time_End": 145.64,
      "Text": " of red and blue that a lot of times egos get in the way when conversations are flying around"
    },
    {
      "Time_Start": 145.64,
      "Time_End": 146.64,
      "Text": " on Twitter."
    },
    {
      "Time_Start": 146.64,
      "Time_End": 150.72,
      "Text": " And it's really nice to look at a human face-to-face and admire and appreciate the tradecraft and"
    },
    {
      "Time_Start": 150.72,
      "Time_End": 155.76,
      "Text": " the thought processes that go into being creative in offensive security, defensive security,"
    },
    {
      "Time_Start": 155.76,
      "Time_End": 160.32,
      "Text": " because ultimately it's human creativity, and it's just quite a cool opportunity to"
    },
    {
      "Time_Start": 160.32,
      "Time_End": 162.0,
      "Text": " learn that from one another."
    },
    {
      "Time_Start": 162.0,
      "Time_End": 163.4,
      "Text": " I'm a huge coffee fan."
    },
    {
      "Time_Start": 163.4,
      "Time_End": 165.16,
      "Text": " I also like motorcycles."
    },
    {
      "Time_Start": 165.16,
      "Time_End": 169.0,
      "Text": " I do not own one of these motorcycles, but boy, do they look fun."
    },
    {
      "Time_Start": 169.0,
      "Time_End": 171.84,
      "Text": " And yeah, I really love open source tools."
    },
    {
      "Time_Start": 171.84,
      "Time_End": 176.51999999999998,
      "Text": " Again, I have quite an obsession with obfuscation, and there's a couple of the tools listed there,"
    },
    {
      "Time_Start": 176.51999999999998,
      "Time_End": 178.94,
      "Text": " but really excited to be here today."
    },
    {
      "Time_Start": 178.94,
      "Time_End": 182.56,
      "Text": " So as a defender, logs are extremely important."
    },
    {
      "Time_Start": 182.56,
      "Time_End": 183.56,
      "Text": " They're facts."
    },
    {
      "Time_Start": 183.56,
      "Time_End": 185.12,
      "Text": " They give us information."
    },
    {
      "Time_Start": 185.12,
      "Time_End": 187.24,
      "Text": " They tell us things that have happened."
    },
    {
      "Time_Start": 187.24,
      "Time_End": 191.36,
      "Text": " Sometimes the absence of logs is also a problem as well, so we want to make sure that we're"
    },
    {
      "Time_Start": 191.36,
      "Time_End": 195.84,
      "Text": " not using logs incorrectly, but ultimately it's visibility."
    },
    {
      "Time_Start": 195.84,
      "Time_End": 199.24,
      "Text": " Another thing is we should make sure that we understand what logs are available and"
    },
    {
      "Time_Start": 199.24,
      "Time_End": 200.96,
      "Text": " turn them on."
    },
    {
      "Time_Start": 200.96,
      "Time_End": 205.24,
      "Text": " Attackers typically do not do this for you, so as a defender, you should do that yourself,"
    },
    {
      "Time_Start": 205.24,
      "Time_End": 210.12,
      "Text": " and also understand all the steps that can go wrong with those logs being potentially"
    },
    {
      "Time_Start": 210.12,
      "Time_End": 217.08,
      "Text": " deleted intentionally or unintentionally by either an attacker or someone in your organisation."
    },
    {
      "Time_Start": 217.08,
      "Time_End": 219.84,
      "Text": " And lastly, do something with the logs."
    },
    {
      "Time_Start": 219.84,
      "Time_End": 223.44000000000003,
      "Text": " It's not as beneficial to have the logs and not do anything with them."
    },
    {
      "Time_Start": 223.44000000000003,
      "Time_End": 227.72000000000003,
      "Text": " It is helpful if you're doing an investigation, but wouldn't it be great to detect that activity"
    },
    {
      "Time_Start": 227.72000000000003,
      "Time_End": 232.16000000000003,
      "Text": " before having to go back in time a few weeks or months to investigate an intrusion that"
    },
    {
      "Time_Start": 232.16000000000003,
      "Time_End": 233.16000000000003,
      "Text": " happened?"
    },
    {
      "Time_Start": 233.16000000000003,
      "Time_End": 238.4,
      "Text": " I want to talk a little bit about some of the differences between cloud logs and more"
    },
    {
      "Time_Start": 238.4,
      "Time_End": 243.68,
      "Text": " on-prem logs, and I'm speaking less of where the logs are stored and more of the source"
    },
    {
      "Time_Start": 243.68,
      "Time_End": 244.76000000000002,
      "Text": " of the logs."
    },
    {
      "Time_Start": 244.95999999999998,
      "Time_End": 250.28,
      "Text": " A lot of my experience has been in host-based security, and so those logs are extremely"
    },
    {
      "Time_Start": 250.28,
      "Time_End": 251.39999999999998,
      "Text": " detailed."
    },
    {
      "Time_Start": 251.39999999999998,
      "Time_End": 258.0,
      "Text": " You also have a lot of aftermarket logging options, like Sysmon, we've heard some different"
    },
    {
      "Time_Start": 258.0,
      "Time_End": 263.48,
      "Text": " talks about using ETW, but there is so much detail in these logs."
    },
    {
      "Time_Start": 263.48,
      "Time_End": 269.96,
      "Text": " All the image loads, all the process creations, arguments, threads, call stacks, even all"
    },
    {
      "Time_Start": 269.96,
      "Time_End": 270.96,
      "Text": " the way down to file content."
    },
    {
      "Time_Start": 271.15999999999997,
      "Time_End": 275.52,
      "Text": " We can actually start to extract attacker information from the endpoint to see what"
    },
    {
      "Time_Start": 275.52,
      "Time_End": 278.03999999999996,
      "Text": " are they working with in their attack."
    },
    {
      "Time_Start": 278.03999999999996,
      "Time_End": 283.44,
      "Text": " So there's a lot of fingerprints that exist based on the attacker's activity, and one"
    },
    {
      "Time_Start": 283.44,
      "Time_End": 287.28,
      "Text": " of the things I love about forensics and IR is you're discovering fingerprints that often"
    },
    {
      "Time_Start": 287.28,
      "Time_End": 291.91999999999996,
      "Text": " the attacker did not intentionally create and maybe is not even aware of."
    },
    {
      "Time_Start": 291.91999999999996,
      "Time_End": 293.88,
      "Text": " Cloud logs are very different."
    },
    {
      "Time_Start": 293.88,
      "Time_End": 299.92,
      "Text": " They are much less granular and abstracted because you're essentially looking at API"
    },
    {
      "Time_Start": 299.92,
      "Time_End": 303.0,
      "Text": " calls, and they're determined by the cloud provider."
    },
    {
      "Time_Start": 303.0,
      "Time_End": 305.68,
      "Text": " There's not Sysmon add-ons for you to do."
    },
    {
      "Time_Start": 305.68,
      "Time_End": 310.2,
      "Text": " There's quite a lot fewer opportunities to enrich those logs natively."
    },
    {
      "Time_Start": 310.2,
      "Time_End": 313.0,
      "Text": " It all depends on what you can do with them after the fact."
    },
    {
      "Time_Start": 313.0,
      "Time_End": 317.48,
      "Text": " We kind of break the logs up into control plane and data plane."
    },
    {
      "Time_Start": 317.48,
      "Time_End": 321.96,
      "Text": " Control plane is typically enabled, and that is the changes to the configurations for the"
    },
    {
      "Time_Start": 321.96,
      "Time_End": 323.88,
      "Text": " cloud provider."
    },
    {
      "Time_Start": 323.88,
      "Time_End": 325.71999999999997,
      "Text": " Data plane is typically not enabled."
    },
    {
      "Time_Start": 325.71999999999997,
      "Time_End": 330.35999999999996,
      "Text": " It's the usage of these things, and it's usually not enabled because of the sheer volume and"
    },
    {
      "Time_Start": 330.35999999999996,
      "Time_End": 334.4,
      "Text": " cost associated with storing and maintaining those logs."
    },
    {
      "Time_Start": 334.4,
      "Time_End": 339.08,
      "Text": " So an example of control plane would be making some S3 bucket or Azure storage blob configuration"
    },
    {
      "Time_Start": 339.08,
      "Time_End": 344.4,
      "Text": " change and then every single request for objects in those places would be data plane logs."
    },
    {
      "Time_Start": 344.4,
      "Time_End": 347.76,
      "Text": " There's also delays in log generation depending on the cloud provider."
    },
    {
      "Time_Start": 347.76,
      "Time_End": 351.0,
      "Text": " Sometimes it's a few tens of seconds."
    },
    {
      "Time_Start": 351.04,
      "Time_End": 353.04,
      "Text": " Sometimes it's 15, 20, 30 minutes."
    },
    {
      "Time_Start": 353.04,
      "Time_End": 358.64,
      "Text": " So these are also factors to consider when you're looking at detection and response."
    },
    {
      "Time_Start": 358.64,
      "Time_End": 362.58,
      "Text": " Retention limits is another thing as well that we'll talk about in the next slide."
    },
    {
      "Time_Start": 362.58,
      "Time_End": 369.5,
      "Text": " But overall, these logs are just not quite as detailed, and you have to create fingerprints"
    },
    {
      "Time_Start": 369.5,
      "Time_End": 375.36,
      "Text": " by joining together multiple events and kind of create your own distinct patterns."
    },
    {
      "Time_Start": 375.36,
      "Time_End": 379.8,
      "Text": " So finding patterns across these logs is really, really important when it comes to threat hunting"
    },
    {
      "Time_Start": 379.8,
      "Time_End": 382.24,
      "Text": " and detections."
    },
    {
      "Time_Start": 382.24,
      "Time_End": 384.32,
      "Text": " So what do cloud logs actually look like?"
    },
    {
      "Time_Start": 384.32,
      "Time_End": 388.0,
      "Text": " If you haven't checked it out before, this is a really simple example of just adding"
    },
    {
      "Time_Start": 388.0,
      "Time_End": 389.0,
      "Text": " a user."
    },
    {
      "Time_Start": 389.0,
      "Time_End": 391.68,
      "Text": " And so on the left, we have an AWS example."
    },
    {
      "Time_Start": 391.68,
      "Time_End": 393.96000000000004,
      "Text": " On the right, we have an Azure log example."
    },
    {
      "Time_Start": 393.96000000000004,
      "Time_End": 398.16,
      "Text": " There are quite a few differences between different cloud providers."
    },
    {
      "Time_Start": 398.16,
      "Time_End": 403.08000000000004,
      "Text": " So normalization becomes quite important if you are in a multi-cloud situation."
    },
    {
      "Time_Start": 403.08000000000004,
      "Time_End": 405.56,
      "Text": " But a lot of the same information is there."
    },
    {
      "Time_Start": 405.56,
      "Time_End": 406.88,
      "Text": " Now how do you get those logs?"
    },
    {
      "Time_Start": 406.96,
      "Time_End": 411.24,
      "Text": " Well, you can query based on the API that the log provider gives you."
    },
    {
      "Time_Start": 411.24,
      "Time_End": 414.4,
      "Text": " And there's a couple pros and cons related to that."
    },
    {
      "Time_Start": 414.4,
      "Time_End": 416.84,
      "Text": " One of the pros is it's the least delayed."
    },
    {
      "Time_Start": 416.84,
      "Time_End": 421.76,
      "Text": " As soon as that log is available, then when you query the API, you get that information."
    },
    {
      "Time_Start": 421.76,
      "Time_End": 425.0,
      "Text": " One of the cons, though, is that there are retention limits."
    },
    {
      "Time_Start": 425.0,
      "Time_End": 428.54,
      "Text": " AWS cloud trail logs, you have a 90-day retention limit."
    },
    {
      "Time_Start": 428.54,
      "Time_End": 433.12,
      "Text": " If you're trying to get something that's 90 days and one minute old, it's gone forever."
    },
    {
      "Time_Start": 433.12,
      "Time_End": 436.24,
      "Text": " AWS\ufffd sorry, Azure is only 30 days."
    },
    {
      "Time_Start": 436.24,
      "Time_End": 440.88,
      "Text": " So would you be comfortable knowing you only had 30 days or only had 90 days of data?"
    },
    {
      "Time_Start": 440.88,
      "Time_End": 446.28000000000003,
      "Text": " If that makes you uncomfortable, then you should consider not just relying on the API,"
    },
    {
      "Time_Start": 446.28000000000003,
      "Time_End": 450.2,
      "Text": " but forwarding those logs to a secondary location."
    },
    {
      "Time_Start": 450.2,
      "Time_End": 452.24,
      "Text": " There's a lot of good reasons to do this."
    },
    {
      "Time_Start": 452.24,
      "Time_End": 457.3,
      "Text": " But it allows you to store very cheaply a lot longer retention for those logs."
    },
    {
      "Time_Start": 457.3,
      "Time_End": 459.94,
      "Text": " You also don't have to deal with API throttling."
    },
    {
      "Time_Start": 459.94,
      "Time_End": 464.76,
      "Text": " So for example, in AWS cloud trail, you can only call that lookup events API two times"
    },
    {
      "Time_Start": 464.8,
      "Time_End": 466.32,
      "Text": " per second."
    },
    {
      "Time_Start": 466.32,
      "Time_End": 471.48,
      "Text": " Now that sounds like a pretty reasonable number, and it is in most cases, but that's globally."
    },
    {
      "Time_Start": 471.48,
      "Time_End": 476.12,
      "Text": " So if you have ten different security products all querying those logs in the same way, you"
    },
    {
      "Time_Start": 476.12,
      "Time_End": 479.88,
      "Text": " can hit API throttling really quickly and it affects everyone else trying to use that"
    },
    {
      "Time_Start": 479.88,
      "Time_End": 481.06,
      "Text": " same API."
    },
    {
      "Time_Start": 481.06,
      "Time_End": 486.76,
      "Text": " So forwarding to a secondary location allows you to avoid the API throttling scenario."
    },
    {
      "Time_Start": 486.76,
      "Time_End": 489.52,
      "Text": " Easier consumption by other tools is another good reason."
    },
    {
      "Time_Start": 489.52,
      "Time_End": 494.4,
      "Text": " But some of the cons, sometimes there's actually data differences between the forwarded event"
    },
    {
      "Time_Start": 494.56000000000006,
      "Time_End": 496.12000000000006,
      "Text": " and the event from the API."
    },
    {
      "Time_Start": 496.12000000000006,
      "Time_End": 498.48,
      "Text": " An example of that is in AWS cloud trail logs."
    },
    {
      "Time_Start": 498.48,
      "Time_End": 505.44000000000005,
      "Text": " If you do lookup events, then there's actually an entire different section called resources,"
    },
    {
      "Time_Start": 505.44000000000005,
      "Time_End": 507.8,
      "Text": " and it's referenced resources for that event."
    },
    {
      "Time_Start": 507.8,
      "Time_End": 512.0,
      "Text": " So it can be usernames, access keys, a lot of different items."
    },
    {
      "Time_Start": 512.0,
      "Time_End": 516.36,
      "Text": " But if you forward that log to an S3 bucket, that whole section's completely gone."
    },
    {
      "Time_Start": 516.36,
      "Time_End": 517.44,
      "Text": " It's not even there."
    },
    {
      "Time_Start": 517.44,
      "Time_End": 523.4000000000001,
      "Text": " So as defenders, it's always, always, always important to know your data, test your tools,"
    },
    {
      "Time_Start": 523.4,
      "Time_End": 531.1999999999999,
      "Text": " and look at the differences between retrieving that information."
    },
    {
      "Time_Start": 531.1999999999999,
      "Time_End": 536.1999999999999,
      "Text": " So the tool we're going to talk about today, and everything we're looking at, is the interactive"
    },
    {
      "Time_Start": 536.1999999999999,
      "Time_End": 538.1999999999999,
      "Text": " cloud console usage."
    },
    {
      "Time_Start": 538.1999999999999,
      "Time_End": 543.4,
      "Text": " Now the word console is kind of problematic here, because typically we think black terminal"
    },
    {
      "Time_Start": 543.4,
      "Time_End": 544.4,
      "Text": " window."
    },
    {
      "Time_Start": 544.4,
      "Time_End": 550.1999999999999,
      "Text": " But AWS actually calls their web UI the AWS management console."
    },
    {
      "Time_Start": 550.1999999999999,
      "Time_End": 552.48,
      "Text": " Azure calls theirs the portal."
    },
    {
      "Time_Start": 552.5600000000001,
      "Time_End": 556.6,
      "Text": " So when we're referring to the word console in this presentation, we're referring to this"
    },
    {
      "Time_Start": 556.6,
      "Time_End": 560.88,
      "Text": " web browser portal."
    },
    {
      "Time_Start": 560.88,
      "Time_End": 564.76,
      "Text": " So do attackers actually use this?"
    },
    {
      "Time_Start": 564.76,
      "Time_End": 567.84,
      "Text": " Like how many attackers are using the UI?"
    },
    {
      "Time_Start": 567.84,
      "Time_End": 568.96,
      "Text": " Quite a few, actually."
    },
    {
      "Time_Start": 568.96,
      "Time_End": 571.22,
      "Text": " Some attackers are also new to cloud."
    },
    {
      "Time_Start": 571.22,
      "Time_End": 574.96,
      "Text": " They're figuring it out as they go, but they're being darn successful at it."
    },
    {
      "Time_Start": 574.96,
      "Time_End": 578.52,
      "Text": " And maybe their playbooks are actually just PDFs saying click here, do this."
    },
    {
      "Time_Start": 578.52,
      "Time_End": 582.52,
      "Text": " And they haven't really had the need to script out these things."
    },
    {
      "Time_Start": 582.52,
      "Time_End": 585.16,
      "Text": " Two threat actors that we track, Lucre 1 and Lucre 3."
    },
    {
      "Time_Start": 585.16,
      "Time_End": 587.76,
      "Text": " Lucre 3 is also known as scattered spider."
    },
    {
      "Time_Start": 587.76,
      "Time_End": 593.96,
      "Text": " There are many examples in which we see them using the console to do different tasks."
    },
    {
      "Time_Start": 593.96,
      "Time_End": 597.64,
      "Text": " Recon tasks, exfiltration tasks, et cetera."
    },
    {
      "Time_Start": 597.64,
      "Time_End": 602.8,
      "Text": " And then sometimes there's also technical reasons why an attacker might use the console."
    },
    {
      "Time_Start": 602.8,
      "Time_End": 608.36,
      "Text": " We had an incident that we were responding to last year, where an attacker had an ECS"
    },
    {
      "Time_Start": 608.36,
      "Time_End": 609.92,
      "Text": " container breakout."
    },
    {
      "Time_Start": 609.92,
      "Time_End": 611.5600000000001,
      "Text": " And it was a federated token."
    },
    {
      "Time_Start": 611.5600000000001,
      "Time_End": 617.2,
      "Text": " And what's interesting is that a federated token is not allowed to access the IAM service."
    },
    {
      "Time_Start": 617.2,
      "Time_End": 621.8000000000001,
      "Text": " But in the AWS documentation, that limitation doesn't apply to console sessions."
    },
    {
      "Time_Start": 621.8000000000001,
      "Time_End": 626.44,
      "Text": " So that's the very first thing they did, was pop open a console session, create a user,"
    },
    {
      "Time_Start": 626.44,
      "Time_End": 629.5600000000001,
      "Text": " and go on with their attack."
    },
    {
      "Time_Start": 629.5600000000001,
      "Time_End": 631.48,
      "Text": " Cool."
    },
    {
      "Time_Start": 631.48,
      "Time_End": 634.64,
      "Text": " So we saw two cloud logs examples."
    },
    {
      "Time_Start": 634.64,
      "Time_End": 641.12,
      "Text": " And let's switch the focus and actually checking the log volume perspective."
    },
    {
      "Time_Start": 641.12,
      "Time_End": 644.48,
      "Text": " And for that, we're going to do some enumeration steps in AWS."
    },
    {
      "Time_Start": 644.48,
      "Time_End": 647.4399999999999,
      "Text": " And by enumeration, I mean just clicking around."
    },
    {
      "Time_Start": 647.4399999999999,
      "Time_End": 650.76,
      "Text": " Something that is not changing or updating anything."
    },
    {
      "Time_Start": 650.76,
      "Time_End": 656.6,
      "Text": " For example, listing user, listing roles, whatever, which is related to read-only event."
    },
    {
      "Time_Start": 656.6,
      "Time_End": 661.8,
      "Text": " And surprisingly, we see that AWS is quite noisy in that perspective."
    },
    {
      "Time_Start": 661.8000000000001,
      "Time_End": 667.44,
      "Text": " And being honest, that's one of the main reasons why we are here today, trying to solve"
    },
    {
      "Time_Start": 667.44,
      "Time_End": 668.44,
      "Text": " this problem."
    },
    {
      "Time_Start": 668.44,
      "Time_End": 673.84,
      "Text": " Azure, on the other hand, they tend to do things differently."
    },
    {
      "Time_Start": 673.84,
      "Time_End": 678.7600000000001,
      "Text": " And when I'm speaking about Azure, I'm speaking about the Azure portal."
    },
    {
      "Time_Start": 678.7600000000001,
      "Time_End": 687.2400000000001,
      "Text": " So if you're trying to do some same enumeration steps, like listing users, blobs, containers,"
    },
    {
      "Time_Start": 687.2400000000001,
      "Time_End": 688.2400000000001,
      "Text": " we don't get that."
    },
    {
      "Time_Start": 688.24,
      "Time_End": 692.48,
      "Text": " Because Azure, again, logs only update or change event."
    },
    {
      "Time_Start": 692.48,
      "Time_End": 696.8,
      "Text": " So doing this enumeration clicks, we're pretty much muted."
    },
    {
      "Time_Start": 696.8,
      "Time_End": 700.4,
      "Text": " And there's no logs generated at all."
    },
    {
      "Time_Start": 700.4,
      "Time_End": 704.44,
      "Text": " And for that, Azure kind of gets a free pass from our problem, not because they are doing"
    },
    {
      "Time_Start": 704.44,
      "Time_End": 710.2,
      "Text": " a better job at this, but since they don't offer enough logs for us."
    },
    {
      "Time_Start": 710.2,
      "Time_End": 715.8,
      "Text": " So being as a security person, you'll always want to know if an attacker is enumerating"
    },
    {
      "Time_Start": 715.8,
      "Time_End": 717.36,
      "Text": " your resources."
    },
    {
      "Time_Start": 717.48,
      "Time_End": 723.08,
      "Text": " And with that being said, we're going to focus only on the AWS service, where we get that"
    },
    {
      "Time_Start": 723.08,
      "Time_End": 728.5600000000001,
      "Text": " kind of noise so we can have a solution for that problem."
    },
    {
      "Time_Start": 728.5600000000001,
      "Time_End": 734.5600000000001,
      "Text": " Switching back to the main part of the presentation, which is the problem, and that's the noisy"
    },
    {
      "Time_Start": 734.5600000000001,
      "Time_End": 735.84,
      "Text": " console logs."
    },
    {
      "Time_Start": 735.84,
      "Time_End": 742.08,
      "Text": " So being a researcher, you understand two things, and you love two things, and that's"
    },
    {
      "Time_Start": 742.08,
      "Time_End": 745.76,
      "Text": " good coffee, and also logs."
    },
    {
      "Time_Start": 745.76,
      "Time_End": 753.36,
      "Text": " But sometimes having too much of both of these can leave you out in the dark, you know what"
    },
    {
      "Time_Start": 753.36,
      "Time_End": 754.4399999999999,
      "Text": " I mean?"
    },
    {
      "Time_Start": 754.4399999999999,
      "Time_End": 759.96,
      "Text": " And the problem here is most of the time, you're out in the dark because of the absence"
    },
    {
      "Time_Start": 759.96,
      "Time_End": 761.0,
      "Text": " of logs."
    },
    {
      "Time_Start": 761.0,
      "Time_End": 766.0,
      "Text": " But in our case, it's actually the sheer volume of logs that is going on here."
    },
    {
      "Time_Start": 766.0,
      "Time_End": 770.48,
      "Text": " And sometimes it feels just like playing the Atari Super Breakout game, where we can think"
    },
    {
      "Time_Start": 770.64,
      "Time_End": 778.12,
      "Text": " that little ball, which is hit from a paddle, has one user click, and it goes to the top."
    },
    {
      "Time_Start": 778.12,
      "Time_End": 780.64,
      "Text": " Maybe it hits just one little square."
    },
    {
      "Time_Start": 780.64,
      "Time_End": 785.8000000000001,
      "Text": " And that could be one correlation, one click, one request."
    },
    {
      "Time_Start": 785.8000000000001,
      "Time_End": 789.28,
      "Text": " But that's obviously not always the case."
    },
    {
      "Time_Start": 789.28,
      "Time_End": 793.6800000000001,
      "Text": " And if you play this game, you know that sometimes a ball could get way over to the top and hit"
    },
    {
      "Time_Start": 793.6800000000001,
      "Time_End": 797.12,
      "Text": " tens, maybe hundreds of squares."
    },
    {
      "Time_Start": 797.12,
      "Time_End": 805.6,
      "Text": " And they can be represented as one click, which calls tens or maybe hundreds of APIs"
    },
    {
      "Time_Start": 805.6,
      "Time_End": 806.6,
      "Text": " in the back end."
    },
    {
      "Time_Start": 806.6,
      "Time_End": 810.0,
      "Text": " And we're going to see that that's actually the case in some of our sessions that we are"
    },
    {
      "Time_Start": 810.0,
      "Time_End": 811.96,
      "Text": " going to present later on."
    },
    {
      "Time_Start": 811.96,
      "Time_End": 819.76,
      "Text": " It's definitely the case that we don't want the high score when it comes to these logs."
    },
    {
      "Time_Start": 819.76,
      "Time_End": 823.4,
      "Text": " What we'd expect to see is one input event in the UI and one log."
    },
    {
      "Time_Start": 823.4,
      "Time_End": 826.52,
      "Text": " That would be the easiest scenario for Defender."
    },
    {
      "Time_Start": 827.16,
      "Time_End": 831.56,
      "Text": " The way that we started to enumerate this was we created an IAM user and gave it absolutely"
    },
    {
      "Time_Start": 831.56,
      "Time_End": 832.56,
      "Text": " no permissions."
    },
    {
      "Time_Start": 832.56,
      "Time_End": 833.84,
      "Text": " Just a login profile."
    },
    {
      "Time_Start": 833.84,
      "Time_End": 835.48,
      "Text": " And it started clicking through the console."
    },
    {
      "Time_Start": 835.48,
      "Time_End": 839.16,
      "Text": " And if you do this, you'll start to see a lot of these tiles start to have these errors"
    },
    {
      "Time_Start": 839.16,
      "Time_End": 842.1999999999999,
      "Text": " saying you don't have access to run this API and this API."
    },
    {
      "Time_Start": 842.1999999999999,
      "Time_End": 847.0,
      "Text": " So if we, for example, go to the IAM service, we'll see even more errors and kind of starting"
    },
    {
      "Time_Start": 847.0,
      "Time_End": 850.8,
      "Text": " to enumerate, okay, if I were to click on IAM, what are all the API calls it's trying"
    },
    {
      "Time_Start": 850.8,
      "Time_End": 852.1999999999999,
      "Text": " to do?"
    },
    {
      "Time_Start": 852.2,
      "Time_End": 856.6800000000001,
      "Text": " And maybe let's go a little further and click on users and see, yep, there's another one"
    },
    {
      "Time_Start": 856.6800000000001,
      "Time_End": 857.6800000000001,
      "Text": " there."
    },
    {
      "Time_Start": 857.6800000000001,
      "Time_End": 858.6800000000001,
      "Text": " IAM list users."
    },
    {
      "Time_Start": 858.6800000000001,
      "Time_End": 863.84,
      "Text": " So if we're trying to map that click to know when an attacker or a user clicks on that,"
    },
    {
      "Time_Start": 863.84,
      "Time_End": 866.84,
      "Text": " then what would all the events be related to this?"
    },
    {
      "Time_Start": 866.84,
      "Time_End": 870.32,
      "Text": " Well, let's actually give ourselves access to run this event and see if anything else"
    },
    {
      "Time_Start": 870.32,
      "Time_End": 871.32,
      "Text": " happens."
    },
    {
      "Time_Start": 871.32,
      "Time_End": 873.6800000000001,
      "Text": " So we can do this just with a little inline policy."
    },
    {
      "Time_Start": 873.6800000000001,
      "Time_End": 877.6,
      "Text": " Now when we click that, we actually can see we have three users here."
    },
    {
      "Time_Start": 877.6,
      "Time_End": 880.2800000000001,
      "Text": " But now we have even more errors."
    },
    {
      "Time_Start": 880.36,
      "Time_End": 883.88,
      "Text": " And in fact, those errors are different API calls."
    },
    {
      "Time_Start": 883.88,
      "Time_End": 887.68,
      "Text": " So if we kind of focus on this example, then how do we go about mapping and documenting"
    },
    {
      "Time_Start": 887.68,
      "Time_End": 891.52,
      "Text": " what are all the API calls related to this click?"
    },
    {
      "Time_Start": 891.52,
      "Time_End": 893.1999999999999,
      "Text": " Cool."
    },
    {
      "Time_Start": 893.1999999999999,
      "Time_End": 901.0,
      "Text": " So looking through data can be a pain in the back sometimes, but we have some tips for"
    },
    {
      "Time_Start": 901.0,
      "Time_End": 902.0,
      "Text": " you."
    },
    {
      "Time_Start": 902.0,
      "Time_End": 904.56,
      "Text": " So if you open the hood, we can see some treasure inside of it."
    },
    {
      "Time_Start": 904.56,
      "Time_End": 908.56,
      "Text": " And these are the four golden rules that helped us very much."
    },
    {
      "Time_Start": 908.5600000000001,
      "Time_End": 914.2,
      "Text": " The first one is having full permission since you don't want to be losing time and giving"
    },
    {
      "Time_Start": 914.2,
      "Time_End": 918.12,
      "Text": " yourself manual permission every time you're trying to do something."
    },
    {
      "Time_Start": 918.12,
      "Time_End": 921.8000000000001,
      "Text": " It's having a new environment for each service."
    },
    {
      "Time_Start": 921.8000000000001,
      "Time_End": 925.5600000000001,
      "Text": " Lots of Excel spreadsheets where we track the time of our action."
    },
    {
      "Time_Start": 925.5600000000001,
      "Time_End": 931.08,
      "Text": " And Debo's favorite one, which is becoming mine too, lots of coffee or any coffee and"
    },
    {
      "Time_Start": 931.08,
      "Time_End": 933.9200000000001,
      "Text": " drink of your choice."
    },
    {
      "Time_Start": 933.9200000000001,
      "Time_End": 937.58,
      "Text": " Let's switch back to the data creation."
    },
    {
      "Time_Start": 937.58,
      "Time_End": 942.14,
      "Text": " We have three scenarios where we are running the list user action."
    },
    {
      "Time_Start": 942.14,
      "Time_End": 948.46,
      "Text": " And the difference between these are scenario A has no permission at all."
    },
    {
      "Time_Start": 948.46,
      "Time_End": 953.46,
      "Text": " So our user can only log into the profile but not do anything at all."
    },
    {
      "Time_Start": 953.46,
      "Time_End": 959.26,
      "Text": " Scenario B is where we gave our user explicit and manual permission to only have the list"
    },
    {
      "Time_Start": 959.26,
      "Time_End": 961.5,
      "Text": " user action."
    },
    {
      "Time_Start": 961.5,
      "Time_End": 964.62,
      "Text": " And scenario C where our user has everything."
    },
    {
      "Time_Start": 964.62,
      "Time_End": 966.22,
      "Text": " So he has full permission."
    },
    {
      "Time_Start": 966.22,
      "Time_End": 969.86,
      "Text": " Let's see what events were generated for each scenario."
    },
    {
      "Time_Start": 969.86,
      "Time_End": 974.9,
      "Text": " So for scenario A, we can see that we have only one log generated, and that's the I am"
    },
    {
      "Time_Start": 974.9,
      "Time_End": 976.1800000000001,
      "Text": " list user."
    },
    {
      "Time_Start": 976.1800000000001,
      "Time_End": 980.0600000000001,
      "Text": " And it was denied due to obvious reasons."
    },
    {
      "Time_Start": 980.0600000000001,
      "Time_End": 984.58,
      "Text": " Moving down to scenario B, we see something change."
    },
    {
      "Time_Start": 984.58,
      "Time_End": 988.0600000000001,
      "Text": " We see that the first action was indeed successful."
    },
    {
      "Time_Start": 988.0600000000001,
      "Time_End": 992.3000000000001,
      "Text": " And we have another five grouping of events which were denied."
    },
    {
      "Time_Start": 992.3000000000001,
      "Time_End": 994.6,
      "Text": " But they happened."
    },
    {
      "Time_Start": 994.6,
      "Time_End": 996.88,
      "Text": " In scenario C, we see some difference."
    },
    {
      "Time_Start": 996.88,
      "Time_End": 1003.52,
      "Text": " We see that the five grouping of events that we saw also in the previous scenario are now"
    },
    {
      "Time_Start": 1003.52,
      "Time_End": 1007.4,
      "Text": " successful and they occurred once per identity."
    },
    {
      "Time_Start": 1007.4,
      "Time_End": 1013.32,
      "Text": " If we check the request parameters, we can see that they are three I am users."
    },
    {
      "Time_Start": 1013.32,
      "Time_End": 1019.0,
      "Text": " So knowing that, we're going to keep these five grouping of events to our little map"
    },
    {
      "Time_Start": 1019.0,
      "Time_End": 1020.1600000000001,
      "Text": " to the side."
    },
    {
      "Time_Start": 1020.16,
      "Time_End": 1024.8,
      "Text": " And let's focus down to the last two button events which are the main difference."
    },
    {
      "Time_Start": 1024.8,
      "Time_End": 1029.6399999999999,
      "Text": " And we see that it's the get access key last used event."
    },
    {
      "Time_Start": 1029.6399999999999,
      "Time_End": 1037.44,
      "Text": " And what's interesting about this is that they are being called only because there are"
    },
    {
      "Time_Start": 1037.44,
      "Time_End": 1042.6,
      "Text": " two access keys present between these three I am users."
    },
    {
      "Time_Start": 1042.6,
      "Time_End": 1048.24,
      "Text": " But we know that the user may contain zero up to two access keys."
    },
    {
      "Time_Start": 1048.24,
      "Time_End": 1050.0,
      "Text": " But that zero means something."
    },
    {
      "Time_Start": 1050.04,
      "Time_End": 1054.08,
      "Text": " It means that they may have none, and this event might never occur."
    },
    {
      "Time_Start": 1054.08,
      "Time_End": 1060.16,
      "Text": " So our solution is let's group these events in three categories."
    },
    {
      "Time_Start": 1060.16,
      "Time_End": 1063.84,
      "Text": " And the first one is the anchor event, or the main event."
    },
    {
      "Time_Start": 1063.84,
      "Time_End": 1070.28,
      "Text": " The required events, and also the optional events which are, again, events that may happen."
    },
    {
      "Time_Start": 1070.28,
      "Time_End": 1075.18,
      "Text": " But if not, it's not that they'll be a deal-breaker for us."
    },
    {
      "Time_Start": 1075.18,
      "Time_End": 1079.44,
      "Text": " So if we look at these optional events, we kind of categorize it into two groupings."
    },
    {
      "Time_Start": 1079.44,
      "Time_End": 1083.1200000000001,
      "Text": " The first one we're just going to call background events because they just happen in the background"
    },
    {
      "Time_Start": 1083.1200000000001,
      "Time_End": 1086.44,
      "Text": " and truly are not related to any input action."
    },
    {
      "Time_Start": 1086.44,
      "Time_End": 1091.24,
      "Text": " So for example, if you just log into AWS console, you'll be presented with a console home, and"
    },
    {
      "Time_Start": 1091.24,
      "Time_End": 1093.68,
      "Text": " we can see all these blue events are just background events."
    },
    {
      "Time_Start": 1093.68,
      "Time_End": 1097.28,
      "Text": " If you were to walk away and take a two-hour coffee break, those events would kind of keep"
    },
    {
      "Time_Start": 1097.28,
      "Time_End": 1099.72,
      "Text": " popping off every couple of minutes."
    },
    {
      "Time_Start": 1099.72,
      "Time_End": 1104.0,
      "Text": " And so what we do is we basically try to separate these so that when we're writing definitions"
    },
    {
      "Time_Start": 1104.0,
      "Time_End": 1108.4,
      "Text": " for the mappings, we're truly only looking at the events that are related to that mapping."
    },
    {
      "Time_Start": 1108.4,
      "Time_End": 1112.64,
      "Text": " So we basically group all these events just so we can slide them out of the way and not"
    },
    {
      "Time_Start": 1112.64,
      "Time_End": 1115.8400000000001,
      "Text": " have to deal with them anymore so that we can focus on what's left, what truly is going"
    },
    {
      "Time_Start": 1115.8400000000001,
      "Time_End": 1119.2,
      "Text": " to tell us the input action."
    },
    {
      "Time_Start": 1119.2,
      "Time_End": 1122.92,
      "Text": " The other kind of optional event is based on context."
    },
    {
      "Time_Start": 1122.92,
      "Time_End": 1127.44,
      "Text": " And this is one of the trickiest things for us to learn kind of the hard way and had to"
    },
    {
      "Time_Start": 1127.44,
      "Time_End": 1131.48,
      "Text": " redo a lot of mapping because everything is connected."
    },
    {
      "Time_Start": 1131.48,
      "Time_End": 1136.72,
      "Text": " The more kinds of resources you have or configurations you have for any kind of object will then"
    },
    {
      "Time_Start": 1136.72,
      "Time_End": 1139.72,
      "Text": " create new events based on different clicks."
    },
    {
      "Time_Start": 1139.72,
      "Time_End": 1144.72,
      "Text": " And so this is why we basically try to reset our mappings to start with absolutely nothing"
    },
    {
      "Time_Start": 1144.72,
      "Time_End": 1148.1200000000001,
      "Text": " to get the core fundamentals and then go and add additional context."
    },
    {
      "Time_Start": 1148.1200000000001,
      "Time_End": 1152.28,
      "Text": " But to demonstrate this, we're going to create two identities."
    },
    {
      "Time_Start": 1152.28,
      "Time_End": 1156.6200000000001,
      "Text": " The everything bagel, which is going to have everything we can think of, all the access"
    },
    {
      "Time_Start": 1156.6200000000001,
      "Time_End": 1159.68,
      "Text": " and permissions and everything else, and then the plain bagel."
    },
    {
      "Time_Start": 1159.68,
      "Time_End": 1162.3600000000001,
      "Text": " So when I say everything, I mean everything."
    },
    {
      "Time_Start": 1162.3600000000001,
      "Time_End": 1167.8400000000001,
      "Text": " This IAM user has lots of attached policies, which are managed policies, a permissions"
    },
    {
      "Time_Start": 1167.8400000000001,
      "Time_End": 1168.8400000000001,
      "Text": " boundary."
    },
    {
      "Time_Start": 1168.8400000000001,
      "Time_End": 1172.7,
      "Text": " It's part of a group that also has policies, so those are inherited."
    },
    {
      "Time_Start": 1172.7,
      "Time_End": 1173.7,
      "Text": " We added tags."
    },
    {
      "Time_Start": 1173.7,
      "Time_End": 1176.5200000000002,
      "Text": " From a credential perspective, it has a login profile."
    },
    {
      "Time_Start": 1176.5200000000002,
      "Time_End": 1178.2400000000002,
      "Text": " We added a virtual MFA device."
    },
    {
      "Time_Start": 1178.2400000000002,
      "Time_End": 1183.96,
      "Text": " It has two access keys, both of which are active, SSH public keys, and on and on and"
    },
    {
      "Time_Start": 1183.96,
      "Time_End": 1184.96,
      "Text": " on."
    },
    {
      "Time_Start": 1184.96,
      "Time_End": 1188.92,
      "Text": " Again, anything we could think of that AWS allowed us to add to it, we did."
    },
    {
      "Time_Start": 1188.92,
      "Time_End": 1191.6000000000001,
      "Text": " And the plain bagel has literally nothing."
    },
    {
      "Time_Start": 1191.6000000000001,
      "Time_End": 1193.64,
      "Text": " Not even a login profile."
    },
    {
      "Time_Start": 1193.64,
      "Time_End": 1199.0800000000002,
      "Text": " So now if we were to click into each of these IAM users in different tabs, then how would"
    },
    {
      "Time_Start": 1199.0800000000002,
      "Time_End": 1200.48,
      "Text": " those events look different?"
    },
    {
      "Time_Start": 1200.48,
      "Time_End": 1204.1200000000001,
      "Text": " So if we click on the permissions tab for the plain bagel, we can see this listing of"
    },
    {
      "Time_Start": 1204.1200000000001,
      "Time_End": 1208.92,
      "Text": " events, and if we click on it with everything bagel, we see a few more events."
    },
    {
      "Time_Start": 1208.92,
      "Time_End": 1212.98,
      "Text": " Now before we go and look at these comparisons, I do kind of want to draw your attention even"
    },
    {
      "Time_Start": 1212.98,
      "Time_End": 1218.72,
      "Text": " to the same API call, AWS is actually using two different user agent strings."
    },
    {
      "Time_Start": 1218.72,
      "Time_End": 1221.3600000000001,
      "Text": " For the same access keys that are here."
    },
    {
      "Time_Start": 1221.3600000000001,
      "Time_End": 1227.64,
      "Text": " There is incredible diversity in the user agents, and almost like the coding style between"
    },
    {
      "Time_Start": 1227.64,
      "Time_End": 1232.1200000000001,
      "Text": " different AWS services that you can see, the more that you spend time in these logs."
    },
    {
      "Time_Start": 1232.1200000000001,
      "Time_End": 1233.1200000000001,
      "Text": " And it makes sense."
    },
    {
      "Time_Start": 1233.1200000000001,
      "Time_End": 1236.72,
      "Text": " There are different teams of humans at AWS doing these different services, so there will"
    },
    {
      "Time_Start": 1236.72,
      "Time_End": 1239.2,
      "Text": " be some differences that you see."
    },
    {
      "Time_Start": 1239.2,
      "Time_End": 1242.3600000000001,
      "Text": " But keep that in mind, there's a lot of different ways that we try to normalize some of these"
    },
    {
      "Time_Start": 1242.3600000000001,
      "Time_End": 1248.1000000000001,
      "Text": " values to make it simpler to write the kind of signal mapping logic for this."
    },
    {
      "Time_Start": 1248.7800000000002,
      "Time_End": 1254.14,
      "Text": " Comparing the everything in plain bagel, we can group these into a few different buckets."
    },
    {
      "Time_Start": 1254.14,
      "Time_End": 1256.42,
      "Text": " Everything in green, common events."
    },
    {
      "Time_Start": 1256.42,
      "Time_End": 1261.3400000000001,
      "Text": " And not only common events, but common request parameters, common user agent strings, everything"
    },
    {
      "Time_Start": 1261.3400000000001,
      "Time_End": 1262.3400000000001,
      "Text": " is identical."
    },
    {
      "Time_Start": 1262.3400000000001,
      "Time_End": 1266.14,
      "Text": " And in the yellow and purple, we do see some differences there."
    },
    {
      "Time_Start": 1266.14,
      "Time_End": 1267.14,
      "Text": " Let's go to one more tab."
    },
    {
      "Time_Start": 1267.14,
      "Time_End": 1271.8600000000001,
      "Text": " If we were to click on the security credentials tab, we'll see again a pretty similar grouping"
    },
    {
      "Time_Start": 1271.8600000000001,
      "Time_End": 1275.96,
      "Text": " of most of those events are going to be common between the two, but in the purple box we"
    },
    {
      "Time_Start": 1275.96,
      "Time_End": 1279.32,
      "Text": " see there are a few differences."
    },
    {
      "Time_Start": 1279.32,
      "Time_End": 1282.68,
      "Text": " One really cool thing here is you'll notice this get access key last used pops up quite"
    },
    {
      "Time_Start": 1282.68,
      "Time_End": 1283.68,
      "Text": " a bit."
    },
    {
      "Time_Start": 1283.68,
      "Time_End": 1288.24,
      "Text": " All of these logs, like it's important for us to group all these logs to say this one"
    },
    {
      "Time_Start": 1288.24,
      "Time_End": 1292.32,
      "Text": " input action produced these logs, but if you kind of pause for a second, if you're an incident"
    },
    {
      "Time_Start": 1292.32,
      "Time_End": 1297.1200000000001,
      "Text": " responder and someone just exported these logs and gave them to you, not only can you"
    },
    {
      "Time_Start": 1297.1200000000001,
      "Time_End": 1301.4,
      "Text": " map it and say this is the input action, but there's a lot of information in there that"
    },
    {
      "Time_Start": 1301.4,
      "Time_End": 1304.24,
      "Text": " tells you about the environment state at that time."
    },
    {
      "Time_Start": 1304.24,
      "Time_End": 1308.96,
      "Text": " For example, these are the three IAM users that were active at that time and that showed"
    },
    {
      "Time_Start": 1308.96,
      "Time_End": 1312.5,
      "Text": " up on the screen when the person clicked this."
    },
    {
      "Time_Start": 1312.5,
      "Time_End": 1316.44,
      "Text": " These are the access keys that were present and active at that time."
    },
    {
      "Time_Start": 1316.44,
      "Time_End": 1320.36,
      "Text": " And so when we've done investigations, it makes sense why the attacker clicked on this"
    },
    {
      "Time_Start": 1320.36,
      "Time_End": 1325.08,
      "Text": " specific user because when you see the list of 10 or 20 users that were there, of course"
    },
    {
      "Time_Start": 1325.08,
      "Time_End": 1328.6,
      "Text": " they'd click on the one that has the word security in it, given all the other users"
    },
    {
      "Time_Start": 1328.6,
      "Time_End": 1329.6,
      "Text": " that were there."
    },
    {
      "Time_Start": 1329.6,
      "Time_End": 1333.28,
      "Text": " So there's a lot of context that you can see from these logs and the tool that we wrote,"
    },
    {
      "Time_Start": 1333.32,
      "Time_End": 1337.16,
      "Text": " we designed it to extract that information and to present it in as usable a format as"
    },
    {
      "Time_Start": 1337.16,
      "Time_End": 1338.16,
      "Text": " possible."
    },
    {
      "Time_Start": 1338.16,
      "Time_End": 1340.76,
      "Text": " Thank you, Debo."
    },
    {
      "Time_Start": 1340.76,
      "Time_End": 1348.58,
      "Text": " So we saw some events that were happening and now let's just take a step back and see"
    },
    {
      "Time_Start": 1348.58,
      "Time_End": 1354.68,
      "Text": " what would be the difference between running some of these events from three perspectives."
    },
    {
      "Time_Start": 1354.68,
      "Time_End": 1361.8,
      "Text": " And by perspective, I mean first running them through the AWS CLI, the BOTO3, and last in"
    },
    {
      "Time_Start": 1361.8,
      "Time_End": 1363.28,
      "Text": " a web console from a browser."
    },
    {
      "Time_Start": 1363.28,
      "Time_End": 1367.24,
      "Text": " Now let's see what actions I'm talking about."
    },
    {
      "Time_Start": 1367.24,
      "Time_End": 1375.96,
      "Text": " We have three-ish and the first one is creating a user, creating an access key for that user,"
    },
    {
      "Time_Start": 1375.96,
      "Time_End": 1378.2,
      "Text": " and lastly attaching a user policy."
    },
    {
      "Time_Start": 1378.2,
      "Time_End": 1383.28,
      "Text": " Now moving down to see what events are generated for each of these actions, we are not surprised,"
    },
    {
      "Time_Start": 1383.28,
      "Time_End": 1389.56,
      "Text": " we're expecting three output events from the three input events that we did, totally fine."
    },
    {
      "Time_Start": 1389.56,
      "Time_End": 1393.32,
      "Text": " There's a small difference between them that we can see that the event source and the event"
    },
    {
      "Time_Start": 1393.32,
      "Time_End": 1397.08,
      "Text": " name is appended at the back of each user agent."
    },
    {
      "Time_Start": 1397.08,
      "Time_End": 1402.8,
      "Text": " So three input events, three output events, very nice, very clean."
    },
    {
      "Time_Start": 1402.8,
      "Time_End": 1408.6799999999998,
      "Text": " Moving down to the BOTO3 SDK, we have the same actions, we are creating a user, creating"
    },
    {
      "Time_Start": 1408.6799999999998,
      "Time_End": 1412.52,
      "Text": " an access key, and attaching a user policy to this user."
    },
    {
      "Time_Start": 1412.6399999999999,
      "Time_End": 1420.6399999999999,
      "Text": " Again, three output events with a small difference between them and that's actually not a small"
    },
    {
      "Time_Start": 1420.6399999999999,
      "Time_End": 1426.4,
      "Text": " difference, they are no difference at all, it's the user agent is the same across them."
    },
    {
      "Time_Start": 1426.4,
      "Time_End": 1436.02,
      "Text": " Now if we move down to the console, now we're going to do a roadmap between each user click"
    },
    {
      "Time_Start": 1436.02,
      "Time_End": 1441.68,
      "Text": " that an actual user needs to make in order to recreate the same three steps."
    },
    {
      "Time_Start": 1441.68,
      "Time_End": 1447.5600000000002,
      "Text": " Now let's see what the first one is the console home or the home page that we get redirected"
    },
    {
      "Time_Start": 1447.5600000000002,
      "Time_End": 1455.0,
      "Text": " once we are logged in, and for that we have 13 logs generated in CloudTrail."
    },
    {
      "Time_Start": 1455.0,
      "Time_End": 1459.68,
      "Text": " Now let's keep that to the side and we can keep track of the number."
    },
    {
      "Time_Start": 1459.68,
      "Time_End": 1466.0,
      "Text": " We have one event generated for just clicking the search bar, and eight events generated"
    },
    {
      "Time_Start": 1466.0,
      "Time_End": 1470.44,
      "Text": " after clicking the IAM service icon."
    },
    {
      "Time_Start": 1470.44,
      "Time_End": 1473.8,
      "Text": " So we have nine events."
    },
    {
      "Time_Start": 1473.8,
      "Time_End": 1480.24,
      "Text": " Going down to the IAM users, 18 events, and we're going to talk later about the worst"
    },
    {
      "Time_Start": 1480.24,
      "Time_End": 1488.24,
      "Text": " case scenario for this specific click, so 18 events would sound like a pretty good scenario."
    },
    {
      "Time_Start": 1488.24,
      "Time_End": 1494.12,
      "Text": " Moving further down, now we are starting to recreate the first step and that's the user"
    },
    {
      "Time_Start": 1494.1200000000001,
      "Time_End": 1500.3200000000002,
      "Text": " creation and we'll hit the create user button, four events, again, attaching a user policy"
    },
    {
      "Time_Start": 1500.3200000000002,
      "Time_End": 1506.0000000000002,
      "Text": " to that user, which has 15 events."
    },
    {
      "Time_Start": 1506.0000000000002,
      "Time_End": 1512.0000000000002,
      "Text": " Moving further down, we have the last step finally, which is creating a user, which accounts"
    },
    {
      "Time_Start": 1512.0000000000002,
      "Time_End": 1517.2,
      "Text": " for three events, and immediately, as you can see from the chain, we get redirected"
    },
    {
      "Time_Start": 1517.2,
      "Time_End": 1522.8000000000002,
      "Text": " to the permission tab of that user, and we have 13 events totally."
    },
    {
      "Time_Start": 1522.8,
      "Time_End": 1526.28,
      "Text": " Great access key, surprisingly, only one event."
    },
    {
      "Time_Start": 1526.28,
      "Time_End": 1528.04,
      "Text": " That's cool."
    },
    {
      "Time_Start": 1528.04,
      "Time_End": 1533.6399999999999,
      "Text": " Speaking from the user agent perspective, we see a variety of them, like only 10 events"
    },
    {
      "Time_Start": 1533.6399999999999,
      "Time_End": 1541.6,
      "Text": " generated from our actual browser, and the other user browser consists of AWS internals,"
    },
    {
      "Time_Start": 1541.6,
      "Time_End": 1549.36,
      "Text": " Java versions of user agents, and also some health, which were mentioned as optional events."
    },
    {
      "Time_Start": 1550.3600000000001,
      "Time_End": 1556.0800000000002,
      "Text": " 73 events from the nine clicks that we have, so again, in comparison, three input events"
    },
    {
      "Time_Start": 1556.0800000000002,
      "Time_End": 1566.0800000000002,
      "Text": " and three output events for both AWS CLI and Boto3, and only 73 events only, yeah, for"
    },
    {
      "Time_Start": 1566.0800000000002,
      "Time_End": 1570.64,
      "Text": " the console, and if that doesn't sound much, wait until the next slide."
    },
    {
      "Time_Start": 1570.64,
      "Time_End": 1576.6000000000001,
      "Text": " So we thought it would be interesting to come up with a mathematical formula so we could"
    },
    {
      "Time_Start": 1576.6000000000001,
      "Time_End": 1582.2800000000002,
      "Text": " kind of predict how many events will be generated for this particular click."
    },
    {
      "Time_Start": 1582.2800000000002,
      "Time_End": 1588.0800000000002,
      "Text": " So we have the one, which is a constant, and represents the anchor event."
    },
    {
      "Time_Start": 1588.0800000000002,
      "Time_End": 1596.2800000000002,
      "Text": " We have five times n, where n will be the number of available IAM users, and lastly,"
    },
    {
      "Time_Start": 1596.2800000000002,
      "Time_End": 1602.72,
      "Text": " we have the get access key last used, which again, a user may contain zero of the two"
    },
    {
      "Time_Start": 1602.72,
      "Time_End": 1605.96,
      "Text": " access keys, so in our case, we had only two."
    },
    {
      "Time_Start": 1605.96,
      "Time_End": 1609.68,
      "Text": " Now, let's increase that number a bit."
    },
    {
      "Time_Start": 1609.68,
      "Time_End": 1618.8,
      "Text": " If we have available 20 IAM users and hit the list users button, we'll have 141 events,"
    },
    {
      "Time_Start": 1618.8,
      "Time_End": 1627.2,
      "Text": " and if we keep increasing that number to 50, we'll have 351 events, and if we have 100"
    },
    {
      "Time_Start": 1627.2,
      "Time_End": 1635.76,
      "Text": " available IAM users, we'll get 701 events generated from only that click."
    },
    {
      "Time_Start": 1636.56,
      "Time_End": 1643.08,
      "Text": " The same approach came for the S3 service, where, for 100 available S3 buckets, we'll"
    },
    {
      "Time_Start": 1643.08,
      "Time_End": 1648.8799999999999,
      "Text": " get 421 events generated."
    },
    {
      "Time_Start": 1648.8799999999999,
      "Time_End": 1652.72,
      "Text": " In this research, we were kind of hoping there would be some shortcuts we could find, like"
    },
    {
      "Time_Start": 1652.72,
      "Time_End": 1657.08,
      "Text": " Andi mentioned, however, looking at the user agents, even the consistency of the user agent"
    },
    {
      "Time_Start": 1657.08,
      "Time_End": 1662.32,
      "Text": " string showing up as Mozilla, as coming from the web browser, the events that were present"
    },
    {
      "Time_Start": 1662.32,
      "Time_End": 1665.08,
      "Text": " really didn't tell the story."
    },
    {
      "Time_Start": 1665.36,
      "Time_End": 1669.6399999999999,
      "Text": " When the events are create user or create access key, those are pretty self-explanatory"
    },
    {
      "Time_Start": 1669.6399999999999,
      "Time_End": 1674.1599999999999,
      "Text": " if you see those in a mix of events, but there are a lot of clicks that don't have any explicit"
    },
    {
      "Time_Start": 1674.1599999999999,
      "Time_End": 1676.6799999999998,
      "Text": " APIs that make sense for what is happening there."
    },
    {
      "Time_Start": 1676.6799999999998,
      "Time_End": 1679.6399999999999,
      "Text": " Ultimately, what we're doing is trying to aggregate this data."
    },
    {
      "Time_Start": 1679.6399999999999,
      "Time_End": 1683.3999999999999,
      "Text": " After we manually map it, we're trying to define all these individual events so we can"
    },
    {
      "Time_Start": 1683.3999999999999,
      "Time_End": 1688.0,
      "Text": " say in summation, these are the events related to clicking this IAM users button."
    },
    {
      "Time_Start": 1688.0,
      "Time_End": 1691.52,
      "Text": " These are the events related to clicking the create user button."
    },
    {
      "Time_Start": 1691.52,
      "Time_End": 1695.6399999999999,
      "Text": " This is the event for creating that access key, and all along, as much as we can, let's"
    },
    {
      "Time_Start": 1695.6399999999999,
      "Time_End": 1699.96,
      "Text": " identify those background events and get them out of the way because it's not directly related"
    },
    {
      "Time_Start": 1699.96,
      "Time_End": 1702.92,
      "Text": " to an input action from the user."
    },
    {
      "Time_Start": 1702.92,
      "Time_End": 1704.32,
      "Text": " So that's the problem."
    },
    {
      "Time_Start": 1704.32,
      "Time_End": 1705.68,
      "Text": " Now, the solution."
    },
    {
      "Time_Start": 1705.68,
      "Time_End": 1707.68,
      "Text": " How do we actually go about technically solving this?"
    },
    {
      "Time_Start": 1707.68,
      "Time_End": 1711.4,
      "Text": " Well, as Andi mentioned, we break everything up into anchor events, required events, and"
    },
    {
      "Time_Start": 1711.4,
      "Time_End": 1712.8799999999999,
      "Text": " optional events."
    },
    {
      "Time_Start": 1712.8799999999999,
      "Time_End": 1718.12,
      "Text": " We kind of take a two-pass approach across all the events we're ingesting."
    },
    {
      "Time_Start": 1718.12,
      "Time_End": 1719.52,
      "Text": " One pass is adding labels."
    },
    {
      "Time_Start": 1719.52,
      "Time_End": 1721.08,
      "Text": " The second pass is doing signals."
    },
    {
      "Time_Start": 1721.6399999999999,
      "Time_End": 1725.6,
      "Text": " And so when we want to define a signal for IAM users, we take the same exact construct"
    },
    {
      "Time_Start": 1725.6,
      "Time_End": 1730.76,
      "Text": " of anchor, required, and optional, and it's directly related to the actual signal class"
    },
    {
      "Time_Start": 1730.76,
      "Time_End": 1731.96,
      "Text": " that we have."
    },
    {
      "Time_Start": 1731.96,
      "Time_End": 1736.8,
      "Text": " So you're defining not only these events, but also metadata about the event."
    },
    {
      "Time_Start": 1736.8,
      "Time_End": 1742.3999999999999,
      "Text": " Think of this like an alert name, an alert description to basically say, if this occurs"
    },
    {
      "Time_Start": 1742.3999999999999,
      "Time_End": 1746.24,
      "Text": " in your logs, what should be presented to you as the analyst?"
    },
    {
      "Time_Start": 1746.24,
      "Time_End": 1747.76,
      "Text": " How would you describe this action?"
    },
    {
      "Time_Start": 1747.76,
      "Time_End": 1749.1599999999999,
      "Text": " What would the URL be?"
    },
    {
      "Time_Start": 1749.24,
      "Time_End": 1753.2,
      "Text": " And what you'll notice is that there's also placeholders in here for updating the content."
    },
    {
      "Time_Start": 1753.2,
      "Time_End": 1758.6000000000001,
      "Text": " And so again, if you click IAM users and there's 20 users present, when that signal is generated,"
    },
    {
      "Time_Start": 1758.6000000000001,
      "Time_End": 1760.92,
      "Text": " you'll actually see the number 20."
    },
    {
      "Time_Start": 1760.92,
      "Time_End": 1762.1200000000001,
      "Text": " You'll see the 20 users."
    },
    {
      "Time_Start": 1762.1200000000001,
      "Time_End": 1766.88,
      "Text": " You'll see any access keys that are present, both in the description as well as in an additional"
    },
    {
      "Time_Start": 1766.88,
      "Time_End": 1772.8400000000001,
      "Text": " data object that contains programmatically accessible details from that event."
    },
    {
      "Time_Start": 1772.8400000000001,
      "Time_End": 1774.8000000000002,
      "Text": " So the first pass is adding labels."
    },
    {
      "Time_Start": 1774.8000000000002,
      "Time_End": 1776.8400000000001,
      "Text": " So we're looking at each individual event."
    },
    {
      "Time_Start": 1777.0800000000002,
      "Time_End": 1781.0400000000002,
      "Text": " We're looking at all the details like request and response parameters, user agent, service"
    },
    {
      "Time_Start": 1781.0400000000002,
      "Time_End": 1785.16,
      "Text": " name, event name, and then we're adding one or more labels to that event."
    },
    {
      "Time_Start": 1785.16,
      "Time_End": 1788.68,
      "Text": " So if the event comes in and it matches all these criteria, then these are all the labels"
    },
    {
      "Time_Start": 1788.68,
      "Time_End": 1791.68,
      "Text": " that are added in this specific order."
    },
    {
      "Time_Start": 1791.68,
      "Time_End": 1796.1200000000001,
      "Text": " Ordering has become such an important thing the more that we've done this mapping, and"
    },
    {
      "Time_Start": 1796.1200000000001,
      "Time_End": 1800.0800000000002,
      "Text": " there are several different levels of ordering that we have to keep in mind."
    },
    {
      "Time_Start": 1800.0800000000002,
      "Time_End": 1803.5200000000002,
      "Text": " The second pass then says, OK, we've gone through all the events one by one."
    },
    {
      "Time_Start": 1803.52,
      "Time_End": 1807.8,
      "Text": " We've added the label or labels to each event, if there are any."
    },
    {
      "Time_Start": 1807.8,
      "Time_End": 1808.8,
      "Text": " And now we're going to go back."
    },
    {
      "Time_Start": 1808.8,
      "Time_End": 1811.48,
      "Text": " And remember how we talked about there's anchor events?"
    },
    {
      "Time_Start": 1811.48,
      "Time_End": 1817.12,
      "Text": " Well, if I go back one slide, if any one of these signal definitions said, by the way,"
    },
    {
      "Time_Start": 1817.12,
      "Time_End": 1820.84,
      "Text": " list users as an anchor event, then there's a Boolean flag that will be set to true."
    },
    {
      "Time_Start": 1820.84,
      "Time_End": 1824.96,
      "Text": " So in the second pass, as we go through event by event, whenever we reach an anchor event,"
    },
    {
      "Time_Start": 1824.96,
      "Time_End": 1829.44,
      "Text": " we stop and then we look at the list of labels applied to that event, and we go down the"
    },
    {
      "Time_Start": 1829.44,
      "Time_End": 1834.76,
      "Text": " line and say for this first label, look behind X seconds, look ahead X seconds, and retrieve"
    },
    {
      "Time_Start": 1834.76,
      "Time_End": 1837.6000000000001,
      "Text": " all the events that also have that same label applied."
    },
    {
      "Time_Start": 1837.6000000000001,
      "Time_End": 1842.2,
      "Text": " And then take that together, summarize that, and then say, does this match the required"
    },
    {
      "Time_Start": 1842.2,
      "Time_End": 1844.92,
      "Text": " signal definition for this mapping?"
    },
    {
      "Time_Start": 1844.92,
      "Time_End": 1847.44,
      "Text": " If yes, awesome."
    },
    {
      "Time_Start": 1847.44,
      "Time_End": 1851.0,
      "Text": " Update all the flags and say, these are now all contributing to the signal, and move on."
    },
    {
      "Time_Start": 1851.0,
      "Time_End": 1853.96,
      "Text": " If not, then go to the next label, and the next one, and the next one."
    },
    {
      "Time_Start": 1853.96,
      "Time_End": 1858.8400000000001,
      "Text": " And do that evaluation before and ahead."
    },
    {
      "Time_Start": 1859.2400000000002,
      "Time_End": 1864.5200000000002,
      "Text": " And the last thing I'll say before we actually do a demo here is we do this not just to pull"
    },
    {
      "Time_Start": 1864.5200000000002,
      "Time_End": 1868.7200000000003,
      "Text": " the events together, but also to extract the data out of it, as I mentioned before."
    },
    {
      "Time_Start": 1868.7200000000003,
      "Time_End": 1873.3600000000001,
      "Text": " There are a lot of really complicated tricks that we had to come up with to accommodate"
    },
    {
      "Time_Start": 1873.3600000000001,
      "Time_End": 1875.4800000000002,
      "Text": " some very interesting situations."
    },
    {
      "Time_Start": 1875.4800000000002,
      "Time_End": 1884.7600000000002,
      "Text": " For example, like, if you're creating a user or certain properties you're adding to a user,"
    },
    {
      "Time_Start": 1884.7600000000002,
      "Time_End": 1886.8000000000002,
      "Text": " then there could be four or five steps in that process."
    },
    {
      "Time_Start": 1886.8,
      "Time_End": 1890.96,
      "Text": " The first process might have an event that says this is the user name that we're modifying."
    },
    {
      "Time_Start": 1890.96,
      "Time_End": 1893.2,
      "Text": " But maybe the third and fourth steps don't."
    },
    {
      "Time_Start": 1893.2,
      "Time_End": 1896.08,
      "Text": " It might just be one or two events, but none of those events actually contain the user"
    },
    {
      "Time_Start": 1896.08,
      "Time_End": 1897.28,
      "Text": " name information."
    },
    {
      "Time_Start": 1897.28,
      "Time_End": 1900.96,
      "Text": " So what we can do is say, we're going to fire this signal for this mapping, but by the way,"
    },
    {
      "Time_Start": 1900.96,
      "Time_End": 1905.8799999999999,
      "Text": " we're going to look at the previous one, two, three signals, and if those signals start"
    },
    {
      "Time_Start": 1905.8799999999999,
      "Time_End": 1909.12,
      "Text": " with this, then we know that we can pull that user name from previous signals and carry"
    },
    {
      "Time_Start": 1909.12,
      "Time_End": 1911.06,
      "Text": " it forward into that mapping."
    },
    {
      "Time_Start": 1911.06,
      "Time_End": 1914.0,
      "Text": " There are also times where we have to merge signals together."
    },
    {
      "Time_Start": 1914.0,
      "Time_End": 1918.8,
      "Text": " And then sometimes where a current signal can be modified by a previous signal, or even"
    },
    {
      "Time_Start": 1918.8,
      "Time_End": 1922.68,
      "Text": " where a current signal can say, actually, let's modify the signal before us, because"
    },
    {
      "Time_Start": 1922.68,
      "Time_End": 1923.68,
      "Text": " we have more information."
    },
    {
      "Time_Start": 1923.68,
      "Time_End": 1928.68,
      "Text": " So, like, for example, any time you expand a policy, there are many places in the AWS"
    },
    {
      "Time_Start": 1928.68,
      "Time_End": 1930.76,
      "Text": " console where you can expand a policy."
    },
    {
      "Time_Start": 1930.76,
      "Time_End": 1935.72,
      "Text": " So we can generically say a policy was expanded, but if we know the last couple signals were"
    },
    {
      "Time_Start": 1935.72,
      "Time_End": 1940.66,
      "Text": " us creating a new user, then we can say, hey, this is actually step 1.2 of creating a user"
    },
    {
      "Time_Start": 1940.8200000000002,
      "Time_End": 1944.1000000000001,
      "Text": " and this policy was expanded."
    },
    {
      "Time_Start": 1944.1000000000001,
      "Time_End": 1949.6200000000001,
      "Text": " So with that, let's do a little demo."
    },
    {
      "Time_Start": 1949.6200000000001,
      "Time_End": 1951.0400000000002,
      "Text": " This is the ultimate speed run."
    },
    {
      "Time_Start": 1951.0400000000002,
      "Time_End": 1952.7,
      "Text": " This is not fast forwarded at all."
    },
    {
      "Time_Start": 1952.7,
      "Time_End": 1956.5400000000002,
      "Text": " We're going to basically pretend like we're an attacker and emulate some techniques that"
    },
    {
      "Time_Start": 1956.5400000000002,
      "Time_End": 1959.5,
      "Text": " we've seen throughout several investigations."
    },
    {
      "Time_Start": 1959.5,
      "Time_End": 1960.8600000000001,
      "Text": " So attacker logs in."
    },
    {
      "Time_Start": 1960.8600000000001,
      "Time_End": 1963.9,
      "Text": " They're going to go into the IAM service and enumerate some users."
    },
    {
      "Time_Start": 1963.9,
      "Time_End": 1965.8200000000002,
      "Text": " We're going to click on this user called Petula."
    },
    {
      "Time_Start": 1965.8200000000002,
      "Time_End": 1968.02,
      "Text": " We're going to click on the permissions tab, security credentials."
    },
    {
      "Time_Start": 1968.58,
      "Time_End": 1973.3799999999999,
      "Text": " Actually, let's give ourselves a login profile so we can log into the console with this identity."
    },
    {
      "Time_Start": 1973.3799999999999,
      "Time_End": 1974.62,
      "Text": " So we create that."
    },
    {
      "Time_Start": 1974.62,
      "Time_End": 1977.58,
      "Text": " The next thing, we want to have an access key, but the two are already defined."
    },
    {
      "Time_Start": 1977.58,
      "Time_End": 1982.46,
      "Text": " So we have to deactivate one and then delete that key so we can then go and create a new"
    },
    {
      "Time_Start": 1982.46,
      "Time_End": 1986.72,
      "Text": " key and get that key material and use that as a form of persistence."
    },
    {
      "Time_Start": 1986.72,
      "Time_End": 1988.54,
      "Text": " So here we are creating this access key."
    },
    {
      "Time_Start": 1988.54,
      "Time_End": 1992.3799999999999,
      "Text": " I'm not going to bother clicking on the material there, but that's the step that you would"
    },
    {
      "Time_Start": 1992.3799999999999,
      "Time_End": 1993.46,
      "Text": " do."
    },
    {
      "Time_Start": 1993.46,
      "Time_End": 1996.26,
      "Text": " So next, let's go and look at secrets manager."
    },
    {
      "Time_Start": 1996.26,
      "Time_End": 2000.62,
      "Text": " We'd like to see what secrets are stored in secrets manager, which is like a password"
    },
    {
      "Time_Start": 2000.62,
      "Time_End": 2002.82,
      "Text": " vault that AWS provides."
    },
    {
      "Time_Start": 2002.82,
      "Time_End": 2004.5,
      "Text": " And so there's only a couple of secrets here."
    },
    {
      "Time_Start": 2004.5,
      "Time_End": 2008.7,
      "Text": " Let's click on the first one, which is Open Yeri, and we'll click on the overview."
    },
    {
      "Time_Start": 2008.7,
      "Time_End": 2010.78,
      "Text": " You can see the actual value that's there."
    },
    {
      "Time_Start": 2010.78,
      "Time_End": 2011.78,
      "Text": " That's cool."
    },
    {
      "Time_Start": 2011.78,
      "Time_End": 2013.58,
      "Text": " But an attacker wants to be a little more efficient."
    },
    {
      "Time_Start": 2013.58,
      "Time_End": 2019.58,
      "Text": " So let's just open up Cloud Shell and programmatically run with AWS CLI or the Bodo Python script"
    },
    {
      "Time_Start": 2019.58,
      "Time_End": 2024.02,
      "Text": " and enumerate all those keys, outputting them to secrets.json, and then we have a very convenient"
    },
    {
      "Time_Start": 2024.02,
      "Time_End": 2026.86,
      "Text": " GUI to say, hey, just go download that file."
    },
    {
      "Time_Start": 2026.86,
      "Time_End": 2030.78,
      "Text": " We'll just wait a second for that to download, and if you look on the upper right, we'll"
    },
    {
      "Time_Start": 2030.78,
      "Time_End": 2035.58,
      "Text": " see it in just 3, 2, 1, 1, 1, 1."
    },
    {
      "Time_Start": 2035.58,
      "Time_End": 2036.58,
      "Text": " There we go."
    },
    {
      "Time_Start": 2036.58,
      "Time_End": 2037.58,
      "Text": " There's the file."
    },
    {
      "Time_Start": 2037.58,
      "Time_End": 2038.7,
      "Text": " So the download was successful."
    },
    {
      "Time_Start": 2038.7,
      "Time_End": 2039.98,
      "Text": " Let's do a little more enumeration."
    },
    {
      "Time_Start": 2039.98,
      "Time_End": 2041.62,
      "Text": " Let's go and look at S3."
    },
    {
      "Time_Start": 2041.62,
      "Time_End": 2046.82,
      "Text": " As an attacker, I want to know what kind of data might be stored based on bucket names."
    },
    {
      "Time_Start": 2046.82,
      "Time_End": 2050.34,
      "Text": " So again, we're just going to go in and click on a bucket."
    },
    {
      "Time_Start": 2050.34,
      "Time_End": 2054.26,
      "Text": " We're going to click on the FLIA bucket, click a couple tabs, objects, permissions,"
    },
    {
      "Time_Start": 2054.26,
      "Time_End": 2058.1000000000004,
      "Text": " management, et cetera, access points, and then let's do one last thing before we actually"
    },
    {
      "Time_Start": 2058.1000000000004,
      "Time_End": 2061.7400000000002,
      "Text": " look at what the logs are producing."
    },
    {
      "Time_Start": 2061.7400000000002,
      "Time_End": 2062.7400000000002,
      "Text": " This is one of my favorites."
    },
    {
      "Time_Start": 2062.7400000000002,
      "Time_End": 2063.82,
      "Text": " This is an EC2."
    },
    {
      "Time_Start": 2063.82,
      "Time_End": 2069.58,
      "Text": " In this account, we have zero EC2 infrastructure, but if we click on EC2 global view, there"
    },
    {
      "Time_Start": 2069.58,
      "Time_End": 2074.1400000000003,
      "Text": " are over 300 events that get produced just by this one click with no resources present,"
    },
    {
      "Time_Start": 2074.1400000000003,
      "Time_End": 2076.86,
      "Text": " and it's so much that you can actually see it has a progress bar because it's running"
    },
    {
      "Time_Start": 2077.1800000000003,
      "Time_End": 2082.7000000000003,
      "Text": " all these individual checks in all the available regions."
    },
    {
      "Time_Start": 2082.7000000000003,
      "Time_End": 2085.98,
      "Text": " So as defenders, what do we do with this information?"
    },
    {
      "Time_Start": 2085.98,
      "Time_End": 2089.86,
      "Text": " Well, if we grab those logs, these logs are actually available in the demo folder of the"
    },
    {
      "Time_Start": 2089.86,
      "Time_End": 2091.1800000000003,
      "Text": " project."
    },
    {
      "Time_Start": 2091.1800000000003,
      "Time_End": 2093.1800000000003,
      "Text": " So first, let's do that first pass."
    },
    {
      "Time_Start": 2093.1800000000003,
      "Time_End": 2096.8,
      "Text": " Let's add signals, which is going to be the labels and the signal generation."
    },
    {
      "Time_Start": 2096.8,
      "Time_End": 2098.7000000000003,
      "Text": " Let's look at the first couple."
    },
    {
      "Time_Start": 2098.7000000000003,
      "Time_End": 2103.2200000000003,
      "Text": " What's really cool about this is we keep the original event, and then we add an enrichment"
    },
    {
      "Time_Start": 2103.2200000000003,
      "Time_End": 2108.94,
      "Text": " object, which contains all the labels or potential signals that can be added."
    },
    {
      "Time_Start": 2108.94,
      "Time_End": 2113.34,
      "Text": " So here we have the original event, and then the signal information in that enrichment"
    },
    {
      "Time_Start": 2113.34,
      "Time_End": 2114.34,
      "Text": " object."
    },
    {
      "Time_Start": 2114.34,
      "Time_End": 2116.78,
      "Text": " In this case, there's actually no signal that fired."
    },
    {
      "Time_Start": 2116.78,
      "Time_End": 2120.96,
      "Text": " So let's actually choose one where there is an enrichment.signal object."
    },
    {
      "Time_Start": 2120.96,
      "Time_End": 2125.5400000000004,
      "Text": " So here's one where we have an actual list users event, and we can see that's when IM"
    },
    {
      "Time_Start": 2125.5400000000004,
      "Time_End": 2126.5400000000004,
      "Text": " users was clicked."
    },
    {
      "Time_Start": 2126.5400000000004,
      "Time_End": 2130.46,
      "Text": " So we have all this information here that we've enriched and said, hey, here's the summary"
    },
    {
      "Time_Start": 2130.46,
      "Time_End": 2134.34,
      "Text": " of the number of IM users, the names, the access keys, and then you can see this additional"
    },
    {
      "Time_Start": 2134.34,
      "Time_End": 2139.38,
      "Text": " data down at the bottom where you can programmatically access all that same information."
    },
    {
      "Time_Start": 2139.38,
      "Time_End": 2144.2200000000003,
      "Text": " And as I mentioned before, we do access this information in certain look-ahead, look-behind"
    },
    {
      "Time_Start": 2144.2200000000003,
      "Time_End": 2146.2200000000003,
      "Text": " signal scenarios."
    },
    {
      "Time_Start": 2146.2200000000003,
      "Time_End": 2149.9,
      "Text": " So this is looking at a really detailed example event by event."
    },
    {
      "Time_Start": 2149.9,
      "Time_End": 2153.4,
      "Text": " The next thing we can do is say, let's do kind of an event summary."
    },
    {
      "Time_Start": 2153.4,
      "Time_End": 2157.46,
      "Text": " All the green events now are ones that are part of a mapping, and then above those groupings"
    },
    {
      "Time_Start": 2157.46,
      "Time_End": 2160.44,
      "Text": " of events, we have the signal information."
    },
    {
      "Time_Start": 2160.44,
      "Time_End": 2164.52,
      "Text": " This view is really helpful when you're trying to debug or add new mappings, because usually"
    },
    {
      "Time_Start": 2164.52,
      "Time_End": 2167.54,
      "Text": " what you're doing is saying, I don't see a signal."
    },
    {
      "Time_Start": 2167.54,
      "Time_End": 2169.98,
      "Text": " Why don't I see a signal?"
    },
    {
      "Time_Start": 2169.98,
      "Time_End": 2172.7200000000003,
      "Text": " What events are not contributing to the signal?"
    },
    {
      "Time_Start": 2172.7200000000003,
      "Time_End": 2176.04,
      "Text": " So we can just add the event mapping information."
    },
    {
      "Time_Start": 2176.04,
      "Time_End": 2180.56,
      "Text": " So we can see here, now, under every event, we have the information like user agent request"
    },
    {
      "Time_Start": 2180.56,
      "Time_End": 2185.52,
      "Text": " parameters and, most importantly, the labels that were used for that mapping."
    },
    {
      "Time_Start": 2185.52,
      "Time_End": 2189.64,
      "Text": " So red labels are those that did not successfully map the before and after events."
    },
    {
      "Time_Start": 2189.64,
      "Time_End": 2193.44,
      "Text": " Green did, and then gray is anything below green that was just skipped if a signal was"
    },
    {
      "Time_Start": 2193.44,
      "Time_End": 2195.2799999999997,
      "Text": " properly generated."
    },
    {
      "Time_Start": 2195.2799999999997,
      "Time_End": 2198.44,
      "Text": " This is still not really the best view for looking at an entire session."
    },
    {
      "Time_Start": 2198.44,
      "Time_End": 2200.06,
      "Text": " This is more for debugging view."
    },
    {
      "Time_Start": 2200.06,
      "Time_End": 2206.98,
      "Text": " For understanding what actually happened, we're going to do the show session summary."
    },
    {
      "Time_Start": 2206.98,
      "Time_End": 2210.96,
      "Text": " So again, when all the signals are working great, then this is the view from a CLI perspective"
    },
    {
      "Time_Start": 2210.96,
      "Time_End": 2216.24,
      "Text": " that's going to make the most sense, where you can see 484 events was that IAM user's"
    },
    {
      "Time_Start": 2216.24,
      "Time_End": 2217.24,
      "Text": " click."
    },
    {
      "Time_Start": 2217.2400000000002,
      "Time_End": 2221.32,
      "Text": " The events that we extracted, we're highlighting in blue here, so that you can kind of quickly"
    },
    {
      "Time_Start": 2221.32,
      "Time_End": 2224.76,
      "Text": " visualize what data was pulled out."
    },
    {
      "Time_Start": 2224.76,
      "Time_End": 2228.36,
      "Text": " And there's that last click we did, 307 events for that global view."
    },
    {
      "Time_Start": 2228.36,
      "Time_End": 2231.5200000000004,
      "Text": " But most people don't necessarily want to live in the CLI."
    },
    {
      "Time_Start": 2231.5200000000004,
      "Time_End": 2234.8,
      "Text": " So Andi's going to talk about what we did about that."
    },
    {
      "Time_Start": 2234.8,
      "Time_End": 2239.7200000000003,
      "Text": " We were really motivated to do some front-end work, and immediately after we started, we"
    },
    {
      "Time_Start": 2239.7200000000003,
      "Time_End": 2243.88,
      "Text": " saw that it's not as easy as it looks."
    },
    {
      "Time_Start": 2243.88,
      "Time_End": 2250.28,
      "Text": " So we came up with this UI, which is supported by dash AG grid."
    },
    {
      "Time_Start": 2250.28,
      "Time_End": 2255.92,
      "Text": " So we can see that we have three buttons at the top, where you can see the events that"
    },
    {
      "Time_Start": 2255.92,
      "Time_End": 2257.52,
      "Text": " were mapped, unmapped."
    },
    {
      "Time_Start": 2257.52,
      "Time_End": 2266.28,
      "Text": " Also the table has all the cool AG grid features, like filtering on different cases, switching"
    },
    {
      "Time_Start": 2266.28,
      "Time_End": 2274.0400000000004,
      "Text": " the column row, also sorting by the columns."
    },
    {
      "Time_Start": 2274.0400000000004,
      "Time_End": 2288.1200000000003,
      "Text": " And we came up with a cute little search filter, which searches all across your data."
    },
    {
      "Time_Start": 2288.1200000000003,
      "Time_End": 2292.1600000000003,
      "Text": " So with that, what are the main takeaways?"
    },
    {
      "Time_Start": 2292.1600000000003,
      "Time_End": 2296.2400000000002,
      "Text": " Console sessions do matter, from a defender's perspective."
    },
    {
      "Time_Start": 2296.2400000000002,
      "Time_End": 2298.2400000000002,
      "Text": " Defenders do still use them."
    },
    {
      "Time_Start": 2298.2400000000002,
      "Time_End": 2300.7200000000003,
      "Text": " But more importantly, regular users use them."
    },
    {
      "Time_Start": 2300.7200000000003,
      "Time_End": 2306.1200000000003,
      "Text": " So being able to filter out and understand benign activity is really important, so that"
    },
    {
      "Time_Start": 2306.1200000000003,
      "Time_End": 2311.44,
      "Text": " what you're left with is going to be a potentially interesting malicious activity."
    },
    {
      "Time_Start": 2311.44,
      "Time_End": 2315.0000000000005,
      "Text": " Number two is understanding what your log sources are."
    },
    {
      "Time_Start": 2315.0000000000005,
      "Time_End": 2316.4,
      "Text": " What are those retention limits?"
    },
    {
      "Time_Start": 2316.4,
      "Time_End": 2317.6800000000003,
      "Text": " Are you forwarding those logs?"
    },
    {
      "Time_Start": 2317.6800000000003,
      "Time_End": 2320.6400000000003,
      "Text": " If you're forwarding them, are you monitoring that it's still forwarding correctly?"
    },
    {
      "Time_Start": 2320.7999999999997,
      "Time_End": 2326.24,
      "Text": " There's a lot of configuration errors that can occur maliciously or benignly."
    },
    {
      "Time_Start": 2326.24,
      "Time_End": 2329.44,
      "Text": " But do you understand what those logs look like?"
    },
    {
      "Time_Start": 2329.44,
      "Time_End": 2333.2,
      "Text": " Trying to figure out these log options in the middle of an incident is not the time"
    },
    {
      "Time_Start": 2333.2,
      "Time_End": 2334.48,
      "Text": " you want to be doing it."
    },
    {
      "Time_Start": 2334.48,
      "Time_End": 2337.2,
      "Text": " Investing that time beforehand will pay dividends."
    },
    {
      "Time_Start": 2337.2,
      "Time_End": 2341.12,
      "Text": " And hopefully you're going to be detecting suspicious activity instead of just investigating"
    },
    {
      "Time_Start": 2341.12,
      "Time_End": 2344.3199999999997,
      "Text": " something that happened weeks or even months before."
    },
    {
      "Time_Start": 2344.3199999999997,
      "Time_End": 2347.8199999999997,
      "Text": " And then lastly, Cloud Console Cartographer is the tool we just showed."
    },
    {
      "Time_Start": 2347.8199999999997,
      "Time_End": 2349.92,
      "Text": " It is free and open source."
    },
    {
      "Time_Start": 2349.92,
      "Time_End": 2353.0,
      "Text": " And the last slide will have the link to that GitHub there."
    },
    {
      "Time_Start": 2353.0,
      "Time_End": 2354.94,
      "Text": " But again, we had a lot of fun doing this research."
    },
    {
      "Time_Start": 2354.94,
      "Time_End": 2357.96,
      "Text": " We had a lot of fun building the tool and using it internally."
    },
    {
      "Time_Start": 2357.96,
      "Time_End": 2360.7200000000003,
      "Text": " And so we hope that you also find it useful."
    },
    {
      "Time_Start": 2360.7200000000003,
      "Time_End": 2366.1,
      "Text": " And just, I think, two weeks ago, we released a blog kind of outlining detail, like step"
    },
    {
      "Time_Start": 2366.1,
      "Time_End": 2370.26,
      "Text": " by step, how you can go and add your own mappings and a little more granularity about using"
    },
    {
      "Time_Start": 2370.26,
      "Time_End": 2376.08,
      "Text": " some of the functions that we just walked through to add your own mappings to the project."
    },
    {
      "Time_Start": 2376.08,
      "Time_End": 2378.86,
      "Text": " So with that, we just want to say thank you so much for your time."
    },
    {
      "Time_Start": 2378.86,
      "Time_End": 2381.54,
      "Text": " As I mentioned at the beginning, this is a really special conference, and we're really"
    },
    {
      "Time_Start": 2381.54,
      "Time_End": 2383.54,
      "Text": " honored to be here."
    },
    {
      "Time_Start": 2383.54,
      "Time_End": 2387.34,
      "Text": " And I've already just been blown away by the presentation so far and more impressed just"
    },
    {
      "Time_Start": 2387.34,
      "Time_End": 2389.38,
      "Text": " with the conversations we've had with several attendees."
    },
    {
      "Time_Start": 2389.38,
      "Time_End": 2394.3,
      "Text": " And so it really is a great opportunity to network and really just share knowledge."
    },
    {
      "Time_Start": 2394.3,
      "Time_End": 2397.58,
      "Text": " And you can find us on LinkedIn and Twitter."
    },
    {
      "Time_Start": 2397.58,
      "Time_End": 2401.02,
      "Text": " We will try to do our best to respond to questions or whatnot."
    },
    {
      "Time_Start": 2401.02,
      "Time_End": 2407.1400000000003,
      "Text": " But please feel free just to ask us a question either here or on stage or throughout the"
    },
    {
      "Time_Start": 2407.14,
      "Time_End": 2409.3799999999997,
      "Text": " rest of the day, today and tomorrow."
    },
    {
      "Time_Start": 2409.3799999999997,
      "Time_End": 2410.3799999999997,
      "Text": " We're always happy to talk."
    },
    {
      "Time_Start": 2410.3799999999997,
      "Time_End": 2412.7,
      "Text": " And then there's the link to the project at the bottom."
    },
    {
      "Time_Start": 2412.7,
      "Time_End": 2414.5,
      "Text": " So with that, thank you very much for your time."
    }
  ]
}