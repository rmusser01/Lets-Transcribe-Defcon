{
  "segments": [
    {
      "Time_Start": 0.0,
      "Time_End": 12.72,
      "Text": "This text was transcribed using whisper model: large-v2\n\n Welcome, everybody, to our session on the cost of complexity, different vulnerabilities"
    },
    {
      "Time_Start": 12.72,
      "Time_End": 14.92,
      "Text": " while implementing the same RFC."
    },
    {
      "Time_Start": 14.92,
      "Time_End": 19.04,
      "Text": " The session will be presented by myself, Daniel Dos Santos from Forescout Research Labs and"
    },
    {
      "Time_Start": 19.04,
      "Time_End": 21.56,
      "Text": " Shlomi Obermann from JSOF."
    },
    {
      "Time_Start": 21.56,
      "Time_End": 23.400000000000002,
      "Text": " So before we start, who we are."
    },
    {
      "Time_Start": 23.400000000000002,
      "Time_End": 27.54,
      "Text": " So this is a collaborative research effort between Forescout and JSOF."
    },
    {
      "Time_Start": 27.54,
      "Time_End": 31.9,
      "Text": " And although it's presented today by myself and by Shlomi, there were several other people"
    },
    {
      "Time_Start": 31.9,
      "Time_End": 37.019999999999996,
      "Text": " involved in this research, and we would just like to acknowledge them here from both sides."
    },
    {
      "Time_Start": 37.019999999999996,
      "Time_End": 41.22,
      "Text": " So a quick outline of this presentation, right."
    },
    {
      "Time_Start": 41.22,
      "Time_End": 45.18,
      "Text": " I will give an introduction of what this research was all about."
    },
    {
      "Time_Start": 45.18,
      "Time_End": 49.26,
      "Text": " What we're calling name rec, a set of new vulnerabilities that basically break some"
    },
    {
      "Time_Start": 49.26,
      "Time_End": 52.54,
      "Text": " DNS client side implementations."
    },
    {
      "Time_Start": 52.54,
      "Time_End": 55.620000000000005,
      "Text": " What are the impacts of these vulnerabilities?"
    },
    {
      "Time_Start": 55.620000000000005,
      "Time_End": 60.980000000000004,
      "Text": " What kind of mitigation actions can we take to actually fix DNS implementations in the"
    },
    {
      "Time_Start": 60.980000000000004,
      "Time_End": 63.120000000000005,
      "Text": " future, now and in the future?"
    },
    {
      "Time_Start": 63.120000000000005,
      "Time_End": 67.18,
      "Text": " And a little bit of a conclusion and main takeaways from this research."
    },
    {
      "Time_Start": 67.18,
      "Time_End": 68.7,
      "Text": " So let's go to the introduction."
    },
    {
      "Time_Start": 68.7,
      "Time_End": 73.22,
      "Text": " So this research is part of what we've been calling Project Memoria."
    },
    {
      "Time_Start": 73.22,
      "Time_End": 77.58000000000001,
      "Text": " Project Memoria is a large study of embedded TCP IP stack security."
    },
    {
      "Time_Start": 77.58000000000001,
      "Time_End": 80.98,
      "Text": " We really want to understand why are they vulnerable, how are they vulnerable, and actually"
    },
    {
      "Time_Start": 80.98,
      "Time_End": 84.14,
      "Text": " what the cybersecurity community can do about it."
    },
    {
      "Time_Start": 84.14,
      "Time_End": 88.14,
      "Text": " This is an initiative that is led by Forescout Research Labs with several collaborations,"
    },
    {
      "Time_Start": 88.14,
      "Time_End": 91.74,
      "Text": " including JSOFT and others."
    },
    {
      "Time_Start": 91.74,
      "Time_End": 96.74,
      "Text": " In previous research that was done in TCP IP stacks, we had examples such as Ripple20,"
    },
    {
      "Time_Start": 96.74,
      "Time_End": 101.66,
      "Text": " a set of 19 vulnerabilities on the track TCP IP stack that revealed massive supply chain"
    },
    {
      "Time_Start": 101.66,
      "Time_End": 104.62,
      "Text": " effects in terms of vendors and affected devices."
    },
    {
      "Time_Start": 104.62,
      "Time_End": 111.7,
      "Text": " Then we had Amnesia 33 that was done at Forescout Research Labs that revealed a set of 33 vulnerabilities"
    },
    {
      "Time_Start": 111.7,
      "Time_End": 116.54,
      "Text": " on four open source stacks and kind of continued the momentum and the trend of TCP IP stack"
    },
    {
      "Time_Start": 116.54,
      "Time_End": 122.38,
      "Text": " vulnerabilities, showing that the similar supply chain effects found in closed source"
    },
    {
      "Time_Start": 122.38,
      "Time_End": 126.78,
      "Text": " code are also found in open source stacks."
    },
    {
      "Time_Start": 126.78,
      "Time_End": 133.78,
      "Text": " And more recently, in February of this year, we released Numberjack, a set of nine vulnerabilities"
    },
    {
      "Time_Start": 133.78,
      "Time_End": 139.38,
      "Text": " that are actually related to predictable TCP initial sequence numbers in nine different"
    },
    {
      "Time_Start": 139.38,
      "Time_End": 140.38,
      "Text": " TCP IP stacks."
    },
    {
      "Time_Start": 140.38,
      "Time_End": 146.98,
      "Text": " So this previous body of work really shows the fact that by now we know that TCP IP stacks"
    },
    {
      "Time_Start": 146.98,
      "Time_End": 152.9,
      "Text": " have several vulnerabilities, and it's not a surprise when new vulnerabilities come out,"
    },
    {
      "Time_Start": 152.9,
      "Time_End": 160.26,
      "Text": " but they have very interesting nuances, and you can always learn new things when you look"
    },
    {
      "Time_Start": 160.26,
      "Time_End": 163.22,
      "Text": " more closely at TCP IP stacks."
    },
    {
      "Time_Start": 163.22,
      "Time_End": 168.7,
      "Text": " You can find vulnerabilities that were known in the past, such as Numberjack."
    },
    {
      "Time_Start": 169.02,
      "Time_End": 172.86,
      "Text": " This is an issue that has been going on for 20 years."
    },
    {
      "Time_Start": 172.86,
      "Time_End": 177.66000000000003,
      "Text": " You can also find new types of vulnerabilities, and you basically find a mix of all of that."
    },
    {
      "Time_Start": 177.66000000000003,
      "Time_End": 182.86,
      "Text": " And this is very important because of the current IoT scenario that we have nowadays"
    },
    {
      "Time_Start": 182.86,
      "Time_End": 188.70000000000002,
      "Text": " where there are billions and billions of devices being deployed out there from seven different"
    },
    {
      "Time_Start": 188.70000000000002,
      "Time_End": 196.02,
      "Text": " vendors, and all of those use code that we all know that in the end, the code that runs"
    },
    {
      "Time_Start": 196.06,
      "Time_End": 205.10000000000002,
      "Text": " in embedded devices might not be the most secure ever, and it tends to be very old code."
    },
    {
      "Time_Start": 205.10000000000002,
      "Time_End": 212.34,
      "Text": " This is what previous research has shown, and it's kind of a motivation for this work"
    },
    {
      "Time_Start": 212.34,
      "Time_End": 214.22,
      "Text": " that we're talking about today."
    },
    {
      "Time_Start": 214.22,
      "Time_End": 218.10000000000002,
      "Text": " So why did we decide to look more closely at DNS?"
    },
    {
      "Time_Start": 218.10000000000002,
      "Time_End": 222.06,
      "Text": " So DNS is the most affected TCP IP component in previous research."
    },
    {
      "Time_Start": 222.06,
      "Time_End": 231.54,
      "Text": " So in Ripple 20, the most critical vulnerability that led to an RCE was CVE-2020-11-901 on"
    },
    {
      "Time_Start": 231.54,
      "Time_End": 236.38,
      "Text": " the track TCP IP stack, which was related to DNS and a specific feature of DNS that"
    },
    {
      "Time_Start": 236.38,
      "Time_End": 239.62,
      "Text": " we will be discussing throughout this presentation."
    },
    {
      "Time_Start": 239.62,
      "Time_End": 246.26,
      "Text": " And then in Amnesia 33, 15 out of the 33 CVEs that we found were actually on DNS clients,"
    },
    {
      "Time_Start": 246.26,
      "Time_End": 250.78,
      "Text": " and three of those were potential RCEs."
    },
    {
      "Time_Start": 250.78,
      "Time_End": 256.38,
      "Text": " So if you look at the image that's on the left-hand side of this presentation, you can"
    },
    {
      "Time_Start": 256.38,
      "Time_End": 264.06,
      "Text": " see that DNS is by far the most affected component in previous research in TCP IP stack."
    },
    {
      "Time_Start": 264.06,
      "Time_End": 269.54,
      "Text": " And another interesting point is that protocol complexity is a good predictor of vulnerabilities."
    },
    {
      "Time_Start": 269.54,
      "Time_End": 271.46,
      "Text": " There are other major findings on DNS."
    },
    {
      "Time_Start": 271.46,
      "Time_End": 275.3,
      "Text": " We all know that DNS is a complex protocol, and we'll go into some of the specific complexities"
    },
    {
      "Time_Start": 275.38,
      "Time_End": 283.86,
      "Text": " in this presentation, but it tends to be a good predictor of new vulnerabilities, right?"
    },
    {
      "Time_Start": 283.86,
      "Time_End": 288.26,
      "Text": " So for instance, very recently, there was a work of JSOF that revealed a set of seven"
    },
    {
      "Time_Start": 288.26,
      "Time_End": 294.46000000000004,
      "Text": " CVEs on the DNS mask, DNS forwarder, that was called DNS Spook."
    },
    {
      "Time_Start": 294.46000000000004,
      "Time_End": 300.1,
      "Text": " But also at the end of last year, we had vulnerabilities such as SIGRED, we had SETDNS, we all know"
    },
    {
      "Time_Start": 300.18,
      "Time_End": 302.98,
      "Text": " about, for instance, the Kaminsky attack."
    },
    {
      "Time_Start": 302.98,
      "Time_End": 309.62,
      "Text": " And there are several major vulnerabilities on DNS that actually really increase the attack"
    },
    {
      "Time_Start": 309.62,
      "Time_End": 315.1,
      "Text": " surface of devices, because DNS is typically externally accessible."
    },
    {
      "Time_Start": 315.1,
      "Time_End": 322.74,
      "Text": " So usually, devices request domain names from external servers, and that means that there"
    },
    {
      "Time_Start": 322.74,
      "Time_End": 329.22,
      "Text": " is a potential for remote exploitation of those devices."
    },
    {
      "Time_Start": 329.22,
      "Time_End": 332.34000000000003,
      "Text": " So let's talk quickly about what DNS actually is, right?"
    },
    {
      "Time_Start": 332.34000000000003,
      "Time_End": 339.06,
      "Text": " So DNS is a protocol in a system that allows system devices on the internet to map between"
    },
    {
      "Time_Start": 339.06,
      "Time_End": 341.54,
      "Text": " domain names and actual IP addresses."
    },
    {
      "Time_Start": 341.54,
      "Time_End": 349.74,
      "Text": " So basically, a client resolves a name such as example.com by querying a specific DNS server."
    },
    {
      "Time_Start": 349.74,
      "Time_End": 352.98,
      "Text": " And the DNS server then looks up the name and returns a response."
    },
    {
      "Time_Start": 352.98,
      "Time_End": 357.02000000000004,
      "Text": " We all know that DNS is hierarchical and then there are recursive queries and all of that."
    },
    {
      "Time_Start": 357.02,
      "Time_End": 361.9,
      "Text": " But we're not going into these details because it's not really relevant in this presentation."
    },
    {
      "Time_Start": 361.9,
      "Time_End": 364.94,
      "Text": " Let's stick to the basics here."
    },
    {
      "Time_Start": 364.94,
      "Time_End": 372.78,
      "Text": " So how are these DNS requests and replies encoded in actual network packets?"
    },
    {
      "Time_Start": 372.78,
      "Time_End": 380.26,
      "Text": " So domain names, such as example.com, are sequences of labels, and each label is preceded"
    },
    {
      "Time_Start": 380.26,
      "Time_End": 381.9,
      "Text": " by a length byte."
    },
    {
      "Time_Start": 381.9,
      "Time_End": 386.29999999999995,
      "Text": " So you can see in the example there that there is a length byte that has the value 3 and"
    },
    {
      "Time_Start": 386.3,
      "Time_End": 393.42,
      "Text": " then three actual characters, www, then the length 7, then the characters for example,"
    },
    {
      "Time_Start": 393.42,
      "Time_End": 398.98,
      "Text": " then the length 3, and then the characters for com."
    },
    {
      "Time_Start": 398.98,
      "Time_End": 406.22,
      "Text": " And there is a clever mechanism of compression in DNS, but we'll explore it more in detail"
    },
    {
      "Time_Start": 406.22,
      "Time_End": 407.26,
      "Text": " later on."
    },
    {
      "Time_Start": 407.26,
      "Time_End": 413.7,
      "Text": " But this mechanism allows implementations to replace sequences of labels with pointers"
    },
    {
      "Time_Start": 413.7,
      "Time_End": 416.2,
      "Text": " to prior occurrence of the same sequence."
    },
    {
      "Time_Start": 416.2,
      "Time_End": 426.52,
      "Text": " So for instance, if you have www.gmail.com and smtp.gmail.com, you don't have to do gmail.com"
    },
    {
      "Time_Start": 426.52,
      "Time_End": 431.76,
      "Text": " twice, you don't need to repeat that in the network packet in response."
    },
    {
      "Time_Start": 431.76,
      "Time_End": 438.96,
      "Text": " You can basically point back to the offset in the packet where the previous occurrence"
    },
    {
      "Time_Start": 438.96,
      "Time_End": 441.8,
      "Text": " of gmail.com was."
    },
    {
      "Time_Start": 441.8,
      "Time_End": 444.08,
      "Text": " This pointer is encoded actually in two bytes."
    },
    {
      "Time_Start": 444.08,
      "Time_End": 450.71999999999997,
      "Text": " So there is the first two bits set to 1, so 1 1, and then the actual encoding of the"
    },
    {
      "Time_Start": 450.71999999999997,
      "Time_End": 454.44,
      "Text": " offset in the packet where you want this to point to."
    },
    {
      "Time_Start": 454.44,
      "Time_End": 460.28,
      "Text": " This message compression is used not just in DNS, but also in DHCP, in multicast DNS,"
    },
    {
      "Time_Start": 460.28,
      "Time_End": 468.71999999999997,
      "Text": " IPv6 router advertisement, and basically several other protocols in internet specifications."
    },
    {
      "Time_Start": 468.72,
      "Time_End": 475.52000000000004,
      "Text": " Interestingly enough, this compression mechanism has led to 20 years of known vulnerabilities."
    },
    {
      "Time_Start": 475.52000000000004,
      "Time_End": 479.36,
      "Text": " And actually even before these vulnerabilities started popping up, or more or less at the"
    },
    {
      "Time_Start": 479.36,
      "Time_End": 484.44000000000005,
      "Text": " same time as they started popping up, there were some comments already about the issues"
    },
    {
      "Time_Start": 484.44000000000005,
      "Time_End": 486.48,
      "Text": " with DNS compression."
    },
    {
      "Time_Start": 486.48,
      "Time_End": 493.24,
      "Text": " So one comment from DJ Bernstein around 2001 is that the problem with DNS compression is"
    },
    {
      "Time_Start": 493.24,
      "Time_End": 495.08000000000004,
      "Text": " the amount of code required to parse it."
    },
    {
      "Time_Start": 495.08,
      "Time_End": 499.64,
      "Text": " As you saw in the previous slide, it's not really an easy mechanism to implement."
    },
    {
      "Time_Start": 499.64,
      "Time_End": 505.12,
      "Text": " So to reliably locate all these names, it takes some work, some actual code that would"
    },
    {
      "Time_Start": 505.12,
      "Time_End": 509.52,
      "Text": " be unnecessary for DNS implementations otherwise."
    },
    {
      "Time_Start": 509.52,
      "Time_End": 515.52,
      "Text": " And there could have been other types of implementations of compression, but in any case, this is what"
    },
    {
      "Time_Start": 515.52,
      "Time_End": 520.24,
      "Text": " we have for more than 20 years in the DNS system."
    },
    {
      "Time_Start": 520.24,
      "Time_End": 525.76,
      "Text": " And if you look at examples of vulnerabilities that were found in this previous 20 years,"
    },
    {
      "Time_Start": 525.76,
      "Time_End": 534.12,
      "Text": " you can really see that it affects from specific devices, such as a Cisco IP phone there, to"
    },
    {
      "Time_Start": 534.12,
      "Time_End": 541.52,
      "Text": " known networking tools, such as TCP dump and Ethereo, to actually media players like VLC,"
    },
    {
      "Time_Start": 541.52,
      "Time_End": 548.6,
      "Text": " to more recently, TCP IP stacks that we examined in previous research, such as Ripple 20 and"
    },
    {
      "Time_Start": 548.6,
      "Time_End": 549.6,
      "Text": " Amnesia 33."
    },
    {
      "Time_Start": 549.6,
      "Time_End": 553.44,
      "Text": " And you can see that there's an increasing trend of these vulnerabilities."
    },
    {
      "Time_Start": 553.44,
      "Time_End": 559.8000000000001,
      "Text": " We saw a few at the early 2000s, but then only in the previous year, there are more"
    },
    {
      "Time_Start": 559.8000000000001,
      "Time_End": 563.2,
      "Text": " than actually five examples there."
    },
    {
      "Time_Start": 563.2,
      "Time_End": 566.8000000000001,
      "Text": " And of course, there are also other vulnerabilities that we're not mentioning here because they"
    },
    {
      "Time_Start": 566.8000000000001,
      "Time_End": 570.48,
      "Text": " don't have CVEs, because they affect other kinds of products and so on."
    },
    {
      "Time_Start": 570.48,
      "Time_End": 577.4,
      "Text": " So we just really want to say that this is a widespread problem."
    },
    {
      "Time_Start": 577.4,
      "Time_End": 581.0799999999999,
      "Text": " And that leads us to actually NameRack, which is this new set of vulnerabilities that we"
    },
    {
      "Time_Start": 581.0799999999999,
      "Time_End": 582.0799999999999,
      "Text": " found."
    },
    {
      "Time_Start": 582.0799999999999,
      "Time_End": 585.36,
      "Text": " And to discuss this set of vulnerabilities and the technicalities behind them, I will"
    },
    {
      "Time_Start": 585.36,
      "Time_End": 592.1999999999999,
      "Text": " now hand it over to Shlomi, and I will pick the presentation back after Shlomi gives us"
    },
    {
      "Time_Start": 592.1999999999999,
      "Time_End": 595.24,
      "Text": " these details to talk about the impact of this vulnerability."
    },
    {
      "Time_Start": 595.24,
      "Time_End": 596.64,
      "Text": " So thank you."
    },
    {
      "Time_Start": 596.64,
      "Time_End": 597.64,
      "Text": " Thank you, Daniel."
    },
    {
      "Time_Start": 597.64,
      "Time_End": 604.52,
      "Text": " I'll now discuss a little bit about what vulnerabilities we were trying to find in the NameRack research"
    },
    {
      "Time_Start": 604.88,
      "Time_End": 607.72,
      "Text": " and what vulnerabilities we ended up finding."
    },
    {
      "Time_Start": 607.72,
      "Time_End": 614.28,
      "Text": " So the goal of the research was to find issues with DNS compression, a specific RFC made"
    },
    {
      "Time_Start": 614.28,
      "Time_End": 618.24,
      "Text": " to save space in DNS response packets."
    },
    {
      "Time_Start": 618.24,
      "Time_End": 625.64,
      "Text": " The motivation for this was issues that we saw in Ripple20 and Amnesia 33 research, and"
    },
    {
      "Time_Start": 625.64,
      "Time_End": 632.84,
      "Text": " the fact that we saw that the code was quite complex, the logic was quite complex, and"
    },
    {
      "Time_Start": 632.84,
      "Time_End": 638.6,
      "Text": " the different implementations found different ways to interpret the RFC."
    },
    {
      "Time_Start": 638.6,
      "Time_End": 644.0,
      "Text": " So we quickly knew we had good potentials for remote code execution vulnerabilities"
    },
    {
      "Time_Start": 644.0,
      "Time_End": 646.84,
      "Text": " and for vulnerabilities in general."
    },
    {
      "Time_Start": 646.84,
      "Time_End": 650.76,
      "Text": " We also saw that some stacks don't implement compression, which is a way to avoid these"
    },
    {
      "Time_Start": 650.76,
      "Time_End": 656.9200000000001,
      "Text": " vulnerabilities, but of course only allows partial functionality."
    },
    {
      "Time_Start": 656.9200000000001,
      "Time_End": 661.12,
      "Text": " We wanted to have a varied selection of different stacks."
    },
    {
      "Time_Start": 661.12,
      "Time_End": 665.4,
      "Text": " We didn't want to have different stacks of the same type or originating from the same"
    },
    {
      "Time_Start": 665.4,
      "Time_End": 666.4,
      "Text": " sources."
    },
    {
      "Time_Start": 666.4,
      "Time_End": 673.08,
      "Text": " And so we chose both stacks meant for embedded devices, general purpose, computing stacks,"
    },
    {
      "Time_Start": 673.08,
      "Time_End": 681.4,
      "Text": " open source, closed source, new stacks, older stacks, so that we have a very wide view of"
    },
    {
      "Time_Start": 681.4,
      "Time_End": 686.32,
      "Text": " implementations of the same code."
    },
    {
      "Time_Start": 686.32,
      "Time_End": 690.72,
      "Text": " Our first results were a little bit underwhelming."
    },
    {
      "Time_Start": 690.72,
      "Time_End": 693.88,
      "Text": " We found some stacks that were not vulnerable."
    },
    {
      "Time_Start": 693.88,
      "Time_End": 700.1600000000001,
      "Text": " We found some vulnerabilities in the Nordic SDK, which is quite popular in embedded devices."
    },
    {
      "Time_Start": 700.1600000000001,
      "Time_End": 704.6,
      "Text": " When we approached them, they replied very quickly, said that this is experimental code"
    },
    {
      "Time_Start": 704.6,
      "Time_End": 709.6,
      "Text": " and that the vulnerabilities had already been fixed in production code."
    },
    {
      "Time_Start": 709.6,
      "Time_End": 712.0400000000001,
      "Text": " This is code that we found online, so it was published."
    },
    {
      "Time_Start": 712.0400000000001,
      "Time_End": 718.2,
      "Text": " We'll discuss this later on in the talk."
    },
    {
      "Time_Start": 718.2,
      "Time_End": 728.6,
      "Text": " As we continued our research, we did find vulnerabilities in pretty prominent stacks."
    },
    {
      "Time_Start": 728.6,
      "Time_End": 734.8000000000001,
      "Text": " We also found a lot of issues that were of different types, but in the same area."
    },
    {
      "Time_Start": 734.8000000000001,
      "Time_End": 739.72,
      "Text": " Specifically in Nucleus Net, we found quite a few issues, quite a few anti-patterns, and"
    },
    {
      "Time_Start": 739.72,
      "Time_End": 742.6,
      "Text": " we'll discuss the different anti-patterns that we found."
    },
    {
      "Time_Start": 742.6,
      "Time_End": 748.44,
      "Text": " We decided to document them and discuss them for better implementation of this RFC."
    },
    {
      "Time_Start": 748.44,
      "Time_End": 752.5600000000001,
      "Text": " In FreeBSD, we found a vulnerability in the DHCP client."
    },
    {
      "Time_Start": 752.5600000000001,
      "Time_End": 758.28,
      "Text": " We didn't look at the DNS client, but I think someone may have looked at it at a later date."
    },
    {
      "Time_Start": 758.28,
      "Time_End": 765.96,
      "Text": " We found in an old version of VxWorks, an end-of-life version of VxWorks, we found stack"
    },
    {
      "Time_Start": 765.96,
      "Time_End": 767.44,
      "Text": " overflow."
    },
    {
      "Time_Start": 767.44,
      "Time_End": 773.8000000000001,
      "Text": " We later discovered that this stack overflow was already found and documented by researchers"
    },
    {
      "Time_Start": 773.8000000000001,
      "Time_End": 776.6400000000001,
      "Text": " from Exodus Intelligent."
    },
    {
      "Time_Start": 776.6400000000001,
      "Time_End": 784.32,
      "Text": " At the time, the VxWorks stack that the vulnerabilities were in was already end-of-life, so we do"
    },
    {
      "Time_Start": 784.32,
      "Time_End": 788.9200000000001,
      "Text": " know that this vulnerability had been fixed in the latest versions of VxWorks, but we're"
    },
    {
      "Time_Start": 788.9200000000001,
      "Time_End": 792.84,
      "Text": " not quite sure of the status in different versions."
    },
    {
      "Time_Start": 792.84,
      "Time_End": 795.08,
      "Text": " We'll discuss this in the impact."
    },
    {
      "Time_Start": 795.08,
      "Time_End": 798.24,
      "Text": " At the time, there was no CVE assigned."
    },
    {
      "Time_Start": 798.24,
      "Time_End": 808.32,
      "Text": " We recently assigned a CVE for this vulnerability, and we found a vulnerability in the NetX stack,"
    },
    {
      "Time_Start": 808.32,
      "Time_End": 813.4000000000001,
      "Text": " the stack of ThreadX operating system currently maintained by Microsoft."
    },
    {
      "Time_Start": 813.4000000000001,
      "Time_End": 818.1600000000001,
      "Text": " This is a vulnerability that could lead to denial of service, maybe remote code execution."
    },
    {
      "Time_Start": 818.1600000000001,
      "Time_End": 820.96,
      "Text": " It would be quite hard to exploit."
    },
    {
      "Time_Start": 821.48,
      "Time_End": 827.12,
      "Text": " Unfortunately, Microsoft did attempt to fix this vulnerability, but decided not to assign"
    },
    {
      "Time_Start": 827.12,
      "Time_End": 831.44,
      "Text": " a CVE and not to document the vulnerability in any way."
    },
    {
      "Time_Start": 831.44,
      "Time_End": 839.08,
      "Text": " They cited very low impact to the vulnerability, though we're not sure exactly what the meaning"
    },
    {
      "Time_Start": 839.08,
      "Time_End": 842.32,
      "Text": " or the reason for that is."
    },
    {
      "Time_Start": 842.32,
      "Time_End": 846.32,
      "Text": " Let's talk a little bit about the different types of vulnerabilities that we found, specifically"
    },
    {
      "Time_Start": 846.32,
      "Time_End": 849.12,
      "Text": " in Nucleus Net."
    },
    {
      "Time_Start": 849.12,
      "Time_End": 854.88,
      "Text": " The first type of vulnerability we found is lack of transaction ID and port ID validation"
    },
    {
      "Time_Start": 854.88,
      "Time_End": 856.48,
      "Text": " and randomization."
    },
    {
      "Time_Start": 856.48,
      "Time_End": 862.0,
      "Text": " The integrity of DNS, the matching between requests sent and responses received, the"
    },
    {
      "Time_Start": 862.0,
      "Time_End": 868.16,
      "Text": " way that we know that we receive response from the right server, is through these two"
    },
    {
      "Time_Start": 868.16,
      "Time_End": 871.76,
      "Text": " random numbers, a random port ID and a random transaction ID."
    },
    {
      "Time_Start": 871.76,
      "Time_End": 877.04,
      "Text": " These should both be randomized, and they should be verified when we receive the response."
    },
    {
      "Time_Start": 877.04,
      "Time_End": 882.0799999999999,
      "Text": " It's not a very robust mechanism, but it gives us some level of integrity."
    },
    {
      "Time_Start": 882.0799999999999,
      "Time_End": 888.48,
      "Text": " Unfortunately, we found that this was misimplemented in the case of Nucleus Net."
    },
    {
      "Time_Start": 888.48,
      "Time_End": 892.48,
      "Text": " We saw that they were both very, very easy to guess."
    },
    {
      "Time_Start": 892.48,
      "Time_End": 898.9599999999999,
      "Text": " We saw very, very low entropy, and we saw this vulnerability in a few other stacks as"
    },
    {
      "Time_Start": 898.9599999999999,
      "Time_End": 900.4399999999999,
      "Text": " well."
    },
    {
      "Time_Start": 900.4399999999999,
      "Time_End": 905.7199999999999,
      "Text": " This type of vulnerability is not a memory corruption vulnerability, but it could be"
    },
    {
      "Time_Start": 905.72,
      "Time_End": 911.24,
      "Text": " combined with other vulnerabilities to make the other vulnerabilities easier to exploit."
    },
    {
      "Time_Start": 911.24,
      "Time_End": 917.1600000000001,
      "Text": " It will allow us to exploit DNS client-side vulnerabilities without being the legitimate"
    },
    {
      "Time_Start": 917.1600000000001,
      "Time_End": 924.6800000000001,
      "Text": " server, making them a power multiplier, making other vulnerabilities combined with this vulnerability"
    },
    {
      "Time_Start": 924.6800000000001,
      "Time_End": 927.6800000000001,
      "Text": " more potent."
    },
    {
      "Time_Start": 927.6800000000001,
      "Time_End": 933.58,
      "Text": " Another issue that we found is a lack of label length and name length validation."
    },
    {
      "Time_Start": 933.58,
      "Time_End": 941.0600000000001,
      "Text": " Different type of issues, both with misimplementation of the RFC, as well as misallocation of buffer"
    },
    {
      "Time_Start": 941.0600000000001,
      "Time_End": 942.0600000000001,
      "Text": " sizes."
    },
    {
      "Time_Start": 942.0600000000001,
      "Time_End": 948.5400000000001,
      "Text": " So, different memory corruptions that arose from the very basic functionality of label"
    },
    {
      "Time_Start": 948.5400000000001,
      "Time_End": 955.62,
      "Text": " length and domain length, leading to different memory corruptions."
    },
    {
      "Time_Start": 955.62,
      "Time_End": 961.9000000000001,
      "Text": " Another issue that we found, a sort of more gentle issue, is no validation of the termination"
    },
    {
      "Time_Start": 961.9399999999999,
      "Time_End": 968.02,
      "Text": " of the domain length, which should end with a null byte representing a zero-length domain"
    },
    {
      "Time_Start": 968.02,
      "Time_End": 969.5,
      "Text": " label."
    },
    {
      "Time_Start": 969.5,
      "Time_End": 978.18,
      "Text": " In the case of Nucleus Net, this led to a 0x1 readout of bounds."
    },
    {
      "Time_Start": 978.18,
      "Time_End": 985.54,
      "Text": " Another type of issue we found is in the parsing of the header of the DNS response."
    },
    {
      "Time_Start": 985.54,
      "Time_End": 991.46,
      "Text": " The header contains counts for different types of resource records."
    },
    {
      "Time_Start": 991.5,
      "Time_End": 998.1800000000001,
      "Text": " We found that there is not sufficient validation, that the count specified in the header actually"
    },
    {
      "Time_Start": 998.1800000000001,
      "Time_End": 1005.26,
      "Text": " exists in the packet, leading to different types of mostly readout of bound vulnerabilities"
    },
    {
      "Time_Start": 1005.26,
      "Time_End": 1011.0600000000001,
      "Text": " from this inconsistency and the lack of validation."
    },
    {
      "Time_Start": 1011.0600000000001,
      "Time_End": 1015.94,
      "Text": " And of course, the vulnerabilities that we were looking for, DNS compression vulnerabilities."
    },
    {
      "Time_Start": 1016.1,
      "Time_End": 1023.1400000000001,
      "Text": " So, DNS compression is a way to reduce the size of DNS packet responses."
    },
    {
      "Time_Start": 1023.1400000000001,
      "Time_End": 1029.98,
      "Text": " The way this is done is it reuses parts or complete domain names as parts of other domain"
    },
    {
      "Time_Start": 1029.98,
      "Time_End": 1030.98,
      "Text": " names."
    },
    {
      "Time_Start": 1030.98,
      "Time_End": 1039.7,
      "Text": " So, if, for example, I want to specify www.domain.com, but I've already specified .com in a different"
    },
    {
      "Time_Start": 1039.7,
      "Time_End": 1043.8200000000002,
      "Text": " place, or I've already specified domain.com in a different place, I can reference that"
    },
    {
      "Time_Start": 1043.9399999999998,
      "Time_End": 1056.46,
      "Text": " previous domain name and use that without repeating the same string again and again."
    },
    {
      "Time_Start": 1056.46,
      "Time_End": 1062.1799999999998,
      "Text": " This is used to save space, and it turns out it's quite tricky to implement."
    },
    {
      "Time_Start": 1062.1799999999998,
      "Time_End": 1071.5,
      "Text": " The way it's implemented is we have a special marker, a byte that starts with two bits that"
    },
    {
      "Time_Start": 1071.5,
      "Time_End": 1078.22,
      "Text": " are one-one turned on, and a reference to a previous location, a previous domain name"
    },
    {
      "Time_Start": 1078.22,
      "Time_End": 1081.14,
      "Text": " in the packet, in the response packet."
    },
    {
      "Time_Start": 1081.14,
      "Time_End": 1086.1,
      "Text": " In order for this to work, the location must be a previous location, it must be a valid"
    },
    {
      "Time_Start": 1086.1,
      "Time_End": 1091.94,
      "Text": " location, and we must make sure that we're not following the same reference, the same"
    },
    {
      "Time_Start": 1091.94,
      "Time_End": 1093.82,
      "Text": " compression pointer."
    },
    {
      "Time_Start": 1093.82,
      "Time_End": 1095.82,
      "Text": " This is the name of the reference."
    },
    {
      "Time_Start": 1095.82,
      "Time_End": 1098.66,
      "Text": " We mustn't follow the same compression pointer twice."
    },
    {
      "Time_Start": 1098.66,
      "Time_End": 1103.98,
      "Text": " We also must make sure that we're calculating the name of the decompressed or uncompressed"
    },
    {
      "Time_Start": 1103.98,
      "Time_End": 1108.26,
      "Text": " domain link correctly if we're going to allocate space for this."
    },
    {
      "Time_Start": 1108.26,
      "Time_End": 1114.1000000000001,
      "Text": " And we found issues with all of these things that must happen in order for the implementation"
    },
    {
      "Time_Start": 1114.1000000000001,
      "Time_End": 1115.46,
      "Text": " to be correct."
    },
    {
      "Time_Start": 1115.46,
      "Time_End": 1121.18,
      "Text": " So, in some cases, we found that the compression pointer can bump forward, leading to different"
    },
    {
      "Time_Start": 1121.18,
      "Time_End": 1128.1000000000001,
      "Text": " types of issues, read-out-of-bounds, miscalculation of the sizes, denial of service."
    },
    {
      "Time_Start": 1128.1000000000001,
      "Time_End": 1133.5800000000002,
      "Text": " In some cases, we saw that the compression pointer doesn't have to point to a valid previous"
    },
    {
      "Time_Start": 1133.5800000000002,
      "Time_End": 1138.46,
      "Text": " domain link, which could lead to the fact that the domain link, when followed, would"
    },
    {
      "Time_Start": 1138.46,
      "Time_End": 1144.5800000000002,
      "Text": " actually reach a point in the packet that is after the compression pointer."
    },
    {
      "Time_Start": 1144.5800000000002,
      "Time_End": 1151.14,
      "Text": " We found that we could nest compression pointers, leading to large sizes, which could, in some"
    },
    {
      "Time_Start": 1151.14,
      "Time_End": 1156.0200000000002,
      "Text": " cases, lead to miscalculation of the uncompressed size."
    },
    {
      "Time_Start": 1156.02,
      "Time_End": 1160.74,
      "Text": " In some cases, just regular miscalculation of the uncompressed size."
    },
    {
      "Time_Start": 1160.74,
      "Time_End": 1170.7,
      "Text": " So we saw that this part of the protocol was difficult to implement and resulted in quite"
    },
    {
      "Time_Start": 1170.7,
      "Time_End": 1173.58,
      "Text": " a lot of vulnerabilities in the stacks that we looked at."
    },
    {
      "Time_Start": 1173.58,
      "Time_End": 1178.74,
      "Text": " We later found out that there are also a lot of vulnerabilities found in previous years"
    },
    {
      "Time_Start": 1178.74,
      "Time_End": 1182.54,
      "Text": " in stacks that we did not look at."
    },
    {
      "Time_Start": 1182.54,
      "Time_End": 1191.46,
      "Text": " Some examples, FreeBSD, VxWorks IPnet, ThreadX NetX, Nucleus, as well as other stacks in"
    },
    {
      "Time_Start": 1191.46,
      "Time_End": 1198.1,
      "Text": " the Ripple 20 and Amesia 33 vulnerabilities that are of this class."
    },
    {
      "Time_Start": 1198.1,
      "Time_End": 1204.06,
      "Text": " It's important to mention that oftentimes, when an IP stack has several different vulnerabilities,"
    },
    {
      "Time_Start": 1204.06,
      "Time_End": 1208.78,
      "Text": " these can be combined to create a stronger exploit or make the exploitation easier."
    },
    {
      "Time_Start": 1208.78,
      "Time_End": 1215.54,
      "Text": " In the example of NucleusNet, the fact that you can both craft a very large DNS response,"
    },
    {
      "Time_Start": 1215.54,
      "Time_End": 1222.42,
      "Text": " which is not a vulnerability per se, but is not correct according to the IRC, the fact"
    },
    {
      "Time_Start": 1222.42,
      "Time_End": 1226.66,
      "Text": " that you can create a memory corruption and write out of bounds, and the fact that it"
    },
    {
      "Time_Start": 1226.66,
      "Time_End": 1234.66,
      "Text": " is easy to guess transaction ID and port ID, mean that it is easier to exploit these three"
    },
    {
      "Time_Start": 1234.66,
      "Time_End": 1240.6200000000001,
      "Text": " vulnerabilities together than exploit each of them separately to achieve a remote code"
    },
    {
      "Time_Start": 1240.6200000000001,
      "Time_End": 1241.6200000000001,
      "Text": " execution."
    },
    {
      "Time_Start": 1241.6200000000001,
      "Time_End": 1247.5,
      "Text": " And there'll be more details about this published in the new report."
    },
    {
      "Time_Start": 1247.5,
      "Time_End": 1254.5400000000002,
      "Text": " I'll now hand the mic over back to Daniel to discuss the impact of these vulnerabilities"
    },
    {
      "Time_Start": 1254.5400000000002,
      "Time_End": 1255.5400000000002,
      "Text": " in the real world."
    },
    {
      "Time_Start": 1255.5400000000002,
      "Time_End": 1260.6200000000001,
      "Text": " Thanks, Lamy, for giving us all the details on the vulnerabilities that we found."
    },
    {
      "Time_Start": 1260.6200000000001,
      "Time_End": 1263.94,
      "Text": " And now let's talk a little bit about their impact."
    },
    {
      "Time_Start": 1263.94,
      "Time_End": 1267.6200000000001,
      "Text": " So first, let's discuss affected devices, right?"
    },
    {
      "Time_Start": 1267.6200000000001,
      "Time_End": 1268.94,
      "Text": " What is actually vulnerable?"
    },
    {
      "Time_Start": 1268.94,
      "Time_End": 1273.8200000000002,
      "Text": " So we all know that understanding affected vendors and devices, when we are talking about"
    },
    {
      "Time_Start": 1273.8200000000002,
      "Time_End": 1278.38,
      "Text": " TCP IP stack vulnerabilities, is very difficult, because these stacks, so basically these code"
    },
    {
      "Time_Start": 1278.38,
      "Time_End": 1281.46,
      "Text": " bases will be used multiple times in many ways, right?"
    },
    {
      "Time_Start": 1281.46,
      "Time_End": 1286.54,
      "Text": " We discussed that at length during Ripple20 and Amnesia 33, for instance."
    },
    {
      "Time_Start": 1286.54,
      "Time_End": 1292.5800000000002,
      "Text": " And we know that it's not easy to know which actual devices on a network or out there in"
    },
    {
      "Time_Start": 1292.58,
      "Time_End": 1296.82,
      "Text": " the real world have the vulnerable versions of these stacks."
    },
    {
      "Time_Start": 1296.82,
      "Time_End": 1301.3,
      "Text": " So here we are not discussing specific affected vendors or specific affected device models."
    },
    {
      "Time_Start": 1301.3,
      "Time_End": 1307.5,
      "Text": " We just want to give us an idea of the scale and the reach of this type of vulnerability."
    },
    {
      "Time_Start": 1307.5,
      "Time_End": 1311.58,
      "Text": " So for instance, we know that FreeBSD, whose DHCP client was found vulnerable, is very"
    },
    {
      "Time_Start": 1311.58,
      "Time_End": 1314.3,
      "Text": " popular in, of course, web and storage servers."
    },
    {
      "Time_Start": 1314.3,
      "Time_End": 1318.02,
      "Text": " But it's also the basis of several popular appliances and other software, right?"
    },
    {
      "Time_Start": 1318.02,
      "Time_End": 1326.1399999999999,
      "Text": " Like open source projects for firewalls or for network-attached storage devices."
    },
    {
      "Time_Start": 1326.1399999999999,
      "Time_End": 1329.18,
      "Text": " And there are certainly millions of those out there."
    },
    {
      "Time_Start": 1329.18,
      "Time_End": 1334.3799999999999,
      "Text": " We know that the Nucleus RTOS that runs Nucleus NAT by default, the ThreadX operating system,"
    },
    {
      "Time_Start": 1334.3799999999999,
      "Time_End": 1338.82,
      "Text": " which runs the NATX stack by default, and the VxWorks operating system that runs IP"
    },
    {
      "Time_Start": 1338.82,
      "Time_End": 1342.3,
      "Text": " NAT have been used for decades in critical systems, right?"
    },
    {
      "Time_Start": 1342.3,
      "Time_End": 1347.78,
      "Text": " And below there, I have a few images, a few examples of where those devices typically"
    },
    {
      "Time_Start": 1347.78,
      "Time_End": 1350.06,
      "Text": " are deployed."
    },
    {
      "Time_Start": 1350.06,
      "Time_End": 1355.42,
      "Text": " So altogether, we know that there are more than 10 billion deployments of those operating"
    },
    {
      "Time_Start": 1355.42,
      "Time_End": 1358.42,
      "Text": " systems or those stacks out there."
    },
    {
      "Time_Start": 1358.42,
      "Time_End": 1362.1399999999999,
      "Text": " And we do know that not all OS deployments use the default stack."
    },
    {
      "Time_Start": 1362.1399999999999,
      "Time_End": 1368.3,
      "Text": " Not all of them have a DNS or DHCP client enabled, and even not every version of these"
    },
    {
      "Time_Start": 1368.3,
      "Time_End": 1369.3,
      "Text": " clients are vulnerable."
    },
    {
      "Time_Start": 1369.3,
      "Time_End": 1373.3799999999999,
      "Text": " But if you think about these 10 billion deployments that I mentioned, and if you think about 1%"
    },
    {
      "Time_Start": 1373.3799999999999,
      "Time_End": 1377.62,
      "Text": " of those is already 100 million devices out there, you can have an idea of the scale of"
    },
    {
      "Time_Start": 1377.6200000000001,
      "Time_End": 1380.7800000000002,
      "Text": " this type of vulnerability."
    },
    {
      "Time_Start": 1380.7800000000002,
      "Time_End": 1386.0600000000002,
      "Text": " So again, this highlights supply chain issues that we already discussed in previous research,"
    },
    {
      "Time_Start": 1386.0600000000002,
      "Time_End": 1387.0600000000002,
      "Text": " right?"
    },
    {
      "Time_Start": 1387.0600000000002,
      "Time_End": 1389.5800000000002,
      "Text": " This is another example of vulnerabilities that trickle down the supply chain, and that's"
    },
    {
      "Time_Start": 1389.5800000000002,
      "Time_End": 1396.5000000000002,
      "Text": " why you have so many affected devices, because of popular components that are embedded in"
    },
    {
      "Time_Start": 1396.5000000000002,
      "Time_End": 1397.5000000000002,
      "Text": " these devices, right?"
    },
    {
      "Time_Start": 1397.5000000000002,
      "Time_End": 1400.18,
      "Text": " Popular software and hardware components."
    },
    {
      "Time_Start": 1400.18,
      "Time_End": 1404.38,
      "Text": " So if we think of two illustrative issues in this research specifically, you can think"
    },
    {
      "Time_Start": 1404.38,
      "Time_End": 1411.7,
      "Text": " back to the ipnet slash VxWorks 6.6 issue that was mentioned by Shlomi during the vulnerabilities."
    },
    {
      "Time_Start": 1411.7,
      "Time_End": 1417.5800000000002,
      "Text": " So that was a vulnerability that was originally found in 2016, but we found it again this"
    },
    {
      "Time_Start": 1417.5800000000002,
      "Time_End": 1419.8600000000001,
      "Text": " year and we know that it was silently patched."
    },
    {
      "Time_Start": 1419.8600000000001,
      "Time_End": 1428.9,
      "Text": " Now it's been issued the CVE-2016-2009 ID, but before there was no ID for it, right?"
    },
    {
      "Time_Start": 1428.9,
      "Time_End": 1433.14,
      "Text": " So we couldn't track this vulnerability properly."
    },
    {
      "Time_Start": 1433.14,
      "Time_End": 1437.5800000000002,
      "Text": " And we know that it has been fixed in at least some devices that mentioned this vulnerability"
    },
    {
      "Time_Start": 1437.5800000000002,
      "Time_End": 1441.98,
      "Text": " specific, so they weren't notified by the vendor, but we don't know actually which devices"
    },
    {
      "Time_Start": 1441.98,
      "Time_End": 1445.3400000000001,
      "Text": " have or have not been patched."
    },
    {
      "Time_Start": 1445.3400000000001,
      "Time_End": 1449.74,
      "Text": " And this actually affects a version of VxWorks that is currently unsupported, but we know"
    },
    {
      "Time_Start": 1449.74,
      "Time_End": 1455.14,
      "Text": " that there are several examples of currently supported devices, firmer and currently supported"
    },
    {
      "Time_Start": 1455.14,
      "Time_End": 1460.94,
      "Text": " devices that runs VxWorks, even 5, which is 20 years old, right?"
    },
    {
      "Time_Start": 1460.94,
      "Time_End": 1465.5800000000002,
      "Text": " And we haven't checked where this vulnerability is still active or not."
    },
    {
      "Time_Start": 1465.5800000000002,
      "Time_End": 1470.46,
      "Text": " There could be patches via extended support for these older versions of VxWorks, but you"
    },
    {
      "Time_Start": 1470.46,
      "Time_End": 1477.98,
      "Text": " can have an idea of the reach and the difficulty in understanding affected devices with these"
    },
    {
      "Time_Start": 1477.98,
      "Time_End": 1481.06,
      "Text": " third-party components."
    },
    {
      "Time_Start": 1481.06,
      "Time_End": 1486.66,
      "Text": " The second issue that we have is the Nordic SDK that Shlomi mentioned that we found the"
    },
    {
      "Time_Start": 1486.66,
      "Time_End": 1490.46,
      "Text": " vulnerability, and the vendor mentioned that that was not production software."
    },
    {
      "Time_Start": 1490.46,
      "Time_End": 1495.38,
      "Text": " It was demonstration code, experimental code, sorry, in the SDK and so on."
    },
    {
      "Time_Start": 1495.38,
      "Time_End": 1500.3400000000001,
      "Text": " But we know that developers tend to use this type of demonstrations or experimental code"
    },
    {
      "Time_Start": 1500.3400000000001,
      "Time_End": 1504.38,
      "Text": " or so on from SDKs in production devices, right?"
    },
    {
      "Time_Start": 1504.38,
      "Time_End": 1510.78,
      "Text": " We have a couple of examples there of scientific papers mentioning how vulnerable example code"
    },
    {
      "Time_Start": 1510.78,
      "Time_End": 1516.46,
      "Text": " turns out in web applications or in C++ applications, and we know that for embedded devices the"
    },
    {
      "Time_Start": 1516.46,
      "Time_End": 1517.82,
      "Text": " similar issue happens."
    },
    {
      "Time_Start": 1517.82,
      "Time_End": 1524.78,
      "Text": " So again, think of the fact that once vulnerable code is out there, it tends to spread."
    },
    {
      "Time_Start": 1524.78,
      "Time_End": 1529.98,
      "Text": " And this leads to different types of impact, depending on the devices that actually employ"
    },
    {
      "Time_Start": 1529.98,
      "Time_End": 1532.98,
      "Text": " this code, right?"
    },
    {
      "Time_Start": 1532.98,
      "Time_End": 1537.54,
      "Text": " So if you think of both sides of the coin, there are the exploitation and the patching"
    },
    {
      "Time_Start": 1537.54,
      "Time_End": 1538.54,
      "Text": " part."
    },
    {
      "Time_Start": 1538.54,
      "Time_End": 1544.54,
      "Text": " We know that FreeBSD, for instance, is a modern operating system that has sandboxing, has"
    },
    {
      "Time_Start": 1544.54,
      "Time_End": 1552.3799999999999,
      "Text": " exploit mitigation, and is typically much more difficult to exploit than a typical embedded"
    },
    {
      "Time_Start": 1552.3799999999999,
      "Time_End": 1559.6599999999999,
      "Text": " device that runs on constrained hardware that has barely any memory protection, which is"
    },
    {
      "Time_Start": 1559.6599999999999,
      "Time_End": 1561.7,
      "Text": " basically the case of the other stacks, right?"
    },
    {
      "Time_Start": 1561.7,
      "Time_End": 1567.26,
      "Text": " So we can see that this issue is spreading from the IT to the IoT and OT environment,"
    },
    {
      "Time_Start": 1567.26,
      "Time_End": 1570.7,
      "Text": " and the exploitation nuances are definitely different there."
    },
    {
      "Time_Start": 1570.74,
      "Time_End": 1575.82,
      "Text": " But if you think of patching as well, we know that for FreeBSD, that often runs in IT servers"
    },
    {
      "Time_Start": 1575.82,
      "Time_End": 1581.82,
      "Text": " that are much easier to identify on the network, to patch centrally if you have SSH-managed"
    },
    {
      "Time_Start": 1581.82,
      "Time_End": 1585.8600000000001,
      "Text": " servers or devices, you have high availability, for instance, where one can be taken offline"
    },
    {
      "Time_Start": 1585.8600000000001,
      "Time_End": 1592.42,
      "Text": " and the other instance will take over, which is just not the case in IoT and OT devices,"
    },
    {
      "Time_Start": 1592.42,
      "Time_End": 1593.42,
      "Text": " right?"
    },
    {
      "Time_Start": 1593.42,
      "Time_End": 1597.54,
      "Text": " So there's other stacks that tend to run on very specific firmware, mission-critical devices"
    },
    {
      "Time_Start": 1597.54,
      "Time_End": 1599.24,
      "Text": " that cannot be taken offline."
    },
    {
      "Time_Start": 1599.24,
      "Time_End": 1603.52,
      "Text": " You have to wait for patches to trickle down the supply chain from the stack maintainer"
    },
    {
      "Time_Start": 1603.52,
      "Time_End": 1609.96,
      "Text": " to possibly an operating system vendor to, in the end, the actual device vendor."
    },
    {
      "Time_Start": 1609.96,
      "Time_End": 1614.48,
      "Text": " And that takes time and takes a lot of effort."
    },
    {
      "Time_Start": 1614.48,
      "Time_End": 1619.48,
      "Text": " So if we discuss the mitigation differences that we started looking at and how we can"
    },
    {
      "Time_Start": 1619.48,
      "Time_End": 1624.96,
      "Text": " move forward in terms of mitigating these issues from both the developer point of view"
    },
    {
      "Time_Start": 1624.96,
      "Time_End": 1632.64,
      "Text": " and the network operator point of view, we want to highlight four instances there of"
    },
    {
      "Time_Start": 1632.64,
      "Time_End": 1635.56,
      "Text": " how we can mitigate these issues in the future."
    },
    {
      "Time_Start": 1635.56,
      "Time_End": 1639.96,
      "Text": " So we want to discuss better documentation and static analysis for developers and device"
    },
    {
      "Time_Start": 1639.96,
      "Time_End": 1644.2,
      "Text": " fingerprinting and intrusion detection for network operators."
    },
    {
      "Time_Start": 1644.2,
      "Time_End": 1649.56,
      "Text": " So on the side of the developers, we really wanted to highlight the issue of better documentation"
    },
    {
      "Time_Start": 1649.8,
      "Time_End": 1654.96,
      "Text": " because we know that specification and security information is scattered across RFCs, and"
    },
    {
      "Time_Start": 1654.96,
      "Time_End": 1660.3999999999999,
      "Text": " that's not just for DNS, but for several internet protocols, right?"
    },
    {
      "Time_Start": 1660.3999999999999,
      "Time_End": 1664.0,
      "Text": " And unfortunately, we have seen, again, in previous research and we have confirmed in"
    },
    {
      "Time_Start": 1664.0,
      "Time_End": 1672.12,
      "Text": " this research that these RFCs are often complex, ambiguous, or sometimes outdated."
    },
    {
      "Time_Start": 1672.12,
      "Time_End": 1674.8799999999999,
      "Text": " This leads to drastic security effects, right?"
    },
    {
      "Time_Start": 1674.88,
      "Time_End": 1679.8000000000002,
      "Text": " So if we look at two instances of RFCs that are related to DNS, for instance, we see that"
    },
    {
      "Time_Start": 1679.8000000000002,
      "Time_End": 1688.2800000000002,
      "Text": " there's this DNS proxy implementation guidelines that mentions some issues with DNS compression"
    },
    {
      "Time_Start": 1688.2800000000002,
      "Time_End": 1693.16,
      "Text": " and compression pointers, invalid compression pointers that may be dropped, but they don't"
    },
    {
      "Time_Start": 1693.16,
      "Time_End": 1696.2,
      "Text": " mention all of the issues that we found."
    },
    {
      "Time_Start": 1696.2,
      "Time_End": 1699.7600000000002,
      "Text": " They also mentioned the other empty pattern about incorrect counts."
    },
    {
      "Time_Start": 1699.8,
      "Time_End": 1706.48,
      "Text": " And these issues are mentioned in RFC that is not the DNS specification RFC itself, right?"
    },
    {
      "Time_Start": 1706.48,
      "Time_End": 1714.64,
      "Text": " So it may be that a developer implementing the DNS client will just not find this exact"
    },
    {
      "Time_Start": 1714.64,
      "Time_End": 1716.36,
      "Text": " specification."
    },
    {
      "Time_Start": 1716.36,
      "Time_End": 1721.8799999999999,
      "Text": " And also, this specification mentions that these packets may be dropped, but doesn't"
    },
    {
      "Time_Start": 1721.8799999999999,
      "Time_End": 1727.8,
      "Text": " alert you to the security issues that these packets bring, and that they probably must"
    },
    {
      "Time_Start": 1727.8,
      "Time_End": 1729.12,
      "Text": " be dropped, right?"
    },
    {
      "Time_Start": 1729.12,
      "Time_End": 1733.8,
      "Text": " Not just that they may be dropped in some cases, but they really should be dropped to"
    },
    {
      "Time_Start": 1733.8,
      "Time_End": 1736.1599999999999,
      "Text": " avoid security issues."
    },
    {
      "Time_Start": 1736.1599999999999,
      "Time_End": 1742.3999999999999,
      "Text": " On the other hand, the second example there is an RFC that actually never made it past"
    },
    {
      "Time_Start": 1742.3999999999999,
      "Time_End": 1743.3999999999999,
      "Text": " the draft stage."
    },
    {
      "Time_Start": 1743.3999999999999,
      "Time_End": 1749.44,
      "Text": " It was about a new compression scheme for DNS, but yeah, it didn't get approved."
    },
    {
      "Time_Start": 1749.44,
      "Time_End": 1754.52,
      "Text": " And there is a section on security considerations that talks about blindly following compression"
    },
    {
      "Time_Start": 1754.52,
      "Time_End": 1757.56,
      "Text": " pointers and how dangerous that is and so on."
    },
    {
      "Time_Start": 1757.6,
      "Time_End": 1761.3999999999999,
      "Text": " But again, this is something that didn't really become standard, right?"
    },
    {
      "Time_Start": 1761.3999999999999,
      "Time_End": 1772.32,
      "Text": " And this is a problem because again, the information is scattered and it's not really centralized"
    },
    {
      "Time_Start": 1772.32,
      "Time_End": 1773.8,
      "Text": " to where to find it."
    },
    {
      "Time_Start": 1773.8,
      "Time_End": 1778.9199999999998,
      "Text": " So we actually took it to ourselves to write an information RFC draft about these identified"
    },
    {
      "Time_Start": 1778.9199999999998,
      "Time_End": 1784.48,
      "Text": " empty patterns and how to avoid them for future developments."
    },
    {
      "Time_Start": 1784.48,
      "Time_End": 1790.16,
      "Text": " We submitted that to the ITF and we are making it available on our GitHub as well."
    },
    {
      "Time_Start": 1790.16,
      "Time_End": 1794.92,
      "Text": " In terms of static analysis, we know that developers need tools to readily spot potential"
    },
    {
      "Time_Start": 1794.92,
      "Time_End": 1795.92,
      "Text": " bugs."
    },
    {
      "Time_Start": 1795.92,
      "Time_End": 1800.04,
      "Text": " So we created some code to identify these empty patterns and specifically the DNS compression"
    },
    {
      "Time_Start": 1800.04,
      "Time_End": 1807.88,
      "Text": " empty pattern using Yarn, which is an open source framework for code querying for C and"
    },
    {
      "Time_Start": 1807.88,
      "Time_End": 1809.56,
      "Text": " C++ implementations."
    },
    {
      "Time_Start": 1809.56,
      "Time_End": 1817.8,
      "Text": " So we developed a plugin on top of this framework and it can be downloaded on our GitHub webpage"
    },
    {
      "Time_Start": 1817.8,
      "Time_End": 1820.28,
      "Text": " that is displayed there on the slides."
    },
    {
      "Time_Start": 1820.28,
      "Time_End": 1825.48,
      "Text": " And those screenshots show a little bit of how the query works and what is the output"
    },
    {
      "Time_Start": 1825.48,
      "Time_End": 1831.32,
      "Text": " of a potentially vulnerable piece of code in a TCPoP stack."
    },
    {
      "Time_Start": 1831.32,
      "Time_End": 1836.04,
      "Text": " In terms of device fingerprinting as well, we know that embedded stacks typically have"
    },
    {
      "Time_Start": 1836.04,
      "Time_End": 1840.72,
      "Text": " implementation quirks that are often useful for stack fingerprinting."
    },
    {
      "Time_Start": 1840.72,
      "Time_End": 1845.48,
      "Text": " More specifically ICMP replies, for instance, and TCP options as well, they are prime examples"
    },
    {
      "Time_Start": 1845.48,
      "Time_End": 1852.96,
      "Text": " of how things are implemented sometimes not according to RFCs or in slightly different"
    },
    {
      "Time_Start": 1852.96,
      "Time_End": 1858.1599999999999,
      "Text": " ways in the case of TCP options and that can be used for precise and accurate fingerprinting"
    },
    {
      "Time_Start": 1858.1599999999999,
      "Time_End": 1859.1599999999999,
      "Text": " of stacks."
    },
    {
      "Time_Start": 1859.1599999999999,
      "Time_End": 1863.56,
      "Text": " And most importantly, this accurate fingerprinting is really what enables other mitigations such"
    },
    {
      "Time_Start": 1863.56,
      "Time_End": 1868.24,
      "Text": " as patching, where you can only patch something that you know is vulnerable and segmentation"
    },
    {
      "Time_Start": 1868.24,
      "Time_End": 1871.48,
      "Text": " in terms of isolating devices in the network."
    },
    {
      "Time_Start": 1871.48,
      "Time_End": 1877.84,
      "Text": " So we have updated our project memorial detector, which is an open source tool to detect TCPoP"
    },
    {
      "Time_Start": 1877.84,
      "Time_End": 1884.56,
      "Text": " stacks running on a device with information that is specific to the stacks that are part"
    },
    {
      "Time_Start": 1884.56,
      "Time_End": 1885.6399999999999,
      "Text": " of this research."
    },
    {
      "Time_Start": 1885.6399999999999,
      "Time_End": 1890.12,
      "Text": " And we will continue to maintain this tool with stacks, not just that are vulnerable"
    },
    {
      "Time_Start": 1890.1200000000001,
      "Time_End": 1896.68,
      "Text": " within project memoria, but also other stacks that we have knowledge about."
    },
    {
      "Time_Start": 1896.68,
      "Time_End": 1902.0000000000002,
      "Text": " If we talk about intrusion detection and exploit detection rules, we know that we can basically"
    },
    {
      "Time_Start": 1902.0000000000002,
      "Time_End": 1908.8400000000001,
      "Text": " turn the entry patterns we found in the vulnerability examples into rules for dropping packets,"
    },
    {
      "Time_Start": 1908.8400000000001,
      "Time_End": 1914.64,
      "Text": " or at least alerting to their presence if you're running on a highly critical environment"
    },
    {
      "Time_Start": 1914.64,
      "Time_End": 1918.8400000000001,
      "Text": " such as operational technology and industrial control systems or medical devices where dropping"
    },
    {
      "Time_Start": 1918.8400000000001,
      "Time_End": 1921.5600000000002,
      "Text": " packets might be problematic."
    },
    {
      "Time_Start": 1921.5600000000002,
      "Time_End": 1927.2400000000002,
      "Text": " So if we look at the main entry patterns that we identified, so invalid domain name labels,"
    },
    {
      "Time_Start": 1927.2400000000002,
      "Time_End": 1934.0800000000002,
      "Text": " invalid domain names, and resource data lengths, invalid compression pointers, and record counts,"
    },
    {
      "Time_Start": 1934.0800000000002,
      "Time_End": 1937.88,
      "Text": " basically all of those can become rules for intrusion detection systems, right?"
    },
    {
      "Time_Start": 1937.88,
      "Time_End": 1942.16,
      "Text": " And I'm not going to read all of the specific rules there, but this is a pretty comprehensive"
    },
    {
      "Time_Start": 1942.16,
      "Time_End": 1947.44,
      "Text": " list of rules that if implemented on an intrusion detection system allows you to not just detect"
    },
    {
      "Time_Start": 1947.44,
      "Time_End": 1952.0,
      "Text": " exploitation of the vulnerabilities that we did find, but also many others that might"
    },
    {
      "Time_Start": 1952.0,
      "Time_End": 1957.72,
      "Text": " appear in the future because they follow the same entry patterns."
    },
    {
      "Time_Start": 1957.72,
      "Time_End": 1964.2,
      "Text": " And also for intrusion detection, we are making available a set of scripts and pcaps with"
    },
    {
      "Time_Start": 1964.2,
      "Time_End": 1971.3600000000001,
      "Text": " malicious packets that allow you to test that intrusion detection rules are actually capturing"
    },
    {
      "Time_Start": 1971.3600000000001,
      "Time_End": 1972.92,
      "Text": " the proper packets."
    },
    {
      "Time_Start": 1972.92,
      "Time_End": 1974.68,
      "Text": " This is available under request."
    },
    {
      "Time_Start": 1974.68,
      "Time_End": 1979.8,
      "Text": " It's not publicly available on GitHub, but we can share it with whoever is interested."
    },
    {
      "Time_Start": 1979.8,
      "Time_End": 1983.4,
      "Text": " So moving on to the conclusion, right?"
    },
    {
      "Time_Start": 1983.4,
      "Time_End": 1988.04,
      "Text": " We know that RFC misimplementation is a common cause of vulnerabilities anticipated stacks"
    },
    {
      "Time_Start": 1988.04,
      "Time_End": 1990.8400000000001,
      "Text": " because they are often complex and behaviors outdated."
    },
    {
      "Time_Start": 1990.8400000000001,
      "Time_End": 1995.04,
      "Text": " And this leads to the fact that DNS clients have several vulnerabilities."
    },
    {
      "Time_Start": 1995.04,
      "Time_End": 1997.52,
      "Text": " So message compression stands out."
    },
    {
      "Time_Start": 1997.52,
      "Time_End": 2003.3600000000001,
      "Text": " It's a very common entry pattern and it often leads to RCE and we really showed with this"
    },
    {
      "Time_Start": 2003.4,
      "Time_End": 2008.68,
      "Text": " research that it's out there in TCP IP stacks, but we do expect it to be out there in many"
    },
    {
      "Time_Start": 2008.68,
      "Time_End": 2010.48,
      "Text": " other products as well."
    },
    {
      "Time_Start": 2010.48,
      "Time_End": 2014.3200000000002,
      "Text": " Not implementing support for compression, on the other hand, seems to be an effective"
    },
    {
      "Time_Start": 2014.3200000000002,
      "Time_End": 2016.48,
      "Text": " mitigation against this type of vulnerability."
    },
    {
      "Time_Start": 2016.48,
      "Time_End": 2021.1200000000001,
      "Text": " Of course, you're limiting functionality, but there is an interesting discussion there"
    },
    {
      "Time_Start": 2021.1200000000001,
      "Time_End": 2026.0800000000002,
      "Text": " that if the bandwidth saving that's associated to compression is basically almost meaningless"
    },
    {
      "Time_Start": 2026.0800000000002,
      "Time_End": 2032.7600000000002,
      "Text": " nowadays for several devices that have fast connectivity, this type of feature might just"
    },
    {
      "Time_Start": 2032.76,
      "Time_End": 2034.8799999999999,
      "Text": " introduce more problems than it solves, right?"
    },
    {
      "Time_Start": 2034.8799999999999,
      "Time_End": 2039.96,
      "Text": " So you as a developer might think of just not enabling it."
    },
    {
      "Time_Start": 2039.96,
      "Time_End": 2044.44,
      "Text": " And DNS clients, they seem to be tested less rigorously than servers for security."
    },
    {
      "Time_Start": 2044.44,
      "Time_End": 2049.72,
      "Text": " We mentioned several vulnerabilities on servers that we found at the beginning of the, or"
    },
    {
      "Time_Start": 2049.72,
      "Time_End": 2053.76,
      "Text": " that were found by other people, but we listed at the beginning of this research."
    },
    {
      "Time_Start": 2053.76,
      "Time_End": 2059.88,
      "Text": " But it seems that client clients are less rigorously tested because they communicated"
    },
    {
      "Time_Start": 2059.88,
      "Time_End": 2061.88,
      "Text": " with a limited set of servers."
    },
    {
      "Time_Start": 2061.88,
      "Time_End": 2067.0,
      "Text": " They may be prone to vulnerabilities being detected later in their development stage"
    },
    {
      "Time_Start": 2067.0,
      "Time_End": 2070.7200000000003,
      "Text": " just because they follow a different model than servers, right?"
    },
    {
      "Time_Start": 2070.7200000000003,
      "Time_End": 2076.28,
      "Text": " They talk to usually trusted servers rather than untrusted clients."
    },
    {
      "Time_Start": 2076.28,
      "Time_End": 2081.48,
      "Text": " Not only for the TCP IP stacks, these issues turned up into vulnerabilities, but every"
    },
    {
      "Time_Start": 2081.48,
      "Time_End": 2084.04,
      "Text": " DNS implementation out there should be tested, right?"
    },
    {
      "Time_Start": 2084.04,
      "Time_End": 2088.8,
      "Text": " So we're talking of firewalls, IDSs, packet desectors, forwarders, and basically any sort"
    },
    {
      "Time_Start": 2088.8,
      "Time_End": 2094.5600000000004,
      "Text": " of software that parses DNS packets."
    },
    {
      "Time_Start": 2094.5600000000004,
      "Time_End": 2100.2400000000002,
      "Text": " If we talk about key takeaways of this research, DNS complexity leads to critical vulnerabilities,"
    },
    {
      "Time_Start": 2100.2400000000002,
      "Time_End": 2103.5600000000004,
      "Text": " not just the complexity of our RFCs, but the protocol itself, right?"
    },
    {
      "Time_Start": 2103.5600000000004,
      "Time_End": 2108.1600000000003,
      "Text": " 50% of what we analyzed is vulnerable to this specific compression anti-pattern."
    },
    {
      "Time_Start": 2108.1600000000003,
      "Time_End": 2112.4,
      "Text": " That means that other implementations are probably vulnerable, as I just mentioned."
    },
    {
      "Time_Start": 2112.4,
      "Time_End": 2116.4,
      "Text": " The fact that we looked at TCP IP stacks amplifies really the problem because this vulnerable"
    },
    {
      "Time_Start": 2116.4,
      "Time_End": 2122.08,
      "Text": " code runs in millions of devices, but other types of products might as well be vulnerable"
    },
    {
      "Time_Start": 2122.08,
      "Time_End": 2124.84,
      "Text": " and be vulnerable at a large scale."
    },
    {
      "Time_Start": 2124.84,
      "Time_End": 2127.7200000000003,
      "Text": " But there are several steps to mitigate this problem, right?"
    },
    {
      "Time_Start": 2127.7200000000003,
      "Time_End": 2131.4,
      "Text": " We are releasing with this research this report about vulnerabilities and anti-patterns, the"
    },
    {
      "Time_Start": 2131.4,
      "Time_End": 2136.44,
      "Text": " draft information RFC, the open source static analysis queries, the open source fingerprinting"
    },
    {
      "Time_Start": 2136.44,
      "Time_End": 2138.42,
      "Text": " of stacks, and the malicious PCAPs."
    },
    {
      "Time_Start": 2138.42,
      "Time_End": 2144.7200000000003,
      "Text": " They can all be obtained either on GitHub or website or directly by contacting us."
    },
    {
      "Time_Start": 2144.7200000000003,
      "Time_End": 2150.44,
      "Text": " We hope that this means that we can mitigate DNS-based vulnerabilities and eradicate them"
    },
    {
      "Time_Start": 2150.44,
      "Time_End": 2151.44,
      "Text": " in the future."
    },
    {
      "Time_Start": 2151.44,
      "Time_End": 2152.88,
      "Text": " Thank you very much."
    },
    {
      "Time_Start": 2152.88,
      "Time_End": 2155.0400000000004,
      "Text": " That's what I had to present today."
    },
    {
      "Time_Start": 2155.0400000000004,
      "Time_End": 2160.44,
      "Text": " We're open for questions, but please, if you would like to know more about this other research"
    },
    {
      "Time_Start": 2160.44,
      "Time_End": 2166.0400000000004,
      "Text": " that we're doing as well, contact us or follow us on social media, and we'll be glad to connect."
    },
    {
      "Time_Start": 2166.0400000000004,
      "Time_End": 2166.7200000000003,
      "Text": " Thank you very much."
    }
  ]
}