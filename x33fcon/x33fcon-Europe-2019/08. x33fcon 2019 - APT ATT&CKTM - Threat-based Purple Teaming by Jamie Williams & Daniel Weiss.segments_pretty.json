{
  "segments": [
    {
      "Time_Start": 0.0,
      "Time_End": 12.120000000000001,
      "Text": "This text was transcribed using whisper model: large-v2\n\n Thank you, and good morning."
    },
    {
      "Time_Start": 12.120000000000001,
      "Time_End": 15.76,
      "Text": " As you can see, the title of our talk is APT Attack Threat-Based Purple Teaming Using"
    },
    {
      "Time_Start": 15.76,
      "Time_End": 17.12,
      "Text": " ATT&CK."
    },
    {
      "Time_Start": 17.12,
      "Time_End": 18.6,
      "Text": " You might have noticed ATT&CK is in there twice."
    },
    {
      "Time_Start": 18.6,
      "Time_End": 19.6,
      "Text": " That's not an accident."
    },
    {
      "Time_Start": 19.6,
      "Time_End": 21.6,
      "Text": " We are big fans of ATT&CK."
    },
    {
      "Time_Start": 21.6,
      "Time_End": 24.2,
      "Text": " As the introduction said, we are from MITRE."
    },
    {
      "Time_Start": 24.2,
      "Time_End": 29.0,
      "Text": " Before we continue to a formal introduction, my name is Jamie Williams."
    },
    {
      "Time_Start": 29.0,
      "Time_End": 31.18,
      "Text": " I'm an adversarial engineer at MITRE."
    },
    {
      "Time_Start": 31.18,
      "Time_End": 36.44,
      "Text": " I do mostly research in adversary emulation as well as behavior detections, and some of"
    },
    {
      "Time_Start": 36.44,
      "Time_End": 40.480000000000004,
      "Text": " the work you might have seen in the public space that I work on, MITRE ATT&CK, as well"
    },
    {
      "Time_Start": 40.480000000000004,
      "Time_End": 41.480000000000004,
      "Text": " as ATT&CK evaluations."
    },
    {
      "Time_Start": 41.480000000000004,
      "Time_End": 42.480000000000004,
      "Text": " Am I not close enough to the mic?"
    },
    {
      "Time_Start": 42.480000000000004,
      "Time_End": 43.480000000000004,
      "Text": " I'll get a little..."
    },
    {
      "Time_Start": 43.480000000000004,
      "Time_End": 44.480000000000004,
      "Text": " Okay."
    },
    {
      "Time_Start": 44.480000000000004,
      "Time_End": 45.480000000000004,
      "Text": " That's a lot better."
    },
    {
      "Time_Start": 45.480000000000004,
      "Time_End": 46.480000000000004,
      "Text": " I can hear myself now."
    },
    {
      "Time_Start": 46.480000000000004,
      "Time_End": 47.480000000000004,
      "Text": " Okay."
    },
    {
      "Time_Start": 47.480000000000004,
      "Time_End": 48.480000000000004,
      "Text": " And I'm Daniel Weiss."
    },
    {
      "Time_Start": 48.480000000000004,
      "Time_End": 55.760000000000005,
      "Text": " I'm a cybersecurity engineer at MITRE as well, have been there for just about three years."
    },
    {
      "Time_Start": 55.76,
      "Time_End": 62.64,
      "Text": " I do both red and blue, split almost 50-50 right now, and I'm also on the ATT&CK evaluations"
    },
    {
      "Time_Start": 62.64,
      "Time_End": 63.64,
      "Text": " team."
    },
    {
      "Time_Start": 63.64,
      "Time_End": 68.24,
      "Text": " So, as I said, you might have noticed from the title of our deck, we are continuing a"
    },
    {
      "Time_Start": 68.24,
      "Time_End": 70.56,
      "Text": " conversation or presentation from last year."
    },
    {
      "Time_Start": 70.56,
      "Time_End": 74.64,
      "Text": " So, if you recognize those gentlemen, that's Cody and Chris, good friends of ours."
    },
    {
      "Time_Start": 74.64,
      "Time_End": 77.03999999999999,
      "Text": " They were here last year briefing on the same topic."
    },
    {
      "Time_Start": 77.03999999999999,
      "Time_End": 81.08,
      "Text": " So, basically, in that shape, our talk today is we're basically picking up where that conversation"
    },
    {
      "Time_Start": 81.08,
      "Time_End": 86.24,
      "Text": " left off and giving a little more example and depth into threat-based purple teaming"
    },
    {
      "Time_Start": 86.24,
      "Time_End": 87.24,
      "Text": " using ATT&CK."
    },
    {
      "Time_Start": 87.24,
      "Time_End": 91.2,
      "Text": " So, before we continue, we'll do a quick recap of what they talked about last year."
    },
    {
      "Time_Start": 91.2,
      "Time_End": 93.96,
      "Text": " So, you know, I think what is ATT&CK?"
    },
    {
      "Time_Start": 93.96,
      "Time_End": 95.64,
      "Text": " It's a great start."
    },
    {
      "Time_Start": 95.64,
      "Time_End": 100.96,
      "Text": " The guys from Atomic Threat Coverage did a pretty good job yesterday describing ATT&CK,"
    },
    {
      "Time_Start": 100.96,
      "Time_End": 105.56,
      "Text": " but at a high level, ATT&CK is our knowledge base of adversary behavior."
    },
    {
      "Time_Start": 105.56,
      "Time_End": 109.84,
      "Text": " Basically, the idea is we have this idea called threat-informed defense."
    },
    {
      "Time_Start": 110.44,
      "Time_End": 113.92,
      "Text": " If you understand what threats are doing, you are better equipped to make good decisions"
    },
    {
      "Time_Start": 113.92,
      "Time_End": 114.92,
      "Text": " in terms of defense."
    },
    {
      "Time_Start": 114.92,
      "Time_End": 120.22,
      "Text": " One of my favorite things about ATT&CK is it's not theoretical."
    },
    {
      "Time_Start": 120.22,
      "Time_End": 124.12,
      "Text": " Everything that is in ATT&CK, all the behaviors captured there, are documented real behaviors,"
    },
    {
      "Time_Start": 124.12,
      "Time_End": 127.68,
      "Text": " so things adversaries are actually doing in the wild."
    },
    {
      "Time_Start": 127.68,
      "Time_End": 128.92000000000002,
      "Text": " We're not selling ATT&CK."
    },
    {
      "Time_Start": 128.92000000000002,
      "Time_End": 132.72,
      "Text": " It's free, global, open, so you can go to the website and read everything for free."
    },
    {
      "Time_Start": 132.72,
      "Time_End": 134.08,
      "Text": " There's no subscription."
    },
    {
      "Time_Start": 134.08,
      "Time_End": 135.76,
      "Text": " There's no money exchanged."
    },
    {
      "Time_Start": 136.76,
      "Time_End": 140.28,
      "Text": " You can check out our analysis, as well as we reference everything, so you can check"
    },
    {
      "Time_Start": 140.28,
      "Time_End": 144.28,
      "Text": " out the sources that we read to make these analysis and all these judgments."
    },
    {
      "Time_Start": 144.28,
      "Time_End": 147.67999999999998,
      "Text": " So you reference everything, you can click it and go to the ground truth intelligence"
    },
    {
      "Time_Start": 147.67999999999998,
      "Time_End": 148.67999999999998,
      "Text": " there."
    },
    {
      "Time_Start": 148.67999999999998,
      "Time_End": 150.51999999999998,
      "Text": " And final point here, it's community-driven."
    },
    {
      "Time_Start": 150.51999999999998,
      "Time_End": 155.35999999999999,
      "Text": " So if you've never noticed, a lot of ATT&CK comes from what we call contributions."
    },
    {
      "Time_Start": 155.35999999999999,
      "Time_End": 157.12,
      "Text": " So we have our contact information there."
    },
    {
      "Time_Start": 157.12,
      "Time_End": 160.68,
      "Text": " It's ATT&CK at MITRE.org for email and our Twitter account."
    },
    {
      "Time_Start": 160.68,
      "Time_End": 163.92,
      "Text": " Definitely we're always looking for, if you guys see things in the wild that are missing"
    },
    {
      "Time_Start": 163.96,
      "Time_End": 167.24,
      "Text": " from ATT&CK, I think there was a mention of that yesterday, as well as there's a talk"
    },
    {
      "Time_Start": 167.24,
      "Time_End": 170.88000000000002,
      "Text": " later today about cloud behaviors."
    },
    {
      "Time_Start": 170.88000000000002,
      "Time_End": 175.44000000000003,
      "Text": " Those type of things, we're always looking for new content, so definitely reach out."
    },
    {
      "Time_Start": 175.44000000000003,
      "Time_End": 179.8,
      "Text": " So to kind of give you an overview of the structure of ATT&CK, normally you see ATT&CK"
    },
    {
      "Time_Start": 179.8,
      "Time_End": 181.36,
      "Text": " in what we call the matrix view."
    },
    {
      "Time_Start": 181.36,
      "Time_End": 184.64000000000001,
      "Text": " So I've decomposed that to kind of make it make more sense."
    },
    {
      "Time_Start": 184.64000000000001,
      "Time_End": 187.52,
      "Text": " So starting with the tactics, or what we call the adversary goals."
    },
    {
      "Time_Start": 187.52,
      "Time_End": 193.12,
      "Text": " So these are, as you see across the top, we have the 12 what we call tactics."
    },
    {
      "Time_Start": 193.12,
      "Time_End": 198.56,
      "Text": " What's special here is this is not a kill chain, so there's no linear or set order of"
    },
    {
      "Time_Start": 198.56,
      "Time_End": 199.56,
      "Text": " these."
    },
    {
      "Time_Start": 199.56,
      "Time_End": 203.48000000000002,
      "Text": " These are just basically the various different things an adversary would do in an environment"
    },
    {
      "Time_Start": 203.48000000000002,
      "Time_End": 205.20000000000002,
      "Text": " once they're post-compromised."
    },
    {
      "Time_Start": 205.20000000000002,
      "Time_End": 210.04000000000002,
      "Text": " So things like gaining initial access, executing things, moving laterally, exfiling, and then"
    },
    {
      "Time_Start": 210.04000000000002,
      "Time_End": 214.5,
      "Text": " on the end, we actually have, as of last week, our latest tactic, impacts."
    },
    {
      "Time_Start": 214.5,
      "Time_End": 218.04000000000002,
      "Text": " So attacks against availability and integrity."
    },
    {
      "Time_Start": 218.04000000000002,
      "Time_End": 220.78,
      "Text": " Coming down from every tactic, we have what we call techniques."
    },
    {
      "Time_Start": 220.78,
      "Time_End": 225.46,
      "Text": " So these are implementations of how an adversary actually achieves those goals."
    },
    {
      "Time_Start": 225.46,
      "Time_End": 227.42000000000002,
      "Text": " So for example, we look at credit access."
    },
    {
      "Time_Start": 227.42000000000002,
      "Time_End": 231.46,
      "Text": " You see things like brute forcing passwords, dumping passwords, or input capture, which"
    },
    {
      "Time_Start": 231.46,
      "Time_End": 238.26,
      "Text": " is basically key logging, so capturing keystrokes to gain access to credentials."
    },
    {
      "Time_Start": 238.26,
      "Time_End": 241.14,
      "Text": " Within each technique, we have what we call procedures."
    },
    {
      "Time_Start": 241.14,
      "Time_End": 244.82,
      "Text": " So if you go to this page on the website and click on individual one, you'll see a full"
    },
    {
      "Time_Start": 244.82,
      "Time_End": 248.28,
      "Text": " write-up on what we mean by that technique, as well as what we call procedures, which"
    },
    {
      "Time_Start": 248.28,
      "Time_End": 252.92,
      "Text": " are actual malware or groups that have done this specific technique."
    },
    {
      "Time_Start": 252.92,
      "Time_End": 257.76,
      "Text": " So in this case, we're highlighting accessibility features, and as you see, that technique spans"
    },
    {
      "Time_Start": 257.76,
      "Time_End": 258.76,
      "Text": " multiple tactics."
    },
    {
      "Time_Start": 258.76,
      "Time_End": 262.2,
      "Text": " So it's PrivEsc and Privilege persistence."
    },
    {
      "Time_Start": 262.2,
      "Time_End": 266.52,
      "Text": " So if you take a look at the procedures, it's kind of small, but basically you see how different"
    },
    {
      "Time_Start": 266.52,
      "Time_End": 269.28,
      "Text": " groups have done accessibility features for persistence."
    },
    {
      "Time_Start": 269.28,
      "Time_End": 274.64,
      "Text": " So in the case of APT3, they replaced the binary with their own payload, so when you"
    },
    {
      "Time_Start": 274.64,
      "Time_End": 279.15999999999997,
      "Text": " go to an RDP desktop or a login page and hit shift five times, CMD will pop or the"
    },
    {
      "Time_Start": 279.15999999999997,
      "Time_End": 283.36,
      "Text": " payload launches, as well as there's an empire module that can do something similar, replaces"
    },
    {
      "Time_Start": 283.36,
      "Time_End": 290.71999999999997,
      "Text": " the magnify binary with CMD, so you go to a login page and you open the magnifying glass"
    },
    {
      "Time_Start": 290.71999999999997,
      "Time_End": 297.15999999999997,
      "Text": " and instead of seeing a zoomed in thing, you see a CMD pop, and that's obviously malicious."
    },
    {
      "Time_Start": 297.15999999999997,
      "Time_End": 300.44,
      "Text": " So getting back to what Cody and Chris talked about last year, one of the things they were"
    },
    {
      "Time_Start": 300.44,
      "Time_End": 302.88,
      "Text": " really excited about is what we call emulation plans."
    },
    {
      "Time_Start": 302.88,
      "Time_End": 305.8,
      "Text": " This is actually a new concept recently."
    },
    {
      "Time_Start": 305.8,
      "Time_End": 311.74,
      "Text": " Basically the idea is taking these tactics from attack and mapping them into a structure"
    },
    {
      "Time_Start": 311.74,
      "Time_End": 313.76,
      "Text": " for how you would emulate an adversary."
    },
    {
      "Time_Start": 313.76,
      "Time_End": 318.36,
      "Text": " So in this case, what they released at the last CFCon was APT3, so they basically did"
    },
    {
      "Time_Start": 318.36,
      "Time_End": 323.4,
      "Text": " a lot of research into the actual cadence of APT3, how they actually maneuver, starting"
    },
    {
      "Time_Start": 323.4,
      "Time_End": 328.02,
      "Text": " with the different phases, so getting their payloads ready and delivering it to a victim,"
    },
    {
      "Time_Start": 328.02,
      "Time_End": 333.5,
      "Text": " what they do when they compromise a host, evading defenses, discovery, so there's various"
    },
    {
      "Time_Start": 333.5,
      "Time_End": 338.53999999999996,
      "Text": " techniques within those tactics, and then phase three, collecting, exfil, and compressing"
    },
    {
      "Time_Start": 338.53999999999996,
      "Time_End": 341.58,
      "Text": " and staging their data."
    },
    {
      "Time_Start": 341.58,
      "Time_End": 347.82,
      "Text": " Another big point they talked about last year was using attack to evaluate specific techniques,"
    },
    {
      "Time_Start": 347.82,
      "Time_End": 352.65999999999997,
      "Text": " so in this case we have what we call our navigator, this basically allows you to make filters"
    },
    {
      "Time_Start": 352.65999999999997,
      "Time_End": 357.5,
      "Text": " or highlight specific techniques and make your own matrix, so what they were talking"
    },
    {
      "Time_Start": 357.5,
      "Time_End": 361.86,
      "Text": " about was basically, you know, you select the techniques you're interested in, or even"
    },
    {
      "Time_Start": 361.86,
      "Time_End": 366.74,
      "Text": " just one, and you use this purple teaming model to evaluate that, so basically the idea"
    },
    {
      "Time_Start": 366.74,
      "Time_End": 371.98,
      "Text": " is you start with emulating a technique, so in this case, execution through API, you figure"
    },
    {
      "Time_Start": 371.98,
      "Time_End": 376.1,
      "Text": " out how an adversary would execute that and run it in your environment, and on the blue"
    },
    {
      "Time_Start": 376.1,
      "Time_End": 382.46,
      "Text": " perspective you detect that or defend it however you choose, but the big point here is transparency"
    },
    {
      "Time_Start": 382.46,
      "Time_End": 385.98,
      "Text": " between each end, so the red team is sharing with the blue exactly what happened, exactly"
    },
    {
      "Time_Start": 385.98,
      "Time_End": 389.98,
      "Text": " when they did it, and completely telling you there's no black box testing, so telling"
    },
    {
      "Time_Start": 389.98,
      "Time_End": 392.62,
      "Text": " you exactly what happened and when, where, and how."
    },
    {
      "Time_Start": 392.62,
      "Time_End": 398.34000000000003,
      "Text": " Blue team defends it based on all that knowledge, pushes their defense back to red, so basically"
    },
    {
      "Time_Start": 398.34000000000003,
      "Time_End": 402.46000000000004,
      "Text": " the challenge there is to up, so say, hey, now that I know you're defending it this way,"
    },
    {
      "Time_Start": 402.46000000000004,
      "Time_End": 407.34000000000003,
      "Text": " can I do that same technique or behavior and bypass your new defense, so that iterative"
    },
    {
      "Time_Start": 407.34000000000003,
      "Time_End": 414.42,
      "Text": " process going back and forth, as you can probably tell, the level of complexity and resiliency"
    },
    {
      "Time_Start": 414.42,
      "Time_End": 416.74,
      "Text": " increases each time."
    },
    {
      "Time_Start": 416.74,
      "Time_End": 420.1,
      "Text": " So you're probably thinking right now, like, am I going to spend the entire time talking"
    },
    {
      "Time_Start": 420.1,
      "Time_End": 425.42,
      "Text": " about what happened last year, no, so thankfully we do have some new content here and it's"
    },
    {
      "Time_Start": 425.42,
      "Time_End": 429.02000000000004,
      "Text": " actually pretty exciting for us, we're actually going to take a deeper dive into the science"
    },
    {
      "Time_Start": 429.02000000000004,
      "Time_End": 433.54,
      "Text": " of what we're talking about by emulation and this purple teaming approach, so at a high"
    },
    {
      "Time_Start": 433.54,
      "Time_End": 437.14,
      "Text": " level just to kind of give you an overview of what we're going to talk about today, we're"
    },
    {
      "Time_Start": 437.14,
      "Time_End": 441.38,
      "Text": " going to pick a specific technique based on a specific scenario, and then we're going"
    },
    {
      "Time_Start": 441.38,
      "Time_End": 446.65999999999997,
      "Text": " to walk you through an example of the purple teaming approach, so emulating that behavior,"
    },
    {
      "Time_Start": 446.65999999999997,
      "Time_End": 451.5,
      "Text": " defending against it, emulating again, defending against it, et cetera, but the big point here"
    },
    {
      "Time_Start": 451.5,
      "Time_End": 455.26,
      "Text": " is transparency, so when we talk about purple teaming, the most important thing is that"
    },
    {
      "Time_Start": 455.26,
      "Time_End": 458.65999999999997,
      "Text": " each side is talking to each other, so hopefully through our demonstration we'll show you the"
    },
    {
      "Time_Start": 458.65999999999997,
      "Time_End": 462.5,
      "Text": " importance of that and the value added by doing that."
    },
    {
      "Time_Start": 462.5,
      "Time_End": 467.46,
      "Text": " One assumption here is the technique that we're testing, we have, we're starting from"
    },
    {
      "Time_Start": 467.46000000000004,
      "Time_End": 471.98,
      "Text": " scratch, so we have no, like, something that we can apply as a defense, so we're starting"
    },
    {
      "Time_Start": 471.98,
      "Time_End": 475.82000000000005,
      "Text": " from basically nothing for defending this technique."
    },
    {
      "Time_Start": 475.82000000000005,
      "Time_End": 481.66,
      "Text": " Okay, so, you know, we're researchers, so we kind of heads in the clouds very often,"
    },
    {
      "Time_Start": 481.66,
      "Time_End": 487.3,
      "Text": " so one more thing we've got to cover before we get, like, into the demonstrations, so"
    },
    {
      "Time_Start": 487.3,
      "Time_End": 492.82000000000005,
      "Text": " it helps, before you start thinking about emulation, it helps to think about, like,"
    },
    {
      "Time_Start": 492.82000000000005,
      "Time_End": 496.98,
      "Text": " your emulation target, in this case a behavior, when we talk about a behavior, we're not talking"
    },
    {
      "Time_Start": 496.98,
      "Time_End": 501.86,
      "Text": " about things like static values, like hashes, IPs, domains, strings, things like that,"
    },
    {
      "Time_Start": 501.86,
      "Time_End": 506.18,
      "Text": " when we want to do what we call an emulation, we're emulating the action or the behavior,"
    },
    {
      "Time_Start": 506.18,
      "Time_End": 511.06,
      "Text": " what an adversary actually does, if you're familiar with the pyramid of pain, this is"
    },
    {
      "Time_Start": 511.06,
      "Time_End": 515.82,
      "Text": " like more of the high level things that are really hard to capture."
    },
    {
      "Time_Start": 515.82,
      "Time_End": 520.4200000000001,
      "Text": " So this is kind of like a nebulous concept, so a really interesting way to help you understand"
    },
    {
      "Time_Start": 520.4200000000001,
      "Time_End": 524.58,
      "Text": " what we mean by behavior is thinking about it in terms of attack, so like I said before,"
    },
    {
      "Time_Start": 524.58,
      "Time_End": 528.3000000000001,
      "Text": " we have the tactics, techniques, and procedures, when we think behavior, we're more or less"
    },
    {
      "Time_Start": 528.3000000000001,
      "Time_End": 533.5,
      "Text": " thinking the techniques and procedures, excuse the pun, but we think that's more or less"
    },
    {
      "Time_Start": 533.5,
      "Time_End": 540.0200000000001,
      "Text": " the heart of a behavior, it's the variation of the hows and the whats, and this is really"
    },
    {
      "Time_Start": 540.0200000000001,
      "Time_End": 542.14,
      "Text": " important for emulation."
    },
    {
      "Time_Start": 542.14,
      "Time_End": 546.08,
      "Text": " Another way to think about a behavior is in stages, so if you think about, like, anything"
    },
    {
      "Time_Start": 546.08,
      "Time_End": 550.82,
      "Text": " in the world, there's, like, before, during, and after, so in terms of a behavior, you"
    },
    {
      "Time_Start": 550.82,
      "Time_End": 555.38,
      "Text": " can think about this, like, apply that same model of behavior and think about the prerequisites,"
    },
    {
      "Time_Start": 555.38,
      "Time_End": 559.46,
      "Text": " so what happens before a behavior happens, the mechanics, so what happens during the"
    },
    {
      "Time_Start": 559.46,
      "Time_End": 564.86,
      "Text": " behavior and then the artifacts, so what's left behind after behavior, so mapping that"
    },
    {
      "Time_Start": 564.86,
      "Time_End": 571.5400000000001,
      "Text": " to Sysmon events, we can think about prerequisites, like, things like image or driver loads, mechanics"
    },
    {
      "Time_Start": 571.5400000000001,
      "Time_End": 577.86,
      "Text": " being things like process creates, process terminates, remote, like, memory reads, threads"
    },
    {
      "Time_Start": 577.86,
      "Time_End": 583.82,
      "Text": " being created, things like that, so actually things happening, and then the artifacts being,"
    },
    {
      "Time_Start": 583.82,
      "Time_End": 588.26,
      "Text": " like, more of the forensic side, so registry changes, file changes, as well as if you're"
    },
    {
      "Time_Start": 588.26,
      "Time_End": 593.1800000000001,
      "Text": " talking about, like, beacons or rats, network connections that are left over that are, like,"
    },
    {
      "Time_Start": 593.1800000000001,
      "Time_End": 597.98,
      "Text": " established C2 channels, so, you know, a lot of theory at this point, but at this point"
    },
    {
      "Time_Start": 597.98,
      "Time_End": 603.3000000000001,
      "Text": " we try to get our hands dirty, we decided not to trust the demo gods, so we prerecorded"
    },
    {
      "Time_Start": 603.3000000000001,
      "Time_End": 606.5,
      "Text": " all of our demos, but hopefully it's still kind of cool, so at this point I'm going to"
    },
    {
      "Time_Start": 606.5,
      "Time_End": 607.5,
      "Text": " hand over to Dan."
    },
    {
      "Time_Start": 607.5,
      "Time_End": 608.5,
      "Text": " Sweet, thanks."
    },
    {
      "Time_Start": 608.5,
      "Time_End": 613.9,
      "Text": " So now that we know what a behavior is, we're going to actually jump into emulating one."
    },
    {
      "Time_Start": 613.9,
      "Time_End": 617.62,
      "Text": " Before we do, I'm just going to touch on how to do that, there's a bunch of open source"
    },
    {
      "Time_Start": 617.62,
      "Time_End": 619.86,
      "Text": " frameworks out there to actually do that."
    },
    {
      "Time_Start": 619.86,
      "Time_End": 625.86,
      "Text": " The two I have up there are up there for a reason, one is because we open sourced it,"
    },
    {
      "Time_Start": 625.86,
      "Time_End": 630.78,
      "Text": " and the other is because they kind of represent two sides of the emulation spectrum."
    },
    {
      "Time_Start": 630.78,
      "Time_End": 635.42,
      "Text": " You have the Atomic Red Team side, which is on purposely made to be simple and easy to"
    },
    {
      "Time_Start": 635.42,
      "Time_End": 639.14,
      "Text": " execute, a lot of the stuff in Atomic Red Team are one liners that you can copy and"
    },
    {
      "Time_Start": 639.14,
      "Time_End": 643.8199999999999,
      "Text": " paste and run into your, and paste into your beacon or into a command prompt or PowerShell,"
    },
    {
      "Time_Start": 643.8199999999999,
      "Time_End": 648.4799999999999,
      "Text": " for example, and just run, and then go through that purple teaming process."
    },
    {
      "Time_Start": 648.4799999999999,
      "Time_End": 654.62,
      "Text": " On the other side you have a tool like Caldera, which is completely automated adversary emulation"
    },
    {
      "Time_Start": 654.62,
      "Time_End": 659.86,
      "Text": " that does end to end attacks."
    },
    {
      "Time_Start": 659.86,
      "Time_End": 665.98,
      "Text": " And so as part of our demo we're kind of going to devise a scenario where we're going"
    },
    {
      "Time_Start": 665.98,
      "Time_End": 670.34,
      "Text": " to demo indirect command execution, and indirect command execution basically says that we want"
    },
    {
      "Time_Start": 670.34,
      "Time_End": 676.14,
      "Text": " to have a command line style interface without invoking CMD."
    },
    {
      "Time_Start": 676.14,
      "Time_End": 679.0600000000001,
      "Text": " At that same time we also are going to avoid PowerShell."
    },
    {
      "Time_Start": 679.0600000000001,
      "Time_End": 685.86,
      "Text": " So as you can see in this example, running CMD is also blocked in this environment."
    },
    {
      "Time_Start": 685.86,
      "Time_End": 690.34,
      "Text": " So jumping to the Atomic Red Team, which is what we used for this demo for the easy"
    },
    {
      "Time_Start": 690.34,
      "Time_End": 697.0600000000001,
      "Text": " side, if you go to indirect command execution on the Atomic Red Team, they actually have"
    },
    {
      "Time_Start": 697.0600000000001,
      "Time_End": 699.78,
      "Text": " two different atomic tests that you can run."
    },
    {
      "Time_Start": 699.78,
      "Time_End": 706.0,
      "Text": " The first one is taking advantage of the program compatibility assistant, and the second one"
    },
    {
      "Time_Start": 706.0,
      "Time_End": 707.42,
      "Text": " is four files."
    },
    {
      "Time_Start": 707.42,
      "Time_End": 712.08,
      "Text": " On the first one the program compatibility assistant allows you to have that command"
    },
    {
      "Time_Start": 712.08,
      "Time_End": 716.48,
      "Text": " line style interface, you just have to specify the dash A flag."
    },
    {
      "Time_Start": 716.48,
      "Time_End": 722.0400000000001,
      "Text": " And for both demos we are going to do the default value of just popping calc.exe."
    },
    {
      "Time_Start": 722.0400000000001,
      "Time_End": 725.64,
      "Text": " On the second one, the four files, there's three different command line arguments that"
    },
    {
      "Time_Start": 725.64,
      "Time_End": 726.64,
      "Text": " we use."
    },
    {
      "Time_Start": 726.64,
      "Time_End": 729.12,
      "Text": " The first one is slash P, which is the search path."
    },
    {
      "Time_Start": 729.12,
      "Time_End": 731.72,
      "Text": " The second one is slash M, which is the search mask."
    },
    {
      "Time_Start": 731.72,
      "Time_End": 736.84,
      "Text": " So that basically says, it's a for loop, and it says our search path is system 32, and"
    },
    {
      "Time_Start": 736.84,
      "Time_End": 739.2800000000001,
      "Text": " the mask, our search mask is notepad.exe."
    },
    {
      "Time_Start": 739.28,
      "Time_End": 744.28,
      "Text": " So for every notepad.exe that you see inside of system 32, I want you to run the command"
    },
    {
      "Time_Start": 744.28,
      "Time_End": 746.8,
      "Text": " after slash C, which is calc.exe."
    },
    {
      "Time_Start": 746.8,
      "Time_End": 752.92,
      "Text": " And since there's only one notepad.exe in system 32, it's going to pop one calc."
    },
    {
      "Time_Start": 752.92,
      "Time_End": 759.4599999999999,
      "Text": " And so just for the simple demo, on the left is the PCA Lua.exe popping calc, just doing"
    },
    {
      "Time_Start": 759.4599999999999,
      "Time_End": 763.78,
      "Text": " it from the run window, so it pops through Explorer."
    },
    {
      "Time_Start": 763.78,
      "Time_End": 769.42,
      "Text": " And then on the second side, you can see four files also running through the run window,"
    },
    {
      "Time_Start": 769.42,
      "Time_End": 771.5,
      "Text": " and that also pops calc."
    },
    {
      "Time_Start": 771.5,
      "Time_End": 772.5,
      "Text": " So sweet."
    },
    {
      "Time_Start": 772.5,
      "Time_End": 773.5,
      "Text": " Simple demo."
    },
    {
      "Time_Start": 773.5,
      "Time_End": 781.1,
      "Text": " So now you see a pretty simple emulation of a technique or a behavior, two different ways."
    },
    {
      "Time_Start": 781.1,
      "Time_End": 785.9399999999999,
      "Text": " And so now we'll jump into the blue side, or the detection side."
    },
    {
      "Time_Start": 785.9399999999999,
      "Time_End": 790.26,
      "Text": " And so before we jump into those two instances of detection, I just want to jump back and"
    },
    {
      "Time_Start": 790.26,
      "Time_End": 792.5,
      "Text": " talk about how you actually come to a detection."
    },
    {
      "Time_Start": 792.5,
      "Time_End": 796.18,
      "Text": " So if you think of it from a pyramid-style layer, the bottom layer is going to be your"
    },
    {
      "Time_Start": 796.18,
      "Time_End": 797.18,
      "Text": " data sources."
    },
    {
      "Time_Start": 797.18,
      "Time_End": 800.74,
      "Text": " That's going to be the source of your information, so process monitoring, image loads, DLLs,"
    },
    {
      "Time_Start": 800.74,
      "Time_End": 802.36,
      "Text": " all those types of things."
    },
    {
      "Time_Start": 802.36,
      "Time_End": 806.98,
      "Text": " The second layer of that pyramid is going to be the sensors, so what actually is pulling"
    },
    {
      "Time_Start": 806.98,
      "Time_End": 810.3,
      "Text": " or what's actually collecting the information from those data sources."
    },
    {
      "Time_Start": 810.3,
      "Time_End": 814.38,
      "Text": " And then the third is going to be your analysis on top of that, basically to formulate the"
    },
    {
      "Time_Start": 814.38,
      "Time_End": 815.72,
      "Text": " detections."
    },
    {
      "Time_Start": 815.72,
      "Time_End": 820.98,
      "Text": " We have the cyber analytic repository, car.mitre.org, it's not listed up there, but that is one"
    },
    {
      "Time_Start": 820.98,
      "Time_End": 825.14,
      "Text": " open source example of analysis on top of those sensors."
    },
    {
      "Time_Start": 825.14,
      "Time_End": 829.7,
      "Text": " And then just as a sidestep, I'll talk about detection lab real quick."
    },
    {
      "Time_Start": 829.7,
      "Time_End": 833.3000000000001,
      "Text": " We use that for all the demos, it's an awesome purple teaming environment."
    },
    {
      "Time_Start": 833.3000000000001,
      "Time_End": 835.66,
      "Text": " Red teamers can use it, blue teamers can use it."
    },
    {
      "Time_Start": 835.66,
      "Time_End": 839.74,
      "Text": " It's at a high level, it's just basically a Windows domain that you can stand up, comes"
    },
    {
      "Time_Start": 839.74,
      "Time_End": 843.38,
      "Text": " with a Splunk server, and you can customize it however you want."
    },
    {
      "Time_Start": 843.38,
      "Time_End": 849.0,
      "Text": " So usually how I run it is I throw Sysmon on there, I open up Sysmon to look like Procmon,"
    },
    {
      "Time_Start": 849.0,
      "Time_End": 853.08,
      "Text": " I enable a bunch of the advanced audit policies, so you get a whole bunch of Windows event"
    },
    {
      "Time_Start": 853.08,
      "Time_End": 858.68,
      "Text": " logs besides the standard ones, and then you can run an emulation of a behavior like we"
    },
    {
      "Time_Start": 858.68,
      "Time_End": 862.8,
      "Text": " just did in the previous slide, and you'll see literally everything that goes on underneath"
    },
    {
      "Time_Start": 862.8,
      "Time_End": 867.4,
      "Text": " the hood of a Windows operating system."
    },
    {
      "Time_Start": 867.4,
      "Time_End": 873.76,
      "Text": " So jumping into that first test, which is the PCA Lua EXE, on the right we have just"
    },
    {
      "Time_Start": 873.76,
      "Time_End": 875.16,
      "Text": " a pretty simple process tree."
    },
    {
      "Time_Start": 875.16,
      "Time_End": 881.0,
      "Text": " So both of these tests are pretty straightforward, Explorer's going to pop the indirect command"
    },
    {
      "Time_Start": 881.0,
      "Time_End": 885.1999999999999,
      "Text": " execution binary that we use, and that's actually going to pop GAL."
    },
    {
      "Time_Start": 885.1999999999999,
      "Time_End": 893.92,
      "Text": " So going back to the data sources, if you want to detect the first test that we ran,"
    },
    {
      "Time_Start": 893.92,
      "Time_End": 901.8399999999999,
      "Text": " the first data source, or the three data sources that you need for this behavior of T1202 is"
    },
    {
      "Time_Start": 902.1600000000001,
      "Time_End": 903.48,
      "Text": " obviously process monitoring."
    },
    {
      "Time_Start": 903.48,
      "Time_End": 907.88,
      "Text": " You're going to want to monitor for process creations of the PCA Lua binary."
    },
    {
      "Time_Start": 907.88,
      "Time_End": 913.44,
      "Text": " The command line parameters, so you have to specify that flag, the dash A, to run a process,"
    },
    {
      "Time_Start": 913.44,
      "Time_End": 915.6800000000001,
      "Text": " to start a process, or to run your payload."
    },
    {
      "Time_Start": 915.6800000000001,
      "Time_End": 920.9200000000001,
      "Text": " And then a Windows event log 4688, obviously process creation will give you that."
    },
    {
      "Time_Start": 920.9200000000001,
      "Time_End": 925.52,
      "Text": " Also Sysmon event ID 1, which is process creation for Sysmon."
    },
    {
      "Time_Start": 925.52,
      "Time_End": 930.12,
      "Text": " And then jumping to four files, so same thing, pretty simple."
    },
    {
      "Time_Start": 930.12,
      "Time_End": 936.4399999999999,
      "Text": " Four files popped GAL, so you want to monitor for the four files binary or executable."
    },
    {
      "Time_Start": 936.4399999999999,
      "Time_End": 942.0,
      "Text": " And then from the command line parameter standpoint, four files, we use three in our test."
    },
    {
      "Time_Start": 942.0,
      "Time_End": 946.6,
      "Text": " So when you start doing this purple teaming and iterative cycle, you try to break the"
    },
    {
      "Time_Start": 946.6,
      "Time_End": 947.6,
      "Text": " detection."
    },
    {
      "Time_Start": 947.6,
      "Time_End": 952.8,
      "Text": " So in first, if we were looking for those three process command line parameter flags,"
    },
    {
      "Time_Start": 952.8000000000001,
      "Time_End": 956.84,
      "Text": " the red team actually can devise a way that they can realize that they actually don't"
    },
    {
      "Time_Start": 956.84,
      "Time_End": 959.32,
      "Text": " need those first two flags."
    },
    {
      "Time_Start": 959.32,
      "Time_End": 963.1200000000001,
      "Text": " So slash P, the search path, you don't need, it defaults to the current directory, and"
    },
    {
      "Time_Start": 963.1200000000001,
      "Time_End": 967.08,
      "Text": " you also don't need the slash M, the search mask, it just defaults to a wild card."
    },
    {
      "Time_Start": 967.08,
      "Time_End": 968.08,
      "Text": " So star."
    },
    {
      "Time_Start": 968.08,
      "Time_End": 972.5200000000001,
      "Text": " So if you're in a directory that has, for example, three files, it'll run your command"
    },
    {
      "Time_Start": 972.5200000000001,
      "Time_End": 974.6400000000001,
      "Text": " three times."
    },
    {
      "Time_Start": 974.6400000000001,
      "Time_End": 978.7600000000001,
      "Text": " And you can also do a slash C or dash C, it doesn't matter."
    },
    {
      "Time_Start": 978.76,
      "Time_End": 983.68,
      "Text": " And then obviously the Windows event log data source, so 4688, that event, or if you're"
    },
    {
      "Time_Start": 983.68,
      "Time_End": 986.3199999999999,
      "Text": " using Sysmon, event ID one will give you this information."
    },
    {
      "Time_Start": 986.3199999999999,
      "Time_End": 992.56,
      "Text": " So we took an opportunity to talk about the project we mentioned earlier, attack evaluation."
    },
    {
      "Time_Start": 992.56,
      "Time_End": 997.04,
      "Text": " So if you've never seen this, the same kind of like red versus blue scenario."
    },
    {
      "Time_Start": 997.04,
      "Time_End": 1001.96,
      "Text": " We basically, for attack evaluation, we ran that same scenario against EDR products."
    },
    {
      "Time_Start": 1001.96,
      "Time_End": 1006.92,
      "Text": " So we have the URLs in the bottom if you check it out, but basically we put together a 20"
    },
    {
      "Time_Start": 1006.9200000000001,
      "Time_End": 1013.0400000000001,
      "Text": " step red team script based on ABT3, had EDR vendors set up the product, we ran that emulation"
    },
    {
      "Time_Start": 1013.0400000000001,
      "Time_End": 1017.6800000000001,
      "Text": " against those products and then provided the output to those EDR products, specifically"
    },
    {
      "Time_Start": 1017.6800000000001,
      "Time_End": 1018.7600000000001,
      "Text": " focusing on detection."
    },
    {
      "Time_Start": 1018.7600000000001,
      "Time_End": 1023.48,
      "Text": " So if you see, as highlighted up there, you see on the left, you see the red slide, so"
    },
    {
      "Time_Start": 1023.48,
      "Time_End": 1026.0800000000002,
      "Text": " transparency, we're telling you exactly what we did."
    },
    {
      "Time_Start": 1026.0800000000002,
      "Time_End": 1028.76,
      "Text": " On the right we're showing you what the EDR product actually captured."
    },
    {
      "Time_Start": 1028.76,
      "Time_End": 1033.16,
      "Text": " So like in terms of every technique that we tested as well as what was captured there."
    },
    {
      "Time_Start": 1033.16,
      "Time_End": 1037.8000000000002,
      "Text": " So this is a pretty good vignette for using this operationally or outside of just testing"
    },
    {
      "Time_Start": 1037.8000000000002,
      "Time_End": 1038.8000000000002,
      "Text": " techniques."
    },
    {
      "Time_Start": 1038.8000000000002,
      "Time_End": 1045.0,
      "Text": " So going forward, like I said, Dan showed you, he said exactly what we tested and he"
    },
    {
      "Time_Start": 1045.0,
      "Time_End": 1048.72,
      "Text": " took that to the detection side and using those command line arguments was able to detect"
    },
    {
      "Time_Start": 1048.72,
      "Time_End": 1049.72,
      "Text": " everything."
    },
    {
      "Time_Start": 1049.72,
      "Time_End": 1053.8000000000002,
      "Text": " I'm actually a huge fan of using like the red versus blue sparring analogy."
    },
    {
      "Time_Start": 1053.8000000000002,
      "Time_End": 1054.8000000000002,
      "Text": " I think it's great."
    },
    {
      "Time_Start": 1054.8000000000002,
      "Time_End": 1059.6000000000001,
      "Text": " A big point here, though, is it's really important sometimes to make blue miss."
    },
    {
      "Time_Start": 1059.6,
      "Time_End": 1063.52,
      "Text": " Not just, like, for shaming or anything like that, but actually, like, it's a good opportunity"
    },
    {
      "Time_Start": 1063.52,
      "Time_End": 1064.6399999999999,
      "Text": " for leveling up."
    },
    {
      "Time_Start": 1064.6399999999999,
      "Time_End": 1069.9199999999998,
      "Text": " So showing them something that they've never seen to help them enable, like, growth and,"
    },
    {
      "Time_Start": 1069.9199999999998,
      "Time_End": 1070.9199999999998,
      "Text": " like, learning."
    },
    {
      "Time_Start": 1070.9199999999998,
      "Time_End": 1074.52,
      "Text": " So big point here, though, is you're not just showing them things they've never seen, but"
    },
    {
      "Time_Start": 1074.52,
      "Time_End": 1077.04,
      "Text": " scoping it to the realm of, like, real behavior."
    },
    {
      "Time_Start": 1077.04,
      "Time_End": 1080.36,
      "Text": " So things they've seen that real adversaries are actually doing."
    },
    {
      "Time_Start": 1080.36,
      "Time_End": 1085.32,
      "Text": " So the next step in this emulation process is to emulate that same behavior, but better."
    },
    {
      "Time_Start": 1085.32,
      "Time_End": 1089.12,
      "Text": " The first step in that process is looking at the way the previous detection worked."
    },
    {
      "Time_Start": 1089.1200000000001,
      "Time_End": 1093.64,
      "Text": " So like Dan just highlighted, everything basically on the pack blue and the four files"
    },
    {
      "Time_Start": 1093.64,
      "Time_End": 1095.64,
      "Text": " detection was process-based."
    },
    {
      "Time_Start": 1095.64,
      "Time_End": 1099.0800000000002,
      "Text": " So looking at process creations as well as process command line arguments."
    },
    {
      "Time_Start": 1099.0800000000002,
      "Time_End": 1103.4,
      "Text": " So immediately as you start diving into the next level emulation, your first prerequisite"
    },
    {
      "Time_Start": 1103.4,
      "Time_End": 1106.68,
      "Text": " is, hey, I cannot live in that process land."
    },
    {
      "Time_Start": 1106.68,
      "Time_End": 1110.6000000000001,
      "Text": " The first thing that comes to mind for me, avoiding processes, is .NET."
    },
    {
      "Time_Start": 1110.6000000000001,
      "Time_End": 1111.6000000000001,
      "Text": " For many reasons."
    },
    {
      "Time_Start": 1111.6000000000001,
      "Time_End": 1116.64,
      "Text": " Firstly, it's pretty great in terms of, like, functionality as access to the low-level like"
    },
    {
      "Time_Start": 1116.64,
      "Time_End": 1120.76,
      "Text": " Win32 API, so you can do a lot of really creative things."
    },
    {
      "Time_Start": 1120.76,
      "Time_End": 1123.76,
      "Text": " In general, a lot of the detections for .NET is immature."
    },
    {
      "Time_Start": 1123.76,
      "Time_End": 1128.16,
      "Text": " Unfortunately, it's really complex under the hood, so there's really not a lot of great,"
    },
    {
      "Time_Start": 1128.16,
      "Time_End": 1133.0,
      "Text": " like, automation and deep analysis and logic based on the mechanics that's going on in"
    },
    {
      "Time_Start": 1133.0,
      "Time_End": 1134.4,
      "Text": " there."
    },
    {
      "Time_Start": 1134.4,
      "Time_End": 1137.22,
      "Text": " As well as, I mean, .NET isn't, like, inherently malicious."
    },
    {
      "Time_Start": 1137.22,
      "Time_End": 1140.4,
      "Text": " It's installed by default on, I think, everything past Vista."
    },
    {
      "Time_Start": 1140.4,
      "Time_End": 1143.8400000000001,
      "Text": " So there's a lot of noise and opportunities for false positives."
    },
    {
      "Time_Start": 1143.84,
      "Time_End": 1147.6799999999998,
      "Text": " So from an emulator, Red Team, it's a great place to hide because there's a lot of normal"
    },
    {
      "Time_Start": 1147.6799999999998,
      "Time_End": 1150.12,
      "Text": " activity happening in that realm."
    },
    {
      "Time_Start": 1150.12,
      "Time_End": 1153.6999999999998,
      "Text": " We call that living off the land, so taking something that's already available and using"
    },
    {
      "Time_Start": 1153.6999999999998,
      "Time_End": 1155.9599999999998,
      "Text": " it for malicious purposes."
    },
    {
      "Time_Start": 1155.9599999999998,
      "Time_End": 1160.52,
      "Text": " And finally, while this is a great emulation target, if you've followed a lot of recent"
    },
    {
      "Time_Start": 1160.52,
      "Time_End": 1165.32,
      "Text": " Red Team developments or frameworks, they're actually moving towards .NET, specifically"
    },
    {
      "Time_Start": 1165.32,
      "Time_End": 1170.8799999999999,
      "Text": " C sharp to avoid PowerShell, which also lives in that process level detection realm."
    },
    {
      "Time_Start": 1170.8799999999999,
      "Time_End": 1172.84,
      "Text": " And also, like, threat actors have moved here."
    },
    {
      "Time_Start": 1172.84,
      "Time_End": 1181.1599999999999,
      "Text": " So we've seen Chinese as well as Iranian actors leveraging .NET for their malware kits."
    },
    {
      "Time_Start": 1181.1599999999999,
      "Time_End": 1185.6,
      "Text": " So looking, starting to do research on how we're going to emulate this indirect execution"
    },
    {
      "Time_Start": 1185.6,
      "Time_End": 1191.6799999999998,
      "Text": " that avoids CMD, we start taking a look, and we come across this blog post about spoofing"
    },
    {
      "Time_Start": 1191.6799999999998,
      "Time_End": 1192.84,
      "Text": " parent PIDs."
    },
    {
      "Time_Start": 1192.84,
      "Time_End": 1198.6799999999998,
      "Text": " So basically, C sharp .NET enables us to start calling API functions."
    },
    {
      "Time_Start": 1198.6799999999998,
      "Time_End": 1201.04,
      "Text": " One interesting function is create process."
    },
    {
      "Time_Start": 1201.36,
      "Time_End": 1207.56,
      "Text": " Obviously, it creates a process, but one of the parameters allows you to specify a particular"
    },
    {
      "Time_Start": 1207.56,
      "Time_End": 1208.56,
      "Text": " parent PID."
    },
    {
      "Time_Start": 1208.56,
      "Time_End": 1210.72,
      "Text": " So that's super interesting."
    },
    {
      "Time_Start": 1210.72,
      "Time_End": 1216.2,
      "Text": " So we're like, hey, that's something we could potentially use to get past that CMD requirement."
    },
    {
      "Time_Start": 1216.2,
      "Time_End": 1218.72,
      "Text": " Taking a deeper look into this, we come across a proof of concept code."
    },
    {
      "Time_Start": 1218.72,
      "Time_End": 1221.8,
      "Text": " So if you've ever seen this, it's called select my parent."
    },
    {
      "Time_Start": 1221.8,
      "Time_End": 1226.76,
      "Text": " I think this was a Python script, but basically the idea is it implements that parent PID"
    },
    {
      "Time_Start": 1226.76,
      "Time_End": 1227.76,
      "Text": " spoofing."
    },
    {
      "Time_Start": 1227.76,
      "Time_End": 1231.84,
      "Text": " So what we're able to do is if you look at the top, you give it a command, and then you"
    },
    {
      "Time_Start": 1231.84,
      "Time_End": 1238.0,
      "Text": " give it a parent PID, and it basically launches that command as a sub process of that PID."
    },
    {
      "Time_Start": 1238.0,
      "Time_End": 1243.16,
      "Text": " So if you look at the bottom, it's actually like procmon or process explorer, you're able"
    },
    {
      "Time_Start": 1243.16,
      "Time_End": 1248.3799999999999,
      "Text": " to see via this code, you're able to launch notepad from LSAS, which is really weird and"
    },
    {
      "Time_Start": 1248.3799999999999,
      "Time_End": 1252.56,
      "Text": " probably should never happen, but it's a really interesting characteristic of the way this"
    },
    {
      "Time_Start": 1252.56,
      "Time_End": 1254.28,
      "Text": " API call works."
    },
    {
      "Time_Start": 1254.28,
      "Time_End": 1259.3,
      "Text": " So taking that to our emulation, what we're able to do is we found another POC for this"
    },
    {
      "Time_Start": 1259.3,
      "Time_End": 1265.52,
      "Text": " written in C sharp, and we're able to launch that same calc payload, but from explorer."
    },
    {
      "Time_Start": 1265.52,
      "Time_End": 1269.52,
      "Text": " So for the sake of demonstration, we left the command line arguments there so you can"
    },
    {
      "Time_Start": 1269.52,
      "Time_End": 1274.8799999999999,
      "Text": " see them, but basically what's happening is we're launching calc from the parent PID of"
    },
    {
      "Time_Start": 1274.8799999999999,
      "Time_End": 1280.16,
      "Text": " explorer, and Dan will take a look at this on the detection side, but this is a really"
    },
    {
      "Time_Start": 1280.16,
      "Time_End": 1283.76,
      "Text": " cool moment when you're doing this iterative emulation because you finally found something"
    },
    {
      "Time_Start": 1283.76,
      "Time_End": 1288.4,
      "Text": " that works and you think it's really hard to detect, so you toss the ball back over"
    },
    {
      "Time_Start": 1288.4,
      "Time_End": 1293.36,
      "Text": " to the blue side, and you're like, hey, good luck with that."
    },
    {
      "Time_Start": 1293.36,
      "Time_End": 1296.6,
      "Text": " And so we'll accept the challenge of trying to detect this."
    },
    {
      "Time_Start": 1296.6,
      "Time_End": 1302.8,
      "Text": " What's really cool is C sharp and PowerShell both use the same underlying.net framework,"
    },
    {
      "Time_Start": 1302.8,
      "Time_End": 1308.32,
      "Text": " but C sharp doesn't have all the, from a defender side, C sharp doesn't have the same PowerShell"
    },
    {
      "Time_Start": 1308.32,
      "Time_End": 1313.26,
      "Text": " logging that is kind of why we want to avoid that as well."
    },
    {
      "Time_Start": 1313.26,
      "Time_End": 1319.82,
      "Text": " So basically what Jamie just explained is it's the same demo that we did before, but"
    },
    {
      "Time_Start": 1319.82,
      "Time_End": 1324.5,
      "Text": " our C sharp payload is popping calc, but we're spoofing the parent PID, so it's actually"
    },
    {
      "Time_Start": 1324.5,
      "Time_End": 1326.54,
      "Text": " spawning from explorer."
    },
    {
      "Time_Start": 1326.54,
      "Time_End": 1331.54,
      "Text": " And going back to the data sources, the two that we used in the first two demos, process"
    },
    {
      "Time_Start": 1331.54,
      "Time_End": 1337.02,
      "Text": " monitoring and process command line parameters, are not as useful in this case."
    },
    {
      "Time_Start": 1337.02,
      "Time_End": 1340.86,
      "Text": " One, you don't know what the process is going to be called, what it's going to be called"
    },
    {
      "Time_Start": 1340.86,
      "Time_End": 1342.94,
      "Text": " when it's created."
    },
    {
      "Time_Start": 1342.94,
      "Time_End": 1347.8,
      "Text": " I guess you could search for if it's an unsigned process being started or an untrusted process"
    },
    {
      "Time_Start": 1347.8,
      "Time_End": 1352.6200000000001,
      "Text": " being started, but that, from a malware standpoint, might not always be the case."
    },
    {
      "Time_Start": 1352.6200000000001,
      "Time_End": 1356.54,
      "Text": " And then as far as command line parameters, those are arbitrary."
    },
    {
      "Time_Start": 1356.54,
      "Time_End": 1359.9,
      "Text": " We could have obviously obfuscated those, we could have put them in base 64 and then"
    },
    {
      "Time_Start": 1359.9,
      "Time_End": 1361.7,
      "Text": " decoded them on the fly."
    },
    {
      "Time_Start": 1361.7,
      "Time_End": 1367.14,
      "Text": " So from a command line parameter perspective, there's not much there."
    },
    {
      "Time_Start": 1368.14,
      "Time_End": 1374.0200000000002,
      "Text": " Fortunately, you can go buy some other data sources to kind of have some insight into"
    },
    {
      "Time_Start": 1374.0200000000002,
      "Time_End": 1377.14,
      "Text": " .NET being executed."
    },
    {
      "Time_Start": 1377.14,
      "Time_End": 1381.46,
      "Text": " So actually first, I think I saw these on Twitter first, I'll have to throw the source"
    },
    {
      "Time_Start": 1381.46,
      "Time_End": 1390.8200000000002,
      "Text": " in there after, but the two sysmon event IDs, 7 and 11, so image load, so the data source"
    },
    {
      "Time_Start": 1390.8200000000002,
      "Time_End": 1393.5400000000002,
      "Text": " is tied back to loaded DLLs and DLL monitoring."
    },
    {
      "Time_Start": 1393.54,
      "Time_End": 1400.6599999999999,
      "Text": " There's actually two being loaded when you run a C sharp or .NET assembly."
    },
    {
      "Time_Start": 1400.6599999999999,
      "Time_End": 1406.42,
      "Text": " So it's the common language runtime DLL and the run just-in-time compiler DLL."
    },
    {
      "Time_Start": 1406.42,
      "Time_End": 1411.3799999999999,
      "Text": " So those two are loaded in when you run your .NET assembly, and then when you run your"
    },
    {
      "Time_Start": 1411.3799999999999,
      "Time_End": 1419.18,
      "Text": " .NET assembly, a usage log file gets dropped into the user profile app data common language"
    },
    {
      "Time_Start": 1419.18,
      "Time_End": 1421.1599999999999,
      "Text": " runtime usage log directory."
    },
    {
      "Time_Start": 1421.16,
      "Time_End": 1426.48,
      "Text": " So just interesting things that happen when you run .NET."
    },
    {
      "Time_Start": 1426.48,
      "Time_End": 1431.96,
      "Text": " So if that's not enough to convince you that .NET was running, you can also jump into ETW,"
    },
    {
      "Time_Start": 1431.96,
      "Time_End": 1436.88,
      "Text": " which is event tracing for Windows, which is essentially a kernel level function or"
    },
    {
      "Time_Start": 1436.88,
      "Time_End": 1444.68,
      "Text": " facility that enables you to log kernel and or application defined events to a log file."
    },
    {
      "Time_Start": 1444.68,
      "Time_End": 1450.76,
      "Text": " So there's three different providers that we'll kind of dive into for this purpose of"
    },
    {
      "Time_Start": 1450.76,
      "Time_End": 1452.48,
      "Text": " detecting that demo."
    },
    {
      "Time_Start": 1452.48,
      "Time_End": 1456.8,
      "Text": " The first two obviously have to have to do with detection of .NET, and the third one,"
    },
    {
      "Time_Start": 1456.8,
      "Time_End": 1463.0,
      "Text": " the kernel process, is going to be more as a bonus just to show that we can see the spoof"
    },
    {
      "Time_Start": 1463.0,
      "Time_End": 1465.08,
      "Text": " parent PID."
    },
    {
      "Time_Start": 1465.08,
      "Time_End": 1470.08,
      "Text": " And then simply to capture or view these ETW events, there's a bunch of different ways."
    },
    {
      "Time_Start": 1470.08,
      "Time_End": 1475.04,
      "Text": " There's built-in command line, log man and tracer PT, so you can run those built-in from"
    },
    {
      "Time_Start": 1475.04,
      "Time_End": 1476.96,
      "Text": " the command line."
    },
    {
      "Time_Start": 1476.96,
      "Time_End": 1478.08,
      "Text": " And there's also some open source things."
    },
    {
      "Time_Start": 1478.08,
      "Time_End": 1485.68,
      "Text": " So FireEye released PyWinTrace, which is essentially a Python wrapper around ETW."
    },
    {
      "Time_Start": 1485.68,
      "Time_End": 1491.44,
      "Text": " And so for this demo, we actually are using another open source Python script called .NET"
    },
    {
      "Time_Start": 1491.44,
      "Time_End": 1498.32,
      "Text": " Runtime ETW, which is made by Countercept, and it is a Python script that uses the .NET"
    },
    {
      "Time_Start": 1498.32,
      "Time_End": 1506.04,
      "Text": " Runtime ETW provider, but it also leverages the PyWinTrace wrapper that FireEye made."
    },
    {
      "Time_Start": 1506.12,
      "Time_End": 1514.72,
      "Text": " And so when we ran that to capture those common language runtime events and all .NET events,"
    },
    {
      "Time_Start": 1514.72,
      "Time_End": 1516.8799999999999,
      "Text": " this is kind of a blowout of what it looks like."
    },
    {
      "Time_Start": 1516.8799999999999,
      "Time_End": 1521.22,
      "Text": " So you do get a lot of data, but it is indicative of .NET running."
    },
    {
      "Time_Start": 1521.22,
      "Time_End": 1524.96,
      "Text": " So you can see the JIT events on the top."
    },
    {
      "Time_Start": 1524.96,
      "Time_End": 1530.44,
      "Text": " You can actually see, like, the ZFcon demo, like, the namespace and the class and also"
    },
    {
      "Time_Start": 1530.44,
      "Time_End": 1535.04,
      "Text": " the function, so main function and the create process function that were actually started."
    },
    {
      "Time_Start": 1535.04,
      "Time_End": 1540.32,
      "Text": " You can also see the module loads and stuff related to the .NET framework."
    },
    {
      "Time_Start": 1540.32,
      "Time_End": 1545.68,
      "Text": " As well as at the bottom, you can see the interop services as well."
    },
    {
      "Time_Start": 1545.68,
      "Time_End": 1548.96,
      "Text": " So all pretty indicative of .NET being run."
    },
    {
      "Time_Start": 1548.96,
      "Time_End": 1554.56,
      "Text": " And then as a bonus, I also said that I'd talk about how to spoof that parent pin, how"
    },
    {
      "Time_Start": 1554.56,
      "Time_End": 1555.56,
      "Text": " to detect it."
    },
    {
      "Time_Start": 1555.56,
      "Time_End": 1560.28,
      "Text": " So that third ETW provider, which was the kernel process, there's another script."
    },
    {
      "Time_Start": 1560.28,
      "Time_End": 1563.08,
      "Text": " It's essentially just a wrapper."
    },
    {
      "Time_Start": 1563.12,
      "Time_End": 1569.8,
      "Text": " It'll run this ETW provider for you and then parse it out and show you the process spawned,"
    },
    {
      "Time_Start": 1569.8,
      "Time_End": 1572.32,
      "Text": " the parent it spawned from, and then also the spoof parent."
    },
    {
      "Time_Start": 1572.32,
      "Time_End": 1580.72,
      "Text": " So if you use this ETW provider, the kernel process ETW, you can see effectively what"
    },
    {
      "Time_Start": 1580.72,
      "Time_End": 1581.72,
      "Text": " happens."
    },
    {
      "Time_Start": 1581.72,
      "Time_End": 1583.52,
      "Text": " And it's in there for a reason."
    },
    {
      "Time_Start": 1583.52,
      "Time_End": 1584.52,
      "Text": " It's for UAC."
    },
    {
      "Time_Start": 1584.52,
      "Time_End": 1591.48,
      "Text": " So if you launch something from elevator prompt and you click yes through the consent.exe,"
    },
    {
      "Time_Start": 1591.48,
      "Time_End": 1592.8799999999999,
      "Text": " this exists."
    },
    {
      "Time_Start": 1592.88,
      "Time_End": 1600.48,
      "Text": " So the parent child relationships match up, even though the elevated process is spawned"
    },
    {
      "Time_Start": 1600.48,
      "Time_End": 1602.6000000000001,
      "Text": " from an SVC host."
    },
    {
      "Time_Start": 1602.6000000000001,
      "Time_End": 1606.4,
      "Text": " So there are false positives in here, but it's still cool that you can see the spoofed"
    },
    {
      "Time_Start": 1606.4,
      "Time_End": 1607.4,
      "Text": " parent."
    },
    {
      "Time_Start": 1607.4,
      "Time_End": 1611.6000000000001,
      "Text": " And with that, you can give yourself a pat on the back."
    },
    {
      "Time_Start": 1611.6000000000001,
      "Time_End": 1612.6000000000001,
      "Text": " That was really cool."
    },
    {
      "Time_Start": 1612.6000000000001,
      "Time_End": 1615.72,
      "Text": " But in reality, scale that into an environment."
    },
    {
      "Time_Start": 1615.72,
      "Time_End": 1618.0800000000002,
      "Text": " Take that and deploy it to 50,000 hosts."
    },
    {
      "Time_Start": 1618.0800000000002,
      "Time_End": 1619.7600000000002,
      "Text": " Probably a nightmare."
    },
    {
      "Time_Start": 1619.76,
      "Time_End": 1624.08,
      "Text": " So the next step in this is, like, looking at that detection and actually detecting better"
    },
    {
      "Time_Start": 1624.08,
      "Time_End": 1625.86,
      "Text": " behaviors better."
    },
    {
      "Time_Start": 1625.86,
      "Time_End": 1629.84,
      "Text": " So a big point here is the realization that, you know, maybe not every behavior is something"
    },
    {
      "Time_Start": 1629.84,
      "Time_End": 1634.24,
      "Text": " that you should detect in realtime for various reasons, such as, like, you know, things like"
    },
    {
      "Time_Start": 1634.24,
      "Time_End": 1639.16,
      "Text": " cost or noise, like Dan was saying, false positives for that type of detection would"
    },
    {
      "Time_Start": 1639.16,
      "Time_End": 1640.16,
      "Text": " be, like, horrific."
    },
    {
      "Time_Start": 1640.16,
      "Time_End": 1642.8,
      "Text": " You'd probably lose a lot of SOC analysts just quitting."
    },
    {
      "Time_Start": 1642.8,
      "Time_End": 1646.68,
      "Text": " The dashboard would light up immediately with all these, like, very benign things happening"
    },
    {
      "Time_Start": 1646.68,
      "Time_End": 1653.16,
      "Text": " in the system, because everything we're dealing with here is built into the system and natural."
    },
    {
      "Time_Start": 1653.16,
      "Time_End": 1658.0800000000002,
      "Text": " There also so, you know, if you're not detecting things in realtime, this may be an opportunity"
    },
    {
      "Time_Start": 1658.0800000000002,
      "Time_End": 1662.6200000000001,
      "Text": " for you to leverage other business processes, so things like hunt or IR."
    },
    {
      "Time_Start": 1662.6200000000001,
      "Time_End": 1665.8400000000001,
      "Text": " So if you're not going to detect it in realtime, maybe that's something your hunt team or IR"
    },
    {
      "Time_Start": 1665.8400000000001,
      "Time_End": 1671.44,
      "Text": " team will take responsibility for and say, you know, they'll pick up where, like, the"
    },
    {
      "Time_Start": 1671.44,
      "Time_End": 1672.44,
      "Text": " detections are missing."
    },
    {
      "Time_Start": 1672.44,
      "Time_End": 1675.26,
      "Text": " Another opportunity here would be something like protections."
    },
    {
      "Time_Start": 1675.26,
      "Time_End": 1680.66,
      "Text": " So an example of that would be if you looked at the most recent release of .NET, they implemented"
    },
    {
      "Time_Start": 1680.66,
      "Time_End": 1686.54,
      "Text": " AMSI within the .NET runtime, so basically what that means is Windows Defender and AV"
    },
    {
      "Time_Start": 1686.54,
      "Time_End": 1691.42,
      "Text": " products that are looking for signature-based malware and other heuristic behaviors are"
    },
    {
      "Time_Start": 1691.42,
      "Time_End": 1695.7,
      "Text": " actually communicating with the .NET runtime and can give it, like, tips and hints on,"
    },
    {
      "Time_Start": 1695.7,
      "Time_End": 1700.58,
      "Text": " you know, what's bad, what's good, and kind of, like, maybe prevent things that are super"
    },
    {
      "Time_Start": 1700.58,
      "Time_End": 1703.46,
      "Text": " malicious or super obvious."
    },
    {
      "Time_Start": 1703.46,
      "Time_End": 1708.5,
      "Text": " So getting back to what we talked about before, the stages of behavior, and mapping this,"
    },
    {
      "Time_Start": 1708.5,
      "Time_End": 1712.3400000000001,
      "Text": " like, better detection to this will actually kind of help us scope, like, what's a realistic"
    },
    {
      "Time_Start": 1712.3400000000001,
      "Time_End": 1714.26,
      "Text": " way to handle this?"
    },
    {
      "Time_Start": 1714.26,
      "Time_End": 1721.22,
      "Text": " So mapping everything Dan just covered in the last section to these stages, so the prerequisites,"
    },
    {
      "Time_Start": 1721.22,
      "Time_End": 1725.18,
      "Text": " the first thing you would see, like Dan said, those DLLs associated with .NET being loaded,"
    },
    {
      "Time_Start": 1725.18,
      "Time_End": 1729.58,
      "Text": " so those would be prereqs, and the mechanics, you would see things like the process of being"
    },
    {
      "Time_Start": 1729.58,
      "Time_End": 1736.22,
      "Text": " created as well as the events from the ETW, and then the artifacts being, you know, those"
    },
    {
      "Time_Start": 1736.22,
      "Time_End": 1741.74,
      "Text": " log files written by the just-in-time compiler as well as that log file in the user profile,"
    },
    {
      "Time_Start": 1741.74,
      "Time_End": 1746.6599999999999,
      "Text": " so individually, all of these might be not great candidates for something to alert on,"
    },
    {
      "Time_Start": 1746.6599999999999,
      "Time_End": 1751.62,
      "Text": " but if you map it out like this, you can kind of see potential, like, I'm calling it a notional"
    },
    {
      "Time_Start": 1751.62,
      "Time_End": 1755.86,
      "Text": " defensive approach, but a way you can actually build this into your defenses, so maybe a"
    },
    {
      "Time_Start": 1755.8600000000001,
      "Time_End": 1760.0600000000002,
      "Text": " first step is, you know, rather than firing on every time one of these individual things"
    },
    {
      "Time_Start": 1760.0600000000002,
      "Time_End": 1765.5800000000002,
      "Text": " happen, maybe you set an alert for any time a process that is specifically unsigned is"
    },
    {
      "Time_Start": 1765.5800000000002,
      "Time_End": 1771.2600000000002,
      "Text": " loading .NET DLLs, so maybe that might be outside of the scope of what real organic"
    },
    {
      "Time_Start": 1771.2600000000002,
      "Time_End": 1775.5400000000002,
      "Text": " .NET execution looks like, because obviously everything in the system is probably Microsoft"
    },
    {
      "Time_Start": 1775.5400000000002,
      "Time_End": 1776.5400000000002,
      "Text": " signed."
    },
    {
      "Time_Start": 1776.5400000000002,
      "Time_End": 1780.66,
      "Text": " A second step to that would be every time you fire an alert seeing an unsigned process"
    },
    {
      "Time_Start": 1780.66,
      "Time_End": 1785.8200000000002,
      "Text": " loading .NET DLLs, you have an analyst follow up and take a look at those very grainy log"
    },
    {
      "Time_Start": 1785.82,
      "Time_End": 1790.3799999999999,
      "Text": " files which would be a nightmare to parse and scale, but maybe an analyst has time to"
    },
    {
      "Time_Start": 1790.3799999999999,
      "Time_End": 1795.98,
      "Text": " go look at those and actually do like an in-depth analysis, and for your hunters in the room,"
    },
    {
      "Time_Start": 1795.98,
      "Time_End": 1800.7,
      "Text": " proactively look for this stuff, so inform your hunt team on all of this behaviour, understand"
    },
    {
      "Time_Start": 1800.7,
      "Time_End": 1804.4199999999998,
      "Text": " all these mechanics, and as they go around in the course of their normal behaviour and"
    },
    {
      "Time_Start": 1804.4199999999998,
      "Time_End": 1808.4199999999998,
      "Text": " look for things, they can look for these type of artefacts and do that kind of analysis"
    },
    {
      "Time_Start": 1808.4199999999998,
      "Time_End": 1812.86,
      "Text": " before any of these behaviours actually happen."
    },
    {
      "Time_Start": 1812.8600000000001,
      "Time_End": 1817.7,
      "Text": " So kind of in conclusion, wrapping up what we talked about today, getting back to that"
    },
    {
      "Time_Start": 1817.7,
      "Time_End": 1822.7400000000002,
      "Text": " attack matrix, basically what we did was it's kind of nuanced and small, but that one technique"
    },
    {
      "Time_Start": 1822.7400000000002,
      "Time_End": 1826.7,
      "Text": " that we're focused on, based on what we did, we're pretty sure we can take it from what"
    },
    {
      "Time_Start": 1826.7,
      "Time_End": 1831.5000000000002,
      "Text": " we call low confidence to medium, so we're not 100 per cent sure we can detect that,"
    },
    {
      "Time_Start": 1831.5000000000002,
      "Time_End": 1835.9,
      "Text": " but based on this iterative process, we feel pretty comfortable that we understand the"
    },
    {
      "Time_Start": 1835.9,
      "Time_End": 1840.66,
      "Text": " behaviour and how to detect it or defend against it, whether it is hunt, IR, protections in"
    },
    {
      "Time_Start": 1840.66,
      "Time_End": 1841.66,
      "Text": " our environment."
    },
    {
      "Time_Start": 1841.98,
      "Time_End": 1844.5400000000002,
      "Text": " So the next step would be rinse and repeat."
    },
    {
      "Time_Start": 1844.5400000000002,
      "Time_End": 1851.02,
      "Text": " So scale this same process and activity out to all of the techniques that you care about."
    },
    {
      "Time_Start": 1851.02,
      "Time_End": 1854.94,
      "Text": " Another way of doing this is getting back to Cody and Chris from last year, chain them"
    },
    {
      "Time_Start": 1854.94,
      "Time_End": 1856.42,
      "Text": " together into a full campaign."
    },
    {
      "Time_Start": 1856.42,
      "Time_End": 1861.02,
      "Text": " So rather than doing each individual one, you can actually write an emulation plan that"
    },
    {
      "Time_Start": 1861.02,
      "Time_End": 1866.8600000000001,
      "Text": " ties these together into a cohesive flow that goes over a couple of days or a week, and"
    },
    {
      "Time_Start": 1866.8600000000001,
      "Time_End": 1873.7,
      "Text": " then run all of this detection against the entire campaign based on those specific techniques."
    },
    {
      "Time_Start": 1873.7,
      "Time_End": 1874.7,
      "Text": " So this is our last slide."
    },
    {
      "Time_Start": 1874.7,
      "Time_End": 1875.7,
      "Text": " We'll leave this up."
    },
    {
      "Time_Start": 1875.7,
      "Time_End": 1877.42,
      "Text": " There's some good resources here."
    },
    {
      "Time_Start": 1877.42,
      "Time_End": 1882.66,
      "Text": " The top one is a link to ATT&CK, so everything else you could link from there, but specific"
    },
    {
      "Time_Start": 1882.66,
      "Time_End": 1887.5400000000002,
      "Text": " things we want to call out is our Medium blog, so we have blog posts there for ATT&CK and"
    },
    {
      "Time_Start": 1887.5400000000002,
      "Time_End": 1892.5000000000002,
      "Text": " ATT&CK evaluations, as well as various use cases such as blue teaming, hunting, SOC work,"
    },
    {
      "Time_Start": 1892.5000000000002,
      "Time_End": 1893.5000000000002,
      "Text": " automation, et cetera."
    },
    {
      "Time_Start": 1893.74,
      "Time_End": 1898.5,
      "Text": " And the bottom two are our contact information, so our email and our Twitter."
    },
    {
      "Time_Start": 1898.5,
      "Time_End": 1902.26,
      "Text": " If you want to reach out about contributions or you have questions, or definitely tweet"
    },
    {
      "Time_Start": 1902.26,
      "Time_End": 1903.26,
      "Text": " us with memes."
    },
    {
      "Time_Start": 1903.26,
      "Time_End": 1904.26,
      "Text": " We love memes."
    },
    {
      "Time_Start": 1904.26,
      "Time_End": 1907.22,
      "Text": " If you didn't notice by our slide deck, we're like eat, sleep, meme, just constantly trying"
    },
    {
      "Time_Start": 1907.22,
      "Time_End": 1908.66,
      "Text": " to make each other laugh."
    },
    {
      "Time_Start": 1908.66,
      "Time_End": 1911.54,
      "Text": " I think we have a couple minutes for questions."
    },
    {
      "Time_Start": 1911.54,
      "Time_End": 1913.86,
      "Text": " Otherwise, thank you for your time and your attention."
    },
    {
      "Time_Start": 1913.86,
      "Time_End": 1914.86,
      "Text": " Thank you."
    }
  ]
}