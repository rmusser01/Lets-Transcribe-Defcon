{
  "segments": [
    {
      "Time_Start": 0.0,
      "Time_End": 9.68,
      "Text": "This text was transcribed using whisper model: large-v2\n\n So, hello, everybody."
    },
    {
      "Time_Start": 9.68,
      "Time_End": 17.240000000000002,
      "Text": " I'm going to talk this afternoon about secure or insecure remote operations and essentially"
    },
    {
      "Time_Start": 17.240000000000002,
      "Time_End": 24.88,
      "Text": " covering the topic that every admin tool is essentially an attack tool, and the only difference"
    },
    {
      "Time_Start": 24.88,
      "Time_End": 31.2,
      "Text": " between remote managements for IT or a legitimate user is context."
    },
    {
      "Time_Start": 31.2,
      "Time_End": 34.239999999999995,
      "Text": " So that's something we all understand."
    },
    {
      "Time_Start": 34.239999999999995,
      "Time_End": 39.879999999999995,
      "Text": " But we're going to discuss this topic in a way and show some really good things for retimers"
    },
    {
      "Time_Start": 39.879999999999995,
      "Time_End": 42.96,
      "Text": " as well as the detections."
    },
    {
      "Time_Start": 42.96,
      "Time_End": 46.739999999999995,
      "Text": " So I'm going to play red and blue all around the topic."
    },
    {
      "Time_Start": 46.739999999999995,
      "Time_End": 52.879999999999995,
      "Text": " So I'm going to have a lot of things to show hopefully for both audiences."
    },
    {
      "Time_Start": 52.88,
      "Time_End": 55.6,
      "Text": " Before we start, how many retimers do we have in the room?"
    },
    {
      "Time_Start": 55.6,
      "Time_End": 56.6,
      "Text": " Yeah."
    },
    {
      "Time_Start": 56.6,
      "Time_End": 57.6,
      "Text": " Feel free."
    },
    {
      "Time_Start": 57.6,
      "Time_End": 58.6,
      "Text": " Okay."
    },
    {
      "Time_Start": 58.6,
      "Time_End": 59.72,
      "Text": " Not that many."
    },
    {
      "Time_Start": 59.72,
      "Time_End": 60.92,
      "Text": " But you're going to be pleased."
    },
    {
      "Time_Start": 60.92,
      "Time_End": 63.92,
      "Text": " How many blue timers do we have in the room?"
    },
    {
      "Time_Start": 63.92,
      "Time_End": 64.92,
      "Text": " Okay."
    },
    {
      "Time_Start": 64.92,
      "Time_End": 66.88,
      "Text": " A bit more."
    },
    {
      "Time_Start": 66.88,
      "Time_End": 71.5,
      "Text": " But we're going to level it up in a way."
    },
    {
      "Time_Start": 71.5,
      "Time_End": 73.72,
      "Text": " So a bit about myself."
    },
    {
      "Time_Start": 73.72,
      "Time_End": 75.2,
      "Text": " I'm based in Israel."
    },
    {
      "Time_Start": 75.2,
      "Time_End": 79.52000000000001,
      "Text": " I'm a security researcher as well as a hacker from the 80s."
    },
    {
      "Time_Start": 79.52000000000001,
      "Time_End": 82.36,
      "Text": " I've been around with computers for a while."
    },
    {
      "Time_Start": 82.84,
      "Time_End": 85.32,
      "Text": " I have a red mind, but a blue heart."
    },
    {
      "Time_Start": 85.32,
      "Time_End": 91.2,
      "Text": " So essentially as a retimed trainer in different organizations around the globe, at the end"
    },
    {
      "Time_Start": 91.2,
      "Time_End": 95.08,
      "Text": " of the day, all I do is just help the blue team get better."
    },
    {
      "Time_Start": 95.08,
      "Time_End": 99.28,
      "Text": " Co-founder in a company called Tenroot, a niche boutique cybersecurity company working"
    },
    {
      "Time_Start": 99.28,
      "Time_End": 107.16,
      "Text": " with Fortune 100, big companies, banks all around the world, as I said."
    },
    {
      "Time_Start": 107.8,
      "Time_End": 112.03999999999999,
      "Text": " Also known for some of my work on Hacktive Directory."
    },
    {
      "Time_Start": 112.03999999999999,
      "Time_End": 115.64,
      "Text": " Hacktive Directory is how I call Active Directory."
    },
    {
      "Time_Start": 115.64,
      "Time_End": 123.24,
      "Text": " Including being part of Javelin Networks, ex-Israeli intelligence corps that we sold"
    },
    {
      "Time_Start": 123.24,
      "Time_End": 126.56,
      "Text": " to Symantec in 2018."
    },
    {
      "Time_Start": 126.56,
      "Time_End": 130.04,
      "Text": " I had the chance to work for Microsoft in the 90s and early 2000s."
    },
    {
      "Time_Start": 130.04,
      "Time_End": 136.35999999999999,
      "Text": " I was actually the only guy I knew in my surrounding in Microsoft back then that had the Linux"
    },
    {
      "Time_Start": 137.32000000000002,
      "Time_End": 145.8,
      "Text": " with the Lilo bootloader on my laptop, and I was very afraid that people will find out."
    },
    {
      "Time_Start": 145.8,
      "Time_End": 148.8,
      "Text": " And I also do in my spare time other activities."
    },
    {
      "Time_Start": 148.8,
      "Time_End": 155.24,
      "Text": " I love to volunteer for youth at risk, as well as play the guitar with my progressive"
    },
    {
      "Time_Start": 155.24,
      "Time_End": 158.0,
      "Text": " rock band and fly planes."
    },
    {
      "Time_Start": 158.0,
      "Time_End": 162.52,
      "Text": " Everything is a bit more calm up there in the sky."
    },
    {
      "Time_Start": 162.52,
      "Time_End": 168.12,
      "Text": " I want to start off by saying that Chet GPT was not used at all in making this code and"
    },
    {
      "Time_Start": 168.12,
      "Time_End": 170.64000000000001,
      "Text": " tools and presentation."
    },
    {
      "Time_Start": 170.64000000000001,
      "Time_End": 177.24,
      "Text": " Not because I didn't want to, because it's just wrong, at least for the things I want"
    },
    {
      "Time_Start": 177.24,
      "Time_End": 178.24,
      "Text": " to do."
    },
    {
      "Time_Start": 178.24,
      "Time_End": 180.68,
      "Text": " It wasn't helpful at all."
    },
    {
      "Time_Start": 180.68,
      "Time_End": 185.28,
      "Text": " On the contrary, everything was incorrect, everything I asked it to do."
    },
    {
      "Time_Start": 185.28,
      "Time_End": 190.8,
      "Text": " It's probably improving, and with the time we all learn what generative AI can be good"
    },
    {
      "Time_Start": 190.88000000000002,
      "Time_End": 194.32000000000002,
      "Text": " for us and what still has room for improvement."
    },
    {
      "Time_Start": 194.32000000000002,
      "Time_End": 200.42000000000002,
      "Text": " But even when you give it feedback, it's still protecting its inner deterministic truth."
    },
    {
      "Time_Start": 200.42000000000002,
      "Time_End": 202.72,
      "Text": " It's protecting the bugs."
    },
    {
      "Time_Start": 202.72,
      "Time_End": 204.08,
      "Text": " And these are logical bugs."
    },
    {
      "Time_Start": 204.08,
      "Time_End": 207.76000000000002,
      "Text": " Keep in mind that they don't generate errors, it's just that the code is wrong."
    },
    {
      "Time_Start": 207.76000000000002,
      "Time_End": 210.44,
      "Text": " So just keep that in mind."
    },
    {
      "Time_Start": 210.44,
      "Time_End": 211.44,
      "Text": " So what we'll talk about."
    },
    {
      "Time_Start": 211.44,
      "Time_End": 215.96,
      "Text": " First of all, we'll kick off with talking about the remoting mindset."
    },
    {
      "Time_Start": 215.96,
      "Time_End": 221.88,
      "Text": " A way to think about, and we'll give quite a few living off the land examples."
    },
    {
      "Time_Start": 221.88,
      "Time_End": 226.88,
      "Text": " Then we're going to dive a bit more specifically into WinRM, Windows Remote Management and"
    },
    {
      "Time_Start": 226.88,
      "Time_End": 232.4,
      "Text": " Partial Remoting for, like I said, both Red Team and Blue Team operations and defenses"
    },
    {
      "Time_Start": 232.4,
      "Time_End": 235.96,
      "Text": " and evasions, bypass of those defenses."
    },
    {
      "Time_Start": 235.96,
      "Time_End": 243.64000000000001,
      "Text": " Then we'll dive into how credentials are exposed in the destination during remote operations."
    },
    {
      "Time_Start": 243.64000000000001,
      "Time_End": 248.08,
      "Text": " And we'll show why you shouldn't trust Microsoft documentation."
    },
    {
      "Time_Start": 248.08,
      "Time_End": 255.0,
      "Text": " I'll show you some quick research that's still trying to figure out why it works this way."
    },
    {
      "Time_Start": 255.0,
      "Time_End": 261.40000000000003,
      "Text": " And I get a TGT with zero secrets in the machine."
    },
    {
      "Time_Start": 261.40000000000003,
      "Time_End": 268.32,
      "Text": " And we're going to also show you how to prevent lateral movement without paying money to any"
    },
    {
      "Time_Start": 268.32,
      "Time_End": 269.32,
      "Text": " company."
    },
    {
      "Time_Start": 269.32,
      "Time_End": 273.62,
      "Text": " Obviously, GUI is nice, but we're going to drop the G and just stay with UI."
    },
    {
      "Time_Start": 273.62,
      "Time_End": 277.42,
      "Text": " So most of the examples will be CLI-based."
    },
    {
      "Time_Start": 277.42,
      "Time_End": 281.38,
      "Text": " So living off the land is a really important concept, whether you're a Blue Teamer or Red"
    },
    {
      "Time_Start": 281.38,
      "Time_End": 282.38,
      "Text": " Teamer."
    },
    {
      "Time_Start": 282.38,
      "Time_End": 284.82,
      "Text": " You have to respect that."
    },
    {
      "Time_Start": 284.82,
      "Time_End": 290.58,
      "Text": " That you don't have to introduce malicious code necessarily if you obviously can blend"
    },
    {
      "Time_Start": 290.58,
      "Time_End": 292.58,
      "Text": " in into the environment."
    },
    {
      "Time_Start": 292.58,
      "Time_End": 295.74,
      "Text": " There are lots of ways to do that."
    },
    {
      "Time_Start": 295.74,
      "Time_End": 302.98,
      "Text": " And like I said, you should look at every management task and ask yourself, it's a remote"
    },
    {
      "Time_Start": 303.02000000000004,
      "Time_End": 306.34000000000003,
      "Text": " management or lateral movement by an adversary."
    },
    {
      "Time_Start": 306.34000000000003,
      "Time_End": 311.78000000000003,
      "Text": " So there are multiple lobbies in the operating system that can actually generate remote connections"
    },
    {
      "Time_Start": 311.78000000000003,
      "Time_End": 316.1,
      "Text": " to machines that are built in, baked in the operating system."
    },
    {
      "Time_Start": 316.1,
      "Time_End": 321.54,
      "Text": " Obviously, RPC, the Microsoft proprietary version of RPC, has been around for a couple"
    },
    {
      "Time_Start": 321.54,
      "Time_End": 326.18,
      "Text": " of decades with WI and distributed com."
    },
    {
      "Time_Start": 326.18,
      "Time_End": 329.5,
      "Text": " Then there is this API heaven around it."
    },
    {
      "Time_Start": 329.5,
      "Time_End": 334.86,
      "Text": " All the inter-process communication methods that we'll talk briefly about."
    },
    {
      "Time_Start": 334.86,
      "Time_End": 339.34,
      "Text": " I'll touch a bit on some nice attacks, if you don't know, and how to prevent them on"
    },
    {
      "Time_Start": 339.34,
      "Time_End": 343.06,
      "Text": " RDP, brute force, man-in-the-middle, things like that."
    },
    {
      "Time_Start": 343.06,
      "Time_End": 348.34,
      "Text": " And like I said, the topic we'll dive a bit more deeply is, for better and for worse,"
    },
    {
      "Time_Start": 348.34,
      "Time_End": 353.02,
      "Text": " for Blue Teams as well as Red Teams, why to use partial remoting and how we can bypass"
    },
    {
      "Time_Start": 353.02,
      "Time_End": 354.72,
      "Text": " that as well."
    },
    {
      "Time_Start": 354.72,
      "Time_End": 358.02,
      "Text": " So RPC, obviously, is a system service that needs no introduction."
    },
    {
      "Time_Start": 358.02,
      "Time_End": 361.74,
      "Text": " All of you know it and work on it."
    },
    {
      "Time_Start": 361.74,
      "Time_End": 367.65999999999997,
      "Text": " And it's essentially, if you look at the definition, and it's important to look at definitions"
    },
    {
      "Time_Start": 367.65999999999997,
      "Time_End": 375.14,
      "Text": " sometimes to understand better, it's data exchange and invocation of functionality located"
    },
    {
      "Time_Start": 375.14,
      "Time_End": 377.38,
      "Text": " in a different process."
    },
    {
      "Time_Start": 377.38,
      "Time_End": 378.94,
      "Text": " Why mindset is important?"
    },
    {
      "Time_Start": 378.94,
      "Time_End": 385.14,
      "Text": " Because we are not running process remotely on a different machine."
    },
    {
      "Time_Start": 385.14,
      "Time_End": 391.53999999999996,
      "Text": " We are triggering and exchanging data, which should tell you that there is data exfiltration"
    },
    {
      "Time_Start": 391.53999999999996,
      "Time_End": 399.5,
      "Text": " potential here, and invocation, running code on any process that is different than ours."
    },
    {
      "Time_Start": 399.5,
      "Time_End": 401.58,
      "Text": " It could be on our same machine."
    },
    {
      "Time_Start": 401.58,
      "Time_End": 403.58,
      "Text": " It can be on the same LAN."
    },
    {
      "Time_Start": 403.58,
      "Time_End": 405.94,
      "Text": " It could be also in a remote location."
    },
    {
      "Time_Start": 405.94,
      "Time_End": 412.84,
      "Text": " And obviously, the RPC service serves as not only the endpoint mapper to map the sessions"
    },
    {
      "Time_Start": 412.84000000000003,
      "Time_End": 418.68,
      "Text": " and allocate higher ports, but also as the com service control manager."
    },
    {
      "Time_Start": 418.68,
      "Time_End": 420.84000000000003,
      "Text": " And many services depend on RPC."
    },
    {
      "Time_Start": 420.84000000000003,
      "Time_End": 426.52000000000004,
      "Text": " For example, I don't know if you ever enumerated the RPC subsystem process service."
    },
    {
      "Time_Start": 426.52000000000004,
      "Time_End": 434.04,
      "Text": " But if you increase the buffer and run enum depend, so you will see this is an average"
    },
    {
      "Time_Start": 434.04,
      "Time_End": 435.56000000000006,
      "Text": " Windows 10 machine."
    },
    {
      "Time_Start": 435.56000000000006,
      "Time_End": 441.16,
      "Text": " So this is roughly 200-something services, almost all your services."
    },
    {
      "Time_Start": 441.20000000000005,
      "Time_End": 443.28000000000003,
      "Text": " And this way or the other depend on RPC."
    },
    {
      "Time_Start": 443.28000000000003,
      "Time_End": 447.40000000000003,
      "Text": " And RPC subsystem is all over the place, right?"
    },
    {
      "Time_Start": 447.40000000000003,
      "Time_End": 453.36,
      "Text": " And it also uses a few ports, namely, of course, 135 and all the ephemeral ports, the dynamic"
    },
    {
      "Time_Start": 453.36,
      "Time_End": 455.8,
      "Text": " port range."
    },
    {
      "Time_Start": 455.8,
      "Time_End": 461.40000000000003,
      "Text": " But if we speak about ports, you think about, for example, an average domain controller"
    },
    {
      "Time_Start": 461.40000000000003,
      "Time_End": 467.72,
      "Text": " on your on-prem infrastructure, many, many ports, as you can see, that are there to exploit."
    },
    {
      "Time_Start": 467.72,
      "Time_End": 474.02000000000004,
      "Text": " Many different protocols, different ways to play with pre-authentication."
    },
    {
      "Time_Start": 474.02000000000004,
      "Time_End": 480.96000000000004,
      "Text": " There is web services here, and RPC, and LDAP, and so much more to play around."
    },
    {
      "Time_Start": 480.96000000000004,
      "Time_End": 486.72,
      "Text": " So the first thing is a nice trick for you to check what ports or protocols does any"
    },
    {
      "Time_Start": 486.72,
      "Time_End": 487.72,
      "Text": " tool use."
    },
    {
      "Time_Start": 487.72,
      "Time_End": 497.04,
      "Text": " For example, if you want to know what PS exec uses, or whatever tool you have, Q-User, QWinSTA."
    },
    {
      "Time_Start": 497.04,
      "Time_End": 501.88,
      "Text": " So obviously, you could look at that with a pickup, with Wireshark or whatever."
    },
    {
      "Time_Start": 501.88,
      "Time_End": 506.8,
      "Text": " But this can be also a very nice and a quick and dirty way."
    },
    {
      "Time_Start": 506.8,
      "Time_End": 509.24,
      "Text": " We're just creating a netstat loop."
    },
    {
      "Time_Start": 509.24,
      "Time_End": 515.84,
      "Text": " Sometimes when I'm in the field and I don't want to install or begin to do some cumbersome"
    },
    {
      "Time_Start": 515.84,
      "Time_End": 520.2,
      "Text": " tasks, I just create this very quick netstat loop."
    },
    {
      "Time_Start": 520.2,
      "Time_End": 522.6800000000001,
      "Text": " All the code in this session is up on my GitHub page."
    },
    {
      "Time_Start": 522.6800000000001,
      "Time_End": 525.52,
      "Text": " So you'll get it later."
    },
    {
      "Time_Start": 525.52,
      "Time_End": 533.24,
      "Text": " But it is a very simple netstat loop that just keeps querying for any changes in a specific"
    },
    {
      "Time_Start": 533.24,
      "Time_End": 537.92,
      "Text": " remote management potential ports and protocols."
    },
    {
      "Time_Start": 537.92,
      "Time_End": 541.64,
      "Text": " Looking at RPC, WinRM, MSTSC, et cetera."
    },
    {
      "Time_Start": 541.64,
      "Time_End": 546.48,
      "Text": " So you can see, for example, the minute I opened the MSTSC, the Microsoft Terminal Service"
    },
    {
      "Time_Start": 546.48,
      "Time_End": 553.88,
      "Text": " Client, immediately there was established connection to port 3389."
    },
    {
      "Time_Start": 553.88,
      "Time_End": 563.84,
      "Text": " If I'm running WMI query, in this window, you see that there is a PowerShell firing"
    },
    {
      "Time_Start": 563.84,
      "Time_End": 570.16,
      "Text": " up in port 135 on process ID 824, right?"
    },
    {
      "Time_Start": 570.16,
      "Time_End": 573.52,
      "Text": " In my local PID."
    },
    {
      "Time_Start": 573.52,
      "Time_End": 580.64,
      "Text": " Of course, keep in mind that also, while the task was access denied, because there is authorization"
    },
    {
      "Time_Start": 580.64,
      "Time_End": 584.52,
      "Text": " failed, but authentication didn't."
    },
    {
      "Time_Start": 584.52,
      "Time_End": 591.6,
      "Text": " And of course, it's not weird that 825 is my RPC endpoint mapper on the subsystem."
    },
    {
      "Time_Start": 591.6,
      "Time_End": 597.28,
      "Text": " But if I run WinRM, in this example, I'm running PowerShell remoting."
    },
    {
      "Time_Start": 597.28,
      "Time_End": 604.02,
      "Text": " You can see access was denied, but there is no port shown, because it's that fast."
    },
    {
      "Time_Start": 604.02,
      "Time_End": 609.64,
      "Text": " So the timeout for the sessions that we're used to seeing other legacy protocols, RPC,"
    },
    {
      "Time_Start": 609.64,
      "Time_End": 613.12,
      "Text": " et cetera, will not be evident in WinRM."
    },
    {
      "Time_Start": 613.12,
      "Time_End": 615.56,
      "Text": " So that's a point to keep in mind."
    },
    {
      "Time_Start": 615.56,
      "Time_End": 619.64,
      "Text": " That's because the service is fairly new and also drops the connection immediately if it's"
    },
    {
      "Time_Start": 619.64,
      "Time_End": 623.08,
      "Text": " not authenticated."
    },
    {
      "Time_Start": 623.08,
      "Time_End": 630.3199999999999,
      "Text": " If we will run now the same command for PowerShell remoting with WinRM, with a user that does"
    },
    {
      "Time_Start": 630.3199999999999,
      "Time_End": 636.64,
      "Text": " actually have permissions that will not get access denied, and we run basically the same"
    },
    {
      "Time_Start": 636.64,
      "Time_End": 645.56,
      "Text": " thing, just fire up InvoCommand, ICM is the alias for InvoCommand, on this remote computer,"
    },
    {
      "Time_Start": 645.56,
      "Time_End": 649.84,
      "Text": " and just ask to run ipconfig on that remote machine."
    },
    {
      "Time_Start": 649.84,
      "Time_End": 655.52,
      "Text": " Now when you look at the loop above, you will see for a brief instant, you will see port"
    },
    {
      "Time_Start": 655.52,
      "Time_End": 658.88,
      "Text": " 5985 was fired up."
    },
    {
      "Time_Start": 658.88,
      "Time_End": 663.96,
      "Text": " Immediately it goes to time wait, and immediately it disconnects."
    },
    {
      "Time_Start": 663.96,
      "Time_End": 671.0400000000001,
      "Text": " So speaking about RPC, I'm sure you know about these errors, RPC not available, which"
    },
    {
      "Time_Start": 671.0400000000001,
      "Time_End": 675.88,
      "Text": " is sometimes you might think that the computer is not available."
    },
    {
      "Time_Start": 675.88,
      "Time_End": 676.88,
      "Text": " It's not on the network."
    },
    {
      "Time_Start": 676.88,
      "Time_End": 680.8000000000001,
      "Text": " It's maybe disconnected or shut down."
    },
    {
      "Time_Start": 680.8000000000001,
      "Time_End": 686.76,
      "Text": " But many times this can be caused by Kerberos clock skew, the time difference between the"
    },
    {
      "Time_Start": 686.76,
      "Time_End": 688.86,
      "Text": " client and the domain controllers."
    },
    {
      "Time_Start": 688.86,
      "Time_End": 695.5,
      "Text": " So just a quick tip about how you can fix this clock skew remotely."
    },
    {
      "Time_Start": 695.5,
      "Time_End": 703.62,
      "Text": " You can do that either with WMI, with NTLM, using the IP address obviously, because you"
    },
    {
      "Time_Start": 703.62,
      "Time_End": 708.78,
      "Text": " want to trigger a negotiated NTLM authentication package and not Kerberos, because Kerberos"
    },
    {
      "Time_Start": 708.78,
      "Time_End": 709.78,
      "Text": " is broken."
    },
    {
      "Time_Start": 709.78,
      "Time_End": 715.82,
      "Text": " Or you can actually do that also with WinRM, and just make sure that the Windows time service"
    },
    {
      "Time_Start": 715.82,
      "Time_End": 720.86,
      "Text": " initiates remote sync, re-sync with the domain controller."
    },
    {
      "Time_Start": 720.86,
      "Time_End": 728.1,
      "Text": " So you might see errors like that, extended error, or RPC not available."
    },
    {
      "Time_Start": 728.1,
      "Time_End": 731.0600000000001,
      "Text": " This might be the errors that you might encounter."
    },
    {
      "Time_Start": 731.0600000000001,
      "Time_End": 735.1800000000001,
      "Text": " And if you try to run RPC not available, right?"
    },
    {
      "Time_Start": 735.1800000000001,
      "Time_End": 743.5400000000001,
      "Text": " So if you run this WMI query, you would think maybe this computer is offline or is not connected."
    },
    {
      "Time_Start": 743.54,
      "Time_End": 750.9399999999999,
      "Text": " But if you would run it with a more mature remote management option, like WinRM, like"
    },
    {
      "Time_Start": 750.9399999999999,
      "Time_End": 755.14,
      "Text": " partial remoting, you will see that there is a time difference between the client and"
    },
    {
      "Time_Start": 755.14,
      "Time_End": 756.14,
      "Text": " the server."
    },
    {
      "Time_Start": 756.14,
      "Time_End": 759.9399999999999,
      "Text": " OK, so actually this error message makes more sense, right?"
    },
    {
      "Time_Start": 759.9399999999999,
      "Time_End": 761.86,
      "Text": " So with that, I know how to solve it."
    },
    {
      "Time_Start": 761.86,
      "Time_End": 764.66,
      "Text": " Like I said, there are multiple ways to solve that."
    },
    {
      "Time_Start": 764.66,
      "Time_End": 770.88,
      "Text": " One of them is just to use PowerShell's ability to cast local variables to remote sessions."
    },
    {
      "Time_Start": 770.88,
      "Time_End": 775.48,
      "Text": " So I'm just going to put the date of my local machine in a variable."
    },
    {
      "Time_Start": 775.48,
      "Time_End": 781.32,
      "Text": " And I'm just going to cast it over with NTLM to the computer's IP."
    },
    {
      "Time_Start": 781.32,
      "Time_End": 791.4399999999999,
      "Text": " And just use the $using option to essentially set the date of that remote machine."
    },
    {
      "Time_Start": 791.4399999999999,
      "Time_End": 793.36,
      "Text": " And that's exactly what it will do."
    },
    {
      "Time_Start": 793.36,
      "Time_End": 797.88,
      "Text": " So I'm just going to invoke this command and set the date."
    },
    {
      "Time_Start": 797.88,
      "Time_End": 804.84,
      "Text": " And once we do that, so at least after that, I can solve this configuration problem, whatever."
    },
    {
      "Time_Start": 804.84,
      "Time_End": 811.36,
      "Text": " But now I can actually access this machine successfully."
    },
    {
      "Time_Start": 811.36,
      "Time_End": 815.88,
      "Text": " Speaking about IPC, which is a part of how RPC works, in-process communication."
    },
    {
      "Time_Start": 815.88,
      "Time_End": 822.2,
      "Text": " So in IPC, what's important to remember is that we can exchange past strings, objects,"
    },
    {
      "Time_Start": 822.2,
      "Time_End": 826.5,
      "Text": " whatever we want between processes, whether local or remote."
    },
    {
      "Time_Start": 826.5,
      "Time_End": 830.3,
      "Text": " And this can be one-way, two-way, encrypted, not encrypted."
    },
    {
      "Time_Start": 830.3,
      "Time_End": 833.94,
      "Text": " All these beautiful options you can control."
    },
    {
      "Time_Start": 833.94,
      "Time_End": 837.14,
      "Text": " Especially when you think about named pipes communication."
    },
    {
      "Time_Start": 837.14,
      "Time_End": 840.5,
      "Text": " That can be really, really interesting."
    },
    {
      "Time_Start": 840.5,
      "Time_End": 847.42,
      "Text": " Because we can actually use named pipe, essentially IPC, for a command and control channel."
    },
    {
      "Time_Start": 847.42,
      "Time_End": 853.94,
      "Text": " Especially in the LAN, when you want to do an engagement to change data or exfiltrate"
    },
    {
      "Time_Start": 853.94,
      "Time_End": 856.9000000000001,
      "Text": " data without socket bind."
    },
    {
      "Time_Start": 856.9000000000001,
      "Time_End": 859.5,
      "Text": " So keep in mind that you don't need to open any firewall port."
    },
    {
      "Time_Start": 859.5,
      "Time_End": 864.3800000000001,
      "Text": " And even without local admin privileges, because we don't need to bind to a socket, we just"
    },
    {
      "Time_Start": 864.3800000000001,
      "Time_End": 870.0200000000001,
      "Text": " write 445, we can get the inter-process communication to work for us."
    },
    {
      "Time_Start": 870.0200000000001,
      "Time_End": 876.5600000000001,
      "Text": " So I just want to show you a one-liner PowerShell named pipe that you can actually communicate"
    },
    {
      "Time_Start": 876.5600000000001,
      "Time_End": 879.2600000000001,
      "Text": " between processes, both locally and remotely."
    },
    {
      "Time_Start": 879.2600000000001,
      "Time_End": 880.94,
      "Text": " So this is the one-liner."
    },
    {
      "Time_Start": 880.94,
      "Time_End": 881.94,
      "Text": " It's very simple."
    },
    {
      "Time_Start": 881.94,
      "Time_End": 886.7800000000001,
      "Text": " I create an object, a new pipeline, a named pipe client stream."
    },
    {
      "Time_Start": 886.7800000000001,
      "Time_End": 888.9000000000001,
      "Text": " Give the pipe a name, mypipe."
    },
    {
      "Time_Start": 888.9000000000001,
      "Time_End": 897.58,
      "Text": " And while I have information coming from the stream reader, I just execute the data that"
    },
    {
      "Time_Start": 897.58,
      "Time_End": 899.4200000000001,
      "Text": " is coming."
    },
    {
      "Time_Start": 899.4200000000001,
      "Time_End": 901.86,
      "Text": " So here I have another process on the same machine."
    },
    {
      "Time_Start": 901.86,
      "Time_End": 906.1400000000001,
      "Text": " I'm just going to connect with a named pipe server stream."
    },
    {
      "Time_Start": 906.1400000000001,
      "Time_End": 911.1800000000001,
      "Text": " And just to use the stream writer to write to that pipe."
    },
    {
      "Time_Start": 911.4200000000001,
      "Time_End": 916.82,
      "Text": " As you can see, everything I'm running here, I just write it to the pipe and it gets read"
    },
    {
      "Time_Start": 916.82,
      "Time_End": 921.46,
      "Text": " by the stream reader in the other process and gets executed."
    },
    {
      "Time_Start": 921.46,
      "Time_End": 922.86,
      "Text": " And why I'm showing you this?"
    },
    {
      "Time_Start": 922.86,
      "Time_End": 925.5000000000001,
      "Text": " Because this is living off the land."
    },
    {
      "Time_Start": 925.5000000000001,
      "Time_End": 926.5000000000001,
      "Text": " Very simple."
    },
    {
      "Time_Start": 926.5000000000001,
      "Time_End": 930.3800000000001,
      "Text": " EDRs won't stop it or won't try to do anything about that."
    },
    {
      "Time_Start": 930.3800000000001,
      "Time_End": 935.0600000000001,
      "Text": " Because in your average Windows machines, same as RPC, you have hundreds of named pipes"
    },
    {
      "Time_Start": 935.0600000000001,
      "Time_End": 937.3000000000001,
      "Text": " and nobody wants to..."
    },
    {
      "Time_Start": 937.3000000000001,
      "Time_End": 942.4200000000001,
      "Text": " If there's something that EDR doesn't want to do, it's to kill something that might be"
    },
    {
      "Time_Start": 942.4200000000001,
      "Time_End": 943.5000000000001,
      "Text": " legitimate."
    },
    {
      "Time_Start": 943.5000000000001,
      "Time_End": 949.1,
      "Text": " That may be Excel needs or office needs or whatever."
    },
    {
      "Time_Start": 949.1,
      "Time_End": 952.58,
      "Text": " I can also, of course, use this in the same way."
    },
    {
      "Time_Start": 952.58,
      "Time_End": 955.46,
      "Text": " Just the same one-liner for remote operations."
    },
    {
      "Time_Start": 955.46,
      "Time_End": 961.5000000000001,
      "Text": " I just change the client stream to point at an IP address."
    },
    {
      "Time_Start": 961.5,
      "Time_End": 970.34,
      "Text": " And essentially I have an interactive reverse shell or whatever that is hard to probably"
    },
    {
      "Time_Start": 970.34,
      "Time_End": 971.34,
      "Text": " detect."
    },
    {
      "Time_Start": 971.34,
      "Time_End": 976.98,
      "Text": " Even if you want to, it will be very hard to understand who is malicious and who is"
    },
    {
      "Time_Start": 976.98,
      "Time_End": 978.42,
      "Text": " not."
    },
    {
      "Time_Start": 978.42,
      "Time_End": 983.54,
      "Text": " And as you can see, everything I run here is executed."
    },
    {
      "Time_Start": 983.54,
      "Time_End": 985.14,
      "Text": " So let's talk about detection."
    },
    {
      "Time_Start": 985.14,
      "Time_End": 986.14,
      "Text": " Blue teamers."
    },
    {
      "Time_Start": 986.14,
      "Time_End": 987.14,
      "Text": " Yay."
    },
    {
      "Time_Start": 987.14,
      "Time_End": 988.42,
      "Text": " So no ETW baked in."
    },
    {
      "Time_Start": 988.42,
      "Time_End": 991.34,
      "Text": " There's no really ETW provider."
    },
    {
      "Time_Start": 992.02,
      "Time_End": 997.94,
      "Text": " You will need to create and install a file system mini filter driver."
    },
    {
      "Time_Start": 997.94,
      "Time_End": 1001.58,
      "Text": " And actually one was created, at least one."
    },
    {
      "Time_Start": 1001.58,
      "Time_End": 1002.94,
      "Text": " Probably GitHub has a few more."
    },
    {
      "Time_Start": 1002.94,
      "Time_End": 1007.22,
      "Text": " But you could actually probably use this project, the NPETW."
    },
    {
      "Time_Start": 1007.22,
      "Time_End": 1011.14,
      "Text": " There are other ways that you can observe named pipe events."
    },
    {
      "Time_Start": 1011.14,
      "Time_End": 1017.34,
      "Text": " For example, you can turn on, if you really want to, kernel object handles monitoring."
    },
    {
      "Time_Start": 1017.5,
      "Time_End": 1021.82,
      "Text": " This will give you information about all handles that are open and closed."
    },
    {
      "Time_Start": 1021.82,
      "Time_End": 1022.82,
      "Text": " This is very noisy."
    },
    {
      "Time_Start": 1022.82,
      "Time_End": 1026.06,
      "Text": " So you'll get a lot of event ID, 4, 5, 4, 6."
    },
    {
      "Time_Start": 1026.06,
      "Time_End": 1028.6200000000001,
      "Text": " If you want, you could obviously enable that."
    },
    {
      "Time_Start": 1028.6200000000001,
      "Time_End": 1030.3400000000001,
      "Text": " You can also use Sysmon."
    },
    {
      "Time_Start": 1030.3400000000001,
      "Time_End": 1032.66,
      "Text": " But then again, very noisy."
    },
    {
      "Time_Start": 1032.66,
      "Time_End": 1038.46,
      "Text": " You will still have to filter the pipe event on match on the XML."
    },
    {
      "Time_Start": 1038.46,
      "Time_End": 1041.26,
      "Text": " Then you will have to filter that afterwards."
    },
    {
      "Time_Start": 1041.26,
      "Time_End": 1048.14,
      "Text": " My personal favorite so-called detection is to try to really monitor and filter by"
    },
    {
      "Time_Start": 1048.14,
      "Time_End": 1056.06,
      "Text": " SMB open files with a prefix of backslash that you really know that somebody opened"
    },
    {
      "Time_Start": 1056.06,
      "Time_End": 1057.26,
      "Text": " that and it's not a file."
    },
    {
      "Time_Start": 1057.26,
      "Time_End": 1059.74,
      "Text": " You don't see a PDF or an Excel or whatever."
    },
    {
      "Time_Start": 1059.74,
      "Time_End": 1063.58,
      "Text": " You will see actually a pipe that looks like something programmatic."
    },
    {
      "Time_Start": 1063.58,
      "Time_End": 1066.54,
      "Text": " So you go ahead and try those detections."
    },
    {
      "Time_Start": 1066.54,
      "Time_End": 1069.82,
      "Text": " Let's speak about Windows admin favorite feature."
    },
    {
      "Time_Start": 1069.82,
      "Time_End": 1070.82,
      "Text": " Woohoo."
    },
    {
      "Time_Start": 1070.98,
      "Time_End": 1074.1799999999998,
      "Text": " Who doesn't love Ransomware Deployment Protocol?"
    },
    {
      "Time_Start": 1074.1799999999998,
      "Time_End": 1076.82,
      "Text": " Really great feature."
    },
    {
      "Time_Start": 1076.82,
      "Time_End": 1083.3,
      "Text": " I can't believe, you know, in late 90s in Microsoft, in NT5, to the days it became Windows"
    },
    {
      "Time_Start": 1083.3,
      "Time_End": 1089.22,
      "Text": " 2000, I can't believe we never imagined that it will be used in the way that it's used"
    },
    {
      "Time_Start": 1089.22,
      "Time_End": 1090.22,
      "Text": " today."
    },
    {
      "Time_Start": 1090.22,
      "Time_End": 1098.98,
      "Text": " There are many RDP attacks and potential vectors, adversary tools, obviously brute force, the"
    },
    {
      "Time_Start": 1099.14,
      "Time_End": 1101.8600000000001,
      "Text": " ways to circumvent that is all the classics."
    },
    {
      "Time_Start": 1101.8600000000001,
      "Time_End": 1107.7,
      "Text": " Change the default username, especially if it's pointing outwards, God forbid."
    },
    {
      "Time_Start": 1107.7,
      "Time_End": 1115.3,
      "Text": " If you have RDP server on an external interface to the internet, you can change the default"
    },
    {
      "Time_Start": 1115.3,
      "Time_End": 1116.3,
      "Text": " port."
    },
    {
      "Time_Start": 1116.3,
      "Time_End": 1124.66,
      "Text": " That makes a lot of hard times to adversaries that will look for port in Shodan, et cetera,"
    },
    {
      "Time_Start": 1125.38,
      "Time_End": 1129.7,
      "Text": " and not the default port that you might be changing in the registry, configure NLA, network"
    },
    {
      "Time_Start": 1129.7,
      "Time_End": 1131.94,
      "Text": " level authentication, et cetera."
    },
    {
      "Time_Start": 1131.94,
      "Time_End": 1139.78,
      "Text": " Another vector is TS shadowing, which is essentially a combination of bad practice of IT admins."
    },
    {
      "Time_Start": 1139.78,
      "Time_End": 1146.74,
      "Text": " I see it all the time in pen testing, admins leaving sessions that are disconnected and"
    },
    {
      "Time_Start": 1146.74,
      "Time_End": 1147.74,
      "Text": " the session is there."
    },
    {
      "Time_Start": 1147.74,
      "Time_End": 1154.18,
      "Text": " So if you pop up, if you spawn a system shell and just use TS con, you can reconnect to"
    },
    {
      "Time_Start": 1154.18,
      "Time_End": 1157.8600000000001,
      "Text": " that session without knowing the credential."
    },
    {
      "Time_Start": 1157.8600000000001,
      "Time_End": 1164.8200000000002,
      "Text": " This bypasses password length, MFA, everything, because you're reconnecting to a previously"
    },
    {
      "Time_Start": 1164.8200000000002,
      "Time_End": 1166.94,
      "Text": " authenticated session."
    },
    {
      "Time_Start": 1166.94,
      "Time_End": 1167.94,
      "Text": " That's really bad."
    },
    {
      "Time_Start": 1167.94,
      "Time_End": 1169.74,
      "Text": " So that's a bad practice."
    },
    {
      "Time_Start": 1169.74,
      "Time_End": 1174.1200000000001,
      "Text": " And there are a lot of men in the middle tools that you can use."
    },
    {
      "Time_Start": 1174.1200000000001,
      "Time_End": 1179.8200000000002,
      "Text": " So in RDP men in the middle, you can really be sure that you will get at minimum the net"
    },
    {
      "Time_Start": 1179.82,
      "Time_End": 1187.82,
      "Text": " NTLM, essentially the NTLM hash baked into in its hashed format with the net NTLM in"
    },
    {
      "Time_Start": 1187.82,
      "Time_End": 1188.98,
      "Text": " the network."
    },
    {
      "Time_Start": 1188.98,
      "Time_End": 1198.54,
      "Text": " You can also get clear text password in the network and without the other party noticing"
    },
    {
      "Time_Start": 1198.54,
      "Time_End": 1201.6599999999999,
      "Text": " that this attack even happened."
    },
    {
      "Time_Start": 1201.6599999999999,
      "Time_End": 1205.3,
      "Text": " But you will need to turn off NLA, network level authentication, which was the default"
    },
    {
      "Time_Start": 1205.3,
      "Time_End": 1207.3,
      "Text": " in server 2003, et cetera."
    },
    {
      "Time_Start": 1207.3,
      "Time_End": 1209.98,
      "Text": " But you can actually do it even today."
    },
    {
      "Time_Start": 1209.98,
      "Time_End": 1215.46,
      "Text": " It downgrades the session, it fakes the certificate, and it actually attempts cred SSP in order"
    },
    {
      "Time_Start": 1215.46,
      "Time_End": 1218.26,
      "Text": " to get that clear text password."
    },
    {
      "Time_Start": 1218.26,
      "Time_End": 1222.86,
      "Text": " And what's the beauty about this is that the victim is totally unaware."
    },
    {
      "Time_Start": 1222.86,
      "Time_End": 1230.1,
      "Text": " So I'm going to pop up in my box here one of those men in the middle tools."
    },
    {
      "Time_Start": 1230.1,
      "Time_End": 1231.34,
      "Text": " There are a few implementations."
    },
    {
      "Time_Start": 1231.34,
      "Time_End": 1235.3,
      "Text": " You see the victim on the right is connecting to an RDP session."
    },
    {
      "Time_Start": 1235.3,
      "Time_End": 1241.86,
      "Text": " You immediately see that the listener, the man in the middle, has already kicked in."
    },
    {
      "Time_Start": 1241.86,
      "Time_End": 1250.82,
      "Text": " And what you will see on the right, as you can see, the behavior is totally normal."
    },
    {
      "Time_Start": 1250.82,
      "Time_End": 1256.02,
      "Text": " So the victim doesn't know even except that the connection takes a bit longer than normally"
    },
    {
      "Time_Start": 1256.02,
      "Time_End": 1259.78,
      "Text": " you would expect, maybe 10 seconds, a bit longer."
    },
    {
      "Time_Start": 1259.78,
      "Time_End": 1263.58,
      "Text": " But on the left, you can see we got the net NTLM just now."
    },
    {
      "Time_Start": 1263.58,
      "Time_End": 1271.4199999999998,
      "Text": " So I got the net NTLM successfully downgrading the session, tempered with the NTLM response."
    },
    {
      "Time_Start": 1271.4199999999998,
      "Time_End": 1273.58,
      "Text": " And now that's the beauty."
    },
    {
      "Time_Start": 1273.58,
      "Time_End": 1280.58,
      "Text": " We show the victim, of course, the self-signed certificate."
    },
    {
      "Time_Start": 1280.58,
      "Time_End": 1286.02,
      "Text": " Because RDP, of course, by default in your network, you will always, maybe not always,"
    },
    {
      "Time_Start": 1286.02,
      "Time_End": 1291.86,
      "Text": " but most common is that you will use the default self-signed certificate."
    },
    {
      "Time_Start": 1291.8600000000001,
      "Time_End": 1294.7400000000002,
      "Text": " Once we connect with that, this was a fake certificate, right?"
    },
    {
      "Time_Start": 1294.7400000000002,
      "Time_End": 1296.9,
      "Text": " It's not the real one."
    },
    {
      "Time_Start": 1296.9,
      "Time_End": 1300.5000000000002,
      "Text": " And as you can see, the victim connected to the session."
    },
    {
      "Time_Start": 1300.5000000000002,
      "Time_End": 1301.5000000000002,
      "Text": " Everything is fine."
    },
    {
      "Time_Start": 1301.5000000000002,
      "Time_End": 1307.98,
      "Text": " He's not aware that everything he's typing, including the clear text password, was forwarded"
    },
    {
      "Time_Start": 1307.98,
      "Time_End": 1309.38,
      "Text": " to us."
    },
    {
      "Time_Start": 1309.38,
      "Time_End": 1311.5400000000002,
      "Text": " So this is classic man in the middle."
    },
    {
      "Time_Start": 1311.5400000000002,
      "Time_End": 1314.94,
      "Text": " How can we get the clear text password from any RDP server?"
    },
    {
      "Time_Start": 1314.94,
      "Time_End": 1321.3400000000001,
      "Text": " Well, I would say the best thing is probably to just simply flip the registry key or just"
    },
    {
      "Time_Start": 1321.34,
      "Time_End": 1327.5,
      "Text": " use this built-in function of setting the user authentication required to zero to disable"
    },
    {
      "Time_Start": 1327.5,
      "Time_End": 1330.02,
      "Text": " NLA remotely."
    },
    {
      "Time_Start": 1330.02,
      "Time_End": 1335.26,
      "Text": " This is much more silent and quicker than, you know, procdump or Mimikatz or whatever."
    },
    {
      "Time_Start": 1335.26,
      "Time_End": 1338.1799999999998,
      "Text": " And we'll get the clear text directly."
    },
    {
      "Time_Start": 1338.1799999999998,
      "Time_End": 1344.4199999999998,
      "Text": " You can actually use all kinds of spoofing tools, common tools, Invay Responder, et cetera,"
    },
    {
      "Time_Start": 1344.4199999999998,
      "Time_End": 1347.1399999999999,
      "Text": " to just relay this registry command."
    },
    {
      "Time_Start": 1347.14,
      "Time_End": 1354.9,
      "Text": " So if you're in the blue team, you might want to just monitor for this change in NLA."
    },
    {
      "Time_Start": 1354.9,
      "Time_End": 1360.42,
      "Text": " Some mitigations, detections, obviously, you can and should enable NLA."
    },
    {
      "Time_Start": 1360.42,
      "Time_End": 1366.46,
      "Text": " You can do that remotely, centrally managed with the group policy, require authentication"
    },
    {
      "Time_Start": 1366.46,
      "Time_End": 1368.7,
      "Text": " using NLA."
    },
    {
      "Time_Start": 1368.7,
      "Time_End": 1373.5,
      "Text": " This will block, if you have NLA, it will block the RDP connection from non-authenticated"
    },
    {
      "Time_Start": 1373.58,
      "Time_End": 1376.58,
      "Text": " hosts, meaning a laptop of a pentester."
    },
    {
      "Time_Start": 1376.58,
      "Time_End": 1382.06,
      "Text": " But it will not prevent the NTLM plus clear text."
    },
    {
      "Time_Start": 1382.06,
      "Time_End": 1384.38,
      "Text": " It will just block the RDP and alert."
    },
    {
      "Time_Start": 1384.38,
      "Time_End": 1391.62,
      "Text": " I will still get your clear text and the net NTLM, just that the RDP session will be blocked"
    },
    {
      "Time_Start": 1391.62,
      "Time_End": 1397.2,
      "Text": " and you get in the event viewer that this attempt was created."
    },
    {
      "Time_Start": 1397.2,
      "Time_End": 1398.88,
      "Text": " So how can we do it better?"
    },
    {
      "Time_Start": 1398.88,
      "Time_End": 1404.24,
      "Text": " So really, the only nice mitigation is to just configure server authentication for client"
    },
    {
      "Time_Start": 1404.24,
      "Time_End": 1406.48,
      "Text": " in simple ways."
    },
    {
      "Time_Start": 1406.48,
      "Time_End": 1413.0,
      "Text": " We need to configure certificates, what you probably don't do today to any RDP connection."
    },
    {
      "Time_Start": 1413.0,
      "Time_End": 1418.0,
      "Text": " But you should, because this will disallow the connection if a certificate cannot be"
    },
    {
      "Time_Start": 1418.0,
      "Time_End": 1419.0,
      "Text": " validated."
    },
    {
      "Time_Start": 1419.0,
      "Time_End": 1424.3600000000001,
      "Text": " This requires, of course, enterprise CA, et cetera, and to generate those server authentication"
    },
    {
      "Time_Start": 1424.3600000000001,
      "Time_End": 1426.1200000000001,
      "Text": " certificates."
    },
    {
      "Time_Start": 1426.1200000000001,
      "Time_End": 1431.44,
      "Text": " Keep in mind that even this will not prevent the attacker from getting the net NTLM, which"
    },
    {
      "Time_Start": 1431.44,
      "Time_End": 1435.2800000000002,
      "Text": " it can then take an offline crack with the hashcat, et cetera."
    },
    {
      "Time_Start": 1435.2800000000002,
      "Time_End": 1438.88,
      "Text": " But it will prevent the clear text and block the connection."
    },
    {
      "Time_Start": 1438.88,
      "Time_End": 1439.88,
      "Text": " So that's not bad."
    },
    {
      "Time_Start": 1439.88,
      "Time_End": 1442.8400000000001,
      "Text": " And of course, you have the classics, MFA, et cetera."
    },
    {
      "Time_Start": 1442.8400000000001,
      "Time_End": 1448.8400000000001,
      "Text": " So this begs the question, this very short, basic examples, to admin or not to admin?"
    },
    {
      "Time_Start": 1448.8400000000001,
      "Time_End": 1450.44,
      "Text": " Of course, what can we use?"
    },
    {
      "Time_Start": 1450.44,
      "Time_End": 1451.44,
      "Text": " RDP is not good."
    },
    {
      "Time_Start": 1451.44,
      "Time_End": 1452.44,
      "Text": " RPC is not good."
    },
    {
      "Time_Start": 1452.44,
      "Time_End": 1453.44,
      "Text": " NaPype, everywhere."
    },
    {
      "Time_Start": 1453.44,
      "Time_End": 1457.28,
      "Text": " So I think we're missing here on something."
    },
    {
      "Time_Start": 1457.28,
      "Time_End": 1463.28,
      "Text": " Because you can perform all these remote management tasks, you know, access SMB file shares, run"
    },
    {
      "Time_Start": 1463.28,
      "Time_End": 1467.56,
      "Text": " local processes, do remote event log service management, et cetera."
    },
    {
      "Time_Start": 1467.56,
      "Time_End": 1473.4,
      "Text": " But we can do all this with PS remoting, partial remoting, utilizing WinRM, Windows Remote"
    },
    {
      "Time_Start": 1473.4,
      "Time_End": 1478.3200000000002,
      "Text": " Management, which is a service that has been around since Vista, Windows Vista, if you"
    },
    {
      "Time_Start": 1478.32,
      "Time_End": 1481.6399999999999,
      "Text": " remember, in 2006."
    },
    {
      "Time_Start": 1481.6399999999999,
      "Time_End": 1487.6399999999999,
      "Text": " Partial remoting always encrypts everything with your TGS, with your session key."
    },
    {
      "Time_Start": 1487.6399999999999,
      "Time_End": 1491.6399999999999,
      "Text": " Single port does all of this and much, much, much more."
    },
    {
      "Time_Start": 1491.6399999999999,
      "Time_End": 1497.2,
      "Text": " So in partial remoting, we're actually working through a web services management protocol,"
    },
    {
      "Time_Start": 1497.2,
      "Time_End": 1498.2,
      "Text": " right?"
    },
    {
      "Time_Start": 1498.2,
      "Time_End": 1504.72,
      "Text": " We have the WinRM service listening on port 5985, or with SSL in workgroups, et cetera,"
    },
    {
      "Time_Start": 1504.72,
      "Time_End": 1505.72,
      "Text": " 5986."
    },
    {
      "Time_Start": 1505.72,
      "Time_End": 1511.6000000000001,
      "Text": " It's enabled by default on all Windows servers from 2012 onwards."
    },
    {
      "Time_Start": 1511.6000000000001,
      "Time_End": 1514.92,
      "Text": " You have to enable it on all other operating system versions."
    },
    {
      "Time_Start": 1514.92,
      "Time_End": 1518.2,
      "Text": " All clients as well, Windows 10, et cetera."
    },
    {
      "Time_Start": 1518.2,
      "Time_End": 1519.48,
      "Text": " It's not enabled by default."
    },
    {
      "Time_Start": 1519.48,
      "Time_End": 1524.32,
      "Text": " It also has a nice additional feature called PowerShell Web Access."
    },
    {
      "Time_Start": 1524.32,
      "Time_End": 1531.6000000000001,
      "Text": " PowerShell Web Access essentially helps you to connect from any browser that supports"
    },
    {
      "Time_Start": 1531.6000000000001,
      "Time_End": 1536.92,
      "Text": " cookies and JavaScripts, essentially any browser from Safari, Mozilla, whatever, Linux,"
    },
    {
      "Time_Start": 1536.92,
      "Time_End": 1538.2400000000002,
      "Text": " Mac, et cetera."
    },
    {
      "Time_Start": 1538.2400000000002,
      "Time_End": 1543.2800000000002,
      "Text": " You get a shell inside of the browser, and you don't even need the client binaries to"
    },
    {
      "Time_Start": 1543.2800000000002,
      "Time_End": 1545.68,
      "Text": " run PowerShell commands."
    },
    {
      "Time_Start": 1545.68,
      "Time_End": 1551.6000000000001,
      "Text": " PowerShell is quite useful, especially when you combine it with the power of jobs."
    },
    {
      "Time_Start": 1551.6000000000001,
      "Time_End": 1559.5200000000002,
      "Text": " Jobs are essentially run spaces in the background that run PowerShell code, leaving you the"
    },
    {
      "Time_Start": 1559.52,
      "Time_End": 1563.56,
      "Text": " session open to just query the status of those jobs."
    },
    {
      "Time_Start": 1563.56,
      "Time_End": 1570.6399999999999,
      "Text": " For example, I'm taking now all the active computers in my lab here."
    },
    {
      "Time_Start": 1570.6399999999999,
      "Time_End": 1575.76,
      "Text": " And I just want to, first of all, I'll just clean the jobs that I currently have."
    },
    {
      "Time_Start": 1575.76,
      "Time_End": 1579.52,
      "Text": " We have four machines here, I can see, that I got from Active Directory."
    },
    {
      "Time_Start": 1579.52,
      "Time_End": 1583.8799999999999,
      "Text": " And I'm just going to invoke command, run the remote PowerShell."
    },
    {
      "Time_Start": 1583.8799999999999,
      "Time_End": 1588.0,
      "Text": " All I want to do is just get IP config slash all from all those machines."
    },
    {
      "Time_Start": 1588.0,
      "Time_End": 1592.36,
      "Text": " And PowerShell remoting, of course, runs the commands locally on the remote machine."
    },
    {
      "Time_Start": 1592.36,
      "Time_End": 1596.88,
      "Text": " I just added the parameter minus as job."
    },
    {
      "Time_Start": 1596.88,
      "Time_End": 1602.04,
      "Text": " And what this created is essentially now when I want to look at the child jobs, I see that"
    },
    {
      "Time_Start": 1602.04,
      "Time_End": 1606.28,
      "Text": " the remote job was run on all those machines locally."
    },
    {
      "Time_Start": 1606.28,
      "Time_End": 1613.2,
      "Text": " I can see the status, the state of each machine, if it's completed, failed, still running."
    },
    {
      "Time_Start": 1613.2,
      "Time_End": 1616.0,
      "Text": " And I can receive the job output."
    },
    {
      "Time_Start": 1616.0,
      "Time_End": 1620.72,
      "Text": " So as you can see, now, of course, I can just also pipe it to a file."
    },
    {
      "Time_Start": 1620.72,
      "Time_End": 1625.12,
      "Text": " That's really nice, because in a matter of seconds, I go to the IP config slash all of"
    },
    {
      "Time_Start": 1625.12,
      "Time_End": 1627.56,
      "Text": " all those machines without going anywhere."
    },
    {
      "Time_Start": 1627.56,
      "Time_End": 1631.16,
      "Text": " You can also copy to, from remote sessions."
    },
    {
      "Time_Start": 1631.16,
      "Time_End": 1636.88,
      "Text": " There is a to session, from session, between VMs, between PowerShell sessions."
    },
    {
      "Time_Start": 1636.88,
      "Time_End": 1643.88,
      "Text": " You can also cast local variables and local functions to remote sessions."
    },
    {
      "Time_Start": 1643.88,
      "Time_End": 1648.64,
      "Text": " For example, in this case, I don't have SMB open."
    },
    {
      "Time_Start": 1648.64,
      "Time_End": 1655.8000000000002,
      "Text": " I just closed port 445 to that remote machine, LonDC1."
    },
    {
      "Time_Start": 1655.8000000000002,
      "Time_End": 1660.96,
      "Text": " And I don't have access to the SMB shares, right?"
    },
    {
      "Time_Start": 1660.96,
      "Time_End": 1666.18,
      "Text": " You can see here also, just to make sure, with a quick timeout, that I don't have access"
    },
    {
      "Time_Start": 1666.18,
      "Time_End": 1669.5200000000002,
      "Text": " to port 445 to see if it's SMB."
    },
    {
      "Time_Start": 1669.52,
      "Time_End": 1674.2,
      "Text": " But still, I can create, I have PowerShell remoting open, port 5985."
    },
    {
      "Time_Start": 1674.2,
      "Time_End": 1679.84,
      "Text": " I created the new PowerShell session, and now I'm going to invoke to that session."
    },
    {
      "Time_Start": 1679.84,
      "Time_End": 1686.44,
      "Text": " I'll just look at the local CTEMP directory of that machine, just to make sure that I"
    },
    {
      "Time_Start": 1686.44,
      "Time_End": 1691.96,
      "Text": " don't have any files named text, test, sorry, text, whatever."
    },
    {
      "Time_Start": 1691.96,
      "Time_End": 1699.48,
      "Text": " I'm just going to create locally, on my machine, a new text file right here, whatever, whatever"
    },
    {
      "Time_Start": 1699.48,
      "Time_End": 1700.48,
      "Text": " I want."
    },
    {
      "Time_Start": 1700.48,
      "Time_End": 1701.48,
      "Text": " Just save it."
    },
    {
      "Time_Start": 1701.48,
      "Time_End": 1706.68,
      "Text": " And now I can, this is the content of my local file, and I want to copy this file."
    },
    {
      "Time_Start": 1706.68,
      "Time_End": 1708.24,
      "Text": " But I don't have SMB."
    },
    {
      "Time_Start": 1708.24,
      "Time_End": 1712.3600000000001,
      "Text": " But I can use the PowerShell copy to session or from session."
    },
    {
      "Time_Start": 1712.3600000000001,
      "Time_End": 1718.14,
      "Text": " I can copy to that remote session, this local machine from my local file, and the destination"
    },
    {
      "Time_Start": 1718.14,
      "Time_End": 1720.72,
      "Text": " should be at the remote machine."
    },
    {
      "Time_Start": 1720.72,
      "Time_End": 1722.56,
      "Text": " So the CTEMP of that remote machine."
    },
    {
      "Time_Start": 1722.56,
      "Time_End": 1728.1200000000001,
      "Text": " Now when I invoke command, of course, you can see the file was properly copied, and"
    },
    {
      "Time_Start": 1728.1200000000001,
      "Time_End": 1730.5600000000002,
      "Text": " I can also see the content."
    },
    {
      "Time_Start": 1730.5600000000002,
      "Time_End": 1736.24,
      "Text": " So for Blue Team, just enough access is really nice, because it really creates a secure,"
    },
    {
      "Time_Start": 1736.24,
      "Time_End": 1739.8000000000002,
      "Text": " constrained, delegated remote access endpoint."
    },
    {
      "Time_Start": 1739.8000000000002,
      "Time_End": 1745.3200000000002,
      "Text": " It utilizes PowerShell session configurations, which is, if you don't know about this, you"
    },
    {
      "Time_Start": 1745.3200000000002,
      "Time_End": 1752.8000000000002,
      "Text": " should really get more into it, because this really makes adversary life harder, much harder."
    },
    {
      "Time_Start": 1752.8,
      "Time_End": 1759.68,
      "Text": " It can give you a lot of logging and visibility, transcriptions, constrained language."
    },
    {
      "Time_Start": 1759.68,
      "Time_End": 1761.9199999999998,
      "Text": " We'll talk about virtual accounts in a second."
    },
    {
      "Time_Start": 1761.9199999999998,
      "Time_End": 1766.6,
      "Text": " But mainly, it can allow you to create a role-based access control."
    },
    {
      "Time_Start": 1766.6,
      "Time_End": 1773.62,
      "Text": " You can create a shell, essentially, payroll for the DNS administrator, for the supplier,"
    },
    {
      "Time_Start": 1773.62,
      "Time_End": 1780.12,
      "Text": " the vendor that comes just to fix something in your specific application."
    },
    {
      "Time_Start": 1780.16,
      "Time_End": 1785.3200000000002,
      "Text": " We can give them access to domain controllers just for specific commands, down to the value"
    },
    {
      "Time_Start": 1785.3200000000002,
      "Time_End": 1788.72,
      "Text": " of the parameter, to this very specific level."
    },
    {
      "Time_Start": 1788.72,
      "Time_End": 1792.64,
      "Text": " You can whitelist things very deeply with that."
    },
    {
      "Time_Start": 1792.64,
      "Time_End": 1797.3200000000002,
      "Text": " Just to show you a very, very quick example of PowerShell session configurations."
    },
    {
      "Time_Start": 1797.3200000000002,
      "Time_End": 1802.5200000000002,
      "Text": " For example, here I'm connecting remotely to a machine called Lon-CL1."
    },
    {
      "Time_Start": 1802.5200000000002,
      "Time_End": 1808.1200000000001,
      "Text": " As you can see, I can run shutdown, ipconfig, whatever, because by default, PowerShell remoting"
    },
    {
      "Time_Start": 1808.1200000000001,
      "Time_End": 1812.4,
      "Text": " will give me a lot of commands, right?"
    },
    {
      "Time_Start": 1812.4,
      "Time_End": 1813.5600000000002,
      "Text": " I'll just do a quick count."
    },
    {
      "Time_Start": 1813.5600000000002,
      "Time_End": 1820.24,
      "Text": " You can see I have almost 3,000 PowerShell commands available in the default remote session."
    },
    {
      "Time_Start": 1820.24,
      "Time_End": 1828.0000000000002,
      "Text": " But what if I connect, and I connect again to a PowerShell session to that same machine,"
    },
    {
      "Time_Start": 1828.0000000000002,
      "Time_End": 1833.92,
      "Text": " but now I connect to a configuration that I pre-configured, called securecon, and I'm"
    },
    {
      "Time_Start": 1833.92,
      "Time_End": 1839.44,
      "Text": " using a specific credential just for a user that I delegated that can run this specific"
    },
    {
      "Time_Start": 1839.44,
      "Time_End": 1842.92,
      "Text": " configuration."
    },
    {
      "Time_Start": 1842.92,
      "Time_End": 1849.5600000000002,
      "Text": " And now when I connect with this user, again, essentially it's the same session, but no,"
    },
    {
      "Time_Start": 1849.5600000000002,
      "Time_End": 1855.48,
      "Text": " not at all, because now if I tap normally the command, it will not work."
    },
    {
      "Time_Start": 1855.48,
      "Time_End": 1857.24,
      "Text": " None of those commands is available for me."
    },
    {
      "Time_Start": 1857.24,
      "Time_End": 1858.24,
      "Text": " So what's happening here?"
    },
    {
      "Time_Start": 1858.24,
      "Time_End": 1861.6000000000001,
      "Text": " It's the same machine, exactly the same machine, same protocol."
    },
    {
      "Time_Start": 1861.6000000000001,
      "Time_End": 1862.64,
      "Text": " There you go."
    },
    {
      "Time_Start": 1862.64,
      "Time_End": 1868.72,
      "Text": " I just whitelisted very, very specific commands for this session."
    },
    {
      "Time_Start": 1868.72,
      "Time_End": 1876.0600000000002,
      "Text": " And this really makes all-based delegated commands."
    },
    {
      "Time_Start": 1876.0600000000002,
      "Time_End": 1882.76,
      "Text": " You can see start service, I only give them audio and spooler or whatever."
    },
    {
      "Time_Start": 1882.76,
      "Time_End": 1884.2800000000002,
      "Text": " None other service will work."
    },
    {
      "Time_Start": 1884.2800000000002,
      "Time_End": 1887.1200000000001,
      "Text": " You cannot stop or start any other service."
    },
    {
      "Time_Start": 1887.1200000000001,
      "Time_End": 1889.1200000000001,
      "Text": " That's really powerful."
    },
    {
      "Time_Start": 1889.1200000000001,
      "Time_End": 1890.8400000000001,
      "Text": " And that begs the question, OK."
    },
    {
      "Time_Start": 1890.8400000000001,
      "Time_End": 1896.38,
      "Text": " So now when we work more with partial remoting, because it's very cool for IT and for Blue"
    },
    {
      "Time_Start": 1896.38,
      "Time_End": 1900.68,
      "Text": " Team, so how can we map or hunt for those sessions?"
    },
    {
      "Time_Start": 1900.68,
      "Time_End": 1906.8600000000001,
      "Text": " That's a good question, because by default, Microsoft does not have tools like that available."
    },
    {
      "Time_Start": 1906.8600000000001,
      "Time_End": 1913.64,
      "Text": " You can probably use EDR, Sysmon, et cetera, and just look for WSMProvHostExit."
    },
    {
      "Time_Start": 1913.64,
      "Time_End": 1917.5600000000002,
      "Text": " This is the process that gets created in the destination when you connect with partial"
    },
    {
      "Time_Start": 1917.5600000000002,
      "Time_End": 1918.8400000000001,
      "Text": " remoting."
    },
    {
      "Time_Start": 1918.8400000000001,
      "Time_End": 1925.1200000000001,
      "Text": " You can obviously look at the relevant ETW providers, WinRM and PowerShell operational"
    },
    {
      "Time_Start": 1925.1200000000001,
      "Time_End": 1926.1200000000001,
      "Text": " logs."
    },
    {
      "Time_Start": 1926.1200000000001,
      "Time_End": 1932.0800000000002,
      "Text": " By the way, WinRM has event ID 6 for the client operation when you connect to it, and event"
    },
    {
      "Time_Start": 1932.0800000000002,
      "Time_End": 1939.3200000000002,
      "Text": " ID 9191 on the destination logged to the operational log."
    },
    {
      "Time_Start": 1939.3200000000002,
      "Time_End": 1941.44,
      "Text": " But you can also try one of my scripts."
    },
    {
      "Time_Start": 1941.44,
      "Time_End": 1944.5600000000002,
      "Text": " I will not run it now for the sakes of the time."
    },
    {
      "Time_Start": 1944.56,
      "Time_End": 1952.04,
      "Text": " But on my GitHub, there is a script that enumerates the web services management URI and the WSMAN"
    },
    {
      "Time_Start": 1952.04,
      "Time_End": 1953.04,
      "Text": " instance."
    },
    {
      "Time_Start": 1953.04,
      "Time_End": 1958.6799999999998,
      "Text": " And you can remotely query all around your networks, remote PowerShell sessions, and"
    },
    {
      "Time_Start": 1958.6799999999998,
      "Time_End": 1963.76,
      "Text": " see who connects from there, and from where, and how long it has been idle also."
    },
    {
      "Time_Start": 1963.76,
      "Time_End": 1970.36,
      "Text": " So this can be really useful when you're doing threat hunting, especially in live incidents."
    },
    {
      "Time_Start": 1970.36,
      "Time_End": 1972.44,
      "Text": " Let's speak about remote operations."
    },
    {
      "Time_Start": 1972.44,
      "Time_End": 1976.88,
      "Text": " So I like to poke around Microsoft documentation."
    },
    {
      "Time_Start": 1976.88,
      "Time_End": 1982.24,
      "Text": " Because like many of my fellow friends, speakers, and researchers, I know that many times the"
    },
    {
      "Time_Start": 1982.24,
      "Time_End": 1987.76,
      "Text": " documentation of Microsoft is not accurate, to say the least."
    },
    {
      "Time_Start": 1987.76,
      "Time_End": 1994.6000000000001,
      "Text": " So I poked around one of their recent papers from recent months, updated a few months ago,"
    },
    {
      "Time_Start": 1994.6000000000001,
      "Time_End": 2000.54,
      "Text": " about credential exposure in administrative tools and logon types."
    },
    {
      "Time_Start": 2000.54,
      "Time_End": 2004.06,
      "Text": " So by the way, you should look at it, because some things might interest you."
    },
    {
      "Time_Start": 2004.06,
      "Time_End": 2010.34,
      "Text": " For example, remote registry service that we all read, and we don't want to use it."
    },
    {
      "Time_Start": 2010.34,
      "Time_End": 2011.34,
      "Text": " It's so not secure."
    },
    {
      "Time_Start": 2011.34,
      "Time_End": 2016.5,
      "Text": " But actually, to query a registry setting using remote registry service is more secure"
    },
    {
      "Time_Start": 2016.5,
      "Time_End": 2022.18,
      "Text": " than to do it with PSExec, for example, in terms of credentials exposed on the other"
    },
    {
      "Time_Start": 2022.18,
      "Time_End": 2023.18,
      "Text": " side."
    },
    {
      "Time_Start": 2023.18,
      "Time_End": 2025.78,
      "Text": " So let's get the advice from Microsoft."
    },
    {
      "Time_Start": 2025.78,
      "Time_End": 2027.94,
      "Text": " Let's look here."
    },
    {
      "Time_Start": 2027.94,
      "Time_End": 2035.8600000000001,
      "Text": " And you see Microsoft mapped all those different connection methods, as well as if there are"
    },
    {
      "Time_Start": 2035.8600000000001,
      "Time_End": 2039.66,
      "Text": " reusable credentials on destination or not."
    },
    {
      "Time_Start": 2039.66,
      "Time_End": 2049.38,
      "Text": " And for example, because we spoke about partial WinRM, let's look here at the document."
    },
    {
      "Time_Start": 2049.38,
      "Time_End": 2056.78,
      "Text": " And as you can see, there are no reusable credentials on destination, right?"
    },
    {
      "Time_Start": 2056.78,
      "Time_End": 2059.7400000000002,
      "Text": " Because it's logon type 3, network logon."
    },
    {
      "Time_Start": 2059.7400000000002,
      "Time_End": 2067.5400000000004,
      "Text": " This makes me think, because I know in the host level, maybe we can duplicate the token."
    },
    {
      "Time_Start": 2067.5400000000004,
      "Time_End": 2072.94,
      "Text": " And even if we don't have any ELSA secrets, no NTLM, no TGT whatsoever, we can still get"
    },
    {
      "Time_Start": 2072.94,
      "Time_End": 2078.0800000000004,
      "Text": " a full token from that primary token."
    },
    {
      "Time_Start": 2078.0800000000004,
      "Time_End": 2080.34,
      "Text": " So let's see if that works."
    },
    {
      "Time_Start": 2080.34,
      "Time_End": 2084.0600000000004,
      "Text": " So now I'm connected to this machine, LONCL1."
    },
    {
      "Time_Start": 2085.06,
      "Time_End": 2088.86,
      "Text": " If I will show you the unique usernames of all the processes in the machine, as you can"
    },
    {
      "Time_Start": 2088.86,
      "Time_End": 2092.98,
      "Text": " see, I have no process for administrator, right?"
    },
    {
      "Time_Start": 2092.98,
      "Time_End": 2097.54,
      "Text": " I'm running as this user, Adam."
    },
    {
      "Time_Start": 2097.54,
      "Time_End": 2101.82,
      "Text": " And I connected to a different machine, LONDC1."
    },
    {
      "Time_Start": 2101.82,
      "Time_End": 2105.7,
      "Text": " And from this remote machine, I'm connecting with partial remoting, OK?"
    },
    {
      "Time_Start": 2105.7,
      "Time_End": 2112.34,
      "Text": " So now I'm actually connected in a live session, continuous session, from that remote machine."
    },
    {
      "Time_Start": 2112.34,
      "Time_End": 2113.94,
      "Text": " And I'll go back to LONCL1."
    },
    {
      "Time_Start": 2114.82,
      "Time_End": 2120.82,
      "Text": " And now, as you can see, because I connected remotely, I have a process by the user administrator,"
    },
    {
      "Time_Start": 2120.82,
      "Time_End": 2124.1,
      "Text": " the domain admin of this domain."
    },
    {
      "Time_Start": 2124.1,
      "Time_End": 2126.5,
      "Text": " So let's run Mimikatz, OK?"
    },
    {
      "Time_Start": 2126.5,
      "Time_End": 2130.3,
      "Text": " Let's run Mimikatz on this box, now that the session is open."
    },
    {
      "Time_Start": 2130.3,
      "Time_End": 2133.42,
      "Text": " And I have this process running in the background."
    },
    {
      "Time_Start": 2133.42,
      "Time_End": 2140.26,
      "Text": " And dump all the credentials we can find, classic secure LSA logon passwords."
    },
    {
      "Time_Start": 2140.26,
      "Time_End": 2142.86,
      "Text": " Dump it to this log file."
    },
    {
      "Time_Start": 2142.86,
      "Time_End": 2148.6600000000003,
      "Text": " And let's see, no credential guard or whatever, doesn't matter anyway."
    },
    {
      "Time_Start": 2148.6600000000003,
      "Time_End": 2154.38,
      "Text": " And as you can see, there are no credentials for administrator, because Microsoft is right."
    },
    {
      "Time_Start": 2154.38,
      "Time_End": 2155.82,
      "Text": " There are no credentials exposed."
    },
    {
      "Time_Start": 2155.82,
      "Time_End": 2160.7400000000002,
      "Text": " I'll also show it here for you, select string, show the unique username."
    },
    {
      "Time_Start": 2160.7400000000002,
      "Time_End": 2166.9,
      "Text": " Yeah, no administrator, OK, no NTLM, no nothing."
    },
    {
      "Time_Start": 2166.9,
      "Time_End": 2168.7400000000002,
      "Text": " But we do have a process."
    },
    {
      "Time_Start": 2168.7400000000002,
      "Time_End": 2174.82,
      "Text": " We do have a process, WSAMProvHost, WSAMProvHost.exe."
    },
    {
      "Time_Start": 2174.82,
      "Time_End": 2180.5400000000004,
      "Text": " And this process, if we run something like token manipulation, full token duplication,"
    },
    {
      "Time_Start": 2180.5400000000004,
      "Time_End": 2190.98,
      "Text": " this one is a classic partial, quite veteran from partial mafia, the partial framework,"
    },
    {
      "Time_Start": 2190.98,
      "Time_End": 2191.98,
      "Text": " offensive framework."
    },
    {
      "Time_Start": 2191.98,
      "Time_End": 2194.86,
      "Text": " Now, as you can see, we duplicated the token."
    },
    {
      "Time_Start": 2194.86,
      "Time_End": 2198.5400000000004,
      "Text": " So we have a primary token, delegation token, not impersonation."
    },
    {
      "Time_Start": 2199.34,
      "Time_End": 2203.98,
      "Text": " And when we access domain controller to the C drive, we get access."
    },
    {
      "Time_Start": 2203.98,
      "Time_End": 2206.22,
      "Text": " Why is this possible?"
    },
    {
      "Time_Start": 2206.22,
      "Time_End": 2211.46,
      "Text": " OK, so the documentation is maybe right on paper."
    },
    {
      "Time_Start": 2211.46,
      "Time_End": 2214.54,
      "Text": " But in reality, I have domain admin."
    },
    {
      "Time_Start": 2214.54,
      "Time_End": 2216.54,
      "Text": " So what can we do to mitigate?"
    },
    {
      "Time_Start": 2216.54,
      "Time_End": 2220.94,
      "Text": " I promise you, blue teamers, I'm not leaving you stranded in the field."
    },
    {
      "Time_Start": 2220.94,
      "Time_End": 2224.7799999999997,
      "Text": " There is a mitigation, virtual accounts."
    },
    {
      "Time_Start": 2224.82,
      "Time_End": 2227.34,
      "Text": " Microsoft is a very responsible company."
    },
    {
      "Time_Start": 2227.34,
      "Time_End": 2231.26,
      "Text": " And that's why it created virtual accounts."
    },
    {
      "Time_Start": 2231.26,
      "Time_End": 2237.7400000000002,
      "Text": " If we look at the whole capabilities file of partial session configurations, we can"
    },
    {
      "Time_Start": 2237.7400000000002,
      "Time_End": 2246.1800000000003,
      "Text": " see one of the capabilities options that we can configure is essentially run as virtual"
    },
    {
      "Time_Start": 2246.1800000000003,
      "Time_End": 2248.6200000000003,
      "Text": " account equals $true."
    },
    {
      "Time_Start": 2248.62,
      "Time_End": 2253.1,
      "Text": " And what this does, this is really a great magic."
    },
    {
      "Time_Start": 2253.1,
      "Time_End": 2259.62,
      "Text": " Because once you enable this option, I will show you in a second what happens."
    },
    {
      "Time_Start": 2259.62,
      "Time_End": 2265.8599999999997,
      "Text": " Now when I connect to this partial remote session, and I will connect to the same machine,"
    },
    {
      "Time_Start": 2265.8599999999997,
      "Time_End": 2275.18,
      "Text": " but this time using a secure con configuration that actually enforces the process to run"
    },
    {
      "Time_Start": 2275.18,
      "Time_End": 2277.7,
      "Text": " as a virtual account."
    },
    {
      "Time_Start": 2277.78,
      "Time_End": 2284.5000000000005,
      "Text": " What this means, technically, is that I get the shell, I get the remote access with all"
    },
    {
      "Time_Start": 2284.5000000000005,
      "Time_End": 2288.0200000000004,
      "Text": " the commands available, and they will execute successfully."
    },
    {
      "Time_Start": 2288.0200000000004,
      "Time_End": 2295.5800000000004,
      "Text": " But they will run as an account, not with the seed of the account that I'm actually"
    },
    {
      "Time_Start": 2295.5800000000004,
      "Time_End": 2296.5800000000004,
      "Text": " running."
    },
    {
      "Time_Start": 2296.5800000000004,
      "Time_End": 2302.7400000000002,
      "Text": " So we can see now, if I expand the username, it's not running as Adam or administrator,"
    },
    {
      "Time_Start": 2302.7400000000002,
      "Time_End": 2307.34,
      "Text": " it's running as WinRM, virtual account, whatever."
    },
    {
      "Time_Start": 2307.34,
      "Time_End": 2312.1400000000003,
      "Text": " Also the seed of the account doesn't match your domain or local users, and it's essentially"
    },
    {
      "Time_Start": 2312.1400000000003,
      "Time_End": 2315.2000000000003,
      "Text": " something you can do nothing with."
    },
    {
      "Time_Start": 2315.2000000000003,
      "Time_End": 2319.7400000000002,
      "Text": " This time I'll spawn the new process with a different method, with Kernel Cactus, a"
    },
    {
      "Time_Start": 2319.7400000000002,
      "Time_End": 2325.02,
      "Text": " research by one of my colleagues, team members in Tenroot."
    },
    {
      "Time_Start": 2325.02,
      "Time_End": 2326.2200000000003,
      "Text": " But it's really the same."
    },
    {
      "Time_Start": 2326.2200000000003,
      "Time_End": 2332.26,
      "Text": " I could use the same partial again, but just to show you that the process duplication works,"
    },
    {
      "Time_Start": 2332.26,
      "Time_End": 2334.6200000000003,
      "Text": " even from Kernel, doesn't matter."
    },
    {
      "Time_Start": 2334.6200000000003,
      "Time_End": 2336.58,
      "Text": " But now I'm running as virtual account."
    },
    {
      "Time_Start": 2336.58,
      "Time_End": 2342.7,
      "Text": " And if I'm running as virtual account, the seed doesn't match the token that I have,"
    },
    {
      "Time_Start": 2342.7,
      "Time_End": 2346.66,
      "Text": " the process token doesn't have the seed that match the domain."
    },
    {
      "Time_Start": 2346.66,
      "Time_End": 2354.48,
      "Text": " So if I try to run anything beyond this box I'm trying to access, it will fail."
    },
    {
      "Time_Start": 2354.48,
      "Time_End": 2360.2599999999998,
      "Text": " As you can see also, the K-list, when I run the tickets, you can see the tickets I got"
    },
    {
      "Time_Start": 2360.2599999999998,
      "Time_End": 2362.42,
      "Text": " are locally from the machine."
    },
    {
      "Time_Start": 2362.42,
      "Time_End": 2368.58,
      "Text": " So I'm not coming out to the network as the user I hoped I will be."
    },
    {
      "Time_Start": 2368.58,
      "Time_End": 2377.94,
      "Text": " But as adversaries, if we already got to this box, and we have local admin privileges, rights,"
    },
    {
      "Time_Start": 2377.94,
      "Time_End": 2386.54,
      "Text": " we can just add it in Notepad, this role capabilities file."
    },
    {
      "Time_Start": 2386.54,
      "Time_End": 2388.34,
      "Text": " Because it's a file."
    },
    {
      "Time_Start": 2388.34,
      "Time_End": 2394.3,
      "Text": " So essentially you go to the file, and you change it from $true to $false, and that's"
    },
    {
      "Time_Start": 2394.3,
      "Time_End": 2395.3,
      "Text": " it."
    },
    {
      "Time_Start": 2395.3,
      "Time_End": 2400.2200000000003,
      "Text": " No mitigation whatsoever."
    },
    {
      "Time_Start": 2400.2200000000003,
      "Time_End": 2401.2200000000003,
      "Text": " But wait!"
    },
    {
      "Time_Start": 2401.2200000000003,
      "Time_End": 2402.2200000000003,
      "Text": " There is more."
    },
    {
      "Time_Start": 2402.2200000000003,
      "Time_End": 2404.9,
      "Text": " Cat and mouse, right?"
    },
    {
      "Time_Start": 2404.9,
      "Time_End": 2407.58,
      "Text": " As my friend Fabian mentioned."
    },
    {
      "Time_Start": 2407.58,
      "Time_End": 2411.6200000000003,
      "Text": " But we defenders, blue teamers, we can monitor all file configs."
    },
    {
      "Time_Start": 2411.6200000000003,
      "Time_End": 2414.06,
      "Text": " We can match by hash changes."
    },
    {
      "Time_Start": 2414.06,
      "Time_End": 2417.7400000000002,
      "Text": " We can actually sign the config file, right?"
    },
    {
      "Time_Start": 2417.7400000000002,
      "Time_End": 2420.5400000000004,
      "Text": " And will you really monitor this?"
    },
    {
      "Time_Start": 2420.5400000000004,
      "Time_End": 2422.3,
      "Text": " I'm just thinking out loud."
    },
    {
      "Time_Start": 2422.3,
      "Time_End": 2427.5800000000004,
      "Text": " Will you monitor, sign all config files, monitor for hash changes?"
    },
    {
      "Time_Start": 2427.5800000000004,
      "Time_End": 2431.78,
      "Text": " As you can see, you take the red pill, and you go down the rabbit hole."
    },
    {
      "Time_Start": 2431.78,
      "Time_End": 2432.78,
      "Text": " It's never-ending."
    },
    {
      "Time_Start": 2432.78,
      "Time_End": 2435.34,
      "Text": " Static measures are really a pain."
    },
    {
      "Time_Start": 2435.34,
      "Time_End": 2439.1800000000003,
      "Text": " It's really about the creativity of the sites."
    },
    {
      "Time_Start": 2439.1800000000003,
      "Time_End": 2442.6600000000003,
      "Text": " Whether you're a red teamer or a blue teamer, this never ends."
    },
    {
      "Time_Start": 2442.6600000000003,
      "Time_End": 2447.5400000000004,
      "Text": " You also have all partial defenses in the world for you."
    },
    {
      "Time_Start": 2448.34,
      "Time_End": 2453.98,
      "Text": " Sadly, a few years back, we published the research, back with my friends in Javelin"
    },
    {
      "Time_Start": 2453.98,
      "Time_End": 2457.62,
      "Text": " Networks, Omer Yair and the team, called InvisiShell."
    },
    {
      "Time_Start": 2457.62,
      "Time_End": 2459.98,
      "Text": " It's still working until today."
    },
    {
      "Time_Start": 2459.98,
      "Time_End": 2466.58,
      "Text": " Many DRs obviously detect it, or the IOCs, but many sometimes don't."
    },
    {
      "Time_Start": 2466.58,
      "Time_End": 2471.38,
      "Text": " And if you just bypass AMSI, then this will work."
    },
    {
      "Time_Start": 2471.38,
      "Time_End": 2476.62,
      "Text": " InvisiShell, essentially, is working with CLR profiling, what we do there, and it doesn't"
    },
    {
      "Time_Start": 2476.7,
      "Time_End": 2479.02,
      "Text": " even need administrative privileges."
    },
    {
      "Time_Start": 2479.02,
      "Time_End": 2484.5,
      "Text": " You will get a PowerShell process without any defenses."
    },
    {
      "Time_Start": 2484.5,
      "Time_End": 2493.74,
      "Text": " It just totally bypasses all the JITed code addresses from all the hooks to the ETW and"
    },
    {
      "Time_Start": 2493.74,
      "Time_End": 2495.06,
      "Text": " to AMSI, et cetera."
    },
    {
      "Time_Start": 2495.06,
      "Time_End": 2497.22,
      "Text": " So feel free to use that."
    },
    {
      "Time_Start": 2497.22,
      "Time_End": 2499.94,
      "Text": " It's quite good for red teamers."
    },
    {
      "Time_Start": 2499.94,
      "Time_End": 2503.46,
      "Text": " Finally, I want to ask you a very simple question."
    },
    {
      "Time_Start": 2503.46,
      "Time_End": 2509.38,
      "Text": " It's so simple that it's amazing how many bad answers you get from chat GPT when you"
    },
    {
      "Time_Start": 2509.38,
      "Time_End": 2511.14,
      "Text": " ask it."
    },
    {
      "Time_Start": 2511.14,
      "Time_End": 2516.02,
      "Text": " How do I prevent domain admins from logging to endpoints?"
    },
    {
      "Time_Start": 2516.02,
      "Time_End": 2517.34,
      "Text": " Fairly simple question, right?"
    },
    {
      "Time_Start": 2517.34,
      "Time_End": 2522.7400000000002,
      "Text": " I mean, it's a question we all ask for ourselves the last 10, 20 years, at least, right?"
    },
    {
      "Time_Start": 2522.7400000000002,
      "Time_End": 2524.02,
      "Text": " Very simple question."
    },
    {
      "Time_Start": 2524.02,
      "Time_End": 2530.08,
      "Text": " So before you ask, you say, yeah, we buy third-party jump servers, whatever."
    },
    {
      "Time_Start": 2530.08,
      "Time_End": 2532.58,
      "Text": " We just want to stop lateral movement, right?"
    },
    {
      "Time_Start": 2532.58,
      "Time_End": 2534.06,
      "Text": " So how can you stop lateral movement?"
    },
    {
      "Time_Start": 2534.06,
      "Time_End": 2541.14,
      "Text": " You can think about expensive solutions, and let's say you really want to prevent that,"
    },
    {
      "Time_Start": 2541.14,
      "Time_End": 2545.54,
      "Text": " but you want to do it very simple, and you know how Active Directory works."
    },
    {
      "Time_Start": 2545.54,
      "Time_End": 2551.98,
      "Text": " So I want to show you something very basic, but this is more hard for adversaries and"
    },
    {
      "Time_Start": 2551.98,
      "Time_End": 2558.86,
      "Text": " red teamers to circumvent than expensive third-party products from experience."
    },
    {
      "Time_Start": 2559.86,
      "Time_End": 2565.58,
      "Text": " Like I call it, small step for IT, giant step for the blue teams against lateral movement."
    },
    {
      "Time_Start": 2565.58,
      "Time_End": 2570.94,
      "Text": " Let's say you're in a network, no EDR, no segmentation, flat network, no VLANs, no MFA,"
    },
    {
      "Time_Start": 2570.94,
      "Time_End": 2579.1800000000003,
      "Text": " no nothing, many misconfigurations, vulnerable certificate templates, whatever, but we just"
    },
    {
      "Time_Start": 2579.1800000000003,
      "Time_End": 2587.86,
      "Text": " want to set logon restrictions for the user workstations, the logon workstations attribute."
    },
    {
      "Time_Start": 2587.86,
      "Time_End": 2589.34,
      "Text": " It's that simple."
    },
    {
      "Time_Start": 2589.34,
      "Time_End": 2596.1800000000003,
      "Text": " So hiding in the properties of an AD user where you visited so many times, there is"
    },
    {
      "Time_Start": 2596.1800000000003,
      "Time_End": 2602.1400000000003,
      "Text": " this logon workstations that instead of giving it the default all computers, you will add"
    },
    {
      "Time_Start": 2602.1400000000003,
      "Time_End": 2605.58,
      "Text": " specific computers it can log on to."
    },
    {
      "Time_Start": 2605.58,
      "Time_End": 2611.06,
      "Text": " Obviously in a real-world scenario, you will need at least two computers, the one to access"
    },
    {
      "Time_Start": 2611.06,
      "Time_End": 2619.22,
      "Text": " and the one to run from, essentially the jump server or the privilege access workstation."
    },
    {
      "Time_Start": 2619.22,
      "Time_End": 2622.82,
      "Text": " Now I'm going to do pass the hash."
    },
    {
      "Time_Start": 2622.82,
      "Time_End": 2626.2599999999998,
      "Text": " And believe me, this is the right password hash."
    },
    {
      "Time_Start": 2626.2599999999998,
      "Time_End": 2633.82,
      "Text": " Essentially now I have an impersonation token with an administrative user, a domain admin."
    },
    {
      "Time_Start": 2633.82,
      "Time_End": 2639.54,
      "Text": " But now as you can see, although I'm trying to run, I'm doing pass the hash because my"
    },
    {
      "Time_Start": 2639.54,
      "Time_End": 2643.1,
      "Text": " primary token will never work because I'm restricted."
    },
    {
      "Time_Start": 2643.1,
      "Time_End": 2648.06,
      "Text": " I try to do a deal for that domain controller and it says it does not exist."
    },
    {
      "Time_Start": 2648.06,
      "Time_End": 2650.42,
      "Text": " OK, no Kerberos tickets created."
    },
    {
      "Time_Start": 2650.42,
      "Time_End": 2651.42,
      "Text": " Fine."
    },
    {
      "Time_Start": 2651.42,
      "Time_End": 2656.54,
      "Text": " I'm trying to run a WMI command and it says access denied."
    },
    {
      "Time_Start": 2656.54,
      "Time_End": 2663.14,
      "Text": " That's interesting because the ports are open, RPC is enabled and open, and my password hash"
    },
    {
      "Time_Start": 2663.14,
      "Time_End": 2665.42,
      "Text": " is for sure correct."
    },
    {
      "Time_Start": 2665.42,
      "Time_End": 2667.02,
      "Text": " Why it's access denied?"
    },
    {
      "Time_Start": 2667.02,
      "Time_End": 2668.38,
      "Text": " Something is bad here."
    },
    {
      "Time_Start": 2668.38,
      "Time_End": 2674.86,
      "Text": " Now when I will try to run partial remoting, it also said failed, user or password is incorrect."
    },
    {
      "Time_Start": 2674.86,
      "Time_End": 2680.46,
      "Text": " Now I'm beginning to question the NTLM hash that I got, right?"
    },
    {
      "Time_Start": 2680.46,
      "Time_End": 2683.9,
      "Text": " Because I'm thinking maybe there's a problem with NTLM, but no."
    },
    {
      "Time_Start": 2683.9,
      "Time_End": 2689.62,
      "Text": " When I use PS exec, it tells me the user isn't allowed to sign in to this computer."
    },
    {
      "Time_Start": 2689.62,
      "Time_End": 2691.3,
      "Text": " This is interesting, right?"
    },
    {
      "Time_Start": 2691.3,
      "Time_End": 2697.62,
      "Text": " Because not to this computer, I am on one computer and I'm trying to sign."
    },
    {
      "Time_Start": 2697.62,
      "Time_End": 2701.74,
      "Text": " When I try schedule task, remote schedule task, access is denied."
    },
    {
      "Time_Start": 2701.74,
      "Time_End": 2702.74,
      "Text": " Nothing."
    },
    {
      "Time_Start": 2702.74,
      "Time_End": 2703.74,
      "Text": " Nothing."
    },
    {
      "Time_Start": 2703.74,
      "Time_End": 2706.02,
      "Text": " Guys, nothing works."
    },
    {
      "Time_Start": 2706.02,
      "Time_End": 2707.02,
      "Text": " Even queries."
    },
    {
      "Time_Start": 2707.02,
      "Time_End": 2708.02,
      "Text": " LDAP query."
    },
    {
      "Time_Start": 2708.02,
      "Time_End": 2710.38,
      "Text": " I'm not talking about code execution."
    },
    {
      "Time_Start": 2710.38,
      "Time_End": 2716.8199999999997,
      "Text": " LDAP query fails because the LDAP server rejects the client credentials."
    },
    {
      "Time_Start": 2716.8199999999997,
      "Time_End": 2719.42,
      "Text": " And this is all one attribute in Active Directory."
    },
    {
      "Time_Start": 2719.42,
      "Time_End": 2721.58,
      "Text": " That's all you have to set."
    },
    {
      "Time_Start": 2721.58,
      "Time_End": 2726.42,
      "Text": " Even if I do a network protocols, et cetera, and trust me this goes on and on and on and"
    },
    {
      "Time_Start": 2726.42,
      "Time_End": 2728.26,
      "Text": " on and on."
    },
    {
      "Time_Start": 2728.26,
      "Time_End": 2734.7000000000003,
      "Text": " Now working with system directory protocols, I just create an LDAP connection."
    },
    {
      "Time_Start": 2734.7000000000003,
      "Time_End": 2741.3,
      "Text": " With this very simple enumeration of member of, I just want to see the I just initiate"
    },
    {
      "Time_Start": 2741.3,
      "Time_End": 2747.2200000000003,
      "Text": " a new LDAP connection and I try to see the member of property of this user and the supplied"
    },
    {
      "Time_Start": 2747.2200000000003,
      "Time_End": 2748.9,
      "Text": " credential is invalid."
    },
    {
      "Time_Start": 2748.9,
      "Time_End": 2754.7000000000003,
      "Text": " All this because of this logon workstations attribute in Active Directory."
    },
    {
      "Time_Start": 2755.1400000000003,
      "Time_End": 2761.6200000000003,
      "Text": " If you're not sure, maybe there is some other magic in this demo."
    },
    {
      "Time_Start": 2761.6200000000003,
      "Time_End": 2768.42,
      "Text": " Of course, obviously, when we do have the clear text password, this will also fail because"
    },
    {
      "Time_Start": 2768.42,
      "Time_End": 2775.34,
      "Text": " you will see even when I type the right password for this user Adam that we just restricted,"
    },
    {
      "Time_Start": 2775.34,
      "Time_End": 2782.5800000000004,
      "Text": " regardless of the pass the hash, you will see we get this very clear message that there"
    },
    {
      "Time_Start": 2782.58,
      "Time_End": 2787.54,
      "Text": " is a problem logging you in, there is some restriction, there is some problem."
    },
    {
      "Time_Start": 2787.54,
      "Time_End": 2793.74,
      "Text": " If we go back to Active Directory, just to show you that I don't need even to log off"
    },
    {
      "Time_Start": 2793.74,
      "Time_End": 2804.14,
      "Text": " from that session, from the same session, I will just reset it back to all computers"
    },
    {
      "Time_Start": 2804.14,
      "Time_End": 2807.62,
      "Text": " or just I could add just my machine, this local machine."
    },
    {
      "Time_Start": 2807.62,
      "Time_End": 2811.74,
      "Text": " I apply the attribute, no GP update, no nothing."
    },
    {
      "Time_Start": 2811.7400000000002,
      "Time_End": 2812.98,
      "Text": " It's directly connected."
    },
    {
      "Time_Start": 2812.98,
      "Time_End": 2816.26,
      "Text": " I run the query, boom, LDAP query works."
    },
    {
      "Time_Start": 2816.26,
      "Time_End": 2818.78,
      "Text": " I get the group membership."
    },
    {
      "Time_Start": 2818.78,
      "Time_End": 2821.98,
      "Text": " Everything I will run now will just work fine."
    },
    {
      "Time_Start": 2821.98,
      "Time_End": 2826.98,
      "Text": " I will try to do schedule tasks successfully, PSX successfully."
    },
    {
      "Time_Start": 2826.98,
      "Time_End": 2832.7000000000003,
      "Text": " Okay, so it was just this attribute."
    },
    {
      "Time_Start": 2832.7000000000003,
      "Time_End": 2836.46,
      "Text": " Because we're running out of time, I just quickly show you I have some other scripts"
    },
    {
      "Time_Start": 2836.46,
      "Time_End": 2843.46,
      "Text": " on my GitHub page that really reflect you the timeline generation for your SOC, for"
    },
    {
      "Time_Start": 2843.46,
      "Time_End": 2849.42,
      "Text": " the analyst to see exactly what's happening while you work with logon restriction."
    },
    {
      "Time_Start": 2849.42,
      "Time_End": 2854.18,
      "Text": " And I also include some scripts to monitor this with some best practices, how to monitor"
    },
    {
      "Time_Start": 2854.18,
      "Time_End": 2855.58,
      "Text": " changes for this attribute."
    },
    {
      "Time_Start": 2855.58,
      "Time_End": 2858.94,
      "Text": " So feel free to visit my GitHub page and take it from there."
    },
    {
      "Time_Start": 2858.94,
      "Time_End": 2865.26,
      "Text": " Okay, so key takeaways, please, please embrace living off the land as a mindset, as a mentality."
    },
    {
      "Time_Start": 2865.5800000000004,
      "Time_End": 2870.6600000000003,
      "Text": " It doesn't matter if you're a red team or a pen tester or a blue team."
    },
    {
      "Time_Start": 2870.6600000000003,
      "Time_End": 2875.94,
      "Text": " Note that credentials exposed on endpoints are not necessarily like the documentation"
    },
    {
      "Time_Start": 2875.94,
      "Time_End": 2877.26,
      "Text": " says."
    },
    {
      "Time_Start": 2877.26,
      "Time_End": 2881.1000000000004,
      "Text": " And like I mentioned earlier, with the Dirk Jan, we're going to understand exactly why"
    },
    {
      "Time_Start": 2881.1000000000004,
      "Time_End": 2886.5,
      "Text": " this primary process token works on a network level."
    },
    {
      "Time_Start": 2886.5,
      "Time_End": 2891.1400000000003,
      "Text": " Sometimes a single configuration goes way further than expensive third party products."
    },
    {
      "Time_Start": 2891.1400000000003,
      "Time_End": 2892.5,
      "Text": " And partial remoting rocks."
    },
    {
      "Time_Start": 2892.5,
      "Time_End": 2899.1,
      "Text": " It's really the best way to manage the environment, but keep in mind that this really is something"
    },
    {
      "Time_Start": 2899.1,
      "Time_End": 2905.42,
      "Text": " you need to log and continuously monitor because it can also be bypassed."
    },
    {
      "Time_Start": 2905.42,
      "Time_End": 2909.98,
      "Text": " And remember, at the end of the day, all of those is just tools."
    },
    {
      "Time_Start": 2909.98,
      "Time_End": 2911.34,
      "Text": " It's not bad nor good."
    },
    {
      "Time_Start": 2911.34,
      "Time_End": 2913.9,
      "Text": " That part is really up to you."
    },
    {
      "Time_Start": 2913.94,
      "Time_End": 2922.86,
      "Text": " And at the end, everything is a set of nested if statements, including JGPT."
    },
    {
      "Time_Start": 2922.86,
      "Time_End": 2926.02,
      "Text": " It's just a lot of if statements, right?"
    },
    {
      "Time_Start": 2926.02,
      "Time_End": 2927.02,
      "Text": " That's all it is."
    },
    {
      "Time_Start": 2927.02,
      "Time_End": 2928.7000000000003,
      "Text": " Dzi\u0119kuj\u0119 bardzo."
    }
  ]
}