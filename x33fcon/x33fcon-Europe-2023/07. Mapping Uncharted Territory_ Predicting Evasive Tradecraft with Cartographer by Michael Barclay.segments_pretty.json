{
  "segments": [
    {
      "Time_Start": 0.0,
      "Time_End": 8.08,
      "Text": "This text was transcribed using whisper model: large-v2\n\n I'm Michael Barclay."
    },
    {
      "Time_Start": 8.08,
      "Time_End": 13.72,
      "Text": " Welcome to Mapping Uncharted Territory, Predicting Evasive Tradecraft with Cartographer."
    },
    {
      "Time_Start": 13.72,
      "Time_End": 16.64,
      "Text": " My professional experience is primarily on the blue team side of things."
    },
    {
      "Time_Start": 16.64,
      "Time_End": 21.92,
      "Text": " I've worn a lot of hats on that side of the field from SOC operations, incident response,"
    },
    {
      "Time_Start": 21.92,
      "Time_End": 22.92,
      "Text": " threat intel."
    },
    {
      "Time_Start": 22.92,
      "Time_End": 26.36,
      "Text": " Currently, I'm the architect for defensive services at SpectreOps."
    },
    {
      "Time_Start": 26.36,
      "Time_End": 30.24,
      "Text": " In terms of academic interests, I'm mostly interested in Windows internals."
    },
    {
      "Time_Start": 30.24,
      "Time_End": 35.879999999999995,
      "Text": " I'm very Windows-heavy in terms of what my interests are, and specifically reverse engineering"
    },
    {
      "Time_Start": 35.879999999999995,
      "Time_End": 36.879999999999995,
      "Text": " work."
    },
    {
      "Time_Start": 36.879999999999995,
      "Time_End": 40.72,
      "Text": " If you ever want to reach out, my Twitter is just my first and last name with an underscore"
    },
    {
      "Time_Start": 40.72,
      "Time_End": 41.72,
      "Text": " at the end."
    },
    {
      "Time_Start": 41.72,
      "Time_End": 46.64,
      "Text": " And before I really jump into the actual talk today, I do want to do a couple of shoutouts"
    },
    {
      "Time_Start": 46.64,
      "Time_End": 50.8,
      "Text": " here specifically to Jared Atkinson and Johnny Johnson, two of my coworkers at SpectreOps"
    },
    {
      "Time_Start": 50.800000000000004,
      "Time_End": 58.400000000000006,
      "Text": " who are doing a lot of research parallel, if not exactly the same as what I'm going"
    },
    {
      "Time_Start": 58.400000000000006,
      "Time_End": 59.64,
      "Text": " to be talking about today."
    },
    {
      "Time_Start": 59.64,
      "Time_End": 66.4,
      "Text": " And we've kind of all been collaboratively working towards the conceptual underpinnings"
    },
    {
      "Time_Start": 66.4,
      "Time_End": 68.28,
      "Text": " of the project that I'm going to present today."
    },
    {
      "Time_Start": 68.28,
      "Time_End": 71.92,
      "Text": " And I also just want to give a quick shout out to Evan McBroom and Lee Christensen as"
    },
    {
      "Time_Start": 71.92,
      "Time_End": 76.88000000000001,
      "Text": " well who have always been extremely patient in answering very, very specific Windows internals"
    },
    {
      "Time_Start": 76.88,
      "Time_End": 82.6,
      "Text": " questions that I've come across while putting this whole project together."
    },
    {
      "Time_Start": 82.6,
      "Time_End": 87.6,
      "Text": " So first I'm going to start talking about some conceptual kind of concepts and underpinnings"
    },
    {
      "Time_Start": 87.6,
      "Time_End": 94.72,
      "Text": " related to detection engineering and evasion and developing more evasive tooling and tradecraft"
    },
    {
      "Time_Start": 94.72,
      "Time_End": 99.88,
      "Text": " and how these are actually kind of predictions about what we think the other side is going"
    },
    {
      "Time_Start": 99.88,
      "Time_End": 101.91999999999999,
      "Text": " to do or already has done."
    },
    {
      "Time_Start": 101.96000000000001,
      "Time_End": 108.16,
      "Text": " I'm then going to introduce a web application that I put together to kind of show how you"
    },
    {
      "Time_Start": 108.16,
      "Time_End": 111.12,
      "Text": " can apply this conceptual model."
    },
    {
      "Time_Start": 111.12,
      "Time_End": 115.32000000000001,
      "Text": " And I'm going to talk a little bit about the future of that web app and the project as"
    },
    {
      "Time_Start": 115.32000000000001,
      "Time_End": 116.32000000000001,
      "Text": " a whole."
    },
    {
      "Time_Start": 116.32000000000001,
      "Time_End": 120.48,
      "Text": " And then I'm going to do a really quick demo at the end, but the web application is live"
    },
    {
      "Time_Start": 120.48,
      "Time_End": 121.48,
      "Text": " right now."
    },
    {
      "Time_Start": 121.48,
      "Time_End": 126.6,
      "Text": " So I will give you the URL for that as part of this talk."
    },
    {
      "Time_Start": 126.6,
      "Time_End": 131.76,
      "Text": " So information security is an inherently adversarial problem set."
    },
    {
      "Time_Start": 132.6,
      "Time_End": 136.32,
      "Text": " Defenders develop offensive tradecraft and the tooling to implement that tradecraft."
    },
    {
      "Time_Start": 136.32,
      "Time_End": 142.51999999999998,
      "Text": " And defenders implement some set of protective controls and detection strategies in response"
    },
    {
      "Time_Start": 142.51999999999998,
      "Time_End": 143.67999999999998,
      "Text": " to that."
    },
    {
      "Time_Start": 143.67999999999998,
      "Time_End": 146.35999999999999,
      "Text": " And attackers then pick that up and do the same thing."
    },
    {
      "Time_Start": 146.35999999999999,
      "Time_End": 151.2,
      "Text": " They modify their tradecraft in response to whatever controls defenders have implemented"
    },
    {
      "Time_Start": 151.2,
      "Time_End": 154.6,
      "Text": " or that they at least think defenders have implemented."
    },
    {
      "Time_Start": 154.6,
      "Time_End": 160.16,
      "Text": " And this feedback loop continues indefinitely, I guess, until we decide to go back to pen"
    },
    {
      "Time_Start": 160.16,
      "Time_End": 162.32,
      "Text": " and paper."
    },
    {
      "Time_Start": 162.32,
      "Time_End": 168.07999999999998,
      "Text": " But there is a kind of cyclical innovation cycle that happens in information security"
    },
    {
      "Time_Start": 168.07999999999998,
      "Time_End": 174.35999999999999,
      "Text": " where we really only progress by way of trying to respond to something we believe is true"
    },
    {
      "Time_Start": 174.35999999999999,
      "Time_End": 177.04,
      "Text": " about what the other side is doing."
    },
    {
      "Time_Start": 177.04,
      "Time_End": 183.64,
      "Text": " But these predictions, and we are all in the business of making predictions, whether we're"
    },
    {
      "Time_Start": 183.64,
      "Time_End": 187.84,
      "Text": " on the red or blue side of things, we're in the business of making predictions about what"
    },
    {
      "Time_Start": 187.84,
      "Time_End": 189.16,
      "Text": " we think the other side is doing."
    },
    {
      "Time_Start": 189.16,
      "Time_End": 196.28,
      "Text": " And these predictions suffer from uncertainty because the problem set is very uncertain."
    },
    {
      "Time_Start": 196.28,
      "Time_End": 199.96,
      "Text": " So before we get into some of those sources of uncertainty, we should talk a little bit"
    },
    {
      "Time_Start": 199.96,
      "Time_End": 201.88,
      "Text": " about what a prediction actually is."
    },
    {
      "Time_Start": 201.88,
      "Time_End": 207.68,
      "Text": " And a prediction is some estimation of the likelihood of some future event occurring."
    },
    {
      "Time_Start": 207.68,
      "Time_End": 213.08,
      "Text": " And I like to think of detection rules, for instance, from the blue team perspective,"
    },
    {
      "Time_Start": 213.08,
      "Time_End": 215.68,
      "Text": " as a prediction in and of itself."
    },
    {
      "Time_Start": 215.68,
      "Time_End": 220.76000000000002,
      "Text": " And when we make predictions about anything, let alone just building detection rules, or"
    },
    {
      "Time_Start": 220.76000000000002,
      "Time_End": 224.8,
      "Text": " some other examples we'll get into in a moment, we have to make assumptions about the world"
    },
    {
      "Time_Start": 224.8,
      "Time_End": 225.8,
      "Text": " around us."
    },
    {
      "Time_Start": 225.8,
      "Time_End": 226.8,
      "Text": " Because the world is complex."
    },
    {
      "Time_Start": 226.8,
      "Time_End": 232.64000000000001,
      "Text": " There's always going to be unknowable things that we have to say, we think this is true"
    },
    {
      "Time_Start": 232.64000000000001,
      "Time_End": 234.64000000000001,
      "Text": " and act accordingly."
    },
    {
      "Time_Start": 234.64000000000001,
      "Time_End": 238.18,
      "Text": " And so when we're building a detection rule, for instance, we have to make assumptions"
    },
    {
      "Time_Start": 238.18,
      "Time_End": 240.24,
      "Text": " about two main categories of things."
    },
    {
      "Time_Start": 240.24,
      "Time_End": 245.32,
      "Text": " So first, the nature of contemporary tradecraft, what type of tradecraft is likely to be employed"
    },
    {
      "Time_Start": 245.35999999999999,
      "Time_End": 250.95999999999998,
      "Text": " in my environment as a defender, if someone were to gain illicit access to it?"
    },
    {
      "Time_Start": 250.95999999999998,
      "Time_End": 256.08,
      "Text": " Not just what techniques, but what specific procedures, what do those procedures actually"
    },
    {
      "Time_Start": 256.08,
      "Time_End": 257.52,
      "Text": " do?"
    },
    {
      "Time_Start": 257.52,
      "Time_End": 260.2,
      "Text": " What do the tools that implement those procedures actually do?"
    },
    {
      "Time_Start": 260.2,
      "Time_End": 266.44,
      "Text": " And I have to kind of hang my hat somewhere and say, this is what I think is relevant"
    },
    {
      "Time_Start": 266.44,
      "Time_End": 268.58,
      "Text": " to defend against in my environment."
    },
    {
      "Time_Start": 268.58,
      "Time_End": 274.88,
      "Text": " And similarly, even if I make a correct assumption about exactly what type, what subset of tradecraft"
    },
    {
      "Time_Start": 274.88,
      "Time_End": 280.68,
      "Text": " is going to be employed against me, I have to make assumptions about what type of telemetry"
    },
    {
      "Time_Start": 280.68,
      "Time_End": 283.4,
      "Text": " that tradecraft is likely to generate as well."
    },
    {
      "Time_Start": 283.4,
      "Time_End": 288.84,
      "Text": " Which is sometimes a more uncertain problem, sometimes a more certain problem, depending"
    },
    {
      "Time_Start": 288.84,
      "Time_End": 292.0,
      "Text": " on what type of telemetry source you're talking about."
    },
    {
      "Time_Start": 292.0,
      "Time_End": 300.3,
      "Text": " Similarly, attackers end up making assumptions about essentially the same sets of information"
    },
    {
      "Time_Start": 300.46000000000004,
      "Time_End": 305.06,
      "Text": " when they're deciding what type of tradecraft to adopt in the middle of an engagement or"
    },
    {
      "Time_Start": 305.06,
      "Time_End": 307.7,
      "Text": " operation or when they're building new tooling."
    },
    {
      "Time_Start": 307.7,
      "Time_End": 314.22,
      "Text": " And I look at tooling itself, any given particular offensive tool, as a prediction, just like"
    },
    {
      "Time_Start": 314.22,
      "Time_End": 317.46000000000004,
      "Text": " how I think of detection rules as predictions."
    },
    {
      "Time_Start": 317.46000000000004,
      "Time_End": 322.5,
      "Text": " And like I said, they make the same kind of sets of, they make assumptions about the same"
    },
    {
      "Time_Start": 322.5,
      "Time_End": 325.74,
      "Text": " types of problems, but they do so in reverse."
    },
    {
      "Time_Start": 325.74,
      "Time_End": 330.38,
      "Text": " So attackers are concerned with selecting tradecraft and tooling that is applicable"
    },
    {
      "Time_Start": 330.38,
      "Time_End": 335.46000000000004,
      "Text": " to a specific environment and which they think will achieve some specific objective that"
    },
    {
      "Time_Start": 335.46000000000004,
      "Time_End": 338.62,
      "Text": " they think is relevant to their operation."
    },
    {
      "Time_Start": 338.62,
      "Time_End": 343.66,
      "Text": " And they also seek to select tradecraft and tooling that's less likely to be detected"
    },
    {
      "Time_Start": 343.66,
      "Time_End": 350.1,
      "Text": " or prevented by security tooling, which requires assumptions about what can and cannot be observed"
    },
    {
      "Time_Start": 350.1,
      "Time_End": 354.22,
      "Text": " by the security products that are likely to be employed in the environments they're operating"
    },
    {
      "Time_Start": 354.22,
      "Time_End": 358.86,
      "Text": " in."
    },
    {
      "Time_Start": 358.86,
      "Time_End": 364.38000000000005,
      "Text": " But assumptions, as necessary as they are to making these types of predictions, they"
    },
    {
      "Time_Start": 364.38000000000005,
      "Time_End": 365.94000000000005,
      "Text": " suffer from uncertainty."
    },
    {
      "Time_Start": 365.94000000000005,
      "Time_End": 372.18,
      "Text": " And if we don't address uncertainty properly, if we don't make at least correct or defensible"
    },
    {
      "Time_Start": 372.18,
      "Time_End": 378.26000000000005,
      "Text": " assumptions when we're making our predictions, the tools and the detection rules that we"
    },
    {
      "Time_Start": 378.26000000000005,
      "Time_End": 383.1,
      "Text": " end up creating are going to be inaccurate."
    },
    {
      "Time_Start": 383.1,
      "Time_End": 389.26000000000005,
      "Text": " And as I was talking on the last slide, we're dealing with two main types of uncertainty."
    },
    {
      "Time_Start": 389.26000000000005,
      "Time_End": 394.66,
      "Text": " Uncertainty related to tradecraft, which in and of itself is a Herculean effort to just"
    },
    {
      "Time_Start": 394.66,
      "Time_End": 400.90000000000003,
      "Text": " identify what current tradecraft looks like, let alone in a specific environment at any"
    },
    {
      "Time_Start": 400.90000000000003,
      "Time_End": 404.90000000000003,
      "Text": " given time what type of tradecraft is likely to be employed."
    },
    {
      "Time_Start": 404.90000000000003,
      "Time_End": 411.06,
      "Text": " You know, threat reports are fantastic, but they're probably just a small portion of what"
    },
    {
      "Time_Start": 411.06,
      "Time_End": 416.54,
      "Text": " is currently being employed, let alone what is possible in general."
    },
    {
      "Time_Start": 416.54,
      "Time_End": 422.7,
      "Text": " Similarly, telemetry is a huge source of uncertainty for both attackers and defenders."
    },
    {
      "Time_Start": 422.7,
      "Time_End": 428.26,
      "Text": " A lot of the telemetry sources that we have in our IT environments are incredibly opaque."
    },
    {
      "Time_Start": 428.26,
      "Time_End": 433.58,
      "Text": " They're difficult to understand exactly how and why they log one action and don't log"
    },
    {
      "Time_Start": 433.58,
      "Time_End": 434.9,
      "Text": " another action."
    },
    {
      "Time_Start": 434.90000000000003,
      "Time_End": 442.58000000000004,
      "Text": " It's difficult to figure out if I were to call a specific API function or interact with"
    },
    {
      "Time_Start": 442.58000000000004,
      "Time_End": 447.14000000000004,
      "Text": " a specific secureable object, whether that will or will not generate telemetry as an"
    },
    {
      "Time_Start": 447.14000000000004,
      "Time_End": 448.14000000000004,
      "Text": " attacker."
    },
    {
      "Time_Start": 448.14000000000004,
      "Time_End": 452.32000000000005,
      "Text": " And if we really want to begin combating these sources of uncertainty, we have to start by"
    },
    {
      "Time_Start": 452.32000000000005,
      "Time_End": 456.94000000000005,
      "Text": " documenting currently known tradecraft in a way that is fundamentally comparative, as"
    },
    {
      "Time_Start": 456.94000000000005,
      "Time_End": 458.42,
      "Text": " I like to think about it."
    },
    {
      "Time_Start": 458.42,
      "Time_End": 462.74,
      "Text": " If we were to take all the tooling that implements a given technique, we need to have some basis"
    },
    {
      "Time_Start": 462.98,
      "Time_End": 469.34000000000003,
      "Text": " to consistently compare the differences and similarities between all the distinct procedures"
    },
    {
      "Time_Start": 469.34000000000003,
      "Time_End": 475.82,
      "Text": " for that technique to have any chance of predicting what future innovation, let alone coverage"
    },
    {
      "Time_Start": 475.82,
      "Time_End": 481.38,
      "Text": " for currently known tradecraft, might look like."
    },
    {
      "Time_Start": 481.38,
      "Time_End": 486.1,
      "Text": " And to help combat this uncertainty, I've developed a web application that I call Cartographer"
    },
    {
      "Time_Start": 486.1,
      "Time_End": 491.98,
      "Text": " that helps to predict possible procedures for a given technique to reduce, like I said,"
    },
    {
      "Time_Start": 491.98,
      "Time_End": 494.1,
      "Text": " both types of uncertainty."
    },
    {
      "Time_Start": 494.1,
      "Time_End": 499.22,
      "Text": " This web application is still in very early stages content-wise, but I've worked really,"
    },
    {
      "Time_Start": 499.22,
      "Time_End": 504.58000000000004,
      "Text": " really hard to tighten up the data model that it's built on top of to make sure that I am"
    },
    {
      "Time_Start": 504.58000000000004,
      "Time_End": 509.58000000000004,
      "Text": " covering the essentially important and essential pieces of information that you really want"
    },
    {
      "Time_Start": 509.58000000000004,
      "Time_End": 513.86,
      "Text": " to know about a given procedure for a given technique."
    },
    {
      "Time_Start": 513.86,
      "Time_End": 520.9,
      "Text": " As we'll see when I demo it, when I give you all access to the currently live version,"
    },
    {
      "Time_Start": 520.9,
      "Time_End": 524.5799999999999,
      "Text": " it's limited in the techniques that it covers."
    },
    {
      "Time_Start": 524.5799999999999,
      "Time_End": 529.74,
      "Text": " It's really one main example with a bunch of procedures outlined for that particular"
    },
    {
      "Time_Start": 529.74,
      "Time_End": 530.74,
      "Text": " technique."
    },
    {
      "Time_Start": 530.74,
      "Time_End": 535.3199999999999,
      "Text": " But the overall goal is to consider what is possible rather than what is just observed"
    },
    {
      "Time_Start": 535.3199999999999,
      "Time_End": 540.1,
      "Text": " when we're building detection rules, when we're selecting already existing offensive"
    },
    {
      "Time_Start": 540.1,
      "Time_End": 545.22,
      "Text": " tooling to use on an adversary simulation or red team engagement, or deciding when to"
    },
    {
      "Time_Start": 545.22,
      "Time_End": 550.1,
      "Text": " develop new tooling entirely."
    },
    {
      "Time_Start": 550.1,
      "Time_End": 554.72,
      "Text": " So let's go ahead and jump into the data model that underpins Cartographer."
    },
    {
      "Time_Start": 554.72,
      "Time_End": 558.9,
      "Text": " So tactics, techniques, and procedures has essentially become the de facto model for"
    },
    {
      "Time_Start": 558.9,
      "Time_End": 562.22,
      "Text": " describing tradecraft in the information security industry."
    },
    {
      "Time_Start": 562.22,
      "Time_End": 570.14,
      "Text": " But the issue here is not that TTPs are inaccurate or a bad model to use, but that they're fundamentally"
    },
    {
      "Time_Start": 570.14,
      "Time_End": 571.66,
      "Text": " categorical labels."
    },
    {
      "Time_Start": 571.66,
      "Time_End": 577.48,
      "Text": " They are not descriptive of the underlying actions that take place when you carry out"
    },
    {
      "Time_Start": 577.48,
      "Time_End": 579.52,
      "Text": " a specific procedure."
    },
    {
      "Time_Start": 579.52,
      "Time_End": 585.3000000000001,
      "Text": " And furthermore, there's no real clear definition of what a procedure actually is."
    },
    {
      "Time_Start": 585.3000000000001,
      "Time_End": 586.8000000000001,
      "Text": " Sometimes it's a tool."
    },
    {
      "Time_Start": 586.8000000000001,
      "Time_End": 590.28,
      "Text": " Sometimes it's a specific command with specific command line arguments."
    },
    {
      "Time_Start": 590.28,
      "Time_End": 595.16,
      "Text": " Sometimes it's just kind of a general narrative description of how you might approach a specific"
    },
    {
      "Time_Start": 595.16,
      "Time_End": 596.16,
      "Text": " technique."
    },
    {
      "Time_Start": 596.16,
      "Time_End": 602.6800000000001,
      "Text": " And this makes it extremely difficult to compare the distinctions between known procedures"
    },
    {
      "Time_Start": 602.6800000000001,
      "Time_End": 607.82,
      "Text": " for a given technique, let alone to say, I know when I've written a detection rule"
    },
    {
      "Time_Start": 607.82,
      "Time_End": 613.8000000000001,
      "Text": " that covers all the procedures for XYZ technique, or whether they're alternative implementations"
    },
    {
      "Time_Start": 613.8000000000001,
      "Time_End": 619.2,
      "Text": " of a technique that you want to execute while you're on a red team engagement."
    },
    {
      "Time_Start": 619.2,
      "Time_End": 625.22,
      "Text": " So in an attempt to provide some kind of widely applicable order to the TTP model, Cartographer"
    },
    {
      "Time_Start": 625.22,
      "Time_End": 631.86,
      "Text": " defines a procedure as an ordered set of operations that when combined achieve some specific outcome."
    },
    {
      "Time_Start": 632.04,
      "Time_End": 636.5,
      "Text": " So we can kind of see in this diagram here that if we move down from the tactic level"
    },
    {
      "Time_Start": 636.5,
      "Time_End": 640.3000000000001,
      "Text": " to the technique level, we have some number of distinct procedures."
    },
    {
      "Time_Start": 640.3000000000001,
      "Time_End": 647.7,
      "Text": " This is just a very small subset of the known distinct procedures for the technique shown"
    },
    {
      "Time_Start": 647.7,
      "Time_End": 649.62,
      "Text": " here, which is LSAS credential dumping."
    },
    {
      "Time_Start": 649.62,
      "Time_End": 654.78,
      "Text": " But what I want to bring your attention to is this very bottom row, which is the operations"
    },
    {
      "Time_Start": 654.78,
      "Time_End": 655.78,
      "Text": " layer."
    },
    {
      "Time_Start": 655.78,
      "Time_End": 661.4200000000001,
      "Text": " So if we look at, for instance, direct access and read implemented by the Mimikatz module"
    },
    {
      "Time_Start": 661.9799999999999,
      "Time_End": 667.8199999999999,
      "Text": " secure LSA logon passwords, what I like to think of as the canonical example of LSAS"
    },
    {
      "Time_Start": 667.8199999999999,
      "Time_End": 674.0999999999999,
      "Text": " credential dumping, we can see three operations here, enumeration of currently running processes,"
    },
    {
      "Time_Start": 674.0999999999999,
      "Time_End": 681.5799999999999,
      "Text": " access to LSAS.exe itself, and then actually reading from LSAS.exe virtual memory."
    },
    {
      "Time_Start": 681.5799999999999,
      "Time_End": 686.74,
      "Text": " So a definition of procedures that involves the word operations isn't very helpful unless"
    },
    {
      "Time_Start": 686.74,
      "Time_End": 689.3,
      "Text": " I also define operations for us."
    },
    {
      "Time_Start": 689.3000000000001,
      "Time_End": 693.9000000000001,
      "Text": " And I think of operations as an action that targets some object."
    },
    {
      "Time_Start": 693.9000000000001,
      "Time_End": 701.3000000000001,
      "Text": " And what this ends up amounting to is we have kind of a schematic or shorthand for what"
    },
    {
      "Time_Start": 701.3000000000001,
      "Time_End": 706.2600000000001,
      "Text": " an operation is that is a pair of an action targeting some object."
    },
    {
      "Time_Start": 706.2600000000001,
      "Time_End": 710.9000000000001,
      "Text": " And obviously these actions have to be specific and appropriate for the object that they act"
    },
    {
      "Time_Start": 710.9000000000001,
      "Time_End": 711.9000000000001,
      "Text": " on."
    },
    {
      "Time_Start": 711.9000000000001,
      "Time_End": 716.5400000000001,
      "Text": " We might be able to write to a registry key value, for instance, and we can transact to"
    },
    {
      "Time_Start": 716.5400000000001,
      "Time_End": 717.5400000000001,
      "Text": " a named pipe."
    },
    {
      "Time_Start": 717.74,
      "Time_End": 720.86,
      "Text": " But we can't really transact to a registry key value, right?"
    },
    {
      "Time_Start": 720.86,
      "Time_End": 721.86,
      "Text": " These don't make sense."
    },
    {
      "Time_Start": 721.86,
      "Time_End": 727.86,
      "Text": " So there is some kind of implicit order to this model of approaching operations that"
    },
    {
      "Time_Start": 727.86,
      "Time_End": 732.06,
      "Text": " build up into procedures to techniques to tactics."
    },
    {
      "Time_Start": 732.06,
      "Time_End": 737.42,
      "Text": " There's a good amount of more work to be done, in my opinion, as far as the way the data"
    },
    {
      "Time_Start": 737.42,
      "Time_End": 744.8199999999999,
      "Text": " model currently stands to really kind of establish an exhaustive list of these action and object"
    },
    {
      "Time_Start": 744.82,
      "Time_End": 748.94,
      "Text": " pairs and to kind of rule out some weird edge cases that pop up."
    },
    {
      "Time_Start": 748.94,
      "Time_End": 753.94,
      "Text": " For the most part, as far as the examples that I've covered so far while building out"
    },
    {
      "Time_Start": 753.94,
      "Time_End": 761.86,
      "Text": " Cartographer, this object's almost entirely referred to what Microsoft and Windows developers"
    },
    {
      "Time_Start": 761.86,
      "Time_End": 766.4200000000001,
      "Text": " consider a securable object that has stayed true for the most part."
    },
    {
      "Time_Start": 766.4200000000001,
      "Time_End": 771.6600000000001,
      "Text": " But there is kind of this lingering question in general of how deep down should we really"
    },
    {
      "Time_Start": 771.66,
      "Time_End": 777.3399999999999,
      "Text": " go when we say this particular action is representative of an operation?"
    },
    {
      "Time_Start": 777.3399999999999,
      "Time_End": 782.86,
      "Text": " For instance, obviously creating a file is an action object pair that is worthy of taking"
    },
    {
      "Time_Start": 782.86,
      "Time_End": 789.2199999999999,
      "Text": " note of as an operation that a given procedure has to implement, but what about parsing memory"
    },
    {
      "Time_Start": 789.2199999999999,
      "Time_End": 792.64,
      "Text": " bytes that are already placed in a buffer, right?"
    },
    {
      "Time_Start": 792.64,
      "Time_End": 794.78,
      "Text": " It's not really generating telemetry."
    },
    {
      "Time_Start": 794.78,
      "Time_End": 798.3,
      "Text": " It's all happening within the memory of the calling process where our tool is running"
    },
    {
      "Time_Start": 798.3000000000001,
      "Time_End": 804.7,
      "Text": " and, you know, the question still stands, and I think I'll find more examples that push"
    },
    {
      "Time_Start": 804.7,
      "Time_End": 809.1400000000001,
      "Text": " my definition of operations a bit more, but for now, you can think of objects largely"
    },
    {
      "Time_Start": 809.1400000000001,
      "Time_End": 813.1400000000001,
      "Text": " as securable objects as defined by Microsoft."
    },
    {
      "Time_Start": 813.1400000000001,
      "Time_End": 818.94,
      "Text": " And an operation is carried out by invoking some specific function, but there's rarely"
    },
    {
      "Time_Start": 818.94,
      "Time_End": 823.2600000000001,
      "Text": " only one functional path to carry out a given operation."
    },
    {
      "Time_Start": 823.2600000000001,
      "Time_End": 828.2600000000001,
      "Text": " So these are just a couple of very obvious kind of off the top of the head examples."
    },
    {
      "Time_Start": 828.26,
      "Time_End": 835.06,
      "Text": " We can call reg set value A to write a registry key value and create a file, create file W."
    },
    {
      "Time_Start": 835.06,
      "Time_End": 840.46,
      "Text": " We can open a handle to a process with calls like NT open process, but what's important"
    },
    {
      "Time_Start": 840.46,
      "Time_End": 845.56,
      "Text": " here is that everything above the operational layer, like I said, they're fundamentally"
    },
    {
      "Time_Start": 845.56,
      "Time_End": 850.58,
      "Text": " categorical labels, but they're not descriptive of the underlying actions that attack tooling"
    },
    {
      "Time_Start": 850.58,
      "Time_End": 856.58,
      "Text": " implements and functions really are where we define what is and is not possible and"
    },
    {
      "Time_Start": 856.58,
      "Time_End": 862.0200000000001,
      "Text": " offer us a concrete definition of what it means to create a file, for instance, and"
    },
    {
      "Time_Start": 862.0200000000001,
      "Time_End": 867.26,
      "Text": " is where the bulk of the analysis that goes into developing content for Cartographer and"
    },
    {
      "Time_Start": 867.26,
      "Time_End": 874.7,
      "Text": " in my opinion really defining what Tradecraft is actually occurs at that functional level."
    },
    {
      "Time_Start": 874.7,
      "Time_End": 883.1800000000001,
      "Text": " And real quickly, just a couple of observations I've made while building out content for Cartographer"
    },
    {
      "Time_Start": 883.3000000000001,
      "Time_End": 888.1400000000001,
      "Text": " is that tools that implement the same procedure often call different functions for a given"
    },
    {
      "Time_Start": 888.1400000000001,
      "Time_End": 894.1800000000001,
      "Text": " operation and these choices often have a direct impact on the telemetry that's generated by"
    },
    {
      "Time_Start": 894.1800000000001,
      "Time_End": 899.4200000000001,
      "Text": " a given tool or by a given procedure, and this is because a lot of especially native"
    },
    {
      "Time_Start": 899.4200000000001,
      "Time_End": 902.46,
      "Text": " logging occurs within the context of a specific function."
    },
    {
      "Time_Start": 902.46,
      "Time_End": 907.3000000000001,
      "Text": " There are function calls that are needed to, for instance, write to the Windows event log"
    },
    {
      "Time_Start": 907.3000000000001,
      "Time_End": 911.5000000000001,
      "Text": " to write data to an ETW provider."
    },
    {
      "Time_Start": 911.5000000000001,
      "Time_End": 915.1400000000001,
      "Text": " These happen in the context of a specific function."
    },
    {
      "Time_Start": 915.1400000000001,
      "Time_End": 922.4200000000001,
      "Text": " The developers at Microsoft who wrote the read virtual memory function as it's defined"
    },
    {
      "Time_Start": 922.4200000000001,
      "Time_End": 927.22,
      "Text": " internally within the Windows operating system had to decide where to generate telemetry"
    },
    {
      "Time_Start": 927.22,
      "Time_End": 934.1800000000001,
      "Text": " and similarly, as the last talk mentioned, EDR providers, for instance, using function"
    },
    {
      "Time_Start": 934.1800000000001,
      "Time_End": 939.58,
      "Text": " hooking and kernel callbacks, those are also scoped to specific functions as well."
    },
    {
      "Time_Start": 939.58,
      "Time_End": 944.3800000000001,
      "Text": " And a really big takeaway that I hope you all remember walking away from this talk is"
    },
    {
      "Time_Start": 944.3800000000001,
      "Time_End": 948.1800000000001,
      "Text": " that some operations are fundamentally more important than others."
    },
    {
      "Time_Start": 948.1800000000001,
      "Time_End": 954.1800000000001,
      "Text": " And when I was talking earlier about that cyclical innovation between attackers and"
    },
    {
      "Time_Start": 954.1800000000001,
      "Time_End": 961.22,
      "Text": " defenders where innovation is almost always a response to some action from the other side,"
    },
    {
      "Time_Start": 961.22,
      "Time_End": 967.74,
      "Text": " we see this cyclical innovation kind of center around specific operations within a given"
    },
    {
      "Time_Start": 967.74,
      "Time_End": 971.1,
      "Text": " procedure or within a given technique over time."
    },
    {
      "Time_Start": 971.1,
      "Time_End": 976.22,
      "Text": " And when we write detection rules that we often kind of name or describe as targeting"
    },
    {
      "Time_Start": 976.22,
      "Time_End": 983.0400000000001,
      "Text": " a technique, what we're really doing is targeting specific operations within specific procedures"
    },
    {
      "Time_Start": 983.0400000000001,
      "Time_End": 984.0400000000001,
      "Text": " for that technique."
    },
    {
      "Time_Start": 984.0400000000001,
      "Time_End": 989.14,
      "Text": " And I'm going to go through an example here where we can kind of see these observations"
    },
    {
      "Time_Start": 989.14,
      "Time_End": 990.14,
      "Text": " play out."
    },
    {
      "Time_Start": 990.14,
      "Time_End": 994.62,
      "Text": " And there's a lot of other very well-known techniques where we see these observations"
    },
    {
      "Time_Start": 994.62,
      "Time_End": 996.14,
      "Text": " play out as well."
    },
    {
      "Time_Start": 996.14,
      "Time_End": 1000.38,
      "Text": " But I chose to talk about LSAS credential dumping today because I think it's generally"
    },
    {
      "Time_Start": 1000.38,
      "Time_End": 1002.02,
      "Text": " very, very well understood."
    },
    {
      "Time_Start": 1002.02,
      "Time_End": 1008.02,
      "Text": " There's a lot of tooling that can be deemed as LSAS credential dumping, but I'm going"
    },
    {
      "Time_Start": 1008.02,
      "Time_End": 1013.1,
      "Text": " to take two really well-known distinct procedures for this technique and dive into those a little"
    },
    {
      "Time_Start": 1013.1,
      "Time_End": 1019.58,
      "Text": " bit to show you kind of how Cartographer actually represents a given procedure for"
    },
    {
      "Time_Start": 1019.58,
      "Time_End": 1020.58,
      "Text": " a technique."
    },
    {
      "Time_Start": 1020.58,
      "Time_End": 1025.54,
      "Text": " So the first one is what I like to think of as direct open and read."
    },
    {
      "Time_Start": 1025.54,
      "Time_End": 1031.34,
      "Text": " This is represented by, again, my canonical example of LSAS credential dumping, MimiCat's"
    },
    {
      "Time_Start": 1031.34,
      "Time_End": 1034.78,
      "Text": " secure LSA logon passwords module."
    },
    {
      "Time_Start": 1034.78,
      "Time_End": 1040.66,
      "Text": " Even if this isn't employed a lot in the wild anymore due to modern LSA protections, it's"
    },
    {
      "Time_Start": 1040.66,
      "Time_End": 1042.42,
      "Text": " still a good example nonetheless."
    },
    {
      "Time_Start": 1042.74,
      "Time_End": 1044.74,
      "Text": " And I hope I can prove that point to you here."
    },
    {
      "Time_Start": 1044.74,
      "Time_End": 1048.5800000000002,
      "Text": " The second procedure I want to talk about is handle duplication."
    },
    {
      "Time_Start": 1048.5800000000002,
      "Time_End": 1054.1000000000001,
      "Text": " So instead of directly opening a handle to the running lsas.exe process, we can attempt"
    },
    {
      "Time_Start": 1054.1000000000001,
      "Time_End": 1058.6000000000001,
      "Text": " to find another process that already has a handle that's open to it and use that instead."
    },
    {
      "Time_Start": 1058.6000000000001,
      "Time_End": 1061.22,
      "Text": " Duplicate that handle and use that instead."
    },
    {
      "Time_Start": 1061.22,
      "Time_End": 1065.64,
      "Text": " So if we dive into the first procedure here, direct open and read memory, there's really"
    },
    {
      "Time_Start": 1065.64,
      "Time_End": 1070.5800000000002,
      "Text": " three core operations that have to take place and do take place."
    },
    {
      "Time_Start": 1070.74,
      "Time_End": 1075.58,
      "Text": " Particularly the MimiCat's implementation of this procedure, but also many other tools"
    },
    {
      "Time_Start": 1075.58,
      "Time_End": 1077.5,
      "Text": " implementation as well."
    },
    {
      "Time_Start": 1077.5,
      "Time_End": 1083.22,
      "Text": " First is enumerating currently open processes to obtain the process ID for lsas.exe."
    },
    {
      "Time_Start": 1083.22,
      "Time_End": 1088.58,
      "Text": " We need that value to call functions like open process, for instance, which is what"
    },
    {
      "Time_Start": 1088.58,
      "Time_End": 1094.98,
      "Text": " MimiCat's calls, to open a handle to lsas.exe with the necessary access rights."
    },
    {
      "Time_Start": 1094.98,
      "Time_End": 1098.58,
      "Text": " And that necessary access rights is a really, really important part, and we're going to"
    },
    {
      "Time_Start": 1098.58,
      "Time_End": 1100.6999999999998,
      "Text": " see why here in just a second."
    },
    {
      "Time_Start": 1100.6999999999998,
      "Time_End": 1106.48,
      "Text": " But there's some very specific, if you're familiar with how DACLs work or security descriptors"
    },
    {
      "Time_Start": 1106.48,
      "Time_End": 1111.54,
      "Text": " in general work for secureable objects in Windows, you'll be very aware of kind of this"
    },
    {
      "Time_Start": 1111.54,
      "Time_End": 1117.1,
      "Text": " idea that if I want to take some specific action on a secureable object in the Windows"
    },
    {
      "Time_Start": 1117.1,
      "Time_End": 1121.62,
      "Text": " operating system, I'm going to have to plan ahead and make sure that the handle I have"
    },
    {
      "Time_Start": 1121.62,
      "Time_End": 1125.4199999999998,
      "Text": " to that object in this case has the necessary access rights."
    },
    {
      "Time_Start": 1125.42,
      "Time_End": 1130.46,
      "Text": " And once I do have that handle with the correct access rights, I go ahead and call my memory"
    },
    {
      "Time_Start": 1130.46,
      "Time_End": 1135.66,
      "Text": " read functions, whether that be mini dump, write dump, or read virtual memory or some"
    },
    {
      "Time_Start": 1135.66,
      "Time_End": 1137.98,
      "Text": " alternative."
    },
    {
      "Time_Start": 1137.98,
      "Time_End": 1143.5800000000002,
      "Text": " To detail the second distinct procedure, actually duplicating handles instead of directly opening"
    },
    {
      "Time_Start": 1143.5800000000002,
      "Time_End": 1148.8600000000001,
      "Text": " a handle to lsas.exe, it gets a bit more complicated, but you'll see it ends up in exactly the same"
    },
    {
      "Time_Start": 1148.8600000000001,
      "Time_End": 1149.8600000000001,
      "Text": " place."
    },
    {
      "Time_Start": 1149.8600000000001,
      "Time_End": 1153.5800000000002,
      "Text": " So instead of enumerating open processes, we're just going to enumerate currently open"
    },
    {
      "Time_Start": 1153.58,
      "Time_End": 1158.6999999999998,
      "Text": " handles to identify a handle that in the case of the tooling that I observed, identify"
    },
    {
      "Time_Start": 1158.6999999999998,
      "Time_End": 1162.74,
      "Text": " a handle with process VM read access rights assigned to it."
    },
    {
      "Time_Start": 1162.74,
      "Time_End": 1169.3799999999999,
      "Text": " This may not be true in all cases, it's more of a down select than a necessary to immediately"
    },
    {
      "Time_Start": 1169.3799999999999,
      "Time_End": 1174.26,
      "Text": " look for handles that have this process VM read access right assigned to them."
    },
    {
      "Time_Start": 1174.26,
      "Time_End": 1177.46,
      "Text": " It's somewhat rare to have this."
    },
    {
      "Time_Start": 1177.46,
      "Time_End": 1181.4199999999998,
      "Text": " So it's just a good down select to build into your tooling."
    },
    {
      "Time_Start": 1181.42,
      "Time_End": 1186.02,
      "Text": " Then we're going to open a handle to the process that has that interesting handle open."
    },
    {
      "Time_Start": 1186.02,
      "Time_End": 1188.74,
      "Text": " Again, we don't know that handle points to lsas."
    },
    {
      "Time_Start": 1188.74,
      "Time_End": 1195.1000000000001,
      "Text": " So we first have to duplicate that handle while specifying the correct access rights."
    },
    {
      "Time_Start": 1195.1000000000001,
      "Time_End": 1201.18,
      "Text": " And then actually make sure that it points to lsas.exe because the way that we enumerate"
    },
    {
      "Time_Start": 1201.18,
      "Time_End": 1207.66,
      "Text": " handles originally doesn't actually tell us where that handle points to until we query"
    },
    {
      "Time_Start": 1207.66,
      "Time_End": 1209.3400000000001,
      "Text": " that handle directly."
    },
    {
      "Time_Start": 1209.34,
      "Time_End": 1213.82,
      "Text": " I think it's ntqueryobject is the call that a lot of tooling makes."
    },
    {
      "Time_Start": 1213.82,
      "Time_End": 1219.22,
      "Text": " And then if all is good with that handle that we've now duplicated, we're just going to"
    },
    {
      "Time_Start": 1219.22,
      "Time_End": 1224.3799999999999,
      "Text": " go ahead and pass it back to those same memory read functions that we called in the MimiCAD"
    },
    {
      "Time_Start": 1224.3799999999999,
      "Time_End": 1229.8999999999999,
      "Text": " supplementation of this technique, whether that be mini dump or something else."
    },
    {
      "Time_Start": 1229.8999999999999,
      "Time_End": 1233.78,
      "Text": " And if we kind of compare and contrast the differences between these procedures, I think"
    },
    {
      "Time_Start": 1233.78,
      "Time_End": 1238.34,
      "Text": " this is where this notion of operations becomes really, really helpful."
    },
    {
      "Time_Start": 1238.34,
      "Time_End": 1246.1799999999998,
      "Text": " Because we can very clearly see that really what's changed here is we're not A, we're"
    },
    {
      "Time_Start": 1246.1799999999998,
      "Time_End": 1249.58,
      "Text": " not directly opening a handle to lsas.exe."
    },
    {
      "Time_Start": 1249.58,
      "Time_End": 1253.86,
      "Text": " That's the really, really big one because that's heavily signatured."
    },
    {
      "Time_Start": 1253.86,
      "Time_End": 1259.02,
      "Text": " There's a ton of open source detection strategies out there for handles that have that access"
    },
    {
      "Time_Start": 1259.02,
      "Time_End": 1263.06,
      "Text": " right that point to lsas.exe."
    },
    {
      "Time_Start": 1263.06,
      "Time_End": 1268.06,
      "Text": " But we can also start to think about from the offensive side of things, exactly what"
    },
    {
      "Time_Start": 1268.06,
      "Time_End": 1269.94,
      "Text": " is possible for us."
    },
    {
      "Time_Start": 1269.94,
      "Time_End": 1276.22,
      "Text": " If I'm interested in credential material that's resident in the virtual memory of lsas.exe,"
    },
    {
      "Time_Start": 1276.22,
      "Time_End": 1281.62,
      "Text": " by really thinking through operations, I can not only decide what's appropriate to employ"
    },
    {
      "Time_Start": 1281.62,
      "Time_End": 1287.62,
      "Text": " on a given assessment, but also to kind of think through what future innovation might"
    },
    {
      "Time_Start": 1287.62,
      "Time_End": 1292.74,
      "Text": " look like, whether it's worth the trouble for me to maybe look for additional implementations"
    },
    {
      "Time_Start": 1292.74,
      "Time_End": 1295.26,
      "Text": " of this technique as a developer."
    },
    {
      "Time_Start": 1295.46,
      "Time_End": 1300.3799999999999,
      "Text": " And this is, in my opinion, an interesting diagram because if we kind of start at the"
    },
    {
      "Time_Start": 1300.3799999999999,
      "Time_End": 1305.74,
      "Text": " middle with direct access and read, remember that Mimikatz came out in I believe 2010,"
    },
    {
      "Time_Start": 1305.74,
      "Time_End": 1308.02,
      "Text": " 2011, something like that."
    },
    {
      "Time_Start": 1308.02,
      "Time_End": 1314.74,
      "Text": " And so we've had over a decade of innovation on LSAS credential dumping procedures."
    },
    {
      "Time_Start": 1314.74,
      "Time_End": 1321.94,
      "Text": " And what we've seen is both on the offensive and defensive side, a lot of focus on that"
    },
    {
      "Time_Start": 1321.94,
      "Time_End": 1326.1000000000001,
      "Text": " handle acquisition, actually getting that handle to lsas.exe."
    },
    {
      "Time_Start": 1326.1000000000001,
      "Time_End": 1331.8600000000001,
      "Text": " On the defensive side of things, things like LSA protections, you can see on the left-hand"
    },
    {
      "Time_Start": 1331.8600000000001,
      "Time_End": 1338.7,
      "Text": " side of this, the arrow pointing to run as PPL, where as of Windows 10, Microsoft now"
    },
    {
      "Time_Start": 1338.7,
      "Time_End": 1344.5,
      "Text": " gives you the option to have LSAS run as what they call protected process light, which kind"
    },
    {
      "Time_Start": 1344.5,
      "Time_End": 1351.38,
      "Text": " of ups the requirements, not to kind of avoid some of the details here, to actually get"
    },
    {
      "Time_Start": 1351.38,
      "Time_End": 1357.3000000000002,
      "Text": " a handle to lsas.exe, let alone things like credential guard, which make dumping LSAS"
    },
    {
      "Time_Start": 1357.3000000000002,
      "Time_End": 1361.22,
      "Text": " memory itself kind of not very fruitful."
    },
    {
      "Time_Start": 1361.22,
      "Time_End": 1368.8200000000002,
      "Text": " But on the right side of this, we can also see from the detection strategy side of things,"
    },
    {
      "Time_Start": 1368.8200000000002,
      "Time_End": 1375.18,
      "Text": " we see a lot of detections focused on, like I said, the opening of that handle to lsas.exe"
    },
    {
      "Time_Start": 1375.18,
      "Time_End": 1377.22,
      "Text": " with specific access rights."
    },
    {
      "Time_Start": 1377.22,
      "Time_End": 1382.1000000000001,
      "Text": " And to give a little bit more context here, all the blue circles are either protective"
    },
    {
      "Time_Start": 1382.1000000000001,
      "Time_End": 1387.5,
      "Text": " controls or detection strategies, and all the red circles represent distinct procedures"
    },
    {
      "Time_Start": 1387.5,
      "Time_End": 1389.18,
      "Text": " for LSAS credential dumping."
    },
    {
      "Time_Start": 1389.18,
      "Time_End": 1397.3600000000001,
      "Text": " And we can kind of see over time that a lot of tooling spawns out of exactly what defenders"
    },
    {
      "Time_Start": 1397.3600000000001,
      "Time_End": 1401.58,
      "Text": " are doing at any given time, whether that means protective controls that Microsoft provides"
    },
    {
      "Time_Start": 1401.58,
      "Time_End": 1409.74,
      "Text": " for us, or just detections that defenders are employing in their environments in general."
    },
    {
      "Time_Start": 1409.74,
      "Time_End": 1414.3,
      "Text": " And you know, like I said, more than a decade later, we now have tooling like NanoDump that"
    },
    {
      "Time_Start": 1414.3,
      "Time_End": 1420.6999999999998,
      "Text": " makes it extremely easy to be very selective about what types of operations we actually"
    },
    {
      "Time_Start": 1420.6999999999998,
      "Time_End": 1424.8999999999999,
      "Text": " use when carrying out a given procedure or technique."
    },
    {
      "Time_Start": 1424.8999999999999,
      "Time_End": 1429.6599999999999,
      "Text": " You can kind of see here, I've drawn little arrows here at all these Boolean values."
    },
    {
      "Time_Start": 1429.66,
      "Time_End": 1435.14,
      "Text": " These are actually all command line arguments that you can supply to NanoDump that will"
    },
    {
      "Time_Start": 1435.14,
      "Time_End": 1438.98,
      "Text": " change how we actually acquire a handle to LSAS."
    },
    {
      "Time_Start": 1438.98,
      "Time_End": 1447.1000000000001,
      "Text": " All of these input arguments actually lead to just calling minidump writedump."
    },
    {
      "Time_Start": 1447.1000000000001,
      "Time_End": 1450.1000000000001,
      "Text": " But it's a matter of how we get that handle."
    },
    {
      "Time_Start": 1450.1000000000001,
      "Time_End": 1458.42,
      "Text": " And it's really just kind of amazing how this stuff kind of snowballs over time, where it's"
    },
    {
      "Time_Start": 1458.66,
      "Time_End": 1464.18,
      "Text": " just kind of piecemeal, defenders make a change, attackers respond, and vice versa."
    },
    {
      "Time_Start": 1464.18,
      "Time_End": 1471.5800000000002,
      "Text": " And then eventually it all comes together into these very easy to use packages like NanoDump."
    },
    {
      "Time_Start": 1471.5800000000002,
      "Time_End": 1478.26,
      "Text": " And so I've talked a lot about distinct procedures as a consequence of, you know, some set of"
    },
    {
      "Time_Start": 1478.26,
      "Time_End": 1482.42,
      "Text": " operations that a tool might implement, right?"
    },
    {
      "Time_Start": 1482.42,
      "Time_End": 1490.6200000000001,
      "Text": " And I've talked about kind of variance between procedures in terms of they implement a different"
    },
    {
      "Time_Start": 1490.6200000000001,
      "Time_End": 1493.18,
      "Text": " ordered set of operations."
    },
    {
      "Time_Start": 1493.18,
      "Time_End": 1497.96,
      "Text": " But I haven't talked too much about for a given operation within a procedure, how they"
    },
    {
      "Time_Start": 1497.96,
      "Time_End": 1499.22,
      "Text": " might vary."
    },
    {
      "Time_Start": 1499.22,
      "Time_End": 1507.66,
      "Text": " And we have two main types of resources that represent this intra-operation variation or"
    },
    {
      "Time_Start": 1507.66,
      "Time_End": 1508.9,
      "Text": " evasion."
    },
    {
      "Time_Start": 1508.9,
      "Time_End": 1514.3400000000001,
      "Text": " First is function maps that show the callable and internal functions that can be used to"
    },
    {
      "Time_Start": 1514.3400000000001,
      "Time_End": 1515.8000000000002,
      "Text": " carry out an operation."
    },
    {
      "Time_Start": 1515.8000000000002,
      "Time_End": 1521.3400000000001,
      "Text": " So this is really kind of showing what is possible, not necessarily what is observed"
    },
    {
      "Time_Start": 1521.3400000000001,
      "Time_End": 1524.02,
      "Text": " in currently known toolings at the functional level."
    },
    {
      "Time_Start": 1524.02,
      "Time_End": 1528.5,
      "Text": " This does both of these actually involve a lot of manual reverse engineering work to"
    },
    {
      "Time_Start": 1528.5,
      "Time_End": 1529.5400000000002,
      "Text": " put together."
    },
    {
      "Time_Start": 1529.5400000000002,
      "Time_End": 1534.74,
      "Text": " So while you will see an operational breakdown for every procedure covered in Cartographer,"
    },
    {
      "Time_Start": 1534.74,
      "Time_End": 1540.7,
      "Text": " not every operation is necessarily going to have a function map and or an abstraction"
    },
    {
      "Time_Start": 1540.7,
      "Time_End": 1541.7,
      "Text": " map."
    },
    {
      "Time_Start": 1541.7,
      "Time_End": 1546.26,
      "Text": " And if function maps are kind of designed to show all the possible functional paths,"
    },
    {
      "Time_Start": 1546.26,
      "Time_End": 1550.74,
      "Text": " as I like to think of them, that can be used to implement an operation, an abstraction"
    },
    {
      "Time_Start": 1550.74,
      "Time_End": 1558.38,
      "Text": " map shows how those decisions impact operating system components essentially."
    },
    {
      "Time_Start": 1558.38,
      "Time_End": 1560.94,
      "Text": " So this is what a function map looks like."
    },
    {
      "Time_Start": 1560.94,
      "Time_End": 1568.04,
      "Text": " This one in particular is discussing or showing all of the different ways that a developer"
    },
    {
      "Time_Start": 1568.04,
      "Time_End": 1574.6200000000001,
      "Text": " can write values to a or write data to a registry key value."
    },
    {
      "Time_Start": 1574.6200000000001,
      "Time_End": 1578.14,
      "Text": " And all the circles in red are callable from user land."
    },
    {
      "Time_Start": 1578.14,
      "Time_End": 1584.42,
      "Text": " And all of the circles in black are internal functions or not callable from user land functions."
    },
    {
      "Time_Start": 1584.42,
      "Time_End": 1589.7,
      "Text": " And what's really important to take away here is that even if you start way over on the"
    },
    {
      "Time_Start": 1589.7,
      "Time_End": 1596.44,
      "Text": " left in the Win32 API space, you're eventually going to traverse this entire hierarchy down"
    },
    {
      "Time_Start": 1596.44,
      "Time_End": 1602.46,
      "Text": " to the syscall level in this particular case."
    },
    {
      "Time_Start": 1602.46,
      "Time_End": 1607.82,
      "Text": " And just a quick note about how functions kind of work in Windows, specifically how"
    },
    {
      "Time_Start": 1607.82,
      "Time_End": 1613.24,
      "Text": " Win32 API functions work, but Windows actually provides us a whole hierarchy of functions"
    },
    {
      "Time_Start": 1613.24,
      "Time_End": 1619.36,
      "Text": " to abstract away all the messy, ugly bits of how the operating system interacts with"
    },
    {
      "Time_Start": 1619.36,
      "Time_End": 1622.24,
      "Text": " kind of kernel objects under the hood."
    },
    {
      "Time_Start": 1622.24,
      "Time_End": 1628.24,
      "Text": " And this kind of diagram here isn't exhaustive of all of the paths that you could take in"
    },
    {
      "Time_Start": 1628.24,
      "Time_End": 1634.28,
      "Text": " terms of the different types of functions that are callable or not callable in Windows."
    },
    {
      "Time_Start": 1634.28,
      "Time_End": 1637.96,
      "Text": " But generally we do see this progression from Win32 API."
    },
    {
      "Time_Start": 1637.96,
      "Time_End": 1641.56,
      "Text": " Some Win32 API functions have IPC mechanisms."
    },
    {
      "Time_Start": 1641.56,
      "Time_End": 1648.8799999999999,
      "Text": " So for instance, RPC procedure calls is super-duper common, ALPC, just to name a couple, COM probably"
    },
    {
      "Time_Start": 1648.8799999999999,
      "Time_End": 1652.72,
      "Text": " fits in the definition of an IPC mechanism as well."
    },
    {
      "Time_Start": 1652.72,
      "Time_End": 1659.9199999999998,
      "Text": " Down to native API calls, so your API functions that start with things like NT or ZW are native"
    },
    {
      "Time_Start": 1659.9199999999998,
      "Time_End": 1666.32,
      "Text": " APIs, which are often essentially just wrappers around syscalls."
    },
    {
      "Time_Start": 1666.32,
      "Time_End": 1671.6,
      "Text": " And what's really important here is that attackers have to make a decision somewhere"
    },
    {
      "Time_Start": 1671.6,
      "Time_End": 1672.8799999999999,
      "Text": " in this hierarchy."
    },
    {
      "Time_Start": 1672.8799999999999,
      "Time_End": 1677.56,
      "Text": " And that decision may have trade-offs, both in terms of telemetry and in terms of these"
    },
    {
      "Time_Start": 1677.56,
      "Time_End": 1685.0,
      "Text": " specific secureable objects that their tools end up interacting with, which I talked a"
    },
    {
      "Time_Start": 1685.0,
      "Time_End": 1689.8,
      "Text": " bit about telemetry within the context of a specific function, but there's also telemetry"
    },
    {
      "Time_Start": 1689.8,
      "Time_End": 1693.72,
      "Text": " in the context of specific objects as well."
    },
    {
      "Time_Start": 1693.72,
      "Time_End": 1698.24,
      "Text": " And tracing the way that known tooling enters into this hierarchy and what happens after"
    },
    {
      "Time_Start": 1698.24,
      "Time_End": 1703.16,
      "Text": " these function calls actually allows us to map out what is possible rather than just"
    },
    {
      "Time_Start": 1703.16,
      "Time_End": 1706.28,
      "Text": " what is known."
    },
    {
      "Time_Start": 1706.28,
      "Time_End": 1710.84,
      "Text": " And so to kind of give an example, so this is a very contrived example."
    },
    {
      "Time_Start": 1710.84,
      "Time_End": 1717.24,
      "Text": " I just wanted to use the same function map, even though it's not super applicable in the"
    },
    {
      "Time_Start": 1717.24,
      "Time_End": 1720.44,
      "Text": " context of writing to a registry key value."
    },
    {
      "Time_Start": 1720.44,
      "Time_End": 1728.48,
      "Text": " But imagine we have one tool that might enter into this functional hierarchy or start their"
    },
    {
      "Time_Start": 1728.48,
      "Time_End": 1735.8400000000001,
      "Text": " functional path at the Win32 API, specifically a Win32 API exported from an API set in tool"
    },
    {
      "Time_Start": 1735.8400000000001,
      "Time_End": 1736.8400000000001,
      "Text": " one up there."
    },
    {
      "Time_Start": 1736.8400000000001,
      "Time_End": 1740.04,
      "Text": " We might have another tool that calls the native version of this API."
    },
    {
      "Time_Start": 1740.04,
      "Time_End": 1745.48,
      "Text": " Then we might have another tool that skips this operation entirely and has decided that"
    },
    {
      "Time_Start": 1745.48,
      "Time_End": 1751.28,
      "Text": " it can still achieve the same outcome or objective that these other tools do, but doesn't"
    },
    {
      "Time_Start": 1751.28,
      "Time_End": 1757.04,
      "Text": " have to call any of these functions."
    },
    {
      "Time_Start": 1757.04,
      "Time_End": 1760.72,
      "Text": " And remember a couple slides ago I talked about abstraction maps."
    },
    {
      "Time_Start": 1760.72,
      "Time_End": 1761.8,
      "Text": " This is what I meant."
    },
    {
      "Time_Start": 1761.8,
      "Time_End": 1766.8,
      "Text": " So an abstraction map, if function maps are meant to show everything that's possible from"
    },
    {
      "Time_Start": 1766.8,
      "Time_End": 1773.56,
      "Text": " a functional evasion level, these are meant to be a bit more about the consequences of"
    },
    {
      "Time_Start": 1773.56,
      "Time_End": 1775.28,
      "Text": " making specific function calls."
    },
    {
      "Time_Start": 1775.28,
      "Time_End": 1781.2,
      "Text": " So we can kind of see here on the left side, abstraction map will always have this structure"
    },
    {
      "Time_Start": 1781.2,
      "Time_End": 1786.0,
      "Text": " of functions, IPC mechanisms, network layer, and secureable objects."
    },
    {
      "Time_Start": 1786.0,
      "Time_End": 1790.6399999999999,
      "Text": " I grabbed this one for service creation because I think it does actually kind of prove the"
    },
    {
      "Time_Start": 1790.6399999999999,
      "Time_End": 1796.04,
      "Text": " utility of abstraction maps and kind of thinking of things in this term a little bit."
    },
    {
      "Time_Start": 1796.04,
      "Time_End": 1800.28,
      "Text": " But at the top row we have a list of tools."
    },
    {
      "Time_Start": 1800.28,
      "Time_End": 1808.48,
      "Text": " The developers of these tools have made specific choices about how they want to create a service."
    },
    {
      "Time_Start": 1808.48,
      "Time_End": 1812.96,
      "Text": " And if you're wondering, regedit is basically just a stand-in for any tool that decides"
    },
    {
      "Time_Start": 1812.96,
      "Time_End": 1817.6399999999999,
      "Text": " to jump straight down to the secureable object layer and just create that registry key and"
    },
    {
      "Time_Start": 1817.6399999999999,
      "Time_End": 1822.76,
      "Text": " the relevant values that represent a service on the Windows operating system."
    },
    {
      "Time_Start": 1822.76,
      "Time_End": 1829.84,
      "Text": " But nonetheless, what's interesting here and is not noted is that a lot of the logging,"
    },
    {
      "Time_Start": 1829.8400000000001,
      "Time_End": 1835.5200000000002,
      "Text": " the Windows event security logs that people use to actually know when a service created"
    },
    {
      "Time_Start": 1835.5200000000002,
      "Time_End": 1840.96,
      "Text": " actually happens in this RPC procedure that's here on the interprocess communication layer"
    },
    {
      "Time_Start": 1840.96,
      "Time_End": 1843.2800000000002,
      "Text": " of this abstraction map."
    },
    {
      "Time_Start": 1843.2800000000002,
      "Time_End": 1851.6000000000001,
      "Text": " And unless you have, for instance, SACL entries for new key creations on the services key,"
    },
    {
      "Time_Start": 1851.6000000000001,
      "Time_End": 1857.7200000000003,
      "Text": " you're not going to get those events or any events for registry key creation in this services"
    },
    {
      "Time_Start": 1857.72,
      "Time_End": 1863.6000000000001,
      "Text": " path necessarily unless you've decided to make sure that you have observability for"
    },
    {
      "Time_Start": 1863.6000000000001,
      "Time_End": 1865.0,
      "Text": " that particular thing."
    },
    {
      "Time_Start": 1865.0,
      "Time_End": 1870.92,
      "Text": " And you may notice this choke point highlighted on the bottom layer here."
    },
    {
      "Time_Start": 1870.92,
      "Time_End": 1875.88,
      "Text": " And I use this to identify essentially the highest layer of an abstraction map where"
    },
    {
      "Time_Start": 1875.88,
      "Time_End": 1878.16,
      "Text": " all known functional paths converge."
    },
    {
      "Time_Start": 1878.16,
      "Time_End": 1883.64,
      "Text": " So no matter how I want to create a service, I'm going to end up creating a registry key."
    },
    {
      "Time_Start": 1883.64,
      "Time_End": 1889.48,
      "Text": " There is under the hood, there is there there are some trickier ways because services are"
    },
    {
      "Time_Start": 1889.48,
      "Time_End": 1896.8000000000002,
      "Text": " actually tracked in the memory of the services.exe process, which is the RPC server for that"
    },
    {
      "Time_Start": 1896.8000000000002,
      "Time_End": 1902.6000000000001,
      "Text": " user land processes interact with to interact with the service control manager."
    },
    {
      "Time_Start": 1902.6000000000001,
      "Time_End": 1908.8400000000001,
      "Text": " But the idea here is that if we build our, our offensive tooling to jump straight to"
    },
    {
      "Time_Start": 1908.8400000000001,
      "Time_End": 1916.2800000000002,
      "Text": " choke points, that represents the most evasive way to interact with this procedure and similarly"
    },
    {
      "Time_Start": 1916.2800000000002,
      "Time_End": 1921.68,
      "Text": " on the defensive side of things, we jump straight if we focus our detection strategies on these"
    },
    {
      "Time_Start": 1921.68,
      "Time_End": 1927.7600000000002,
      "Text": " choke point layers, we have the best chance of essentially making what I like to call"
    },
    {
      "Time_Start": 1927.7600000000002,
      "Time_End": 1932.96,
      "Text": " a detection that's resilient to evasion attempts."
    },
    {
      "Time_Start": 1932.96,
      "Time_End": 1937.44,
      "Text": " So I'm going to talk real briefly about the present and future of Cartographer."
    },
    {
      "Time_Start": 1937.44,
      "Time_End": 1941.2,
      "Text": " So the web app is currently up, you can reach it at cartographer.run."
    },
    {
      "Time_Start": 1941.2,
      "Time_End": 1947.16,
      "Text": " I will say it's not very well formatted for mobile, I'm not much of a web developer, I'm"
    },
    {
      "Time_Start": 1947.16,
      "Time_End": 1949.72,
      "Text": " definitely not a mobile web developer."
    },
    {
      "Time_Start": 1949.72,
      "Time_End": 1952.3200000000002,
      "Text": " So I would recommend using a desktop."
    },
    {
      "Time_Start": 1952.3200000000002,
      "Time_End": 1958.88,
      "Text": " And it's really all it is, is a read only display of all of the data that I've included"
    },
    {
      "Time_Start": 1958.88,
      "Time_End": 1965.1200000000001,
      "Text": " and dumped into the database and this data model that I've been discussing that powers"
    },
    {
      "Time_Start": 1965.1200000000001,
      "Time_End": 1969.64,
      "Text": " Cartographer and really its current state is a preview."
    },
    {
      "Time_Start": 1969.64,
      "Time_End": 1974.92,
      "Text": " It's meant to just show you kind of how the data model works and what it looks like and"
    },
    {
      "Time_Start": 1974.92,
      "Time_End": 1979.8000000000002,
      "Text": " how we might want to represent and think about describing offensive tradecraft."
    },
    {
      "Time_Start": 1979.8000000000002,
      "Time_End": 1982.0000000000002,
      "Text": " There is a lot of future work planned."
    },
    {
      "Time_Start": 1982.0000000000002,
      "Time_End": 1986.5600000000002,
      "Text": " I do plan to open source hopefully by the end of the summer and actually start soliciting"
    },
    {
      "Time_Start": 1986.5600000000002,
      "Time_End": 1990.16,
      "Text": " contributions from other people in the community."
    },
    {
      "Time_Start": 1990.16,
      "Time_End": 1996.0800000000002,
      "Text": " I do have some hurdles to get through before that's really a feasible option just because"
    },
    {
      "Time_Start": 1996.0800000000002,
      "Time_End": 2003.8400000000001,
      "Text": " of the way that data is input into Cartographer currently and kind of the particularities"
    },
    {
      "Time_Start": 2003.8400000000001,
      "Time_End": 2007.8400000000001,
      "Text": " of the research methodology needed to really build out this content."
    },
    {
      "Time_Start": 2007.8400000000001,
      "Time_End": 2013.6000000000001,
      "Text": " But I do also want to build a lot more integrations, especially ones with currently existing projects"
    },
    {
      "Time_Start": 2013.6000000000001,
      "Time_End": 2018.48,
      "Text": " and repositories of information that cover telemetry relative to specific function calls."
    },
    {
      "Time_Start": 2018.56,
      "Time_End": 2023.04,
      "Text": " I know I said earlier my coworker Johnny Johnson's been working on a lot of this type of stuff"
    },
    {
      "Time_Start": 2023.04,
      "Time_End": 2028.88,
      "Text": " and I want to bring a lot of his work into Cartographer as kind of an automated integration"
    },
    {
      "Time_Start": 2028.88,
      "Time_End": 2035.52,
      "Text": " and enrichment whenever I put a new procedure into the database for the app."
    },
    {
      "Time_Start": 2035.52,
      "Time_End": 2041.76,
      "Text": " I also want to build out a lot more docs, blog material, video content, whatever it"
    },
    {
      "Time_Start": 2041.76,
      "Time_End": 2042.76,
      "Text": " may be."
    },
    {
      "Time_Start": 2042.76,
      "Time_End": 2047.4,
      "Text": " And like I said, I'm not a great web developer so I definitely want to make it a little bit"
    },
    {
      "Time_Start": 2047.4,
      "Time_End": 2049.32,
      "Text": " more pretty in the future."
    },
    {
      "Time_Start": 2049.32,
      "Time_End": 2053.0,
      "Text": " So there are some challenges to a lot of these roadmap items."
    },
    {
      "Time_Start": 2053.0,
      "Time_End": 2057.6,
      "Text": " Like I said, it's a very research intensive content."
    },
    {
      "Time_Start": 2057.6,
      "Time_End": 2065.8,
      "Text": " It involves a lot of tracing a Win32 API function call down to essentially the transition into"
    },
    {
      "Time_Start": 2065.8,
      "Time_End": 2066.8,
      "Text": " kernel mode."
    },
    {
      "Time_Start": 2066.8,
      "Time_End": 2074.6800000000003,
      "Text": " And this involves dealing with a lot of kind of very low level Windows internals concepts"
    },
    {
      "Time_Start": 2074.6800000000003,
      "Time_End": 2077.12,
      "Text": " and services and components."
    },
    {
      "Time_Start": 2077.12,
      "Time_End": 2081.12,
      "Text": " So for instance, a lot of Win32 APIs make RPC calls."
    },
    {
      "Time_Start": 2081.12,
      "Time_End": 2088.7799999999997,
      "Text": " There's a bit of a trick to reversing what RPC procedure is actually being called when,"
    },
    {
      "Time_Start": 2088.7799999999997,
      "Time_End": 2094.24,
      "Text": " for instance, there's a Win32 API called NDR client call which is responsible for actually"
    },
    {
      "Time_Start": 2094.24,
      "Time_End": 2101.12,
      "Text": " making RPC procedure calls and it has a very tricky and weird format of how it takes in"
    },
    {
      "Time_Start": 2101.12,
      "Time_End": 2106.56,
      "Text": " input arguments to determine what procedure is actually being called."
    },
    {
      "Time_Start": 2107.0,
      "Time_End": 2109.52,
      "Text": " There's also currently kind of a tricky input format."
    },
    {
      "Time_Start": 2109.52,
      "Time_End": 2114.2799999999997,
      "Text": " So the way Cartographer works is that all of the procedures that are defined in the"
    },
    {
      "Time_Start": 2114.2799999999997,
      "Time_End": 2122.04,
      "Text": " app are built out and input via YAML files which is a good way to keep content persistent"
    },
    {
      "Time_Start": 2122.04,
      "Time_End": 2128.36,
      "Text": " and to make sure that it's kind of human readable because I am building out each of all of the"
    },
    {
      "Time_Start": 2128.36,
      "Time_End": 2132.68,
      "Text": " data that you'll see here in a second for each of these procedures."
    },
    {
      "Time_Start": 2132.68,
      "Time_End": 2136.2799999999997,
      "Text": " But I did structure those YAML files in a very particular way."
    },
    {
      "Time_Start": 2136.28,
      "Time_End": 2140.52,
      "Text": " So I'm going to have to document really, really effectively in order to open source"
    },
    {
      "Time_Start": 2140.52,
      "Time_End": 2145.44,
      "Text": " and actually solicit more contributions from the community, which is a goal of mine, like"
    },
    {
      "Time_Start": 2145.44,
      "Time_End": 2147.92,
      "Text": " I said, hopefully by end of summer."
    },
    {
      "Time_Start": 2147.92,
      "Time_End": 2153.52,
      "Text": " And I mentioned this a little bit earlier, but there are a lot of very tricky data model"
    },
    {
      "Time_Start": 2153.52,
      "Time_End": 2158.5600000000004,
      "Text": " edge cases here, you know, functions, a lot of functions implement more than one operation"
    },
    {
      "Time_Start": 2158.5600000000004,
      "Time_End": 2159.5600000000004,
      "Text": " under the hood."
    },
    {
      "Time_Start": 2159.5600000000004,
      "Time_End": 2162.76,
      "Text": " So I was showing you the abstraction map for service creation."
    },
    {
      "Time_Start": 2162.76,
      "Time_End": 2168.92,
      "Text": " That's a great example of a procedure that there is essentially one function call create"
    },
    {
      "Time_Start": 2168.92,
      "Time_End": 2172.6000000000004,
      "Text": " service W that implements multiple operations under the hood."
    },
    {
      "Time_Start": 2172.6000000000004,
      "Time_End": 2180.76,
      "Text": " It not only creates the registry key that defines a service, but it also loads the record"
    },
    {
      "Time_Start": 2180.76,
      "Time_End": 2187.88,
      "Text": " that is responsible for recording that service into the service.exe process."
    },
    {
      "Time_Start": 2187.88,
      "Time_End": 2193.04,
      "Text": " There's also kind of a lot of lingering questions around how granular operations really should"
    },
    {
      "Time_Start": 2193.04,
      "Time_End": 2194.04,
      "Text": " be."
    },
    {
      "Time_Start": 2194.04,
      "Time_End": 2198.08,
      "Text": " I also mentioned this a little bit earlier with the example of obviously file creation"
    },
    {
      "Time_Start": 2198.08,
      "Time_End": 2203.2400000000002,
      "Text": " is a distinct operation, but is reading data you've already put into a buffer in memory"
    },
    {
      "Time_Start": 2203.2400000000002,
      "Time_End": 2207.44,
      "Text": " of the process that your tool is running in an operation?"
    },
    {
      "Time_Start": 2207.44,
      "Time_End": 2208.44,
      "Text": " Probably not."
    },
    {
      "Time_Start": 2208.44,
      "Time_End": 2213.04,
      "Text": " Is it significant as a challenge that tool developers have to think about, make choices"
    },
    {
      "Time_Start": 2213.04,
      "Time_End": 2214.7200000000003,
      "Text": " about and overcome?"
    },
    {
      "Time_Start": 2214.7200000000003,
      "Time_End": 2215.84,
      "Text": " Absolutely."
    },
    {
      "Time_Start": 2216.0,
      "Time_End": 2222.56,
      "Text": " If the goal here is to really describe what is distinct between procedures and offer a"
    },
    {
      "Time_Start": 2222.56,
      "Time_End": 2228.88,
      "Text": " way for defenders to think critically about where to build detections and how to build"
    },
    {
      "Time_Start": 2228.88,
      "Time_End": 2235.52,
      "Text": " detections and for attackers to select appropriate trade craft and determine when to develop"
    },
    {
      "Time_Start": 2235.52,
      "Time_End": 2240.2000000000003,
      "Text": " new tooling, maybe those things aren't super important."
    },
    {
      "Time_Start": 2240.44,
      "Time_End": 2246.5200000000004,
      "Text": " I'd like to represent them somewhere, but they're probably not operations."
    },
    {
      "Time_Start": 2246.5200000000004,
      "Time_End": 2249.1200000000003,
      "Text": " Some further reading, we have a lot of blog posts."
    },
    {
      "Time_Start": 2249.1200000000003,
      "Time_End": 2254.4,
      "Text": " All of these except for this last one are on the Specter Ops blog, but I do really love"
    },
    {
      "Time_Start": 2254.4,
      "Time_End": 2258.0000000000005,
      "Text": " Adam Chester's blog post about Mimikatz."
    },
    {
      "Time_Start": 2258.0000000000005,
      "Time_End": 2262.2000000000003,
      "Text": " He talks about SSP injection, which is covering Cartographer."
    },
    {
      "Time_Start": 2262.2000000000003,
      "Time_End": 2265.84,
      "Text": " I recommend this post primarily because I think the thought process that went through"
    },
    {
      "Time_Start": 2265.84,
      "Time_End": 2271.88,
      "Text": " it is really, really informative to the type of approach that I'm taking to trade craft"
    },
    {
      "Time_Start": 2271.88,
      "Time_End": 2272.88,
      "Text": " with Cartographer."
    },
    {
      "Time_Start": 2272.88,
      "Time_End": 2278.92,
      "Text": " And in the future, if you have questions and contributions about Cartographer, again, the"
    },
    {
      "Time_Start": 2278.92,
      "Time_End": 2282.96,
      "Text": " repo is not open source right now, but you can always DM me on Twitter."
    },
    {
      "Time_Start": 2282.96,
      "Time_End": 2284.56,
      "Text": " You can email me."
    },
    {
      "Time_Start": 2284.56,
      "Time_End": 2290.36,
      "Text": " And once that GitHub repo is public, you can talk to me there as well and submit issues."
    },
    {
      "Time_Start": 2290.36,
      "Time_End": 2297.2400000000002,
      "Text": " But now let's hop right into demo and forgive me if this is messy, just because I know we"
    },
    {
      "Time_Start": 2297.2400000000002,
      "Time_End": 2305.76,
      "Text": " have a split screen here, so I'm kind of like third person operating this web browser."
    },
    {
      "Time_Start": 2305.76,
      "Time_End": 2306.76,
      "Text": " So this is Cartographer."
    },
    {
      "Time_Start": 2306.76,
      "Time_End": 2308.6800000000003,
      "Text": " This is the homepage."
    },
    {
      "Time_Start": 2308.6800000000003,
      "Time_End": 2313.1600000000003,
      "Text": " Really the main view that you're going to be using is this library view."
    },
    {
      "Time_Start": 2313.1600000000003,
      "Time_End": 2314.6400000000003,
      "Text": " Very, very simple."
    },
    {
      "Time_Start": 2314.6400000000003,
      "Time_End": 2319.44,
      "Text": " You'll be confronted with a dropdown that wants you to select the technique."
    },
    {
      "Time_Start": 2319.52,
      "Time_End": 2323.48,
      "Text": " And once you do that, you'll see a number of distinct procedures for this technique"
    },
    {
      "Time_Start": 2323.48,
      "Time_End": 2324.96,
      "Text": " populated in this other."
    },
    {
      "Time_Start": 2324.96,
      "Time_End": 2330.64,
      "Text": " So let's go ahead and take a look at, again, the canonical example, direct open and read."
    },
    {
      "Time_Start": 2330.64,
      "Time_End": 2333.8,
      "Text": " Every procedure has a description."
    },
    {
      "Time_Start": 2333.8,
      "Time_End": 2338.84,
      "Text": " You also see all of the other procedures for this technique that Cartographer covers."
    },
    {
      "Time_Start": 2338.84,
      "Time_End": 2345.96,
      "Text": " Again, this is not exhaustive necessarily, but I'm really focused on depth over breadth"
    },
    {
      "Time_Start": 2345.96,
      "Time_End": 2348.4,
      "Text": " with this web application currently."
    },
    {
      "Time_Start": 2348.4,
      "Time_End": 2355.88,
      "Text": " And for every procedure, you can use this little dropdown to see all of the other procedures,"
    },
    {
      "Time_Start": 2355.88,
      "Time_End": 2361.32,
      "Text": " whether for this technique or for another one, that when we talked about those action"
    },
    {
      "Time_Start": 2361.32,
      "Time_End": 2367.84,
      "Text": " and object relationships that define an operation, it basically looks for every other operation"
    },
    {
      "Time_Start": 2367.84,
      "Time_End": 2372.28,
      "Text": " in any other procedure that has that same object and action operation."
    },
    {
      "Time_Start": 2373.0,
      "Time_End": 2379.7200000000003,
      "Text": " So you can get a sense of what other procedures are opening handles and for what purpose and"
    },
    {
      "Time_Start": 2379.7200000000003,
      "Time_End": 2383.6800000000003,
      "Text": " how."
    },
    {
      "Time_Start": 2383.6800000000003,
      "Time_End": 2388.0400000000004,
      "Text": " I've also gone, and this is all manual as well, gone out and pulled down a bunch of"
    },
    {
      "Time_Start": 2388.0400000000004,
      "Time_End": 2393.6400000000003,
      "Text": " detection rules and not only just provided information about them in terms of what telemetry"
    },
    {
      "Time_Start": 2393.6400000000003,
      "Time_End": 2398.88,
      "Text": " they use or which operation within this procedure they're targeting, but added some comments"
    },
    {
      "Time_Start": 2398.88,
      "Time_End": 2401.2000000000003,
      "Text": " here and there as well."
    },
    {
      "Time_Start": 2401.28,
      "Time_End": 2405.8,
      "Text": " And just some general detection notes, and these should probably just be called defensive"
    },
    {
      "Time_Start": 2405.8,
      "Time_End": 2410.92,
      "Text": " notes in general because I do also comment on protective controls relative to a given"
    },
    {
      "Time_Start": 2410.92,
      "Time_End": 2412.4,
      "Text": " procedure in here."
    },
    {
      "Time_Start": 2412.4,
      "Time_End": 2419.28,
      "Text": " But we can then scroll all the way down to operations and we can show details."
    },
    {
      "Time_Start": 2419.28,
      "Time_End": 2422.2400000000002,
      "Text": " And every operation is going to have a description."
    },
    {
      "Time_Start": 2422.2400000000002,
      "Time_End": 2427.2400000000002,
      "Text": " Some descriptions are more verbose and detailed than others, with some references related"
    },
    {
      "Time_Start": 2427.2400000000002,
      "Time_End": 2429.6800000000003,
      "Text": " to that operation in particular."
    },
    {
      "Time_Start": 2429.68,
      "Time_End": 2434.7599999999998,
      "Text": " And if we do have a function map, we have that here as well."
    },
    {
      "Time_Start": 2434.7599999999998,
      "Time_End": 2436.7599999999998,
      "Text": " And maybe I have one."
    },
    {
      "Time_Start": 2436.7599999999998,
      "Time_End": 2437.7599999999998,
      "Text": " Yes."
    },
    {
      "Time_Start": 2437.7599999999998,
      "Time_End": 2440.7999999999997,
      "Text": " And here's one with an abstraction map."
    },
    {
      "Time_Start": 2440.7999999999997,
      "Time_End": 2444.7599999999998,
      "Text": " Again, I included this abstraction map more as an example."
    },
    {
      "Time_Start": 2444.7599999999998,
      "Time_End": 2451.3199999999997,
      "Text": " You can kind of see here that in the case of kernel 32 reprocess memory or DBG help"
    },
    {
      "Time_Start": 2451.3199999999997,
      "Time_End": 2454.48,
      "Text": " mini dump write dump, it basically just makes this call."
    },
    {
      "Time_Start": 2454.48,
      "Time_End": 2458.24,
      "Text": " So the abstraction map isn't particularly informative here."
    },
    {
      "Time_Start": 2458.28,
      "Time_End": 2464.96,
      "Text": " But like I said, I don't think not every operation will have an abstraction map or a function"
    },
    {
      "Time_Start": 2464.96,
      "Time_End": 2471.2400000000002,
      "Text": " map, but I will try to include them where it seems relevant and useful and informative."
    }
  ]
}