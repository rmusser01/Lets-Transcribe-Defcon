{
  "segments": [
    {
      "Time_Start": 0.0,
      "Time_End": 13.0,
      "Text": "This text was transcribed using whisper model: large-v2\n\n Alright, so good morning ZivCon, today's presentation is I can see an apple behind your windows"
    },
    {
      "Time_Start": 13.0,
      "Time_End": 16.36,
      "Text": " red teaming macOS environments."
    },
    {
      "Time_Start": 16.36,
      "Time_End": 22.080000000000002,
      "Text": " My name is Wojciech Regula and I'm a head of mobile security at Securing, I'm mostly"
    },
    {
      "Time_Start": 22.080000000000002,
      "Time_End": 29.0,
      "Text": " focused on iOS and macOS application security, I also run a blog in my free time, that's"
    },
    {
      "Time_Start": 29.0,
      "Time_End": 34.16,
      "Text": " of course about Apple security, so if you'd like to read some more about it, feel free"
    },
    {
      "Time_Start": 34.16,
      "Time_End": 40.0,
      "Text": " to visit it, the link is on the slide, somebody of you may also know me from iOS security"
    },
    {
      "Time_Start": 40.0,
      "Time_End": 47.400000000000006,
      "Text": " suite that I'm an author of, iOS security suite is a free swift open source library"
    },
    {
      "Time_Start": 47.400000000000006,
      "Time_End": 55.84,
      "Text": " that helps you making sure that your application is run on a secure iPhone or iPad, and recently"
    },
    {
      "Time_Start": 55.84,
      "Time_End": 61.800000000000004,
      "Text": " like for one year we've started in securing a new service that is a macOS environment"
    },
    {
      "Time_Start": 61.800000000000004,
      "Time_End": 68.80000000000001,
      "Text": " security verification, and on the right of the slide you can see the conferences that"
    },
    {
      "Time_Start": 68.80000000000001,
      "Time_End": 72.64,
      "Text": " I attended in the past."
    },
    {
      "Time_Start": 72.64,
      "Time_End": 79.80000000000001,
      "Text": " Alright so, when I was creating this talk I had an idea in my mind to provide a presentation"
    },
    {
      "Time_Start": 79.80000000000001,
      "Time_End": 85.44,
      "Text": " about macOS red teaming that is like a typical red teaming presentation, I'd like after this"
    },
    {
      "Time_Start": 85.44,
      "Time_End": 93.44,
      "Text": " talk to have in your minds a feeling that, oh, that's the very same attack scenarios"
    },
    {
      "Time_Start": 93.44,
      "Time_End": 100.08,
      "Text": " that are present on Windows, but they also work on Macs, so that was the main idea that"
    },
    {
      "Time_Start": 100.08,
      "Time_End": 104.47999999999999,
      "Text": " I'd like to insert to your minds, right?"
    },
    {
      "Time_Start": 104.47999999999999,
      "Time_End": 113.52,
      "Text": " So we'll start from introduction, and then we're gonna compare Macs in corporate environments,"
    },
    {
      "Time_Start": 113.6,
      "Time_End": 121.47999999999999,
      "Text": " and then I will share my thoughts on mythic, that's a C2 framework for mostly for Macs,"
    },
    {
      "Time_Start": 121.47999999999999,
      "Time_End": 126.36,
      "Text": " and when we will have everything set, our environment will be set up, we'll start from"
    },
    {
      "Time_Start": 126.36,
      "Time_End": 132.64,
      "Text": " initial access, then persistence, and when we have the persistence like standard data"
    },
    {
      "Time_Start": 132.64,
      "Time_End": 138.56,
      "Text": " collection lateral movement, and because I don't like giving talks without recommendations"
    },
    {
      "Time_Start": 138.56,
      "Time_End": 146.04,
      "Text": " in the end, I'll give you some ideas on how to harden your macOS environments."
    },
    {
      "Time_Start": 146.04,
      "Time_End": 157.88,
      "Text": " Alright, I know it's hard after the afterparty, but I will try to move your hands, so the"
    },
    {
      "Time_Start": 157.88,
      "Time_End": 164.12,
      "Text": " first question, raise your hands if there is at least one Mac in your companies."
    },
    {
      "Time_Start": 165.12,
      "Time_End": 171.12,
      "Text": " Oh, I would say like 70%, that's good."
    },
    {
      "Time_Start": 171.12,
      "Time_End": 179.04,
      "Text": " And the second question, raise your hand again if those Macs have access to your company's"
    },
    {
      "Time_Start": 179.04,
      "Time_End": 183.12,
      "Text": " resources like other Windows machines."
    },
    {
      "Time_Start": 183.12,
      "Time_End": 190.84,
      "Text": " Okay, that's, I would say like everybody who raised their hand in the first question raised"
    },
    {
      "Time_Start": 190.84,
      "Time_End": 195.12,
      "Text": " their hand in the second question, right, something."
    },
    {
      "Time_Start": 195.12,
      "Time_End": 202.56,
      "Text": " It only proves that this talk was correct in the assumptions."
    },
    {
      "Time_Start": 202.56,
      "Time_End": 206.72,
      "Text": " So why did I decide to make this talk?"
    },
    {
      "Time_Start": 206.72,
      "Time_End": 212.44,
      "Text": " Because Macs are getting more common in corporate environments."
    },
    {
      "Time_Start": 212.44,
      "Time_End": 219.88,
      "Text": " Developers use them, UX guys, designers, managers, etc."
    },
    {
      "Time_Start": 219.92,
      "Time_End": 226.79999999999998,
      "Text": " There are companies like software houses or IT companies in general that have a large"
    },
    {
      "Time_Start": 226.79999999999998,
      "Time_End": 234.44,
      "Text": " percentage of Macs in their environments, and the problem is that those Macs are usually"
    },
    {
      "Time_Start": 234.44,
      "Time_End": 240.35999999999999,
      "Text": " not symmetrically secured compared to Windows machines, right?"
    },
    {
      "Time_Start": 240.35999999999999,
      "Time_End": 249.76,
      "Text": " So we probably, if you have Macs in your company, you probably know that, you know that, but"
    },
    {
      "Time_Start": 249.76000000000002,
      "Time_End": 255.64000000000001,
      "Text": " there are sometimes people that tell me, Wojtek, I work in a huge bank, we don't have"
    },
    {
      "Time_Start": 255.64000000000001,
      "Time_End": 256.64000000000004,
      "Text": " Macs."
    },
    {
      "Time_Start": 256.64000000000004,
      "Time_End": 262.16,
      "Text": " And I say, okay, but do you have an iOS application, for example, a mobile banking application?"
    },
    {
      "Time_Start": 262.16,
      "Time_End": 264.98,
      "Text": " And they say, yes, we do have that."
    },
    {
      "Time_Start": 264.98,
      "Time_End": 268.64000000000004,
      "Text": " And I ask them, alright, so how is this application developed?"
    },
    {
      "Time_Start": 268.64000000000004,
      "Time_End": 276.96000000000004,
      "Text": " Because you cannot compile an iOS application on Windows, so probably somewhere in the infrastructure"
    },
    {
      "Time_Start": 276.96,
      "Time_End": 281.35999999999996,
      "Text": " you have Macs, and you probably even don't know about it."
    },
    {
      "Time_Start": 281.35999999999996,
      "Time_End": 287.15999999999997,
      "Text": " And if you have Macs in that company, are they symmetrically secured?"
    },
    {
      "Time_Start": 287.15999999999997,
      "Time_End": 290.62,
      "Text": " Are they bound to the AD?"
    },
    {
      "Time_Start": 290.62,
      "Time_End": 293.0,
      "Text": " Is SOC monitoring those Macs?"
    },
    {
      "Time_Start": 293.0,
      "Time_End": 299.64,
      "Text": " So they are usually a blind spot, that's why I decided to make this talk."
    },
    {
      "Time_Start": 299.64,
      "Time_End": 308.32,
      "Text": " And what are the main problems that we determine after investigating some MacOS environments"
    },
    {
      "Time_Start": 308.32,
      "Time_End": 310.2,
      "Text": " in huge companies?"
    },
    {
      "Time_Start": 310.2,
      "Time_End": 316.52,
      "Text": " So there are old and vulnerable MacOS versions like everywhere."
    },
    {
      "Time_Start": 316.52,
      "Time_End": 324.91999999999996,
      "Text": " I even met recently a Mac that was not updated for four years, and it was used by a person"
    },
    {
      "Time_Start": 324.92,
      "Time_End": 333.08000000000004,
      "Text": " who was responsible in that company for making payments to the employees."
    },
    {
      "Time_Start": 333.08000000000004,
      "Time_End": 339.20000000000005,
      "Text": " The second problem is MacOS system firewall is usually disabled."
    },
    {
      "Time_Start": 339.20000000000005,
      "Time_End": 342.32,
      "Text": " And that's because this default configuration Mac."
    },
    {
      "Time_Start": 342.32,
      "Time_End": 348.88,
      "Text": " So if you buy a brand new Mac, you configure it, you will see that the firewall is disabled"
    },
    {
      "Time_Start": 348.88,
      "Time_End": 349.88,
      "Text": " by default."
    },
    {
      "Time_Start": 350.48,
      "Time_End": 358.04,
      "Text": " Anti-malware, oh, I can see there is a delay between my laptop because I'm displaying other slides."
    },
    {
      "Time_Start": 362.44,
      "Time_End": 366.08,
      "Text": " But I'm on the new slide for like three minutes."
    },
    {
      "Time_Start": 372.76,
      "Time_End": 376.15999999999997,
      "Text": " Already hacked, right?"
    },
    {
      "Time_Start": 376.15999999999997,
      "Time_End": 377.0,
      "Text": " So I reconnect."
    },
    {
      "Time_Start": 379.88,
      "Time_End": 401.88,
      "Text": " That's Apple magic, that's what we call Apple magic."
    },
    {
      "Time_Start": 410.88,
      "Time_End": 411.88,
      "Text": " You have a problem?"
    },
    {
      "Time_Start": 411.88,
      "Time_End": 412.88,
      "Text": " Can you?"
    },
    {
      "Time_Start": 432.88,
      "Time_End": 437.68,
      "Text": " All right, so that was the slide that I was on."
    },
    {
      "Time_Start": 437.68,
      "Time_End": 440.76,
      "Text": " So yeah, I stopped on talking about malware."
    },
    {
      "Time_Start": 440.76,
      "Time_End": 442.68,
      "Text": " So do even Mac have viruses?"
    },
    {
      "Time_Start": 442.68,
      "Time_End": 444.40000000000003,
      "Text": " Yes, they have."
    },
    {
      "Time_Start": 444.40000000000003,
      "Time_End": 447.04,
      "Text": " And there are a lot of types of malware on MacOS."
    },
    {
      "Time_Start": 447.04,
      "Time_End": 448.96,
      "Text": " Even we have our ransomware."
    },
    {
      "Time_Start": 448.96,
      "Time_End": 452.96000000000004,
      "Text": " So yeah, there is malware on Macs."
    },
    {
      "Time_Start": 452.96000000000004,
      "Time_End": 457.44,
      "Text": " Standard users working on administrative accounts, that was everywhere because that's again the"
    },
    {
      "Time_Start": 457.44,
      "Time_End": 458.44,
      "Text": " default configuration."
    },
    {
      "Time_Start": 458.44,
      "Time_End": 463.16,
      "Text": " If you create a new user, it automatically becomes an admin."
    },
    {
      "Time_Start": 463.16,
      "Time_End": 472.72,
      "Text": " Not even saying about application whitelisting, and one of the worst things, in small and"
    },
    {
      "Time_Start": 472.72,
      "Time_End": 478.52000000000004,
      "Text": " mid-sized companies, those Macs were not even enrolled to MDMs."
    },
    {
      "Time_Start": 478.52000000000004,
      "Time_End": 483.92,
      "Text": " So the users could apply any policies they wanted to."
    },
    {
      "Time_Start": 483.92,
      "Time_End": 490.92,
      "Text": " All right, so now let's compare MacOS environments."
    },
    {
      "Time_Start": 491.68,
      "Time_End": 498.88,
      "Text": " So typically, we have Windows, mostly Windows environments, when all the computers are bound"
    },
    {
      "Time_Start": 498.88,
      "Time_End": 500.48,
      "Text": " to the AD."
    },
    {
      "Time_Start": 500.48,
      "Time_End": 506.04,
      "Text": " And there are Macs that also could be bound to the AD, because there are native mechanisms"
    },
    {
      "Time_Start": 506.04,
      "Time_End": 508.68,
      "Text": " in MacOS that allow doing that."
    },
    {
      "Time_Start": 508.68,
      "Time_End": 514.72,
      "Text": " However, for example, if you bound your Macs to AD, you cannot enforce, for example, GPOs"
    },
    {
      "Time_Start": 514.72,
      "Time_End": 520.2,
      "Text": " that are crucial, right, for laptop management."
    },
    {
      "Time_Start": 520.2,
      "Time_End": 527.36,
      "Text": " And the second situation, that's the more common situation than the first one, is that"
    },
    {
      "Time_Start": 527.36,
      "Time_End": 535.1600000000001,
      "Text": " you have AD in your infrastructure, however, those Macs are not directly bound to it."
    },
    {
      "Time_Start": 535.1600000000001,
      "Time_End": 538.44,
      "Text": " But you still want to use Kerberos, for example."
    },
    {
      "Time_Start": 538.44,
      "Time_End": 542.88,
      "Text": " So there is a neat plugin called Nomad that handles the Kerberos."
    },
    {
      "Time_Start": 542.88,
      "Time_End": 549.5600000000001,
      "Text": " So that's the second type of environments, of MacOS environments."
    },
    {
      "Time_Start": 549.5600000000001,
      "Time_End": 554.36,
      "Text": " The third one, the last one that I'm going to talk about, is the situation where there"
    },
    {
      "Time_Start": 554.36,
      "Time_End": 556.0000000000001,
      "Text": " is no AD."
    },
    {
      "Time_Start": 556.0000000000001,
      "Time_End": 563.22,
      "Text": " We have, for example, a software house that is a relatively new company, and they wanted"
    },
    {
      "Time_Start": 563.22,
      "Time_End": 566.1600000000001,
      "Text": " to build their infrastructure without AD."
    },
    {
      "Time_Start": 566.1600000000001,
      "Time_End": 571.36,
      "Text": " So they have all the services in the cloud, and they use SSO, like for example, Okta."
    },
    {
      "Time_Start": 571.36,
      "Time_End": 573.6400000000001,
      "Text": " So there is no AD bound."
    },
    {
      "Time_Start": 574.3199999999999,
      "Time_End": 581.1999999999999,
      "Text": " Okay, so with having those three setups in mind, let's take a look at the target, because"
    },
    {
      "Time_Start": 581.1999999999999,
      "Time_End": 586.88,
      "Text": " as I told you at the beginning, I wanted to give you a presentation that is like a typical"
    },
    {
      "Time_Start": 586.88,
      "Time_End": 589.52,
      "Text": " Red Team presentation."
    },
    {
      "Time_Start": 589.52,
      "Time_End": 595.3199999999999,
      "Text": " We're going to go from zero to hero, so we're going to hack this kind of infrastructure."
    },
    {
      "Time_Start": 595.32,
      "Time_End": 604.1600000000001,
      "Text": " So we have a Mac that, via OpenVPN, connects to the company's intranet and gets access"
    },
    {
      "Time_Start": 604.1600000000001,
      "Time_End": 605.98,
      "Text": " to Active Directory."
    },
    {
      "Time_Start": 605.98,
      "Time_End": 612.12,
      "Text": " Because of the Active Directory, it connects to Active Directory Federational Services."
    },
    {
      "Time_Start": 612.12,
      "Time_End": 618.0,
      "Text": " That's what provides SSO, and in the end, the person that uses this Mac has access to"
    },
    {
      "Time_Start": 618.0,
      "Time_End": 621.2,
      "Text": " JIRA or Google Workspace."
    },
    {
      "Time_Start": 621.2,
      "Time_End": 626.4000000000001,
      "Text": " Let's imagine that the person that we're going to hack uses also AWS, so there are"
    },
    {
      "Time_Start": 626.4000000000001,
      "Time_End": 632.0,
      "Text": " somewhere on the Mac AWS keys stored."
    },
    {
      "Time_Start": 632.0,
      "Time_End": 640.2800000000001,
      "Text": " Regarding social media, administrators mostly do not hide them behind the SSO, because it's"
    },
    {
      "Time_Start": 640.2800000000001,
      "Time_End": 648.44,
      "Text": " kind of problematic, especially, for example, if you have a marketing team that mostly uses"
    },
    {
      "Time_Start": 648.48,
      "Time_End": 653.4000000000001,
      "Text": " their own personal accounts to manage your company's social media."
    },
    {
      "Time_Start": 653.4000000000001,
      "Time_End": 657.5200000000001,
      "Text": " That's why the social medias are usually not behind the SSO."
    },
    {
      "Time_Start": 657.5200000000001,
      "Time_End": 663.72,
      "Text": " So they have, for example, Firefox that connects to that social media."
    },
    {
      "Time_Start": 663.72,
      "Time_End": 671.2800000000001,
      "Text": " That company also heard that using Signal is secure, so for communication purposes,"
    },
    {
      "Time_Start": 671.2800000000001,
      "Time_End": 673.44,
      "Text": " they use Signal."
    },
    {
      "Time_Start": 673.44,
      "Time_End": 681.32,
      "Text": " And there are also some protected documents in desktop or downloads or documents directory."
    },
    {
      "Time_Start": 681.32,
      "Time_End": 685.96,
      "Text": " So we have this target."
    },
    {
      "Time_Start": 685.96,
      "Time_End": 694.7600000000001,
      "Text": " So if you'd like to start a red teaming exercise, we have to have a C2, so I really recommend"
    },
    {
      "Time_Start": 694.7600000000001,
      "Time_End": 698.5600000000001,
      "Text": " for MacOS red teaming purposes using Mythic."
    },
    {
      "Time_Start": 698.5600000000001,
      "Time_End": 702.0200000000001,
      "Text": " It's really great, created by Cody Thomas."
    },
    {
      "Time_Start": 702.02,
      "Time_End": 704.98,
      "Text": " It's open source."
    },
    {
      "Time_Start": 704.98,
      "Time_End": 710.22,
      "Text": " And why I really like Mythic is that it has really extensive docs."
    },
    {
      "Time_Start": 710.22,
      "Time_End": 715.6999999999999,
      "Text": " So like everything the Mythic provides, you can read about it on the internet in the Docs"
    },
    {
      "Time_Start": 715.6999999999999,
      "Time_End": 716.6999999999999,
      "Text": " Watch."
    },
    {
      "Time_Start": 716.6999999999999,
      "Time_End": 718.74,
      "Text": " It's really great."
    },
    {
      "Time_Start": 718.74,
      "Time_End": 723.18,
      "Text": " So let's take a look at demo."
    },
    {
      "Time_Start": 723.18,
      "Time_End": 726.06,
      "Text": " That's a default configuration of Mythic."
    },
    {
      "Time_Start": 726.06,
      "Time_End": 730.1,
      "Text": " So we'll log into operator."
    },
    {
      "Time_Start": 730.1800000000001,
      "Time_End": 735.34,
      "Text": " We're going to use UpFill, a standard JXA payload."
    },
    {
      "Time_Start": 735.34,
      "Time_End": 741.74,
      "Text": " And for the communication with the C2, we're going to use standard unencrypted HTTP."
    },
    {
      "Time_Start": 741.74,
      "Time_End": 745.22,
      "Text": " But also Mythic provides HTTPS, of course, WebSockets, et cetera."
    },
    {
      "Time_Start": 745.22,
      "Time_End": 748.14,
      "Text": " I just wanted to keep it simple."
    },
    {
      "Time_Start": 748.14,
      "Time_End": 751.62,
      "Text": " So we are creating a new payload."
    },
    {
      "Time_Start": 751.62,
      "Time_End": 753.74,
      "Text": " We're going to use UpFill."
    },
    {
      "Time_Start": 753.74,
      "Time_End": 758.1800000000001,
      "Text": " We include all the commands to have all the features that it provides."
    },
    {
      "Time_Start": 758.6200000000001,
      "Time_End": 765.0600000000001,
      "Text": " As I told you, we're going to connect via the HTTP."
    },
    {
      "Time_Start": 765.0600000000001,
      "Time_End": 771.5000000000001,
      "Text": " We set our IP address."
    },
    {
      "Time_Start": 771.5000000000001,
      "Time_End": 774.1400000000001,
      "Text": " And we create next."
    },
    {
      "Time_Start": 774.1400000000001,
      "Time_End": 776.2600000000001,
      "Text": " We have created the payload."
    },
    {
      "Time_Start": 776.2600000000001,
      "Time_End": 778.9000000000001,
      "Text": " And now we can download it."
    },
    {
      "Time_Start": 778.9000000000001,
      "Time_End": 780.1,
      "Text": " All right."
    },
    {
      "Time_Start": 780.1,
      "Time_End": 782.34,
      "Text": " But we have our payload."
    },
    {
      "Time_Start": 782.34,
      "Time_End": 786.1,
      "Text": " But then we have to somehow deliver it, right?"
    },
    {
      "Time_Start": 786.1,
      "Time_End": 790.58,
      "Text": " So this is where the problems start."
    },
    {
      "Time_Start": 790.58,
      "Time_End": 798.5400000000001,
      "Text": " So in recent years, Apple wanted to limit the applications that are downloaded directly"
    },
    {
      "Time_Start": 798.5400000000001,
      "Time_End": 805.62,
      "Text": " from the internet, because that was a really easy way to malware, to infect users."
    },
    {
      "Time_Start": 805.62,
      "Time_End": 809.5400000000001,
      "Text": " So they started requiring notarization."
    },
    {
      "Time_Start": 809.5400000000001,
      "Time_End": 811.62,
      "Text": " And what has to be notarized?"
    },
    {
      "Time_Start": 811.62,
      "Time_End": 817.94,
      "Text": " So macOS applications, bundles like kernel extensions, disk images, or flat installer"
    },
    {
      "Time_Start": 817.94,
      "Time_End": 823.22,
      "Text": " packages, those with the extension PKG."
    },
    {
      "Time_Start": 823.22,
      "Time_End": 827.1,
      "Text": " And what does it mean that the software has to be notarized?"
    },
    {
      "Time_Start": 827.1,
      "Time_End": 833.66,
      "Text": " So a notarization is a mechanism where you have a paid developer account."
    },
    {
      "Time_Start": 833.66,
      "Time_End": 835.14,
      "Text": " It's a paid developer account."
    },
    {
      "Time_Start": 835.14,
      "Time_End": 840.62,
      "Text": " It's not that much, because it's like $100 per year."
    },
    {
      "Time_Start": 840.62,
      "Time_End": 844.0600000000001,
      "Text": " But still, you have to pay for it."
    },
    {
      "Time_Start": 844.0600000000001,
      "Time_End": 848.22,
      "Text": " So when you have a paid developer account, you create your application."
    },
    {
      "Time_Start": 848.22,
      "Time_End": 849.82,
      "Text": " You send it to Apple."
    },
    {
      "Time_Start": 849.82,
      "Time_End": 852.78,
      "Text": " And Apple confirms that this application is free of malware."
    },
    {
      "Time_Start": 852.78,
      "Time_End": 858.98,
      "Text": " That's, of course, an automated scan behind Apple's infrastructure."
    },
    {
      "Time_Start": 858.98,
      "Time_End": 866.26,
      "Text": " So you can, of course, trick these scans to stop all your malware."
    },
    {
      "Time_Start": 866.26,
      "Time_End": 870.1,
      "Text": " But that's not what we are going to cover in this talk."
    },
    {
      "Time_Start": 870.1,
      "Time_End": 874.26,
      "Text": " For this talk, I just wanted you to know that there is a notarization mechanism."
    },
    {
      "Time_Start": 874.26,
      "Time_End": 881.98,
      "Text": " So if you want to create a dropper, and you want to do it in a legitimate way, let's say,"
    },
    {
      "Time_Start": 881.98,
      "Time_End": 884.14,
      "Text": " it has to be notarized."
    },
    {
      "Time_Start": 884.14,
      "Time_End": 889.38,
      "Text": " So it will be sent to Apple and verified against malware."
    },
    {
      "Time_Start": 889.38,
      "Time_End": 892.94,
      "Text": " And what happens if you do not notarize your application?"
    },
    {
      "Time_Start": 892.94,
      "Time_End": 899.78,
      "Text": " So when the user double clicks on the application right after it's downloaded from the internet,"
    },
    {
      "Time_Start": 899.78,
      "Time_End": 904.14,
      "Text": " there will be a prompt that the application cannot be opened, because the developer cannot"
    },
    {
      "Time_Start": 904.14,
      "Time_End": 905.42,
      "Text": " be verified."
    },
    {
      "Time_Start": 905.42,
      "Time_End": 907.26,
      "Text": " So macOS will simply block it."
    },
    {
      "Time_Start": 907.26,
      "Time_End": 914.54,
      "Text": " So without the developer certificate, you are not able to deliver a legitimate payload."
    },
    {
      "Time_Start": 914.54,
      "Time_End": 918.66,
      "Text": " However, there are some solutions."
    },
    {
      "Time_Start": 918.66,
      "Time_End": 925.5,
      "Text": " So the first one is, of course, delivering a package file that is notarized."
    },
    {
      "Time_Start": 926.06,
      "Time_End": 929.98,
      "Text": " However, we risk our certificate being revoked by Apple, right?"
    },
    {
      "Time_Start": 929.98,
      "Time_End": 934.9,
      "Text": " So in Redteaming, we don't want to risk it."
    },
    {
      "Time_Start": 934.9,
      "Time_End": 942.06,
      "Text": " There are services that use stolen developer certificates for that purposes."
    },
    {
      "Time_Start": 942.06,
      "Time_End": 949.62,
      "Text": " But if you do internal Redteaming, you probably do not want to use stolen certificates, right?"
    },
    {
      "Time_Start": 949.62,
      "Time_End": 953.38,
      "Text": " So the first idea."
    },
    {
      "Time_Start": 953.46,
      "Time_End": 958.82,
      "Text": " The second idea is a technique commonly used by malware."
    },
    {
      "Time_Start": 958.82,
      "Time_End": 963.3,
      "Text": " So these two screenshots are from real malware."
    },
    {
      "Time_Start": 963.3,
      "Time_End": 970.98,
      "Text": " And what it does, it's delivering the dropper inside of the DMG file."
    },
    {
      "Time_Start": 970.98,
      "Time_End": 975.9399999999999,
      "Text": " The DMG file doesn't have to be signed, doesn't have to be notarized."
    },
    {
      "Time_Start": 975.94,
      "Time_End": 984.7800000000001,
      "Text": " So the only thing that has to be notarized is the application that's inside of the DMG."
    },
    {
      "Time_Start": 984.7800000000001,
      "Time_End": 992.2600000000001,
      "Text": " But the big plus of delivering DMG is that you can set a custom background, which is"
    },
    {
      "Time_Start": 992.2600000000001,
      "Time_End": 994.9000000000001,
      "Text": " a PNG image."
    },
    {
      "Time_Start": 994.9000000000001,
      "Time_End": 1000.5,
      "Text": " And this PNG image, as you can see, provides an instruction to victims."
    },
    {
      "Time_Start": 1000.5,
      "Time_End": 1005.82,
      "Text": " So in the first part, there is a DMG with the unsigned package file."
    },
    {
      "Time_Start": 1005.82,
      "Time_End": 1010.9000000000001,
      "Text": " And on the right, you can see that there's an instruction to right-click on that and"
    },
    {
      "Time_Start": 1010.9000000000001,
      "Time_End": 1012.2600000000001,
      "Text": " press open."
    },
    {
      "Time_Start": 1012.2600000000001,
      "Time_End": 1016.7800000000001,
      "Text": " And that's the mechanism that bypasses notarization requirements."
    },
    {
      "Time_Start": 1016.7800000000001,
      "Time_End": 1022.3000000000001,
      "Text": " There will be additional prompt that this application has been downloaded from the internet"
    },
    {
      "Time_Start": 1022.3000000000001,
      "Time_End": 1023.6600000000001,
      "Text": " and cannot be verified."
    },
    {
      "Time_Start": 1023.6600000000001,
      "Time_End": 1027.18,
      "Text": " So you make the user accept the risk of getting infected."
    },
    {
      "Time_Start": 1027.18,
      "Time_End": 1029.8600000000001,
      "Text": " But come on, you're doing Redteaming."
    },
    {
      "Time_Start": 1029.8600000000001,
      "Time_End": 1034.8600000000001,
      "Text": " You know that this prompt doesn't work, right?"
    },
    {
      "Time_Start": 1035.66,
      "Time_End": 1039.3000000000002,
      "Text": " OK, so there is also a third way."
    },
    {
      "Time_Start": 1039.3000000000002,
      "Time_End": 1043.2600000000002,
      "Text": " But it requires from us having a zero day."
    },
    {
      "Time_Start": 1043.2600000000002,
      "Time_End": 1050.7,
      "Text": " So the mechanism that verifies the notarization on the user's end, it's called Gatekeeper."
    },
    {
      "Time_Start": 1050.7,
      "Time_End": 1052.6200000000001,
      "Text": " There are, of course, zero days for that."
    },
    {
      "Time_Start": 1052.6200000000001,
      "Time_End": 1055.8600000000001,
      "Text": " I've even found one, as you can see on the slide."
    },
    {
      "Time_Start": 1055.8600000000001,
      "Time_End": 1064.2600000000002,
      "Text": " However, it still requires having a zero day."
    },
    {
      "Time_Start": 1065.26,
      "Time_End": 1070.82,
      "Text": " And the last way that I'm going to share during this talk is infection via Microsoft Office"
    },
    {
      "Time_Start": 1070.82,
      "Time_End": 1072.1,
      "Text": " Macro."
    },
    {
      "Time_Start": 1072.1,
      "Time_End": 1077.36,
      "Text": " And that's what you are probably used to."
    },
    {
      "Time_Start": 1077.36,
      "Time_End": 1084.3799999999999,
      "Text": " So on macOS, there are white-listed extensions that doesn't have to be notarized."
    },
    {
      "Time_Start": 1084.3799999999999,
      "Time_End": 1088.3799999999999,
      "Text": " Because it would be really dumb if you download, for example, a picture from the internet."
    },
    {
      "Time_Start": 1088.3799999999999,
      "Time_End": 1093.58,
      "Text": " You double-click on it, and you have a prompt, oh, this picture has not been signed by the"
    },
    {
      "Time_Start": 1093.58,
      "Time_End": 1094.58,
      "Text": " real developer."
    },
    {
      "Time_Start": 1094.58,
      "Time_End": 1095.74,
      "Text": " So it would be really dumb."
    },
    {
      "Time_Start": 1095.74,
      "Time_End": 1100.1399999999999,
      "Text": " So there is a white list that bypasses the Gatekeeper requirements."
    },
    {
      "Time_Start": 1100.1399999999999,
      "Time_End": 1103.3,
      "Text": " And one of these examples is DocsFile."
    },
    {
      "Time_Start": 1103.3,
      "Time_End": 1108.3799999999999,
      "Text": " So you deliver a Word document with Macro, you double-click on it, and there will be"
    },
    {
      "Time_Start": 1108.3799999999999,
      "Time_End": 1110.5,
      "Text": " no Gatekeeper bypass."
    },
    {
      "Time_Start": 1110.5,
      "Time_End": 1114.74,
      "Text": " However, it's not that easy."
    },
    {
      "Time_Start": 1114.74,
      "Time_End": 1120.6799999999998,
      "Text": " So how does it look like from the inside?"
    },
    {
      "Time_Start": 1120.78,
      "Time_End": 1125.24,
      "Text": " So on macOS, we have a Visual Basic subroutine that's called AutoOpen."
    },
    {
      "Time_Start": 1125.24,
      "Time_End": 1134.0800000000002,
      "Text": " So right after user accepts macros in the document that they are about to open, this"
    },
    {
      "Time_Start": 1134.0800000000002,
      "Time_End": 1138.16,
      "Text": " macro is being automatically called."
    },
    {
      "Time_Start": 1138.16,
      "Time_End": 1142.0,
      "Text": " And usually, we use MacScript function."
    },
    {
      "Time_Start": 1142.0,
      "Time_End": 1149.4,
      "Text": " And what MacScript does is spawning a shell, like Bash or ZSH."
    },
    {
      "Time_Start": 1149.4,
      "Time_End": 1158.18,
      "Text": " So in this example, we download from our C2 server the payload, the app.js."
    },
    {
      "Time_Start": 1158.18,
      "Time_End": 1160.44,
      "Text": " We use HMODE on it."
    },
    {
      "Time_Start": 1160.44,
      "Time_End": 1166.6000000000001,
      "Text": " And with OSAScript, with specifying language to JavaScript, we run this totally not a virus"
    },
    {
      "Time_Start": 1166.6000000000001,
      "Time_End": 1170.5600000000002,
      "Text": " JavaScript file."
    },
    {
      "Time_Start": 1170.5600000000002,
      "Time_End": 1178.76,
      "Text": " But that's not the end of the macro story, as Microsoft Word on macOS is unboxed."
    },
    {
      "Time_Start": 1179.12,
      "Time_End": 1185.52,
      "Text": " So we get a code execution on Macs that doesn't have to be notarized, so you don't have to"
    },
    {
      "Time_Start": 1185.52,
      "Time_End": 1187.92,
      "Text": " send this payload to Apple."
    },
    {
      "Time_Start": 1187.92,
      "Time_End": 1191.8,
      "Text": " However, yeah, this is some boxed code execution."
    },
    {
      "Time_Start": 1191.8,
      "Time_End": 1195.06,
      "Text": " So this is not what we'd like to have, right?"
    },
    {
      "Time_Start": 1195.06,
      "Time_End": 1200.8,
      "Text": " Because we don't have still access to users' directories, which is not really good for"
    },
    {
      "Time_Start": 1200.8,
      "Time_End": 1202.46,
      "Text": " us."
    },
    {
      "Time_Start": 1202.46,
      "Time_End": 1205.52,
      "Text": " But there is a bypass for it."
    },
    {
      "Time_Start": 1205.96,
      "Time_End": 1213.4,
      "Text": " Matcalf-Bad shared a really cool technique that makes you able to escape the word sandbox."
    },
    {
      "Time_Start": 1213.4,
      "Time_End": 1216.96,
      "Text": " However, it requires you to reboot your machine."
    },
    {
      "Time_Start": 1216.96,
      "Time_End": 1219.76,
      "Text": " So you infect the user."
    },
    {
      "Time_Start": 1219.76,
      "Time_End": 1224.08,
      "Text": " You create, let's say, a sandbox escape."
    },
    {
      "Time_Start": 1224.08,
      "Time_End": 1226.34,
      "Text": " You start to persist on that machine."
    },
    {
      "Time_Start": 1226.34,
      "Time_End": 1234.8,
      "Text": " But this un-sandboxed code won't be executed until the user reboots their Mac."
    },
    {
      "Time_Start": 1234.8,
      "Time_End": 1235.8,
      "Text": " From one side, it's good."
    },
    {
      "Time_Start": 1235.8,
      "Time_End": 1241.24,
      "Text": " But from the other side, we usually, during red team, don't have time to wait for the"
    },
    {
      "Time_Start": 1241.24,
      "Time_End": 1243.32,
      "Text": " user to reboot their Macs, right?"
    },
    {
      "Time_Start": 1243.32,
      "Time_End": 1246.0,
      "Text": " But I don't know."
    },
    {
      "Time_Start": 1246.0,
      "Time_End": 1248.8,
      "Text": " What was the last thing when you rebooted your Mac?"
    },
    {
      "Time_Start": 1248.8,
      "Time_End": 1252.68,
      "Text": " I do it only when I update my computer."
    },
    {
      "Time_Start": 1252.68,
      "Time_End": 1256.76,
      "Text": " Is that also your case?"
    },
    {
      "Time_Start": 1256.76,
      "Time_End": 1263.12,
      "Text": " That's useless, mostly, this bypass, right?"
    },
    {
      "Time_Start": 1263.1200000000001,
      "Time_End": 1268.92,
      "Text": " Only if your company has automated update process and you know that there will be an"
    },
    {
      "Time_Start": 1268.92,
      "Time_End": 1275.8000000000002,
      "Text": " update, which will be forced by GPOs or other policies."
    },
    {
      "Time_Start": 1275.8000000000002,
      "Time_End": 1279.24,
      "Text": " And right before the update, you start infecting users."
    },
    {
      "Time_Start": 1279.24,
      "Time_End": 1283.4,
      "Text": " Maybe that makes sense, but in general, it doesn't."
    },
    {
      "Time_Start": 1283.4,
      "Time_End": 1287.0000000000002,
      "Text": " However, we have our own zero days."
    },
    {
      "Time_Start": 1287.0,
      "Time_End": 1293.04,
      "Text": " So during this talk, I will present a demo of my Mac as a sandbox escape vulnerability."
    },
    {
      "Time_Start": 1293.04,
      "Time_End": 1295.8,
      "Text": " Unfortunately, it's still a zero day."
    },
    {
      "Time_Start": 1295.8,
      "Time_End": 1297.2,
      "Text": " Apple didn't fix it on time."
    },
    {
      "Time_Start": 1297.2,
      "Time_End": 1303.52,
      "Text": " So I'm sorry without code, just the demo."
    },
    {
      "Time_Start": 1303.52,
      "Time_End": 1307.92,
      "Text": " So here we have the document file."
    },
    {
      "Time_Start": 1307.92,
      "Time_End": 1313.0,
      "Text": " That's a regular file downloaded from the Internet, a regular Word file downloaded from"
    },
    {
      "Time_Start": 1313.0,
      "Time_End": 1316.86,
      "Text": " the Internet with this macro."
    },
    {
      "Time_Start": 1317.72,
      "Time_End": 1320.3000000000002,
      "Text": " So let's the demo start."
    },
    {
      "Time_Start": 1320.3000000000002,
      "Time_End": 1322.42,
      "Text": " The user double clicks on it."
    },
    {
      "Time_Start": 1322.42,
      "Time_End": 1325.7800000000002,
      "Text": " It has to enable macros."
    },
    {
      "Time_Start": 1325.7800000000002,
      "Time_End": 1327.5800000000002,
      "Text": " As you can see, the terminal was found."
    },
    {
      "Time_Start": 1327.5800000000002,
      "Time_End": 1334.38,
      "Text": " We do, of course, don't need to spawn it, but I wanted to show you that it worked."
    },
    {
      "Time_Start": 1334.38,
      "Time_End": 1341.22,
      "Text": " And as we have the code execution, let's check if it's really on sandbox."
    },
    {
      "Time_Start": 1341.22,
      "Time_End": 1343.5800000000002,
      "Text": " So we verify the user."
    },
    {
      "Time_Start": 1343.5800000000002,
      "Time_End": 1346.38,
      "Text": " It runs with my user's permissions."
    },
    {
      "Time_Start": 1346.38,
      "Time_End": 1350.2600000000002,
      "Text": " And I think we just spawn shell here."
    },
    {
      "Time_Start": 1350.2600000000002,
      "Time_End": 1356.22,
      "Text": " And then we use LS to list current users."
    },
    {
      "Time_Start": 1356.22,
      "Time_End": 1359.2600000000002,
      "Text": " Let's wait a while."
    },
    {
      "Time_Start": 1359.2600000000002,
      "Time_End": 1361.3000000000002,
      "Text": " So yeah."
    },
    {
      "Time_Start": 1361.3000000000002,
      "Time_End": 1364.5200000000002,
      "Text": " Our infected machine responded with two users."
    },
    {
      "Time_Start": 1364.5200000000002,
      "Time_End": 1366.98,
      "Text": " What means that we have our code on sandbox?"
    },
    {
      "Time_Start": 1366.98,
      "Time_End": 1368.8600000000001,
      "Text": " Because we were able to list users, right?"
    },
    {
      "Time_Start": 1368.8600000000001,
      "Time_End": 1371.14,
      "Text": " So yeah, that was the zero day."
    },
    {
      "Time_Start": 1371.14,
      "Time_End": 1376.46,
      "Text": " But I'm sorry, no details this time."
    },
    {
      "Time_Start": 1376.46,
      "Time_End": 1381.8600000000001,
      "Text": " And by the way, it's not a zero day only for Microsoft Office."
    },
    {
      "Time_Start": 1381.8600000000001,
      "Time_End": 1384.3000000000002,
      "Text": " It's a zero day for a macro sandboxing system."
    },
    {
      "Time_Start": 1384.3000000000002,
      "Time_End": 1387.8200000000002,
      "Text": " So it bypasses all kinds of sandboxes on Mac."
    },
    {
      "Time_Start": 1387.8200000000002,
      "Time_End": 1389.5800000000002,
      "Text": " All right."
    },
    {
      "Time_Start": 1389.5800000000002,
      "Time_End": 1395.5800000000002,
      "Text": " So we have our code unsandboxed and executed on the victim's machine."
    },
    {
      "Time_Start": 1395.5800000000002,
      "Time_End": 1398.7,
      "Text": " So now we have to somehow persist."
    },
    {
      "Time_Start": 1398.94,
      "Time_End": 1403.78,
      "Text": " There are many techniques, like launch agents, launch daemons, login items."
    },
    {
      "Time_Start": 1403.78,
      "Time_End": 1406.8600000000001,
      "Text": " These three are commonly used by malware."
    },
    {
      "Time_Start": 1406.8600000000001,
      "Time_End": 1410.18,
      "Text": " Cron jobs, login logout hooks, authorization plugins."
    },
    {
      "Time_Start": 1410.18,
      "Time_End": 1417.3400000000001,
      "Text": " But there are many, many more, like 30-plus techniques."
    },
    {
      "Time_Start": 1417.3400000000001,
      "Time_End": 1422.22,
      "Text": " And they are well-documented on my friend's Chabas blog, which link"
    },
    {
      "Time_Start": 1422.22,
      "Time_End": 1425.5,
      "Text": " you have in the end of the slide."
    },
    {
      "Time_Start": 1425.5,
      "Time_End": 1425.98,
      "Text": " All right."
    },
    {
      "Time_Start": 1425.98,
      "Time_End": 1429.94,
      "Text": " So now let's try to persist with mythic."
    },
    {
      "Time_Start": 1429.94,
      "Time_End": 1432.06,
      "Text": " So there's a common persist launch."
    },
    {
      "Time_Start": 1432.06,
      "Time_End": 1436.02,
      "Text": " And we will be creating a launch agent."
    },
    {
      "Time_Start": 1436.02,
      "Time_End": 1438.82,
      "Text": " So again, we start with the parameters that"
    },
    {
      "Time_Start": 1438.82,
      "Time_End": 1440.8600000000001,
      "Text": " will be passed to this launch agent."
    },
    {
      "Time_Start": 1440.8600000000001,
      "Time_End": 1446.46,
      "Text": " So we want to run an OSA script to run our JS payload."
    },
    {
      "Time_Start": 1446.46,
      "Time_End": 1453.1,
      "Text": " And we have to somehow point to the payload that was saved."
    },
    {
      "Time_Start": 1453.14,
      "Time_End": 1456.9800000000002,
      "Text": " We start with dot, because on Mac it works exactly the same"
    },
    {
      "Time_Start": 1456.9800000000002,
      "Time_End": 1458.66,
      "Text": " like it works on Linux."
    },
    {
      "Time_Start": 1458.66,
      "Time_End": 1463.46,
      "Text": " So if you start with dot, that file will be hidden."
    },
    {
      "Time_Start": 1463.46,
      "Time_End": 1465.0600000000002,
      "Text": " We set the custom label."
    },
    {
      "Time_Start": 1465.0600000000002,
      "Time_End": 1475.0600000000002,
      "Text": " And in a while, mythic will return the result"
    },
    {
      "Time_Start": 1475.0600000000002,
      "Time_End": 1478.2600000000002,
      "Text": " that the file has been written to the launch agent's directory."
    },
    {
      "Time_Start": 1478.2600000000002,
      "Time_End": 1478.7400000000002,
      "Text": " OK."
    },
    {
      "Time_Start": 1478.7400000000002,
      "Time_End": 1481.5000000000002,
      "Text": " So we have our launch agent already there."
    },
    {
      "Time_Start": 1481.5,
      "Time_End": 1483.94,
      "Text": " Now we have to load it."
    },
    {
      "Time_Start": 1483.94,
      "Time_End": 1487.66,
      "Text": " So after a user reboots the machine or kills the process,"
    },
    {
      "Time_Start": 1487.66,
      "Time_End": 1490.26,
      "Text": " it will be automatically spawned."
    },
    {
      "Time_Start": 1490.26,
      "Time_End": 1495.34,
      "Text": " So with launchctl load, we provide the path."
    },
    {
      "Time_Start": 1498.02,
      "Time_End": 1500.54,
      "Text": " And in a moment, we will see that there"
    },
    {
      "Time_Start": 1500.54,
      "Time_End": 1503.98,
      "Text": " will be another active callback."
    },
    {
      "Time_Start": 1503.98,
      "Time_End": 1504.9,
      "Text": " Yeah."
    },
    {
      "Time_Start": 1504.9,
      "Time_End": 1506.98,
      "Text": " So as you can see, we have another active callback."
    },
    {
      "Time_Start": 1507.98,
      "Time_End": 1515.02,
      "Text": " And recently, Apple pushed their new macOS beta,"
    },
    {
      "Time_Start": 1515.02,
      "Time_End": 1519.14,
      "Text": " which is macOS Ventura, that will be available in this fall."
    },
    {
      "Time_Start": 1519.14,
      "Time_End": 1521.98,
      "Text": " And they made some changes to the operating system."
    },
    {
      "Time_Start": 1521.98,
      "Time_End": 1526.6200000000001,
      "Text": " And now if you go to System Settings and go to General,"
    },
    {
      "Time_Start": 1526.6200000000001,
      "Time_End": 1530.46,
      "Text": " you will see agents, launch daemons, and login items"
    },
    {
      "Time_Start": 1530.46,
      "Time_End": 1532.8600000000001,
      "Text": " that are installed on the machine."
    },
    {
      "Time_Start": 1532.8600000000001,
      "Time_End": 1535.06,
      "Text": " So this takes a little bit of time."
    },
    {
      "Time_Start": 1536.06,
      "Time_End": 1538.54,
      "Text": " So this technique, the launch agent technique,"
    },
    {
      "Time_Start": 1538.54,
      "Time_End": 1540.8999999999999,
      "Text": " will become more noisy because user"
    },
    {
      "Time_Start": 1540.8999999999999,
      "Time_End": 1543.3,
      "Text": " will be able to, not from the command line,"
    },
    {
      "Time_Start": 1543.3,
      "Time_End": 1545.74,
      "Text": " but from the user interface, verify what"
    },
    {
      "Time_Start": 1545.74,
      "Time_End": 1547.62,
      "Text": " launch agents are registered."
    },
    {
      "Time_Start": 1547.62,
      "Time_End": 1552.46,
      "Text": " So this technique probably will change in the future."
    },
    {
      "Time_Start": 1552.46,
      "Time_End": 1554.94,
      "Text": " But as I told you, there are a lot of techniques"
    },
    {
      "Time_Start": 1554.94,
      "Time_End": 1556.06,
      "Text": " to persist on macOS."
    },
    {
      "Time_Start": 1556.06,
      "Time_End": 1559.3,
      "Text": " And Apple covers, like for now, four techniques maybe"
    },
    {
      "Time_Start": 1559.3,
      "Time_End": 1560.7,
      "Text": " that will be displayed here."
    },
    {
      "Time_Start": 1560.74,
      "Time_End": 1568.3,
      "Text": " So we have unlimited methods to still persist on Mac still."
    },
    {
      "Time_Start": 1568.3,
      "Time_End": 1571.78,
      "Text": " All right, so we have our answer box code execution."
    },
    {
      "Time_Start": 1571.78,
      "Time_End": 1577.54,
      "Text": " We know that the persistence is provided."
    },
    {
      "Time_Start": 1577.54,
      "Time_End": 1581.6200000000001,
      "Text": " So let's get back to our target because now we"
    },
    {
      "Time_Start": 1581.6200000000001,
      "Time_End": 1585.74,
      "Text": " want to attack the services installed on the machine."
    },
    {
      "Time_Start": 1585.74,
      "Time_End": 1588.42,
      "Text": " So what we are interested in?"
    },
    {
      "Time_Start": 1588.42,
      "Time_End": 1590.18,
      "Text": " Of course, VPN credentials."
    },
    {
      "Time_Start": 1590.18,
      "Time_End": 1593.42,
      "Text": " Of course, AD credentials, but also signal messages,"
    },
    {
      "Time_Start": 1593.42,
      "Time_End": 1596.38,
      "Text": " browser cookies, keychain entries, AWS,"
    },
    {
      "Time_Start": 1596.38,
      "Time_End": 1602.38,
      "Text": " and other cloud keys, and desktop documents files."
    },
    {
      "Time_Start": 1602.38,
      "Time_End": 1605.3,
      "Text": " Let's start from the OpenVPN."
    },
    {
      "Time_Start": 1605.3,
      "Time_End": 1612.54,
      "Text": " So OpenVPN saves its profiles that you install in it"
    },
    {
      "Time_Start": 1612.54,
      "Time_End": 1616.42,
      "Text": " as a flat file without any additional protections."
    },
    {
      "Time_Start": 1616.42,
      "Time_End": 1621.66,
      "Text": " So if in your profile there are all the user's credentials"
    },
    {
      "Time_Start": 1621.66,
      "Time_End": 1627.6200000000001,
      "Text": " that are required to connect to your internal network,"
    },
    {
      "Time_Start": 1627.6200000000001,
      "Time_End": 1628.78,
      "Text": " it's over."
    },
    {
      "Time_Start": 1628.78,
      "Time_End": 1630.7,
      "Text": " However, it's not a really common case."
    },
    {
      "Time_Start": 1630.7,
      "Time_End": 1633.9,
      "Text": " Usually, the profiles contain certificates, et cetera."
    },
    {
      "Time_Start": 1633.9,
      "Time_End": 1638.38,
      "Text": " But the user has to log in with their login and password"
    },
    {
      "Time_Start": 1638.38,
      "Time_End": 1644.18,
      "Text": " or something else in the prompt that will be displayed"
    },
    {
      "Time_Start": 1644.22,
      "Time_End": 1646.7,
      "Text": " during the connection."
    },
    {
      "Time_Start": 1646.7,
      "Time_End": 1651.54,
      "Text": " So we have this profile, but we also"
    },
    {
      "Time_Start": 1651.54,
      "Time_End": 1655.8200000000002,
      "Text": " will need to have the user login and password."
    },
    {
      "Time_Start": 1655.8200000000002,
      "Time_End": 1659.6200000000001,
      "Text": " So how to do that with OpenVPN on Mac?"
    },
    {
      "Time_Start": 1659.6200000000001,
      "Time_End": 1661.7,
      "Text": " As I told you, there is a notarization process."
    },
    {
      "Time_Start": 1661.7,
      "Time_End": 1664.42,
      "Text": " So OpenVPN, as it is an application"
    },
    {
      "Time_Start": 1664.42,
      "Time_End": 1667.6200000000001,
      "Text": " downloaded from the internet, it has to be notarized."
    },
    {
      "Time_Start": 1667.6200000000001,
      "Time_End": 1670.7,
      "Text": " And notarization requires, of course,"
    },
    {
      "Time_Start": 1670.7,
      "Time_End": 1672.6200000000001,
      "Text": " the anti-malware checks, but also"
    },
    {
      "Time_Start": 1672.6200000000001,
      "Time_End": 1675.3000000000002,
      "Text": " requires the developers to harden"
    },
    {
      "Time_Start": 1675.3000000000002,
      "Time_End": 1678.1000000000001,
      "Text": " the runtime of the application they distribute."
    },
    {
      "Time_Start": 1678.1000000000001,
      "Time_End": 1688.7,
      "Text": " And hardening runtime nowadays mitigate code injection"
    },
    {
      "Time_Start": 1688.7,
      "Time_End": 1690.38,
      "Text": " vulnerabilities."
    },
    {
      "Time_Start": 1690.38,
      "Time_End": 1694.9,
      "Text": " However, there are special entitlements"
    },
    {
      "Time_Start": 1694.9,
      "Time_End": 1699.8200000000002,
      "Text": " that will make this hardened runtime not really hardened,"
    },
    {
      "Time_Start": 1699.82,
      "Time_End": 1703.46,
      "Text": " and code injection attacks will be still possible."
    },
    {
      "Time_Start": 1703.46,
      "Time_End": 1707.82,
      "Text": " And OpenVPN deliberately, on purpose,"
    },
    {
      "Time_Start": 1707.82,
      "Time_End": 1712.1,
      "Text": " implements those two entitlements."
    },
    {
      "Time_Start": 1712.1,
      "Time_End": 1715.3,
      "Text": " And the first one is allow built environment variables, what"
    },
    {
      "Time_Start": 1715.3,
      "Time_End": 1719.3,
      "Text": " allows us performing an attack like LD preload on Linux."
    },
    {
      "Time_Start": 1719.3,
      "Time_End": 1721.4199999999998,
      "Text": " So we can provide a dynamic library"
    },
    {
      "Time_Start": 1721.4199999999998,
      "Time_End": 1724.1,
      "Text": " that will be loaded to the process context."
    },
    {
      "Time_Start": 1724.1,
      "Time_End": 1726.5,
      "Text": " And the second one is disable library validation."
    },
    {
      "Time_Start": 1726.5,
      "Time_End": 1729.62,
      "Text": " So this library doesn't even have to be signed."
    },
    {
      "Time_Start": 1729.6200000000001,
      "Time_End": 1731.5400000000002,
      "Text": " So we can inject to OpenVPN."
    },
    {
      "Time_Start": 1736.98,
      "Time_End": 1740.7,
      "Text": " So when we can inject to the OpenVPN,"
    },
    {
      "Time_Start": 1740.7,
      "Time_End": 1744.8600000000001,
      "Text": " you can, for example, use my universal application keylogger."
    },
    {
      "Time_Start": 1744.8600000000001,
      "Time_End": 1748.5400000000002,
      "Text": " And what's the idea behind this universal keylogger"
    },
    {
      "Time_Start": 1748.5400000000002,
      "Time_End": 1751.5000000000002,
      "Text": " is that, generally, if you'd like"
    },
    {
      "Time_Start": 1751.5000000000002,
      "Time_End": 1753.74,
      "Text": " to listen for keystrokes on Mac OS,"
    },
    {
      "Time_Start": 1753.74,
      "Time_End": 1756.94,
      "Text": " you will need a special permission from the user."
    },
    {
      "Time_Start": 1756.94,
      "Time_End": 1759.2600000000002,
      "Text": " So you have to register to listening to all keystrokes"
    },
    {
      "Time_Start": 1759.42,
      "Time_End": 1762.22,
      "Text": " to all applications, which, of course,"
    },
    {
      "Time_Start": 1762.22,
      "Time_End": 1765.22,
      "Text": " has implications on user security and privacy."
    },
    {
      "Time_Start": 1765.22,
      "Time_End": 1769.98,
      "Text": " So Apple decided to make an architectonical decision"
    },
    {
      "Time_Start": 1769.98,
      "Time_End": 1774.26,
      "Text": " to, when you start listening for all keystrokes on the machine,"
    },
    {
      "Time_Start": 1774.26,
      "Time_End": 1775.58,
      "Text": " there will be a special prompt."
    },
    {
      "Time_Start": 1775.58,
      "Time_End": 1777.78,
      "Text": " And you want to avoid that."
    },
    {
      "Time_Start": 1777.78,
      "Time_End": 1779.74,
      "Text": " So this keylogger, what this keylogger does,"
    },
    {
      "Time_Start": 1779.74,
      "Time_End": 1783.54,
      "Text": " it's a dynamic library which injects to a process."
    },
    {
      "Time_Start": 1783.54,
      "Time_End": 1787.34,
      "Text": " And it only gets the keystrokes from the OpenVPN."
    },
    {
      "Time_Start": 1787.34,
      "Time_End": 1789.02,
      "Text": " So there will be no additional prompt,"
    },
    {
      "Time_Start": 1789.78,
      "Time_End": 1794.02,
      "Text": " because a developer may decide to get the keystrokes"
    },
    {
      "Time_Start": 1794.02,
      "Time_End": 1796.34,
      "Text": " information when, for example, they develop a game,"
    },
    {
      "Time_Start": 1796.34,
      "Time_End": 1799.98,
      "Text": " because they want to have control of what keystrokes are"
    },
    {
      "Time_Start": 1799.98,
      "Time_End": 1801.34,
      "Text": " sent to the application."
    },
    {
      "Time_Start": 1801.34,
      "Time_End": 1803.06,
      "Text": " So that's the code."
    },
    {
      "Time_Start": 1803.06,
      "Time_End": 1805.34,
      "Text": " It's publicly available on GitHub."
    },
    {
      "Time_Start": 1805.34,
      "Time_End": 1808.3,
      "Text": " So feel free to use it."
    },
    {
      "Time_Start": 1808.3,
      "Time_End": 1812.1,
      "Text": " So with this technique, on the first screenshot,"
    },
    {
      "Time_Start": 1812.1,
      "Time_End": 1813.98,
      "Text": " you can see that we were able to,"
    },
    {
      "Time_Start": 1813.98,
      "Time_End": 1816.54,
      "Text": " with the build insert libraries, we"
    },
    {
      "Time_Start": 1816.58,
      "Time_End": 1819.3799999999999,
      "Text": " were able to inject to OpenVPN without, again,"
    },
    {
      "Time_Start": 1819.3799999999999,
      "Time_End": 1820.86,
      "Text": " without any additional permission,"
    },
    {
      "Time_Start": 1820.86,
      "Time_End": 1823.78,
      "Text": " no root, no anything more."
    },
    {
      "Time_Start": 1823.78,
      "Time_End": 1827.26,
      "Text": " And then on the second screenshot,"
    },
    {
      "Time_Start": 1827.26,
      "Time_End": 1830.1399999999999,
      "Text": " this keylogger is really simple."
    },
    {
      "Time_Start": 1830.1399999999999,
      "Time_End": 1835.22,
      "Text": " It just locks any keystroke that was pressed."
    },
    {
      "Time_Start": 1835.22,
      "Time_End": 1837.82,
      "Text": " So as you can see, a recorded string password."
    },
    {
      "Time_Start": 1837.82,
      "Time_End": 1839.8999999999999,
      "Text": " So we were able, without any additional permission,"
    },
    {
      "Time_Start": 1839.8999999999999,
      "Time_End": 1845.1399999999999,
      "Text": " to inject to OpenVPN and listen for the user's credentials."
    },
    {
      "Time_Start": 1845.14,
      "Time_End": 1849.8200000000002,
      "Text": " So we have the access to the VPN."
    },
    {
      "Time_Start": 1849.8200000000002,
      "Time_End": 1855.14,
      "Text": " So now let's focus on Nomad and Active Directory."
    },
    {
      "Time_Start": 1855.14,
      "Time_End": 1858.5800000000002,
      "Text": " So Nomad saves your ID credentials"
    },
    {
      "Time_Start": 1858.5800000000002,
      "Time_End": 1860.3400000000001,
      "Text": " to macOS Keychain, which is good."
    },
    {
      "Time_Start": 1860.3400000000001,
      "Time_End": 1863.7800000000002,
      "Text": " That's the storage developers are supposed"
    },
    {
      "Time_Start": 1863.7800000000002,
      "Time_End": 1865.5800000000002,
      "Text": " to store their secret in."
    },
    {
      "Time_Start": 1865.5800000000002,
      "Time_End": 1869.66,
      "Text": " Like on macOS, in iOS, and Apple TV, and other Apple devices,"
    },
    {
      "Time_Start": 1869.66,
      "Time_End": 1875.0200000000002,
      "Text": " Keychain is the place where you want to have your credential,"
    },
    {
      "Time_Start": 1875.3799999999999,
      "Time_End": 1878.5,
      "Text": " your secret data, stored in."
    },
    {
      "Time_Start": 1878.5,
      "Time_End": 1880.26,
      "Text": " However, the Keychain has a flaw,"
    },
    {
      "Time_Start": 1880.26,
      "Time_End": 1882.7,
      "Text": " and Apple knows about it, that allows"
    },
    {
      "Time_Start": 1882.7,
      "Time_End": 1886.74,
      "Text": " getting from it entries without any additional prompt,"
    },
    {
      "Time_Start": 1886.74,
      "Time_End": 1888.98,
      "Text": " root access, or user's password."
    },
    {
      "Time_Start": 1888.98,
      "Time_End": 1892.3799999999999,
      "Text": " And I've even documented it on my blog."
    },
    {
      "Time_Start": 1892.3799999999999,
      "Time_End": 1894.34,
      "Text": " So if you are interested in this topic,"
    },
    {
      "Time_Start": 1894.34,
      "Time_End": 1898.42,
      "Text": " feel free to visit the String macOS Apps Keychain entries"
    },
    {
      "Time_Start": 1898.42,
      "Time_End": 1900.26,
      "Text": " post."
    },
    {
      "Time_Start": 1900.26,
      "Time_End": 1903.7,
      "Text": " And especially for my new macOS Red Teaming series,"
    },
    {
      "Time_Start": 1903.78,
      "Time_End": 1906.38,
      "Text": " I've created a Nomad Credential Stealer tool"
    },
    {
      "Time_Start": 1906.38,
      "Time_End": 1909.26,
      "Text": " that is, of course, again, open source and free to use,"
    },
    {
      "Time_Start": 1909.26,
      "Time_End": 1914.38,
      "Text": " which will use this tricky Keychain flow"
    },
    {
      "Time_Start": 1914.38,
      "Time_End": 1918.74,
      "Text": " to take the Keychain entries."
    },
    {
      "Time_Start": 1918.74,
      "Time_End": 1922.46,
      "Text": " So in the Nomad case, these entries"
    },
    {
      "Time_Start": 1922.46,
      "Time_End": 1925.38,
      "Text": " will be your ID login and ID password."
    },
    {
      "Time_Start": 1925.38,
      "Time_End": 1927.3400000000001,
      "Text": " So again, without any additional prompt,"
    },
    {
      "Time_Start": 1927.3400000000001,
      "Time_End": 1930.22,
      "Text": " without root permission, you run this tool."
    },
    {
      "Time_Start": 1930.22,
      "Time_End": 1933.66,
      "Text": " And if somebody uses Nomad, it gets the ID credentials."
    },
    {
      "Time_Start": 1934.6200000000001,
      "Time_End": 1937.0600000000002,
      "Text": " So yeah, we have access to the OpenVPN."
    },
    {
      "Time_Start": 1937.0600000000002,
      "Time_End": 1938.94,
      "Text": " We have our credentials."
    },
    {
      "Time_Start": 1938.94,
      "Time_End": 1942.74,
      "Text": " And in most cases, in such an infrastructure,"
    },
    {
      "Time_Start": 1942.74,
      "Time_End": 1943.78,
      "Text": " we will have access."
    },
    {
      "Time_Start": 1943.78,
      "Time_End": 1945.66,
      "Text": " Because we have ID credentials, we"
    },
    {
      "Time_Start": 1945.66,
      "Time_End": 1948.5,
      "Text": " will have access to Active Directory Federation"
    },
    {
      "Time_Start": 1948.5,
      "Time_End": 1949.42,
      "Text": " services."
    },
    {
      "Time_Start": 1949.42,
      "Time_End": 1954.02,
      "Text": " And because it's an SSO, the company's resources"
    },
    {
      "Time_Start": 1954.02,
      "Time_End": 1957.14,
      "Text": " are now available to us."
    },
    {
      "Time_Start": 1957.14,
      "Time_End": 1957.8200000000002,
      "Text": " All right."
    },
    {
      "Time_Start": 1957.82,
      "Time_End": 1963.6599999999999,
      "Text": " So now let's focus on signal messages."
    },
    {
      "Time_Start": 1967.1,
      "Time_End": 1970.34,
      "Text": " Is signal secure?"
    },
    {
      "Time_Start": 1970.34,
      "Time_End": 1973.1,
      "Text": " That's a question to you."
    },
    {
      "Time_Start": 1973.1,
      "Time_End": 1973.6,
      "Text": " Huh?"
    },
    {
      "Time_Start": 1973.6,
      "Time_End": 1974.6599999999999,
      "Text": " I hope so."
    },
    {
      "Time_Start": 1974.6599999999999,
      "Time_End": 1977.4199999999998,
      "Text": " You hope so?"
    },
    {
      "Time_Start": 1977.4199999999998,
      "Time_End": 1978.9399999999998,
      "Text": " I hope so, too."
    },
    {
      "Time_Start": 1978.9399999999998,
      "Time_End": 1983.82,
      "Text": " But signal is a really good messenger."
    },
    {
      "Time_Start": 1983.82,
      "Time_End": 1986.4199999999998,
      "Text": " I personally use it."
    },
    {
      "Time_Start": 1986.42,
      "Time_End": 1990.74,
      "Text": " However, as signal claims, they only"
    },
    {
      "Time_Start": 1990.74,
      "Time_End": 1996.6200000000001,
      "Text": " provide security for transit."
    },
    {
      "Time_Start": 1996.6200000000001,
      "Time_End": 1998.8600000000001,
      "Text": " So they don't care about your endpoint security."
    },
    {
      "Time_Start": 2001.5800000000002,
      "Time_End": 2005.8600000000001,
      "Text": " However, the signal database that you add on Mac"
    },
    {
      "Time_Start": 2005.8600000000001,
      "Time_End": 2007.98,
      "Text": " is encrypted."
    },
    {
      "Time_Start": 2007.98,
      "Time_End": 2011.22,
      "Text": " The messages are stored in an SQLite database,"
    },
    {
      "Time_Start": 2011.22,
      "Time_End": 2012.8200000000002,
      "Text": " which is encrypted."
    },
    {
      "Time_Start": 2012.8200000000002,
      "Time_End": 2016.22,
      "Text": " However, what about the key?"
    },
    {
      "Time_Start": 2016.22,
      "Time_End": 2018.46,
      "Text": " The key is stored in a flat file"
    },
    {
      "Time_Start": 2018.46,
      "Time_End": 2020.66,
      "Text": " that you can access without, again,"
    },
    {
      "Time_Start": 2020.66,
      "Time_End": 2022.58,
      "Text": " any additional permissions."
    },
    {
      "Time_Start": 2022.58,
      "Time_End": 2025.78,
      "Text": " So you take the database."
    },
    {
      "Time_Start": 2025.78,
      "Time_End": 2030.34,
      "Text": " You go to library application support signal config.json."
    },
    {
      "Time_Start": 2030.34,
      "Time_End": 2033.14,
      "Text": " You provide the key that's marked on the red"
    },
    {
      "Time_Start": 2033.14,
      "Time_End": 2036.18,
      "Text": " to the DB browser, for example."
    },
    {
      "Time_Start": 2036.18,
      "Time_End": 2038.18,
      "Text": " And you have access to all the signal messages"
    },
    {
      "Time_Start": 2038.18,
      "Time_End": 2040.06,
      "Text": " without any additional permission."
    },
    {
      "Time_Start": 2040.6599999999999,
      "Time_End": 2047.5,
      "Text": " Do you know if the signal is for other signal implementations?"
    },
    {
      "Time_Start": 2047.5,
      "Time_End": 2048.9,
      "Text": " For other signal implementations?"
    },
    {
      "Time_Start": 2048.9,
      "Time_End": 2052.02,
      "Text": " I know that on Windows, it worked the same."
    },
    {
      "Time_Start": 2052.02,
      "Time_End": 2054.82,
      "Text": " I don't know how it works now."
    },
    {
      "Time_Start": 2054.82,
      "Time_End": 2056.06,
      "Text": " So I will repeat the question."
    },
    {
      "Time_Start": 2056.06,
      "Time_End": 2059.34,
      "Text": " The question was, if on other platforms,"
    },
    {
      "Time_Start": 2059.34,
      "Time_End": 2061.82,
      "Text": " signal works the same."
    },
    {
      "Time_Start": 2061.82,
      "Time_End": 2065.94,
      "Text": " And as far as I know, on Windows, it worked the same."
    },
    {
      "Time_Start": 2065.94,
      "Time_End": 2068.06,
      "Text": " And on Linux, probably also."
    },
    {
      "Time_Start": 2068.06,
      "Time_End": 2072.2599999999998,
      "Text": " But that's a presentation about Mac, so on Mac,"
    },
    {
      "Time_Start": 2072.2599999999998,
      "Time_End": 2075.42,
      "Text": " it's in a flat file."
    },
    {
      "Time_Start": 2075.42,
      "Time_End": 2078.66,
      "Text": " All right, so we have access to the company's resources."
    },
    {
      "Time_Start": 2078.66,
      "Time_End": 2080.94,
      "Text": " We have access to the signal."
    },
    {
      "Time_Start": 2080.94,
      "Time_End": 2083.22,
      "Text": " Let's now focus on Firefox."
    },
    {
      "Time_Start": 2083.22,
      "Time_End": 2087.46,
      "Text": " So Firefox stores saved logins and passwords"
    },
    {
      "Time_Start": 2087.46,
      "Time_End": 2089.62,
      "Text": " in an encrypted form."
    },
    {
      "Time_Start": 2089.62,
      "Time_End": 2090.62,
      "Text": " So it is encrypted."
    },
    {
      "Time_Start": 2090.62,
      "Time_End": 2093.06,
      "Text": " However, if master password is not set,"
    },
    {
      "Time_Start": 2093.06,
      "Time_End": 2095.38,
      "Text": " and that's the default configuration,"
    },
    {
      "Time_Start": 2095.42,
      "Time_End": 2098.2200000000003,
      "Text": " those credentials can be dumped without root."
    },
    {
      "Time_Start": 2098.2200000000003,
      "Time_End": 2101.3,
      "Text": " Again, any additional permissions."
    },
    {
      "Time_Start": 2101.3,
      "Time_End": 2104.3,
      "Text": " There is even a tool, this time not coded by me,"
    },
    {
      "Time_Start": 2104.3,
      "Time_End": 2108.06,
      "Text": " but by Unode, Firefox Decrypt."
    },
    {
      "Time_Start": 2108.06,
      "Time_End": 2109.6600000000003,
      "Text": " It's really simple."
    },
    {
      "Time_Start": 2109.6600000000003,
      "Time_End": 2110.82,
      "Text": " Let me show you a demo."
    },
    {
      "Time_Start": 2113.7400000000002,
      "Time_End": 2116.46,
      "Text": " So we're on Python."
    },
    {
      "Time_Start": 2116.46,
      "Time_End": 2119.94,
      "Text": " We choose the profile that we want to dump."
    },
    {
      "Time_Start": 2119.94,
      "Time_End": 2122.7000000000003,
      "Text": " And yeah, all the credentials saved in the Firefox"
    },
    {
      "Time_Start": 2123.4199999999996,
      "Time_End": 2125.74,
      "Text": " are dumped without any additional permission."
    },
    {
      "Time_Start": 2130.46,
      "Time_End": 2134.3799999999997,
      "Text": " So that's the situation we have now."
    },
    {
      "Time_Start": 2134.3799999999997,
      "Time_End": 2138.2599999999998,
      "Text": " And let's go to the TCC."
    },
    {
      "Time_Start": 2138.2599999999998,
      "Time_End": 2142.9399999999996,
      "Text": " So if you have iPhones or Macs, and you"
    },
    {
      "Time_Start": 2142.9399999999996,
      "Time_End": 2145.22,
      "Text": " install an application, a new application,"
    },
    {
      "Time_Start": 2145.22,
      "Time_End": 2149.1,
      "Text": " like for example, Microsoft Teams, or a browser,"
    },
    {
      "Time_Start": 2149.1,
      "Time_End": 2153.14,
      "Text": " and you join a video call, and the first time"
    },
    {
      "Time_Start": 2153.14,
      "Time_End": 2156.3399999999997,
      "Text": " you will see a prompt that this application wants"
    },
    {
      "Time_Start": 2156.3399999999997,
      "Time_End": 2157.7,
      "Text": " to access your camera."
    },
    {
      "Time_Start": 2157.7,
      "Time_End": 2159.54,
      "Text": " And you have to click on that prompt"
    },
    {
      "Time_Start": 2159.54,
      "Time_End": 2162.2599999999998,
      "Text": " in order to give the application access."
    },
    {
      "Time_Start": 2162.2599999999998,
      "Time_End": 2167.7799999999997,
      "Text": " And this mechanism on Mac and iOS is called TCC."
    },
    {
      "Time_Start": 2167.7799999999997,
      "Time_End": 2172.46,
      "Text": " So on the screenshot, you can see that I tried to list address"
    },
    {
      "Time_Start": 2172.46,
      "Time_End": 2174.94,
      "Text": " book from the terminal."
    },
    {
      "Time_Start": 2174.94,
      "Time_End": 2177.62,
      "Text": " And Mac has displayed me a prompt"
    },
    {
      "Time_Start": 2177.62,
      "Time_End": 2180.2999999999997,
      "Text": " that the terminal would like to access your contacts."
    },
    {
      "Time_Start": 2180.2999999999997,
      "Time_End": 2183.3399999999997,
      "Text": " And what's really good about TCC is"
    },
    {
      "Time_Start": 2183.3399999999997,
      "Time_End": 2186.74,
      "Text": " that Apple wanted to make sure that there is a clear user"
    },
    {
      "Time_Start": 2186.74,
      "Time_End": 2189.02,
      "Text": " consent on doing it."
    },
    {
      "Time_Start": 2189.02,
      "Time_End": 2192.2999999999997,
      "Text": " So even if you, for example, have root,"
    },
    {
      "Time_Start": 2192.2999999999997,
      "Time_End": 2193.8599999999997,
      "Text": " you cannot bypass this prompt."
    },
    {
      "Time_Start": 2193.8599999999997,
      "Time_End": 2195.66,
      "Text": " Because Apple wanted to know that there"
    },
    {
      "Time_Start": 2195.66,
      "Time_End": 2197.7,
      "Text": " is a user that clicks on the prompt"
    },
    {
      "Time_Start": 2197.7,
      "Time_End": 2202.42,
      "Text": " before opening your camera."
    },
    {
      "Time_Start": 2202.42,
      "Time_End": 2206.98,
      "Text": " And each Mac OS huge update, Apple"
    },
    {
      "Time_Start": 2206.98,
      "Time_End": 2210.42,
      "Text": " adds new resources that are protected by TCC."
    },
    {
      "Time_Start": 2210.42,
      "Time_End": 2215.1,
      "Text": " So like desktop, documents, downloads, camera, microphone,"
    },
    {
      "Time_Start": 2215.1,
      "Time_End": 2218.98,
      "Text": " screen sharing, contacts, automation, Bluetooth, photos."
    },
    {
      "Time_Start": 2218.98,
      "Time_End": 2221.38,
      "Text": " And a lot of stuff is now protected by the TCC."
    },
    {
      "Time_Start": 2221.38,
      "Time_End": 2224.54,
      "Text": " So yeah, on Mac OS, you are not a god if you have root."
    },
    {
      "Time_Start": 2228.62,
      "Time_End": 2231.02,
      "Text": " So let's confirm it with Mythic."
    },
    {
      "Time_Start": 2231.06,
      "Time_End": 2235.2599999999998,
      "Text": " So again, let's run a show."
    },
    {
      "Time_Start": 2235.2599999999998,
      "Time_End": 2237.9,
      "Text": " And we're going to list, for example, desktop."
    },
    {
      "Time_Start": 2242.9,
      "Time_End": 2246.02,
      "Text": " Schedule a task, and you will see the prompt."
    },
    {
      "Time_Start": 2246.02,
      "Time_End": 2247.94,
      "Text": " User doesn't allow on it."
    },
    {
      "Time_Start": 2247.94,
      "Time_End": 2250.22,
      "Text": " And you will see that we have an error,"
    },
    {
      "Time_Start": 2250.22,
      "Time_End": 2252.02,
      "Text": " that operation is not permitted."
    },
    {
      "Time_Start": 2255.78,
      "Time_End": 2259.66,
      "Text": " Yeah, so as I told you, accessing desktop documents,"
    },
    {
      "Time_Start": 2259.66,
      "Time_End": 2262.02,
      "Text": " microphone, et cetera, and other sensitive resources"
    },
    {
      "Time_Start": 2262.02,
      "Time_End": 2263.7799999999997,
      "Text": " will spawn a prompt."
    },
    {
      "Time_Start": 2263.7799999999997,
      "Time_End": 2267.62,
      "Text": " But the good thing is that there are tons of TCC bypasses."
    },
    {
      "Time_Start": 2267.62,
      "Time_End": 2271.58,
      "Text": " And last year, I was speaking a presentation"
    },
    {
      "Time_Start": 2271.58,
      "Time_End": 2275.7799999999997,
      "Text": " on Black Hat US in Las Vegas about bypassing Mac OS privacy"
    },
    {
      "Time_Start": 2275.7799999999997,
      "Time_End": 2276.7799999999997,
      "Text": " mechanisms."
    },
    {
      "Time_Start": 2276.7799999999997,
      "Time_End": 2281.42,
      "Text": " We found like 20 TCC bypasses."
    },
    {
      "Time_Start": 2281.42,
      "Time_End": 2285.2999999999997,
      "Text": " But yeah, still, they are all now fixed."
    },
    {
      "Time_Start": 2285.2999999999997,
      "Time_End": 2289.02,
      "Text": " Apple pays for the TCC bypasses in their Bug Bounty program."
    },
    {
      "Time_Start": 2289.02,
      "Time_End": 2293.02,
      "Text": " So there is a lot of pressure on securing TCC."
    },
    {
      "Time_Start": 2293.02,
      "Time_End": 2295.42,
      "Text": " So you can, of course, find your own zero day."
    },
    {
      "Time_Start": 2295.42,
      "Time_End": 2298.66,
      "Text": " But that's kind of problematic."
    },
    {
      "Time_Start": 2298.66,
      "Time_End": 2301.54,
      "Text": " So we will find another way, which"
    },
    {
      "Time_Start": 2301.54,
      "Time_End": 2304.34,
      "Text": " is abusing applications that are already"
    },
    {
      "Time_Start": 2304.34,
      "Time_End": 2308.14,
      "Text": " installed on your Mac machines."
    },
    {
      "Time_Start": 2308.14,
      "Time_End": 2310.5,
      "Text": " And typically, I also made a lot of blog posts"
    },
    {
      "Time_Start": 2310.5,
      "Time_End": 2311.94,
      "Text": " about bypassing TCC."
    },
    {
      "Time_Start": 2311.94,
      "Time_End": 2314.62,
      "Text": " But for example, most Electron applications"
    },
    {
      "Time_Start": 2314.62,
      "Time_End": 2319.98,
      "Text": " are now vulnerable to code injections."
    },
    {
      "Time_Start": 2319.98,
      "Time_End": 2322.74,
      "Text": " And those, because we will be executing code"
    },
    {
      "Time_Start": 2322.74,
      "Time_End": 2326.38,
      "Text": " in the Electron apps context, we will"
    },
    {
      "Time_Start": 2326.38,
      "Time_End": 2328.2999999999997,
      "Text": " have all the permissions that were already"
    },
    {
      "Time_Start": 2328.2999999999997,
      "Time_End": 2329.8599999999997,
      "Text": " granted to those applications."
    },
    {
      "Time_Start": 2329.8599999999997,
      "Time_End": 2331.5,
      "Text": " So for example, let's imagine you"
    },
    {
      "Time_Start": 2331.5,
      "Time_End": 2335.22,
      "Text": " want to access a camera on your victim's machine."
    },
    {
      "Time_Start": 2335.22,
      "Time_End": 2339.42,
      "Text": " And that victim uses in their company Microsoft Teams."
    },
    {
      "Time_Start": 2339.42,
      "Time_End": 2342.8599999999997,
      "Text": " So we can expect that those Microsoft Teams"
    },
    {
      "Time_Start": 2342.86,
      "Time_End": 2351.06,
      "Text": " have the camera screen sharing and recording already granted."
    },
    {
      "Time_Start": 2351.06,
      "Time_End": 2352.7000000000003,
      "Text": " So we can inject to Microsoft Teams"
    },
    {
      "Time_Start": 2352.7000000000003,
      "Time_End": 2356.1400000000003,
      "Text": " and use its permissions to bypass the TCC."
    },
    {
      "Time_Start": 2356.1400000000003,
      "Time_End": 2361.6200000000003,
      "Text": " However, there is even a better trick"
    },
    {
      "Time_Start": 2361.6200000000003,
      "Time_End": 2365.82,
      "Text": " that works in Mac OS environments,"
    },
    {
      "Time_Start": 2365.82,
      "Time_End": 2370.3,
      "Text": " because Macs are usually managed via the SSH."
    },
    {
      "Time_Start": 2370.3,
      "Time_End": 2375.54,
      "Text": " And because the SSH is used for administrative purposes,"
    },
    {
      "Time_Start": 2375.54,
      "Time_End": 2378.38,
      "Text": " the remote login, usually on those Macs,"
    },
    {
      "Time_Start": 2378.38,
      "Time_End": 2381.54,
      "Text": " have the allow full disk access for remote users."
    },
    {
      "Time_Start": 2381.54,
      "Time_End": 2383.1800000000003,
      "Text": " I will show it to you."
    },
    {
      "Time_Start": 2383.1800000000003,
      "Time_End": 2385.6200000000003,
      "Text": " So that's the problem."
    },
    {
      "Time_Start": 2385.6200000000003,
      "Time_End": 2387.3,
      "Text": " That's the checkbox that is usually"
    },
    {
      "Time_Start": 2387.3,
      "Time_End": 2392.6200000000003,
      "Text": " checked on the Mac OS machines in huge companies' environments."
    },
    {
      "Time_Start": 2392.6200000000003,
      "Time_End": 2396.52,
      "Text": " And if the shell has full disk access,"
    },
    {
      "Time_Start": 2396.52,
      "Time_End": 2400.2200000000003,
      "Text": " it means that the administrator, because it's an administrator,"
    },
    {
      "Time_Start": 2400.2200000000003,
      "Time_End": 2405.78,
      "Text": " can do almost everything on the Mac machines."
    },
    {
      "Time_Start": 2405.78,
      "Time_End": 2408.6200000000003,
      "Text": " What's really interesting, there is no TCC"
    },
    {
      "Time_Start": 2408.6200000000003,
      "Time_End": 2409.9800000000005,
      "Text": " when you have full disk access."
    },
    {
      "Time_Start": 2409.9800000000005,
      "Time_End": 2412.78,
      "Text": " This shell can access your desktop,"
    },
    {
      "Time_Start": 2412.78,
      "Time_End": 2414.7400000000002,
      "Text": " spawn a camera, et cetera, et cetera,"
    },
    {
      "Time_Start": 2414.7400000000002,
      "Time_End": 2417.1000000000004,
      "Text": " without any additional prompt."
    },
    {
      "Time_Start": 2417.1000000000004,
      "Time_End": 2419.86,
      "Text": " But yeah, that's for administrators, right?"
    },
    {
      "Time_Start": 2419.86,
      "Time_End": 2423.5400000000004,
      "Text": " However, there's a trick."
    },
    {
      "Time_Start": 2423.5400000000004,
      "Time_End": 2426.42,
      "Text": " Let's imagine that we don't have user's password"
    },
    {
      "Time_Start": 2426.42,
      "Time_End": 2429.2200000000003,
      "Text": " to the victim's machine."
    },
    {
      "Time_Start": 2429.2200000000003,
      "Time_End": 2432.6600000000003,
      "Text": " We have only the code execution that's un-sandboxed."
    },
    {
      "Time_Start": 2432.6600000000003,
      "Time_End": 2435.9,
      "Text": " We have the persistence already achieved,"
    },
    {
      "Time_Start": 2435.9,
      "Time_End": 2438.5800000000004,
      "Text": " but we want to access that SSH."
    },
    {
      "Time_Start": 2438.5800000000004,
      "Time_End": 2440.6200000000003,
      "Text": " How we can do this?"
    },
    {
      "Time_Start": 2440.6200000000003,
      "Time_End": 2441.6200000000003,
      "Text": " Do you have any idea?"
    },
    {
      "Time_Start": 2445.9,
      "Time_End": 2447.34,
      "Text": " Once again?"
    },
    {
      "Time_Start": 2447.34,
      "Time_End": 2448.6600000000003,
      "Text": " Drop SSH."
    },
    {
      "Time_Start": 2448.6600000000003,
      "Time_End": 2450.1000000000004,
      "Text": " That's a good idea."
    },
    {
      "Time_Start": 2450.1000000000004,
      "Time_End": 2452.34,
      "Text": " However, there will be another SSH"
    },
    {
      "Time_Start": 2452.34,
      "Time_End": 2454.86,
      "Text": " that will be not the system SSH, so the full disk"
    },
    {
      "Time_Start": 2454.86,
      "Time_End": 2457.0200000000004,
      "Text": " access for that SSH will not be granted."
    },
    {
      "Time_Start": 2459.5800000000004,
      "Time_End": 2461.86,
      "Text": " Yes, yes, yes."
    },
    {
      "Time_Start": 2461.86,
      "Time_End": 2467.78,
      "Text": " So when we are a user, we can add our own key"
    },
    {
      "Time_Start": 2467.78,
      "Time_End": 2469.1800000000003,
      "Text": " to authorized keys, right?"
    },
    {
      "Time_Start": 2469.1800000000003,
      "Time_End": 2472.9800000000005,
      "Text": " So the SSH authorized keys, and SSH to localhost"
    },
    {
      "Time_Start": 2472.9800000000005,
      "Time_End": 2475.34,
      "Text": " without providing a password."
    },
    {
      "Time_Start": 2475.34,
      "Time_End": 2478.7000000000003,
      "Text": " So let me show you a demo."
    },
    {
      "Time_Start": 2478.7000000000003,
      "Time_End": 2480.86,
      "Text": " So yeah, we go to desktop."
    },
    {
      "Time_Start": 2480.86,
      "Time_End": 2483.3,
      "Text": " The operation is not permitted because of the TCC."
    },
    {
      "Time_Start": 2484.3,
      "Time_End": 2490.02,
      "Text": " However, let's create our own SSH key again,"
    },
    {
      "Time_Start": 2490.02,
      "Time_End": 2491.1400000000003,
      "Text": " our own SSH key."
    },
    {
      "Time_Start": 2499.78,
      "Time_End": 2505.26,
      "Text": " As you can see, we provide empty password, passphrase."
    },
    {
      "Time_Start": 2505.26,
      "Time_End": 2510.82,
      "Text": " Then we copy the ID that we've created to the authorized keys."
    },
    {
      "Time_Start": 2513.5800000000004,
      "Time_End": 2515.42,
      "Text": " We set up the permissions of it."
    },
    {
      "Time_Start": 2518.94,
      "Time_End": 2523.7400000000002,
      "Text": " And now, using SSH and the user's account,"
    },
    {
      "Time_Start": 2523.7400000000002,
      "Time_End": 2525.02,
      "Text": " we SSH to localhost."
    },
    {
      "Time_Start": 2530.5,
      "Time_End": 2534.5,
      "Text": " All right, so we have the SSH session."
    },
    {
      "Time_Start": 2534.5,
      "Time_End": 2537.86,
      "Text": " And now, if we go to desktop, you"
    },
    {
      "Time_Start": 2537.86,
      "Time_End": 2541.26,
      "Text": " will see that we can access it without raising TCC"
    },
    {
      "Time_Start": 2541.26,
      "Time_End": 2548.1800000000003,
      "Text": " because of the full disk access permission that"
    },
    {
      "Time_Start": 2548.1800000000003,
      "Time_End": 2550.78,
      "Text": " is for administrative purposes."
    },
    {
      "Time_Start": 2550.78,
      "Time_End": 2554.5,
      "Text": " All right, so we bypassed the TCC."
    },
    {
      "Time_Start": 2554.5,
      "Time_End": 2559.3,
      "Text": " But what about the SSH keys, AWS, Azure, Google Cloud"
    },
    {
      "Time_Start": 2559.3,
      "Time_End": 2560.82,
      "Text": " credentials, et cetera?"
    },
    {
      "Time_Start": 2560.82,
      "Time_End": 2563.7000000000003,
      "Text": " That's another good news for you."
    },
    {
      "Time_Start": 2563.7000000000003,
      "Time_End": 2567.46,
      "Text": " There are, by default, stored in home directory, which"
    },
    {
      "Time_Start": 2567.46,
      "Time_End": 2569.5,
      "Text": " is not protected by the TCC."
    },
    {
      "Time_Start": 2569.54,
      "Time_End": 2573.58,
      "Text": " So you don't even have to care about it."
    },
    {
      "Time_Start": 2573.58,
      "Time_End": 2576.14,
      "Text": " All right, so that was the last step."
    },
    {
      "Time_Start": 2576.14,
      "Time_End": 2579.82,
      "Text": " And we have taken over the Mac OS machine."
    },
    {
      "Time_Start": 2583.26,
      "Time_End": 2585.58,
      "Text": " And because I don't want to leave you"
    },
    {
      "Time_Start": 2585.58,
      "Time_End": 2589.94,
      "Text": " without any recommendations, there are six that I know"
    },
    {
      "Time_Start": 2589.94,
      "Time_End": 2593.46,
      "Text": " that implementing all those mechanisms is a process."
    },
    {
      "Time_Start": 2593.46,
      "Time_End": 2595.58,
      "Text": " But there are the six points that you at least"
    },
    {
      "Time_Start": 2595.58,
      "Time_End": 2598.14,
      "Text": " have to implement in the infrastructures."
    },
    {
      "Time_Start": 2598.18,
      "Time_End": 2600.98,
      "Text": " So the first one, I know they're really obvious,"
    },
    {
      "Time_Start": 2600.98,
      "Time_End": 2605.3799999999997,
      "Text": " but I repeat it every talk about Mac OS security."
    },
    {
      "Time_Start": 2605.3799999999997,
      "Time_End": 2609.3399999999997,
      "Text": " So enroll your Macs to MDM."
    },
    {
      "Time_Start": 2609.3399999999997,
      "Time_End": 2614.02,
      "Text": " You need to centralize the manage those Macs, right?"
    },
    {
      "Time_Start": 2614.02,
      "Time_End": 2615.1,
      "Text": " Keep them updated."
    },
    {
      "Time_Start": 2615.1,
      "Time_End": 2618.58,
      "Text": " As you can see, Macs have zero days, have vulnerabilities."
    },
    {
      "Time_Start": 2618.58,
      "Time_End": 2620.58,
      "Text": " You have to update your Macs."
    },
    {
      "Time_Start": 2620.58,
      "Time_End": 2623.5,
      "Text": " Enforce policies like system integrity protection."
    },
    {
      "Time_Start": 2623.5,
      "Time_End": 2626.42,
      "Text": " For example, without system integrity protection,"
    },
    {
      "Time_Start": 2626.42,
      "Time_End": 2629.1,
      "Text": " you can elevate your privileges to root."
    },
    {
      "Time_Start": 2629.1,
      "Time_End": 2633.26,
      "Text": " You can bypass the TCC, or maybe not even bypass,"
    },
    {
      "Time_Start": 2633.26,
      "Time_End": 2637.54,
      "Text": " because if SIP is disabled, there is even no TCC."
    },
    {
      "Time_Start": 2637.54,
      "Time_End": 2641.1800000000003,
      "Text": " The TCC is disabled, too, as well."
    },
    {
      "Time_Start": 2641.1800000000003,
      "Time_End": 2643.9,
      "Text": " Enforce firewall, gatekeeper, which"
    },
    {
      "Time_Start": 2643.9,
      "Time_End": 2645.86,
      "Text": " makes sure that all the applications are not"
    },
    {
      "Time_Start": 2645.86,
      "Time_End": 2647.82,
      "Text": " authorized before opening."
    },
    {
      "Time_Start": 2647.82,
      "Time_End": 2651.2200000000003,
      "Text": " File vault, which is responsible for encryption, et cetera,"
    },
    {
      "Time_Start": 2651.2200000000003,
      "Time_End": 2652.94,
      "Text": " et cetera."
    },
    {
      "Time_Start": 2652.94,
      "Time_End": 2657.86,
      "Text": " I bet that nowadays, when you have a Mac OS environment,"
    },
    {
      "Time_Start": 2657.86,
      "Time_End": 2661.78,
      "Text": " people do not use word macros mostly,"
    },
    {
      "Time_Start": 2661.78,
      "Time_End": 2665.42,
      "Text": " because they are quite limited comparing to Windows macros."
    },
    {
      "Time_Start": 2665.42,
      "Time_End": 2669.7000000000003,
      "Text": " So if your company doesn't use macros on Macs,"
    },
    {
      "Time_Start": 2669.7000000000003,
      "Time_End": 2672.34,
      "Text": " you can disable it globally."
    },
    {
      "Time_Start": 2672.34,
      "Time_End": 2675.38,
      "Text": " Install an anti-malware solution,"
    },
    {
      "Time_Start": 2675.38,
      "Time_End": 2680.98,
      "Text": " because as you can see, as you could see during the talk,"
    },
    {
      "Time_Start": 2680.98,
      "Time_End": 2682.7000000000003,
      "Text": " there is malware for Macs."
    },
    {
      "Time_Start": 2683.3,
      "Time_End": 2687.6200000000003,
      "Text": " Because of the zero days monitor on Mac machines,"
    },
    {
      "Time_Start": 2687.6200000000003,
      "Time_End": 2693.26,
      "Text": " they are not 100% secure if you follow the first five steps."
    },
    {
      "Time_Start": 2693.26,
      "Time_End": 2697.2200000000003,
      "Text": " If you'd like to verify your Mac OS environment security"
    },
    {
      "Time_Start": 2697.2200000000003,
      "Time_End": 2702.4600000000005,
      "Text": " or do a red teaming scenarios in your infrastructure,"
    },
    {
      "Time_Start": 2702.4600000000005,
      "Time_End": 2705.34,
      "Text": " you can hire us to do it."
    },
    {
      "Time_Start": 2705.34,
      "Time_End": 2707.7400000000002,
      "Text": " All right, so summing up."
    },
    {
      "Time_Start": 2707.7400000000002,
      "Time_End": 2711.94,
      "Text": " That will be the quickest sum up ever."
    },
    {
      "Time_Start": 2711.94,
      "Time_End": 2715.14,
      "Text": " Macs, like other machines, can be infected."
    },
    {
      "Time_Start": 2715.14,
      "Time_End": 2716.78,
      "Text": " If you have Macs in your machine,"
    },
    {
      "Time_Start": 2716.78,
      "Time_End": 2719.7000000000003,
      "Text": " if you have Mac machines in your environment,"
    },
    {
      "Time_Start": 2719.7000000000003,
      "Time_End": 2723.98,
      "Text": " don't make them a blind spot, not seen by your socks."
    },
    {
      "Time_Start": 2723.98,
      "Time_End": 2725.94,
      "Text": " Thank you very much."
    }
  ]
}