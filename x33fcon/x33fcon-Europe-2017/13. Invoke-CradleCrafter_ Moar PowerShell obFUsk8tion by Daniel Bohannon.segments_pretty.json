{
  "segments": [
    {
      "Time_Start": 0.0,
      "Time_End": 14.72,
      "Text": "This text was transcribed using whisper model: large-v2\n\n Thank you very much."
    },
    {
      "Time_Start": 14.72,
      "Time_End": 18.44,
      "Text": " So yeah, my name is Daniel Bohannon, and today we're going to look for the first time in"
    },
    {
      "Time_Start": 18.44,
      "Time_End": 24.52,
      "Text": " public at a new tool that I released about 20 minutes ago called Invoke Cradle Crafter."
    },
    {
      "Time_Start": 24.52,
      "Time_End": 25.52,
      "Text": " So just a little bit about me."
    },
    {
      "Time_Start": 25.52,
      "Time_End": 29.72,
      "Text": " I am an incident response consultant with Mandiant, based out of the Washington, D.C."
    },
    {
      "Time_Start": 29.72,
      "Time_End": 30.72,
      "Text": " area."
    },
    {
      "Time_Start": 30.72,
      "Time_End": 31.72,
      "Text": " Been there for about two years."
    },
    {
      "Time_Start": 31.72,
      "Time_End": 35.519999999999996,
      "Text": " Prior to that, spent about five years doing IT operations and security for a restaurant"
    },
    {
      "Time_Start": 35.519999999999996,
      "Time_End": 37.92,
      "Text": " franchise in the U.S."
    },
    {
      "Time_Start": 37.92,
      "Time_End": 42.36,
      "Text": " And my day-to-day role pretty much looks like incident response as well as threat hunting"
    },
    {
      "Time_Start": 42.36,
      "Time_End": 48.44,
      "Text": " kind of detection, evasion, obfuscation techniques and research, and actually applying that in"
    },
    {
      "Time_Start": 48.44,
      "Time_End": 49.480000000000004,
      "Text": " the real world."
    },
    {
      "Time_Start": 49.480000000000004,
      "Time_End": 55.720000000000006,
      "Text": " So in January, I was speaking at a conference, and this gentleman tweeted, Daniel Bohannon,"
    },
    {
      "Time_Start": 55.720000000000006,
      "Time_End": 58.2,
      "Text": " true American, always has a cat in the presentation."
    },
    {
      "Time_Start": 58.2,
      "Time_End": 62.220000000000006,
      "Text": " So I figured maybe, I didn't realize I was such a strong stereotype, but given all the"
    },
    {
      "Time_Start": 62.220000000000006,
      "Time_End": 64.48,
      "Text": " presentations today, it definitely is."
    },
    {
      "Time_Start": 64.48,
      "Time_End": 70.2,
      "Text": " So I figured I would counter with that, a nice little American meme."
    },
    {
      "Time_Start": 70.2,
      "Time_End": 74.12,
      "Text": " But to be fair, the best one, and probably the more accurate one, is this, a nice oversized"
    },
    {
      "Time_Start": 74.12,
      "Time_End": 76.04,
      "Text": " cat with Starbucks."
    },
    {
      "Time_Start": 76.04,
      "Time_End": 80.48,
      "Text": " So sorry, Eli, I had to get one cat meme in there, but I promise that's all."
    },
    {
      "Time_Start": 80.48,
      "Time_End": 81.48,
      "Text": " So what are we going to look at today?"
    },
    {
      "Time_Start": 81.48,
      "Time_End": 86.48,
      "Text": " First, I'm going to just briefly talk about my motivation of why am I still researching"
    },
    {
      "Time_Start": 86.48,
      "Time_End": 87.48,
      "Text": " obfuscation?"
    },
    {
      "Time_Start": 87.48,
      "Time_End": 90.60000000000001,
      "Text": " Haven't I caused us defenders enough trouble with that?"
    },
    {
      "Time_Start": 90.60000000000001,
      "Time_End": 94.32000000000001,
      "Text": " And then we're going to look at the current state of PowerShell obfuscation, as well as"
    },
    {
      "Time_Start": 94.32000000000001,
      "Time_End": 97.92,
      "Text": " the current state of detecting this obfuscation."
    },
    {
      "Time_Start": 97.92,
      "Time_End": 101.88000000000001,
      "Text": " And then we're going to look at the new stuff, looking at really cryptic cradles from three"
    },
    {
      "Time_Start": 101.88,
      "Time_End": 105.92,
      "Text": " different perspectives, from a syntax, a kind of cradle genre perspective, as well"
    },
    {
      "Time_Start": 105.92,
      "Time_End": 111.8,
      "Text": " as obfuscation that we can apply at the token layer that's not an invoke obfuscation, and"
    },
    {
      "Time_Start": 111.8,
      "Time_End": 116.56,
      "Text": " then looking at a myriad of different invocation syntaxes that as defenders we should be aware"
    },
    {
      "Time_Start": 116.56,
      "Time_End": 117.56,
      "Text": " of and be looking for."
    },
    {
      "Time_Start": 117.56,
      "Time_End": 122.91999999999999,
      "Text": " Then we're going to look at detecting these cryptic cradles, or our best efforts at starting"
    },
    {
      "Time_Start": 122.91999999999999,
      "Time_End": 129.56,
      "Text": " to do that, as well as finally a live demo, and hopefully that goes well."
    },
    {
      "Time_Start": 129.56,
      "Time_End": 133.84,
      "Text": " A few disclaimers, and this comes from a lot of questions I've gotten in the past when"
    },
    {
      "Time_Start": 133.84,
      "Time_End": 136.74,
      "Text": " I talk about this, or this sort of material."
    },
    {
      "Time_Start": 136.74,
      "Time_End": 140.12,
      "Text": " First of all, blocking PowerShell is not a realistic option."
    },
    {
      "Time_Start": 140.12,
      "Time_End": 145.0,
      "Text": " And in one short sentence, that's because PowerShell.exe is not PowerShell."
    },
    {
      "Time_Start": 145.0,
      "Time_End": 150.04,
      "Text": " And a great, a really simple way, it's completely different to think about it, is if your attacker"
    },
    {
      "Time_Start": 150.04,
      "Time_End": 154.48000000000002,
      "Text": " renames PowerShell.exe, how good is that if you're trying to only block PowerShell.exe?"
    },
    {
      "Time_Start": 154.48000000000002,
      "Time_End": 158.36,
      "Text": " So you can obviously go deeper, look at internal file name, but it's not a great option, and"
    },
    {
      "Time_Start": 158.36,
      "Time_End": 161.88000000000002,
      "Text": " there's a lot more good that you can do with PowerShell, especially if you're on the latest"
    },
    {
      "Time_Start": 161.88000000000002,
      "Time_End": 163.76000000000002,
      "Text": " version of PowerShell."
    },
    {
      "Time_Start": 163.76000000000002,
      "Time_End": 168.68,
      "Text": " This leads to the second point, which is a quote from noted blue teamer Jared Haight,"
    },
    {
      "Time_Start": 168.68,
      "Time_End": 170.56,
      "Text": " and that is, PowerShell is not special."
    },
    {
      "Time_Start": 170.56,
      "Time_End": 174.32000000000002,
      "Text": " And what he means by that is that there's a lot of reports that talk about the increase"
    },
    {
      "Time_Start": 174.32000000000002,
      "Time_End": 180.08,
      "Text": " in malicious uses of PowerShell, but almost all of those are in cases where the attacker"
    },
    {
      "Time_Start": 180.08,
      "Time_End": 182.84,
      "Text": " already has code execution on the system."
    },
    {
      "Time_Start": 182.84,
      "Time_End": 186.88000000000002,
      "Text": " So if your user opens a macro, or opens a document, enables a macro, and PowerShell"
    },
    {
      "Time_Start": 186.88,
      "Time_End": 191.4,
      "Text": " happens to be used to download a binary, that's not a PowerShell problem, that's a user opening"
    },
    {
      "Time_Start": 191.4,
      "Time_End": 193.16,
      "Text": " a freaking macro problem."
    },
    {
      "Time_Start": 193.16,
      "Time_End": 197.24,
      "Text": " PowerShell does happen to be their tool of choice to download the file."
    },
    {
      "Time_Start": 197.24,
      "Time_End": 201.4,
      "Text": " And lastly, PowerShell 5.0 is your new best friend, and I say new, because it's been around"
    },
    {
      "Time_Start": 201.4,
      "Time_End": 206.28,
      "Text": " since 2014, and there's just two really good blog posts looking at, the first one specifically"
    },
    {
      "Time_Start": 206.28,
      "Time_End": 211.84,
      "Text": " logging around PowerShell 5, and the second one is by Microsoft, a really great blog post"
    },
    {
      "Time_Start": 211.84,
      "Time_End": 216.56,
      "Text": " and white paper on all the benefits of PowerShell 5."
    },
    {
      "Time_Start": 216.56,
      "Time_End": 219.16,
      "Text": " So my motivation."
    },
    {
      "Time_Start": 219.16,
      "Time_End": 222.88,
      "Text": " Attackers are obfuscating, and they have been for a while, and for some reason in the past"
    },
    {
      "Time_Start": 222.88,
      "Time_End": 226.04,
      "Text": " six months they've been doing it a lot more, I don't know why."
    },
    {
      "Time_Start": 226.04,
      "Time_End": 232.48,
      "Text": " And PowerShell is such a great platform for them because it's native on all modern Windows"
    },
    {
      "Time_Start": 232.48,
      "Time_End": 238.84,
      "Text": " operating systems, it's signed, Windows binary, and typically it's whitelisted if app whitelisting"
    },
    {
      "Time_Start": 238.84,
      "Time_End": 241.04,
      "Text": " isn't in the environment."
    },
    {
      "Time_Start": 241.04,
      "Time_End": 244.6,
      "Text": " So once InvokeShellCode and InvokeMemeCats came to be, the security community really"
    },
    {
      "Time_Start": 244.6,
      "Time_End": 248.96,
      "Text": " started to take notice and we started to see a proliferation of offensive PowerShell"
    },
    {
      "Time_Start": 248.96,
      "Time_End": 252.0,
      "Text": " frameworks, as well as defensive as well."
    },
    {
      "Time_Start": 252.0,
      "Time_End": 256.12,
      "Text": " And it's really, for all practical reasons, impossible to detect this kind of usage of"
    },
    {
      "Time_Start": 256.12,
      "Time_End": 260.32,
      "Text": " PowerShell if you don't at a very minimum have command line logging or command line"
    },
    {
      "Time_Start": 260.32,
      "Time_End": 266.24,
      "Text": " auditing, but really what you want to get to is having the script lock module and transcription"
    },
    {
      "Time_Start": 266.24,
      "Time_End": 269.96,
      "Text": " logs that PowerShell 5 makes available."
    },
    {
      "Time_Start": 269.96,
      "Time_End": 273.0,
      "Text": " So what's my obsession with obfuscation, why do I keep doing it?"
    },
    {
      "Time_Start": 273.0,
      "Time_End": 277.68,
      "Text": " One of my colleagues said, what's your sickness, like why don't you just be okay with where"
    },
    {
      "Time_Start": 277.68,
      "Time_End": 278.68,
      "Text": " it's at?"
    },
    {
      "Time_Start": 278.68,
      "Time_End": 283.36,
      "Text": " And this is because this is really taking the whole realm of obfuscation and looking"
    },
    {
      "Time_Start": 283.36,
      "Time_End": 287.66,
      "Text": " directly at one of the main things that attackers like to do, which is download and execute"
    },
    {
      "Time_Start": 287.66,
      "Time_End": 290.56,
      "Text": " remote code with PowerShell."
    },
    {
      "Time_Start": 290.56,
      "Time_End": 296.12,
      "Text": " And so with this, this really started by looking and documenting obscure cradle syntaxes that"
    },
    {
      "Time_Start": 296.12,
      "Time_End": 299.84,
      "Text": " we see, strangely enough, commodity malware using some of the more interesting ones, and"
    },
    {
      "Time_Start": 299.84000000000003,
      "Time_End": 305.56000000000006,
      "Text": " then enumerating that and finding cradles I have yet to see be used in the wild and"
    },
    {
      "Time_Start": 305.56000000000006,
      "Time_End": 306.96000000000004,
      "Text": " cataloging that."
    },
    {
      "Time_Start": 306.96000000000004,
      "Time_End": 310.88000000000005,
      "Text": " And I put all of this into this tool to kind of make it like a living library, because"
    },
    {
      "Time_Start": 310.88000000000005,
      "Time_End": 316.52000000000004,
      "Text": " to be honest, I got tired of copying and pasting out of my notes and having syntax errors and"
    },
    {
      "Time_Start": 316.52000000000004,
      "Time_End": 321.88000000000005,
      "Text": " having to replace stuff, so a tool is definitely the easiest way to keep that in check."
    },
    {
      "Time_Start": 321.88000000000005,
      "Time_End": 325.40000000000003,
      "Text": " So the current state of PowerShell obfuscation, where are we at today?"
    },
    {
      "Time_Start": 325.40000000000003,
      "Time_End": 328.76000000000005,
      "Text": " Well this has really been my life for the past year and a half."
    },
    {
      "Time_Start": 328.76,
      "Time_End": 334.52,
      "Text": " And as a defender, I get really excited when I find interesting PowerShell artifacts."
    },
    {
      "Time_Start": 334.52,
      "Time_End": 338.92,
      "Text": " And in my day-to-day, what I've been doing for the past year and a half has been working"
    },
    {
      "Time_Start": 338.92,
      "Time_End": 343.88,
      "Text": " on host-based and network-based detection, mainly for PowerShell, but for other stuff"
    },
    {
      "Time_Start": 343.88,
      "Time_End": 344.88,
      "Text": " as well."
    },
    {
      "Time_Start": 344.88,
      "Time_End": 350.24,
      "Text": " And it wasn't until I got to be able to play with our tool called HIP, which is our"
    },
    {
      "Time_Start": 350.24,
      "Time_End": 352.52,
      "Text": " real-time agent that we use in investigations."
    },
    {
      "Time_Start": 352.52,
      "Time_End": 355.0,
      "Text": " It stands for Host Investigative Platform."
    },
    {
      "Time_Start": 355.0,
      "Time_End": 358.28,
      "Text": " Once I started to do this, I was able to see the results really, really quickly."
    },
    {
      "Time_Start": 358.28000000000003,
      "Time_End": 363.08000000000004,
      "Text": " And I basically started to come up with obscure syntaxes to get around our trigger logic."
    },
    {
      "Time_Start": 363.08000000000004,
      "Time_End": 365.16,
      "Text": " And I would go to the owner and say, hey, can we update this?"
    },
    {
      "Time_Start": 365.16,
      "Time_End": 366.6,
      "Text": " Can we update this?"
    },
    {
      "Time_Start": 366.6,
      "Time_End": 369.96000000000004,
      "Text": " And day after day, week after week, it got to the point where he said, why don't I"
    },
    {
      "Time_Start": 369.96000000000004,
      "Time_End": 371.24,
      "Text": " give you access?"
    },
    {
      "Time_Start": 371.24,
      "Time_End": 374.68,
      "Text": " And you can come up with the weird syntaxes and the detection for it."
    },
    {
      "Time_Start": 374.68,
      "Time_End": 378.72,
      "Text": " And so that kind of turned into a somewhat unofficial role, and that's what I've been"
    },
    {
      "Time_Start": 378.72,
      "Time_End": 380.24,
      "Text": " doing ever since."
    },
    {
      "Time_Start": 380.24,
      "Time_End": 382.36,
      "Text": " And it's been a lot of fun."
    },
    {
      "Time_Start": 382.36,
      "Time_End": 387.12,
      "Text": " And so last year at DerbyCon, I released this tool called Invoke Obfuscation, kind of the"
    },
    {
      "Time_Start": 387.16,
      "Time_End": 393.36,
      "Text": " culmination of this research to automate the obfuscation of PowerShell commands and scripts."
    },
    {
      "Time_Start": 393.36,
      "Time_End": 395.12,
      "Text": " And it does this at four different layers."
    },
    {
      "Time_Start": 395.12,
      "Time_End": 399.56,
      "Text": " And so if you haven't seen this tool or seen the previous talk, I'm gonna go through it"
    },
    {
      "Time_Start": 399.56,
      "Time_End": 403.68,
      "Text": " at a really high level to show you this kind of obfuscation so that we can see how Invoke"
    },
    {
      "Time_Start": 403.68,
      "Time_End": 407.76,
      "Text": " Cradle Crafter in today's talk is a bit different."
    },
    {
      "Time_Start": 407.76,
      "Time_End": 409.56,
      "Text": " So the first layer, tokens."
    },
    {
      "Time_Start": 409.56,
      "Time_End": 410.96,
      "Text": " So basically I went through this example."
    },
    {
      "Time_Start": 410.96,
      "Time_End": 415.12,
      "Text": " This is the most common remote download cradle, and if that's our attacker command at the"
    },
    {
      "Time_Start": 415.12,
      "Time_End": 418.6,
      "Text": " top, then as a defender on the bottom, if we look for those four strings, then we'll"
    },
    {
      "Time_Start": 418.6,
      "Time_End": 420.16,
      "Text": " catch that command."
    },
    {
      "Time_Start": 420.16,
      "Time_End": 423.88,
      "Text": " But basically we're gonna walk through and see if we start obfuscating, we can actually"
    },
    {
      "Time_Start": 423.88,
      "Time_End": 425.52,
      "Text": " bypass that detection."
    },
    {
      "Time_Start": 425.52,
      "Time_End": 428.18,
      "Text": " So we're gonna obfuscate the command and update our detection."
    },
    {
      "Time_Start": 428.18,
      "Time_End": 430.4,
      "Text": " So for example, we don't need system dot."
    },
    {
      "Time_Start": 430.4,
      "Time_End": 431.4,
      "Text": " We can remove that."
    },
    {
      "Time_Start": 431.4,
      "Time_End": 433.52,
      "Text": " Any time you see a string, we can concatenate it."
    },
    {
      "Time_Start": 433.52,
      "Time_End": 437.4,
      "Text": " We can use double quotes, single quotes, white space, et cetera."
    },
    {
      "Time_Start": 437.4,
      "Time_End": 440.32,
      "Text": " When it comes to methods, download string is the most common, because it's memory only"
    },
    {
      "Time_Start": 440.32,
      "Time_End": 442.12,
      "Text": " and it's a string, an expression."
    },
    {
      "Time_Start": 442.12,
      "Time_End": 446.64,
      "Text": " However, it is a method of the net.webclient class, and there are a ton of methods, and"
    },
    {
      "Time_Start": 446.64,
      "Time_End": 447.96,
      "Text": " I want you to look at these four."
    },
    {
      "Time_Start": 447.96,
      "Time_End": 453.72,
      "Text": " So download string, download data, open read, which is the one that you've only seen once"
    },
    {
      "Time_Start": 453.72,
      "Time_End": 457.36,
      "Text": " or twice, and then download file."
    },
    {
      "Time_Start": 457.36,
      "Time_End": 463.0,
      "Text": " These are four that in Invoke Obfuscation, it will never substitute one method for another,"
    },
    {
      "Time_Start": 463.0,
      "Time_End": 464.96,
      "Text": " because it's actually changing the result."
    },
    {
      "Time_Start": 464.96,
      "Time_End": 469.76,
      "Text": " If you go from top to bottom, you have it returning an expression, a file to disk, a"
    },
    {
      "Time_Start": 469.76,
      "Time_End": 471.24,
      "Text": " byte array, or a byte stream."
    },
    {
      "Time_Start": 471.36,
      "Time_End": 474.32,
      "Text": " And so there's additional wrappers you need around that command to convert back to an"
    },
    {
      "Time_Start": 474.32,
      "Time_End": 476.28000000000003,
      "Text": " expression to invoke it."
    },
    {
      "Time_Start": 476.28000000000003,
      "Time_End": 480.76,
      "Text": " So Invoke Obfuscation will never do this, but Invoke Cradlecrafter can, and that's the"
    },
    {
      "Time_Start": 480.76,
      "Time_End": 481.76,
      "Text": " whole point."
    },
    {
      "Time_Start": 481.76,
      "Time_End": 486.48,
      "Text": " Additionally, so Invoke Obfuscation will say, okay, if we have a method, we can put single"
    },
    {
      "Time_Start": 486.48,
      "Time_End": 489.96000000000004,
      "Text": " quotes around it, we can put double quotes around it, and once we do that, we can actually"
    },
    {
      "Time_Start": 489.96000000000004,
      "Time_End": 492.92,
      "Text": " put a tick mark, or like a lot of tick marks."
    },
    {
      "Time_Start": 492.92,
      "Time_End": 496.08,
      "Text": " And then after that, we can look at arguments, do a lot of different stuff as well."
    },
    {
      "Time_Start": 496.08,
      "Time_End": 498.08,
      "Text": " So we'll just use tick marks in this example."
    },
    {
      "Time_Start": 498.08,
      "Time_End": 502.0,
      "Text": " When it comes to commandlets, these are the three options that are in Invoke Obfuscation."
    },
    {
      "Time_Start": 502.0,
      "Time_End": 506.8,
      "Text": " If we see a commandlet, doesn't matter what it is, we can add tick marks, we can concatenate"
    },
    {
      "Time_Start": 506.8,
      "Time_End": 510.47999999999996,
      "Text": " it as a string and then invoke it with a dot or an ampersand, or we can reorder it, basically"
    },
    {
      "Time_Start": 510.47999999999996,
      "Time_End": 514.24,
      "Text": " any string manipulation, and then invoke it with a dot or ampersand."
    },
    {
      "Time_Start": 514.24,
      "Time_End": 517.48,
      "Text": " But in Invoke Cradlecrafter, we can be more creative."
    },
    {
      "Time_Start": 517.48,
      "Time_End": 520.72,
      "Text": " And the reason this isn't in Invoke Obfuscation is because there are some fringe cases in"
    },
    {
      "Time_Start": 520.72,
      "Time_End": 525.88,
      "Text": " which it actually doesn't work as expected, and so since we're dealing with more tightly"
    },
    {
      "Time_Start": 525.88,
      "Time_End": 531.16,
      "Text": " constrained syntax in Invoke Cradlecrafter, we can use different obfuscation."
    },
    {
      "Time_Start": 531.16,
      "Time_End": 533.56,
      "Text": " So I've chosen to implement this kind of obfuscation."
    },
    {
      "Time_Start": 533.56,
      "Time_End": 537.56,
      "Text": " So we can use git command, or this 1.0 syntax for git command, and actually use wildcards,"
    },
    {
      "Time_Start": 537.56,
      "Time_End": 541.36,
      "Text": " so instead of a new object, that wildcard happens to return it."
    },
    {
      "Time_Start": 541.36,
      "Time_End": 546.2,
      "Text": " And instead of git command, we can use an alias, or yeah, an alias of GCM, and instead"
    },
    {
      "Time_Start": 546.2,
      "Time_End": 550.8,
      "Text": " of calling execution context as a variable, we can use wildcards on the git variable alias"
    },
    {
      "Time_Start": 550.8,
      "Time_End": 553.2,
      "Text": " that way."
    },
    {
      "Time_Start": 553.2,
      "Time_End": 557.0200000000001,
      "Text": " And so at this point, we're left with Invoke Expression."
    },
    {
      "Time_Start": 557.0200000000001,
      "Time_End": 560.5200000000001,
      "Text": " And when it comes to Invoke Obfuscation, we pretty much just dealt with IEX or Invoke"
    },
    {
      "Time_Start": 560.5200000000001,
      "Time_End": 566.1600000000001,
      "Text": " Expression, or a little bit different stuff like this, using automatic variables or environment"
    },
    {
      "Time_Start": 566.1600000000001,
      "Time_End": 570.12,
      "Text": " variables and pulling out the letters I and E and X and then invoking that."
    },
    {
      "Time_Start": 570.12,
      "Time_End": 578.12,
      "Text": " So in the last two releases of Invoke Obfuscation, I added a set of IEX syntaxes like this."
    },
    {
      "Time_Start": 578.12,
      "Time_End": 581.1600000000001,
      "Text": " And we're gonna see there's quite a bit more in Invoke Cradlecrafter."
    },
    {
      "Time_Start": 582.16,
      "Time_End": 584.9599999999999,
      "Text": " Oh, I lied, there's actually another cat picture in there."
    },
    {
      "Time_Start": 584.9599999999999,
      "Time_End": 589.92,
      "Text": " All right, two strikes, three I'm out, I have to sit down, so I hope that's the only one."
    },
    {
      "Time_Start": 589.92,
      "Time_End": 592.92,
      "Text": " So that was token-level obfuscation, the first of the four categories."
    },
    {
      "Time_Start": 592.92,
      "Time_End": 595.36,
      "Text": " Second, we have string-level, and this is really simple."
    },
    {
      "Time_Start": 595.36,
      "Time_End": 599.36,
      "Text": " Basically take your entire command, treat it as a string, and then do any string manipulation,"
    },
    {
      "Time_Start": 599.36,
      "Time_End": 602.92,
      "Text": " and then just invoke it with Invoke Expression or whatever else you'd like."
    },
    {
      "Time_Start": 602.92,
      "Time_End": 604.8399999999999,
      "Text": " Third, we have encoding."
    },
    {
      "Time_Start": 604.8399999999999,
      "Time_End": 610.76,
      "Text": " So the current public version of Invoke Obfuscation has these six, ASCII, hexadecimal, octal,"
    },
    {
      "Time_Start": 610.76,
      "Time_End": 615.2,
      "Text": " all the way down through secure string, which is technically encryption, and bitwise XOR."
    },
    {
      "Time_Start": 615.2,
      "Time_End": 617.68,
      "Text": " And the fourth category is obfuscated launchers."
    },
    {
      "Time_Start": 617.68,
      "Time_End": 622.52,
      "Text": " And so with this, we can do things like echoing the PowerShell command into PowerShell dash"
    },
    {
      "Time_Start": 622.52,
      "Time_End": 623.88,
      "Text": " or PowerShell IEX input."
    },
    {
      "Time_Start": 623.88,
      "Time_End": 627.88,
      "Text": " And what this allows you to do is push code to PowerShell standard input, and so you can"
    },
    {
      "Time_Start": 627.88,
      "Time_End": 632.16,
      "Text": " see these are sysmon logs, so PowerShell's arguments doesn't actually contain the command,"
    },
    {
      "Time_Start": 632.16,
      "Time_End": 633.16,
      "Text": " but its parent does."
    },
    {
      "Time_Start": 633.16,
      "Time_End": 638.56,
      "Text": " Now you can take this a step further and set your PowerShell command into an environment"
    },
    {
      "Time_Start": 638.5600000000001,
      "Time_End": 643.1600000000001,
      "Text": " variable one, and then set PowerShell dash in environment variable two, and then echo"
    },
    {
      "Time_Start": 643.1600000000001,
      "Time_End": 645.12,
      "Text": " var one into var two."
    },
    {
      "Time_Start": 645.12,
      "Time_End": 650.0400000000001,
      "Text": " We've actually seen Fin 8 do this as recently as this February."
    },
    {
      "Time_Start": 650.0400000000001,
      "Time_End": 652.6800000000001,
      "Text": " And this is what it looks like in the event logs."
    },
    {
      "Time_Start": 652.6800000000001,
      "Time_End": 655.8800000000001,
      "Text": " So the arguments of the actual command content are actually pushed all the way up to the"
    },
    {
      "Time_Start": 655.8800000000001,
      "Time_End": 658.2,
      "Text": " grandparent process."
    },
    {
      "Time_Start": 658.2,
      "Time_End": 662.36,
      "Text": " And there's an interesting post, John Lambert from Microsoft, if you're not following him,"
    },
    {
      "Time_Start": 662.36,
      "Time_End": 663.36,
      "Text": " you definitely should."
    },
    {
      "Time_Start": 663.36,
      "Time_End": 666.1600000000001,
      "Text": " He tweets a lot of really interesting things, evil things that he's finding in the wild."
    },
    {
      "Time_Start": 666.16,
      "Time_End": 671.88,
      "Text": " He posted this doc, had some interesting obfuscation going on, and Nick Carr, a colleague"
    },
    {
      "Time_Start": 671.88,
      "Time_End": 675.6,
      "Text": " of mine, tweeted and said, hey, we've actually seen Fin 8 doing this, here's a decoder that"
    },
    {
      "Time_Start": 675.6,
      "Time_End": 677.68,
      "Text": " I've pushed to GitHub to decode this."
    },
    {
      "Time_Start": 677.68,
      "Time_End": 681.64,
      "Text": " And then another colleague of mine, Ian All, said, yeah, this lines up really well with"
    },
    {
      "Time_Start": 681.64,
      "Time_End": 682.64,
      "Text": " some samples that we've been seeing."
    },
    {
      "Time_Start": 682.64,
      "Time_End": 687.4,
      "Text": " So you can see the screenshot here, Fin 8 is setting this command in the very bottom"
    },
    {
      "Time_Start": 687.4,
      "Time_End": 690.8399999999999,
      "Text": " variable, and the very bottom is setting it in variable one."
    },
    {
      "Time_Start": 690.8399999999999,
      "Time_End": 693.88,
      "Text": " In variable two, they're setting this PowerShell dash, and then what you actually see on the"
    },
    {
      "Time_Start": 693.88,
      "Time_End": 696.8,
      "Text": " command line is command echo var one to var two."
    },
    {
      "Time_Start": 696.8,
      "Time_End": 699.28,
      "Text": " Does that look familiar?"
    },
    {
      "Time_Start": 699.28,
      "Time_End": 702.84,
      "Text": " So in the first phase of invoke obfuscation, this is how I did it, but I actually took"
    },
    {
      "Time_Start": 702.84,
      "Time_End": 707.4,
      "Text": " it one step further in later releases, and basically created environment variable three,"
    },
    {
      "Time_Start": 707.4,
      "Time_End": 711.96,
      "Text": " which is the contents, it is literally the command echo var one pipe var two, and so"
    },
    {
      "Time_Start": 711.96,
      "Time_End": 717.24,
      "Text": " now all you see in invoke obfuscation is command slash C var three, that's it."
    },
    {
      "Time_Start": 717.24,
      "Time_End": 720.16,
      "Text": " And so these are the current options, again, in the public version of invoke obfuscation,"
    },
    {
      "Time_Start": 720.16,
      "Time_End": 724.6,
      "Text": " here's the latest that's there, and that standard n plus plus is the example that we"
    },
    {
      "Time_Start": 724.6,
      "Time_End": 726.36,
      "Text": " just looked at."
    },
    {
      "Time_Start": 726.36,
      "Time_End": 733.14,
      "Text": " So that's some of the recent stuff in obfuscation that we've seen attackers using."
    },
    {
      "Time_Start": 733.14,
      "Time_End": 736.12,
      "Text": " So what does detection look like for this?"
    },
    {
      "Time_Start": 736.12,
      "Time_End": 741.6,
      "Text": " Well, hopefully there's examples out there where AV is catching some of these scripts"
    },
    {
      "Time_Start": 741.6,
      "Time_End": 743.3199999999999,
      "Text": " that are obfuscated at the token layer."
    },
    {
      "Time_Start": 743.3199999999999,
      "Time_End": 748.04,
      "Text": " I've still yet to see it, but again, hopefully they're catching up."
    },
    {
      "Time_Start": 748.04,
      "Time_End": 751.4399999999999,
      "Text": " And one thing to keep in mind is that obfuscation does not affect heuristics."
    },
    {
      "Time_Start": 751.4399999999999,
      "Time_End": 757.28,
      "Text": " So if you're looking at PowerShell accessing LSASS memory space from invoke mimikatz, obfuscation's"
    },
    {
      "Time_Start": 757.28,
      "Time_End": 758.28,
      "Text": " not gonna help you there."
    },
    {
      "Time_Start": 758.28,
      "Time_End": 764.12,
      "Text": " It's still going to perform that action, but it will likely get around detection of the"
    },
    {
      "Time_Start": 764.12,
      "Time_End": 768.52,
      "Text": " script itself, unless you're doing some interesting stuff that we'll talk about."
    },
    {
      "Time_Start": 768.52,
      "Time_End": 772.68,
      "Text": " It's been really neat to see some of our technically competitors in the industry updating their"
    },
    {
      "Time_Start": 772.68,
      "Time_End": 777.48,
      "Text": " command line detection for some of this obfuscation, so that's been really exciting to see."
    },
    {
      "Time_Start": 777.48,
      "Time_End": 782.0,
      "Text": " A lot's changed since the initial release of invoke obfuscation, so I hope that they've"
    },
    {
      "Time_Start": 782.0,
      "Time_End": 783.0,
      "Text": " been keeping up."
    },
    {
      "Time_Start": 783.0,
      "Time_End": 788.2,
      "Text": " But overall, that's my goal, is that we all as a community across all industries will"
    },
    {
      "Time_Start": 788.2,
      "Time_End": 791.64,
      "Text": " get better at detecting this kind of activity."
    },
    {
      "Time_Start": 791.64,
      "Time_End": 796.44,
      "Text": " And it's been really neat to see APT32, which is a Vietnamese attacker, also known as Ocean"
    },
    {
      "Time_Start": 796.44,
      "Time_End": 798.8000000000001,
      "Text": " Lotus, using invoke obfuscation."
    },
    {
      "Time_Start": 798.8000000000001,
      "Time_End": 802.9200000000001,
      "Text": " I think their inner command is stuck, because they go through a lot of layers."
    },
    {
      "Time_Start": 802.9200000000001,
      "Time_End": 808.84,
      "Text": " I've spent a bit of time in the past couple weeks de-obfuscating and kind of hating life"
    },
    {
      "Time_Start": 808.84,
      "Time_End": 813.1200000000001,
      "Text": " for a little bit, but it's been really interesting to see how they're using it."
    },
    {
      "Time_Start": 813.1200000000001,
      "Time_End": 816.7600000000001,
      "Text": " Some interesting things, if you're not aware of these, that I think are gonna be beneficial"
    },
    {
      "Time_Start": 816.7600000000001,
      "Time_End": 818.9200000000001,
      "Text": " in detecting this kind of stuff."
    },
    {
      "Time_Start": 818.9200000000001,
      "Time_End": 826.3600000000001,
      "Text": " One is AMSI, the Anti-Malware Scan Interface, and this allows registered AV vendors to access"
    },
    {
      "Time_Start": 826.3600000000001,
      "Time_End": 831.2800000000001,
      "Text": " mostly de-obfuscated content from a lot more than just PowerShell, from bbscript and several"
    },
    {
      "Time_Start": 831.28,
      "Time_End": 832.28,
      "Text": " others."
    },
    {
      "Time_Start": 832.28,
      "Time_End": 836.0,
      "Text": " But ultimately, it still relies on the AV vendor having a signature that will detect"
    },
    {
      "Time_Start": 836.0,
      "Time_End": 837.0799999999999,
      "Text": " on that content."
    },
    {
      "Time_Start": 837.0799999999999,
      "Time_End": 841.76,
      "Text": " And today, still really not seeing it being flagged on any of this."
    },
    {
      "Time_Start": 841.76,
      "Time_End": 843.68,
      "Text": " And hopefully that will change very soon."
    },
    {
      "Time_Start": 843.68,
      "Time_End": 847.8,
      "Text": " The other one is from Lee Holmes, and he was actually on the PowerShell team at Microsoft,"
    },
    {
      "Time_Start": 847.8,
      "Time_End": 852.0,
      "Text": " and now is currently a lead security architect for the Azure team."
    },
    {
      "Time_Start": 852.0,
      "Time_End": 857.04,
      "Text": " And he has this great, great blog post, actually looking at invoke obfuscation output."
    },
    {
      "Time_Start": 857.04,
      "Time_End": 861.0,
      "Text": " And he created these two functions that is on his GitHub, Frequency Analysis and Vector"
    },
    {
      "Time_Start": 861.0,
      "Time_End": 862.0,
      "Text": " Similarity."
    },
    {
      "Time_Start": 862.0,
      "Time_End": 863.0,
      "Text": " Really, really cool stuff."
    },
    {
      "Time_Start": 863.0,
      "Time_End": 865.7199999999999,
      "Text": " And this has been the kind of stuff that I get really excited about, and I've been doing"
    },
    {
      "Time_Start": 865.7199999999999,
      "Time_End": 869.76,
      "Text": " some research on the side to look more into that."
    },
    {
      "Time_Start": 869.76,
      "Time_End": 874.3199999999999,
      "Text": " All right, for the new stuff, more crafting cryptic cradles."
    },
    {
      "Time_Start": 874.3199999999999,
      "Time_End": 877.28,
      "Text": " You know what, I know what this next slide is, and it's another cat."
    },
    {
      "Time_Start": 877.28,
      "Time_End": 880.1999999999999,
      "Text": " But this one is really the last one, I promise, this is the last one."
    },
    {
      "Time_Start": 880.1999999999999,
      "Time_End": 885.28,
      "Text": " And I had to put this in here because more, I'm obviously using a different spelling than"
    },
    {
      "Time_Start": 885.28,
      "Time_End": 890.68,
      "Text": " what's in the dictionary, but it comes from more plus roar, more very loudly, I suppose."
    },
    {
      "Time_Start": 890.68,
      "Time_End": 894.4399999999999,
      "Text": " So these are the three categories of new stuff that we're gonna talk about today."
    },
    {
      "Time_Start": 894.4399999999999,
      "Time_End": 899.4399999999999,
      "Text": " When it comes to cryptic cradles, the first category is just obscure syntaxes, no obfuscation"
    },
    {
      "Time_Start": 899.4399999999999,
      "Time_End": 900.4399999999999,
      "Text": " whatsoever."
    },
    {
      "Time_Start": 900.4399999999999,
      "Time_End": 902.4399999999999,
      "Text": " So Matt Graber actually tweeted this last week."
    },
    {
      "Time_Start": 902.4399999999999,
      "Time_End": 906.72,
      "Text": " This is actually a download cradle, IWR, an alias for Invoke Web Request."
    },
    {
      "Time_Start": 906.72,
      "Time_End": 909.4399999999999,
      "Text": " It was introduced in PowerShell three years later, so you don't see it that much because"
    },
    {
      "Time_Start": 909.4399999999999,
      "Time_End": 913.8399999999999,
      "Text": " typically red teamers and attackers like their stuff to work on PowerShell two or later,"
    },
    {
      "Time_Start": 913.8399999999999,
      "Time_End": 914.8399999999999,
      "Text": " but it totally works."
    },
    {
      "Time_Start": 915.4,
      "Time_End": 917.64,
      "Text": " So we'll look at this and a lot of other ones."
    },
    {
      "Time_Start": 917.64,
      "Time_End": 921.0,
      "Text": " Then we'll look at obscure token obfuscation, and again, completely different obfuscation"
    },
    {
      "Time_Start": 921.0,
      "Time_End": 924.9200000000001,
      "Text": " than what you see in Invoke obfuscation, but it allows to take a command like this and"
    },
    {
      "Time_Start": 924.9200000000001,
      "Time_End": 928.8000000000001,
      "Text": " transform it into something like this, all through really interesting means of enumerating"
    },
    {
      "Time_Start": 928.8000000000001,
      "Time_End": 932.32,
      "Text": " commandlets, methods, members, and properties."
    },
    {
      "Time_Start": 932.32,
      "Time_End": 936.64,
      "Text": " Then we'll look at some obscure invocation syntaxes, looking at some PowerShell one syntax,"
    },
    {
      "Time_Start": 936.64,
      "Time_End": 941.72,
      "Text": " PowerShell three syntax, and several others."
    },
    {
      "Time_Start": 941.72,
      "Time_End": 945.0,
      "Text": " So breaking it down into two categories, and this is how the tool does it as well,"
    },
    {
      "Time_Start": 945.0,
      "Time_End": 946.0,
      "Text": " disk-based and memory-based."
    },
    {
      "Time_Start": 946.0,
      "Time_End": 950.84,
      "Text": " Disk-based, Commodity loves disk-based stuff because they're downloading an XE to run,"
    },
    {
      "Time_Start": 950.84,
      "Time_End": 954.84,
      "Text": " but I think disk-based is actually really overlooked, and it's sad because it has some"
    },
    {
      "Time_Start": 954.84,
      "Time_End": 958.0,
      "Text": " interesting potential that a lot of people aren't looking for."
    },
    {
      "Time_Start": 958.0,
      "Time_End": 961.32,
      "Text": " One would be what if you just always downloaded your payload to the profile script and then"
    },
    {
      "Time_Start": 961.32,
      "Time_End": 962.52,
      "Text": " just ran PowerShell?"
    },
    {
      "Time_Start": 962.52,
      "Time_End": 967.08,
      "Text": " Now everything in that script gets run, nothing on the command line, pretty interesting stuff."
    },
    {
      "Time_Start": 967.08,
      "Time_End": 970.1600000000001,
      "Text": " Obviously it's all going to be in PowerShell event logs, but sadly most people don't have"
    },
    {
      "Time_Start": 970.16,
      "Time_End": 976.4399999999999,
      "Text": " PowerShell five, or even three for that matter, so there's really not too much to do there."
    },
    {
      "Time_Start": 976.4399999999999,
      "Time_End": 980.92,
      "Text": " So download file, again, this is the most common one that we see Commodity malware using."
    },
    {
      "Time_Start": 980.92,
      "Time_End": 985.52,
      "Text": " We do actually see a bit of Commodity using bitsadmin, so bitsadmin is actually deprecated,"
    },
    {
      "Time_Start": 985.52,
      "Time_End": 988.6,
      "Text": " but still works, and startbittstransfer is PowerShell's version."
    },
    {
      "Time_Start": 988.6,
      "Time_End": 990.12,
      "Text": " Now what's interesting about these?"
    },
    {
      "Time_Start": 990.12,
      "Time_End": 994.8399999999999,
      "Text": " Well, they actually work with constrained language mode, so Matt Graber and Casey Smith"
    },
    {
      "Time_Start": 994.8399999999999,
      "Time_End": 998.56,
      "Text": " have been doing a lot of awesome talks on device guard, which can enforce constrained"
    },
    {
      "Time_Start": 998.5600000000001,
      "Time_End": 1001.9200000000001,
      "Text": " language mode, and so these will still work in constrained language mode if you're on"
    },
    {
      "Time_Start": 1001.9200000000001,
      "Time_End": 1004.1600000000001,
      "Text": " a system that has that and need to download some stuff."
    },
    {
      "Time_Start": 1004.1600000000001,
      "Time_End": 1007.32,
      "Text": " One thing to keep in mind is that the file that you're downloading, if it does not return"
    },
    {
      "Time_Start": 1007.32,
      "Time_End": 1011.8000000000001,
      "Text": " a file size, like if your file's on Pastebin, for example, it's not going to return a file"
    },
    {
      "Time_Start": 1011.8000000000001,
      "Time_End": 1015.9200000000001,
      "Text": " size if you're pulling that raw data, and bits needs that to do what it does, the background"
    },
    {
      "Time_Start": 1015.9200000000001,
      "Time_End": 1019.0000000000001,
      "Text": " intelligent transfer service, it needs that file size, so you're going to get an error"
    },
    {
      "Time_Start": 1019.0000000000001,
      "Time_End": 1022.58,
      "Text": " like this, so definitely want to test your payload to make sure is the server speaking"
    },
    {
      "Time_Start": 1022.58,
      "Time_End": 1026.16,
      "Text": " the right language so that bits will work when it downloads it."
    },
    {
      "Time_Start": 1026.16,
      "Time_End": 1027.5600000000002,
      "Text": " Now the memory-based cradles."
    },
    {
      "Time_Start": 1027.5600000000002,
      "Time_End": 1031.3600000000001,
      "Text": " Again, first one, fan favorite, this is what we see all the time, not going to spend any"
    },
    {
      "Time_Start": 1031.3600000000001,
      "Time_End": 1032.48,
      "Text": " time there."
    },
    {
      "Time_Start": 1032.48,
      "Time_End": 1035.68,
      "Text": " Download data in OpenRead, main difference here is that you have it returning as a byte"
    },
    {
      "Time_Start": 1035.68,
      "Time_End": 1038.8400000000001,
      "Text": " array or a byte stream, so we have to do a little bit more work around that command to"
    },
    {
      "Time_Start": 1038.8400000000001,
      "Time_End": 1042.3200000000002,
      "Text": " get it back to an expression before we invoke it."
    },
    {
      "Time_Start": 1042.3200000000002,
      "Time_End": 1046.68,
      "Text": " InvokeWebRequest and InvokeRestMethod, this is what Graber tweeted, the IWR, these are"
    },
    {
      "Time_Start": 1046.68,
      "Time_End": 1052.16,
      "Text": " also both, these will both work on systems with constrained language mode enabled, but"
    },
    {
      "Time_Start": 1052.16,
      "Time_End": 1055.3600000000001,
      "Text": " these are introduced in PowerShell three or later, so that's something that you have to"
    },
    {
      "Time_Start": 1055.3600000000001,
      "Time_End": 1056.3600000000001,
      "Text": " keep in mind."
    },
    {
      "Time_Start": 1056.3600000000001,
      "Time_End": 1060.5600000000002,
      "Text": " InvokeWebRequest also has some nice aliases, wget and curl, I don't think I've actually"
    },
    {
      "Time_Start": 1060.5600000000002,
      "Time_End": 1063.7600000000002,
      "Text": " ever seen those being used, but they totally work."
    },
    {
      "Time_Start": 1063.7600000000002,
      "Time_End": 1067.44,
      "Text": " This is actually probably my favorite, which is really, it's really strange, it's not really"
    },
    {
      "Time_Start": 1067.44,
      "Time_End": 1070.5200000000002,
      "Text": " that sexy, but it has some nuances that I think are just really cool."
    },
    {
      "Time_Start": 1070.5200000000002,
      "Time_End": 1075.64,
      "Text": " So basically calling the net HTTP web request class directly, and you're able to do this"
    },
    {
      "Time_Start": 1075.64,
      "Time_End": 1080.0400000000002,
      "Text": " without having to say new object and then the class name."
    },
    {
      "Time_Start": 1080.0400000000002,
      "Time_End": 1084.92,
      "Text": " And you can actually do the same thing with one, two, and three, that was not the laser,"
    },
    {
      "Time_Start": 1084.92,
      "Time_End": 1090.1200000000001,
      "Text": " you can do the same thing with downloadString, downloadData, and downloadFile and openRead,"
    },
    {
      "Time_Start": 1090.1200000000001,
      "Time_End": 1095.64,
      "Text": " but it's only in PowerShell three or later."
    },
    {
      "Time_Start": 1095.64,
      "Time_End": 1097.04,
      "Text": " So that's number six."
    },
    {
      "Time_Start": 1097.04,
      "Time_End": 1101.26,
      "Text": " Number seven, this one is strictly for the lulz, if you have money on getting a cradle"
    },
    {
      "Time_Start": 1101.26,
      "Time_End": 1104.28,
      "Text": " to work, don't put it on this one."
    },
    {
      "Time_Start": 1104.28,
      "Time_End": 1108.4,
      "Text": " I considered not putting it in the tool, but I spent like over 50 hours on it, trying to"
    },
    {
      "Time_Start": 1108.4,
      "Time_End": 1111.96,
      "Text": " get it to be more reliable, so your results may vary."
    },
    {
      "Time_Start": 1111.96,
      "Time_End": 1115.72,
      "Text": " So this one is technically unsupported in the tool, please don't open up, get issues"
    },
    {
      "Time_Start": 1115.72,
      "Time_End": 1116.72,
      "Text": " on this one."
    },
    {
      "Time_Start": 1116.72,
      "Time_End": 1120.4,
      "Text": " But basically if you have Notepad and go to open and instead of a file name put in a URL,"
    },
    {
      "Time_Start": 1120.4,
      "Time_End": 1123.8400000000001,
      "Text": " then Notepad will fetch your freaking payload for you, which is awesome, because now PowerShell's"
    },
    {
      "Time_Start": 1123.8400000000001,
      "Time_End": 1125.92,
      "Text": " not making a network connection."
    },
    {
      "Time_Start": 1125.92,
      "Time_End": 1129.88,
      "Text": " So basically this syntax in this tool will automate that, it'll basically spawn Notepad"
    },
    {
      "Time_Start": 1129.88,
      "Time_End": 1135.08,
      "Text": " off the screen, use send keys to send keystrokes to automate all this, Control-A, Control-C"
    },
    {
      "Time_Start": 1135.08,
      "Time_End": 1140.56,
      "Text": " to select all, copy all, and then invoke the contents off the clipboard."
    },
    {
      "Time_Start": 1140.56,
      "Time_End": 1145.28,
      "Text": " Inline scripting, oh, let me go back, com objects, so this is basically PowerShell interacting"
    },
    {
      "Time_Start": 1145.28,
      "Time_End": 1148.8,
      "Text": " with other applications through com to have them go fetch the payloads."
    },
    {
      "Time_Start": 1148.8,
      "Time_End": 1152.44,
      "Text": " A lot quieter, a lot cleaner than send keys and Notepads, you don't have stuff flying"
    },
    {
      "Time_Start": 1152.44,
      "Time_End": 1153.96,
      "Text": " up in front of the user."
    },
    {
      "Time_Start": 1153.96,
      "Time_End": 1154.96,
      "Text": " These are really, really cool."
    },
    {
      "Time_Start": 1154.96,
      "Time_End": 1158.84,
      "Text": " And then the last two are inline scripting and pre-compiled scripting."
    },
    {
      "Time_Start": 1158.84,
      "Time_End": 1161.6799999999998,
      "Text": " So basically PowerShell can host several other scripting languages."
    },
    {
      "Time_Start": 1161.6799999999998,
      "Time_End": 1165.96,
      "Text": " C Sharp is the default, but JScript, Visual Basic, et cetera."
    },
    {
      "Time_Start": 1165.96,
      "Time_End": 1169.6399999999999,
      "Text": " And so you can basically put in, in this case this is C Sharp, put in your code, and then"
    },
    {
      "Time_Start": 1169.64,
      "Time_End": 1173.5600000000002,
      "Text": " just do add type, and what it'll do on the target system, it will compile and execute"
    },
    {
      "Time_Start": 1173.5600000000002,
      "Time_End": 1174.64,
      "Text": " that code."
    },
    {
      "Time_Start": 1174.64,
      "Time_End": 1178.8000000000002,
      "Text": " Now if you want to be a little quieter, you can pre-compile it and just load the bytes"
    },
    {
      "Time_Start": 1178.8000000000002,
      "Time_End": 1180.5600000000002,
      "Text": " directly onto your target system."
    },
    {
      "Time_Start": 1180.5600000000002,
      "Time_End": 1184.3600000000001,
      "Text": " The thing you have to keep in mind is that there has to be compatibility between the"
    },
    {
      "Time_Start": 1184.3600000000001,
      "Time_End": 1187.76,
      "Text": " versions of the .NET compilers that are on each system."
    },
    {
      "Time_Start": 1187.76,
      "Time_End": 1191.5600000000002,
      "Text": " All right, that was looking at the obscure cradles."
    },
    {
      "Time_Start": 1191.5600000000002,
      "Time_End": 1193.88,
      "Text": " Now what does obfuscation look like?"
    },
    {
      "Time_Start": 1193.88,
      "Time_End": 1196.72,
      "Text": " How is it actually different than invoke obfuscation?"
    },
    {
      "Time_Start": 1196.84,
      "Time_End": 1200.48,
      "Text": " Well, let's take a look at the same basic download cradle."
    },
    {
      "Time_Start": 1200.48,
      "Time_End": 1204.82,
      "Text": " So we have our member obfuscation, or sorry, our method obfuscation here."
    },
    {
      "Time_Start": 1204.82,
      "Time_End": 1207.6200000000001,
      "Text": " So download string."
    },
    {
      "Time_Start": 1207.6200000000001,
      "Time_End": 1212.2,
      "Text": " One thing that we can do is say, okay, this is a method of net.webclient, the class."
    },
    {
      "Time_Start": 1212.2,
      "Time_End": 1215.2,
      "Text": " So what if we just say new object netwebclient.psobject.methods."
    },
    {
      "Time_Start": 1215.2,
      "Time_End": 1220.1200000000001,
      "Text": " It's gonna give us this huge list of all the method names."
    },
    {
      "Time_Start": 1220.1200000000001,
      "Time_End": 1223.68,
      "Text": " You could also do the same thing in a lot cleaner syntax with get member, and both of"
    },
    {
      "Time_Start": 1223.68,
      "Time_End": 1224.68,
      "Text": " these are options in the tool."
    },
    {
      "Time_Start": 1224.68,
      "Time_End": 1227.6000000000001,
      "Text": " But we'll stick with psobject for this one."
    },
    {
      "Time_Start": 1227.6000000000001,
      "Time_End": 1231.3200000000002,
      "Text": " Now what we can do is then enumerate that and say, okay, I wanna know where the object"
    },
    {
      "Time_Start": 1231.3200000000002,
      "Time_End": 1233.52,
      "Text": " name is download string."
    },
    {
      "Time_Start": 1233.52,
      "Time_End": 1234.72,
      "Text": " And then we see there's actually two."
    },
    {
      "Time_Start": 1234.72,
      "Time_End": 1235.72,
      "Text": " There's an overloaded definition."
    },
    {
      "Time_Start": 1235.72,
      "Time_End": 1239.26,
      "Text": " Well, I would actually just like the name of that."
    },
    {
      "Time_Start": 1239.26,
      "Time_End": 1241.6000000000001,
      "Text": " Now that gets me the string download string."
    },
    {
      "Time_Start": 1241.6000000000001,
      "Time_End": 1244.6000000000001,
      "Text": " And so what really makes this fun is see download string?"
    },
    {
      "Time_Start": 1244.6000000000001,
      "Time_End": 1249.4,
      "Text": " What if we just randomly select from a set of nice wildcarded strings to get download"
    },
    {
      "Time_Start": 1249.4,
      "Time_End": 1250.92,
      "Text": " string?"
    },
    {
      "Time_Start": 1250.92,
      "Time_End": 1253.18,
      "Text": " And you're gonna see this thing repeated greatly."
    },
    {
      "Time_Start": 1253.18,
      "Time_End": 1255.46,
      "Text": " So now this becomes a string download string."
    },
    {
      "Time_Start": 1255.46,
      "Time_End": 1259.02,
      "Text": " So now we're gonna pop it up into the command, and if you notice that .invoke, this is necessary"
    },
    {
      "Time_Start": 1259.02,
      "Time_End": 1261.94,
      "Text": " for PowerShell 2, but it's not necessary for PowerShell 3."
    },
    {
      "Time_Start": 1261.94,
      "Time_End": 1266.14,
      "Text": " But everything produced in this tool, unless it explicitly says 3.0 or later, it will work"
    },
    {
      "Time_Start": 1266.14,
      "Time_End": 1267.14,
      "Text": " across the board."
    },
    {
      "Time_Start": 1267.14,
      "Time_End": 1269.6000000000001,
      "Text": " So that .invoke will be there."
    },
    {
      "Time_Start": 1269.6000000000001,
      "Time_End": 1270.6000000000001,
      "Text": " New object."
    },
    {
      "Time_Start": 1270.6000000000001,
      "Time_End": 1273.7,
      "Text": " So how does InvokeCradleCrafter handle command line obfuscation?"
    },
    {
      "Time_Start": 1273.7,
      "Time_End": 1279.66,
      "Text": " Well, we can use get command, new object, and then invoke the result that comes back."
    },
    {
      "Time_Start": 1279.66,
      "Time_End": 1281.8600000000001,
      "Text": " So we can use a . or ampersand to invoke it."
    },
    {
      "Time_Start": 1281.8600000000001,
      "Time_End": 1283.7,
      "Text": " Get command can be any of these aliases."
    },
    {
      "Time_Start": 1283.7,
      "Time_End": 1284.7,
      "Text": " So we'll just choose command."
    },
    {
      "Time_Start": 1284.7,
      "Time_End": 1286.96,
      "Text": " And the new object, you guessed it, wildcards."
    },
    {
      "Time_Start": 1286.96,
      "Time_End": 1288.7,
      "Text": " So randomly select one of these in the tool."
    },
    {
      "Time_Start": 1288.7,
      "Time_End": 1289.98,
      "Text": " Now that's our new object."
    },
    {
      "Time_Start": 1289.98,
      "Time_End": 1291.98,
      "Text": " Now something really interesting here."
    },
    {
      "Time_Start": 1291.98,
      "Time_End": 1296.8400000000001,
      "Text": " Since we obfuscated download string, we've actually introduced another new object."
    },
    {
      "Time_Start": 1296.8400000000001,
      "Time_End": 1300.8200000000002,
      "Text": " So the only reason I bring this up is because I spent way too much time making this work"
    },
    {
      "Time_Start": 1300.8200000000002,
      "Time_End": 1303.6200000000001,
      "Text": " because I'm really OCD about this kind of stuff working."
    },
    {
      "Time_Start": 1303.6200000000001,
      "Time_End": 1309.94,
      "Text": " But basically the whole code is comprised of tags and embedded tags so that at any point,"
    },
    {
      "Time_Start": 1309.94,
      "Time_End": 1313.74,
      "Text": " if you ever introduce another new object, it will take on the identity of the original"
    },
    {
      "Time_Start": 1313.74,
      "Time_End": 1314.74,
      "Text": " one."
    },
    {
      "Time_Start": 1314.74,
      "Time_End": 1315.78,
      "Text": " So both are going to be replaced."
    },
    {
      "Time_Start": 1315.78,
      "Time_End": 1319.06,
      "Text": " And this gets really, really big really fast when you start to look at some of the bigger"
    },
    {
      "Time_Start": 1319.06,
      "Time_End": 1320.06,
      "Text": " cradles."
    },
    {
      "Time_Start": 1320.06,
      "Time_End": 1322.66,
      "Text": " In addition, we could have used this just randomly selected 1.0 syntax to do the same"
    },
    {
      "Time_Start": 1322.66,
      "Time_End": 1323.66,
      "Text": " thing."
    },
    {
      "Time_Start": 1323.66,
      "Time_End": 1324.66,
      "Text": " Pretty disgusting, right?"
    },
    {
      "Time_Start": 1324.66,
      "Time_End": 1330.66,
      "Text": " And this one is actually, you can see down here, this is finding the 1.0 method get command"
    },
    {
      "Time_Start": 1330.66,
      "Time_End": 1331.9,
      "Text": " name."
    },
    {
      "Time_Start": 1331.9,
      "Time_End": 1333.6200000000001,
      "Text": " That's the one that it chose there."
    },
    {
      "Time_Start": 1333.6200000000001,
      "Time_End": 1335.3400000000001,
      "Text": " Other things that are being obfuscated behind the scenes."
    },
    {
      "Time_Start": 1335.34,
      "Time_End": 1340.4199999999998,
      "Text": " So invoke obfuscation does so much obfuscation, but you can't really control what it does"
    },
    {
      "Time_Start": 1340.4199999999998,
      "Time_End": 1341.4199999999998,
      "Text": " where."
    },
    {
      "Time_Start": 1341.4199999999998,
      "Time_End": 1344.86,
      "Text": " With invoke cradle crafter, since we're dealing with such a smaller command, I wanted to have"
    },
    {
      "Time_Start": 1344.86,
      "Time_End": 1347.26,
      "Text": " almost full control over every piece of it."
    },
    {
      "Time_Start": 1347.26,
      "Time_End": 1350.4599999999998,
      "Text": " And you'll see in the tool that hopefully it gets you pretty darn close to that."
    },
    {
      "Time_Start": 1350.4599999999998,
      "Time_End": 1353.82,
      "Text": " These are some of the options that will be obfuscated randomly behind the scenes that"
    },
    {
      "Time_Start": 1353.82,
      "Time_End": 1356.1799999999998,
      "Text": " you don't necessarily get to explicitly select."
    },
    {
      "Time_Start": 1356.1799999999998,
      "Time_End": 1359.1799999999998,
      "Text": " So where object, we can use any of its aliases there."
    },
    {
      "Time_Start": 1359.1799999999998,
      "Time_End": 1364.1399999999999,
      "Text": " And then for like, a lot of, I think, I see a lot of detections built on stuff looking"
    },
    {
      "Time_Start": 1364.14,
      "Time_End": 1365.98,
      "Text": " for like, dash like."
    },
    {
      "Time_Start": 1365.98,
      "Time_End": 1370.1000000000001,
      "Text": " That's gonna burn you, because you can use dash c like for case sensitive, or i like"
    },
    {
      "Time_Start": 1370.1000000000001,
      "Time_End": 1371.1000000000001,
      "Text": " for case insensitive."
    },
    {
      "Time_Start": 1371.1000000000001,
      "Time_End": 1374.26,
      "Text": " So there's a lot of those things that you need to keep in mind when you're writing detections"
    },
    {
      "Time_Start": 1374.26,
      "Time_End": 1375.66,
      "Text": " for this kind of stuff."
    },
    {
      "Time_Start": 1375.66,
      "Time_End": 1378.94,
      "Text": " In addition, dollar undersign, this is for the current variable."
    },
    {
      "Time_Start": 1378.94,
      "Time_End": 1382.46,
      "Text": " Well it hit me one day when I was looking at the automatic variables about page."
    },
    {
      "Time_Start": 1382.46,
      "Time_End": 1385.94,
      "Text": " It talked about this variable called underscores, like oh my gosh, that's that."
    },
    {
      "Time_Start": 1385.94,
      "Time_End": 1388.1000000000001,
      "Text": " So we don't have to use dollar sign underscore."
    },
    {
      "Time_Start": 1388.1000000000001,
      "Time_End": 1390.8600000000001,
      "Text": " We can use get variable or any of its aliases underscore."
    },
    {
      "Time_Start": 1390.8600000000001,
      "Time_End": 1394.5800000000002,
      "Text": " In addition, dash value only can be any of these substrings because of how parameter"
    },
    {
      "Time_Start": 1394.5800000000002,
      "Time_End": 1396.0600000000002,
      "Text": " binding works in PowerShell."
    },
    {
      "Time_Start": 1396.0600000000002,
      "Time_End": 1398.22,
      "Text": " And we can also do dot value."
    },
    {
      "Time_Start": 1398.22,
      "Time_End": 1400.3000000000002,
      "Text": " It gets crazier from there."
    },
    {
      "Time_Start": 1400.3000000000002,
      "Time_End": 1404.2400000000002,
      "Text": " So we can also use get item variable, or gi or item, or the aliases there."
    },
    {
      "Time_Start": 1404.2400000000002,
      "Time_End": 1407.8200000000002,
      "Text": " In addition, you can just throw like a forward or backslash after that colon and it still"
    },
    {
      "Time_Start": 1407.8200000000002,
      "Time_End": 1408.8200000000002,
      "Text": " works."
    },
    {
      "Time_Start": 1408.8200000000002,
      "Time_End": 1412.5400000000002,
      "Text": " We can also do the same thing with get child item and any of its aliases."
    },
    {
      "Time_Start": 1412.5400000000002,
      "Time_End": 1416.38,
      "Text": " So a lot of options there for that current variable."
    },
    {
      "Time_Start": 1416.38,
      "Time_End": 1420.0600000000002,
      "Text": " Another thing we can do with invoke cradle crafter is since the only input this tool"
    },
    {
      "Time_Start": 1420.06,
      "Time_End": 1424.4199999999998,
      "Text": " will take is a URL from you of where your stage payload is, it'll take a post cradle"
    },
    {
      "Time_Start": 1424.4199999999998,
      "Time_End": 1425.4199999999998,
      "Text": " command."
    },
    {
      "Time_Start": 1425.4199999999998,
      "Time_End": 1430.3799999999999,
      "Text": " So again, if your cradle was invoke mimikatz script, you probably want to run after that"
    },
    {
      "Time_Start": 1430.3799999999999,
      "Time_End": 1432.58,
      "Text": " invoke mimikatz dash dump treads whatever."
    },
    {
      "Time_Start": 1432.58,
      "Time_End": 1436.74,
      "Text": " So you can enter a command afterwards and we'll see why that's important for the"
    },
    {
      "Time_Start": 1436.74,
      "Time_End": 1439.02,
      "Text": " tool to have in some of the invocation syntaxes."
    },
    {
      "Time_Start": 1439.02,
      "Time_End": 1444.5,
      "Text": " But we can also do things like rearrange the command by breaking things out into variables."
    },
    {
      "Time_Start": 1444.5,
      "Time_End": 1448.46,
      "Text": " So for example, we have the option to use logical variable names like ds for download"
    },
    {
      "Time_Start": 1448.46,
      "Time_End": 1452.94,
      "Text": " string and logical variable syntax, the dollar sign, or we can do random variable names with"
    },
    {
      "Time_Start": 1452.94,
      "Time_End": 1454.66,
      "Text": " random variable syntax."
    },
    {
      "Time_Start": 1454.66,
      "Time_End": 1460.54,
      "Text": " And the last section is obscure invocation syntaxes, which we'll look at right now."
    },
    {
      "Time_Start": 1460.54,
      "Time_End": 1464.42,
      "Text": " So there's over 10 different invocation syntaxes across the board."
    },
    {
      "Time_Start": 1464.42,
      "Time_End": 1466.74,
      "Text": " The disk-based cradles have a couple more."
    },
    {
      "Time_Start": 1466.74,
      "Time_End": 1470.08,
      "Text": " But pretty much, we have our standard IEX, I'm not gonna spend any time there."
    },
    {
      "Time_Start": 1470.08,
      "Time_End": 1474.5,
      "Text": " We have get alias and get command, again using wildcards to retrieve the command that we're"
    },
    {
      "Time_Start": 1474.5,
      "Time_End": 1475.5,
      "Text": " interested in."
    },
    {
      "Time_Start": 1475.5,
      "Time_End": 1477.3400000000001,
      "Text": " PowerShell 1.0, we have get commandlets."
    },
    {
      "Time_Start": 1477.34,
      "Time_End": 1479.6599999999999,
      "Text": " We saw one sample of that already."
    },
    {
      "Time_Start": 1479.6599999999999,
      "Time_End": 1483.86,
      "Text": " The first one is like the basic syntax and the second one's just a random obfuscated"
    },
    {
      "Time_Start": 1483.86,
      "Time_End": 1484.86,
      "Text": " version."
    },
    {
      "Time_Start": 1484.86,
      "Time_End": 1490.26,
      "Text": " Invoke script, PowerShell 1.0 syntax to execute an expression or a script block."
    },
    {
      "Time_Start": 1490.26,
      "Time_End": 1494.6599999999999,
      "Text": " We then have invoke command, which this is going to force us to need to cast an expression"
    },
    {
      "Time_Start": 1494.6599999999999,
      "Time_End": 1496.5,
      "Text": " to a script block before we invoke it."
    },
    {
      "Time_Start": 1496.5,
      "Time_End": 1497.5,
      "Text": " PS run space."
    },
    {
      "Time_Start": 1497.5,
      "Time_End": 1498.5,
      "Text": " This one's really cool."
    },
    {
      "Time_Start": 1498.5,
      "Time_End": 1502.26,
      "Text": " Matt Graber actually had this idea a couple months ago and shared it with me."
    },
    {
      "Time_Start": 1502.26,
      "Time_End": 1506.26,
      "Text": " And it's basically just creating a PowerShell run space, shoving the code in it with this"
    },
    {
      "Time_Start": 1506.26,
      "Time_End": 1510.74,
      "Text": " add script and then a dot invoke and you're off to the races."
    },
    {
      "Time_Start": 1510.74,
      "Time_End": 1511.74,
      "Text": " Concatenated IEX."
    },
    {
      "Time_Start": 1511.74,
      "Time_End": 1512.74,
      "Text": " This is the one I've had the most fun with."
    },
    {
      "Time_Start": 1512.74,
      "Time_End": 1515.94,
      "Text": " It gets a little crazy as you can see, so let me cover these last three real quick and"
    },
    {
      "Time_Start": 1515.94,
      "Time_End": 1517.3,
      "Text": " then we'll come back to that."
    },
    {
      "Time_Start": 1517.3,
      "Time_End": 1518.3,
      "Text": " Invoke is workflow."
    },
    {
      "Time_Start": 1518.3,
      "Time_End": 1519.82,
      "Text": " This is PowerShell three year later."
    },
    {
      "Time_Start": 1519.82,
      "Time_End": 1523.18,
      "Text": " Pretty darn close to invoke expression except everything's confined to the workflow."
    },
    {
      "Time_Start": 1523.18,
      "Time_End": 1529.78,
      "Text": " So when you use option nine and option seven, if you have a post-cradle command, like again"
    },
    {
      "Time_Start": 1529.78,
      "Time_End": 1534.58,
      "Text": " invoke me me cats dash dump creds, that has to be done in the same run space or workflow"
    },
    {
      "Time_Start": 1534.62,
      "Time_End": 1536.26,
      "Text": " as the invocation itself."
    },
    {
      "Time_Start": 1536.26,
      "Time_End": 1537.8999999999999,
      "Text": " So that's why the tool takes that command."
    },
    {
      "Time_Start": 1537.8999999999999,
      "Time_End": 1541.34,
      "Text": " So if you're copying and pasting out and expecting to always put your command at the end, it's"
    },
    {
      "Time_Start": 1541.34,
      "Time_End": 1543.1799999999998,
      "Text": " not gonna work with those two."
    },
    {
      "Time_Start": 1543.1799999999998,
      "Time_End": 1548.4199999999998,
      "Text": " But the tool handles that and puts it in the proper run space or workflow."
    },
    {
      "Time_Start": 1548.4199999999998,
      "Time_End": 1552.1799999999998,
      "Text": " The last two, dot sourcing and import module, these are just interesting ways that you can"
    },
    {
      "Time_Start": 1552.1799999999998,
      "Time_End": 1556.5,
      "Text": " load scripts that are on disk for any of the disk-based download cradles."
    },
    {
      "Time_Start": 1556.5,
      "Time_End": 1558.5,
      "Text": " So concatenated IEX, coming back to that."
    },
    {
      "Time_Start": 1558.5,
      "Time_End": 1562.3799999999999,
      "Text": " And again, in the latest version of invoke obfuscation, we do stuff like this."
    },
    {
      "Time_Start": 1562.38,
      "Time_End": 1566.94,
      "Text": " Passing out the letters I, E, and X from environment variables like comspec or shell"
    },
    {
      "Time_Start": 1566.94,
      "Time_End": 1569.38,
      "Text": " ID, which is an automatic variable in PowerShell."
    },
    {
      "Time_Start": 1569.38,
      "Time_End": 1573.0200000000002,
      "Text": " This is the only subtle overlap between these two tools."
    },
    {
      "Time_Start": 1573.0200000000002,
      "Time_End": 1576.74,
      "Text": " And that invoke cradle crafter takes this, but it basically puts everything on steroids"
    },
    {
      "Time_Start": 1576.74,
      "Time_End": 1581.9,
      "Text": " and says, okay, we're never gonna assume that we're gonna call a variable with a dollar"
    },
    {
      "Time_Start": 1581.9,
      "Time_End": 1584.6200000000001,
      "Text": " sign and let's use wildcards wherever we can."
    },
    {
      "Time_Start": 1584.6200000000001,
      "Time_End": 1587.5800000000002,
      "Text": " So now that becomes our comspec and shell ID."
    },
    {
      "Time_Start": 1587.5800000000002,
      "Time_End": 1589.14,
      "Text": " And this is the newest part."
    },
    {
      "Time_Start": 1589.14,
      "Time_End": 1591.98,
      "Text": " So if we take a string, in this case it's an empty string, it doesn't matter."
    },
    {
      "Time_Start": 1592.58,
      "Time_End": 1593.58,
      "Text": " And we pipe it to get member."
    },
    {
      "Time_Start": 1593.58,
      "Time_End": 1595.9,
      "Text": " There are a ton of members that a string has."
    },
    {
      "Time_Start": 1595.9,
      "Time_End": 1598.54,
      "Text": " So look at the very bottom, we have this index of."
    },
    {
      "Time_Start": 1598.54,
      "Time_End": 1600.74,
      "Text": " That one conveniently has the letters I and E and X."
    },
    {
      "Time_Start": 1600.74,
      "Time_End": 1603.06,
      "Text": " Ah, let's look at that one."
    },
    {
      "Time_Start": 1603.06,
      "Time_End": 1608.06,
      "Text": " So if we do string.indexof, then we can see, okay, there's actually a lot of overloaded"
    },
    {
      "Time_Start": 1608.06,
      "Time_End": 1609.18,
      "Text": " definitions there."
    },
    {
      "Time_Start": 1609.18,
      "Time_End": 1614.34,
      "Text": " I would love to get my hands on any of those I's and E's and X's, but it's an object."
    },
    {
      "Time_Start": 1614.34,
      "Time_End": 1616.84,
      "Text": " So let's throw it into a string."
    },
    {
      "Time_Start": 1616.84,
      "Time_End": 1621.14,
      "Text": " So we'll randomly choose between two different string syntaxes, then we have this long string"
    },
    {
      "Time_Start": 1621.3000000000002,
      "Time_End": 1623.3400000000001,
      "Text": " that gives us a lot of options."
    },
    {
      "Time_Start": 1623.3400000000001,
      "Time_End": 1627.0200000000002,
      "Text": " So for example, if we use the index 0, 7, or 8, that gives us I, E, X."
    },
    {
      "Time_Start": 1627.0200000000002,
      "Time_End": 1628.9,
      "Text": " But these are all the options that are in the tool."
    },
    {
      "Time_Start": 1628.9,
      "Time_End": 1632.6200000000001,
      "Text": " So I basically went through, wrote a script to enumerate every single member of these"
    },
    {
      "Time_Start": 1632.6200000000001,
      "Time_End": 1636.8200000000002,
      "Text": " string functions and pull out every single I, E, and X that works across PowerShell 2,"
    },
    {
      "Time_Start": 1636.8200000000002,
      "Time_End": 1640.5800000000002,
      "Text": " 3, 4, and 5, and threw it into the tool so it'll be randomly selected every single time"
    },
    {
      "Time_Start": 1640.5800000000002,
      "Time_End": 1642.46,
      "Text": " so the numbers will never be the same."
    },
    {
      "Time_Start": 1642.46,
      "Time_End": 1645.42,
      "Text": " But there's obviously some stuff that you can key off of in here if you're looking just"
    },
    {
      "Time_Start": 1645.42,
      "Time_End": 1647.74,
      "Text": " at the overall syntax itself."
    },
    {
      "Time_Start": 1647.74,
      "Time_End": 1650.7800000000002,
      "Text": " All right."
    },
    {
      "Time_Start": 1650.78,
      "Time_End": 1655.1399999999999,
      "Text": " So most of you would say, hey, all that stuff you just said is really great for red teamers"
    },
    {
      "Time_Start": 1655.1399999999999,
      "Time_End": 1656.98,
      "Text": " and sucks for blue teamers, right?"
    },
    {
      "Time_Start": 1656.98,
      "Time_End": 1659.86,
      "Text": " All right, well, what's the good news?"
    },
    {
      "Time_Start": 1659.86,
      "Time_End": 1663.42,
      "Text": " What's the redeeming factor for the blue teamers, right, because that's who I am?"
    },
    {
      "Time_Start": 1663.42,
      "Time_End": 1667.42,
      "Text": " Well, behavior is not really going to be affected by obfuscation."
    },
    {
      "Time_Start": 1667.42,
      "Time_End": 1668.62,
      "Text": " So what's the bigger picture?"
    },
    {
      "Time_Start": 1668.62,
      "Time_End": 1673.7,
      "Text": " What are some behaviors or artifacts that we can look for to detect this kind of activity?"
    },
    {
      "Time_Start": 1673.7,
      "Time_End": 1675.66,
      "Text": " First network connections."
    },
    {
      "Time_Start": 1675.66,
      "Time_End": 1680.66,
      "Text": " And one of the reasons I went down this rabbit hole with this project is, what if an organization"
    },
    {
      "Time_Start": 1680.98,
      "Time_End": 1684.98,
      "Text": " that your target is, is just looking for PowerShell making network connections, period?"
    },
    {
      "Time_Start": 1684.98,
      "Time_End": 1688.1000000000001,
      "Text": " Well, how can we pawn off network connections on other binaries?"
    },
    {
      "Time_Start": 1688.1000000000001,
      "Time_End": 1691.0600000000002,
      "Text": " And that's the coolest part of this project in my opinion."
    },
    {
      "Time_Start": 1691.0600000000002,
      "Time_End": 1695.3000000000002,
      "Text": " So for example, when you use bits, either bits admin or start bits transfer, svchost"
    },
    {
      "Time_Start": 1695.3000000000002,
      "Time_End": 1696.5,
      "Text": " actually makes a network connection."
    },
    {
      "Time_Start": 1696.5,
      "Time_End": 1700.8600000000001,
      "Text": " And it's not really a, there's no parent-child process relationship between PowerShell and"
    },
    {
      "Time_Start": 1700.8600000000001,
      "Time_End": 1704.14,
      "Text": " svchost in that process."
    },
    {
      "Time_Start": 1704.14,
      "Time_End": 1708.94,
      "Text": " For a com object, Word, Excel, IE, those applications make the network connection."
    },
    {
      "Time_Start": 1708.94,
      "Time_End": 1712.6200000000001,
      "Text": " And with SendKeys and Notepad, actually Notepad and svchost make the network connection."
    },
    {
      "Time_Start": 1712.6200000000001,
      "Time_End": 1715.9,
      "Text": " Actually they make quite a few network connections depending on how big your payload is."
    },
    {
      "Time_Start": 1715.9,
      "Time_End": 1718.3400000000001,
      "Text": " So something to keep in mind there."
    },
    {
      "Time_Start": 1718.3400000000001,
      "Time_End": 1719.3400000000001,
      "Text": " Parent-child process relationships."
    },
    {
      "Time_Start": 1719.3400000000001,
      "Time_End": 1722.78,
      "Text": " Again, if you're calling bits admin from PowerShell, that's pretty darn suspicious."
    },
    {
      "Time_Start": 1722.78,
      "Time_End": 1724.78,
      "Text": " And again, a lot of commodity malware does this."
    },
    {
      "Time_Start": 1724.78,
      "Time_End": 1725.78,
      "Text": " We see this quite a bit."
    },
    {
      "Time_Start": 1725.78,
      "Time_End": 1731.3400000000001,
      "Text": " But when it comes to com objects, what's great is that when Word and Excel and IE get spawned"
    },
    {
      "Time_Start": 1731.3400000000001,
      "Time_End": 1734.3400000000001,
      "Text": " by svchost, PowerShell doesn't even spawn them."
    },
    {
      "Time_Start": 1734.3400000000001,
      "Time_End": 1737.06,
      "Text": " So no great parent-child process relationship there."
    },
    {
      "Time_Start": 1737.06,
      "Time_End": 1741.34,
      "Text": " SendKeys and Notepad, well, in order to get the PID for Notepad to try to make it a little"
    },
    {
      "Time_Start": 1741.34,
      "Time_End": 1743.94,
      "Text": " more reliable, technically PowerShell does spawn Notepad."
    },
    {
      "Time_Start": 1743.94,
      "Time_End": 1746.1799999999998,
      "Text": " You could use WMI or some other stuff to do that."
    },
    {
      "Time_Start": 1746.1799999999998,
      "Time_End": 1749.3799999999999,
      "Text": " But it's, in my opinion, not really worth the effort to go to that length."
    },
    {
      "Time_Start": 1749.3799999999999,
      "Time_End": 1750.94,
      "Text": " And then for inline scripting."
    },
    {
      "Time_Start": 1750.94,
      "Time_End": 1754.78,
      "Text": " On the target system, if you do, if you have embedded inline C-sharp or anything else,"
    },
    {
      "Time_Start": 1754.78,
      "Time_End": 1756.3,
      "Text": " it will compile on the target system."
    },
    {
      "Time_Start": 1756.3,
      "Time_End": 1760.12,
      "Text": " So you'll see PowerShell, CSE, and CVTRES on the target system."
    },
    {
      "Time_Start": 1760.12,
      "Time_End": 1763.3799999999999,
      "Text": " So if you're not doing any compilation of C-sharp and PowerShell in your environment,"
    },
    {
      "Time_Start": 1763.3799999999999,
      "Time_End": 1766.8999999999999,
      "Text": " that's a pretty darn good indicator to look for, because a ton of groups, a lot of financial"
    },
    {
      "Time_Start": 1766.9,
      "Time_End": 1770.5,
      "Text": " groups, love to use shellcode loaders that are written in C-sharp."
    },
    {
      "Time_Start": 1770.5,
      "Time_End": 1771.5,
      "Text": " So we see this quite a bit."
    },
    {
      "Time_Start": 1771.5,
      "Time_End": 1774.66,
      "Text": " This has been really helpful on a lot of investigations."
    },
    {
      "Time_Start": 1774.66,
      "Time_End": 1775.66,
      "Text": " Event logs."
    },
    {
      "Time_Start": 1775.66,
      "Time_End": 1779.94,
      "Text": " Besides command line auditing and basically every PowerShell log, bitsadmin has its own"
    },
    {
      "Time_Start": 1779.94,
      "Time_End": 1782.22,
      "Text": " event log that logs by default, which is really great."
    },
    {
      "Time_Start": 1782.22,
      "Time_End": 1784.0600000000002,
      "Text": " So your URI is gonna be sitting in there."
    },
    {
      "Time_Start": 1784.0600000000002,
      "Time_End": 1787.5,
      "Text": " I'm not saying clear it, just saying be aware of it."
    },
    {
      "Time_Start": 1787.5,
      "Time_End": 1789.46,
      "Text": " And as defenders, it's something we should look for."
    },
    {
      "Time_Start": 1789.46,
      "Time_End": 1794.98,
      "Text": " Also if you're using Notepad, you'll see rundll making this davset cookie with your URI in"
    },
    {
      "Time_Start": 1794.98,
      "Time_End": 1796.66,
      "Text": " the command line arguments."
    },
    {
      "Time_Start": 1797.42,
      "Time_End": 1799.14,
      "Text": " So DLLs loaded."
    },
    {
      "Time_Start": 1799.14,
      "Time_End": 1800.74,
      "Text": " There's a lot of interesting ones here."
    },
    {
      "Time_Start": 1800.74,
      "Time_End": 1804.5800000000002,
      "Text": " When PowerShell, actually when anything loads IE as a com object, it's gonna load a nice"
    },
    {
      "Time_Start": 1804.5800000000002,
      "Time_End": 1807.22,
      "Text": " little DLL called IEProxy."
    },
    {
      "Time_Start": 1807.22,
      "Time_End": 1808.98,
      "Text": " How often does PowerShell do that?"
    },
    {
      "Time_Start": 1808.98,
      "Time_End": 1813.14,
      "Text": " If you're doing this from a macro, how often does WinWord load IEProxy?"
    },
    {
      "Time_Start": 1813.14,
      "Time_End": 1814.14,
      "Text": " And where do we find that?"
    },
    {
      "Time_Start": 1814.14,
      "Time_End": 1816.98,
      "Text": " Prefetch files is a great place if the prefetch file is still there."
    },
    {
      "Time_Start": 1816.98,
      "Time_End": 1819.5400000000002,
      "Text": " The one thing I really want to draw your attention to is PowerShell net.webclient."
    },
    {
      "Time_Start": 1819.5400000000002,
      "Time_End": 1821.3400000000001,
      "Text": " It loads a lot of DLLs."
    },
    {
      "Time_Start": 1821.3400000000001,
      "Time_End": 1824.94,
      "Text": " You can see here a couple, but RAS API 32 and RAS may not DLL."
    },
    {
      "Time_Start": 1825.22,
      "Time_End": 1828.8600000000001,
      "Text": " One of our consultants found this late last year in an engagement, and what's really cool"
    },
    {
      "Time_Start": 1828.8600000000001,
      "Time_End": 1833.6200000000001,
      "Text": " about this is that it happens to create a nice registry key for you."
    },
    {
      "Time_Start": 1833.6200000000001,
      "Time_End": 1836.8200000000002,
      "Text": " Every time any binary loads those to make a network connection."
    },
    {
      "Time_Start": 1836.8200000000002,
      "Time_End": 1839.26,
      "Text": " Now you can't trust the time sample in the registry key because it inherits it from the"
    },
    {
      "Time_Start": 1839.26,
      "Time_End": 1843.5,
      "Text": " parent registry key, but if PowerShell is not used to make network connections in an"
    },
    {
      "Time_Start": 1843.5,
      "Time_End": 1847.66,
      "Text": " environment, and let's say an unnamed fin group went through and was using PowerShell"
    },
    {
      "Time_Start": 1847.66,
      "Time_End": 1852.26,
      "Text": " to download a second stage payload, then you're gonna see these reg keys all over the place"
    },
    {
      "Time_Start": 1852.26,
      "Time_End": 1854.66,
      "Text": " for every system that second stage ran on."
    },
    {
      "Time_Start": 1854.66,
      "Time_End": 1856.8600000000001,
      "Text": " Pretty convenient stuff, right?"
    },
    {
      "Time_Start": 1856.8600000000001,
      "Time_End": 1857.8600000000001,
      "Text": " AppCompat cache."
    },
    {
      "Time_Start": 1857.8600000000001,
      "Time_End": 1861.78,
      "Text": " Again, if we see this shell loading activity, we're gonna see the very specific order of"
    },
    {
      "Time_Start": 1861.78,
      "Time_End": 1866.46,
      "Text": " PowerShell, CSC, CDT-RES, and AppCompat cache whenever these C-sharp loaders are being run"
    },
    {
      "Time_Start": 1866.46,
      "Time_End": 1867.8200000000002,
      "Text": " in PowerShell."
    },
    {
      "Time_Start": 1867.8200000000002,
      "Time_End": 1868.8200000000002,
      "Text": " Really good to look for."
    },
    {
      "Time_Start": 1868.8200000000002,
      "Time_End": 1870.78,
      "Text": " And lastly, cache temporary files."
    },
    {
      "Time_Start": 1870.78,
      "Time_End": 1876.3000000000002,
      "Text": " When you're using WinWord, Excel, IE, or Notepad, it's kind of memory only, but not really because"
    },
    {
      "Time_Start": 1876.3000000000002,
      "Time_End": 1880.22,
      "Text": " the applications will cache crap in temporary internet files or inet cache depending on"
    },
    {
      "Time_Start": 1880.22,
      "Time_End": 1881.22,
      "Text": " your OS."
    },
    {
      "Time_Start": 1881.58,
      "Time_End": 1884.8600000000001,
      "Text": " So, and a lot of times, the full payload will be there."
    },
    {
      "Time_Start": 1884.8600000000001,
      "Time_End": 1890.34,
      "Text": " So that's something to keep in mind, again, I'm not saying go and delete these cache files,"
    },
    {
      "Time_Start": 1890.34,
      "Time_End": 1893.38,
      "Text": " but they are there as a defender, so some yard rules might be pretty helpful to go through"
    },
    {
      "Time_Start": 1893.38,
      "Time_End": 1894.38,
      "Text": " and look."
    },
    {
      "Time_Start": 1894.38,
      "Time_End": 1898.14,
      "Text": " All right, it's demo time."
    },
    {
      "Time_Start": 1898.14,
      "Time_End": 1899.14,
      "Text": " Let's see if this works."
    },
    {
      "Time_Start": 1899.14,
      "Time_End": 1905.68,
      "Text": " Oh, of course, the obligatory please do not use this for evil, have full consent of whatever"
    },
    {
      "Time_Start": 1905.68,
      "Time_End": 1907.14,
      "Text": " environment you're using this in."
    },
    {
      "Time_Start": 1907.14,
      "Time_End": 1910.22,
      "Text": " And I don't say that jokingly, please."
    },
    {
      "Time_Start": 1910.22,
      "Time_End": 1911.22,
      "Text": " I'll come back."
    },
    {
      "Time_Start": 1924.82,
      "Time_End": 1925.82,
      "Text": " Can y'all see that all right?"
    },
    {
      "Time_Start": 1930.82,
      "Time_End": 1934.02,
      "Text": " All right, and this, I pushed this code about 20 minutes before I came up here, so it is"
    },
    {
      "Time_Start": 1934.02,
      "Time_End": 1935.02,
      "Text": " live."
    },
    {
      "Time_Start": 1935.02,
      "Time_End": 1938.22,
      "Text": " I'll have it."
    },
    {
      "Time_Start": 1938.22,
      "Time_End": 1939.22,
      "Text": " InvokeCradleCrafter.psd1."
    },
    {
      "Time_Start": 1939.22,
      "Time_End": 1940.22,
      "Text": " Did I misspell that?"
    },
    {
      "Time_Start": 1940.22,
      "Time_End": 1941.22,
      "Text": " Oh."
    },
    {
      "Time_Start": 1941.22,
      "Time_End": 1942.22,
      "Text": " Thank you."
    },
    {
      "Time_Start": 1942.22,
      "Time_End": 1943.22,
      "Text": " All right."
    },
    {
      "Time_Start": 1943.22,
      "Time_End": 1944.22,
      "Text": " And now we're gonna call invokeCradleCrafter."
    },
    {
      "Time_Start": 1944.22,
      "Time_End": 1945.22,
      "Text": " And there's my ASCII art."
    },
    {
      "Time_Start": 1945.22,
      "Time_End": 1946.22,
      "Text": " Spent way too much time on that."
    },
    {
      "Time_Start": 1946.22,
      "Time_End": 1947.22,
      "Text": " Basically building out a nice obfuscated cradle there."
    },
    {
      "Time_Start": 1947.22,
      "Time_End": 1948.22,
      "Text": " And it actually does run that command, that invokeCradleCrafter, so you can go home and"
    },
    {
      "Time_Start": 1948.22,
      "Time_End": 1949.22,
      "Text": " play with that if you'd like."
    },
    {
      "Time_Start": 1949.22,
      "Time_End": 1950.22,
      "Text": " All right."
    },
    {
      "Time_Start": 1950.22,
      "Time_End": 1951.22,
      "Text": " So let's see if this works."
    },
    {
      "Time_Start": 1951.22,
      "Time_End": 1952.22,
      "Text": " All right."
    },
    {
      "Time_Start": 1952.22,
      "Time_End": 1953.22,
      "Text": " All right."
    },
    {
      "Time_Start": 1953.22,
      "Time_End": 1954.22,
      "Text": " All right."
    },
    {
      "Time_Start": 1954.22,
      "Time_End": 1955.22,
      "Text": " All right."
    },
    {
      "Time_Start": 1955.22,
      "Time_End": 1956.22,
      "Text": " All right."
    },
    {
      "Time_Start": 1956.22,
      "Time_End": 1957.22,
      "Text": " All right."
    },
    {
      "Time_Start": 1957.22,
      "Time_End": 1958.22,
      "Text": " All right."
    },
    {
      "Time_Start": 1958.22,
      "Time_End": 1959.22,
      "Text": " All right."
    },
    {
      "Time_Start": 1959.22,
      "Time_End": 1960.22,
      "Text": " All right."
    },
    {
      "Time_Start": 1960.22,
      "Time_End": 1961.22,
      "Text": " All right."
    },
    {
      "Time_Start": 1961.22,
      "Time_End": 1962.22,
      "Text": " All right."
    },
    {
      "Time_Start": 1962.22,
      "Time_End": 1963.22,
      "Text": " All right."
    },
    {
      "Time_Start": 1963.22,
      "Time_End": 1964.22,
      "Text": " All right."
    },
    {
      "Time_Start": 1964.22,
      "Time_End": 1965.22,
      "Text": " All right."
    },
    {
      "Time_Start": 1965.22,
      "Time_End": 1966.22,
      "Text": " All right."
    },
    {
      "Time_Start": 1966.22,
      "Time_End": 1967.22,
      "Text": " All right."
    },
    {
      "Time_Start": 1967.22,
      "Time_End": 1968.22,
      "Text": " All right."
    },
    {
      "Time_Start": 1968.22,
      "Time_End": 1969.22,
      "Text": " All right."
    },
    {
      "Time_Start": 1969.22,
      "Time_End": 1970.22,
      "Text": " All right."
    },
    {
      "Time_Start": 1970.22,
      "Time_End": 1971.22,
      "Text": " All right."
    },
    {
      "Time_Start": 1971.22,
      "Time_End": 1972.22,
      "Text": " All right."
    },
    {
      "Time_Start": 1972.22,
      "Time_End": 1973.22,
      "Text": " All right."
    },
    {
      "Time_Start": 1973.22,
      "Time_End": 1974.22,
      "Text": " All right."
    },
    {
      "Time_Start": 1974.22,
      "Time_End": 1975.22,
      "Text": " All right."
    },
    {
      "Time_Start": 1975.22,
      "Time_End": 1976.22,
      "Text": " All right."
    },
    {
      "Time_Start": 1976.22,
      "Time_End": 1977.22,
      "Text": " All right."
    },
    {
      "Time_Start": 1977.22,
      "Time_End": 1978.22,
      "Text": " All right."
    },
    {
      "Time_Start": 1978.22,
      "Time_End": 1979.22,
      "Text": " All right."
    },
    {
      "Time_Start": 1979.22,
      "Time_End": 1980.22,
      "Text": " All right."
    },
    {
      "Time_Start": 1980.22,
      "Time_End": 1981.22,
      "Text": " All right."
    },
    {
      "Time_Start": 1981.22,
      "Time_End": 1982.22,
      "Text": " All right."
    },
    {
      "Time_Start": 1982.22,
      "Time_End": 1983.22,
      "Text": " All right."
    },
    {
      "Time_Start": 1983.22,
      "Time_End": 1984.22,
      "Text": " All right."
    },
    {
      "Time_Start": 1984.22,
      "Time_End": 1985.22,
      "Text": " So let's go home and play with that if you'd like."
    },
    {
      "Time_Start": 1985.22,
      "Time_End": 1986.22,
      "Text": " So we have very, very similar to invoke obfuscation."
    },
    {
      "Time_Start": 1986.22,
      "Time_End": 1987.22,
      "Text": " We have a nice tutorial here."
    },
    {
      "Time_Start": 1987.22,
      "Time_End": 1988.22,
      "Text": " So basically everything in yellow takes you to a new menu, and everything in green actually"
    },
    {
      "Time_Start": 1988.22,
      "Time_End": 1989.22,
      "Text": " applies something."
    },
    {
      "Time_Start": 1989.22,
      "Time_End": 1990.22,
      "Text": " So if we get to the tutorial, you'll see step one is basically setting your fields, so URL"
    },
    {
      "Time_Start": 1990.22,
      "Time_End": 1991.22,
      "Text": " and then path and host cradle command are optional."
    },
    {
      "Time_Start": 1991.22,
      "Time_End": 1992.54,
      "Text": " So, for example, let's do set URL bit.ly zifcon ASCII."
    },
    {
      "Time_Start": 1992.54,
      "Time_End": 1995.3,
      "Text": " We'll see what that is later."
    },
    {
      "Time_Start": 1995.3,
      "Time_End": 1997.7,
      "Text": " Alright, so we have memory and disk as our two options."
    },
    {
      "Time_Start": 1997.7,
      "Time_End": 2000.98,
      "Text": " So memory, you can see here very clearly"
    },
    {
      "Time_Start": 2000.98,
      "Time_End": 2003.98,
      "Text": " if it's PS3 or later, it's in bright red."
    },
    {
      "Time_Start": 2003.98,
      "Time_End": 2006.06,
      "Text": " So please don't yell at me if your stuff"
    },
    {
      "Time_Start": 2006.06,
      "Time_End": 2007.3,
      "Text": " doesn't work on PowerShell 2"
    },
    {
      "Time_Start": 2007.3,
      "Time_End": 2009.24,
      "Text": " because it's pretty darn explicit in the tool."
    },
    {
      "Time_Start": 2009.24,
      "Time_End": 2012.1,
      "Text": " So PSWebString, if we go here,"
    },
    {
      "Time_Start": 2012.1,
      "Time_End": 2013.8799999999999,
      "Text": " I took a lot of pain to go through"
    },
    {
      "Time_Start": 2013.8799999999999,
      "Time_End": 2015.5,
      "Text": " and actually build out information."
    },
    {
      "Time_Start": 2015.5,
      "Time_End": 2017.1,
      "Text": " Every time you enter a new Cradle context,"
    },
    {
      "Time_Start": 2017.1,
      "Time_End": 2018.98,
      "Text": " it says here's artifacts, behaviors,"
    },
    {
      "Time_Start": 2019.8999999999999,
      "Time_End": 2022.3999999999999,
      "Text": " indications that this thing may have just happened."
    },
    {
      "Time_Start": 2022.4,
      "Time_End": 2024.8400000000001,
      "Text": " So that as blue teamers, we have no excuse"
    },
    {
      "Time_Start": 2024.8400000000001,
      "Time_End": 2026.68,
      "Text": " to not be looking at these artifacts."
    },
    {
      "Time_Start": 2026.68,
      "Time_End": 2028.8400000000001,
      "Text": " And as red teamers, you can make a more informed selection"
    },
    {
      "Time_Start": 2028.8400000000001,
      "Time_End": 2031.48,
      "Text": " about what Cradle you wanna use in what situation."
    },
    {
      "Time_Start": 2031.48,
      "Time_End": 2033.44,
      "Text": " So please do look at that, and if you see any errors,"
    },
    {
      "Time_Start": 2033.44,
      "Time_End": 2037.0400000000002,
      "Text": " please let me know and we'll get those updated."
    },
    {
      "Time_Start": 2037.0400000000002,
      "Time_End": 2039.7,
      "Text": " So, Rearrange."
    },
    {
      "Time_Start": 2039.7,
      "Time_End": 2042.26,
      "Text": " By default, this is a one-liner command here."
    },
    {
      "Time_Start": 2042.26,
      "Time_End": 2044.3600000000001,
      "Text": " If I do multivariable, it'll break it out"
    },
    {
      "Time_Start": 2044.3600000000001,
      "Time_End": 2046.76,
      "Text": " into normal variable syntax and normal variable names."
    },
    {
      "Time_Start": 2046.76,
      "Time_End": 2050.42,
      "Text": " Now if you notice here, that URL is in blue, right?"
    },
    {
      "Time_Start": 2051.42,
      "Time_End": 2053.14,
      "Text": " Again, I took way too much time on this."
    },
    {
      "Time_Start": 2053.14,
      "Time_End": 2055.54,
      "Text": " Any input that you have, which is your URL,"
    },
    {
      "Time_Start": 2055.54,
      "Time_End": 2058.5,
      "Text": " a path in post-Cradle command, will always appear in blue."
    },
    {
      "Time_Start": 2058.5,
      "Time_End": 2059.78,
      "Text": " So when the command gets really crazy,"
    },
    {
      "Time_Start": 2059.78,
      "Time_End": 2062.58,
      "Text": " you know what's the stuff that I contributed to."
    },
    {
      "Time_Start": 2062.58,
      "Time_End": 2063.7400000000002,
      "Text": " The whole command will be white"
    },
    {
      "Time_Start": 2063.7400000000002,
      "Time_End": 2065.46,
      "Text": " except for the thing that just changed."
    },
    {
      "Time_Start": 2065.46,
      "Time_End": 2067.82,
      "Text": " So all the yellow pieces, all the things that just changed."
    },
    {
      "Time_Start": 2067.82,
      "Time_End": 2069.9,
      "Text": " So if we do random variable,"
    },
    {
      "Time_Start": 2069.9,
      "Time_End": 2071.78,
      "Text": " those are all the things that changed there."
    },
    {
      "Time_Start": 2071.78,
      "Time_End": 2073.62,
      "Text": " And I really took way too much time doing this"
    },
    {
      "Time_Start": 2073.62,
      "Time_End": 2076.2000000000003,
      "Text": " because the point of this isn't to create some hack tool,"
    },
    {
      "Time_Start": 2076.2000000000003,
      "Time_End": 2078.98,
      "Text": " it's to help inform users of how you can substitute"
    },
    {
      "Time_Start": 2078.98,
      "Time_End": 2081.62,
      "Text": " these pieces and why it still works."
    },
    {
      "Time_Start": 2081.62,
      "Time_End": 2083.38,
      "Text": " So we'll leave that Rearrange option."
    },
    {
      "Time_Start": 2083.38,
      "Time_End": 2085.02,
      "Text": " Commandlet, for new object."
    },
    {
      "Time_Start": 2085.02,
      "Time_End": 2087.62,
      "Text": " Again, the default is just new-object."
    },
    {
      "Time_Start": 2087.62,
      "Time_End": 2088.54,
      "Text": " We can use git command."
    },
    {
      "Time_Start": 2088.54,
      "Time_End": 2091.2400000000002,
      "Text": " So in this case, it's using git-command."
    },
    {
      "Time_Start": 2091.2400000000002,
      "Time_End": 2092.14,
      "Text": " Now it's using command."
    },
    {
      "Time_Start": 2092.14,
      "Time_End": 2094.5,
      "Text": " You'll see it's using random invocation operator"
    },
    {
      "Time_Start": 2094.5,
      "Time_End": 2096.06,
      "Text": " as well as wildcard string."
    },
    {
      "Time_Start": 2096.06,
      "Time_End": 2097.68,
      "Text": " So we'll go with that one."
    },
    {
      "Time_Start": 2097.68,
      "Time_End": 2099.98,
      "Text": " Method, downloadString is the default."
    },
    {
      "Time_Start": 2099.98,
      "Time_End": 2102.02,
      "Text": " Number two would be the PS object enumeration."
    },
    {
      "Time_Start": 2102.02,
      "Time_End": 2103.86,
      "Text": " So this is our wildcard that is selected"
    },
    {
      "Time_Start": 2103.86,
      "Time_End": 2105.5,
      "Text": " for downloadString."
    },
    {
      "Time_Start": 2105.5,
      "Time_End": 2107.7,
      "Text": " This is almost the same except it's using getMember"
    },
    {
      "Time_Start": 2107.7,
      "Time_End": 2111.62,
      "Text": " instead of ps.object, or ps.object.method."
    },
    {
      "Time_Start": 2111.62,
      "Time_End": 2113.2599999999998,
      "Text": " So we'll go with that one."
    },
    {
      "Time_Start": 2113.2599999999998,
      "Time_End": 2114.62,
      "Text": " Invoke."
    },
    {
      "Time_Start": 2114.62,
      "Time_End": 2118.14,
      "Text": " So by default, I do not add an invoke function."
    },
    {
      "Time_Start": 2118.14,
      "Time_End": 2119.8599999999997,
      "Text": " And the reason is because sometimes you probably"
    },
    {
      "Time_Start": 2119.8599999999997,
      "Time_End": 2123.06,
      "Text": " don't want to run that Cobalt strike stage on your system,"
    },
    {
      "Time_Start": 2123.06,
      "Time_End": 2124.62,
      "Text": " but you want to make sure,"
    },
    {
      "Time_Start": 2124.62,
      "Time_End": 2126.18,
      "Text": " is this Debo's guy's obfuscation?"
    },
    {
      "Time_Start": 2126.18,
      "Time_End": 2127.5,
      "Text": " Is it actually working?"
    },
    {
      "Time_Start": 2127.5,
      "Time_End": 2129.46,
      "Text": " Let me just make sure before I add invoke"
    },
    {
      "Time_Start": 2129.46,
      "Time_End": 2131.3399999999997,
      "Text": " that it actually downloads the payload."
    },
    {
      "Time_Start": 2131.3399999999997,
      "Time_End": 2132.8599999999997,
      "Text": " In this case, we'll just go ahead and add an invoke."
    },
    {
      "Time_Start": 2132.8599999999997,
      "Time_End": 2135.3599999999997,
      "Text": " And again, we have our regular invoke syntax"
    },
    {
      "Time_Start": 2135.36,
      "Time_End": 2138.8,
      "Text": " before or after getAliases3, we have getCommand,"
    },
    {
      "Time_Start": 2138.8,
      "Time_End": 2140.44,
      "Text": " pretty much all the things we walked through."
    },
    {
      "Time_Start": 2140.44,
      "Time_End": 2143.08,
      "Text": " And then nine, of course, my favorite"
    },
    {
      "Time_Start": 2143.08,
      "Time_End": 2145.84,
      "Text": " is doing randomized IEX concatenation."
    },
    {
      "Time_Start": 2145.84,
      "Time_End": 2146.96,
      "Text": " So we'll go with this."
    },
    {
      "Time_Start": 2146.96,
      "Time_End": 2149.52,
      "Text": " And now, we can just run test."
    },
    {
      "Time_Start": 2149.52,
      "Time_End": 2150.48,
      "Text": " And if it works."
    },
    {
      "Time_Start": 2152.04,
      "Time_End": 2153.88,
      "Text": " There we go, iHeartZipCon."
    },
    {
      "Time_Start": 2153.88,
      "Time_End": 2155.44,
      "Text": " So this is our payload, right?"
    },
    {
      "Time_Start": 2156.52,
      "Time_End": 2157.36,
      "Text": " Woo!"
    },
    {
      "Time_Start": 2157.36,
      "Time_End": 2162.36,
      "Text": " And so if you're like me, that was a lot of keystrokes"
    },
    {
      "Time_Start": 2163.1600000000003,
      "Time_End": 2164.0,
      "Text": " to go through and do that."
    },
    {
      "Time_Start": 2164.0,
      "Time_End": 2166.96,
      "Text": " So I've, of course, included the nice all,"
    },
    {
      "Time_Start": 2166.96,
      "Time_End": 2168.92,
      "Text": " and you can just do all of it at once,"
    },
    {
      "Time_Start": 2168.92,
      "Time_End": 2169.76,
      "Text": " as many times as you want."
    },
    {
      "Time_Start": 2169.76,
      "Time_End": 2171.52,
      "Text": " And again, invoke obfuscation,"
    },
    {
      "Time_Start": 2171.52,
      "Time_End": 2173.04,
      "Text": " if you kept hitting one, one, one, one, one,"
    },
    {
      "Time_Start": 2173.04,
      "Time_End": 2174.28,
      "Text": " it would grow, grow, grow, grow, grow."
    },
    {
      "Time_Start": 2174.28,
      "Time_End": 2175.92,
      "Text": " This isn't, because this is not adding to,"
    },
    {
      "Time_Start": 2175.92,
      "Time_End": 2177.28,
      "Text": " it's simply making substitutions"
    },
    {
      "Time_Start": 2177.28,
      "Time_End": 2179.16,
      "Text": " in all the places that it can."
    },
    {
      "Time_Start": 2179.16,
      "Time_End": 2180.6,
      "Text": " So typically, what I'll do is I'll go through"
    },
    {
      "Time_Start": 2180.6,
      "Time_End": 2182.68,
      "Text": " and I'll put all obfuscation, and then I'll go back"
    },
    {
      "Time_Start": 2182.68,
      "Time_End": 2184.68,
      "Text": " and start to pick the ones I want to make sure,"
    },
    {
      "Time_Start": 2184.68,
      "Time_End": 2186.08,
      "Text": " I want to make sure it's this syntax."
    },
    {
      "Time_Start": 2186.08,
      "Time_End": 2187.2,
      "Text": " Let me go through and repeat, repeat,"
    },
    {
      "Time_Start": 2187.2,
      "Time_End": 2188.6,
      "Text": " until it's a syntax that I like."
    },
    {
      "Time_Start": 2188.6,
      "Time_End": 2190.12,
      "Text": " And you'll see that in some of these other ones,"
    },
    {
      "Time_Start": 2190.12,
      "Time_End": 2193.12,
      "Text": " like ps.com.object.ie, there's a lot more properties here."
    },
    {
      "Time_Start": 2193.12,
      "Time_End": 2194.6,
      "Text": " There's a lot more things you can change,"
    },
    {
      "Time_Start": 2194.6,
      "Time_End": 2196.72,
      "Text": " and a lot more information up here."
    },
    {
      "Time_Start": 2196.72,
      "Time_End": 2200.46,
      "Text": " And if I go all there, then that's a chunk of change"
    },
    {
      "Time_Start": 2200.46,
      "Time_End": 2202.66,
      "Text": " right there, that's a lot of cradle."
    },
    {
      "Time_Start": 2202.66,
      "Time_End": 2205.52,
      "Text": " So again, I hope that the colors are informative"
    },
    {
      "Time_Start": 2205.52,
      "Time_End": 2209.2,
      "Text": " and actually help convey what's happening behind the scenes."
    },
    {
      "Time_Start": 2209.2,
      "Time_End": 2211.7999999999997,
      "Text": " And right now, there's a few cradles"
    },
    {
      "Time_Start": 2211.7999999999997,
      "Time_End": 2213.04,
      "Text": " that are still in testing,"
    },
    {
      "Time_Start": 2213.04,
      "Time_End": 2215.42,
      "Text": " so namely the inline C sharp and the bits."
    },
    {
      "Time_Start": 2215.42,
      "Time_End": 2217.62,
      "Text": " Those will be released within the next two weeks,"
    },
    {
      "Time_Start": 2217.62,
      "Time_End": 2219.3199999999997,
      "Text": " so bear with me on that, but I hope,"
    },
    {
      "Time_Start": 2219.3199999999997,
      "Time_End": 2221.3199999999997,
      "Text": " I feel like this is enough to get off to the races"
    },
    {
      "Time_Start": 2221.32,
      "Time_End": 2224.52,
      "Text": " and get a good head start on when it comes to testing these"
    },
    {
      "Time_Start": 2224.52,
      "Time_End": 2226.92,
      "Text": " from a red team and blue team perspective."
    },
    {
      "Time_Start": 2226.92,
      "Time_End": 2228.32,
      "Text": " So closing comments."
    },
    {
      "Time_Start": 2229.46,
      "Time_End": 2231.36,
      "Text": " Please do not run away from PowerShell,"
    },
    {
      "Time_Start": 2231.36,
      "Time_End": 2233.32,
      "Text": " because a lot of people are saying that."
    },
    {
      "Time_Start": 2233.32,
      "Time_End": 2235.1600000000003,
      "Text": " There's so much good that PowerShell can do,"
    },
    {
      "Time_Start": 2235.1600000000003,
      "Time_End": 2237.32,
      "Text": " and the logging and security features"
    },
    {
      "Time_Start": 2237.32,
      "Time_End": 2240.2000000000003,
      "Text": " that come with PowerShell 5 are insanely good,"
    },
    {
      "Time_Start": 2240.2000000000003,
      "Time_End": 2241.3,
      "Text": " just so few people have them."
    },
    {
      "Time_Start": 2241.3,
      "Time_End": 2244.44,
      "Text": " And I totally realize that it produces a ton of logs,"
    },
    {
      "Time_Start": 2244.44,
      "Time_End": 2247.2400000000002,
      "Text": " and there's some research that I'm working on"
    },
    {
      "Time_Start": 2247.2400000000002,
      "Time_End": 2251.6400000000003,
      "Text": " to help make available some techniques,"
    },
    {
      "Time_Start": 2251.6400000000003,
      "Time_End": 2252.48,
      "Text": " as opposed to me just saying,"
    },
    {
      "Time_Start": 2252.48,
      "Time_End": 2255.4,
      "Text": " hey, you should look for a lot of characters"
    },
    {
      "Time_Start": 2255.4,
      "Time_End": 2256.6000000000004,
      "Text": " and frequency analysis."
    },
    {
      "Time_Start": 2257.5600000000004,
      "Time_End": 2259.1200000000003,
      "Text": " It'd be cool if there was an open source thing"
    },
    {
      "Time_Start": 2259.1200000000003,
      "Time_End": 2260.8,
      "Text": " that actually just did that, right?"
    },
    {
      "Time_Start": 2260.8,
      "Time_End": 2263.2400000000002,
      "Text": " So anyways, hopefully more on that later."
    },
    {
      "Time_Start": 2263.2400000000002,
      "Time_End": 2265.7200000000003,
      "Text": " My message, upgrade to PowerShell 5, please."
    },
    {
      "Time_Start": 2265.7200000000003,
      "Time_End": 2268.6800000000003,
      "Text": " Even if you don't have the capacity to look at the stuff,"
    },
    {
      "Time_Start": 2268.6800000000003,
      "Time_End": 2270.7200000000003,
      "Text": " turn on the logs, aggregate the logs,"
    },
    {
      "Time_Start": 2270.7200000000003,
      "Time_End": 2272.76,
      "Text": " and if nothing else, just set up a cron job"
    },
    {
      "Time_Start": 2272.76,
      "Time_End": 2274.6800000000003,
      "Text": " and start grepping through for something."
    },
    {
      "Time_Start": 2274.6800000000003,
      "Time_End": 2276.0000000000005,
      "Text": " We all need to start somewhere,"
    },
    {
      "Time_Start": 2276.16,
      "Time_End": 2277.72,
      "Text": " and get these small wins,"
    },
    {
      "Time_Start": 2277.72,
      "Time_End": 2279.88,
      "Text": " and expand our detection to include more and more artifacts"
    },
    {
      "Time_Start": 2279.88,
      "Time_End": 2281.76,
      "Text": " that we looked at on this list."
    },
    {
      "Time_Start": 2281.76,
      "Time_End": 2283.98,
      "Text": " And as always, you'll hear me talk about"
    },
    {
      "Time_Start": 2283.98,
      "Time_End": 2285.6,
      "Text": " breaking our assumptions of what we always thought"
    },
    {
      "Time_Start": 2285.6,
      "Time_End": 2287.0,
      "Text": " a cradle would look like,"
    },
    {
      "Time_Start": 2287.0,
      "Time_End": 2289.56,
      "Text": " and again, what if notepad's downloading the payload,"
    },
    {
      "Time_Start": 2289.56,
      "Time_End": 2291.68,
      "Text": " or what if IE or something else is,"
    },
    {
      "Time_Start": 2291.68,
      "Time_End": 2294.6,
      "Text": " and how would that bypass some of our detections today,"
    },
    {
      "Time_Start": 2294.6,
      "Time_End": 2299.36,
      "Text": " and how can we make changes to not be bypassed?"
    },
    {
      "Time_Start": 2299.36,
      "Time_End": 2300.92,
      "Text": " And we need to accept that we're gonna miss stuff."
    },
    {
      "Time_Start": 2300.92,
      "Time_End": 2303.28,
      "Text": " We're all humans, and there's people way smarter than me"
    },
    {
      "Time_Start": 2303.28,
      "Time_End": 2305.28,
      "Text": " that are doing stuff we've never even thought about before"
    },
    {
      "Time_Start": 2305.28,
      "Time_End": 2307.36,
      "Text": " that hopefully we'll find in an investigation at some point"
    },
    {
      "Time_Start": 2307.36,
      "Time_End": 2309.1600000000003,
      "Text": " and write a blog about or something,"
    },
    {
      "Time_Start": 2309.1600000000003,
      "Time_End": 2312.0800000000004,
      "Text": " but ultimately, we can't expect to be able to solve"
    },
    {
      "Time_Start": 2312.0800000000004,
      "Time_End": 2313.76,
      "Text": " all this in one fell swoop."
    },
    {
      "Time_Start": 2313.76,
      "Time_End": 2315.32,
      "Text": " It takes time, it takes failing,"
    },
    {
      "Time_Start": 2315.32,
      "Time_End": 2317.6000000000004,
      "Text": " it takes repeated tries and tries again,"
    },
    {
      "Time_Start": 2317.6000000000004,
      "Time_End": 2319.48,
      "Text": " and the most beneficial thing that we can do"
    },
    {
      "Time_Start": 2319.48,
      "Time_End": 2321.8,
      "Text": " is to share both successes, and more importantly,"
    },
    {
      "Time_Start": 2321.8,
      "Time_End": 2323.38,
      "Text": " failures with the community"
    },
    {
      "Time_Start": 2323.38,
      "Time_End": 2327.02,
      "Text": " so that we all get better together in forums just like this."
    },
    {
      "Time_Start": 2328.28,
      "Time_End": 2330.76,
      "Text": " So, huge, huge thanks to a lot of my colleagues,"
    },
    {
      "Time_Start": 2330.76,
      "Time_End": 2333.6400000000003,
      "Text": " in particular, Nick Carr, Ian Awe, and Matt Dunwoody."
    },
    {
      "Time_Start": 2333.64,
      "Time_End": 2337.48,
      "Text": " They really make my job extremely fun"
    },
    {
      "Time_Start": 2337.48,
      "Time_End": 2340.64,
      "Text": " and make hunting just unbelievably cool."
    },
    {
      "Time_Start": 2340.64,
      "Time_End": 2342.44,
      "Text": " Matt Dunwoody's actually been doing some really cool stuff"
    },
    {
      "Time_Start": 2342.44,
      "Time_End": 2344.8399999999997,
      "Text": " with detecting this stuff in memory"
    },
    {
      "Time_Start": 2344.8399999999997,
      "Time_End": 2346.7999999999997,
      "Text": " that's been really, really fascinating to watch."
    },
    {
      "Time_Start": 2346.7999999999997,
      "Time_End": 2348.94,
      "Text": " I'd also like to thank my colleague, Evan Pena."
    },
    {
      "Time_Start": 2348.94,
      "Time_End": 2350.2799999999997,
      "Text": " He's one of our red team guys"
    },
    {
      "Time_Start": 2350.2799999999997,
      "Time_End": 2354.16,
      "Text": " who undoubtedly performed an insane level of QA"
    },
    {
      "Time_Start": 2354.16,
      "Time_End": 2355.56,
      "Text": " on several iterations of this cradle,"
    },
    {
      "Time_Start": 2355.56,
      "Time_End": 2357.2799999999997,
      "Text": " so Evan, big shout out to you,"
    },
    {
      "Time_Start": 2357.2799999999997,
      "Time_End": 2359.68,
      "Text": " and then lastly, I'd just like to thank my wife, Paige,"
    },
    {
      "Time_Start": 2359.68,
      "Time_End": 2362.24,
      "Text": " because she really supports me in doing this research,"
    },
    {
      "Time_Start": 2362.28,
      "Time_End": 2364.76,
      "Text": " and when it's hundreds and hundreds of hours"
    },
    {
      "Time_Start": 2364.76,
      "Time_End": 2366.0400000000004,
      "Text": " sitting at home in front of your laptop"
    },
    {
      "Time_Start": 2366.0400000000004,
      "Time_End": 2368.92,
      "Text": " doing this kind of stuff at crazy hours into the night,"
    },
    {
      "Time_Start": 2368.92,
      "Time_End": 2372.6800000000003,
      "Text": " it's not the most fun thing for her to sit and watch me do,"
    },
    {
      "Time_Start": 2372.6800000000003,
      "Time_End": 2376.42,
      "Text": " so I really do appreciate that support."
    },
    {
      "Time_Start": 2376.42,
      "Time_End": 2377.7200000000003,
      "Text": " That was a lot of content,"
    },
    {
      "Time_Start": 2378.6400000000003,
      "Time_End": 2380.92,
      "Text": " and I would like to say that please"
    },
    {
      "Time_Start": 2380.92,
      "Time_End": 2382.0000000000005,
      "Text": " reach out to me on Twitter,"
    },
    {
      "Time_Start": 2382.0000000000005,
      "Time_End": 2383.6400000000003,
      "Text": " and I'll be around all day today,"
    },
    {
      "Time_Start": 2383.6400000000003,
      "Time_End": 2384.48,
      "Text": " be around tomorrow as well,"
    },
    {
      "Time_Start": 2384.48,
      "Time_End": 2385.32,
      "Text": " so please come talk to me"
    },
    {
      "Time_Start": 2385.32,
      "Time_End": 2387.28,
      "Text": " if you have any questions, criticisms, comments."
    },
    {
      "Time_Start": 2387.28,
      "Time_End": 2389.0400000000004,
      "Text": " I'd love to talk to you and hear what you have to say,"
    },
    {
      "Time_Start": 2389.0400000000004,
      "Time_End": 2391.0000000000005,
      "Text": " and from the bottom of my heart,"
    },
    {
      "Time_Start": 2391.0,
      "Time_End": 2392.88,
      "Text": " I've had the best time in Poland."
    },
    {
      "Time_Start": 2392.88,
      "Time_End": 2394.92,
      "Text": " First time here, awesome time at ZipCon,"
    },
    {
      "Time_Start": 2394.92,
      "Time_End": 2397.28,
      "Text": " so thank you very much for having me."
    },
    {
      "Time_Start": 2397.28,
      "Time_End": 2398.12,
      "Text": " Woo!"
    },
    {
      "Time_Start": 2398.12,
      "Time_End": 2398.94,
      "Text": " Woo!"
    },
    {
      "Time_Start": 2398.94,
      "Time_End": 2399.78,
      "Text": " Woo!"
    },
    {
      "Time_Start": 2399.78,
      "Time_End": 2400.62,
      "Text": " Woo!"
    },
    {
      "Time_Start": 2400.62,
      "Time_End": 2401.44,
      "Text": " Woo!"
    },
    {
      "Time_Start": 2401.44,
      "Time_End": 2402.28,
      "Text": " Woo!"
    },
    {
      "Time_Start": 2402.28,
      "Time_End": 2403.12,
      "Text": " Woo!"
    },
    {
      "Time_Start": 2403.12,
      "Time_End": 2403.94,
      "Text": " Woo!"
    },
    {
      "Time_Start": 2403.94,
      "Time_End": 2404.78,
      "Text": " Woo!"
    },
    {
      "Time_Start": 2404.78,
      "Time_End": 2405.62,
      "Text": " Woo!"
    },
    {
      "Time_Start": 2405.62,
      "Time_End": 2406.44,
      "Text": " Woo!"
    },
    {
      "Time_Start": 2406.44,
      "Time_End": 2407.28,
      "Text": " Woo!"
    },
    {
      "Time_Start": 2407.28,
      "Time_End": 2408.12,
      "Text": " Woo!"
    },
    {
      "Time_Start": 2408.12,
      "Time_End": 2408.94,
      "Text": " Woo!"
    },
    {
      "Time_Start": 2408.94,
      "Time_End": 2409.78,
      "Text": " Woo!"
    },
    {
      "Time_Start": 2409.78,
      "Time_End": 2410.62,
      "Text": " Woo!"
    },
    {
      "Time_Start": 2410.62,
      "Time_End": 2411.44,
      "Text": " Woo!"
    },
    {
      "Time_Start": 2411.44,
      "Time_End": 2412.28,
      "Text": " Woo!"
    },
    {
      "Time_Start": 2412.28,
      "Time_End": 2413.12,
      "Text": " Woo!"
    },
    {
      "Time_Start": 2413.12,
      "Time_End": 2413.94,
      "Text": " Woo!"
    },
    {
      "Time_Start": 2413.94,
      "Time_End": 2414.78,
      "Text": " Woo!"
    },
    {
      "Time_Start": 2414.78,
      "Time_End": 2415.62,
      "Text": " Woo!"
    },
    {
      "Time_Start": 2415.62,
      "Time_End": 2416.44,
      "Text": " Woo!"
    },
    {
      "Time_Start": 2416.44,
      "Time_End": 2417.28,
      "Text": " Woo!"
    },
    {
      "Time_Start": 2417.28,
      "Time_End": 2418.12,
      "Text": " Woo!"
    },
    {
      "Time_Start": 2418.12,
      "Time_End": 2418.94,
      "Text": " Woo!"
    },
    {
      "Time_Start": 2418.94,
      "Time_End": 2419.78,
      "Text": " Woo!"
    },
    {
      "Time_Start": 2419.78,
      "Time_End": 2420.62,
      "Text": " Woo!"
    }
  ]
}