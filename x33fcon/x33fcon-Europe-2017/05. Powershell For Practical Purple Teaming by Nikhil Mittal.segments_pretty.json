{
  "segments": [
    {
      "Time_Start": 0.0,
      "Time_End": 16.4,
      "Text": "This text was transcribed using whisper model: large-v2\n\n So, thank you very much for coming to the talk."
    },
    {
      "Time_Start": 16.4,
      "Time_End": 25.12,
      "Text": " I'm going to talk about how we can use PowerShell for practical purple teaming, not the stuff"
    },
    {
      "Time_Start": 25.12,
      "Time_End": 26.68,
      "Text": " which was discussed in the talk."
    },
    {
      "Time_Start": 26.68,
      "Time_End": 30.24,
      "Text": " That talk you should watch after this one, because I'm not going to discuss how you"
    },
    {
      "Time_Start": 30.24,
      "Time_End": 37.6,
      "Text": " can actually process the events once you connect them from a Windows box, let's say."
    },
    {
      "Time_Start": 37.6,
      "Time_End": 44.64,
      "Text": " First, maybe after the conference, if you're trying to implement something really practical"
    },
    {
      "Time_Start": 44.64,
      "Time_End": 47.64,
      "Text": " out of the talk, watch this one first."
    },
    {
      "Time_Start": 47.64,
      "Time_End": 52.32,
      "Text": " See how I just point to how you can collect some data, and then see the previous one,"
    },
    {
      "Time_Start": 52.32,
      "Time_End": 56.16,
      "Text": " how you can actually do it on scale."
    },
    {
      "Time_Start": 56.160000000000004,
      "Time_End": 59.480000000000004,
      "Text": " With that, a couple of things about me."
    },
    {
      "Time_Start": 59.480000000000004,
      "Time_End": 61.080000000000005,
      "Text": " I'm a hacker, obviously."
    },
    {
      "Time_Start": 61.080000000000005,
      "Time_End": 66.08,
      "Text": " I train at various conferences, trained for the past three days at ZipCon."
    },
    {
      "Time_Start": 66.08,
      "Time_End": 70.52000000000001,
      "Text": " I speak at some of the conferences spoken at many around the world."
    },
    {
      "Time_Start": 70.52000000000001,
      "Time_End": 75.2,
      "Text": " On Twitter, you can find me on this ID, Nikhil underscore MITT."
    },
    {
      "Time_Start": 75.2,
      "Time_End": 77.80000000000001,
      "Text": " So if you are on Twitter, please follow me."
    },
    {
      "Time_Start": 77.80000000000001,
      "Time_End": 82.28,
      "Text": " As I always say, I'm a sucker for Twitter followers."
    },
    {
      "Time_Start": 82.28,
      "Time_End": 84.08000000000001,
      "Text": " So please do that."
    },
    {
      "Time_Start": 84.08,
      "Time_End": 87.67999999999999,
      "Text": " I blog regularly on labofpenetrationtester.com."
    },
    {
      "Time_Start": 87.67999999999999,
      "Time_End": 89.84,
      "Text": " That's my home on the internet."
    },
    {
      "Time_Start": 89.84,
      "Time_End": 95.96,
      "Text": " I maintain two open source toolkits for red teamers, penetration testers, hackers, whatever"
    },
    {
      "Time_Start": 95.96,
      "Time_End": 99.0,
      "Text": " you want to say, Cautelia and Nishang."
    },
    {
      "Time_Start": 99.0,
      "Time_End": 105.6,
      "Text": " Cautelia is useful for using human interface devices for offensive security, penetration"
    },
    {
      "Time_Start": 105.6,
      "Time_End": 110.16,
      "Text": " testing, to break into boxes where, of course, we have the permission to do so."
    },
    {
      "Time_Start": 110.16,
      "Time_End": 116.11999999999999,
      "Text": " Nishang is a tool which is a collection of partial scripts which you can use in different"
    },
    {
      "Time_Start": 116.11999999999999,
      "Time_End": 118.52,
      "Text": " phases of a penetration test."
    },
    {
      "Time_Start": 118.52,
      "Time_End": 123.8,
      "Text": " I'm generally interested in new ways of breaking into boxes, once again, where I have permission"
    },
    {
      "Time_Start": 123.8,
      "Time_End": 124.8,
      "Text": " to do so."
    },
    {
      "Time_Start": 124.8,
      "Time_End": 132.51999999999998,
      "Text": " I have previously spoken at DEF CON, Black Hat, Troopers, ShakerCon, and a few more conferences."
    },
    {
      "Time_Start": 132.51999999999998,
      "Time_End": 137.68,
      "Text": " So what we are going to discuss today is what traditional red teaming was."
    },
    {
      "Time_Start": 137.68,
      "Time_End": 145.64000000000001,
      "Text": " Of course, you must have seen some of these things already from the morning, why purple"
    },
    {
      "Time_Start": 145.64000000000001,
      "Time_End": 151.36,
      "Text": " teaming is a bit better than traditional red teaming, what purple teaming is actually,"
    },
    {
      "Time_Start": 151.36,
      "Time_End": 156.24,
      "Text": " why we would like to use PowerShell for different things."
    },
    {
      "Time_Start": 156.24,
      "Time_End": 163.32,
      "Text": " Then a couple of stories I would take to you through purple teaming stories with live demonstrations."
    },
    {
      "Time_Start": 163.32,
      "Time_End": 166.16,
      "Text": " Hopefully that would be the more interesting part."
    },
    {
      "Time_Start": 166.16,
      "Time_End": 172.64,
      "Text": " And then how we can implement purple teaming or just brainstorming how purple teaming can"
    },
    {
      "Time_Start": 172.64,
      "Time_End": 176.64,
      "Text": " be done with an external red team as well."
    },
    {
      "Time_Start": 176.64,
      "Time_End": 185.04,
      "Text": " So the traditional red teaming has an adversarial nature, that is, it has been red versus blue."
    },
    {
      "Time_Start": 185.04,
      "Time_End": 192.72,
      "Text": " You need a result, who won, red won or blue won."
    },
    {
      "Time_Start": 192.72,
      "Time_End": 198.72,
      "Text": " I have been into engagements where there have been actually tracks or metrics of the"
    },
    {
      "Time_Start": 198.72,
      "Time_End": 202.07999999999998,
      "Text": " points scored, who scored more points."
    },
    {
      "Time_Start": 202.07999999999998,
      "Time_End": 210.52,
      "Text": " And that is where the adversarial nature, the red versus blue narrative comes in."
    },
    {
      "Time_Start": 210.52,
      "Time_End": 215.07999999999998,
      "Text": " Also what a traditional red teaming is, of course, I'm in no way against traditional"
    },
    {
      "Time_Start": 215.07999999999998,
      "Time_End": 216.2,
      "Text": " red teaming."
    },
    {
      "Time_Start": 216.2,
      "Time_End": 218.96,
      "Text": " That's my bread and butter as well."
    },
    {
      "Time_Start": 218.96,
      "Time_End": 225.32000000000002,
      "Text": " But in traditional red teaming, what we see generally is it is focused on stealth."
    },
    {
      "Time_Start": 225.32000000000002,
      "Time_End": 231.76000000000002,
      "Text": " The goal for red team is not to get caught, which is perfectly fine."
    },
    {
      "Time_Start": 231.76000000000002,
      "Time_End": 240.68,
      "Text": " If we are trying to simulate a real adversary, the best way is not to get caught, maybe for"
    },
    {
      "Time_Start": 240.68,
      "Time_End": 246.20000000000002,
      "Text": " like 10 years or maybe 4 years, 2 months, 1 week, depends on the length of the red team"
    },
    {
      "Time_Start": 246.20000000000002,
      "Time_End": 247.20000000000002,
      "Text": " engagement."
    },
    {
      "Time_Start": 247.44000000000003,
      "Time_End": 251.88000000000002,
      "Text": " There has been no red team engagement in my knowledge where you're allowed to reside inside"
    },
    {
      "Time_Start": 251.88000000000002,
      "Time_End": 255.52,
      "Text": " an environment for 10 years, but real attackers do."
    },
    {
      "Time_Start": 255.52,
      "Time_End": 261.0,
      "Text": " There have been cases of technology companies, if you can guess what I'm talking about, who"
    },
    {
      "Time_Start": 261.0,
      "Time_End": 267.36,
      "Text": " were found for, let's say, for a decade and they don't know it."
    },
    {
      "Time_Start": 267.36,
      "Time_End": 275.28000000000003,
      "Text": " Because of this focus on stealth, many red teamers do not want to share their methods,"
    },
    {
      "Time_Start": 275.28000000000003,
      "Time_End": 279.36,
      "Text": " their technologies, their techniques with blue teams, which makes sense."
    },
    {
      "Time_Start": 279.36,
      "Time_End": 283.52000000000004,
      "Text": " Of course, even I don't share it with the clients unless it is specifically asked."
    },
    {
      "Time_Start": 283.52000000000004,
      "Time_End": 290.28000000000003,
      "Text": " That's something we spend weekends, nights to develop tools and things."
    },
    {
      "Time_Start": 290.28000000000003,
      "Time_End": 294.96000000000004,
      "Text": " Of course, if those are not open source, that's something which we develop."
    },
    {
      "Time_Start": 294.96000000000004,
      "Time_End": 296.36,
      "Text": " That's our intellectual property."
    },
    {
      "Time_Start": 296.36,
      "Time_End": 301.84000000000003,
      "Text": " Similarly, many blue teamers avoid discussing their detection methodologies, techniques"
    },
    {
      "Time_Start": 301.84000000000003,
      "Time_End": 302.84000000000003,
      "Text": " with red teams."
    },
    {
      "Time_Start": 302.84000000000003,
      "Time_End": 307.56000000000006,
      "Text": " Again, that makes sense as well."
    },
    {
      "Time_Start": 307.56000000000006,
      "Time_End": 311.16,
      "Text": " Traditional red teaming is adversarial in nature, once again."
    },
    {
      "Time_Start": 311.16,
      "Time_End": 314.8,
      "Text": " Red versus blue, a boxing match."
    },
    {
      "Time_Start": 314.8,
      "Time_End": 319.48,
      "Text": " The result may be a knockdown or after four rounds who won, the matrix is in the same"
    },
    {
      "Time_Start": 319.48,
      "Time_End": 320.48,
      "Text": " way."
    },
    {
      "Time_Start": 320.48,
      "Time_End": 327.32000000000005,
      "Text": " Also, this, which I added at the last moment in the slide, I've seen it a lot, I've faced"
    },
    {
      "Time_Start": 327.32000000000005,
      "Time_End": 329.88000000000005,
      "Text": " this problem myself as well."
    },
    {
      "Time_Start": 329.92,
      "Time_End": 335.68,
      "Text": " Red teamers generally do not have access to the enterprise-grade tools which blue teamers"
    },
    {
      "Time_Start": 335.68,
      "Time_End": 337.71999999999997,
      "Text": " have access to."
    },
    {
      "Time_Start": 337.71999999999997,
      "Time_End": 342.56,
      "Text": " Let's say a multimillion-dollar SIEM device, which may or may not be useful, depending"
    },
    {
      "Time_Start": 342.56,
      "Time_End": 349.4,
      "Text": " on how you configure it, but still having the ability to correlate events, things, it"
    },
    {
      "Time_Start": 349.4,
      "Time_End": 353.8,
      "Text": " may or may not be possible for a red teamer to have access to that."
    },
    {
      "Time_Start": 353.8,
      "Time_End": 359.6,
      "Text": " Specifically for a freelancer like me, I rely more on open source and maybe just some tools."
    },
    {
      "Time_Start": 360.32000000000005,
      "Time_End": 364.88,
      "Text": " In such cases, it is always advised if you can just make your red and blue team work"
    },
    {
      "Time_Start": 364.88,
      "Time_End": 365.88,
      "Text": " together."
    },
    {
      "Time_Start": 365.88,
      "Time_End": 371.40000000000003,
      "Text": " Now, what or how purple teaming can help in such a scenario?"
    },
    {
      "Time_Start": 371.40000000000003,
      "Time_End": 377.24,
      "Text": " Once again, there are different goals for a penetration test or a red teaming or a purple"
    },
    {
      "Time_Start": 377.24,
      "Time_End": 383.16,
      "Text": " teaming, so do not think of it as a Venn diagram intersecting somewhere."
    },
    {
      "Time_Start": 383.16,
      "Time_End": 385.36,
      "Text": " It is not at all that."
    },
    {
      "Time_Start": 385.36,
      "Time_End": 390.8,
      "Text": " The goals of all these exercises are completely different."
    },
    {
      "Time_Start": 390.8,
      "Time_End": 392.76,
      "Text": " So what is purple teaming?"
    },
    {
      "Time_Start": 392.76,
      "Time_End": 396.52000000000004,
      "Text": " It's not red versus blue, it's red and blue."
    },
    {
      "Time_Start": 396.52000000000004,
      "Time_End": 405.12,
      "Text": " So for me, I should admit that it's been just like a year or so when I started doing this"
    },
    {
      "Time_Start": 405.12,
      "Time_End": 406.12,
      "Text": " thing."
    },
    {
      "Time_Start": 406.12,
      "Time_End": 410.6,
      "Text": " There were presentations by, I think, I don't know if Chris Gates is here or not, he was"
    },
    {
      "Time_Start": 410.6,
      "Time_End": 414.16,
      "Text": " supposed to do a presentation with Mubix."
    },
    {
      "Time_Start": 414.16,
      "Time_End": 418.52000000000004,
      "Text": " So I saw that presentation, got queries from some of my clients."
    },
    {
      "Time_Start": 418.52000000000004,
      "Time_End": 424.36,
      "Text": " If you can do something like this, I tried it with a few clients, did like not more than"
    },
    {
      "Time_Start": 424.36,
      "Time_End": 427.04,
      "Text": " 10 engagements up to now for purple teaming."
    },
    {
      "Time_Start": 427.04,
      "Time_End": 436.08000000000004,
      "Text": " How I did that was sitting with the blue team, more of it in a training setup."
    },
    {
      "Time_Start": 436.08000000000004,
      "Time_End": 442.40000000000003,
      "Text": " Instead of using my lab access, which I use in my training classes, we use their live"
    },
    {
      "Time_Start": 442.40000000000003,
      "Time_End": 446.8,
      "Text": " network, of course, with the permission and all that, and do it in the training format."
    },
    {
      "Time_Start": 446.8,
      "Time_End": 451.8,
      "Text": " That is to work together to improve the security, not just to score points."
    },
    {
      "Time_Start": 451.8,
      "Time_End": 456.32000000000005,
      "Text": " The focus is on detection."
    },
    {
      "Time_Start": 456.32000000000005,
      "Time_End": 461.6,
      "Text": " That's what is the major difference between a red and a purple assessment is."
    },
    {
      "Time_Start": 461.6,
      "Time_End": 469.04,
      "Text": " You must get caught, and I directly quote Chris here, the focus is on assessing detection"
    },
    {
      "Time_Start": 469.04,
      "Time_End": 475.52000000000004,
      "Text": " and response mechanisms, that is getting caught, and training of red and blue teams."
    },
    {
      "Time_Start": 475.52000000000004,
      "Time_End": 480.08000000000004,
      "Text": " If you get caught, red team need to improve their tools and techniques."
    },
    {
      "Time_Start": 480.08000000000004,
      "Time_End": 487.76,
      "Text": " If you don't get caught, then blue team needs to improve their detection mechanisms."
    },
    {
      "Time_Start": 487.76,
      "Time_End": 490.70000000000005,
      "Text": " And why detection and prevention?"
    },
    {
      "Time_Start": 490.70000000000005,
      "Time_End": 492.72,
      "Text": " Because that's proactive."
    },
    {
      "Time_Start": 492.72,
      "Time_End": 498.56,
      "Text": " It's not something like you got hacked, and then you try to find out who was the attacker,"
    },
    {
      "Time_Start": 498.56,
      "Time_End": 503.92,
      "Text": " this was the CNC, or probably a nation actor or something like that."
    },
    {
      "Time_Start": 503.92,
      "Time_End": 506.96,
      "Text": " Try to do it before you got hacked."
    },
    {
      "Time_Start": 506.96,
      "Time_End": 512.8,
      "Text": " And later on, when we discuss the assume breach methodology, which is used by Microsoft's"
    },
    {
      "Time_Start": 512.8,
      "Time_End": 520.48,
      "Text": " cloud red team security, we will see that it is always better to assume that you are"
    },
    {
      "Time_Start": 520.48,
      "Time_End": 521.48,
      "Text": " already hacked."
    },
    {
      "Time_Start": 521.48,
      "Time_End": 528.48,
      "Text": " There is an adversary living in your environment, and in that case, purple teaming helps even"
    },
    {
      "Time_Start": 528.48,
      "Time_End": 530.36,
      "Text": " more."
    },
    {
      "Time_Start": 530.36,
      "Time_End": 535.32,
      "Text": " Once again, if attacks are successful, train blue team."
    },
    {
      "Time_Start": 535.32,
      "Time_End": 538.76,
      "Text": " If attacks fail, train red team."
    },
    {
      "Time_Start": 538.76,
      "Time_End": 541.52,
      "Text": " Improvement for both of us."
    },
    {
      "Time_Start": 541.52,
      "Time_End": 545.9200000000001,
      "Text": " Also red team gets to see the monitoring, detection, and response mechanisms."
    },
    {
      "Time_Start": 545.9200000000001,
      "Time_End": 553.16,
      "Text": " I never knew before doing a purple teaming environment that there is something like time-based"
    },
    {
      "Time_Start": 553.16,
      "Time_End": 560.0,
      "Text": " log correlation, wherein blue teams can actually create a complete timeline of my attack using"
    },
    {
      "Time_Start": 560.0,
      "Time_End": 561.0,
      "Text": " automated tools."
    },
    {
      "Time_Start": 561.0,
      "Time_End": 562.48,
      "Text": " Never knew that."
    },
    {
      "Time_Start": 562.48,
      "Time_End": 568.8399999999999,
      "Text": " Similarly, blue team gets to see how we can run, let's say, my clients."
    },
    {
      "Time_Start": 568.8399999999999,
      "Time_End": 573.68,
      "Text": " Always when I used to use PowerShell in my red team engagements, during my closure meetings,"
    },
    {
      "Time_Start": 573.68,
      "Time_End": 578.48,
      "Text": " my clients would always recommend blocking, let's say, PowerShell.exe."
    },
    {
      "Time_Start": 578.48,
      "Time_End": 582.48,
      "Text": " Of course, that doesn't help those of you who have used PowerShell in red team engagements"
    },
    {
      "Time_Start": 582.48,
      "Time_End": 585.52,
      "Text": " would know that blocking PowerShell.exe is not a solution at all."
    },
    {
      "Time_Start": 585.52,
      "Time_End": 588.16,
      "Text": " It's just a snake oil."
    },
    {
      "Time_Start": 588.16,
      "Time_End": 595.6,
      "Text": " So that my clients, blue teams, get to know with the help of my knowledge or what I know."
    },
    {
      "Time_Start": 595.6,
      "Time_End": 599.32,
      "Text": " Now, why PowerShell?"
    },
    {
      "Time_Start": 599.32,
      "Time_End": 604.9200000000001,
      "Text": " Of course, how many of you actually use PowerShell for red or blue?"
    },
    {
      "Time_Start": 604.9200000000001,
      "Time_End": 606.36,
      "Text": " Many."
    },
    {
      "Time_Start": 606.36,
      "Time_End": 607.36,
      "Text": " Not many still."
    },
    {
      "Time_Start": 607.36,
      "Time_End": 611.6800000000001,
      "Text": " Oh, I got a big hand over there."
    },
    {
      "Time_Start": 611.6800000000001,
      "Time_End": 618.0000000000001,
      "Text": " So PowerShell, because it is available by default in modern Windows operating system,"
    },
    {
      "Time_Start": 618.0000000000001,
      "Time_End": 626.5600000000001,
      "Text": " post-Windows Vista, in all Windows operating systems, 7, 8, 8.1, 10, 2008, 12, 16, in all"
    },
    {
      "Time_Start": 626.5600000000001,
      "Time_End": 632.0400000000001,
      "Text": " of these, even Windows IoT code, you will have PowerShell present."
    },
    {
      "Time_Start": 632.0400000000001,
      "Time_End": 634.36,
      "Text": " And that makes it really useful."
    },
    {
      "Time_Start": 634.36,
      "Time_End": 638.24,
      "Text": " With upgrade to PowerShell version 5, the detection capabilities have been enhanced"
    },
    {
      "Time_Start": 638.24,
      "Time_End": 639.48,
      "Text": " a lot."
    },
    {
      "Time_Start": 639.48,
      "Time_End": 643.76,
      "Text": " It provides you access to WMI, Windows API."
    },
    {
      "Time_Start": 643.76,
      "Time_End": 646.9200000000001,
      "Text": " So WMI is an alternate object system."
    },
    {
      "Time_Start": 646.9200000000001,
      "Time_End": 649.6,
      "Text": " It still provides you access to that com objects."
    },
    {
      "Time_Start": 649.6,
      "Time_End": 658.32,
      "Text": " So if you are really up to date with the latest threat vectors, you may like to see talks"
    },
    {
      "Time_Start": 658.32,
      "Time_End": 664.2,
      "Text": " by, let's say, Casey, Casey Smith, who works a lot on com objects."
    },
    {
      "Time_Start": 664.2,
      "Time_End": 669.6400000000001,
      "Text": " And that dude basically tweets a whitelisting bypass every second minute."
    },
    {
      "Time_Start": 669.6400000000001,
      "Time_End": 674.6400000000001,
      "Text": " So PowerShell, once again, PowerShell provides access not only to these things, to registry,"
    },
    {
      "Time_Start": 674.6400000000001,
      "Time_End": 676.2,
      "Text": " other boxes on the network."
    },
    {
      "Time_Start": 676.2,
      "Time_End": 680.84,
      "Text": " PowerShell remoting provides you the ability to interact with other boxes on the network"
    },
    {
      "Time_Start": 680.84,
      "Time_End": 683.48,
      "Text": " if you have administrative credentials."
    },
    {
      "Time_Start": 683.48,
      "Time_End": 689.0,
      "Text": " It is based on .NET framework, which means you can extend its capability if something"
    },
    {
      "Time_Start": 689.0,
      "Time_End": 693.6800000000001,
      "Text": " is not available in PowerShell by default."
    },
    {
      "Time_Start": 693.6800000000001,
      "Time_End": 696.44,
      "Text": " So why red team would use PowerShell?"
    },
    {
      "Time_Start": 696.44,
      "Time_End": 702.32,
      "Text": " Those of who you do red teaming or even penetration testing and are not using this."
    },
    {
      "Time_Start": 702.32,
      "Time_End": 707.6800000000001,
      "Text": " Ability to execute attacks without touching disk, and that is something which is built"
    },
    {
      "Time_Start": 707.6800000000001,
      "Time_End": 710.08,
      "Text": " in PowerShell, sounds really easy to do."
    },
    {
      "Time_Start": 710.08,
      "Time_End": 716.8800000000001,
      "Text": " It's hard to do without having tools like PowerShell at your disposal."
    },
    {
      "Time_Start": 716.88,
      "Time_End": 724.24,
      "Text": " Object-based attacks, that means if you use PowerShell scripts, specifically not the frameworks"
    },
    {
      "Time_Start": 724.24,
      "Time_End": 728.08,
      "Text": " and single scripts, the chances of detection are really low."
    },
    {
      "Time_Start": 728.08,
      "Time_End": 733.4,
      "Text": " It is this easy to change signature for your script and you can avoid detection for a really"
    },
    {
      "Time_Start": 733.4,
      "Time_End": 734.4,
      "Text": " long time."
    },
    {
      "Time_Start": 734.4,
      "Time_End": 736.88,
      "Text": " Plenty of open source attack tools."
    },
    {
      "Time_Start": 736.88,
      "Time_End": 741.16,
      "Text": " This is the hard thing when it comes to attackers."
    },
    {
      "Time_Start": 741.16,
      "Time_End": 748.9599999999999,
      "Text": " You may need not write anything, if you just maybe look up on the internet for something,"
    },
    {
      "Time_Start": 748.9599999999999,
      "Time_End": 754.4,
      "Text": " if it can be done with the help of PowerShell, something nasty, something for offensive security,"
    },
    {
      "Time_Start": 754.4,
      "Time_End": 759.8399999999999,
      "Text": " there may be already a script or framework which has that thing."
    },
    {
      "Time_Start": 759.8399999999999,
      "Time_End": 765.1999999999999,
      "Text": " And capability to avoid or bypass detection mechanisms, I think we will have a look at"
    },
    {
      "Time_Start": 765.1999999999999,
      "Time_End": 769.54,
      "Text": " this thing live."
    },
    {
      "Time_Start": 769.54,
      "Time_End": 771.98,
      "Text": " Why would Blue Team use it?"
    },
    {
      "Time_Start": 771.98,
      "Time_End": 779.5,
      "Text": " Once again, ability to exit monitoring and detection scripts without installing agents."
    },
    {
      "Time_Start": 779.5,
      "Time_End": 784.2199999999999,
      "Text": " Agent installation is something which creeps up whenever you discuss detection mechanisms."
    },
    {
      "Time_Start": 784.2199999999999,
      "Time_End": 790.5,
      "Text": " With the fabulous performance of many antivirus vendors to get owned while running a system"
    },
    {
      "Time_Start": 790.5,
      "Time_End": 796.66,
      "Text": " on different boxes with the data protection mechanisms getting owned with their agents,"
    },
    {
      "Time_Start": 796.66,
      "Time_End": 801.98,
      "Text": " agent installation is something which always comes up when we discuss defense mechanisms"
    },
    {
      "Time_Start": 801.98,
      "Time_End": 805.62,
      "Text": " or techniques."
    },
    {
      "Time_Start": 805.62,
      "Time_End": 811.2199999999999,
      "Text": " The ability to run agentless detection mechanisms with the help of anyone?"
    },
    {
      "Time_Start": 811.2199999999999,
      "Time_End": 813.38,
      "Text": " WMI maybe?"
    },
    {
      "Time_Start": 813.38,
      "Time_End": 818.5799999999999,
      "Text": " You can easily access WMI with PowerShell with just four commandlets."
    },
    {
      "Time_Start": 818.5799999999999,
      "Time_End": 826.62,
      "Text": " And the ability to use that WMI stuff for agentless detection mechanisms takes PowerShell,"
    },
    {
      "Time_Start": 827.22,
      "Time_End": 830.86,
      "Text": " really, really useful when it comes to Blue Teams."
    },
    {
      "Time_Start": 830.86,
      "Time_End": 835.86,
      "Text": " I think it's not in the slides, but tools like from the guys from Mandiate, WMI-IDS,"
    },
    {
      "Time_Start": 835.86,
      "Time_End": 842.86,
      "Text": " an intuition detection system, not tried it yet, I don't know if it works in a production"
    },
    {
      "Time_Start": 844.38,
      "Time_End": 851.38,
      "Text": " environment or not, but a tool like WMI-IDS based completely on WMI with agentless detection"
    },
    {
      "Time_Start": 852.38,
      "Time_End": 856.66,
      "Text": " mechanisms, that could be really, really helpful for Blue Teams."
    },
    {
      "Time_Start": 856.66,
      "Time_End": 863.66,
      "Text": " Not only that, if you've ever used PowerShell remoting, let's say for lateral movement,"
    },
    {
      "Time_Start": 864.06,
      "Time_End": 868.82,
      "Text": " things like invoke command, which is a commandlet in PowerShell to execute stuff on different"
    },
    {
      "Time_Start": 868.82,
      "Time_End": 872.9399999999999,
      "Text": " boxes, that allows you to scale."
    },
    {
      "Time_Start": 872.9399999999999,
      "Time_End": 878.78,
      "Text": " So a thing about invoke command, that commandlet allows you to execute scripts and commands"
    },
    {
      "Time_Start": 878.78,
      "Time_End": 882.9399999999999,
      "Text": " on, let's say, 10,000 boxes parallelly, that's a built-in feature."
    },
    {
      "Time_Start": 882.9399999999999,
      "Time_End": 886.3,
      "Text": " Why that is not useful for a Blue Team guy?"
    },
    {
      "Time_Start": 886.3,
      "Time_End": 891.8199999999999,
      "Text": " Of course it is, I mean you can run your detection scripts, schedule a job, a partial job maybe"
    },
    {
      "Time_Start": 891.8199999999999,
      "Time_End": 898.54,
      "Text": " on your domain controller somewhere, run a simple detection script or a baselining script"
    },
    {
      "Time_Start": 898.54,
      "Time_End": 904.06,
      "Text": " every half an hour, hour and hour on all of your boxes parallelly without having really"
    },
    {
      "Time_Start": 904.06,
      "Time_End": 908.5799999999999,
      "Text": " any overhead on the performance."
    },
    {
      "Time_Start": 908.82,
      "Time_End": 913.62,
      "Text": " Another thing which I would like to mention here is, which I started with actually, blocking"
    },
    {
      "Time_Start": 913.62,
      "Time_End": 917.14,
      "Text": " PowerShell.exe."
    },
    {
      "Time_Start": 917.14,
      "Time_End": 923.5,
      "Text": " I have been into meetings or closure meetings, discussions, et cetera, where PowerShell.exe"
    },
    {
      "Time_Start": 923.5,
      "Time_End": 929.14,
      "Text": " is considered, or PowerShell itself is considered the evil, something which has been unleashed"
    },
    {
      "Time_Start": 929.14,
      "Time_End": 932.62,
      "Text": " on the world and it will consume it all."
    },
    {
      "Time_Start": 932.62,
      "Time_End": 934.34,
      "Text": " It's not that thing."
    },
    {
      "Time_Start": 934.34,
      "Time_End": 940.5400000000001,
      "Text": " In fact, as a Red Teamer who has been doing these things for the past nine years, I can"
    },
    {
      "Time_Start": 940.5400000000001,
      "Time_End": 946.7800000000001,
      "Text": " assure you that, I can bet my life on it, if you have PowerShell version 5 installed"
    },
    {
      "Time_Start": 946.7800000000001,
      "Time_End": 953.34,
      "Text": " on your boxes, the chances of detection of an attacker on your box increases multifold."
    },
    {
      "Time_Start": 953.34,
      "Time_End": 959.58,
      "Text": " It is really, really, really hard not to leave a trace if you have PowerShell version 5 installed"
    },
    {
      "Time_Start": 959.58,
      "Time_End": 964.1600000000001,
      "Text": " with its enhanced logging capabilities, and of course if you are managing your logs perfectly"
    },
    {
      "Time_Start": 964.16,
      "Time_End": 970.0,
      "Text": " as discussed in the last talk, you are forwarding things to a central log system monitoring"
    },
    {
      "Time_Start": 970.0,
      "Time_End": 971.0,
      "Text": " things."
    },
    {
      "Time_Start": 971.0,
      "Time_End": 976.6,
      "Text": " Of course, if no one is monitoring the logs, logging anything is useless."
    },
    {
      "Time_Start": 976.6,
      "Time_End": 981.1999999999999,
      "Text": " So if you have PowerShell version 5 installed, enhanced logging capabilities like system-wide"
    },
    {
      "Time_Start": 981.1999999999999,
      "Time_End": 988.6,
      "Text": " transcripts, suspicious script block logging, couple that with the elephant in the room"
    },
    {
      "Time_Start": 988.88,
      "Time_End": 995.08,
      "Text": " which no one wants to address, process creation, logs, if you have all these three things set"
    },
    {
      "Time_Start": 995.08,
      "Time_End": 998.5600000000001,
      "Text": " up, it's really, really hard not to leave a trace."
    },
    {
      "Time_Start": 998.5600000000001,
      "Time_End": 1001.0400000000001,
      "Text": " Any attacker will leave a trace somewhere."
    },
    {
      "Time_Start": 1001.0400000000001,
      "Time_End": 1006.64,
      "Text": " Of course, if you still find ways to silently do things after this, that's what Purple Timing"
    },
    {
      "Time_Start": 1006.64,
      "Time_End": 1011.48,
      "Text": " is for, come up with new ways of detection."
    },
    {
      "Time_Start": 1011.48,
      "Time_End": 1016.12,
      "Text": " Then there are plenty of open source detection and response tools when it comes to Blue Team"
    },
    {
      "Time_Start": 1016.12,
      "Time_End": 1021.36,
      "Text": " as well, some of which I can quote at the top of my head."
    },
    {
      "Time_Start": 1021.36,
      "Time_End": 1029.64,
      "Text": " Kansa, it's an IR incident response framework, PoshSec, PowerForensics, InvokeIR, all these"
    },
    {
      "Time_Start": 1029.64,
      "Time_End": 1034.64,
      "Text": " are open source PowerShell tools which you can use for incident response, baselining,"
    },
    {
      "Time_Start": 1034.64,
      "Time_End": 1037.08,
      "Text": " auditing, and whatnot."
    },
    {
      "Time_Start": 1037.08,
      "Time_End": 1044.68,
      "Text": " Also, if you are specifically threatened by PowerShell, the name PowerShell itself, then"
    },
    {
      "Time_Start": 1044.68,
      "Time_End": 1054.72,
      "Text": " you have the capability to really run PowerShell in a constraint mode, maybe try application-wide"
    },
    {
      "Time_Start": 1054.72,
      "Time_End": 1055.72,
      "Text": " listing."
    },
    {
      "Time_Start": 1055.72,
      "Time_End": 1061.1200000000001,
      "Text": " It can, of course, be bypassed, but at least it adds a cost to the attacker."
    },
    {
      "Time_Start": 1061.1200000000001,
      "Time_End": 1064.72,
      "Text": " So that's what Red and Blue should use, or they use PowerShell."
    },
    {
      "Time_Start": 1064.72,
      "Time_End": 1067.96,
      "Text": " Why should Purple use it, or a Purple Team?"
    },
    {
      "Time_Start": 1067.96,
      "Time_End": 1072.76,
      "Text": " The ability to demonstrate and detect real attacks, as we will see, and as at least I"
    },
    {
      "Time_Start": 1072.84,
      "Time_End": 1077.32,
      "Text": " have been doing, I do Purple Teaming engagements in a training format."
    },
    {
      "Time_Start": 1077.32,
      "Time_End": 1087.76,
      "Text": " So PowerShell allows me to detect, not only execute attacks, but detect them in real time."
    },
    {
      "Time_Start": 1087.76,
      "Time_End": 1093.6,
      "Text": " And also not only on a single box or on 100 boxes, using, let's say, PowerShell remoting"
    },
    {
      "Time_Start": 1093.6,
      "Time_End": 1099.32,
      "Text": " or the capabilities which come up with WMI, maybe on 10,000 boxes at a time."
    },
    {
      "Time_Start": 1099.32,
      "Time_End": 1105.56,
      "Text": " Once again, plenty of open source attack, detection, and response tools and techniques"
    },
    {
      "Time_Start": 1105.56,
      "Time_End": 1106.56,
      "Text": " available."
    },
    {
      "Time_Start": 1106.56,
      "Time_End": 1110.8799999999999,
      "Text": " So I think that would be enough of theory."
    },
    {
      "Time_Start": 1110.8799999999999,
      "Time_End": 1117.08,
      "Text": " What's the first story, or what's the first attack which we are going to have a look at?"
    },
    {
      "Time_Start": 1117.08,
      "Time_End": 1126.96,
      "Text": " We'll start as a normal non-local admin domain user, that is a normal domain user with no"
    },
    {
      "Time_Start": 1126.96,
      "Time_End": 1129.44,
      "Text": " local admin rights."
    },
    {
      "Time_Start": 1129.44,
      "Time_End": 1133.68,
      "Text": " Look for a local admin access, so pretty much run-of-the-mill user hunting."
    },
    {
      "Time_Start": 1133.68,
      "Time_End": 1135.08,
      "Text": " Look for a DA token."
    },
    {
      "Time_Start": 1135.08,
      "Time_End": 1141.8400000000001,
      "Text": " Once we find a DA token, use that, escalate privileges, create maybe a golden ticket,"
    },
    {
      "Time_Start": 1141.8400000000001,
      "Time_End": 1147.68,
      "Text": " use that golden ticket later on, and exfiltrate interesting stuff."
    },
    {
      "Time_Start": 1147.68,
      "Time_End": 1158.4,
      "Text": " If we start with a domain user access, is that something which we are making up?"
    },
    {
      "Time_Start": 1158.4,
      "Time_End": 1159.92,
      "Text": " Nope."
    },
    {
      "Time_Start": 1159.92,
      "Time_End": 1165.24,
      "Text": " I would like you to read this Cloud Red Teaming paper from Microsoft."
    },
    {
      "Time_Start": 1165.24,
      "Time_End": 1170.28,
      "Text": " Very, very good if you are into Red Teaming at all."
    },
    {
      "Time_Start": 1170.28,
      "Time_End": 1174.2,
      "Text": " It details the assumed breach methodology."
    },
    {
      "Time_Start": 1174.2,
      "Time_End": 1179.0,
      "Text": " And this line, I think, sums up, it is more likely that an organization has already been"
    },
    {
      "Time_Start": 1179.0,
      "Time_End": 1185.2,
      "Text": " compromised, and I'm quoting the paper here, but just hasn't discovered it yet."
    },
    {
      "Time_Start": 1185.2,
      "Time_End": 1189.68,
      "Text": " And that is actually a nice thing to begin with."
    },
    {
      "Time_Start": 1189.68,
      "Time_End": 1194.92,
      "Text": " Three things which we are going to talk about shortly, of course, because there's not enough"
    },
    {
      "Time_Start": 1194.92,
      "Time_End": 1202.44,
      "Text": " time, I believe, Red Teaming, Insider Threat Simulation, and Blue Teaming in the talk."
    },
    {
      "Time_Start": 1202.44,
      "Time_End": 1208.24,
      "Text": " When we talk about Insider Threat Simulation, of course, an insider would, at some point,"
    },
    {
      "Time_Start": 1208.24,
      "Time_End": 1213.8400000000001,
      "Text": " would have at least normal domain user privileges so that they can log into a box and do their"
    },
    {
      "Time_Start": 1213.8400000000001,
      "Time_End": 1215.76,
      "Text": " stuff, whatever they want to."
    },
    {
      "Time_Start": 1215.76,
      "Time_End": 1217.3600000000001,
      "Text": " So we'll start with that."
    },
    {
      "Time_Start": 1217.3600000000001,
      "Time_End": 1220.0800000000002,
      "Text": " Not discussing assumed breach anymore."
    },
    {
      "Time_Start": 1220.0800000000002,
      "Time_End": 1223.4,
      "Text": " So we will look for local admin access."
    },
    {
      "Time_Start": 1223.4,
      "Time_End": 1226.6000000000001,
      "Text": " So we already have normal domain user access."
    },
    {
      "Time_Start": 1226.6000000000001,
      "Time_End": 1227.92,
      "Text": " Do you think it's really easy?"
    },
    {
      "Time_Start": 1227.92,
      "Time_End": 1228.92,
      "Text": " Too easy?"
    },
    {
      "Time_Start": 1228.92,
      "Time_End": 1234.5600000000002,
      "Text": " Do you genuinely think that having normal domain user access makes it too easy?"
    },
    {
      "Time_Start": 1234.5600000000002,
      "Time_End": 1237.5600000000002,
      "Text": " If you think that, go back to the previous talk."
    },
    {
      "Time_Start": 1237.5600000000002,
      "Time_End": 1239.64,
      "Text": " See where it was a very interesting talk."
    },
    {
      "Time_Start": 1239.64,
      "Time_End": 1245.64,
      "Text": " See how you can get that, or maybe, for example, I always like to quote this example."
    },
    {
      "Time_Start": 1245.64,
      "Time_End": 1253.68,
      "Text": " I did a Red Teaming six years back, maybe, for a German oncology back there in New Delhi."
    },
    {
      "Time_Start": 1253.68,
      "Time_End": 1256.76,
      "Text": " And I used to work for a company, and right now I'm independent."
    },
    {
      "Time_Start": 1256.76,
      "Time_End": 1259.0,
      "Text": " I used to work for a company at that time."
    },
    {
      "Time_Start": 1259.0,
      "Time_End": 1263.68,
      "Text": " And we were made to sit inside a conference room without any network port at all."
    },
    {
      "Time_Start": 1263.68,
      "Time_End": 1270.36,
      "Text": " So it was a long engagement, two or three months, but still, without network access,"
    },
    {
      "Time_Start": 1270.36,
      "Time_End": 1271.36,
      "Text": " I mean, you cannot."
    },
    {
      "Time_Start": 1271.36,
      "Time_End": 1275.6,
      "Text": " There was no Wi-Fi, only cable network."
    },
    {
      "Time_Start": 1275.6,
      "Time_End": 1281.3799999999999,
      "Text": " And we were supposed to break into that company without any network access."
    },
    {
      "Time_Start": 1281.3799999999999,
      "Time_End": 1285.2,
      "Text": " And at that time, I got started with this human interface device thing."
    },
    {
      "Time_Start": 1285.2,
      "Time_End": 1290.3600000000001,
      "Text": " You can program devices, throw them into parking lot, maybe leave at reception, cafeteria,"
    },
    {
      "Time_Start": 1290.3600000000001,
      "Time_End": 1294.72,
      "Text": " mail them to employees."
    },
    {
      "Time_Start": 1294.72,
      "Time_End": 1296.0,
      "Text": " There will be connections."
    },
    {
      "Time_Start": 1296.0,
      "Time_End": 1299.48,
      "Text": " And that's how I actually got into that environment."
    },
    {
      "Time_Start": 1299.48,
      "Time_End": 1307.28,
      "Text": " So that's another example of getting a normal domain user access."
    },
    {
      "Time_Start": 1307.28,
      "Time_End": 1309.06,
      "Text": " Client-side attacks, maybe."
    },
    {
      "Time_Start": 1309.06,
      "Time_End": 1313.16,
      "Text": " People just love to open attachments which strangers from the internet send them."
    },
    {
      "Time_Start": 1313.16,
      "Time_End": 1317.0,
      "Text": " So maybe try that as well."
    },
    {
      "Time_Start": 1317.0,
      "Time_End": 1322.68,
      "Text": " With all that, we can safely assume that we have a normal domain user level access."
    },
    {
      "Time_Start": 1322.68,
      "Time_End": 1328.0800000000002,
      "Text": " Now what our next step is to hunt for local admin or escalate our privileges locally."
    },
    {
      "Time_Start": 1328.0800000000002,
      "Time_End": 1334.28,
      "Text": " Now when it comes to a domain environment, the most interesting thing is it's a shitbox."
    },
    {
      "Time_Start": 1334.28,
      "Time_End": 1339.28,
      "Text": " You really don't know where you may have a local admin privilege or the user."
    },
    {
      "Time_Start": 1339.28,
      "Time_End": 1345.0,
      "Text": " Let's say you get this normal domain user access with a client-side attack."
    },
    {
      "Time_Start": 1345.0,
      "Time_End": 1351.08,
      "Text": " It is always possible that the user is not a local admin on the current box."
    },
    {
      "Time_Start": 1351.08,
      "Time_End": 1358.76,
      "Text": " But if it's a reasonably big domain, let's say even more than 1K boxes, there are chances"
    },
    {
      "Time_Start": 1358.76,
      "Time_End": 1364.36,
      "Text": " that there would be some box lying in the domain where that user would be a local admin."
    },
    {
      "Time_Start": 1364.36,
      "Time_End": 1367.0,
      "Text": " If not, you may try local privilege escalation as well."
    },
    {
      "Time_Start": 1367.0,
      "Time_End": 1373.36,
      "Text": " There are always services ready to be hijacked."
    },
    {
      "Time_Start": 1373.36,
      "Time_End": 1375.4,
      "Text": " How would you do that?"
    },
    {
      "Time_Start": 1375.4,
      "Time_End": 1382.08,
      "Text": " Of course, PowerView, the tool which made it possible for everyone to do user hunting."
    },
    {
      "Time_Start": 1382.08,
      "Time_End": 1388.04,
      "Text": " We are going to use PowerView, of course written in PowerShell, to find access, find local"
    },
    {
      "Time_Start": 1388.04,
      "Time_End": 1393.2,
      "Text": " admin access on one of the boxes in our domain."
    },
    {
      "Time_Start": 1393.2,
      "Time_End": 1403.96,
      "Text": " So this is the box which we are going to use for different attacks."
    },
    {
      "Time_Start": 1403.96,
      "Time_End": 1411.0800000000002,
      "Text": " And what I'm going to do here, I'm going to load, is this visible?"
    },
    {
      "Time_Start": 1411.0800000000002,
      "Time_End": 1413.64,
      "Text": " Yeah, thank you."
    },
    {
      "Time_Start": 1413.64,
      "Time_End": 1427.72,
      "Text": " Now we are going to run, find, oops, let's run it with verbosity."
    },
    {
      "Time_Start": 1427.72,
      "Time_End": 1432.48,
      "Text": " I've been using the same lab for my training for the past few days, so those of my students"
    },
    {
      "Time_Start": 1432.48,
      "Time_End": 1438.4,
      "Text": " sitting here will identify some of the boxes."
    },
    {
      "Time_Start": 1438.4,
      "Time_End": 1445.16,
      "Text": " So we have actually local admin access on a number of boxes."
    },
    {
      "Time_Start": 1445.16,
      "Time_End": 1452.3600000000001,
      "Text": " That's fine, but please note one thing here, that the script identified that there are"
    },
    {
      "Time_Start": 1452.3600000000001,
      "Time_End": 1457.8400000000001,
      "Text": " a total number of 43 boxes in the domain, and then it approached each and every one"
    },
    {
      "Time_Start": 1457.8400000000001,
      "Time_End": 1458.8400000000001,
      "Text": " box."
    },
    {
      "Time_Start": 1458.8400000000001,
      "Time_End": 1463.72,
      "Text": " Don't you think that that is something really nice, makes some logs probably?"
    },
    {
      "Time_Start": 1463.72,
      "Time_End": 1466.92,
      "Text": " So we'll come back to that."
    },
    {
      "Time_Start": 1466.92,
      "Time_End": 1476.5600000000002,
      "Text": " But now the box I'm interested in is this one, although the attack is quite scripted,"
    },
    {
      "Time_Start": 1476.5600000000002,
      "Time_End": 1482.76,
      "Text": " but many times the name of the box, the NetBIOS name of the box is enough to tell you interesting"
    },
    {
      "Time_Start": 1482.76,
      "Time_End": 1485.3600000000001,
      "Text": " things."
    },
    {
      "Time_Start": 1485.3600000000001,
      "Time_End": 1492.4,
      "Text": " So once we have identified a box, we may have local admin access."
    },
    {
      "Time_Start": 1492.4,
      "Time_End": 1497.48,
      "Text": " Let's see what kind of logs are activity generated."
    },
    {
      "Time_Start": 1497.48,
      "Time_End": 1503.72,
      "Text": " On all the boxes where it was not successful, you will see event 4624, a successful logon,"
    },
    {
      "Time_Start": 1503.72,
      "Time_End": 1510.88,
      "Text": " and 4634 logoff from the user on this box, which is lab user."
    },
    {
      "Time_Start": 1510.88,
      "Time_End": 1517.6000000000001,
      "Text": " So in case someone runs this, reads up it on the internet, so this is how many times"
    },
    {
      "Time_Start": 1517.6000000000001,
      "Time_End": 1522.4800000000002,
      "Text": " people do the stuff, their Metasploit payloads are getting detected, they move quickly to"
    },
    {
      "Time_Start": 1522.4800000000002,
      "Time_End": 1529.2800000000002,
      "Text": " PowerShell, found out that PowerView is awesome for user hunting, ran fine local admin access,"
    },
    {
      "Time_Start": 1529.2800000000002,
      "Time_End": 1534.8400000000001,
      "Text": " and the user ID, these logs, if you have seen it, I'm quite sure many of you have, they"
    },
    {
      "Time_Start": 1534.8400000000001,
      "Time_End": 1536.8000000000002,
      "Text": " do log a user ID."
    },
    {
      "Time_Start": 1536.8000000000002,
      "Time_End": 1543.8000000000002,
      "Text": " So maybe on 1,000 boxes of your domain, you will have these two events, 4624 and 34, from"
    },
    {
      "Time_Start": 1543.8000000000002,
      "Time_End": 1546.4800000000002,
      "Text": " a particular username."
    },
    {
      "Time_Start": 1546.48,
      "Time_End": 1547.48,
      "Text": " That's a dead giveaway."
    },
    {
      "Time_Start": 1547.48,
      "Time_End": 1552.46,
      "Text": " I mean, if you cannot, you should develop the capability to detect that."
    },
    {
      "Time_Start": 1552.46,
      "Time_End": 1557.84,
      "Text": " In cases of successful logon, because we are looking for local admin access, in cases of"
    },
    {
      "Time_Start": 1557.84,
      "Time_End": 1565.48,
      "Text": " success, there would be event 4672, admin logon on those boxes where this user is a"
    },
    {
      "Time_Start": 1565.48,
      "Time_End": 1566.74,
      "Text": " local admin."
    },
    {
      "Time_Start": 1566.74,
      "Time_End": 1568.24,
      "Text": " And how can you read it with PowerShell?"
    },
    {
      "Time_Start": 1568.24,
      "Time_End": 1573.9,
      "Text": " I mean, there are so many tools written in PowerShell which can do it easily for you,"
    },
    {
      "Time_Start": 1573.9,
      "Time_End": 1581.38,
      "Text": " but if you just want simple one-line PowerShell command, then you can do this to list the"
    },
    {
      "Time_Start": 1581.38,
      "Time_End": 1589.2,
      "Text": " latest event, let's say, related to event ID 4672 from the security log of the box."
    },
    {
      "Time_Start": 1589.2,
      "Time_End": 1591.16,
      "Text": " How would you do it on scale?"
    },
    {
      "Time_Start": 1591.16,
      "Time_End": 1596.46,
      "Text": " Maybe use PowerShell remoting, use invoke command, the script block, pass to it the"
    },
    {
      "Time_Start": 1596.46,
      "Time_End": 1601.8600000000001,
      "Text": " list of servers you want to run it on, and it would do it parallelly on those n number"
    },
    {
      "Time_Start": 1601.8600000000001,
      "Time_End": 1602.8600000000001,
      "Text": " of boxes."
    },
    {
      "Time_Start": 1603.38,
      "Time_End": 1609.14,
      "Text": " You can also, for example, if you have all the organizations do have older boxes which"
    },
    {
      "Time_Start": 1609.14,
      "Time_End": 1615.2600000000002,
      "Text": " are there for backward compatibility, XP 2003 or even earlier, then you can use WMI classes,"
    },
    {
      "Time_Start": 1615.2600000000002,
      "Time_End": 1620.1000000000001,
      "Text": " these ones, to do the same thing once again using PowerShell."
    },
    {
      "Time_Start": 1620.1000000000001,
      "Time_End": 1627.7400000000002,
      "Text": " Just because I mentioned it, even if you run WMI queries from a PowerShell instance on"
    },
    {
      "Time_Start": 1627.7400000000002,
      "Time_End": 1632.7,
      "Text": " your box, PowerShell need not be installed on the remote box."
    },
    {
      "Time_Start": 1632.7,
      "Time_End": 1637.38,
      "Text": " It's just plain WMI if you use WMI."
    },
    {
      "Time_Start": 1637.38,
      "Time_End": 1646.02,
      "Text": " So once we identify that we have local admin access, we can use something like this."
    },
    {
      "Time_Start": 1646.02,
      "Time_End": 1656.3400000000001,
      "Text": " The box was OPS-Terminal-SER, let's run, enter PS session, which provides you a one-to-one"
    },
    {
      "Time_Start": 1656.3400000000001,
      "Time_End": 1667.1200000000001,
      "Text": " PowerShell remoting session with the box running PowerShell remoting."
    },
    {
      "Time_Start": 1667.1200000000001,
      "Time_End": 1674.5400000000002,
      "Text": " So if you see here, you are still lab user, but on a different box now."
    },
    {
      "Time_Start": 1674.5400000000002,
      "Time_End": 1675.5400000000002,
      "Text": " It's that simple."
    },
    {
      "Time_Start": 1675.5400000000002,
      "Time_End": 1680.1000000000001,
      "Text": " Once you have, please keep in mind that we need administrative privileges by default"
    },
    {
      "Time_Start": 1680.1000000000001,
      "Time_End": 1684.5000000000002,
      "Text": " to do that."
    },
    {
      "Time_Start": 1684.66,
      "Time_End": 1689.66,
      "Text": " So once this is done, then we are going to use, once it is confirmed that yes, we indeed"
    },
    {
      "Time_Start": 1689.66,
      "Time_End": 1696.22,
      "Text": " have administrative access, the next step is to get some credentials which provides"
    },
    {
      "Time_Start": 1696.22,
      "Time_End": 1698.86,
      "Text": " us interesting things."
    },
    {
      "Time_Start": 1698.86,
      "Time_End": 1700.52,
      "Text": " And we'll use Mimikatz for that."
    },
    {
      "Time_Start": 1700.52,
      "Time_End": 1706.78,
      "Text": " So I always say that there, if we talk about at least threat landscape when it comes to"
    },
    {
      "Time_Start": 1706.78,
      "Time_End": 1710.98,
      "Text": " red teamers or red team techniques, there are two eras."
    },
    {
      "Time_Start": 1710.98,
      "Time_End": 1714.58,
      "Text": " One was before Mimikatz and one is after Mimikatz."
    },
    {
      "Time_Start": 1714.58,
      "Time_End": 1720.78,
      "Text": " So no engagement, at least for me, no engagement at some point of time, waiting one or two"
    },
    {
      "Time_Start": 1720.78,
      "Time_End": 1725.3,
      "Text": " is where I use Mimikatz and not actually for pulling credentials in clear text."
    },
    {
      "Time_Start": 1725.3,
      "Time_End": 1727.42,
      "Text": " That's so 2012."
    },
    {
      "Time_Start": 1727.42,
      "Time_End": 1734.06,
      "Text": " It's been useful for many more things now."
    },
    {
      "Time_Start": 1734.06,
      "Time_End": 1741.4199999999998,
      "Text": " So let's run Mimikatz onto the target box."
    },
    {
      "Time_Start": 1741.4199999999998,
      "Time_End": 1746.74,
      "Text": " And here you can see the interesting thing is not the ability to run Mimikatz on a target"
    },
    {
      "Time_Start": 1746.74,
      "Time_End": 1747.74,
      "Text": " box."
    },
    {
      "Time_Start": 1747.74,
      "Time_End": 1752.36,
      "Text": " The interesting thing here is we're using PowerShell remoting, Mimikatz, invoke Mimikatz"
    },
    {
      "Time_Start": 1752.36,
      "Time_End": 1755.1,
      "Text": " uses PowerShell remoting in the background."
    },
    {
      "Time_Start": 1755.1,
      "Time_End": 1759.46,
      "Text": " That means if you have process creation logs, you're collecting process creation logs on"
    },
    {
      "Time_Start": 1759.46,
      "Time_End": 1766.74,
      "Text": " the target box, you will see WS improv host, the service or the executable which PowerShell"
    },
    {
      "Time_Start": 1766.74,
      "Time_End": 1770.3400000000001,
      "Text": " remoting uses and not PowerShell.exe at all."
    },
    {
      "Time_Start": 1770.3400000000001,
      "Time_End": 1779.98,
      "Text": " So let's have a look at that."
    },
    {
      "Time_Start": 1779.98,
      "Time_End": 1794.1,
      "Text": " If we go to this box and try to see logs for process creation, let's see what we can see."
    },
    {
      "Time_Start": 1794.1000000000001,
      "Time_End": 1807.9,
      "Text": " The security logs would be something like this or WS improv"
    },
    {
      "Time_Start": 1807.9,
      "Time_End": 1816.5400000000002,
      "Text": " host not PowerShell.exe."
    },
    {
      "Time_Start": 1816.5400000000002,
      "Time_End": 1822.2600000000002,
      "Text": " What actually helps here is or maybe I'll come back to it in a moment."
    },
    {
      "Time_Start": 1822.26,
      "Time_End": 1824.22,
      "Text": " Here's something which helps here."
    },
    {
      "Time_Start": 1824.22,
      "Time_End": 1827.9,
      "Text": " Do not get disheartened."
    },
    {
      "Time_Start": 1827.9,
      "Time_End": 1834.3,
      "Text": " So unless you have PowerShell version 5 and enhanced logging capabilities, there would"
    },
    {
      "Time_Start": 1834.3,
      "Time_End": 1836.1,
      "Text": " be actually no really interesting logs."
    },
    {
      "Time_Start": 1836.1,
      "Time_End": 1841.86,
      "Text": " As you can see, even with process creation logs with command line auditing enabled."
    },
    {
      "Time_Start": 1841.86,
      "Time_End": 1847.74,
      "Text": " What we need here is things like system-wide transcripts, script block logging."
    },
    {
      "Time_Start": 1847.74,
      "Time_End": 1855.1,
      "Text": " Because the reality of today's threat landscape is you have so many script-based tools out"
    },
    {
      "Time_Start": 1855.1,
      "Time_End": 1859.22,
      "Text": " there that it really helps if you can pinpoint on script-based attacks."
    },
    {
      "Time_Start": 1859.22,
      "Time_End": 1866.42,
      "Text": " Frankly, if you ask me, it is easier to bypass a countermeasure while if you use an executable"
    },
    {
      "Time_Start": 1866.42,
      "Time_End": 1872.42,
      "Text": " and not a script-based attack, but they are so easy to execute, it's almost addicting."
    },
    {
      "Time_Start": 1872.42,
      "Time_End": 1877.48,
      "Text": " So what we are going to do on this box, I have PowerShell version 5 installed and some"
    },
    {
      "Time_Start": 1878.22,
      "Time_End": 1880.92,
      "Text": " of the logging capabilities enabled."
    },
    {
      "Time_Start": 1880.92,
      "Time_End": 1889.1200000000001,
      "Text": " So first of all, let's have a look at if we have any malicious script block logging which"
    },
    {
      "Time_Start": 1889.1200000000001,
      "Time_End": 1893.94,
      "Text": " goes to PowerShell operational."
    },
    {
      "Time_Start": 1893.94,
      "Time_End": 1900.32,
      "Text": " So although this is quite scattered, those of you who have seen source of Mimikatz will"
    },
    {
      "Time_Start": 1900.32,
      "Time_End": 1906.44,
      "Text": " know that this comes from invoke Mimikatz."
    },
    {
      "Time_Start": 1906.44,
      "Time_End": 1910.68,
      "Text": " These all logs, these are almost 100 of log entries."
    },
    {
      "Time_Start": 1910.68,
      "Time_End": 1917.28,
      "Text": " So what enhanced script block logging does, if it thinks that a script block, a PowerShell"
    },
    {
      "Time_Start": 1917.28,
      "Time_End": 1924.4,
      "Text": " script block is suspicious or malicious, it is logged in into the PowerShell operational"
    },
    {
      "Time_Start": 1924.4,
      "Time_End": 1925.96,
      "Text": " logs."
    },
    {
      "Time_Start": 1925.96,
      "Time_End": 1935.72,
      "Text": " That means you may have a complete script in here, deobfuscated, decrypted, de-whatever,"
    },
    {
      "Time_Start": 1935.72,
      "Time_End": 1939.76,
      "Text": " that's your free deobfuscator right here."
    },
    {
      "Time_Start": 1939.76,
      "Time_End": 1944.08,
      "Text": " Whatever stuff you pass on to a PowerShell scripting host gets logged in here if it is"
    },
    {
      "Time_Start": 1944.08,
      "Time_End": 1945.4,
      "Text": " assumed malicious."
    },
    {
      "Time_Start": 1945.4,
      "Time_End": 1949.6000000000001,
      "Text": " In case you're using obfuscation, it's almost sure."
    },
    {
      "Time_Start": 1949.6000000000001,
      "Time_End": 1954.48,
      "Text": " And I think we have the god of obfuscation here in the room."
    },
    {
      "Time_Start": 1954.48,
      "Time_End": 1960.3600000000001,
      "Text": " So pardon me if I used obfuscation wrong by any chance."
    },
    {
      "Time_Start": 1960.3600000000001,
      "Time_End": 1966.48,
      "Text": " So if you use any sort of obfuscation, your script, unless you are Daniel, your script"
    },
    {
      "Time_Start": 1966.48,
      "Time_End": 1969.5200000000002,
      "Text": " will be visible right here."
    },
    {
      "Time_Start": 1969.5200000000002,
      "Time_End": 1978.64,
      "Text": " So not only that, the thing which helps most here is this."
    },
    {
      "Time_Start": 1978.64,
      "Time_End": 1989.2400000000002,
      "Text": " If you have system wide transcripts enabled, you will have something like this."
    },
    {
      "Time_Start": 1989.32,
      "Time_End": 1993.08,
      "Text": " Of course, please make sure that your transcripts are forwarded to a SIEM device or a central"
    },
    {
      "Time_Start": 1993.08,
      "Time_End": 1994.72,
      "Text": " log management system."
    },
    {
      "Time_Start": 1994.72,
      "Time_End": 2002.36,
      "Text": " What this transcript says that a user, lab user, on this machine executed this process,"
    },
    {
      "Time_Start": 2002.36,
      "Time_End": 2014.76,
      "Text": " wsmprofhost, and what that script does, it runs this script, which is invokeMimikatz,"
    },
    {
      "Time_Start": 2015.76,
      "Time_End": 2025.92,
      "Text": " and what it did was, if it is visible over here, the result was this."
    },
    {
      "Time_Start": 2025.92,
      "Time_End": 2035.2,
      "Text": " This tool was executed on your box and your credentials or hashes or whatever was visible"
    },
    {
      "Time_Start": 2035.2,
      "Time_End": 2036.2,
      "Text": " to this guy."
    },
    {
      "Time_Start": 2036.2,
      "Time_End": 2039.36,
      "Text": " So that's what system wide transcripts do."
    },
    {
      "Time_Start": 2039.36,
      "Time_End": 2043.8,
      "Text": " Of course, if you can forward these things to a device which manages your logs and can"
    },
    {
      "Time_Start": 2043.8,
      "Time_End": 2055.12,
      "Text": " create some correlation rules out of this, it would be really helpful."
    },
    {
      "Time_Start": 2055.12,
      "Time_End": 2063.36,
      "Text": " Now we saw that in case we ran invokeMimikatz, the most useful thing was system wide transcripts."
    },
    {
      "Time_Start": 2063.36,
      "Time_End": 2066.44,
      "Text": " I saw this already."
    },
    {
      "Time_Start": 2066.44,
      "Time_End": 2071.72,
      "Text": " Now the next step is to look for domain admin."
    },
    {
      "Time_Start": 2071.7200000000003,
      "Time_End": 2077.32,
      "Text": " Although I personally, in my engagements, I do not go after domain admin specifically"
    },
    {
      "Time_Start": 2077.32,
      "Time_End": 2083.6800000000003,
      "Text": " since the time Microsoft ATA has come onto the scene, and we'll discuss that as well,"
    },
    {
      "Time_Start": 2083.6800000000003,
      "Time_End": 2084.6800000000003,
      "Text": " I believe."
    },
    {
      "Time_Start": 2084.6800000000003,
      "Time_End": 2093.44,
      "Text": " But still, let's go for DA because that's what many of us do in a real world engagement."
    },
    {
      "Time_Start": 2093.44,
      "Time_End": 2098.88,
      "Text": " Leaving the talk aside, I would suggest you not to do that, not to go for DA immediately"
    },
    {
      "Time_Start": 2099.04,
      "Time_End": 2103.52,
      "Text": " as soon as you got a local admin access because that's really noisy."
    },
    {
      "Time_Start": 2103.52,
      "Time_End": 2110.6400000000003,
      "Text": " Maybe stick to your goals, go after client's IP or employee data or whatever the goal of"
    },
    {
      "Time_Start": 2110.6400000000003,
      "Time_End": 2112.52,
      "Text": " your engagement is."
    },
    {
      "Time_Start": 2112.52,
      "Time_End": 2121.1600000000003,
      "Text": " But once you think that it is the best way to go for, let's try how we can do that."
    },
    {
      "Time_Start": 2121.1600000000003,
      "Time_End": 2128.0,
      "Text": " So what we have done up to now is we have admin access to a box."
    },
    {
      "Time_Start": 2128.12,
      "Time_End": 2138.0,
      "Text": " We have hashes of a local admin which was term admin which I have actually copied already"
    },
    {
      "Time_Start": 2138.0,
      "Time_End": 2141.12,
      "Text": " so that things are bit fast."
    },
    {
      "Time_Start": 2141.12,
      "Time_End": 2145.96,
      "Text": " So what we are going to do now using hashes, NTLM hashes of that user, we are going to"
    },
    {
      "Time_Start": 2145.96,
      "Time_End": 2153.44,
      "Text": " create a PowerShell process with the privileges of that user of this thing."
    },
    {
      "Time_Start": 2153.44,
      "Time_End": 2159.12,
      "Text": " The new PowerShell process which opens up has the privileges of term admin, the administrator"
    },
    {
      "Time_Start": 2159.12,
      "Time_End": 2161.9,
      "Text": " on that remote box."
    },
    {
      "Time_Start": 2161.9,
      "Time_End": 2175.52,
      "Text": " What we are going to do now is try to look for a domain admin from this thing."
    },
    {
      "Time_Start": 2175.52,
      "Time_End": 2182.7000000000003,
      "Text": " So now I'm so used to load mimikets every second that it's even not required."
    },
    {
      "Time_Start": 2182.7,
      "Time_End": 2186.2999999999997,
      "Text": " So let's run invoke-user-hunter."
    },
    {
      "Time_Start": 2186.2999999999997,
      "Time_End": 2191.2599999999998,
      "Text": " What invoke-user-hunter does, it looks for, let's not run it with verbosity, it looks"
    },
    {
      "Time_Start": 2191.2599999999998,
      "Time_End": 2195.3399999999997,
      "Text": " for a token of domain admin on any of the boxes."
    },
    {
      "Time_Start": 2195.3399999999997,
      "Time_End": 2197.74,
      "Text": " It can do it on all the boxes."
    },
    {
      "Time_Start": 2197.74,
      "Time_End": 2202.4199999999996,
      "Text": " Success would be shown only on those boxes where you have local admin rights as well."
    },
    {
      "Time_Start": 2202.4199999999996,
      "Time_End": 2207.8599999999997,
      "Text": " That is, it will find for a box, look for a box where a domain admin is logged in and"
    },
    {
      "Time_Start": 2207.86,
      "Time_End": 2213.2200000000003,
      "Text": " you have local admin rights so that you can reuse the token of domain admin."
    },
    {
      "Time_Start": 2213.2200000000003,
      "Time_End": 2217.02,
      "Text": " It is true for this box."
    },
    {
      "Time_Start": 2217.02,
      "Time_End": 2222.6600000000003,
      "Text": " So as you might have guessed, once we have something like this, it's really easy to escalate"
    },
    {
      "Time_Start": 2222.6600000000003,
      "Time_End": 2224.7400000000002,
      "Text": " our privileges to domain admin."
    },
    {
      "Time_Start": 2224.7400000000002,
      "Time_End": 2228.6600000000003,
      "Text": " But there is something which comes in when you do things like this."
    },
    {
      "Time_Start": 2228.6600000000003,
      "Time_End": 2231.06,
      "Text": " Of course, regular logs."
    },
    {
      "Time_Start": 2231.06,
      "Time_End": 2239.14,
      "Text": " And I have been looking at this thing being used increasingly in enterprise environments."
    },
    {
      "Time_Start": 2239.14,
      "Time_End": 2244.46,
      "Text": " Microsoft ATA, Advanced Threat Analytics, they bought up a behavioral analysis company"
    },
    {
      "Time_Start": 2244.46,
      "Time_End": 2246.66,
      "Text": " a few years back, two or three years back."
    },
    {
      "Time_Start": 2246.66,
      "Time_End": 2252.02,
      "Text": " And this tool is, personally for me, this is my latest nightmare."
    },
    {
      "Time_Start": 2252.02,
      "Time_End": 2257.38,
      "Text": " How ATA works is, and I'm not endorsing it, I mean, this is a fantastic tool and Microsoft"
    },
    {
      "Time_Start": 2257.38,
      "Time_End": 2261.06,
      "Text": " is not as evil as it used to be, but still I'm not endorsing it."
    },
    {
      "Time_Start": 2261.06,
      "Time_End": 2264.86,
      "Text": " Try it on with your own risk."
    },
    {
      "Time_Start": 2264.86,
      "Time_End": 2269.42,
      "Text": " How ATA works is, it looks for whatever traffic you are sending to the DC."
    },
    {
      "Time_Start": 2269.42,
      "Time_End": 2274.34,
      "Text": " In my lab, it is a light gateway installed on the DC itself, or you may have a sensor"
    },
    {
      "Time_Start": 2274.34,
      "Time_End": 2280.86,
      "Text": " which sends whatever traffic is being sent to the DC to ATA's gateway."
    },
    {
      "Time_Start": 2280.86,
      "Time_End": 2288.2200000000003,
      "Text": " It looks for anomalies, like if you are using, let's say, NTLM authentication, because Kerberos"
    },
    {
      "Time_Start": 2288.2200000000003,
      "Time_End": 2291.54,
      "Text": " is the default one in a domain environment."
    },
    {
      "Time_Start": 2291.54,
      "Time_End": 2298.3,
      "Text": " Or if one of your users used to log in only at 10 in the morning and logs out at 4 in"
    },
    {
      "Time_Start": 2298.3,
      "Time_End": 2304.1,
      "Text": " the evening, but today, for some weird reason, that user logs in at 11 in the night."
    },
    {
      "Time_Start": 2304.1,
      "Time_End": 2306.42,
      "Text": " Even that thing, it claims, gets detected."
    },
    {
      "Time_Start": 2306.42,
      "Time_End": 2309.82,
      "Text": " So there are a lot of claims, a lot of avoidance, a lot of bypasses."
    },
    {
      "Time_Start": 2309.82,
      "Time_End": 2316.2200000000003,
      "Text": " In fact, if you are interested in ATA, and here's a chance for me to, for some shameless"
    },
    {
      "Time_Start": 2316.2200000000003,
      "Time_End": 2319.02,
      "Text": " self-promotion, visit my blog."
    },
    {
      "Time_Start": 2319.02,
      "Time_End": 2323.26,
      "Text": " I blogged how you can avoid ATA last month."
    },
    {
      "Time_Start": 2323.26,
      "Time_End": 2328.78,
      "Text": " That is, so the blog was, if you stay on the database layer, do not interact with the DC"
    },
    {
      "Time_Start": 2328.78,
      "Time_End": 2329.78,
      "Text": " at all."
    },
    {
      "Time_Start": 2329.78,
      "Time_End": 2337.54,
      "Text": " This bastard works only on DC, doesn't monitor any other server."
    },
    {
      "Time_Start": 2337.54,
      "Time_End": 2338.54,
      "Text": " That's it."
    },
    {
      "Time_Start": 2338.54,
      "Time_End": 2346.86,
      "Text": " Or user hunting, it gets detected as recurring using SMB session enumeration, which doesn't"
    },
    {
      "Time_Start": 2346.86,
      "Time_End": 2351.3,
      "Text": " make things really easy as they look like."
    },
    {
      "Time_Start": 2351.3,
      "Time_End": 2356.98,
      "Text": " Assuming that we got past that thing, it was marked as, let's say, a false positive or"
    },
    {
      "Time_Start": 2356.98,
      "Time_End": 2359.68,
      "Text": " no one is looking at it."
    },
    {
      "Time_Start": 2359.68,
      "Time_End": 2366.18,
      "Text": " In such a case, if we have, if we escalate our privileges to domain admin, how we are"
    },
    {
      "Time_Start": 2366.18,
      "Time_End": 2371.54,
      "Text": " doing that, once again, now we run Mimikatz onto the OPS file where a domain admin was"
    },
    {
      "Time_Start": 2371.54,
      "Time_End": 2372.54,
      "Text": " logged in."
    },
    {
      "Time_Start": 2372.54,
      "Time_End": 2376.8199999999997,
      "Text": " We pulled the hashes of a domain admin, so an assumption that we know that this guy is"
    },
    {
      "Time_Start": 2376.8199999999997,
      "Time_End": 2379.94,
      "Text": " a domain admin."
    },
    {
      "Time_Start": 2379.94,
      "Time_End": 2386.2599999999998,
      "Text": " We start a PowerShell process with the privileges of that user who would be domain admin."
    },
    {
      "Time_Start": 2386.2599999999998,
      "Time_End": 2390.3399999999997,
      "Text": " Looks easy, looks silent, but it is not."
    },
    {
      "Time_Start": 2390.34,
      "Time_End": 2397.5,
      "Text": " Once again, ATA will kick in, and interestingly, it can point out to the exact name of the"
    },
    {
      "Time_Start": 2397.5,
      "Time_End": 2398.5,
      "Text": " attack, the hacker lingo."
    },
    {
      "Time_Start": 2398.5,
      "Time_End": 2400.7000000000003,
      "Text": " It's overpassed the hash attack."
    },
    {
      "Time_Start": 2400.7000000000003,
      "Time_End": 2404.98,
      "Text": " That is, you are using an NTLM hash to create a Kerberos ticket."
    },
    {
      "Time_Start": 2404.98,
      "Time_End": 2407.26,
      "Text": " How do you, how it does that?"
    },
    {
      "Time_Start": 2407.26,
      "Time_End": 2417.46,
      "Text": " Because generally, in case of a normal ticket, a normal TGT, the timestamp which you encrypt"
    },
    {
      "Time_Start": 2417.46,
      "Time_End": 2423.34,
      "Text": " with your NTLM hash to authenticate to the KDC is not done using NTLM."
    },
    {
      "Time_Start": 2423.34,
      "Time_End": 2432.58,
      "Text": " That's what it checks for here and shows an alert."
    },
    {
      "Time_Start": 2432.58,
      "Time_End": 2437.86,
      "Text": " Once we are DA, the next thing which we can do is execute stuff on the domain controller"
    },
    {
      "Time_Start": 2437.86,
      "Time_End": 2439.54,
      "Text": " and persist on it."
    },
    {
      "Time_Start": 2439.54,
      "Time_End": 2441.7,
      "Text": " How we can do that?"
    },
    {
      "Time_Start": 2441.7,
      "Time_End": 2445.7,
      "Text": " By getting maybe the hash of the Kirby TGT account, which we can use to create a golden"
    },
    {
      "Time_Start": 2446.0200000000004,
      "Time_End": 2447.0200000000004,
      "Text": " ticket later on."
    },
    {
      "Time_Start": 2447.0200000000004,
      "Time_End": 2451.82,
      "Text": " When you create a golden ticket, that's perfectly fine."
    },
    {
      "Time_Start": 2451.82,
      "Time_End": 2457.1000000000004,
      "Text": " Of course, when you execute stuff on the domain controller, it's not always."
    },
    {
      "Time_Start": 2457.1000000000004,
      "Time_End": 2462.34,
      "Text": " So does anyone of you, can anyone of you tell me if there is a replacement for the first"
    },
    {
      "Time_Start": 2462.34,
      "Time_End": 2463.34,
      "Text": " step?"
    },
    {
      "Time_Start": 2463.34,
      "Time_End": 2468.42,
      "Text": " Instead of executing Mimikatz onto the domain controller, is there another way of remotely"
    },
    {
      "Time_Start": 2468.42,
      "Time_End": 2472.9,
      "Text": " pulling hashes from the DC?"
    },
    {
      "Time_Start": 2472.9,
      "Time_End": 2474.78,
      "Text": " Maybe DC sync?"
    },
    {
      "Time_Start": 2474.86,
      "Time_End": 2479.82,
      "Text": " So you pose as a domain controller, tell the domain controller that I am a domain controller"
    },
    {
      "Time_Start": 2479.82,
      "Time_End": 2480.82,
      "Text": " as well."
    },
    {
      "Time_Start": 2480.82,
      "Time_End": 2484.78,
      "Text": " Please sync with me, send me all the hashes, and it sends the hashes to you."
    },
    {
      "Time_Start": 2484.78,
      "Time_End": 2487.2000000000003,
      "Text": " You can use that as well."
    },
    {
      "Time_Start": 2487.2000000000003,
      "Time_End": 2494.7000000000003,
      "Text": " In any case, once you get hashes for the Kirby TGT account, which is this in our lab case,"
    },
    {
      "Time_Start": 2494.7000000000003,
      "Time_End": 2501.2200000000003,
      "Text": " once you do that, you can create a golden ticket later on, which generally, in my cases,"
    },
    {
      "Time_Start": 2501.2200000000003,
      "Time_End": 2506.38,
      "Text": " I have seen working for at least six months, two months, three months, it depends on the"
    },
    {
      "Time_Start": 2506.38,
      "Time_End": 2511.3,
      "Text": " environment which you are targeting."
    },
    {
      "Time_Start": 2511.3,
      "Time_End": 2517.0600000000004,
      "Text": " Creating a golden ticket does not necessarily create any logs, because you are doing it"
    },
    {
      "Time_Start": 2517.0600000000004,
      "Time_End": 2518.0600000000004,
      "Text": " on your own box."
    },
    {
      "Time_Start": 2518.0600000000004,
      "Time_End": 2523.9800000000005,
      "Text": " Of course, if someone looks or does forensically investigate your box later on, it would be"
    },
    {
      "Time_Start": 2523.9800000000005,
      "Time_End": 2528.0200000000004,
      "Text": " visible, but doesn't do that in any other case."
    },
    {
      "Time_Start": 2528.02,
      "Time_End": 2534.86,
      "Text": " But if you use it, same logs, successful admin log on, log off, et cetera, and once"
    },
    {
      "Time_Start": 2534.86,
      "Time_End": 2536.9,
      "Text": " again, ATA."
    },
    {
      "Time_Start": 2536.9,
      "Time_End": 2543.02,
      "Text": " Why I keep coming back to ATA, frankly, I've never seen anything which detects attacks"
    },
    {
      "Time_Start": 2543.02,
      "Time_End": 2546.9,
      "Text": " like this so quickly and effectively."
    },
    {
      "Time_Start": 2546.9,
      "Time_End": 2554.82,
      "Text": " Of course, it has its own flaws, but your golden ticket may get detected as well, which"
    },
    {
      "Time_Start": 2554.82,
      "Time_End": 2557.62,
      "Text": " doesn't make things really good if you're a red teamer."
    },
    {
      "Time_Start": 2558.22,
      "Time_End": 2564.9,
      "Text": " Another reason why I keep coming back to this, because this is something which blue guys"
    },
    {
      "Time_Start": 2564.9,
      "Time_End": 2565.9,
      "Text": " can use."
    },
    {
      "Time_Start": 2565.9,
      "Time_End": 2569.98,
      "Text": " Of course, an expensive tool, but really, really useful."
    },
    {
      "Time_Start": 2569.98,
      "Time_End": 2573.54,
      "Text": " Now, there are many ways of exfiltration."
    },
    {
      "Time_Start": 2573.54,
      "Time_End": 2575.94,
      "Text": " My favorite is to use Gmail."
    },
    {
      "Time_Start": 2575.94,
      "Time_End": 2578.96,
      "Text": " You can once again use PowerShell to exfiltrate things to Gmail."
    },
    {
      "Time_Start": 2578.96,
      "Time_End": 2586.1,
      "Text": " What I'm doing here, depending on the environment, if you exfiltrate, let's say, 10 GBs or 100"
    },
    {
      "Time_Start": 2586.1,
      "Time_End": 2588.86,
      "Text": " GBs of data, that may get detected."
    },
    {
      "Time_Start": 2588.86,
      "Time_End": 2595.9,
      "Text": " If someone asks me that if there is a single thing I want to exfiltrate from an environment,"
    },
    {
      "Time_Start": 2595.9,
      "Time_End": 2600.2599999999998,
      "Text": " that would be a hash of the Kubernetes GT account."
    },
    {
      "Time_Start": 2600.2599999999998,
      "Time_End": 2606.42,
      "Text": " So that's how we exfiltrate it using Gmail, chances of detection."
    },
    {
      "Time_Start": 2606.42,
      "Time_End": 2612.86,
      "Text": " If you have a deep packet inspection setup, which looks at even Gmail, I have seen environments"
    },
    {
      "Time_Start": 2612.86,
      "Time_End": 2619.1,
      "Text": " where HTTPS is intercepted, but things like Gmail, Google Docs, et cetera, are not."
    },
    {
      "Time_Start": 2619.1,
      "Time_End": 2621.46,
      "Text": " So you may like to do that as well."
    },
    {
      "Time_Start": 2621.46,
      "Time_End": 2624.46,
      "Text": " How many times?"
    },
    {
      "Time_Start": 2624.46,
      "Time_End": 2629.9,
      "Text": " Oh, two minutes."
    },
    {
      "Time_Start": 2629.9,
      "Time_End": 2635.86,
      "Text": " So if you want to exfiltrate a huge chunk of data, maybe go for FTP, Dropbox, Google"
    },
    {
      "Time_Start": 2635.86,
      "Time_End": 2638.1800000000003,
      "Text": " Drive maybe."
    },
    {
      "Time_Start": 2638.1800000000003,
      "Time_End": 2641.54,
      "Text": " So that's story one."
    },
    {
      "Time_Start": 2641.54,
      "Time_End": 2648.86,
      "Text": " Another one is to start as a once again non-local admin domain user, maybe use client-side attack"
    },
    {
      "Time_Start": 2648.86,
      "Time_End": 2652.74,
      "Text": " with PowerShell.exe, which is blocked with whitelisting."
    },
    {
      "Time_Start": 2652.74,
      "Time_End": 2654.34,
      "Text": " How we can do that?"
    },
    {
      "Time_Start": 2654.34,
      "Time_End": 2656.86,
      "Text": " Maybe use HTA."
    },
    {
      "Time_Start": 2656.86,
      "Time_End": 2660.66,
      "Text": " So if you use HTA, you will see something like this."
    },
    {
      "Time_Start": 2660.66,
      "Time_End": 2672.66,
      "Text": " Even if you have explicitly blocked PowerShell, you will still see something like this."
    },
    {
      "Time_Start": 2672.66,
      "Time_End": 2676.94,
      "Text": " If I have that right now."
    },
    {
      "Time_Start": 2676.94,
      "Time_End": 2687.92,
      "Text": " So this is when you run PowerShell.exe without HTA, and this is when you run it with HTA."
    },
    {
      "Time_Start": 2687.92,
      "Time_End": 2690.64,
      "Text": " Even if you have explicitly blocked PowerShell, it will still be allowed."
    },
    {
      "Time_Start": 2690.64,
      "Time_End": 2695.12,
      "Text": " So there are so many ways to actually bypass application whitelisting."
    },
    {
      "Time_Start": 2695.12,
      "Time_End": 2699.84,
      "Text": " Once again, what helps here is system-wide transcripts."
    },
    {
      "Time_Start": 2699.84,
      "Time_End": 2704.6800000000003,
      "Text": " For example, if PowerShell.exe is blocked, removed, you can still use something like"
    },
    {
      "Time_Start": 2704.6800000000003,
      "Time_End": 2708.0,
      "Text": " MSBuild to rerun it."
    },
    {
      "Time_Start": 2708.0,
      "Time_End": 2714.56,
      "Text": " Even if you do it with MSBuild, system-wide transcripts will still log each and everything."
    },
    {
      "Time_Start": 2714.56,
      "Time_End": 2717.6800000000003,
      "Text": " So it helps."
    },
    {
      "Time_Start": 2718.44,
      "Time_End": 2725.04,
      "Text": " You can use ICMP, HTTPS, DNS shells out of raw TCP or UDP, which are some of the lesser"
    },
    {
      "Time_Start": 2725.04,
      "Time_End": 2726.44,
      "Text": " monitored protocols."
    },
    {
      "Time_Start": 2726.44,
      "Time_End": 2730.6,
      "Text": " There are ready-to-use shells in Nishang and in other tools for that."
    },
    {
      "Time_Start": 2730.6,
      "Time_End": 2737.64,
      "Text": " Or maybe just use Empire, which has its own implementation of encrypted communications."
    },
    {
      "Time_Start": 2737.64,
      "Time_End": 2740.8999999999996,
      "Text": " Let me quickly go through the random PowerShell things."
    },
    {
      "Time_Start": 2740.8999999999996,
      "Time_End": 2745.0,
      "Text": " One of the very interesting attacks is to downgrade to PowerShell version 2."
    },
    {
      "Time_Start": 2745.0,
      "Time_End": 2747.0,
      "Text": " That's called the PowerShell downgrade attack."
    },
    {
      "Time_Start": 2747.0,
      "Time_End": 2752.2,
      "Text": " That is, even if your environment has PowerShell version 5 installed, someone may just run"
    },
    {
      "Time_Start": 2752.2,
      "Time_End": 2759.2,
      "Text": " PowerShell-version 2 and remove effectively MZ, the Anti-Malware Scan Interface, enhanced"
    },
    {
      "Time_Start": 2759.2,
      "Time_End": 2761.68,
      "Text": " login capabilities, et cetera."
    },
    {
      "Time_Start": 2761.68,
      "Time_End": 2766.52,
      "Text": " Although not enabled by default on Windows 10, you can install an older .NET version"
    },
    {
      "Time_Start": 2766.52,
      "Time_End": 2768.68,
      "Text": " and still do it."
    },
    {
      "Time_Start": 2768.68,
      "Time_End": 2772.28,
      "Text": " How do we defend against things like this?"
    },
    {
      "Time_Start": 2772.28,
      "Time_End": 2778.96,
      "Text": " Lee Holmes, one of the architects of PowerShell, blogged about this."
    },
    {
      "Time_Start": 2778.96,
      "Time_End": 2786.76,
      "Text": " Whenever you run a PowerShell event or script, in Windows PowerShell log, you will see event"
    },
    {
      "Time_Start": 2786.76,
      "Time_End": 2789.44,
      "Text": " ID 400, which codes engine version."
    },
    {
      "Time_Start": 2789.44,
      "Time_End": 2796.0800000000004,
      "Text": " So if you do not absolutely want PowerShell 2 to be executed in your environment, this"
    },
    {
      "Time_Start": 2796.08,
      "Time_End": 2801.56,
      "Text": " should be a security alert as soon as someone runs PowerShell version 2."
    },
    {
      "Time_Start": 2801.56,
      "Time_End": 2806.44,
      "Text": " Yes, if PowerShell.exe is blocked."
    },
    {
      "Time_Start": 2806.44,
      "Time_End": 2810.08,
      "Text": " So I had a demonstration for this as well, but you can imagine what happens."
    },
    {
      "Time_Start": 2810.08,
      "Time_End": 2815.7599999999998,
      "Text": " It just pops open PowerShell even if you block it already."
    },
    {
      "Time_Start": 2815.7599999999998,
      "Time_End": 2819.48,
      "Text": " Once again, system-wide transcripts to the rescue."
    },
    {
      "Time_Start": 2819.48,
      "Time_End": 2827.64,
      "Text": " If you have MZ enabled, MZ detects PowerShell, BB script, JScript code from memory."
    },
    {
      "Time_Start": 2827.64,
      "Time_End": 2831.2,
      "Text": " If you want to avoid that, you can do that as well."
    },
    {
      "Time_Start": 2831.2,
      "Time_End": 2837.22,
      "Text": " So attack, it's detection, detection, attack, which can disable it."
    },
    {
      "Time_Start": 2837.22,
      "Time_End": 2841.18,
      "Text": " And that is what purple teaming is about."
    },
    {
      "Time_Start": 2841.18,
      "Time_End": 2846.26,
      "Text": " If you introduce a new detection mechanism, the red team should try to avoid it."
    },
    {
      "Time_Start": 2846.26,
      "Time_End": 2851.94,
      "Text": " As soon as the red team tries to bypass it, for example, this one was treated by Matt,"
    },
    {
      "Time_Start": 2851.94,
      "Time_End": 2855.6200000000003,
      "Text": " the guy who wrote PowerSploit, still an event ID is generated."
    },
    {
      "Time_Start": 2855.6200000000003,
      "Time_End": 2857.9,
      "Text": " So maybe look for that event ID as well."
    },
    {
      "Time_Start": 2857.9,
      "Time_End": 2863.5800000000004,
      "Text": " Defense, attack, defense, keep doing that."
    },
    {
      "Time_Start": 2863.5800000000004,
      "Time_End": 2869.6600000000003,
      "Text": " As a freelancer, how I go ahead with purple teaming, as I said in the beginning, I do"
    },
    {
      "Time_Start": 2869.6600000000003,
      "Time_End": 2875.3,
      "Text": " it more in the form of a training scenario, maybe three or four guys of the client's blue"
    },
    {
      "Time_Start": 2875.34,
      "Time_End": 2877.78,
      "Text": " team or maybe red team will sit with me."
    },
    {
      "Time_Start": 2877.78,
      "Time_End": 2879.7400000000002,
      "Text": " And we do it together in form of a training."
    },
    {
      "Time_Start": 2879.7400000000002,
      "Time_End": 2883.5800000000004,
      "Text": " That's how I've been doing purple teaming."
    },
    {
      "Time_Start": 2883.5800000000004,
      "Time_End": 2887.38,
      "Text": " And there is actually a valid reason of not doing it with external red team."
    },
    {
      "Time_Start": 2887.38,
      "Time_End": 2891.54,
      "Text": " The adversarial nature that is, OK, why should I share my techniques with my client's blue"
    },
    {
      "Time_Start": 2891.54,
      "Time_End": 2892.78,
      "Text": " team?"
    },
    {
      "Time_Start": 2892.78,
      "Time_End": 2895.2200000000003,
      "Text": " That makes sense."
    },
    {
      "Time_Start": 2895.2200000000003,
      "Time_End": 2901.94,
      "Text": " And that is why most purple teaming engagements are not done with an external red team."
    },
    {
      "Time_Start": 2901.94,
      "Time_End": 2908.1,
      "Text": " But external red component in a purple team provides new techniques, new perspective."
    },
    {
      "Time_Start": 2908.1,
      "Time_End": 2912.46,
      "Text": " So please do not kick us freelancers out."
    },
    {
      "Time_Start": 2912.46,
      "Time_End": 2918.14,
      "Text": " We are much more into the purple teaming scenario."
    },
    {
      "Time_Start": 2918.14,
      "Time_End": 2925.2200000000003,
      "Text": " Some of the references, good reads on purple teaming if you want to read."
    },
    {
      "Time_Start": 2925.2200000000003,
      "Time_End": 2930.02,
      "Text": " So to conclude, purple team aims to bring red and blue together."
    },
    {
      "Time_Start": 2930.02,
      "Time_End": 2936.46,
      "Text": " So not red versus blue, but red and blue so that the benefits for security are maximized."
    },
    {
      "Time_Start": 2936.46,
      "Time_End": 2940.22,
      "Text": " Doesn't mean an add to red teaming, both have different goals, of course."
    },
    {
      "Time_Start": 2940.22,
      "Time_End": 2943.42,
      "Text": " Red teaming has its own thing."
    },
    {
      "Time_Start": 2943.42,
      "Time_End": 2949.06,
      "Text": " And structural and cultural, work cultural changes are really, really required to create"
    },
    {
      "Time_Start": 2949.06,
      "Time_End": 2952.46,
      "Text": " an effective purple team."
    },
    {
      "Time_Start": 2952.46,
      "Time_End": 2953.58,
      "Text": " And that would be it from me."
    }
  ]
}