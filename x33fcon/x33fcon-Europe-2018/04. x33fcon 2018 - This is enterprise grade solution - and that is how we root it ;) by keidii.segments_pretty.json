{
  "segments": [
    {
      "Time_Start": 0.0,
      "Time_End": 21.080000000000002,
      "Text": "This text was transcribed using whisper model: large-v2\n\n So, yes, this will be a presentation about the bugs found in the security solution, Enterprise"
    },
    {
      "Time_Start": 21.080000000000002,
      "Time_End": 25.96,
      "Text": " Grade Solution, the story how we did root it."
    },
    {
      "Time_Start": 25.96,
      "Time_End": 31.64,
      "Text": " The second title is bugs are everywhere, and a quick question, what happens when you type"
    },
    {
      "Time_Start": 31.64,
      "Time_End": 35.88,
      "Text": " in bugs are everywhere into the Google image search?"
    },
    {
      "Time_Start": 35.88,
      "Time_End": 37.88,
      "Text": " You get the bugs."
    },
    {
      "Time_Start": 37.88,
      "Time_End": 40.480000000000004,
      "Text": " It's a disclaimer."
    },
    {
      "Time_Start": 40.480000000000004,
      "Time_End": 47.08,
      "Text": " So at first, the opinions expressed here are only mine."
    },
    {
      "Time_Start": 47.08,
      "Time_End": 51.88,
      "Text": " If I'm saying that somebody is doing something wrong, this is my opinion."
    },
    {
      "Time_Start": 51.88,
      "Time_End": 52.88,
      "Text": " Nobody else."
    },
    {
      "Time_Start": 52.88,
      "Time_End": 57.080000000000005,
      "Text": " I'm not impersonating anyone."
    },
    {
      "Time_Start": 57.080000000000005,
      "Time_End": 62.2,
      "Text": " Second, the presentation purpose is just to educate everybody."
    },
    {
      "Time_Start": 62.2,
      "Time_End": 66.36,
      "Text": " Following slides are the result of security research."
    },
    {
      "Time_Start": 66.36,
      "Time_End": 71.36,
      "Text": " Of course, done by accident, but still a security research."
    },
    {
      "Time_Start": 71.36,
      "Time_End": 77.4,
      "Text": " No animals were harmed, and playing with malware is a bad idea."
    },
    {
      "Time_Start": 77.4,
      "Time_End": 78.4,
      "Text": " Basically who am I?"
    },
    {
      "Time_Start": 78.4,
      "Time_End": 84.08000000000001,
      "Text": " I graduated physics on Warsaw University of Technology, and because of studying right"
    },
    {
      "Time_Start": 84.08000000000001,
      "Time_End": 92.36000000000001,
      "Text": " there, I developed the curiosity how the things are working, how the environment, the world"
    },
    {
      "Time_Start": 92.36000000000001,
      "Time_End": 96.04,
      "Text": " is built, and the knowledge about the universe and stuff."
    },
    {
      "Time_Start": 96.04,
      "Time_End": 101.32000000000001,
      "Text": " I know why the answer for everything is 42."
    },
    {
      "Time_Start": 101.32000000000001,
      "Time_End": 108.96000000000001,
      "Text": " Later on, working seven years in SERT Polska allowed me to develop skills and gain combat"
    },
    {
      "Time_Start": 108.96000000000001,
      "Time_End": 115.32000000000001,
      "Text": " readiness to analyze stuff, to play with malware."
    },
    {
      "Time_Start": 115.32000000000001,
      "Time_End": 121.04,
      "Text": " I had an opportunity to work with a lot of great people."
    },
    {
      "Time_Start": 121.04,
      "Time_End": 126.0,
      "Text": " Some of them are here."
    },
    {
      "Time_Start": 126.0,
      "Time_End": 131.72,
      "Text": " With some of them, I'm still working in my new job."
    },
    {
      "Time_Start": 131.72,
      "Time_End": 138.76,
      "Text": " I'm still trying to fly with dragons, Dragon Sector's CTF team."
    },
    {
      "Time_Start": 138.76,
      "Time_End": 147.12,
      "Text": " Now I'm working in the corporate environment and having fun corporate way still."
    },
    {
      "Time_Start": 147.12,
      "Time_End": 148.44,
      "Text": " So who are you?"
    },
    {
      "Time_Start": 148.44,
      "Time_End": 154.2,
      "Text": " Is there any security guy here, girls, or bug hunters?"
    },
    {
      "Time_Start": 154.20000000000002,
      "Time_End": 156.44000000000003,
      "Text": " Because part of this presentation is for bug hunters."
    },
    {
      "Time_Start": 156.44000000000003,
      "Time_End": 157.48000000000002,
      "Text": " Any bug hunters?"
    },
    {
      "Time_Start": 157.48000000000002,
      "Time_End": 164.48000000000002,
      "Text": " People who are hunting bugs day by day, earning money for bread, doing that?"
    },
    {
      "Time_Start": 164.48000000000002,
      "Time_End": 169.16000000000003,
      "Text": " So first of all, it happens to everybody, everyone."
    },
    {
      "Time_Start": 169.16000000000003,
      "Time_End": 178.12,
      "Text": " When you create a piece of code yourself, I mean a human is creating a piece of code,"
    },
    {
      "Time_Start": 178.12,
      "Time_End": 183.32000000000002,
      "Text": " you will create a bug, because this is the byproduct of being a human."
    },
    {
      "Time_Start": 183.44,
      "Time_End": 193.2,
      "Text": " Big examples, F5, this is something, if you have enterprise-grade servers, you need to"
    },
    {
      "Time_Start": 193.2,
      "Time_End": 197.64,
      "Text": " root your HTTP traffic and probably you are using F5."
    },
    {
      "Time_Start": 197.64,
      "Time_End": 205.4,
      "Text": " 52 CVE last year, 11 this year, so they have bugs."
    },
    {
      "Time_Start": 205.4,
      "Time_End": 212.95999999999998,
      "Text": " Microsoft, a very good example, even since they started developing operating systems,"
    },
    {
      "Time_Start": 212.96,
      "Time_End": 215.52,
      "Text": " they implement bugs right there, maybe for fun."
    },
    {
      "Time_Start": 215.52,
      "Time_End": 224.16,
      "Text": " Adobe, another great example, probably they had a lot of fun implementing their own standards."
    },
    {
      "Time_Start": 224.16,
      "Time_End": 236.92000000000002,
      "Text": " Antiviruses, Symantec, McAfee, Trend Micro, you just can try to Google exploits for antivirus 2017."
    },
    {
      "Time_Start": 236.96,
      "Time_End": 244.88000000000002,
      "Text": " CPU manufacturers, so this year we learned that you can have a bug in a CPU, so probably"
    },
    {
      "Time_Start": 244.88000000000002,
      "Time_End": 253.60000000000002,
      "Text": " somebody who is designing those tiny copper wires did the job wrong."
    },
    {
      "Time_Start": 253.60000000000002,
      "Time_End": 260.48,
      "Text": " You can try to patch it using software, but still the bug is inside the great plan of"
    },
    {
      "Time_Start": 260.48,
      "Time_End": 269.36,
      "Text": " the CPU, like millions, trillions of wires and some of them are done in the wrong way."
    },
    {
      "Time_Start": 269.36,
      "Time_End": 275.68,
      "Text": " If I'm correct, today will be another release of the CPU bugs, 6 or 7 of them?"
    },
    {
      "Time_Start": 275.68,
      "Time_End": 283.16,
      "Text": " 8, okay, but tomorrow we'll have fun."
    },
    {
      "Time_Start": 283.16,
      "Time_End": 284.16,
      "Text": " What about us?"
    },
    {
      "Time_Start": 284.16,
      "Time_End": 285.52000000000004,
      "Text": " What about my company, my bank?"
    },
    {
      "Time_Start": 285.52000000000004,
      "Time_End": 287.52000000000004,
      "Text": " I'm working in a bank, do we have a bug?"
    },
    {
      "Time_Start": 287.52000000000004,
      "Time_End": 289.40000000000003,
      "Text": " Do we have a bug in my code?"
    },
    {
      "Time_Start": 289.40000000000003,
      "Time_End": 296.28000000000003,
      "Text": " Of course, the internet will say, no, banks are safe, but try to Google for it."
    },
    {
      "Time_Start": 296.28000000000003,
      "Time_End": 299.88000000000005,
      "Text": " Somebody found a bug, but we fixed it in 72 hours."
    },
    {
      "Time_Start": 299.88000000000005,
      "Time_End": 307.56000000000006,
      "Text": " I'm very proud of that, because in the 72 hours we managed to identify the bug, put"
    },
    {
      "Time_Start": 307.56000000000006,
      "Time_End": 316.40000000000003,
      "Text": " it through the fix, through the chain, so in the environment, UAT environment, quality"
    },
    {
      "Time_Start": 316.40000000000003,
      "Time_End": 321.12000000000006,
      "Text": " environment, production environment, and do the analysis, if there are any victims,"
    },
    {
      "Time_Start": 321.12000000000006,
      "Time_End": 328.28000000000003,
      "Text": " so if somebody abused this bug and everything was done in 72 hours, so it is doable in the"
    },
    {
      "Time_Start": 328.28000000000003,
      "Time_End": 333.12,
      "Text": " big corporate concrete environment."
    },
    {
      "Time_Start": 333.12,
      "Time_End": 335.52000000000004,
      "Text": " Motivation."
    },
    {
      "Time_Start": 335.52000000000004,
      "Time_End": 343.68000000000006,
      "Text": " Bugs are often not funny, some are funny, like vulnerabilities in WordPress are funny."
    },
    {
      "Time_Start": 343.68,
      "Time_End": 350.0,
      "Text": " Usually those bugs in security solutions are not funny, because what is worse than"
    },
    {
      "Time_Start": 350.0,
      "Time_End": 355.6,
      "Text": " lack of security, the false sense of security, so you think you are safe, because you have"
    },
    {
      "Time_Start": 355.6,
      "Time_End": 362.92,
      "Text": " FireEye, Kaspersky, whatever, put any name there, so we are safe, because look, half"
    },
    {
      "Time_Start": 362.92,
      "Time_End": 369.72,
      "Text": " of the rack is filled with security solutions, the product."
    },
    {
      "Time_Start": 369.76000000000005,
      "Time_End": 376.04,
      "Text": " What I will be talking about, Forcepoint bundle, so called WebSense."
    },
    {
      "Time_Start": 376.04,
      "Time_End": 386.36,
      "Text": " This is a group of security products, first we have an email gateway, so the product that"
    },
    {
      "Time_Start": 386.36,
      "Time_End": 394.28000000000003,
      "Text": " is filtering your emails, going in, going out, web gateway, so HTTP proxy, able to do"
    },
    {
      "Time_Start": 394.32000000000005,
      "Time_End": 400.32000000000005,
      "Text": " a content filtering, SSL stripping, and of course we can add DLP to everything, so it"
    },
    {
      "Time_Start": 400.32000000000005,
      "Time_End": 402.68,
      "Text": " looks quite decent."
    },
    {
      "Time_Start": 402.68,
      "Time_End": 407.44000000000005,
      "Text": " I do like that partially, because you have everything integrated into one piece, like"
    },
    {
      "Time_Start": 407.44000000000005,
      "Time_End": 412.44000000000005,
      "Text": " you don't need to write rules for emails, outgoing emails, incoming emails, and web"
    },
    {
      "Time_Start": 412.44000000000005,
      "Time_End": 417.24,
      "Text": " filtering in a few separate places, you can do it once."
    },
    {
      "Time_Start": 417.28000000000003,
      "Time_End": 425.76,
      "Text": " The process of reporting, this is quite an important part, because I was not quite confident"
    },
    {
      "Time_Start": 425.76,
      "Time_End": 437.36,
      "Text": " about this process, so we managed to break version 0.8.1 and now there is 0.8.5 on the"
    },
    {
      "Time_Start": 437.36,
      "Time_End": 446.6,
      "Text": " market, so they did release a few in this time, but still during the process of reporting,"
    },
    {
      "Time_Start": 446.6,
      "Time_End": 454.8,
      "Text": " which was September, this version 0.1 was supported."
    },
    {
      "Time_Start": 454.8,
      "Time_End": 456.0,
      "Text": " What did we report?"
    },
    {
      "Time_Start": 456.0,
      "Time_End": 463.20000000000005,
      "Text": " We sent them 5 PDFs containing bugs about PEM, web gateway, admin interface, mail gateway"
    },
    {
      "Time_Start": 463.20000000000005,
      "Time_End": 465.64000000000004,
      "Text": " and general bad practices."
    },
    {
      "Time_Start": 465.64000000000004,
      "Time_End": 470.76000000000005,
      "Text": " I will not talk about the general bad practices, because this is like standards are like, do"
    },
    {
      "Time_Start": 470.76000000000005,
      "Time_End": 476.24,
      "Text": " not hard code passwords into your code, they did."
    },
    {
      "Time_Start": 476.24,
      "Time_End": 483.28000000000003,
      "Text": " They use modern cryptography, they use DES, who is using DES now, I don't know."
    },
    {
      "Time_Start": 483.28000000000003,
      "Time_End": 486.96000000000004,
      "Text": " But I will try to talk about those first four."
    },
    {
      "Time_Start": 486.96000000000004,
      "Time_End": 494.52,
      "Text": " We reported that, we sent them those PDFs at the end of September and we clearly mentioned"
    },
    {
      "Time_Start": 494.52,
      "Time_End": 500.76,
      "Text": " that we will disclose that after 90 days or longer."
    },
    {
      "Time_Start": 500.76,
      "Time_End": 506.48,
      "Text": " I tried to consult about those 90 days with my friends, for example, for Google Zero,"
    },
    {
      "Time_Start": 506.48,
      "Time_End": 510.68,
      "Text": " I thought, okay, those guys are reporting a lot of stuff, so probably can tell, share"
    },
    {
      "Time_Start": 510.68,
      "Time_End": 521.8,
      "Text": " with me experience, should I put the 90 days, so this is like not a random decision of ours."
    },
    {
      "Time_Start": 521.8,
      "Time_End": 526.16,
      "Text": " Immediately the same day we got acknowledged, okay, thank you for the report, we will contact"
    },
    {
      "Time_Start": 526.16,
      "Time_End": 527.16,
      "Text": " you later."
    },
    {
      "Time_Start": 527.56,
      "Time_End": 534.4399999999999,
      "Text": " Few months later, at the end of December, we still didn't receive a clear acknowledgement"
    },
    {
      "Time_Start": 534.4399999999999,
      "Time_End": 541.64,
      "Text": " that, okay, we received your email, we tested all the vulnerabilities that you mentioned"
    },
    {
      "Time_Start": 541.64,
      "Time_End": 551.64,
      "Text": " and we confirmed that, I don't know, there is only one that is still exploitable."
    },
    {
      "Time_Start": 551.64,
      "Time_End": 556.64,
      "Text": " To be honest, we didn't receive any exact information, what they are planning to do,"
    },
    {
      "Time_Start": 556.64,
      "Time_End": 565.8,
      "Text": " do they plan, I don't know, notify the customers, release, fix it in a new version, whatever."
    },
    {
      "Time_Start": 565.8,
      "Time_End": 570.04,
      "Text": " One of the things they received, okay, you can try to retest it in new version, okay,"
    },
    {
      "Time_Start": 570.04,
      "Time_End": 577.28,
      "Text": " so I am as a customer, as a researcher, I am allowed to test a new version and inform"
    },
    {
      "Time_Start": 577.28,
      "Time_End": 586.56,
      "Text": " them if their new version is still vulnerable, so for me, quite misunderstanding."
    },
    {
      "Time_Start": 586.6,
      "Time_End": 593.6400000000001,
      "Text": " Luckily, after a few escalations, at the end of January, we received a list of identified"
    },
    {
      "Time_Start": 593.6400000000001,
      "Time_End": 600.0400000000001,
      "Text": " vulnerabilities, 12 items, they sent the 12 items that we do acknowledge that we received"
    },
    {
      "Time_Start": 600.0400000000001,
      "Time_End": 602.5600000000001,
      "Text": " those 12 items."
    },
    {
      "Time_Start": 602.5600000000001,
      "Time_End": 610.32,
      "Text": " Nevertheless, a lot of answered questions and hard feelings to the process."
    },
    {
      "Time_Start": 610.32,
      "Time_End": 613.6400000000001,
      "Text": " But let's go to the bugs."
    },
    {
      "Time_Start": 613.6400000000001,
      "Time_End": 616.0000000000001,
      "Text": " First the trivial one, the Triton."
    },
    {
      "Time_Start": 616.0,
      "Time_End": 621.0,
      "Text": " The Triton is the part of this bundle that is used to manage all the components, so you"
    },
    {
      "Time_Start": 621.0,
      "Time_End": 628.96,
      "Text": " can do the admin clicking here, so I want to block emails containing Viagra, apply,"
    },
    {
      "Time_Start": 628.96,
      "Time_End": 634.28,
      "Text": " it is sent to your infrastructure and the emails containing Viagra are blocked."
    },
    {
      "Time_Start": 634.28,
      "Time_End": 641.52,
      "Text": " If you have a new appliance, so you ship a new 4U server into the rack and you want to"
    },
    {
      "Time_Start": 641.52,
      "Time_End": 648.16,
      "Text": " add it to your existing cluster, you can do it here, like add another server, you are"
    },
    {
      "Time_Start": 648.16,
      "Time_End": 655.24,
      "Text": " typing the IP address of the server, you are typing the username, the password and out"
    },
    {
      "Time_Start": 655.24,
      "Time_End": 663.36,
      "Text": " of curiosity I say, okay, what happened when I type in a bug tick in the username?"
    },
    {
      "Time_Start": 663.36,
      "Time_End": 670.16,
      "Text": " After visiting the server, the server was sleeping for 60 seconds, so maybe not something"
    },
    {
      "Time_Start": 670.16,
      "Time_End": 677.4399999999999,
      "Text": " awesome, but this should not happen, especially that it is visible that they are passing this"
    },
    {
      "Time_Start": 677.4399999999999,
      "Time_End": 685.04,
      "Text": " parameter unsanitized multiple times, so the server was freezing for 6, 220 seconds or"
    },
    {
      "Time_Start": 685.04,
      "Time_End": 686.04,
      "Text": " more."
    },
    {
      "Time_Start": 686.04,
      "Time_End": 691.68,
      "Text": " Okay, but they said, okay, this is lame, because you already had an admin to this Triton stuff,"
    },
    {
      "Time_Start": 691.68,
      "Time_End": 698.9599999999999,
      "Text": " so you are injecting command as an admin, everybody can do that."
    },
    {
      "Time_Start": 698.96,
      "Time_End": 704.84,
      "Text": " Another part, the personal email manager, so called PEM, this is the marketing bullshit"
    },
    {
      "Time_Start": 704.84,
      "Time_End": 710.88,
      "Text": " from the PDF, from the vendor, basically this is the quarantine for the emails, so if the"
    },
    {
      "Time_Start": 710.88,
      "Time_End": 716.8000000000001,
      "Text": " email gateways will classify something as malicious, spam, suspicious or something,"
    },
    {
      "Time_Start": 716.8000000000001,
      "Time_End": 721.9200000000001,
      "Text": " it is putting the email to the quarantine and later the user can browse the quarantine"
    },
    {
      "Time_Start": 722.0799999999999,
      "Time_End": 727.0799999999999,
      "Text": " and see what kind of emails were blocked."
    },
    {
      "Time_Start": 727.0799999999999,
      "Time_End": 735.28,
      "Text": " For example, if a very important email from CEO was blocked, it can be released or delivered"
    },
    {
      "Time_Start": 735.28,
      "Time_End": 737.4399999999999,
      "Text": " to the inbox."
    },
    {
      "Time_Start": 737.4399999999999,
      "Time_End": 744.0799999999999,
      "Text": " So this is how it looks, you see that there is a list of messages, nothing special."
    },
    {
      "Time_Start": 744.0799999999999,
      "Time_End": 748.7199999999999,
      "Text": " This is the preview of an email sent."
    },
    {
      "Time_Start": 748.72,
      "Time_End": 753.4200000000001,
      "Text": " We see that we have headers, content, nothing special still."
    },
    {
      "Time_Start": 753.4200000000001,
      "Time_End": 754.96,
      "Text": " What about the features?"
    },
    {
      "Time_Start": 754.96,
      "Time_End": 763.2,
      "Text": " One of the features, you can view the blocked email content and this point my attention,"
    },
    {
      "Time_Start": 763.2,
      "Time_End": 770.6,
      "Text": " because you are viewing a content of the email that was classified as potentially malicious."
    },
    {
      "Time_Start": 770.6,
      "Time_End": 778.32,
      "Text": " Keep going, you are viewing content of the email in HTML."
    },
    {
      "Time_Start": 778.9200000000001,
      "Time_End": 785.5200000000001,
      "Text": " Why do you even try to render potentially malicious emails in real HTML?"
    },
    {
      "Time_Start": 785.5200000000001,
      "Time_End": 790.8000000000001,
      "Text": " Because you are not in Outlook, you are in browser."
    },
    {
      "Time_Start": 790.8000000000001,
      "Time_End": 792.48,
      "Text": " About the bug we found."
    },
    {
      "Time_Start": 792.48,
      "Time_End": 798.5200000000001,
      "Text": " In PEM web interface, when the email content is displayed, there is literally no limit."
    },
    {
      "Time_Start": 798.52,
      "Time_End": 809.0799999999999,
      "Text": " Even Outlook is more restricted in the way of rendering HTML, running JavaScript."
    },
    {
      "Time_Start": 809.0799999999999,
      "Time_End": 810.12,
      "Text": " What is funny?"
    },
    {
      "Time_Start": 810.12,
      "Time_End": 817.64,
      "Text": " You can craft the email that will click deliver myself when viewing the email, when the victim"
    },
    {
      "Time_Start": 817.64,
      "Time_End": 820.96,
      "Text": " is viewing the email."
    },
    {
      "Time_Start": 820.96,
      "Time_End": 827.4,
      "Text": " One thing, the security policy of the browser may be less restrictive because the PEM, this"
    },
    {
      "Time_Start": 827.4,
      "Time_End": 832.48,
      "Text": " web interface is served from the intranet, so you already managed to bypass those, all"
    },
    {
      "Time_Start": 832.48,
      "Time_End": 837.4,
      "Text": " those firewalls, proxy servers and stuff that is filtering the malicious traffic."
    },
    {
      "Time_Start": 837.4,
      "Time_End": 842.48,
      "Text": " You just deliver and render it in the browser in the intranet."
    },
    {
      "Time_Start": 842.48,
      "Time_End": 846.0,
      "Text": " But there is one condition."
    },
    {
      "Time_Start": 846.0,
      "Time_End": 850.3199999999999,
      "Text": " Your email need to be classified as spam or malicious."
    },
    {
      "Time_Start": 850.3199999999999,
      "Time_End": 854.1999999999999,
      "Text": " How would you do it?"
    },
    {
      "Time_Start": 854.2,
      "Time_End": 859.36,
      "Text": " I just put a lot of pennies and Viagra into the email and it worked."
    },
    {
      "Time_Start": 859.36,
      "Time_End": 866.5200000000001,
      "Text": " Every single email containing this stuff is marked as spam, pharmaceuticals."
    },
    {
      "Time_Start": 866.5200000000001,
      "Time_End": 876.6,
      "Text": " So let's look for the example."
    },
    {
      "Time_Start": 876.6,
      "Time_End": 884.8000000000001,
      "Text": " So we have an email content with URL image loaded from the external web page and the"
    },
    {
      "Time_Start": 884.8000000000001,
      "Time_End": 888.08,
      "Text": " iframe pointing to some resource in the internet."
    },
    {
      "Time_Start": 888.08,
      "Time_End": 892.76,
      "Text": " We are sending that, this is how it looks in the PEM."
    },
    {
      "Time_Start": 892.76,
      "Time_End": 895.5600000000001,
      "Text": " So everything was rendered, the content was downloaded."
    },
    {
      "Time_Start": 895.5600000000001,
      "Time_End": 903.32,
      "Text": " Of course, the user needed access to outgoing traffic but there was an attempt to fetch"
    },
    {
      "Time_Start": 903.32,
      "Time_End": 906.5600000000001,
      "Text": " the content."
    },
    {
      "Time_Start": 906.5600000000001,
      "Time_End": 915.1600000000001,
      "Text": " Inside the source of the web page there is a plain HTML, so you can do anything."
    },
    {
      "Time_Start": 915.1600000000001,
      "Time_End": 926.5600000000001,
      "Text": " For example, you can do a JavaScript injection into this interface, but OK, XSS is not fun."
    },
    {
      "Time_Start": 926.5600000000001,
      "Time_End": 928.96,
      "Text": " Let's go deeper."
    },
    {
      "Time_Start": 928.96,
      "Time_End": 935.2,
      "Text": " How do you handle the email with attachment and the attachment is the graphic file that"
    },
    {
      "Time_Start": 935.2,
      "Time_End": 938.0,
      "Text": " is rendered inside the email?"
    },
    {
      "Time_Start": 938.0,
      "Time_End": 942.44,
      "Text": " Anybody of you knows how to do it?"
    },
    {
      "Time_Start": 942.44,
      "Time_End": 950.0400000000001,
      "Text": " So you can try to embed external resources, so like load this image from cdn.com, whatever."
    },
    {
      "Time_Start": 950.0400000000001,
      "Time_End": 957.48,
      "Text": " You can add inline attachments like base64 encoded inline image, but the content of the"
    },
    {
      "Time_Start": 957.48,
      "Time_End": 960.5600000000001,
      "Text": " body of the HTML is growing really fast then."
    },
    {
      "Time_Start": 960.5600000000001,
      "Time_End": 967.6,
      "Text": " And you can use something called CID URI scheme, so in the email body you can make"
    },
    {
      "Time_Start": 967.6,
      "Time_End": 970.5600000000001,
      "Text": " a reference to attachments."
    },
    {
      "Time_Start": 970.5600000000001,
      "Time_End": 974.6400000000001,
      "Text": " Very tricky, very like 80s."
    },
    {
      "Time_Start": 974.6400000000001,
      "Time_End": 977.6800000000001,
      "Text": " So following RFC, it looks like that."
    },
    {
      "Time_Start": 977.6800000000001,
      "Time_End": 985.4000000000001,
      "Text": " So we are creating URL to CID double dot and the name of the resource and later on you"
    },
    {
      "Time_Start": 985.4,
      "Time_End": 993.4399999999999,
      "Text": " just need to name the attachment, content ID equals full bar or whatever."
    },
    {
      "Time_Start": 993.4399999999999,
      "Time_End": 999.0799999999999,
      "Text": " But how will you do it in the real browser in the HTML mode?"
    },
    {
      "Time_Start": 999.0799999999999,
      "Time_End": 1005.16,
      "Text": " Because when you are rendering email in the browser, you don't have the attachments."
    },
    {
      "Time_Start": 1005.16,
      "Time_End": 1015.1999999999999,
      "Text": " So you need to like fix those, the browser don't know how to handle CID URI scheme."
    },
    {
      "Time_Start": 1016.0,
      "Time_End": 1018.1600000000001,
      "Text": " Let's make a test."
    },
    {
      "Time_Start": 1018.1600000000001,
      "Time_End": 1026.16,
      "Text": " So we send a message with image source equals CID blah, blah, blah and there was an attached"
    },
    {
      "Time_Start": 1026.16,
      "Time_End": 1029.24,
      "Text": " image at the end here."
    },
    {
      "Time_Start": 1029.24,
      "Time_End": 1031.04,
      "Text": " What was the effect?"
    },
    {
      "Time_Start": 1031.04,
      "Time_End": 1035.28,
      "Text": " The neon card was rendered inside the HTML mode."
    },
    {
      "Time_Start": 1035.28,
      "Time_End": 1042.56,
      "Text": " So some magic happened at the bottom of the server."
    },
    {
      "Time_Start": 1042.56,
      "Time_End": 1051.56,
      "Text": " So you can see that the URL, the CID was replaced with the path to some file on the"
    },
    {
      "Time_Start": 1051.56,
      "Time_End": 1055.04,
      "Text": " web server."
    },
    {
      "Time_Start": 1055.04,
      "Time_End": 1061.6399999999999,
      "Text": " So you're literally storing the attachments on the web server and then presenting them"
    },
    {
      "Time_Start": 1061.6399999999999,
      "Time_End": 1062.6399999999999,
      "Text": " to the user."
    },
    {
      "Time_Start": 1062.6399999999999,
      "Time_End": 1066.48,
      "Text": " Okay, let's try to exploit that."
    },
    {
      "Time_Start": 1066.48,
      "Time_End": 1072.3799999999999,
      "Text": " We created the email, this is the important part."
    },
    {
      "Time_Start": 1073.2,
      "Time_End": 1079.74,
      "Text": " The email contains iframe and the iframe is leading you normally to the attachment."
    },
    {
      "Time_Start": 1079.74,
      "Time_End": 1083.2600000000002,
      "Text": " But in HTML, in browser, it will not work."
    },
    {
      "Time_Start": 1083.2600000000002,
      "Time_End": 1088.1000000000001,
      "Text": " So what we'll get, okay, and this is the attachment."
    },
    {
      "Time_Start": 1088.1000000000001,
      "Time_End": 1094.5400000000002,
      "Text": " Please notice the original file name, this is JSP file, not GIF, not PNG, not graphic"
    },
    {
      "Time_Start": 1094.5400000000002,
      "Time_End": 1096.6200000000001,
      "Text": " file."
    },
    {
      "Time_Start": 1096.6200000000001,
      "Time_End": 1099.3200000000002,
      "Text": " Let's try to render it."
    },
    {
      "Time_Start": 1099.32,
      "Time_End": 1104.08,
      "Text": " And if you decode base64, this is something that you can find in the internet, like a"
    },
    {
      "Time_Start": 1104.08,
      "Time_End": 1106.8799999999999,
      "Text": " web show."
    },
    {
      "Time_Start": 1106.8799999999999,
      "Time_End": 1111.6799999999998,
      "Text": " So when you open the email in the browser, it looks like that."
    },
    {
      "Time_Start": 1111.6799999999998,
      "Time_End": 1117.56,
      "Text": " And okay, very interesting, guys, type the first command that you type in the unknown"
    },
    {
      "Time_Start": 1117.56,
      "Time_End": 1119.3999999999999,
      "Text": " environment."
    },
    {
      "Time_Start": 1119.3999999999999,
      "Time_End": 1120.3999999999999,
      "Text": " Some propositions?"
    },
    {
      "Time_Start": 1120.3999999999999,
      "Time_End": 1121.3999999999999,
      "Text": " ID, yes, exactly."
    },
    {
      "Time_Start": 1121.3999999999999,
      "Time_End": 1122.3999999999999,
      "Text": " Who am I?"
    },
    {
      "Time_Start": 1122.3999999999999,
      "Time_End": 1123.3999999999999,
      "Text": " Like, am I nobody?"
    },
    {
      "Time_Start": 1123.3999999999999,
      "Time_End": 1124.3999999999999,
      "Text": " No, you are rude."
    },
    {
      "Time_Start": 1124.4,
      "Time_End": 1137.48,
      "Text": " So, basically, to root this appliance, you need to send yourself an email with a lot"
    },
    {
      "Time_Start": 1137.48,
      "Time_End": 1142.2800000000002,
      "Text": " of spam and Viagra and iframe."
    },
    {
      "Time_Start": 1142.2800000000002,
      "Time_End": 1147.2800000000002,
      "Text": " But they fixed that, hopefully."
    },
    {
      "Time_Start": 1147.2800000000002,
      "Time_End": 1152.1200000000001,
      "Text": " New versions, they will not implement it again in the new version."
    },
    {
      "Time_Start": 1152.1200000000001,
      "Time_End": 1153.1200000000001,
      "Text": " Another bug."
    },
    {
      "Time_Start": 1153.1200000000001,
      "Time_End": 1154.1200000000001,
      "Text": " Bug number three."
    },
    {
      "Time_Start": 1154.1200000000001,
      "Time_End": 1161.8000000000002,
      "Text": " I was setting up a web server running on a local host on some random high port."
    },
    {
      "Time_Start": 1161.8000000000002,
      "Time_End": 1166.5600000000002,
      "Text": " Normal daily job, you're developing a tool, tool is serving HTML page, you're starting"
    },
    {
      "Time_Start": 1166.5600000000002,
      "Time_End": 1169.44,
      "Text": " a web server in Python, Java, whatever."
    },
    {
      "Time_Start": 1169.44,
      "Time_End": 1177.2,
      "Text": " And I open a corporate browser, Internet Explorer, of course, type in HTTP blah, blah, blah,"
    },
    {
      "Time_Start": 1177.2,
      "Time_End": 1181.3600000000001,
      "Text": " hit enter, and Internet cannot display the page."
    },
    {
      "Time_Start": 1181.3600000000001,
      "Time_End": 1185.0400000000002,
      "Text": " What the fuck is going on?"
    },
    {
      "Time_Start": 1185.0400000000002,
      "Time_End": 1188.64,
      "Text": " This is the normal user reaction."
    },
    {
      "Time_Start": 1188.64,
      "Time_End": 1194.88,
      "Text": " And ticket to the IT, but I'm not the IT guy, I'm the security guy, okay?"
    },
    {
      "Time_Start": 1194.88,
      "Time_End": 1201.3200000000002,
      "Text": " A lot of FSCK, netstat and debugging later, a very obvious conclusion."
    },
    {
      "Time_Start": 1201.3200000000002,
      "Time_End": 1205.92,
      "Text": " Any hints from the audience?"
    },
    {
      "Time_Start": 1205.92,
      "Time_End": 1209.2400000000002,
      "Text": " No."
    },
    {
      "Time_Start": 1209.2400000000002,
      "Time_End": 1211.1200000000001,
      "Text": " I set up a proxy in the wrong way."
    },
    {
      "Time_Start": 1211.88,
      "Time_End": 1215.3600000000001,
      "Text": " I didn't check the box, bypass proxy server for local addresses."
    },
    {
      "Time_Start": 1215.3600000000001,
      "Time_End": 1223.8000000000002,
      "Text": " So the question is, where did my HTTP request go?"
    },
    {
      "Time_Start": 1223.8000000000002,
      "Time_End": 1227.1200000000001,
      "Text": " So we are launching HTTP request here."
    },
    {
      "Time_Start": 1227.1200000000001,
      "Time_End": 1232.2800000000002,
      "Text": " It is forwarded to proxy because this is the standard setup, proxy is receiving all the"
    },
    {
      "Time_Start": 1232.2800000000002,
      "Time_End": 1234.8000000000002,
      "Text": " HTTP requests."
    },
    {
      "Time_Start": 1234.8000000000002,
      "Time_End": 1240.44,
      "Text": " And the proxy is thinking, where is the local host for me?"
    },
    {
      "Time_Start": 1240.44,
      "Time_End": 1246.72,
      "Text": " Of course, the local host is the proxy itself, but still, to be able to do something with"
    },
    {
      "Time_Start": 1246.72,
      "Time_End": 1252.6000000000001,
      "Text": " that, you need a TCP port to be open, you need something to be listening on the local"
    },
    {
      "Time_Start": 1252.6000000000001,
      "Time_End": 1253.6000000000001,
      "Text": " host."
    },
    {
      "Time_Start": 1253.6000000000001,
      "Time_End": 1260.44,
      "Text": " Sorry for hand notes, but I was researching that with old school techniques."
    },
    {
      "Time_Start": 1260.44,
      "Time_End": 1264.4,
      "Text": " This is the list of the ports that were open on the local host."
    },
    {
      "Time_Start": 1264.4,
      "Time_End": 1268.88,
      "Text": " Some of them were like TLS wrappers for others, etc., etc."
    },
    {
      "Time_Start": 1268.88,
      "Time_End": 1276.8400000000001,
      "Text": " So 20 or more TCP ports, I think half of them answering with HTTP."
    },
    {
      "Time_Start": 1276.8400000000001,
      "Time_End": 1280.7600000000002,
      "Text": " So we already got HTTP."
    },
    {
      "Time_Start": 1280.7600000000002,
      "Time_End": 1282.4,
      "Text": " So this is the example of the exploit."
    },
    {
      "Time_Start": 1282.4,
      "Time_End": 1291.2,
      "Text": " You are sending HTTP request to a local host port 8880 using your corporate browser."
    },
    {
      "Time_Start": 1291.2,
      "Time_End": 1294.96,
      "Text": " Just you mistype the one setting."
    },
    {
      "Time_Start": 1294.96,
      "Time_End": 1298.48,
      "Text": " And you get the configuration of the appliance."
    },
    {
      "Time_Start": 1298.48,
      "Time_End": 1304.24,
      "Text": " And of course, everything was running as root, so you need to find a valid method."
    },
    {
      "Time_Start": 1304.24,
      "Time_End": 1311.48,
      "Text": " So with the lowest possible user rights on the endpoint, you are able to exploit the"
    },
    {
      "Time_Start": 1311.48,
      "Time_End": 1314.28,
      "Text": " web gateway this way."
    },
    {
      "Time_Start": 1314.28,
      "Time_End": 1318.84,
      "Text": " And they fixed that, luckily."
    },
    {
      "Time_Start": 1318.84,
      "Time_End": 1319.84,
      "Text": " Bug number four."
    },
    {
      "Time_Start": 1319.84,
      "Time_End": 1323.8,
      "Text": " But first, a short story."
    },
    {
      "Time_Start": 1323.8,
      "Time_End": 1331.0,
      "Text": " At some point of the time, I received the email, how can we change the font of the disclaimer"
    },
    {
      "Time_Start": 1331.0,
      "Time_End": 1335.44,
      "Text": " that is attached at the end of each email?"
    },
    {
      "Time_Start": 1335.44,
      "Time_End": 1340.76,
      "Text": " So some of you probably work in the great big corporation, and you know that when the"
    },
    {
      "Time_Start": 1340.76,
      "Time_End": 1343.6399999999999,
      "Text": " email is going out, you need a disclaimer."
    },
    {
      "Time_Start": 1343.6399999999999,
      "Time_End": 1346.8,
      "Text": " This message needs to be delivered to recipient only."
    },
    {
      "Time_Start": 1346.8,
      "Time_End": 1351.6,
      "Text": " If you are not recipient and reading this email, please delete this email and our lawyers"
    },
    {
      "Time_Start": 1351.68,
      "Time_End": 1353.68,
      "Text": " will contact you, blah, blah, blah."
    },
    {
      "Time_Start": 1353.68,
      "Time_End": 1355.68,
      "Text": " A huge portion of the text."
    },
    {
      "Time_Start": 1355.68,
      "Time_End": 1361.2800000000002,
      "Text": " Yes, yes, yes, you need to protect the environment, don't print this email, blah, blah, blah,"
    },
    {
      "Time_Start": 1361.2800000000002,
      "Time_End": 1367.0800000000002,
      "Text": " save people, don't make harm, whatever."
    },
    {
      "Time_Start": 1367.0800000000002,
      "Time_End": 1368.0800000000002,
      "Text": " First question."
    },
    {
      "Time_Start": 1368.0800000000002,
      "Time_End": 1372.5600000000002,
      "Text": " Why did it reach me?"
    },
    {
      "Time_Start": 1372.5600000000002,
      "Time_End": 1377.92,
      "Text": " I am not the guy responsible for the color of the font in the disclaimer."
    },
    {
      "Time_Start": 1378.24,
      "Time_End": 1384.3200000000002,
      "Text": " Literally, this is quite obvious, you change the font, you go to the UX developer, ask"
    },
    {
      "Time_Start": 1384.3200000000002,
      "Time_End": 1393.04,
      "Text": " them for a piece of HTML code with different color, everything should be working, but yes."
    },
    {
      "Time_Start": 1393.04,
      "Time_End": 1394.04,
      "Text": " One remark."
    },
    {
      "Time_Start": 1394.04,
      "Time_End": 1398.64,
      "Text": " My team is known in our corporation as the people that know how those tiny things in"
    },
    {
      "Time_Start": 1398.64,
      "Time_End": 1400.44,
      "Text": " the computer works."
    },
    {
      "Time_Start": 1400.44,
      "Time_End": 1405.44,
      "Text": " It sounds trivial, but we often receive a lot of, maybe not a lot of, we often receive"
    },
    {
      "Time_Start": 1405.44,
      "Time_End": 1414.3200000000002,
      "Text": " a request like, okay, nobody knows how the stuff is working, maybe you have a slightly"
    },
    {
      "Time_Start": 1414.3200000000002,
      "Time_End": 1418.2,
      "Text": " idea how this is working, how to fix that."
    },
    {
      "Time_Start": 1418.2,
      "Time_End": 1422.1200000000001,
      "Text": " So this is the normal way how the email is going out."
    },
    {
      "Time_Start": 1422.1200000000001,
      "Time_End": 1428.1200000000001,
      "Text": " So the PC is contacting Exchange on any other mail server, mail server is sending it to"
    },
    {
      "Time_Start": 1428.1200000000001,
      "Time_End": 1435.88,
      "Text": " the world by mail filtering, so for example, this mail gateway appliance."
    },
    {
      "Time_Start": 1435.88,
      "Time_End": 1438.8400000000001,
      "Text": " And of course, you have a bonus, you have servers."
    },
    {
      "Time_Start": 1438.8400000000001,
      "Time_End": 1445.0800000000002,
      "Text": " And because of legacy reasons, because of change of the environment, because of whatever,"
    },
    {
      "Time_Start": 1445.0800000000002,
      "Time_End": 1450.0800000000002,
      "Text": " whatever, servers are sending emails, not to the single point, but they are like, some"
    },
    {
      "Time_Start": 1450.0800000000002,
      "Time_End": 1456.0400000000002,
      "Text": " of them are connected to Exchange, some are connected to a web gateway, some are like"
    },
    {
      "Time_Start": 1456.04,
      "Time_End": 1460.12,
      "Text": " sending emails by, I don't know."
    },
    {
      "Time_Start": 1460.12,
      "Time_End": 1472.04,
      "Text": " So it happens that we identify that the disclaimer is attached on this mail gateway."
    },
    {
      "Time_Start": 1472.04,
      "Time_End": 1477.44,
      "Text": " In the Triton, so in this fancy interface that you configure everything, you are able"
    },
    {
      "Time_Start": 1477.44,
      "Time_End": 1483.12,
      "Text": " to edit the content of the disclaimer, but you are not able to change the style."
    },
    {
      "Time_Start": 1483.1200000000001,
      "Time_End": 1487.7600000000002,
      "Text": " So you can put the Polish version, the English version, there is no limit on the length,"
    },
    {
      "Time_Start": 1487.7600000000002,
      "Time_End": 1497.0400000000002,
      "Text": " so you can like put the environment, disclaimer, the privacy, whatever you want there."
    },
    {
      "Time_Start": 1497.0400000000002,
      "Time_End": 1502.92,
      "Text": " We are counting on the fact that, okay, maybe it is not doable from the interface, maybe"
    },
    {
      "Time_Start": 1502.92,
      "Time_End": 1506.0400000000002,
      "Text": " there is a config file or whatever."
    },
    {
      "Time_Start": 1506.04,
      "Time_End": 1514.0,
      "Text": " So we will be able to change the config file and then the font will go from blue to silver."
    },
    {
      "Time_Start": 1514.0,
      "Time_End": 1523.6,
      "Text": " Because we already got root, we made a very short one-liner that will try to find the"
    },
    {
      "Time_Start": 1523.6,
      "Time_End": 1528.0,
      "Text": " file where the configuration of the color of the font is."
    },
    {
      "Time_Start": 1528.0,
      "Time_End": 1534.8799999999999,
      "Text": " So we run it and luckily it was hard-coded in the binary file, but okay, so we failed."
    },
    {
      "Time_Start": 1534.88,
      "Time_End": 1541.16,
      "Text": " But they already led us into the server, so let's type some comments."
    },
    {
      "Time_Start": 1541.16,
      "Time_End": 1549.72,
      "Text": " Let's see what is happening in the kernel, the mask."
    },
    {
      "Time_Start": 1549.72,
      "Time_End": 1553.5200000000002,
      "Text": " You have 1000 segfaults in your logs, okay?"
    },
    {
      "Time_Start": 1553.5200000000002,
      "Time_End": 1562.24,
      "Text": " This is normal people reaction is something is crashing, something is crashing, IT needs"
    },
    {
      "Time_Start": 1562.24,
      "Time_End": 1570.08,
      "Text": " to fix it, but we are, again, we are not the normal people, we are the security guys."
    },
    {
      "Time_Start": 1570.08,
      "Time_End": 1578.92,
      "Text": " So we see that something is wrong, literally wrong there."
    },
    {
      "Time_Start": 1578.92,
      "Time_End": 1582.08,
      "Text": " We knew that stuff is crashing, but we didn't know where."
    },
    {
      "Time_Start": 1582.08,
      "Time_End": 1592.9199999999998,
      "Text": " So from the logs we saw that process name kvoop is crashing in this library."
    },
    {
      "Time_Start": 1592.9199999999998,
      "Time_End": 1597.6399999999999,
      "Text": " This process is created by process called filter and process filter is created by some"
    },
    {
      "Time_Start": 1597.6399999999999,
      "Time_End": 1599.96,
      "Text": " modified postfix version."
    },
    {
      "Time_Start": 1599.96,
      "Time_End": 1609.1999999999998,
      "Text": " So okay, we see that probably when the email is filtered, analyzed, something is crashing."
    },
    {
      "Time_Start": 1609.32,
      "Time_End": 1618.4,
      "Text": " So, yeah, related to my processing and we tried to Google for kvoop, mwx, whatever,"
    },
    {
      "Time_Start": 1618.4,
      "Time_End": 1624.72,
      "Text": " and we found out that this is a library developed by HP, the company that is doing the broken"
    },
    {
      "Time_Start": 1624.72,
      "Time_End": 1629.24,
      "Text": " notebooks, sorry."
    },
    {
      "Time_Start": 1629.24,
      "Time_End": 1632.8400000000001,
      "Text": " My personal feeling, I don't like this company."
    },
    {
      "Time_Start": 1632.88,
      "Time_End": 1643.1200000000001,
      "Text": " So they wrote a library and this mwxsr is Microsoft Word XML something reader."
    },
    {
      "Time_Start": 1643.1200000000001,
      "Time_End": 1649.4800000000002,
      "Text": " So it makes sense if you already find it in the internet."
    },
    {
      "Time_Start": 1649.4800000000002,
      "Time_End": 1651.2400000000002,
      "Text": " More Google later."
    },
    {
      "Time_Start": 1651.2400000000002,
      "Time_End": 1657.44,
      "Text": " This is library to parse multiple file formats and extract the content for example for DLP."
    },
    {
      "Time_Start": 1657.44,
      "Time_End": 1662.2400000000002,
      "Text": " So you have, when you are sending dots, it is extracting the content to see that if you"
    },
    {
      "Time_Start": 1662.24,
      "Time_End": 1665.36,
      "Text": " are not shipping the, I don't know, bank secrecy or whatever."
    },
    {
      "Time_Start": 1665.36,
      "Time_End": 1672.4,
      "Text": " You're sending Excel, PDF, many of those file formats."
    },
    {
      "Time_Start": 1672.4,
      "Time_End": 1678.28,
      "Text": " Anybody, when you look on those file formats, anything come to your mind?"
    },
    {
      "Time_Start": 1678.28,
      "Time_End": 1683.8,
      "Text": " A lot of CV was discovered for example by Cisco Talos in those."
    },
    {
      "Time_Start": 1683.8,
      "Time_End": 1691.72,
      "Text": " And for me, like the Adobe itself implementing the PDF format made a lot of mistakes."
    },
    {
      "Time_Start": 1691.72,
      "Time_End": 1698.28,
      "Text": " If you are making a product that is implementing PDF, .zip, every file format that were exploited"
    },
    {
      "Time_Start": 1698.28,
      "Time_End": 1705.16,
      "Text": " over a few years, you're brave."
    },
    {
      "Time_Start": 1705.16,
      "Time_End": 1710.2,
      "Text": " Going back to the segfaults, they were crashing when they were trying to access the memory"
    },
    {
      "Time_Start": 1710.2,
      "Time_End": 1711.88,
      "Text": " at the addresses like that."
    },
    {
      "Time_Start": 1711.88,
      "Time_End": 1719.72,
      "Text": " So anybody on the audience, can you tell me what is visible when you look on this hex"
    },
    {
      "Time_Start": 1719.72,
      "Time_End": 1731.72,
      "Text": " characters, 10 seconds, 9, no?"
    },
    {
      "Time_Start": 1731.72,
      "Time_End": 1734.08,
      "Text": " There are strings, ASCII strings."
    },
    {
      "Time_Start": 1734.08,
      "Time_End": 1741.3600000000001,
      "Text": " So 20 is a space, 3A is a big letter, big letter T or something like that."
    },
    {
      "Time_Start": 1741.3600000000001,
      "Time_End": 1748.16,
      "Text": " So every time the process is crashing, it is crashing and when trying to access a memory"
    },
    {
      "Time_Start": 1749.0,
      "Time_End": 1750.4,
      "Text": " where the address is ASCII."
    },
    {
      "Time_Start": 1750.4,
      "Time_End": 1756.48,
      "Text": " So this is clearly something wrong with parsing documents."
    },
    {
      "Time_Start": 1756.48,
      "Time_End": 1761.0800000000002,
      "Text": " And we need to find those emails."
    },
    {
      "Time_Start": 1761.0800000000002,
      "Time_End": 1767.3600000000001,
      "Text": " We managed to find those emails by correlating the date of the crash, date time of the crash"
    },
    {
      "Time_Start": 1767.3600000000001,
      "Time_End": 1772.52,
      "Text": " with the logs from the exchange."
    },
    {
      "Time_Start": 1772.52,
      "Time_End": 1783.48,
      "Text": " Got the rough email with attachment, tried to pass it through the solution, it crashed."
    },
    {
      "Time_Start": 1783.48,
      "Time_End": 1786.48,
      "Text": " So can we repeat that?"
    },
    {
      "Time_Start": 1786.48,
      "Time_End": 1787.48,
      "Text": " Yes."
    },
    {
      "Time_Start": 1787.48,
      "Time_End": 1788.48,
      "Text": " Success."
    },
    {
      "Time_Start": 1788.48,
      "Time_End": 1796.2,
      "Text": " We tried to minimize the corpus because the attachment was a .x document having 60 pages."
    },
    {
      "Time_Start": 1796.2,
      "Time_End": 1802.48,
      "Text": " So clearly not good material for analyzing what is wrong with the parser."
    },
    {
      "Time_Start": 1802.48,
      "Time_End": 1808.56,
      "Text": " We managed to minimize the code almost to one line."
    },
    {
      "Time_Start": 1808.56,
      "Time_End": 1814.0,
      "Text": " So you have the picture inside the word document with a too long description."
    },
    {
      "Time_Start": 1814.0,
      "Time_End": 1820.0,
      "Text": " And the server was crashing when there was too long description, I think 124 characters"
    },
    {
      "Time_Start": 1820.0,
      "Time_End": 1822.96,
      "Text": " or more."
    },
    {
      "Time_Start": 1822.96,
      "Time_End": 1832.72,
      "Text": " Then we need to try to read the faults to understand what is the logic behind."
    },
    {
      "Time_Start": 1832.72,
      "Time_End": 1838.52,
      "Text": " But reading segmentation fault logs is boring, I wrote a code."
    },
    {
      "Time_Start": 1838.52,
      "Time_End": 1842.08,
      "Text": " Normally you see something like that, after parsing you see something like this."
    },
    {
      "Time_Start": 1842.08,
      "Time_End": 1845.08,
      "Text": " This is just a little bit enriched."
    },
    {
      "Time_Start": 1845.08,
      "Time_End": 1853.76,
      "Text": " So first of all we can see that the tool is interpreting the memory address as a string,"
    },
    {
      "Time_Start": 1853.76,
      "Time_End": 1860.08,
      "Text": " so we can dot IS colon here."
    },
    {
      "Time_Start": 1860.08,
      "Time_End": 1865.6999999999998,
      "Text": " Additionally if you give this tool a path to the binaries, so if you extract the binaries"
    },
    {
      "Time_Start": 1865.6999999999998,
      "Time_End": 1874.56,
      "Text": " from the server and put it to the directory when the tool is, it can try to disassemble"
    },
    {
      "Time_Start": 1874.56,
      "Time_End": 1882.0,
      "Text": " the binary file and tell you, okay, this is the line where the assembly code crashed."
    },
    {
      "Time_Start": 1882.0,
      "Time_End": 1894.9199999999998,
      "Text": " In our case we are crashing in the line where this call AX plus some offset."
    },
    {
      "Time_Start": 1894.9199999999998,
      "Time_End": 1901.48,
      "Text": " So the first thing we probably have remote code execution by free because we don't need"
    },
    {
      "Time_Start": 1901.48,
      "Time_End": 1906.96,
      "Text": " the ROOP gadgets or anything else because we already have an instruction that is calling"
    },
    {
      "Time_Start": 1906.96,
      "Time_End": 1913.72,
      "Text": " the address that we control."
    },
    {
      "Time_Start": 1913.72,
      "Time_End": 1922.84,
      "Text": " So few hours later we will manage to develop exploit, the input was that we are putting"
    },
    {
      "Time_Start": 1922.84,
      "Time_End": 1929.0,
      "Text": " in the address what we want to call and later on the server, the software is crashing just"
    },
    {
      "Time_Start": 1929.0,
      "Time_End": 1931.48,
      "Text": " at this address."
    },
    {
      "Time_Start": 1931.48,
      "Time_End": 1937.72,
      "Text": " And of course everything was running as root, so exploited."
    },
    {
      "Time_Start": 1937.72,
      "Time_End": 1944.6,
      "Text": " What is very funny, to trigger this bug you don't need anything because you need to send"
    },
    {
      "Time_Start": 1944.6,
      "Time_End": 1951.32,
      "Text": " the email with attachment to even not existing email in the corporation that is protected"
    },
    {
      "Time_Start": 1951.32,
      "Time_End": 1953.76,
      "Text": " with this solution."
    },
    {
      "Time_Start": 1953.76,
      "Time_End": 1958.72,
      "Text": " So you just prepare the exploit, send it randomly and you take over the control of"
    },
    {
      "Time_Start": 1958.72,
      "Time_End": 1963.32,
      "Text": " the mail gateway of the whole company."
    },
    {
      "Time_Start": 1963.32,
      "Time_End": 1966.36,
      "Text": " Luckily they fixed that."
    },
    {
      "Time_Start": 1966.36,
      "Time_End": 1971.44,
      "Text": " Closing credits, the summary."
    },
    {
      "Time_Start": 1971.44,
      "Time_End": 1976.16,
      "Text": " We did not perform a penetration test of the solution, so everything we discovered was"
    },
    {
      "Time_Start": 1976.16,
      "Time_End": 1981.72,
      "Text": " discovered by accident, like we misconfigured the proxy."
    },
    {
      "Time_Start": 1981.72,
      "Time_End": 1988.24,
      "Text": " All bugs were discovered by curiosity and accidents as I say."
    },
    {
      "Time_Start": 1988.24,
      "Time_End": 1994.0,
      "Text": " Everything seriously, everything on every each component of this solution was running"
    },
    {
      "Time_Start": 1994.0,
      "Time_End": 2000.16,
      "Text": " as root with one exception, there was a Postgres database running locally and the Postgres"
    },
    {
      "Time_Start": 2000.16,
      "Time_End": 2005.76,
      "Text": " database was running on the Postgres user just because the Postgres out of the box is"
    },
    {
      "Time_Start": 2005.76,
      "Time_End": 2009.08,
      "Text": " dropping the privileges, but everything else was running as root."
    },
    {
      "Time_Start": 2009.1200000000001,
      "Time_End": 2014.4,
      "Text": " So if you take over any kind of piece of this solution, you are root."
    },
    {
      "Time_Start": 2014.4,
      "Time_End": 2021.0400000000002,
      "Text": " We managed to break version 8.1, there is 8.5."
    },
    {
      "Time_Start": 2021.0400000000002,
      "Time_End": 2027.2400000000002,
      "Text": " A lot, a lot, seriously a lot was improved inside and a lot was fixed, not even stuff"
    },
    {
      "Time_Start": 2027.2400000000002,
      "Time_End": 2029.8000000000002,
      "Text": " that we reported."
    },
    {
      "Time_Start": 2029.8000000000002,
      "Time_End": 2035.2,
      "Text": " Conclusion number one, never, please, if you have any influence on the developers, product"
    },
    {
      "Time_Start": 2035.24,
      "Time_End": 2038.92,
      "Text": " managers, never run stuff as a root."
    },
    {
      "Time_Start": 2038.92,
      "Time_End": 2046.2,
      "Text": " You have thousands of ways to elevate the privileges if your solution is needing that,"
    },
    {
      "Time_Start": 2046.2,
      "Time_End": 2054.12,
      "Text": " but never run stuff as a root, because this defense in depth methodology said, okay, drop"
    },
    {
      "Time_Start": 2054.12,
      "Time_End": 2059.68,
      "Text": " the privileges, limit the access, limit the scope, if you need read-only access, work"
    },
    {
      "Time_Start": 2059.68,
      "Time_End": 2065.6,
      "Text": " as a user that has only read-only access, not as the most privileged account on your"
    },
    {
      "Time_Start": 2065.6,
      "Time_End": 2067.12,
      "Text": " system."
    },
    {
      "Time_Start": 2067.12,
      "Time_End": 2076.12,
      "Text": " Never, never, never trust user input, especially if you just classify this user input as malicious."
    },
    {
      "Time_Start": 2076.12,
      "Time_End": 2078.44,
      "Text": " This is quite obvious."
    },
    {
      "Time_Start": 2078.44,
      "Time_End": 2080.96,
      "Text": " Don't ignore your crashes."
    },
    {
      "Time_Start": 2080.96,
      "Time_End": 2085.3199999999997,
      "Text": " The piece that was missing on those servers was a process, for example, that was looking"
    },
    {
      "Time_Start": 2085.32,
      "Time_End": 2092.6400000000003,
      "Text": " if something crashed and then reporting this crash back to a vendor and say, okay, our"
    },
    {
      "Time_Start": 2092.6400000000003,
      "Time_End": 2094.2000000000003,
      "Text": " solution is broken."
    },
    {
      "Time_Start": 2094.2000000000003,
      "Time_End": 2103.0800000000004,
      "Text": " What is funny, when the mail analyzer crashed, it was marking the email as clean, so additionally"
    },
    {
      "Time_Start": 2103.0800000000004,
      "Time_End": 2110.6000000000004,
      "Text": " to exploiting the web server, the email got passed through all the detection mechanism."
    },
    {
      "Time_Start": 2110.6,
      "Time_End": 2115.64,
      "Text": " Keep your API under control, authorize calls, all of them, even if you expose API on the"
    },
    {
      "Time_Start": 2115.64,
      "Time_End": 2121.72,
      "Text": " local host, you never know who is on the local host and you never know when you will by accident"
    },
    {
      "Time_Start": 2121.72,
      "Time_End": 2130.24,
      "Text": " expose the API to the local or wide network."
    },
    {
      "Time_Start": 2130.24,
      "Time_End": 2134.96,
      "Text": " If you are implementing parsers of complex file format, good luck with that, Adobe had"
    },
    {
      "Time_Start": 2134.96,
      "Time_End": 2135.96,
      "Text": " a problem with that."
    },
    {
      "Time_Start": 2136.32,
      "Time_End": 2143.4,
      "Text": " If you are implementing parsers with many, many complex files, you are seriously crazy"
    },
    {
      "Time_Start": 2143.4,
      "Time_End": 2147.2,
      "Text": " and very brave."
    },
    {
      "Time_Start": 2147.2,
      "Time_End": 2153.16,
      "Text": " And final conclusion, if you claim to have bug reporting program, handle it."
    },
    {
      "Time_Start": 2153.16,
      "Time_End": 2159.7200000000003,
      "Text": " Forcepoint on the official webpage is claiming to have the product security incident response"
    },
    {
      "Time_Start": 2159.7200000000003,
      "Time_End": 2165.94,
      "Text": " team and on the description it is said that this is the team that is dedicated for receiving"
    },
    {
      "Time_Start": 2165.94,
      "Time_End": 2172.62,
      "Text": " a feedback about the products, about the vulnerabilities, about the misconfiguration,"
    },
    {
      "Time_Start": 2172.62,
      "Time_End": 2177.06,
      "Text": " misfunctionality and handling it."
    },
    {
      "Time_Start": 2177.06,
      "Time_End": 2183.58,
      "Text": " Three tips, evaluate the submission, give the feedback to the guy that is reporting,"
    },
    {
      "Time_Start": 2183.58,
      "Time_End": 2189.9,
      "Text": " be responsive, be precise, tell exactly what is going on right now, because we just put"
    },
    {
      "Time_Start": 2189.9,
      "Time_End": 2195.14,
      "Text": " those emails with the reports to the black hole, we didn't receive, in my opinion, any"
    },
    {
      "Time_Start": 2195.14,
      "Time_End": 2200.06,
      "Text": " constructive response from them and be honest, if you, for example, not planning to fix"
    },
    {
      "Time_Start": 2200.06,
      "Time_End": 2204.94,
      "Text": " it because in the two months you are releasing a new version, tell it to the researcher,"
    },
    {
      "Time_Start": 2204.94,
      "Time_End": 2210.3799999999997,
      "Text": " because we didn't know what is happening, especially that for a very short period of"
    },
    {
      "Time_Start": 2210.3799999999997,
      "Time_End": 2219.8199999999997,
      "Text": " time we were using this version, this version with a lot of remote root vulnerabilities."
    },
    {
      "Time_Start": 2219.9,
      "Time_End": 2225.26,
      "Text": " And my personal feeling about the whole experiment."
    },
    {
      "Time_Start": 2225.26,
      "Time_End": 2226.78,
      "Text": " Thank you very much, that's all."
    },
    {
      "Time_Start": 2226.78,
      "Time_End": 2227.78,
      "Text": " If you have questions..."
    },
    {
      "Time_Start": 2235.78,
      "Time_End": 2236.78,
      "Text": " Any questions?"
    },
    {
      "Time_Start": 2250.78,
      "Time_End": 2258.78,
      "Text": " Hi, I've got a quick question regarding this memory corruption, there were no ISLR, right?"
    },
    {
      "Time_Start": 2258.78,
      "Time_End": 2259.78,
      "Text": " Because..."
    },
    {
      "Time_Start": 2259.78,
      "Time_End": 2260.78,
      "Text": " No."
    },
    {
      "Time_Start": 2260.78,
      "Time_End": 2263.78,
      "Text": " Yes, okay, so that's all."
    },
    {
      "Time_Start": 2263.78,
      "Time_End": 2272.78,
      "Text": " There was literally no obstacles, so first of all, we did control the instruction pointer,"
    },
    {
      "Time_Start": 2273.7400000000002,
      "Time_End": 2275.7400000000002,
      "Text": " let me go back there."
    },
    {
      "Time_Start": 2278.7400000000002,
      "Time_End": 2282.7400000000002,
      "Text": " Okay, we controlled the instruction pointer because there was a call with a parameter,"
    },
    {
      "Time_Start": 2282.7400000000002,
      "Time_End": 2284.7400000000002,
      "Text": " we controlled the parameter."
    },
    {
      "Time_Start": 2284.7400000000002,
      "Time_End": 2290.7400000000002,
      "Text": " Second, there were a lot of libraries statically, not statically, that were load on the fixed"
    },
    {
      "Time_Start": 2290.7400000000002,
      "Time_End": 2296.7400000000002,
      "Text": " addresses, so we didn't need to guess, for example, addresses, because the legacy libraries"
    },
    {
      "Time_Start": 2296.7400000000002,
      "Time_End": 2299.7400000000002,
      "Text": " were loaded on the same address all the time."
    },
    {
      "Time_Start": 2300.7000000000003,
      "Time_End": 2306.7000000000003,
      "Text": " And second, I don't remember if there were any, I don't know, stack canaries or ISLR"
    },
    {
      "Time_Start": 2306.7000000000003,
      "Time_End": 2313.7000000000003,
      "Text": " there, but it was quite trivial, the only thing that we needed to do is type in to this"
    },
    {
      "Time_Start": 2313.7000000000003,
      "Time_End": 2320.7000000000003,
      "Text": " tool a correct address, and there was a lot of gadgets all around, but you didn't need"
    },
    {
      "Time_Start": 2321.6600000000003,
      "Time_End": 2329.6600000000003,
      "Text": " to build a stack-based ROP chain, because you just need to specify, go there, call this"
    },
    {
      "Time_Start": 2329.6600000000003,
      "Time_End": 2330.6600000000003,
      "Text": " procedure."
    },
    {
      "Time_Start": 2330.6600000000003,
      "Time_End": 2332.6600000000003,
      "Text": " Yes, yes, thank you, thank you for explaining."
    },
    {
      "Time_Start": 2334.6600000000003,
      "Time_End": 2336.6600000000003,
      "Text": " Other questions?"
    },
    {
      "Time_Start": 2337.6600000000003,
      "Time_End": 2344.6600000000003,
      "Text": " Okay, I also noticed that you mentioned that it was a product with many features, you explored"
    },
    {
      "Time_Start": 2345.62,
      "Time_End": 2352.62,
      "Text": " the mailing analysis, have you or your team also explored the just web content analysis,"
    },
    {
      "Time_Start": 2352.62,
      "Time_End": 2359.62,
      "Text": " because I seem to know the product and it also implements the SSL traffic inspection"
    },
    {
      "Time_Start": 2359.62,
      "Time_End": 2360.62,
      "Text": " and so on."
    },
    {
      "Time_Start": 2361.62,
      "Time_End": 2368.62,
      "Text": " Yes, so basically this key view library is used by any kind of channel to do the content"
    },
    {
      "Time_Start": 2369.58,
      "Time_End": 2375.58,
      "Text": " inspection, so you probably, probably we didn't test that, as I mentioned we didn't perform"
    },
    {
      "Time_Start": 2375.58,
      "Time_End": 2377.58,
      "Text": " a penetration test, it was like accident."
    },
    {
      "Time_Start": 2378.58,
      "Time_End": 2385.58,
      "Text": " Probably 99% sure that if you send this .x file, it will also trigger the bug, because"
    },
    {
      "Time_Start": 2385.58,
      "Time_End": 2387.58,
      "Text": " the library underneath is the same."
    },
    {
      "Time_Start": 2388.58,
      "Time_End": 2389.58,
      "Text": " Thank you."
    },
    {
      "Time_Start": 2392.58,
      "Time_End": 2393.58,
      "Text": " Any other questions?"
    },
    {
      "Time_Start": 2394.54,
      "Time_End": 2395.54,
      "Text": " Thanks very much."
    },
    {
      "Time_Start": 2396.54,
      "Time_End": 2402.54,
      "Text": " If you have a question, I will be still here, I will try to put my presentation on the Twitter"
    },
    {
      "Time_Start": 2403.54,
      "Time_End": 2405.54,
      "Text": " on XivCon, so you can have fun at home."
    },
    {
      "Time_Start": 2406.54,
      "Time_End": 2407.54,
      "Text": " Thanks very much."
    }
  ]
}