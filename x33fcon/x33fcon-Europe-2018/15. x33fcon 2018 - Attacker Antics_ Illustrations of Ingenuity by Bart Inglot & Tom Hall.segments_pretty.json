{
  "segments": [
    {
      "Time_Start": 0.0,
      "Time_End": 15.0,
      "Text": "This text was transcribed using whisper model: large-v2\n\n Alright, well, welcome everyone. Hi. I think I'm audible. You can hear me at the back,"
    },
    {
      "Time_Start": 15.0,
      "Time_End": 22.0,
      "Text": " right? You can hear me? Yeah, yeah? Awesome. Right, so the talk is titled Attacker Antics."
    },
    {
      "Time_Start": 22.0,
      "Time_End": 28.0,
      "Text": " Tom and I will be talking about nine different TTPs, so techniques that the attackers use"
    },
    {
      "Time_Start": 28.0,
      "Time_End": 33.0,
      "Text": " quite recently that we found were really sexy, were very interesting, and we were also allowed"
    },
    {
      "Time_Start": 33.0,
      "Time_End": 38.0,
      "Text": " to share them with you. So we put them all together, and there's quite a lot to go through,"
    },
    {
      "Time_Start": 38.0,
      "Time_End": 43.0,
      "Text": " so we might skip certain bits here and there, but all of this stuff is on the slides, and"
    },
    {
      "Time_Start": 43.0,
      "Time_End": 49.0,
      "Text": " the slides will be released. So don't worry, just relax, sit back, and enjoy. Alright,"
    },
    {
      "Time_Start": 49.0,
      "Time_End": 56.0,
      "Text": " so without further ado, I'll let Tom introduce me for a change. So, yeah, this is Bart. He's"
    },
    {
      "Time_Start": 56.0,
      "Time_End": 60.0,
      "Text": " one of our incident response consultants. He's currently based out in Singapore, obviously"
    },
    {
      "Time_Start": 60.0,
      "Time_End": 67.0,
      "Text": " from Poland originally. Can you hear me okay? Yeah? Cool. And we previously worked together"
    },
    {
      "Time_Start": 67.0,
      "Time_End": 73.0,
      "Text": " over in the UK in our management offices and for our previous organisation. He's currently"
    },
    {
      "Time_Start": 73.0,
      "Time_End": 78.0,
      "Text": " trying to learn French to impress his wife, but I hear it's not going too well so far."
    },
    {
      "Time_Start": 78.0,
      "Time_End": 84.0,
      "Text": " That's a brilliant introduction. I probably should have done it myself. Right, and here"
    },
    {
      "Time_Start": 84.0,
      "Time_End": 90.0,
      "Text": " is Tom. So Tom is our senior consultant. He's from England, but based in England as"
    },
    {
      "Time_Start": 90.0,
      "Time_End": 95.0,
      "Text": " well, around London. He's been doing incident response and digital forensics for about seven"
    },
    {
      "Time_Start": 95.0,
      "Time_End": 101.0,
      "Text": " years. He's a big rugby fan, and he's also a keen rock climber. He claims I'm a little"
    },
    {
      "Time_Start": 101.0,
      "Time_End": 107.0,
      "Text": " bit better at climbing, which I really don't buy into, but what do you know? And you can"
    },
    {
      "Time_Start": 107.0,
      "Time_End": 114.0,
      "Text": " catch him on Twitter at THOR underscore SEC. A quick disclosure statement, and that's something"
    },
    {
      "Time_Start": 114.0,
      "Time_End": 118.0,
      "Text": " I need to read out to you. So all case studies and examples are drawn from our experiences"
    },
    {
      "Time_Start": 118.0,
      "Time_End": 123.0,
      "Text": " and activities working for a variety of customers and do not represent our work for any one"
    },
    {
      "Time_Start": 123.0,
      "Time_End": 129.0,
      "Text": " customer or a set of customers. In many cases, facts have been changed to obscure the identity"
    },
    {
      "Time_Start": 129.0,
      "Time_End": 136.0,
      "Text": " of our customers and the individuals associated with our customers. Right, so these are the"
    },
    {
      "Time_Start": 136.0,
      "Time_End": 141.0,
      "Text": " nine TTPs, and we're just going to dive into the first one. Over to you, Tom."
    },
    {
      "Time_Start": 141.0,
      "Time_End": 146.0,
      "Text": " All right, so this is the first one. We're going to go through an incident where we saw"
    },
    {
      "Time_Start": 146.0,
      "Time_End": 152.0,
      "Text": " the AV server used as a deployment mechanism. So what we saw was the attacker using a number"
    },
    {
      "Time_Start": 152.0,
      "Time_End": 157.0,
      "Text": " of backdoors, including one that will be familiar to a lot of you here, obviously a Cobalt Strike."
    },
    {
      "Time_Start": 157.0,
      "Time_End": 161.0,
      "Text": " On the blue team's side, it's quite useful for us. We have a randomized service name"
    },
    {
      "Time_Start": 161.0,
      "Time_End": 166.0,
      "Text": " which we can trigger on. It's calling base 64 encoded PowerShell. It's fairly kind of"
    },
    {
      "Time_Start": 166.0,
      "Time_End": 171.0,
      "Text": " standard stuff, right, but it's useful for the attackers because it's present in memory."
    },
    {
      "Time_Start": 171.0,
      "Time_End": 176.0,
      "Text": " They can kind of move laterally with SMB, but what's really interesting in this instance"
    },
    {
      "Time_Start": 176.0,
      "Time_End": 181.0,
      "Text": " is how they spread the malware across the organization. So obviously we'd seen kind"
    },
    {
      "Time_Start": 181.0,
      "Time_End": 186.0,
      "Text": " of PowerShell being spawned, so we had a look on the network, and what was really interesting"
    },
    {
      "Time_Start": 186.0,
      "Time_End": 192.0,
      "Text": " is we saw that the McAfee EPO service, that's kind of the main distribution point in the"
    },
    {
      "Time_Start": 192.0,
      "Time_End": 199.0,
      "Text": " enterprise for the AV, was serving up a PowerShell script, which you can see just up here,"
    },
    {
      "Time_Start": 199.0,
      "Time_End": 207.0,
      "Text": " running from DLP agent install 0409 kb.ps1. Now, when we looked at the script itself,"
    },
    {
      "Time_Start": 207.0,
      "Time_End": 211.0,
      "Text": " it's quite interesting because we saw that there were similarities between some of the"
    },
    {
      "Time_Start": 211.0,
      "Time_End": 216.0,
      "Text": " Cobalt Strike payloads we'd seen previously. What was really kind of different here is"
    },
    {
      "Time_Start": 216.0,
      "Time_End": 221.0,
      "Text": " we can see from the signature field that it's actually signed by the EPO server itself,"
    },
    {
      "Time_Start": 221.0,
      "Time_End": 226.0,
      "Text": " so they've legitimately got the EPO server to serve this script up."
    },
    {
      "Time_Start": 226.0,
      "Time_End": 232.0,
      "Text": " So looking kind of in the next steps of the investigation, we turn to the EPO server itself"
    },
    {
      "Time_Start": 232.0,
      "Time_End": 237.0,
      "Text": " and kind of obviously surprise, surprise, we found the PowerShell script in the repository"
    },
    {
      "Time_Start": 237.0,
      "Time_End": 241.0,
      "Text": " where we'd previously seen it, and when we were kind of pivoting around, looking around"
    },
    {
      "Time_Start": 241.0,
      "Time_End": 247.0,
      "Text": " what happened at the same time, we saw there was also a RAR file. Now obviously, for us,"
    },
    {
      "Time_Start": 247.0,
      "Time_End": 250.0,
      "Text": " this is quite interesting, it's not something we've really come across before, so we did"
    },
    {
      "Time_Start": 250.0,
      "Time_End": 257.0,
      "Text": " a bit of background research. It turns out in 2013, Jerome Loken gave a talk on effectively"
    },
    {
      "Time_Start": 257.0,
      "Time_End": 263.0,
      "Text": " using AV as a botnet kind of in an organization, so kind of a mass deployment kind of tool,"
    },
    {
      "Time_Start": 263.0,
      "Time_End": 269.0,
      "Text": " and he's provided on GitHub a tool called ePolicyOwner, which is obviously free to grab,"
    },
    {
      "Time_Start": 269.0,
      "Time_End": 273.0,
      "Text": " take a look at it, it's really cool stuff, but it looks like obviously our attackers"
    },
    {
      "Time_Start": 273.0,
      "Time_End": 279.0,
      "Text": " have got some ideas maybe kind of similar to this, so we took kind of a deeper dive"
    },
    {
      "Time_Start": 279.0,
      "Time_End": 285.0,
      "Text": " really into the functionality, and what you can see here is the tool itself is effectively"
    },
    {
      "Time_Start": 285.0,
      "Time_End": 292.0,
      "Text": " putting on a few files, catalog.z, PKG, catalog.z, and essentially kind of serving them up to"
    },
    {
      "Time_Start": 292.0,
      "Time_End": 297.0,
      "Text": " the EPO server and reconfiguring it to kind of take control and serve up any kind of files"
    },
    {
      "Time_Start": 297.0,
      "Time_End": 304.0,
      "Text": " that they want, and using kind of the file command, what it will do is it will create"
    },
    {
      "Time_Start": 304.0,
      "Time_End": 309.0,
      "Text": " a batch script, run.bat, which will basically just serve up any script that you pass to it."
    },
    {
      "Time_Start": 309.0,
      "Time_End": 314.0,
      "Text": " So that's pretty cool, it seems similar, so we go back to the EPO server and we find this"
    },
    {
      "Time_Start": 314.0,
      "Time_End": 319.0,
      "Text": " RAR file, and as you can see here, there's some similarities, right? We've got our catalog.z,"
    },
    {
      "Time_Start": 319.0,
      "Time_End": 324.0,
      "Text": " we've got our PowerShell script that we saw served up over the network, and we've also got"
    },
    {
      "Time_Start": 324.0,
      "Time_End": 329.0,
      "Text": " our run.bat, so it's looking pretty similar so far."
    },
    {
      "Time_Start": 329.0,
      "Time_End": 335.0,
      "Text": " So take a deeper dive, and again look, as we can see, it's effectively launching this PowerShell"
    },
    {
      "Time_Start": 335.0,
      "Time_End": 340.0,
      "Text": " script, running it locally across all the servers, and it's authenticated from the AV,"
    },
    {
      "Time_Start": 340.0,
      "Time_End": 345.0,
      "Text": " so it bypasses most of the security logging you'll probably have in place, and it also gets around"
    },
    {
      "Time_Start": 345.0,
      "Time_End": 350.0,
      "Text": " most of the firewall blocks, right? Because you want to have your AV administered across the enterprise,"
    },
    {
      "Time_Start": 350.0,
      "Time_End": 354.0,
      "Text": " so you're not going to be blocking it from communicating with all your endpoints."
    },
    {
      "Time_Start": 354.0,
      "Time_End": 358.0,
      "Text": " So pretty cool, pretty different."
    },
    {
      "Time_Start": 358.0,
      "Time_End": 363.0,
      "Text": " Thank you, Tom. Right, so the next TCP is called Stealing Secrets from Air-Gapped Networks."
    },
    {
      "Time_Start": 363.0,
      "Time_End": 369.0,
      "Text": " It's based on an investigation that we did for a client who had two physically separate networks."
    },
    {
      "Time_Start": 369.0,
      "Time_End": 374.0,
      "Text": " The first, as we mentioned, was air-gapped, meaning it had no internet connection,"
    },
    {
      "Time_Start": 374.0,
      "Time_End": 380.0,
      "Text": " and the other was their everyday network. And to move data between the two, for convenience reasons,"
    },
    {
      "Time_Start": 380.0,
      "Time_End": 386.0,
      "Text": " they decided to use USB devices, and I think they suspected that someone might be after them,"
    },
    {
      "Time_Start": 386.0,
      "Time_End": 393.0,
      "Text": " so they did research in the local markets and chose a vendor who was selling highly secure USB devices."
    },
    {
      "Time_Start": 393.0,
      "Time_End": 398.0,
      "Text": " And as we looked into it, they worked just like normal devices, but they came with the software"
    },
    {
      "Time_Start": 399.0,
      "Time_End": 405.0,
      "Text": " provided by the vendor, some kind of proprietary software that allowed the user to create encrypted containers,"
    },
    {
      "Time_Start": 405.0,
      "Time_End": 411.0,
      "Text": " a little bit like TrueCrypt, on the device. And so the user could store just any document they wanted"
    },
    {
      "Time_Start": 411.0,
      "Time_End": 417.0,
      "Text": " on the device, and that would be just stored like a typical USB device, but it was also a container"
    },
    {
      "Time_Start": 417.0,
      "Time_End": 423.0,
      "Text": " that was highly secure, as the vendor claimed. And then to open that up, you needed the software"
    },
    {
      "Time_Start": 423.0,
      "Time_End": 429.0,
      "Text": " that came with the USB device, and you could only interact with that container using that software,"
    },
    {
      "Time_Start": 429.0,
      "Time_End": 435.0,
      "Text": " which makes a big difference between your TrueCrypt or the others, where you mount it as a drive,"
    },
    {
      "Time_Start": 435.0,
      "Time_End": 440.0,
      "Text": " and then you can use any software to move the data in and out. Here, you had to use their software"
    },
    {
      "Time_Start": 440.0,
      "Time_End": 444.0,
      "Text": " to open the files, place the files in, that kind of thing."
    },
    {
      "Time_Start": 444.0,
      "Time_End": 450.0,
      "Text": " So I mentioned it was highly secure, so the vendor said it was unbreakable, it was using 256 AES,"
    },
    {
      "Time_Start": 450.0,
      "Time_End": 455.0,
      "Text": " so highly strong encryption, and it was all closed source, it was never released to anyone,"
    },
    {
      "Time_Start": 455.0,
      "Time_End": 459.0,
      "Text": " so the format was proprietary. And as we did the investigation, because the client discovered"
    },
    {
      "Time_Start": 459.0,
      "Time_End": 464.0,
      "Text": " they have a problem on the network, we started unraveling a story that showed us that the attackers"
    },
    {
      "Time_Start": 464.0,
      "Time_End": 470.0,
      "Text": " staged it into three different phases. The first phase was locating systems of interest,"
    },
    {
      "Time_Start": 470.0,
      "Time_End": 475.0,
      "Text": " makes sense, right? Internal reconnaissance, looking for any documents that they may want to steal."
    },
    {
      "Time_Start": 475.0,
      "Time_End": 480.0,
      "Text": " Second phase was researching what security measures the victim has in the network,"
    },
    {
      "Time_Start": 480.0,
      "Time_End": 485.0,
      "Text": " so they can try to attack that. And the last stage was, obviously, once they knew how to do it,"
    },
    {
      "Time_Start": 485.0,
      "Time_End": 489.0,
      "Text": " breaking that security. And this is kind of how we're going to go about it."
    },
    {
      "Time_Start": 489.0,
      "Time_End": 495.0,
      "Text": " An extra point, the activity was attributed, or we attributed to a group known as THICC,"
    },
    {
      "Time_Start": 495.0,
      "Time_End": 500.0,
      "Text": " and we have a slide about it, but you can also Google them. There were some papers,"
    },
    {
      "Time_Start": 500.0,
      "Time_End": 505.0,
      "Text": " or blog posts, in 2016 and again in 2017 about the group. So first, we found that the attackers"
    },
    {
      "Time_Start": 505.0,
      "Time_End": 510.0,
      "Text": " came to the environment and dropped two tools. One of them is NativeSoft USBDevU,"
    },
    {
      "Time_Start": 510.0,
      "Time_End": 516.0,
      "Text": " which is a free utility, some of you might know it, and it's a good utility that opens registry"
    },
    {
      "Time_Start": 516.0,
      "Time_End": 521.0,
      "Text": " and various other places to tell you what USB devices are currently connected,"
    },
    {
      "Time_Start": 521.0,
      "Time_End": 525.0,
      "Text": " as well as what devices were connected in the past. And that was useful for the attacker,"
    },
    {
      "Time_Start": 525.0,
      "Time_End": 530.0,
      "Text": " because once they knew that the data was moved on the USB devices, it was just a matter of time"
    },
    {
      "Time_Start": 530.0,
      "Time_End": 536.0,
      "Text": " before they identified all the key systems of interest. Now, what we didn't know was that"
    },
    {
      "Time_Start": 536.0,
      "Time_End": 541.0,
      "Text": " they would just place the utility on a disk and run a scheduled task, and then in the command prompt"
    },
    {
      "Time_Start": 541.0,
      "Time_End": 546.0,
      "Text": " they would say, hey, just output everything to a TXT file, then they would come around,"
    },
    {
      "Time_Start": 546.0,
      "Time_End": 552.0,
      "Text": " grab that file, and then analyze it offline. So something we didn't know was that it supports"
    },
    {
      "Time_Start": 552.0,
      "Time_End": 557.0,
      "Text": " command line arguments, and it's not just a good utility. The second thing was what we dubbed"
    },
    {
      "Time_Start": 557.0,
      "Time_End": 562.0,
      "Text": " a detectmon, and essentially it was a self-contained exe file that was persisted on the system,"
    },
    {
      "Time_Start": 562.0,
      "Time_End": 567.0,
      "Text": " and it would just run and do nothing except any time a USB device is connected,"
    },
    {
      "Time_Start": 567.0,
      "Time_End": 572.0,
      "Text": " it would run a DIR command and pipe it to a file on disk, right?"
    },
    {
      "Time_Start": 572.0,
      "Time_End": 577.0,
      "Text": " The location was hard-coded into the malware, and it would run that command every three minutes"
    },
    {
      "Time_Start": 577.0,
      "Time_End": 581.0,
      "Text": " so that later when the attacker comes to the system and grabs those TXT files,"
    },
    {
      "Time_Start": 581.0,
      "Time_End": 586.0,
      "Text": " he knows what content was on the disk. So they're not stealing the data yet,"
    },
    {
      "Time_Start": 586.0,
      "Time_End": 590.0,
      "Text": " they're just kind of checking what is available to them."
    },
    {
      "Time_Start": 590.0,
      "Time_End": 595.0,
      "Text": " That's what the nature of USBW looks like. You can find it on the internet."
    },
    {
      "Time_Start": 595.0,
      "Time_End": 599.0,
      "Text": " And in the next phase, they realized, okay, so there are these USB devices in the network,"
    },
    {
      "Time_Start": 599.0,
      "Time_End": 604.0,
      "Text": " and the problems they were facing were obviously strong encryption, there was unknown file formats"
    },
    {
      "Time_Start": 604.0,
      "Time_End": 609.0,
      "Text": " when it comes to the encryption container, then we have no disk mapping like I mentioned earlier,"
    },
    {
      "Time_Start": 609.0,
      "Time_End": 614.0,
      "Text": " and lastly, there might be, and this is what we suspect, that the USB devices had encryption chip"
    },
    {
      "Time_Start": 614.0,
      "Time_End": 622.0,
      "Text": " that ensured that if someone steals the encrypted container and they have the password,"
    },
    {
      "Time_Start": 622.0,
      "Time_End": 629.0,
      "Text": " they still won't be able to access that container because the key is probably split"
    },
    {
      "Time_Start": 629.0,
      "Time_End": 635.0,
      "Text": " between the chip and the password. So that's what we suspected, we never got a chance to confirm that."
    },
    {
      "Time_Start": 635.0,
      "Time_End": 639.0,
      "Text": " How could the attacker get around it? Well, fairly simple, right?"
    },
    {
      "Time_Start": 639.0,
      "Time_End": 644.0,
      "Text": " It doesn't matter how strong the encryption is as long as you have the password."
    },
    {
      "Time_Start": 644.0,
      "Time_End": 648.0,
      "Text": " The file formats, well, we're talking about state-sponsored attackers,"
    },
    {
      "Time_Start": 648.0,
      "Time_End": 655.0,
      "Text": " so they could have reverse-engineered it. They also could have used APIs if those are available by the vendor."
    },
    {
      "Time_Start": 655.0,
      "Time_End": 659.0,
      "Text": " They could have the things like, if there is no mapping, like TrueCrypt,"
    },
    {
      "Time_Start": 659.0,
      "Time_End": 664.0,
      "Text": " they can perhaps dump the process while the user is interacting with the container"
    },
    {
      "Time_Start": 664.0,
      "Time_End": 669.0,
      "Text": " to extract the encryption key or maybe other secrets that allow the interaction."
    },
    {
      "Time_Start": 669.0,
      "Time_End": 674.0,
      "Text": " And lastly, if the USB device did have the chip that we mentioned earlier,"
    },
    {
      "Time_Start": 674.0,
      "Time_End": 680.0,
      "Text": " they could automate the process and just wait until the chip is inserted and then access and steal the data."
    },
    {
      "Time_Start": 680.0,
      "Time_End": 683.0,
      "Text": " So these were kind of theories how they could get around it."
    },
    {
      "Time_Start": 683.0,
      "Time_End": 689.0,
      "Text": " Once we found the software that we dubbed them as Shell that was actually specifically created to do that,"
    },
    {
      "Time_Start": 689.0,
      "Time_End": 692.0,
      "Text": " we did some analysis to understand how they do it, right?"
    },
    {
      "Time_Start": 692.0,
      "Time_End": 697.0,
      "Text": " So the report came back and they said, the team that did analysis, they said,"
    },
    {
      "Time_Start": 697.0,
      "Time_End": 704.0,
      "Text": " hey, in the first phase, any time a USB device is connected, it hashes all the files on disk"
    },
    {
      "Time_Start": 704.0,
      "Time_End": 711.0,
      "Text": " and compares the hash to a hard-coded one. Only once that match is found, it moves on to the second stage."
    },
    {
      "Time_Start": 711.0,
      "Time_End": 713.0,
      "Text": " So obviously the question was, what is it looking for, right?"
    },
    {
      "Time_Start": 713.0,
      "Time_End": 717.0,
      "Text": " We entered the hash into Google, nothing came up."
    },
    {
      "Time_Start": 717.0,
      "Time_End": 723.0,
      "Text": " And then as we started, I started feeding the reverse engineering team various file names that we expected."
    },
    {
      "Time_Start": 723.0,
      "Time_End": 726.0,
      "Text": " And they said, hey, there is a match. I can't really tell you what the match was."
    },
    {
      "Time_Start": 726.0,
      "Time_End": 732.0,
      "Text": " But what it turned out later was that there was some trickery by these hackers"
    },
    {
      "Time_Start": 732.0,
      "Time_End": 736.0,
      "Text": " to make this process more difficult and there is a slide about it."
    },
    {
      "Time_Start": 736.0,
      "Time_End": 739.0,
      "Text": " So once a match was found, they come to the second stage,"
    },
    {
      "Time_Start": 739.0,
      "Time_End": 742.0,
      "Text": " which is looking for a very specific file extension."
    },
    {
      "Time_Start": 742.0,
      "Time_End": 747.0,
      "Text": " Once it's found, they check if the file is at least 4 MB and then they move to the third stage."
    },
    {
      "Time_Start": 747.0,
      "Time_End": 749.0,
      "Text": " So the first one is looking for the software."
    },
    {
      "Time_Start": 749.0,
      "Time_End": 752.0,
      "Text": " That's what they were looking for, the software that the vendor provides."
    },
    {
      "Time_Start": 752.0,
      "Time_End": 755.0,
      "Text": " Second one was making sure that there is a volume, right?"
    },
    {
      "Time_Start": 755.0,
      "Time_End": 757.0,
      "Text": " The container, the encrypted container."
    },
    {
      "Time_Start": 757.0,
      "Time_End": 761.0,
      "Text": " And lastly, once the two conditions were met,"
    },
    {
      "Time_Start": 761.0,
      "Time_End": 766.0,
      "Text": " the malware would extract from itself four different versions of the vendor's software"
    },
    {
      "Time_Start": 766.0,
      "Time_End": 772.0,
      "Text": " and automate trying to break into the container with each version until one of them worked."
    },
    {
      "Time_Start": 772.0,
      "Time_End": 776.0,
      "Text": " Some clever tricks and you can tell that it wasn't like a five minutes thing."
    },
    {
      "Time_Start": 776.0,
      "Time_End": 780.0,
      "Text": " They clearly researched the thing and they had to also buy the USB devices"
    },
    {
      "Time_Start": 780.0,
      "Time_End": 783.0,
      "Text": " because that software that the vendor provides, it crashes."
    },
    {
      "Time_Start": 783.0,
      "Time_End": 787.0,
      "Text": " It won't work unless the USB device is inserted."
    },
    {
      "Time_Start": 787.0,
      "Time_End": 789.0,
      "Text": " And here comes the bonus point."
    },
    {
      "Time_Start": 789.0,
      "Time_End": 793.0,
      "Text": " The software that I mentioned earlier, or I should say a piece of malware called Detectmon,"
    },
    {
      "Time_Start": 793.0,
      "Time_End": 796.0,
      "Text": " at some point got also updated by the attacker"
    },
    {
      "Time_Start": 796.0,
      "Time_End": 801.0,
      "Text": " because they realized that sometimes the victim doesn't put all the files into container."
    },
    {
      "Time_Start": 801.0,
      "Time_End": 803.0,
      "Text": " Sometimes they just put on the USB device."
    },
    {
      "Time_Start": 803.0,
      "Time_End": 806.0,
      "Text": " So instead of doing DIR every three minutes,"
    },
    {
      "Time_Start": 806.0,
      "Time_End": 810.0,
      "Text": " they just use xcopy command, again, building commands,"
    },
    {
      "Time_Start": 810.0,
      "Time_End": 813.0,
      "Text": " to copy all the files from the USB device,"
    },
    {
      "Time_Start": 813.0,
      "Time_End": 816.0,
      "Text": " excluding certain that were listed in a text file."
    },
    {
      "Time_Start": 816.0,
      "Time_End": 818.0,
      "Text": " So a very, very interesting command."
    },
    {
      "Time_Start": 818.0,
      "Time_End": 819.0,
      "Text": " I wasn't even aware of it."
    },
    {
      "Time_Start": 819.0,
      "Time_End": 823.0,
      "Text": " And the text file had things like Adobe Reader, surprisingly."
    },
    {
      "Time_Start": 823.0,
      "Time_End": 824.0,
      "Text": " There must have been a folder."
    },
    {
      "Time_Start": 824.0,
      "Time_End": 826.0,
      "Text": " The containers, right?"
    },
    {
      "Time_Start": 826.0,
      "Time_End": 828.0,
      "Text": " So a file extension for the encrypted containers."
    },
    {
      "Time_Start": 828.0,
      "Time_End": 830.0,
      "Text": " Obviously, they didn't want those."
    },
    {
      "Time_Start": 830.0,
      "Time_End": 831.0,
      "Text": " They had no use of those."
    },
    {
      "Time_Start": 831.0,
      "Time_End": 834.0,
      "Text": " But also some file extensions that we never understood what they were"
    },
    {
      "Time_Start": 834.0,
      "Time_End": 837.0,
      "Text": " because they were unique to the client's environment."
    },
    {
      "Time_Start": 838.0,
      "Time_End": 840.0,
      "Text": " Like I mentioned, attribution."
    },
    {
      "Time_Start": 840.0,
      "Time_End": 841.0,
      "Text": " The group is known as TIC."
    },
    {
      "Time_Start": 841.0,
      "Time_End": 843.0,
      "Text": " We believe they're Chinese origin"
    },
    {
      "Time_Start": 843.0,
      "Time_End": 845.0,
      "Text": " and they've been active since at least 2009."
    },
    {
      "Time_Start": 847.0,
      "Time_End": 850.0,
      "Text": " Right, so I mentioned that there was some trickery."
    },
    {
      "Time_Start": 850.0,
      "Time_End": 853.0,
      "Text": " So throughout the investigation we saw,"
    },
    {
      "Time_Start": 853.0,
      "Time_End": 855.0,
      "Text": " various investigations,"
    },
    {
      "Time_Start": 855.0,
      "Time_End": 857.0,
      "Text": " we saw the operation security improve."
    },
    {
      "Time_Start": 857.0,
      "Time_End": 859.0,
      "Text": " And this is a great example of it."
    },
    {
      "Time_Start": 859.0,
      "Time_End": 861.0,
      "Text": " So when you think about MD5 algorithm,"
    },
    {
      "Time_Start": 861.0,
      "Time_End": 863.0,
      "Text": " it consists of four different rounds."
    },
    {
      "Time_Start": 863.0,
      "Time_End": 867.0,
      "Text": " And something that really kudos to the reverse engineering team,"
    },
    {
      "Time_Start": 867.0,
      "Time_End": 871.0,
      "Text": " they spotted that there was a small change in round three."
    },
    {
      "Time_Start": 872.0,
      "Time_End": 876.0,
      "Text": " One of the constants had one of its bytes changed,"
    },
    {
      "Time_Start": 876.0,
      "Time_End": 879.0,
      "Text": " which meant that any time you hash something,"
    },
    {
      "Time_Start": 879.0,
      "Time_End": 882.0,
      "Text": " the output will be different than from original MD5."
    },
    {
      "Time_Start": 883.0,
      "Time_End": 885.0,
      "Text": " And that was just so that when you googled that hash,"
    },
    {
      "Time_Start": 885.0,
      "Time_End": 887.0,
      "Text": " that was hard-coded,"
    },
    {
      "Time_Start": 887.0,
      "Time_End": 888.0,
      "Text": " you wouldn't find any hits in Google."
    },
    {
      "Time_Start": 888.0,
      "Time_End": 890.0,
      "Text": " At least that's our theory."
    },
    {
      "Time_Start": 890.0,
      "Time_End": 892.0,
      "Text": " Right, back over to you, Tom."
    },
    {
      "Time_Start": 893.0,
      "Time_End": 894.0,
      "Text": " Great, cheers, Bart."
    },
    {
      "Time_Start": 894.0,
      "Time_End": 896.0,
      "Text": " So quickly jumping in then,"
    },
    {
      "Time_Start": 896.0,
      "Time_End": 898.0,
      "Text": " we're going to look at a DNS backdoor."
    },
    {
      "Time_Start": 898.0,
      "Time_End": 900.0,
      "Text": " So this is Soundbyte."
    },
    {
      "Time_Start": 900.0,
      "Time_End": 903.0,
      "Text": " It's a backdoor we've seen used by APT32."
    },
    {
      "Time_Start": 903.0,
      "Time_End": 906.0,
      "Text": " Solely, I should add, by APT32,"
    },
    {
      "Time_Start": 906.0,
      "Time_End": 909.0,
      "Text": " or a Vietnamese-based threat group that we track."
    },
    {
      "Time_Start": 909.0,
      "Time_End": 912.0,
      "Text": " It's a fairly kind of advanced backdoor."
    },
    {
      "Time_Start": 912.0,
      "Time_End": 916.0,
      "Text": " What's interesting here is it actually uses recursive DNS servers."
    },
    {
      "Time_Start": 916.0,
      "Time_End": 918.0,
      "Text": " So in an environment where you don't have"
    },
    {
      "Time_Start": 918.0,
      "Time_End": 920.0,
      "Text": " really good detailed DNS logging,"
    },
    {
      "Time_Start": 920.0,
      "Time_End": 923.0,
      "Text": " it's very difficult to track the source and destination"
    },
    {
      "Time_Start": 923.0,
      "Time_End": 925.0,
      "Text": " of these beacon packets."
    },
    {
      "Time_Start": 925.0,
      "Time_End": 928.0,
      "Text": " Kind of got kind of the expected kind of functionality"
    },
    {
      "Time_Start": 928.0,
      "Time_End": 930.0,
      "Text": " of an advanced backdoor."
    },
    {
      "Time_Start": 930.0,
      "Time_End": 932.0,
      "Text": " And obviously kind of the aim for the attackers really"
    },
    {
      "Time_Start": 932.0,
      "Time_End": 935.0,
      "Text": " is to divert things like proxy, firewall rules,"
    },
    {
      "Time_Start": 935.0,
      "Time_End": 937.0,
      "Text": " and be able to get out of the environment"
    },
    {
      "Time_Start": 937.0,
      "Time_End": 939.0,
      "Text": " kind of as easy as possible"
    },
    {
      "Time_Start": 939.0,
      "Time_End": 942.0,
      "Text": " without alerting the security teams."
    },
    {
      "Time_Start": 942.0,
      "Time_End": 946.0,
      "Text": " So jumping into kind of a beacon example."
    },
    {
      "Time_Start": 946.0,
      "Time_End": 950.0,
      "Text": " So what it does is it uses null resource records with DNS."
    },
    {
      "Time_Start": 950.0,
      "Time_End": 954.0,
      "Text": " It also uses a custom Base64 dictionary."
    },
    {
      "Time_Start": 954.0,
      "Time_End": 957.0,
      "Text": " What we can see here in yellow, the first six bytes,"
    },
    {
      "Time_Start": 957.0,
      "Time_End": 960.0,
      "Text": " is it stores a host identifier"
    },
    {
      "Time_Start": 960.0,
      "Time_End": 963.0,
      "Text": " so that the C2 knows which system it's talking to."
    },
    {
      "Time_Start": 963.0,
      "Time_End": 965.0,
      "Text": " But what's kind of interesting here is"
    },
    {
      "Time_Start": 965.0,
      "Time_End": 969.0,
      "Text": " although it makes it easy to identify the source host for us"
    },
    {
      "Time_Start": 969.0,
      "Time_End": 971.0,
      "Text": " when we're looking on the network,"
    },
    {
      "Time_Start": 971.0,
      "Time_End": 973.0,
      "Text": " it also, because it stores it in the registry"
    },
    {
      "Time_Start": 973.0,
      "Time_End": 975.0,
      "Text": " and it only stores it once,"
    },
    {
      "Time_Start": 975.0,
      "Time_End": 977.0,
      "Text": " it gives us an indication of when that system"
    },
    {
      "Time_Start": 977.0,
      "Time_End": 979.0,
      "Text": " was first compromised."
    },
    {
      "Time_Start": 979.0,
      "Time_End": 982.0,
      "Text": " And in blue, we can see here, we've got a tick counter."
    },
    {
      "Time_Start": 982.0,
      "Time_End": 985.0,
      "Text": " So every beacon that comes out,"
    },
    {
      "Time_Start": 985.0,
      "Time_End": 987.0,
      "Text": " you can see if you have number of beacons at set intervals."
    },
    {
      "Time_Start": 987.0,
      "Time_End": 990.0,
      "Text": " It's quite easy to detect kind of for your DNS logs"
    },
    {
      "Time_Start": 990.0,
      "Time_End": 993.0,
      "Text": " when you've got multiple requests to one domain."
    },
    {
      "Time_Start": 993.0,
      "Time_End": 995.0,
      "Text": " What it does is it makes that domain unique."
    },
    {
      "Time_Start": 995.0,
      "Time_End": 998.0,
      "Text": " So if you're trying to stack on the network logs"
    },
    {
      "Time_Start": 998.0,
      "Time_End": 1001.0,
      "Text": " kind of suspicious kind of DNS lookups,"
    },
    {
      "Time_Start": 1001.0,
      "Time_End": 1005.0,
      "Text": " you're just going to see these as individual records."
    },
    {
      "Time_Start": 1007.0,
      "Time_End": 1012.0,
      "Text": " So an example of some of the commands that it supports."
    },
    {
      "Time_Start": 1013.0,
      "Time_End": 1016.0,
      "Text": " We're going to take a quick look at the move file."
    },
    {
      "Time_Start": 1016.0,
      "Time_End": 1018.0,
      "Text": " We can see here."
    },
    {
      "Time_Start": 1018.0,
      "Time_End": 1021.0,
      "Text": " What it does, as you can see, is it takes arg0 and arg2"
    },
    {
      "Time_Start": 1021.0,
      "Time_End": 1023.0,
      "Text": " and effectively takes two files"
    },
    {
      "Time_Start": 1023.0,
      "Time_End": 1026.0,
      "Text": " and it tells the endpoint to kind of move the first file"
    },
    {
      "Time_Start": 1026.0,
      "Time_End": 1029.0,
      "Text": " to the second file."
    },
    {
      "Time_Start": 1029.0,
      "Time_End": 1033.0,
      "Text": " So just an example kind of before we get to the base64"
    },
    {
      "Time_Start": 1033.0,
      "Time_End": 1037.0,
      "Text": " kind of encoding of what it looks like as a C2 command."
    },
    {
      "Time_Start": 1037.0,
      "Time_End": 1039.0,
      "Text": " And we can see here on the first bytes,"
    },
    {
      "Time_Start": 1039.0,
      "Time_End": 1041.0,
      "Text": " we've got the actual command itself"
    },
    {
      "Time_Start": 1041.0,
      "Time_End": 1043.0,
      "Text": " which kind of, as we just said,"
    },
    {
      "Time_Start": 1043.0,
      "Time_End": 1046.0,
      "Text": " we're looking at the move file."
    },
    {
      "Time_Start": 1046.0,
      "Time_End": 1048.0,
      "Text": " Then following that, we've got two sections"
    },
    {
      "Time_Start": 1048.0,
      "Time_End": 1051.0,
      "Text": " which represent the compressed and the decompressed sides."
    },
    {
      "Time_Start": 1051.0,
      "Time_End": 1053.0,
      "Text": " So we've got error checking in there."
    },
    {
      "Time_Start": 1053.0,
      "Time_End": 1055.0,
      "Text": " They can see if there's been any kind of issues"
    },
    {
      "Time_Start": 1055.0,
      "Time_End": 1058.0,
      "Text": " with kind of transporting the data over the network."
    },
    {
      "Time_Start": 1058.0,
      "Time_End": 1060.0,
      "Text": " And then finally at the end here,"
    },
    {
      "Time_Start": 1060.0,
      "Time_End": 1062.0,
      "Text": " we've got the actual compressed data itself"
    },
    {
      "Time_Start": 1062.0,
      "Time_End": 1064.0,
      "Text": " which, as you can see here, we've got the header"
    },
    {
      "Time_Start": 1064.0,
      "Time_End": 1066.0,
      "Text": " to indicate the start of that data."
    },
    {
      "Time_Start": 1066.0,
      "Time_End": 1069.0,
      "Text": " What's interesting is not kind of supported here,"
    },
    {
      "Time_Start": 1069.0,
      "Time_End": 1071.0,
      "Text": " but these bytes here, these FF bytes,"
    },
    {
      "Time_Start": 1071.0,
      "Time_End": 1073.0,
      "Text": " if we've got larger commands that need to go over"
    },
    {
      "Time_Start": 1073.0,
      "Time_End": 1076.0,
      "Text": " multiple requests, because obviously we've only got"
    },
    {
      "Time_Start": 1076.0,
      "Time_End": 1078.0,
      "Text": " a set length for DNS records,"
    },
    {
      "Time_Start": 1078.0,
      "Time_End": 1081.0,
      "Text": " we can kind of have a continuous stream"
    },
    {
      "Time_Start": 1081.0,
      "Time_End": 1085.0,
      "Text": " where we can verify which point"
    },
    {
      "Time_Start": 1085.0,
      "Time_End": 1090.0,
      "Text": " we get to the end of that message."
    },
    {
      "Time_Start": 1090.0,
      "Time_End": 1092.0,
      "Text": " So kind of breaking that down a bit"
    },
    {
      "Time_Start": 1092.0,
      "Time_End": 1094.0,
      "Text": " and kind of decompressing it, we can see here"
    },
    {
      "Time_Start": 1094.0,
      "Time_End": 1096.0,
      "Text": " the arguments are stored as length value pairs."
    },
    {
      "Time_Start": 1096.0,
      "Time_End": 1098.0,
      "Text": " So arg0 here is highlighted."
    },
    {
      "Time_Start": 1099.0,
      "Time_End": 1101.0,
      "Text": " We can see we've got one file"
    },
    {
      "Time_Start": 1101.0,
      "Time_End": 1104.0,
      "Text": " which is representative of desktop old file."
    },
    {
      "Time_Start": 1104.0,
      "Time_End": 1106.0,
      "Text": " We've got our arg1 which isn't implemented"
    },
    {
      "Time_Start": 1106.0,
      "Time_End": 1107.0,
      "Text": " for this command."
    },
    {
      "Time_Start": 1107.0,
      "Time_End": 1109.0,
      "Text": " It's just kind of passed over."
    },
    {
      "Time_Start": 1109.0,
      "Time_End": 1112.0,
      "Text": " Followed finally by arg2 which effectively takes"
    },
    {
      "Time_Start": 1112.0,
      "Time_End": 1115.0,
      "Text": " old file and moves it to new file."
    },
    {
      "Time_Start": 1115.0,
      "Time_End": 1117.0,
      "Text": " Fairly simple stuff, but it's an interesting way"
    },
    {
      "Time_Start": 1117.0,
      "Time_End": 1119.0,
      "Text": " obviously of using DNS to kind of divert"
    },
    {
      "Time_Start": 1119.0,
      "Time_End": 1124.0,
      "Text": " from normal kind of C2 kind of practices."
    },
    {
      "Time_Start": 1124.0,
      "Time_End": 1126.0,
      "Text": " So lastly, just to look at some"
    },
    {
      "Time_Start": 1126.0,
      "Time_End": 1128.0,
      "Text": " of the host base indicators."
    },
    {
      "Time_Start": 1128.0,
      "Time_End": 1130.0,
      "Text": " What this attacker likes to do is they like to"
    },
    {
      "Time_Start": 1130.0,
      "Time_End": 1133.0,
      "Text": " kind of disguise themselves with standard kind of"
    },
    {
      "Time_Start": 1133.0,
      "Time_End": 1136.0,
      "Text": " Windows file names and folder structures."
    },
    {
      "Time_Start": 1136.0,
      "Time_End": 1140.0,
      "Text": " So the first sample we found is this soundvolsso.exe"
    },
    {
      "Time_Start": 1140.0,
      "Time_End": 1142.0,
      "Text": " which is where the sound byte naming came from."
    },
    {
      "Time_Start": 1142.0,
      "Time_End": 1146.0,
      "Text": " There's a legitimate DLL file with the same name."
    },
    {
      "Time_Start": 1146.0,
      "Time_End": 1148.0,
      "Text": " What we find is interesting here is"
    },
    {
      "Time_Start": 1148.0,
      "Time_End": 1151.0,
      "Text": " they've got unsigned droppers"
    },
    {
      "Time_Start": 1151.0,
      "Time_End": 1153.0,
      "Text": " in the PE resource data of that."
    },
    {
      "Time_Start": 1153.0,
      "Time_End": 1155.0,
      "Text": " They have the actual backdoor itself"
    },
    {
      "Time_Start": 1155.0,
      "Time_End": 1157.0,
      "Text": " which is self-signed by the attackers"
    },
    {
      "Time_Start": 1157.0,
      "Time_End": 1159.0,
      "Text": " but impersonating Microsoft."
    },
    {
      "Time_Start": 1159.0,
      "Time_End": 1161.0,
      "Text": " So again, trying to kind of hide"
    },
    {
      "Time_Start": 1161.0,
      "Time_End": 1165.0,
      "Text": " and kind of camouflage themselves in the network."
    },
    {
      "Time_Start": 1165.0,
      "Time_End": 1166.0,
      "Text": " As we said in the registry key,"
    },
    {
      "Time_Start": 1166.0,
      "Time_End": 1170.0,
      "Text": " they're storing the host indicator"
    },
    {
      "Time_Start": 1170.0,
      "Time_End": 1173.0,
      "Text": " and both samples are persistent as a service."
    },
    {
      "Time_Start": 1173.0,
      "Time_End": 1176.0,
      "Text": " So here we're using .NET."
    },
    {
      "Time_Start": 1176.0,
      "Time_End": 1177.0,
      "Text": " Legitimate file names,"
    },
    {
      "Time_Start": 1177.0,
      "Time_End": 1182.0,
      "Text": " they just changed the version numbers."
    },
    {
      "Time_Start": 1182.0,
      "Time_End": 1184.0,
      "Text": " Thanks."
    },
    {
      "Time_Start": 1184.0,
      "Time_End": 1186.0,
      "Text": " Right."
    },
    {
      "Time_Start": 1186.0,
      "Time_End": 1188.0,
      "Text": " So the next section which is TP number four"
    },
    {
      "Time_Start": 1188.0,
      "Time_End": 1190.0,
      "Text": " is hidden comment that can haunt you."
    },
    {
      "Time_Start": 1190.0,
      "Time_End": 1193.0,
      "Text": " So I'll start with a little bit of a quiz"
    },
    {
      "Time_Start": 1193.0,
      "Time_End": 1195.0,
      "Text": " to wake you guys up to make sure you're still listening,"
    },
    {
      "Time_Start": 1195.0,
      "Time_End": 1197.0,
      "Text": " you haven't fallen asleep yet."
    },
    {
      "Time_Start": 1197.0,
      "Time_End": 1198.0,
      "Text": " So I'll tell you a story."
    },
    {
      "Time_Start": 1198.0,
      "Time_End": 1200.0,
      "Text": " We came to investigate a server"
    },
    {
      "Time_Start": 1200.0,
      "Time_End": 1202.0,
      "Text": " and we found a bit weird"
    },
    {
      "Time_Start": 1202.0,
      "Time_End": 1204.0,
      "Text": " that the attackers took the main page,"
    },
    {
      "Time_Start": 1204.0,
      "Time_End": 1207.0,
      "Text": " let's call it index.php."
    },
    {
      "Time_Start": 1207.0,
      "Time_End": 1209.0,
      "Text": " They made a copy of it so we could diff them"
    },
    {
      "Time_Start": 1209.0,
      "Time_End": 1211.0,
      "Text": " and in the original index,"
    },
    {
      "Time_Start": 1211.0,
      "Time_End": 1212.0,
      "Text": " they appended four lines"
    },
    {
      "Time_Start": 1212.0,
      "Time_End": 1215.0,
      "Text": " that we represented here in a pseudocode."
    },
    {
      "Time_Start": 1215.0,
      "Time_End": 1216.0,
      "Text": " And as you can see,"
    },
    {
      "Time_Start": 1216.0,
      "Time_End": 1220.0,
      "Text": " all it does is it queries the local time on the system,"
    },
    {
      "Time_Start": 1220.0,
      "Time_End": 1222.0,
      "Text": " converts that into number of ticks"
    },
    {
      "Time_Start": 1222.0,
      "Time_End": 1224.0,
      "Text": " and then that into minutes."
    },
    {
      "Time_Start": 1224.0,
      "Time_End": 1225.0,
      "Text": " So that's what you have."
    },
    {
      "Time_Start": 1225.0,
      "Time_End": 1226.0,
      "Text": " You have total minutes"
    },
    {
      "Time_Start": 1226.0,
      "Time_End": 1228.0,
      "Text": " and then it just kind of removes"
    },
    {
      "Time_Start": 1228.0,
      "Time_End": 1230.0,
      "Text": " the least significant digit, right,"
    },
    {
      "Time_Start": 1230.0,
      "Time_End": 1232.0,
      "Text": " by dividing by 10."
    },
    {
      "Time_Start": 1232.0,
      "Time_End": 1234.0,
      "Text": " And then appends it to a string"
    },
    {
      "Time_Start": 1234.0,
      "Time_End": 1236.0,
      "Text": " and prints it out."
    },
    {
      "Time_Start": 1236.0,
      "Time_End": 1238.0,
      "Text": " So effectively when you browse to a page,"
    },
    {
      "Time_Start": 1238.0,
      "Time_End": 1239.0,
      "Text": " you won't see it at all"
    },
    {
      "Time_Start": 1239.0,
      "Time_End": 1241.0,
      "Text": " unless you go into HTML code"
    },
    {
      "Time_Start": 1241.0,
      "Time_End": 1244.0,
      "Text": " and then all you see is a HTML comment"
    },
    {
      "Time_Start": 1244.0,
      "Time_End": 1246.0,
      "Text": " as presented in the example."
    },
    {
      "Time_Start": 1246.0,
      "Time_End": 1248.0,
      "Text": " So, any suggestions"
    },
    {
      "Time_Start": 1248.0,
      "Time_End": 1250.0,
      "Text": " why would the attackers have done that?"
    },
    {
      "Time_Start": 1250.0,
      "Time_End": 1252.0,
      "Text": " Anyone?"
    },
    {
      "Time_Start": 1252.0,
      "Time_End": 1253.0,
      "Text": " This is the interactive part."
    },
    {
      "Time_Start": 1253.0,
      "Time_End": 1254.0,
      "Text": " Yes."
    },
    {
      "Time_Start": 1258.0,
      "Time_End": 1259.0,
      "Text": " To do what?"
    },
    {
      "Time_Start": 1261.0,
      "Time_End": 1262.0,
      "Text": " As a seed."
    },
    {
      "Time_Start": 1262.0,
      "Time_End": 1264.0,
      "Text": " Okay, yeah, that's a great idea."
    },
    {
      "Time_Start": 1264.0,
      "Time_End": 1266.0,
      "Text": " And then you could use that seed for?"
    },
    {
      "Time_Start": 1270.0,
      "Time_End": 1271.0,
      "Text": " Sorry."
    },
    {
      "Time_Start": 1275.0,
      "Time_End": 1277.0,
      "Text": " Right, so the idea..."
    },
    {
      "Time_Start": 1277.0,
      "Time_End": 1278.0,
      "Text": " Great thinking, great thinking."
    },
    {
      "Time_Start": 1278.0,
      "Time_End": 1281.0,
      "Text": " So the idea is that you get some kind of random number"
    },
    {
      "Time_Start": 1281.0,
      "Time_End": 1283.0,
      "Text": " generator, right?"
    },
    {
      "Time_Start": 1283.0,
      "Time_End": 1284.0,
      "Text": " Yes."
    },
    {
      "Time_Start": 1289.0,
      "Time_End": 1293.0,
      "Text": " So the idea is that it would bypass detection"
    },
    {
      "Time_Start": 1293.0,
      "Time_End": 1295.0,
      "Text": " and what are we trying to detect?"
    },
    {
      "Time_Start": 1295.0,
      "Time_End": 1297.0,
      "Text": " And what are we trying to detect?"
    },
    {
      "Time_Start": 1299.0,
      "Time_End": 1300.0,
      "Text": " The full ID."
    },
    {
      "Time_Start": 1300.0,
      "Time_End": 1302.0,
      "Text": " And what would anyone use a GUID"
    },
    {
      "Time_Start": 1302.0,
      "Time_End": 1304.0,
      "Text": " because it's effectively a GUID, right?"
    },
    {
      "Time_Start": 1304.0,
      "Time_End": 1306.0,
      "Text": " What do you need a GUID for?"
    },
    {
      "Time_Start": 1306.0,
      "Time_End": 1308.0,
      "Text": " So what I'm going here with,"
    },
    {
      "Time_Start": 1308.0,
      "Time_End": 1309.0,
      "Text": " it's a great idea."
    },
    {
      "Time_Start": 1309.0,
      "Time_End": 1310.0,
      "Text": " There were even ideas of,"
    },
    {
      "Time_Start": 1310.0,
      "Time_End": 1313.0,
      "Text": " hey, maybe it's preventing caching"
    },
    {
      "Time_Start": 1313.0,
      "Time_End": 1315.0,
      "Text": " because every time the page will be unique"
    },
    {
      "Time_Start": 1315.0,
      "Time_End": 1317.0,
      "Text": " at least every 10 minutes."
    },
    {
      "Time_Start": 1317.0,
      "Time_End": 1318.0,
      "Text": " So we had these ideas"
    },
    {
      "Time_Start": 1318.0,
      "Time_End": 1320.0,
      "Text": " but we didn't really know what it was for, right?"
    },
    {
      "Time_Start": 1320.0,
      "Time_End": 1323.0,
      "Text": " So yeah, thank you, thank you for your ideas."
    },
    {
      "Time_Start": 1323.0,
      "Time_End": 1325.0,
      "Text": " And before I tell you why they did it,"
    },
    {
      "Time_Start": 1325.0,
      "Time_End": 1327.0,
      "Text": " let me tell you a story about webshells."
    },
    {
      "Time_Start": 1327.0,
      "Time_End": 1329.0,
      "Text": " So obviously it's a technical conference,"
    },
    {
      "Time_Start": 1329.0,
      "Time_End": 1331.0,
      "Text": " so all of you know what webshells are, right?"
    },
    {
      "Time_Start": 1331.0,
      "Time_End": 1334.0,
      "Text": " They're just web-based backdoors."
    },
    {
      "Time_Start": 1334.0,
      "Time_End": 1337.0,
      "Text": " Very difficult to detect for a number of reasons."
    },
    {
      "Time_Start": 1337.0,
      "Time_End": 1339.0,
      "Text": " They're passive in a sense that they don't beacon out,"
    },
    {
      "Time_Start": 1339.0,
      "Time_End": 1342.0,
      "Text": " you have to connect to them as the attacker."
    },
    {
      "Time_Start": 1342.0,
      "Time_End": 1344.0,
      "Text": " And like I said, they can really vary in size,"
    },
    {
      "Time_Start": 1344.0,
      "Time_End": 1348.0,
      "Text": " they can be even as small as 20 bytes."
    },
    {
      "Time_Start": 1348.0,
      "Time_End": 1350.0,
      "Text": " If you Google, and I'm sure you know it,"
    },
    {
      "Time_Start": 1350.0,
      "Time_End": 1352.0,
      "Text": " there are like hundreds of different webshells"
    },
    {
      "Time_Start": 1352.0,
      "Time_End": 1355.0,
      "Text": " and here is an example of a China chopper."
    },
    {
      "Time_Start": 1355.0,
      "Time_End": 1357.0,
      "Text": " So very commonly used backdoor."
    },
    {
      "Time_Start": 1357.0,
      "Time_End": 1359.0,
      "Text": " At the top you have a source code"
    },
    {
      "Time_Start": 1359.0,
      "Time_End": 1362.0,
      "Text": " of a file that was placed in the victim's system, right?"
    },
    {
      "Time_Start": 1362.0,
      "Time_End": 1364.0,
      "Text": " The actual webshell, very, very short."
    },
    {
      "Time_Start": 1364.0,
      "Time_End": 1368.0,
      "Text": " And at the bottom you have the attacker's screen"
    },
    {
      "Time_Start": 1368.0,
      "Time_End": 1369.0,
      "Text": " using the thick client,"
    },
    {
      "Time_Start": 1369.0,
      "Time_End": 1372.0,
      "Text": " which looks very much like just Explorer."
    },
    {
      "Time_Start": 1372.0,
      "Time_End": 1374.0,
      "Text": " You know, just clicky, beautiful, you know,"
    },
    {
      "Time_Start": 1374.0,
      "Time_End": 1376.0,
      "Text": " just go around and you do nasty things."
    },
    {
      "Time_Start": 1376.0,
      "Time_End": 1378.0,
      "Text": " Now what does it look like on the wire?"
    },
    {
      "Time_Start": 1378.0,
      "Time_End": 1381.0,
      "Text": " So on the top we have the request sent"
    },
    {
      "Time_Start": 1381.0,
      "Time_End": 1382.0,
      "Text": " to the webshell by the attacker."
    },
    {
      "Time_Start": 1382.0,
      "Time_End": 1384.0,
      "Text": " It's just your typical post request"
    },
    {
      "Time_Start": 1384.0,
      "Time_End": 1387.0,
      "Text": " with a very big chunk of base 64"
    },
    {
      "Time_Start": 1387.0,
      "Time_End": 1391.0,
      "Text": " that gets decoded on the victim system and executed, right?"
    },
    {
      "Time_Start": 1391.0,
      "Time_End": 1394.0,
      "Text": " And then we have a response at the bottom from the victim."
    },
    {
      "Time_Start": 1394.0,
      "Time_End": 1397.0,
      "Text": " Now coming back to the original story,"
    },
    {
      "Time_Start": 1397.0,
      "Time_End": 1400.0,
      "Text": " a little bit later we found another file"
    },
    {
      "Time_Start": 1400.0,
      "Time_End": 1403.0,
      "Text": " that we missed at first because it was timestamped, right?"
    },
    {
      "Time_Start": 1403.0,
      "Time_End": 1405.0,
      "Text": " So its timestamps were altered."
    },
    {
      "Time_Start": 1405.0,
      "Time_End": 1408.0,
      "Text": " And inside we found 10 lines of codes."
    },
    {
      "Time_Start": 1408.0,
      "Time_End": 1410.0,
      "Text": " The first four were practically identical,"
    },
    {
      "Time_Start": 1410.0,
      "Time_End": 1412.0,
      "Text": " like the ones they appended earlier."
    },
    {
      "Time_Start": 1412.0,
      "Time_End": 1415.0,
      "Text": " But now instead of printing it out as a comment,"
    },
    {
      "Time_Start": 1415.0,
      "Time_End": 1418.0,
      "Text": " the value of time is appended to a text,"
    },
    {
      "Time_Start": 1418.0,
      "Time_End": 1421.0,
      "Text": " which in this example is ABC123."
    },
    {
      "Time_Start": 1421.0,
      "Time_End": 1423.0,
      "Text": " And then it's compared with a cookie."
    },
    {
      "Time_Start": 1423.0,
      "Time_End": 1426.0,
      "Text": " And if the cookie doesn't contain the right value,"
    },
    {
      "Time_Start": 1426.0,
      "Time_End": 1429.0,
      "Text": " the user is redirected."
    },
    {
      "Time_Start": 1429.0,
      "Time_End": 1432.0,
      "Text": " Which effectively means that if you want to use the webshell,"
    },
    {
      "Time_Start": 1432.0,
      "Time_End": 1434.0,
      "Text": " you need to know the passwords"
    },
    {
      "Time_Start": 1434.0,
      "Time_End": 1436.0,
      "Text": " and the current time on the system,"
    },
    {
      "Time_Start": 1436.0,
      "Time_End": 1437.0,
      "Text": " put them in the cookie,"
    },
    {
      "Time_Start": 1437.0,
      "Time_End": 1440.0,
      "Text": " and only then you can interact with the webshell."
    },
    {
      "Time_Start": 1440.0,
      "Time_End": 1442.0,
      "Text": " Bit of a one-time password, right?"
    },
    {
      "Time_Start": 1442.0,
      "Time_End": 1445.0,
      "Text": " Pretty cool, at least we thought it was."
    },
    {
      "Time_Start": 1448.0,
      "Time_End": 1451.0,
      "Text": " So moving on, we're going to look at a persistence technique"
    },
    {
      "Time_Start": 1451.0,
      "Time_End": 1454.0,
      "Text": " that we haven't seen used too much."
    },
    {
      "Time_Start": 1454.0,
      "Time_End": 1457.0,
      "Text": " So again, kind of staying on the theme of ABC32,"
    },
    {
      "Time_Start": 1457.0,
      "Time_End": 1458.0,
      "Text": " we've got another backdoor,"
    },
    {
      "Time_Start": 1458.0,
      "Time_End": 1461.0,
      "Text": " highly kind of functional, called comprogo."
    },
    {
      "Time_Start": 1461.0,
      "Time_End": 1464.0,
      "Text": " So it's a free kind of staged backdoor,"
    },
    {
      "Time_Start": 1464.0,
      "Time_End": 1466.0,
      "Text": " as you see quite commonly."
    },
    {
      "Time_Start": 1466.0,
      "Time_End": 1467.0,
      "Text": " You've got a persistence mechanism,"
    },
    {
      "Time_Start": 1467.0,
      "Time_End": 1470.0,
      "Text": " you've got a loader, and you've got a payload, right?"
    },
    {
      "Time_Start": 1470.0,
      "Time_End": 1472.0,
      "Text": " So we first took a look at this,"
    },
    {
      "Time_Start": 1472.0,
      "Time_End": 1476.0,
      "Text": " and we saw that it was using this Improx server 32."
    },
    {
      "Time_Start": 1476.0,
      "Time_End": 1479.0,
      "Text": " So first thoughts, is it comobject hijacking?"
    },
    {
      "Time_Start": 1479.0,
      "Time_End": 1480.0,
      "Text": " I don't know."
    },
    {
      "Time_Start": 1480.0,
      "Time_End": 1481.0,
      "Text": " It's quite common."
    },
    {
      "Time_Start": 1481.0,
      "Time_End": 1482.0,
      "Text": " We see it quite a lot."
    },
    {
      "Time_Start": 1482.0,
      "Time_End": 1484.0,
      "Text": " But kind of digging deeper into it,"
    },
    {
      "Time_Start": 1484.0,
      "Time_End": 1488.0,
      "Text": " we saw actually it's using this registry key,"
    },
    {
      "Time_Start": 1488.0,
      "Time_End": 1490.0,
      "Text": " autodial DLL, to persist."
    },
    {
      "Time_Start": 1490.0,
      "Time_End": 1492.0,
      "Text": " So we did a bit of research."
    },
    {
      "Time_Start": 1492.0,
      "Time_End": 1493.0,
      "Text": " There's not too much written about it."
    },
    {
      "Time_Start": 1493.0,
      "Time_End": 1496.0,
      "Text": " We saw it briefly mentioned in one blog here."
    },
    {
      "Time_Start": 1496.0,
      "Time_End": 1499.0,
      "Text": " We did some kind of auto runs testing."
    },
    {
      "Time_Start": 1499.0,
      "Time_End": 1500.0,
      "Text": " It was kind of hit and miss"
    },
    {
      "Time_Start": 1500.0,
      "Time_End": 1502.0,
      "Text": " as to whether or not we detected it."
    },
    {
      "Time_Start": 1502.0,
      "Time_End": 1505.0,
      "Text": " But essentially, every time the Winsock library is loaded,"
    },
    {
      "Time_Start": 1505.0,
      "Time_End": 1508.0,
      "Text": " it's looking in this registry key for a DLL,"
    },
    {
      "Time_Start": 1508.0,
      "Time_End": 1510.0,
      "Text": " which is typically kind of a Windows-based"
    },
    {
      "Time_Start": 1510.0,
      "Time_End": 1513.0,
      "Text": " legitimate signed DLL."
    },
    {
      "Time_Start": 1513.0,
      "Time_End": 1514.0,
      "Text": " It's loading it,"
    },
    {
      "Time_Start": 1514.0,
      "Time_End": 1517.0,
      "Text": " and it's expecting these three export functions."
    },
    {
      "Time_Start": 1517.0,
      "Time_End": 1519.0,
      "Text": " So what we found is,"
    },
    {
      "Time_Start": 1519.0,
      "Time_End": 1522.0,
      "Text": " they're replacing overwriting this registry key"
    },
    {
      "Time_Start": 1522.0,
      "Time_End": 1524.0,
      "Text": " with their malicious DLL,"
    },
    {
      "Time_Start": 1524.0,
      "Time_End": 1527.0,
      "Text": " which then, when every time the Winsock library is loaded,"
    },
    {
      "Time_Start": 1527.0,
      "Time_End": 1529.0,
      "Text": " it's loading their malicious DLL,"
    },
    {
      "Time_Start": 1529.0,
      "Time_End": 1531.0,
      "Text": " which is loading the payload."
    },
    {
      "Time_Start": 1531.0,
      "Time_End": 1533.0,
      "Text": " But it's also allowing the Winsock library to function"
    },
    {
      "Time_Start": 1533.0,
      "Time_End": 1536.0,
      "Text": " kind of as it would do normally."
    },
    {
      "Time_Start": 1536.0,
      "Time_End": 1538.0,
      "Text": " And that's kind of just another bit,"
    },
    {
      "Time_Start": 1538.0,
      "Time_End": 1540.0,
      "Text": " but we'll kind of touch on that"
    },
    {
      "Time_Start": 1540.0,
      "Time_End": 1546.0,
      "Text": " further on in one of the other slides."
    },
    {
      "Time_Start": 1546.0,
      "Time_End": 1547.0,
      "Text": " Right."
    },
    {
      "Time_Start": 1547.0,
      "Time_End": 1548.0,
      "Text": " This DDP number six is called"
    },
    {
      "Time_Start": 1548.0,
      "Time_End": 1551.0,
      "Text": " securing corporate email is tricky."
    },
    {
      "Time_Start": 1551.0,
      "Time_End": 1553.0,
      "Text": " And as you well know,"
    },
    {
      "Time_Start": 1553.0,
      "Time_End": 1555.0,
      "Text": " most attackers have various objectives."
    },
    {
      "Time_Start": 1555.0,
      "Time_End": 1560.0,
      "Text": " And a common objective often is reading victims' emails."
    },
    {
      "Time_Start": 1560.0,
      "Time_End": 1561.0,
      "Text": " Because A, perhaps,"
    },
    {
      "Time_Start": 1561.0,
      "Time_End": 1564.0,
      "Text": " that's where a lot of sensitive data goes through."
    },
    {
      "Time_Start": 1564.0,
      "Time_End": 1567.0,
      "Text": " And B, if the security team is against them"
    },
    {
      "Time_Start": 1567.0,
      "Time_End": 1569.0,
      "Text": " or is looking for them,"
    },
    {
      "Time_Start": 1569.0,
      "Time_End": 1574.0,
      "Text": " then they can be a step ahead by reading the emails."
    },
    {
      "Time_Start": 1574.0,
      "Time_End": 1577.0,
      "Text": " So most environments run using Exchange Serve"
    },
    {
      "Time_Start": 1577.0,
      "Time_End": 1579.0,
      "Text": " and Active Directory."
    },
    {
      "Time_Start": 1579.0,
      "Time_End": 1582.0,
      "Text": " And the common angles or attack angles that we observe"
    },
    {
      "Time_Start": 1582.0,
      "Time_End": 1584.0,
      "Text": " are mailbox exporting,"
    },
    {
      "Time_Start": 1584.0,
      "Time_End": 1588.0,
      "Text": " which means taking a whole email inbox offline,"
    },
    {
      "Time_Start": 1588.0,
      "Time_End": 1590.0,
      "Text": " making a copy of it, analyzing it,"
    },
    {
      "Time_Start": 1590.0,
      "Time_End": 1593.0,
      "Text": " setting up inbox forwarding rules or transport rules,"
    },
    {
      "Time_Start": 1593.0,
      "Time_End": 1598.0,
      "Text": " meaning forwarding any emails of interest from victim inboxes,"
    },
    {
      "Time_Start": 1598.0,
      "Time_End": 1600.0,
      "Text": " and also things like mailbox delegation,"
    },
    {
      "Time_Start": 1600.0,
      "Time_End": 1604.0,
      "Text": " which means that a user A can access email of user B."
    },
    {
      "Time_Start": 1604.0,
      "Time_End": 1606.0,
      "Text": " So these are very common tactics."
    },
    {
      "Time_Start": 1606.0,
      "Time_End": 1608.0,
      "Text": " What is less common are SAPI filters,"
    },
    {
      "Time_Start": 1608.0,
      "Time_End": 1612.0,
      "Text": " which are effectively plug-ins for Microsoft IES server."
    },
    {
      "Time_Start": 1612.0,
      "Time_End": 1615.0,
      "Text": " And we've seen a group that use them to capture credentials"
    },
    {
      "Time_Start": 1615.0,
      "Time_End": 1618.0,
      "Text": " when the users were logging in into OWA,"
    },
    {
      "Time_Start": 1618.0,
      "Time_End": 1620.0,
      "Text": " as well as Exchange Transport Agents,"
    },
    {
      "Time_Start": 1620.0,
      "Time_End": 1624.0,
      "Text": " which are effectively plug-ins for Exchange Server."
    },
    {
      "Time_Start": 1624.0,
      "Time_End": 1627.0,
      "Text": " And these have been around since at least 2010."
    },
    {
      "Time_Start": 1627.0,
      "Time_End": 1629.0,
      "Text": " We've seen some that were compiled in 2008,"
    },
    {
      "Time_Start": 1629.0,
      "Time_End": 1631.0,
      "Text": " if we can believe the timestamps."
    },
    {
      "Time_Start": 1631.0,
      "Time_End": 1633.0,
      "Text": " And they are less known."
    },
    {
      "Time_Start": 1633.0,
      "Time_End": 1635.0,
      "Text": " Now, here's a story of an investigation"
    },
    {
      "Time_Start": 1635.0,
      "Time_End": 1637.0,
      "Text": " where we responded and we came across"
    },
    {
      "Time_Start": 1637.0,
      "Time_End": 1640.0,
      "Text": " highly sophisticated malicious transport agents."
    },
    {
      "Time_Start": 1640.0,
      "Time_End": 1642.0,
      "Text": " It was split into three components."
    },
    {
      "Time_Start": 1642.0,
      "Time_End": 1644.0,
      "Text": " The first component had an agent."
    },
    {
      "Time_Start": 1644.0,
      "Time_End": 1646.0,
      "Text": " Well, we'll call it agent.dll."
    },
    {
      "Time_Start": 1646.0,
      "Time_End": 1648.0,
      "Text": " And this is the transport agent that they installed."
    },
    {
      "Time_Start": 1648.0,
      "Time_End": 1651.0,
      "Text": " It was very small. You could easily decompile it."
    },
    {
      "Time_Start": 1651.0,
      "Time_End": 1652.0,
      "Text": " It was written in .NET,"
    },
    {
      "Time_Start": 1652.0,
      "Time_End": 1655.0,
      "Text": " and it followed the template that's on the next slide."
    },
    {
      "Time_Start": 1655.0,
      "Time_End": 1658.0,
      "Text": " All it did was it would load the mining DLL,"
    },
    {
      "Time_Start": 1658.0,
      "Time_End": 1661.0,
      "Text": " which is the big component that did all the work,"
    },
    {
      "Time_Start": 1661.0,
      "Time_End": 1663.0,
      "Text": " and it will pass details from every single email"
    },
    {
      "Time_Start": 1663.0,
      "Time_End": 1665.0,
      "Text": " that goes in and out of the environment"
    },
    {
      "Time_Start": 1665.0,
      "Time_End": 1666.0,
      "Text": " to the mining component."
    },
    {
      "Time_Start": 1666.0,
      "Time_End": 1667.0,
      "Text": " That's all it did."
    },
    {
      "Time_Start": 1667.0,
      "Time_End": 1669.0,
      "Text": " The mining component, on the other hand,"
    },
    {
      "Time_Start": 1669.0,
      "Time_End": 1671.0,
      "Text": " was highly sophisticated."
    },
    {
      "Time_Start": 1671.0,
      "Time_End": 1673.0,
      "Text": " It was protected on disk."
    },
    {
      "Time_Start": 1673.0,
      "Time_End": 1675.0,
      "Text": " It had a separate config file."
    },
    {
      "Time_Start": 1675.0,
      "Time_End": 1677.0,
      "Text": " The attack is updated at some point."
    },
    {
      "Time_Start": 1677.0,
      "Time_End": 1678.0,
      "Text": " It would load it up,"
    },
    {
      "Time_Start": 1678.0,
      "Time_End": 1680.0,
      "Text": " and that configuration file would say things like,"
    },
    {
      "Time_Start": 1680.0,
      "Time_End": 1685.0,
      "Text": " hey, store any emails that go into these inboxes,"
    },
    {
      "Time_Start": 1685.0,
      "Time_End": 1686.0,
      "Text": " into disk in encrypted form."
    },
    {
      "Time_Start": 1686.0,
      "Time_End": 1690.0,
      "Text": " And they were using public and private key encryption."
    },
    {
      "Time_Start": 1690.0,
      "Time_End": 1692.0,
      "Text": " They were also doing things like"
    },
    {
      "Time_Start": 1692.0,
      "Time_End": 1694.0,
      "Text": " if the server runs out of space,"
    },
    {
      "Time_Start": 1694.0,
      "Time_End": 1696.0,
      "Text": " it reaches 10% of free space,"
    },
    {
      "Time_Start": 1696.0,
      "Time_End": 1697.0,
      "Text": " stop mining,"
    },
    {
      "Time_Start": 1697.0,
      "Time_End": 1699.0,
      "Text": " log any errors to file."
    },
    {
      "Time_Start": 1699.0,
      "Time_End": 1701.0,
      "Text": " And, you know, it was highly configurable."
    },
    {
      "Time_Start": 1701.0,
      "Time_End": 1703.0,
      "Text": " One of the other brilliant things that these hackers did"
    },
    {
      "Time_Start": 1703.0,
      "Time_End": 1706.0,
      "Text": " was they set up like a god email address"
    },
    {
      "Time_Start": 1706.0,
      "Time_End": 1709.0,
      "Text": " where they said anytime anything comes from that email address,"
    },
    {
      "Time_Start": 1709.0,
      "Time_End": 1712.0,
      "Text": " take the body of the email and run it as a script,"
    },
    {
      "Time_Start": 1712.0,
      "Time_End": 1714.0,
      "Text": " which essentially gave them remote access to the system."
    },
    {
      "Time_Start": 1714.0,
      "Time_End": 1716.0,
      "Text": " So really, really clever."
    },
    {
      "Time_Start": 1716.0,
      "Time_End": 1717.0,
      "Text": " And obviously the last point was"
    },
    {
      "Time_Start": 1717.0,
      "Time_End": 1719.0,
      "Text": " something that would steal those emails,"
    },
    {
      "Time_Start": 1719.0,
      "Time_End": 1721.0,
      "Text": " and for that they set up WMI Persistence."
    },
    {
      "Time_Start": 1721.0,
      "Time_End": 1724.0,
      "Text": " They regularly would run script that was encoded,"
    },
    {
      "Time_Start": 1724.0,
      "Time_End": 1728.0,
      "Text": " well, it was stored in a bit of obfuscated way in the registry,"
    },
    {
      "Time_Start": 1728.0,
      "Time_End": 1733.0,
      "Text": " and that script had a lot of anti-VMware methods,"
    },
    {
      "Time_Start": 1733.0,
      "Time_End": 1734.0,
      "Text": " and one of them was, for instance,"
    },
    {
      "Time_Start": 1734.0,
      "Time_End": 1736.0,
      "Text": " checking the parent process"
    },
    {
      "Time_Start": 1736.0,
      "Time_End": 1739.0,
      "Text": " so that if it didn't match WMI, it would terminate."
    },
    {
      "Time_Start": 1739.0,
      "Time_End": 1740.0,
      "Text": " So that even if you find it"
    },
    {
      "Time_Start": 1740.0,
      "Time_End": 1742.0,
      "Text": " and you put it in a sandbox environment,"
    },
    {
      "Time_Start": 1742.0,
      "Time_End": 1746.0,
      "Text": " it won't really execute."
    },
    {
      "Time_Start": 1746.0,
      "Time_End": 1747.0,
      "Text": " Right, so like I said,"
    },
    {
      "Time_Start": 1747.0,
      "Time_End": 1749.0,
      "Text": " this is the template on the right side."
    },
    {
      "Time_Start": 1749.0,
      "Time_End": 1750.0,
      "Text": " It's very, very simple,"
    },
    {
      "Time_Start": 1750.0,
      "Time_End": 1752.0,
      "Text": " and that's exactly what the attackers followed."
    },
    {
      "Time_Start": 1752.0,
      "Time_End": 1756.0,
      "Text": " And then there are things that both Red Team and Blue Team"
    },
    {
      "Time_Start": 1756.0,
      "Time_End": 1757.0,
      "Text": " could be on the lookout for,"
    },
    {
      "Time_Start": 1757.0,
      "Time_End": 1759.0,
      "Text": " the three commandlets."
    },
    {
      "Time_Start": 1759.0,
      "Time_End": 1761.0,
      "Text": " There is one for installing transport agents,"
    },
    {
      "Time_Start": 1761.0,
      "Time_End": 1763.0,
      "Text": " once you install it, you have to enable it,"
    },
    {
      "Time_Start": 1763.0,
      "Time_End": 1766.0,
      "Text": " and then obviously one for getting transport agents."
    },
    {
      "Time_Start": 1766.0,
      "Time_End": 1768.0,
      "Text": " And besides looking for those three in event logs,"
    },
    {
      "Time_Start": 1768.0,
      "Time_End": 1771.0,
      "Text": " you can also review Exchange Server configuration file"
    },
    {
      "Time_Start": 1771.0,
      "Time_End": 1773.0,
      "Text": " called agents.config,"
    },
    {
      "Time_Start": 1773.0,
      "Time_End": 1776.0,
      "Text": " and if you don't have a way to automate it"
    },
    {
      "Time_Start": 1776.0,
      "Time_End": 1778.0,
      "Text": " and maybe acquiring it across the environment"
    },
    {
      "Time_Start": 1778.0,
      "Time_End": 1780.0,
      "Text": " and diffing would be another way"
    },
    {
      "Time_Start": 1780.0,
      "Time_End": 1783.0,
      "Text": " to discover any discrepancies."
    },
    {
      "Time_Start": 1783.0,
      "Time_End": 1786.0,
      "Text": " So were the attackers successful?"
    },
    {
      "Time_Start": 1786.0,
      "Time_End": 1788.0,
      "Text": " Well, they introduced encryption,"
    },
    {
      "Time_Start": 1788.0,
      "Time_End": 1790.0,
      "Text": " they had a kill switch,"
    },
    {
      "Time_Start": 1790.0,
      "Time_End": 1792.0,
      "Text": " they also had anti-analysis,"
    },
    {
      "Time_Start": 1792.0,
      "Time_End": 1795.0,
      "Text": " and even an uninstalled function in the code."
    },
    {
      "Time_Start": 1795.0,
      "Time_End": 1797.0,
      "Text": " So I would say, yeah, pretty secure."
    },
    {
      "Time_Start": 1797.0,
      "Time_End": 1799.0,
      "Text": " It was highly configurable, like I said earlier."
    },
    {
      "Time_Start": 1799.0,
      "Time_End": 1800.0,
      "Text": " It was very extensible"
    },
    {
      "Time_Start": 1800.0,
      "Time_End": 1803.0,
      "Text": " with three completely independent components."
    },
    {
      "Time_Start": 1803.0,
      "Time_End": 1804.0,
      "Text": " They were forgiving,"
    },
    {
      "Time_Start": 1804.0,
      "Time_End": 1806.0,
      "Text": " meaning they were logging all the errors,"
    },
    {
      "Time_Start": 1806.0,
      "Time_End": 1808.0,
      "Text": " and it was pretty automated."
    },
    {
      "Time_Start": 1808.0,
      "Time_End": 1810.0,
      "Text": " So yeah, I would say, you know,"
    },
    {
      "Time_Start": 1810.0,
      "Time_End": 1814.0,
      "Text": " full soft development lifecycle here by the attackers."
    },
    {
      "Time_Start": 1816.0,
      "Time_End": 1818.0,
      "Text": " So what we're going to look at here"
    },
    {
      "Time_Start": 1818.0,
      "Time_End": 1820.0,
      "Text": " is a little nod to the obfuscation."
    },
    {
      "Time_Start": 1820.0,
      "Time_End": 1822.0,
      "Text": " We're going to look at some of the ways"
    },
    {
      "Time_Start": 1822.0,
      "Time_End": 1824.0,
      "Text": " that Soundbyte and Comprogo"
    },
    {
      "Time_Start": 1824.0,
      "Time_End": 1827.0,
      "Text": " have kind of utilized,"
    },
    {
      "Time_Start": 1827.0,
      "Time_End": 1830.0,
      "Text": " kind of hiding effectively from the security team."
    },
    {
      "Time_Start": 1830.0,
      "Time_End": 1831.0,
      "Text": " So a bit of interaction."
    },
    {
      "Time_Start": 1831.0,
      "Time_End": 1835.0,
      "Text": " One of these is a malicious service."
    },
    {
      "Time_Start": 1835.0,
      "Time_End": 1837.0,
      "Text": " For the top one, hands up anyone"
    },
    {
      "Time_Start": 1837.0,
      "Time_End": 1840.0,
      "Text": " who thinks this is the malicious service."
    },
    {
      "Time_Start": 1840.0,
      "Time_End": 1843.0,
      "Text": " Yeah, bottom one, anybody?"
    },
    {
      "Time_Start": 1843.0,
      "Time_End": 1845.0,
      "Text": " Quite difficult, right?"
    },
    {
      "Time_Start": 1845.0,
      "Time_End": 1847.0,
      "Text": " There was one person who thought it was the bottom,"
    },
    {
      "Time_Start": 1847.0,
      "Time_End": 1848.0,
      "Text": " at the back."
    },
    {
      "Time_Start": 1848.0,
      "Time_End": 1849.0,
      "Text": " Oh, we got one."
    },
    {
      "Time_Start": 1849.0,
      "Time_End": 1851.0,
      "Text": " I agree with you, it's the bottom one."
    },
    {
      "Time_Start": 1851.0,
      "Time_End": 1852.0,
      "Text": " Slightly easier, right,"
    },
    {
      "Time_Start": 1852.0,
      "Time_End": 1854.0,
      "Text": " if we look at the image path, right?"
    },
    {
      "Time_Start": 1854.0,
      "Time_End": 1857.0,
      "Text": " Bottom one, it's pretty bad, right?"
    },
    {
      "Time_Start": 1857.0,
      "Time_End": 1859.0,
      "Text": " Considering if you were paying attention"
    },
    {
      "Time_Start": 1859.0,
      "Time_End": 1862.0,
      "Text": " to the previous kind of HPIs for Soundbyte."
    },
    {
      "Time_Start": 1862.0,
      "Time_End": 1864.0,
      "Text": " But obviously, one of the issues we've got here"
    },
    {
      "Time_Start": 1864.0,
      "Time_End": 1866.0,
      "Text": " is we can't have two services with the same name."
    },
    {
      "Time_Start": 1866.0,
      "Time_End": 1869.0,
      "Text": " So if they're loading their tools on your system,"
    },
    {
      "Time_Start": 1869.0,
      "Time_End": 1871.0,
      "Text": " we get a conflict,"
    },
    {
      "Time_Start": 1871.0,
      "Time_End": 1872.0,
      "Text": " which obviously we don't want."
    },
    {
      "Time_Start": 1872.0,
      "Time_End": 1874.0,
      "Text": " It creates event log errors."
    },
    {
      "Time_Start": 1874.0,
      "Time_End": 1875.0,
      "Text": " It causes obviously kind of suspicion"
    },
    {
      "Time_Start": 1875.0,
      "Time_End": 1877.0,
      "Text": " from the security team."
    },
    {
      "Time_Start": 1877.0,
      "Time_End": 1882.0,
      "Text": " So what we saw them using is no break space."
    },
    {
      "Time_Start": 1882.0,
      "Time_End": 1884.0,
      "Text": " So it's a Unicode character."
    },
    {
      "Time_Start": 1884.0,
      "Time_End": 1886.0,
      "Text": " It's commonly interpreted by most applications"
    },
    {
      "Time_Start": 1886.0,
      "Time_End": 1887.0,
      "Text": " as a space."
    },
    {
      "Time_Start": 1887.0,
      "Time_End": 1890.0,
      "Text": " So at the end of the service and display names,"
    },
    {
      "Time_Start": 1890.0,
      "Time_End": 1892.0,
      "Text": " they put one of these characters here."
    },
    {
      "Time_Start": 1892.0,
      "Time_End": 1893.0,
      "Text": " And when you're looking at it"
    },
    {
      "Time_Start": 1893.0,
      "Time_End": 1895.0,
      "Text": " kind of with your standard kind of applications,"
    },
    {
      "Time_Start": 1895.0,
      "Time_End": 1898.0,
      "Text": " it looks just like a normal kind of service name."
    },
    {
      "Time_Start": 1898.0,
      "Time_End": 1900.0,
      "Text": " And you've got no real idea, obviously,"
    },
    {
      "Time_Start": 1900.0,
      "Time_End": 1904.0,
      "Text": " that it's hiding their malicious payload."
    },
    {
      "Time_Start": 1904.0,
      "Time_End": 1906.0,
      "Text": " But then we take a look at Comprogo."
    },
    {
      "Time_Start": 1906.0,
      "Time_End": 1907.0,
      "Text": " So as we discussed,"
    },
    {
      "Time_Start": 1907.0,
      "Time_End": 1909.0,
      "Text": " they're using Autodial DLL persistence,"
    },
    {
      "Time_Start": 1909.0,
      "Time_End": 1911.0,
      "Text": " and they're updating the registry key."
    },
    {
      "Time_Start": 1911.0,
      "Time_End": 1913.0,
      "Text": " Now, you could quite easily, obviously,"
    },
    {
      "Time_Start": 1913.0,
      "Time_End": 1915.0,
      "Text": " put in any kind of file name you like,"
    },
    {
      "Time_Start": 1915.0,
      "Time_End": 1917.0,
      "Text": " but it's a bit obvious."
    },
    {
      "Time_Start": 1917.0,
      "Time_End": 1918.0,
      "Text": " So what they like to do is"
    },
    {
      "Time_Start": 1918.0,
      "Time_End": 1921.0,
      "Text": " they like to use the same naming scheme."
    },
    {
      "Time_Start": 1921.0,
      "Time_End": 1924.0,
      "Text": " But obviously, you can't have more than one file name,"
    },
    {
      "Time_Start": 1924.0,
      "Time_End": 1927.0,
      "Text": " one kind of file in the system without overwriting it."
    },
    {
      "Time_Start": 1927.0,
      "Time_End": 1930.0,
      "Text": " So what they use here is an operating system command."
    },
    {
      "Time_Start": 1930.0,
      "Time_End": 1932.0,
      "Text": " Now, obviously, they could use no break space,"
    },
    {
      "Time_Start": 1932.0,
      "Time_End": 1933.0,
      "Text": " but it kind of looks a bit obvious"
    },
    {
      "Time_Start": 1933.0,
      "Time_End": 1936.0,
      "Text": " because then you have your space before your DOM."
    },
    {
      "Time_Start": 1936.0,
      "Time_End": 1938.0,
      "Text": " It kind of sticks out a little bit."
    },
    {
      "Time_Start": 1938.0,
      "Time_End": 1939.0,
      "Text": " But unlike the no break space,"
    },
    {
      "Time_Start": 1939.0,
      "Time_End": 1940.0,
      "Text": " the operating system command"
    },
    {
      "Time_Start": 1940.0,
      "Time_End": 1943.0,
      "Text": " is not actually interpreted by most applications."
    },
    {
      "Time_Start": 1943.0,
      "Time_End": 1949.0,
      "Text": " So it just looks like a standard RSA, SA, DHLP.DLL."
    },
    {
      "Time_Start": 1949.0,
      "Time_End": 1951.0,
      "Text": " So they can persist within the registry key"
    },
    {
      "Time_Start": 1951.0,
      "Time_End": 1953.0,
      "Text": " with their malicious DLL,"
    },
    {
      "Time_Start": 1953.0,
      "Time_End": 1955.0,
      "Text": " but it looks no different to the kind of standard"
    },
    {
      "Time_Start": 1955.0,
      "Time_End": 1958.0,
      "Text": " kind of technique the operating system uses."
    },
    {
      "Time_Start": 1961.0,
      "Time_End": 1962.0,
      "Text": " Thanks, Tom."
    },
    {
      "Time_Start": 1962.0,
      "Time_End": 1964.0,
      "Text": " All right, so that brings us to TTP number eight,"
    },
    {
      "Time_Start": 1964.0,
      "Time_End": 1968.0,
      "Text": " which is about, well, avoiding static IOCs."
    },
    {
      "Time_Start": 1968.0,
      "Time_End": 1970.0,
      "Text": " So a quick, quick reminder, right?"
    },
    {
      "Time_Start": 1970.0,
      "Time_End": 1972.0,
      "Text": " Everyone knows what IOCs are."
    },
    {
      "Time_Start": 1972.0,
      "Time_End": 1974.0,
      "Text": " They are a way to describe threat data,"
    },
    {
      "Time_Start": 1974.0,
      "Time_End": 1977.0,
      "Text": " things like malware, attacker TTPs,"
    },
    {
      "Time_Start": 1977.0,
      "Time_End": 1979.0,
      "Text": " evidence of compromise, things like that."
    },
    {
      "Time_Start": 1979.0,
      "Time_End": 1981.0,
      "Text": " You know, we wouldn't be manning"
    },
    {
      "Time_Start": 1981.0,
      "Time_End": 1983.0,
      "Text": " if we didn't mention OpenIOC,"
    },
    {
      "Time_Start": 1983.0,
      "Time_End": 1985.0,
      "Text": " which was developed back in 2010."
    },
    {
      "Time_Start": 1985.0,
      "Time_End": 1986.0,
      "Text": " But obviously, there are different standards."
    },
    {
      "Time_Start": 1986.0,
      "Time_End": 1989.0,
      "Text": " Yara, Styx, you know, your Cyborgs,"
    },
    {
      "Time_Start": 1989.0,
      "Time_End": 1991.0,
      "Text": " and so on and so forth."
    },
    {
      "Time_Start": 1991.0,
      "Time_End": 1993.0,
      "Text": " What an IOC can look like, right?"
    },
    {
      "Time_Start": 1993.0,
      "Time_End": 1995.0,
      "Text": " This is an example of OpenIOC one"
    },
    {
      "Time_Start": 1995.0,
      "Time_End": 1997.0,
      "Text": " where it uses a Boolean logic."
    },
    {
      "Time_Start": 1997.0,
      "Time_End": 1999.0,
      "Text": " At the top, you have your OR statement,"
    },
    {
      "Time_Start": 1999.0,
      "Time_End": 2001.0,
      "Text": " and then you have conditions."
    },
    {
      "Time_Start": 2001.0,
      "Time_End": 2003.0,
      "Text": " So to match, you would say,"
    },
    {
      "Time_Start": 2003.0,
      "Time_End": 2006.0,
      "Text": " file name is UDI32.exe,"
    },
    {
      "Time_Start": 2006.0,
      "Time_End": 2008.0,
      "Text": " or file name is something,"
    },
    {
      "Time_Start": 2008.0,
      "Time_End": 2011.0,
      "Text": " or, and, you know, you can have nested conditions,"
    },
    {
      "Time_Start": 2011.0,
      "Time_End": 2014.0,
      "Text": " negative checks, and so on and so forth."
    },
    {
      "Time_Start": 2014.0,
      "Time_End": 2016.0,
      "Text": " When you develop your IOC,"
    },
    {
      "Time_Start": 2016.0,
      "Time_End": 2017.0,
      "Text": " it's a bit of a cycle, right?"
    },
    {
      "Time_Start": 2017.0,
      "Time_End": 2019.0,
      "Text": " You start at the top, and you go,"
    },
    {
      "Time_Start": 2019.0,
      "Time_End": 2021.0,
      "Text": " we identify malicious activity."
    },
    {
      "Time_Start": 2021.0,
      "Time_End": 2022.0,
      "Text": " We move on."
    },
    {
      "Time_Start": 2022.0,
      "Time_End": 2024.0,
      "Text": " We collect and analyze data."
    },
    {
      "Time_Start": 2024.0,
      "Time_End": 2027.0,
      "Text": " Then we move, and we create IOC based on the findings,"
    },
    {
      "Time_Start": 2027.0,
      "Time_End": 2030.0,
      "Text": " and then we sweep, and we look for more."
    },
    {
      "Time_Start": 2030.0,
      "Time_End": 2032.0,
      "Text": " We tune it by reducing the noise, right?"
    },
    {
      "Time_Start": 2032.0,
      "Time_End": 2035.0,
      "Text": " We fix false positives, and then we find more evil, right?"
    },
    {
      "Time_Start": 2035.0,
      "Time_End": 2037.0,
      "Text": " At that point, the cycle repeats,"
    },
    {
      "Time_Start": 2037.0,
      "Time_End": 2038.0,
      "Text": " and you look for more."
    },
    {
      "Time_Start": 2038.0,
      "Time_End": 2041.0,
      "Text": " That's kind of just a reminder to everyone."
    },
    {
      "Time_Start": 2041.0,
      "Time_End": 2043.0,
      "Text": " So let's go about an actual example"
    },
    {
      "Time_Start": 2043.0,
      "Time_End": 2046.0,
      "Text": " where the attacker has installed a malicious service"
    },
    {
      "Time_Start": 2046.0,
      "Time_End": 2048.0,
      "Text": " that runs a DLL,"
    },
    {
      "Time_Start": 2048.0,
      "Time_End": 2051.0,
      "Text": " and there are things that you can actually signature, right?"
    },
    {
      "Time_Start": 2051.0,
      "Time_End": 2053.0,
      "Text": " So you can look at the DLL and say,"
    },
    {
      "Time_Start": 2053.0,
      "Time_End": 2055.0,
      "Text": " okay, what are the static features I can signature?"
    },
    {
      "Time_Start": 2055.0,
      "Time_End": 2058.0,
      "Text": " Maybe there is a unique export DLL name,"
    },
    {
      "Time_Start": 2058.0,
      "Time_End": 2060.0,
      "Text": " or there are some version information details"
    },
    {
      "Time_Start": 2060.0,
      "Time_End": 2061.0,
      "Text": " that I can signature,"
    },
    {
      "Time_Start": 2061.0,
      "Time_End": 2063.0,
      "Text": " and I can look for that across the environment."
    },
    {
      "Time_Start": 2063.0,
      "Time_End": 2065.0,
      "Text": " Or perhaps I'll go after the service."
    },
    {
      "Time_Start": 2065.0,
      "Time_End": 2068.0,
      "Text": " Maybe the service is unique enough, right?"
    },
    {
      "Time_Start": 2068.0,
      "Time_End": 2069.0,
      "Text": " Other things would be file properties."
    },
    {
      "Time_Start": 2069.0,
      "Time_End": 2072.0,
      "Text": " Perhaps the file was called svchose.exe,"
    },
    {
      "Time_Start": 2072.0,
      "Time_End": 2073.0,
      "Text": " and it was inflated."
    },
    {
      "Time_Start": 2073.0,
      "Time_End": 2076.0,
      "Text": " So you're looking at an svchose over 100 meg."
    },
    {
      "Time_Start": 2076.0,
      "Time_End": 2078.0,
      "Text": " There are various properties that you can look for,"
    },
    {
      "Time_Start": 2078.0,
      "Time_End": 2081.0,
      "Text": " or you can go for things like strings or unique functions,"
    },
    {
      "Time_Start": 2081.0,
      "Time_End": 2083.0,
      "Text": " but checking that across the environment"
    },
    {
      "Time_Start": 2083.0,
      "Time_End": 2086.0,
      "Text": " is obviously more costly than just looking at metadata."
    },
    {
      "Time_Start": 2086.0,
      "Time_End": 2087.0,
      "Text": " But, you know, there are many different ways"
    },
    {
      "Time_Start": 2087.0,
      "Time_End": 2088.0,
      "Text": " you could signature."
    },
    {
      "Time_Start": 2088.0,
      "Time_End": 2089.0,
      "Text": " So in this example,"
    },
    {
      "Time_Start": 2089.0,
      "Time_End": 2093.0,
      "Text": " we're looking at a highly sophisticated adversary"
    },
    {
      "Time_Start": 2093.0,
      "Time_End": 2095.0,
      "Text": " who is placing various types of backdoor,"
    },
    {
      "Time_Start": 2095.0,
      "Time_End": 2097.0,
      "Text": " and that code never repeated,"
    },
    {
      "Time_Start": 2097.0,
      "Time_End": 2099.0,
      "Text": " even across single system,"
    },
    {
      "Time_Start": 2099.0,
      "Time_End": 2101.0,
      "Text": " which meant signaturing was a little bit difficult."
    },
    {
      "Time_Start": 2101.0,
      "Time_End": 2102.0,
      "Text": " So in this instance,"
    },
    {
      "Time_Start": 2102.0,
      "Time_End": 2104.0,
      "Text": " there is a DLL that's running as a Windows service,"
    },
    {
      "Time_Start": 2104.0,
      "Time_End": 2106.0,
      "Text": " just like in the slide before,"
    },
    {
      "Time_Start": 2106.0,
      "Time_End": 2110.0,
      "Text": " and they didn't set up any export function in the registry,"
    },
    {
      "Time_Start": 2110.0,
      "Time_End": 2114.0,
      "Text": " so the export called service main will get executed."
    },
    {
      "Time_Start": 2114.0,
      "Time_End": 2115.0,
      "Text": " And when we looked,"
    },
    {
      "Time_Start": 2115.0,
      "Time_End": 2117.0,
      "Text": " and also I should say that DLL was packed,"
    },
    {
      "Time_Start": 2117.0,
      "Time_End": 2119.0,
      "Text": " so there weren't any visible strings,"
    },
    {
      "Time_Start": 2119.0,
      "Time_End": 2121.0,
      "Text": " and it was a custom packer."
    },
    {
      "Time_Start": 2121.0,
      "Time_End": 2123.0,
      "Text": " So there were no version information."
    },
    {
      "Time_Start": 2123.0,
      "Time_End": 2126.0,
      "Text": " If you look at sections over here on the left,"
    },
    {
      "Time_Start": 2126.0,
      "Time_End": 2129.0,
      "Text": " all the section names look pretty standard."
    },
    {
      "Time_Start": 2129.0,
      "Time_End": 2131.0,
      "Text": " There wasn't really much standing out."
    },
    {
      "Time_Start": 2131.0,
      "Time_End": 2133.0,
      "Text": " And then when we thought about the export names"
    },
    {
      "Time_Start": 2133.0,
      "Time_End": 2135.0,
      "Text": " as library.dll,"
    },
    {
      "Time_Start": 2135.0,
      "Time_End": 2137.0,
      "Text": " well, is it really unique or not?"
    },
    {
      "Time_Start": 2137.0,
      "Time_End": 2138.0,
      "Text": " Arguable."
    },
    {
      "Time_Start": 2138.0,
      "Time_End": 2140.0,
      "Text": " And then when we look at the exports,"
    },
    {
      "Time_Start": 2140.0,
      "Time_End": 2142.0,
      "Text": " we see that they're completely random, right?"
    },
    {
      "Time_Start": 2142.0,
      "Time_End": 2144.0,
      "Text": " And every single variant had different export names,"
    },
    {
      "Time_Start": 2145.0,
      "Time_End": 2148.0,
      "Text": " export functions, I should say."
    },
    {
      "Time_Start": 2148.0,
      "Time_End": 2150.0,
      "Text": " Now, what is really odd here"
    },
    {
      "Time_Start": 2150.0,
      "Time_End": 2153.0,
      "Text": " is that service main isn't on the list."
    },
    {
      "Time_Start": 2153.0,
      "Time_End": 2156.0,
      "Text": " So how would that code, how would that DLL load"
    },
    {
      "Time_Start": 2156.0,
      "Time_End": 2159.0,
      "Text": " if it executes service main function,"
    },
    {
      "Time_Start": 2159.0,
      "Time_End": 2162.0,
      "Text": " but service main function isn't on the list?"
    },
    {
      "Time_Start": 2162.0,
      "Time_End": 2164.0,
      "Text": " So with reverse engineering,"
    },
    {
      "Time_Start": 2164.0,
      "Time_End": 2166.0,
      "Text": " we found out that when the DLL is loaded,"
    },
    {
      "Time_Start": 2166.0,
      "Time_End": 2169.0,
      "Text": " before the function is actually executed,"
    },
    {
      "Time_Start": 2169.0,
      "Time_End": 2172.0,
      "Text": " the export table gets replaced."
    },
    {
      "Time_Start": 2172.0,
      "Time_End": 2175.0,
      "Text": " So what we saw earlier was just a fake export table"
    },
    {
      "Time_Start": 2175.0,
      "Time_End": 2177.0,
      "Text": " that's every time randomized,"
    },
    {
      "Time_Start": 2177.0,
      "Time_End": 2179.0,
      "Text": " and only once the DLL is loaded,"
    },
    {
      "Time_Start": 2179.0,
      "Time_End": 2181.0,
      "Text": " it replaces its own export table,"
    },
    {
      "Time_Start": 2181.0,
      "Time_End": 2183.0,
      "Text": " which allows it to execute."
    },
    {
      "Time_Start": 2183.0,
      "Time_End": 2185.0,
      "Text": " So very, very tricky and difficult to signature"
    },
    {
      "Time_Start": 2185.0,
      "Time_End": 2188.0,
      "Text": " if you only use your static IOCs."
    },
    {
      "Time_Start": 2188.0,
      "Time_End": 2190.0,
      "Text": " So just to wrap up,"
    },
    {
      "Time_Start": 2190.0,
      "Time_End": 2194.0,
      "Text": " we're going to take a quick look at some DDE samples."
    },
    {
      "Time_Start": 2194.0,
      "Time_End": 2196.0,
      "Text": " Originally, kind of, I guess,"
    },
    {
      "Time_Start": 2196.0,
      "Time_End": 2198.0,
      "Text": " we first saw this written about by Context"
    },
    {
      "Time_Start": 2198.0,
      "Time_End": 2200.0,
      "Text": " about 2014 time."
    },
    {
      "Time_Start": 2200.0,
      "Time_End": 2204.0,
      "Text": " As you can see here, Sense Post blogged about it in 2016."
    },
    {
      "Time_Start": 2204.0,
      "Time_End": 2207.0,
      "Text": " And then again, kind of, October 2017,"
    },
    {
      "Time_Start": 2207.0,
      "Time_End": 2210.0,
      "Text": " we see a big uptick in activity"
    },
    {
      "Time_Start": 2210.0,
      "Time_End": 2213.0,
      "Text": " because obviously they're writing about how we can use DDE"
    },
    {
      "Time_Start": 2213.0,
      "Time_End": 2215.0,
      "Text": " to execute code in Office documents"
    },
    {
      "Time_Start": 2215.0,
      "Time_End": 2217.0,
      "Text": " without using macros."
    },
    {
      "Time_Start": 2217.0,
      "Time_End": 2219.0,
      "Text": " So we thought, all right, well,"
    },
    {
      "Time_Start": 2219.0,
      "Time_End": 2220.0,
      "Text": " there's got to be some stuff out there,"
    },
    {
      "Time_Start": 2220.0,
      "Time_End": 2221.0,
      "Text": " so we wrote Yara scripts"
    },
    {
      "Time_Start": 2221.0,
      "Time_End": 2223.0,
      "Text": " and we started hunting through VirusTotal."
    },
    {
      "Time_Start": 2223.0,
      "Time_End": 2226.0,
      "Text": " So we pulled the first one."
    },
    {
      "Time_Start": 2226.0,
      "Time_End": 2228.0,
      "Text": " Well, it's not very interesting, right?"
    },
    {
      "Time_Start": 2228.0,
      "Time_End": 2229.0,
      "Text": " We're just calling calc."
    },
    {
      "Time_Start": 2229.0,
      "Time_End": 2230.0,
      "Text": " It's a bit boring."
    },
    {
      "Time_Start": 2230.0,
      "Time_End": 2233.0,
      "Text": " So we carry on hunting."
    },
    {
      "Time_Start": 2233.0,
      "Time_End": 2234.0,
      "Text": " All right, well,"
    },
    {
      "Time_Start": 2234.0,
      "Time_End": 2235.0,
      "Text": " we've also got some leak hackers here."
    },
    {
      "Time_Start": 2235.0,
      "Time_End": 2237.0,
      "Text": " They're adding a local user account,"
    },
    {
      "Time_Start": 2237.0,
      "Time_End": 2238.0,
      "Text": " hacker, password."
    },
    {
      "Time_Start": 2238.0,
      "Time_End": 2241.0,
      "Text": " They might have read that one on the Internet somewhere."
    },
    {
      "Time_Start": 2241.0,
      "Time_End": 2243.0,
      "Text": " So we keep going."
    },
    {
      "Time_Start": 2243.0,
      "Time_End": 2244.0,
      "Text": " Somebody's running IP config."
    },
    {
      "Time_Start": 2244.0,
      "Time_End": 2245.0,
      "Text": " There's no output, right?"
    },
    {
      "Time_Start": 2245.0,
      "Time_End": 2247.0,
      "Text": " Not very interesting."
    },
    {
      "Time_Start": 2247.0,
      "Time_End": 2250.0,
      "Text": " So we carry on looking through VirusTotal."
    },
    {
      "Time_Start": 2250.0,
      "Time_End": 2251.0,
      "Text": " We get a hit."
    },
    {
      "Time_Start": 2251.0,
      "Time_End": 2253.0,
      "Text": " This looks a bit more fun, right?"
    },
    {
      "Time_Start": 2253.0,
      "Time_End": 2255.0,
      "Text": " We're calling a remote object."
    },
    {
      "Time_Start": 2256.0,
      "Time_End": 2260.0,
      "Text": " So we pull the file, take a look at it."
    },
    {
      "Time_Start": 2260.0,
      "Time_End": 2263.0,
      "Text": " Oh, just a little face."
    },
    {
      "Time_Start": 2263.0,
      "Time_End": 2265.0,
      "Text": " So we carried on looking,"
    },
    {
      "Time_Start": 2265.0,
      "Time_End": 2267.0,
      "Text": " and what we found here is"
    },
    {
      "Time_Start": 2267.0,
      "Time_End": 2271.0,
      "Text": " they're using a way of bypassing application whitelisting."
    },
    {
      "Time_Start": 2271.0,
      "Time_End": 2273.0,
      "Text": " So what the attackers here are doing"
    },
    {
      "Time_Start": 2273.0,
      "Time_End": 2275.0,
      "Text": " on the sample we found on VT"
    },
    {
      "Time_Start": 2275.0,
      "Time_End": 2278.0,
      "Text": " is they're using a signed WSH script,"
    },
    {
      "Time_Start": 2278.0,
      "Time_End": 2281.0,
      "Text": " which allows them to run their own scripts"
    },
    {
      "Time_Start": 2281.0,
      "Time_End": 2284.0,
      "Text": " without it going through exploit guard on Windows."
    },
    {
      "Time_Start": 2284.0,
      "Time_End": 2286.0,
      "Text": " So it's a pretty cool technique."
    },
    {
      "Time_Start": 2286.0,
      "Time_End": 2288.0,
      "Text": " Subty's written about it."
    },
    {
      "Time_Start": 2288.0,
      "Time_End": 2290.0,
      "Text": " We've seen it a few times."
    },
    {
      "Time_Start": 2290.0,
      "Time_End": 2293.0,
      "Text": " But kind of moving on a bit more,"
    },
    {
      "Time_Start": 2293.0,
      "Time_End": 2297.0,
      "Text": " we track FIN7, a financially motivated group,"
    },
    {
      "Time_Start": 2297.0,
      "Time_End": 2301.0,
      "Text": " and what we saw is a phishing campaign that they ran."
    },
    {
      "Time_Start": 2301.0,
      "Time_End": 2304.0,
      "Text": " And here you can see they're using PowerSource,"
    },
    {
      "Time_Start": 2304.0,
      "Time_End": 2306.0,
      "Text": " again, kind of DNS C2s."
    },
    {
      "Time_Start": 2306.0,
      "Time_End": 2308.0,
      "Text": " Really interesting again,"
    },
    {
      "Time_Start": 2308.0,
      "Time_End": 2310.0,
      "Text": " but what's really cool is"
    },
    {
      "Time_Start": 2310.0,
      "Time_End": 2313.0,
      "Text": " kind of the agility some of these groups have."
    },
    {
      "Time_Start": 2313.0,
      "Time_End": 2315.0,
      "Text": " Now obviously kind of the eagle-eyed kind of guys in the audience,"
    },
    {
      "Time_Start": 2315.0,
      "Time_End": 2316.0,
      "Text": " girls in the audience,"
    },
    {
      "Time_Start": 2316.0,
      "Time_End": 2318.0,
      "Text": " sort of spotted that the SensePost blog post"
    },
    {
      "Time_Start": 2318.0,
      "Time_End": 2320.0,
      "Text": " was written on the 9th of October."
    },
    {
      "Time_Start": 2320.0,
      "Time_End": 2322.0,
      "Text": " And by the 10th of October,"
    },
    {
      "Time_Start": 2322.0,
      "Time_End": 2324.0,
      "Text": " FIN7 had created a Word document,"
    },
    {
      "Time_Start": 2324.0,
      "Time_End": 2326.0,
      "Text": " and they're using a phishing campaign"
    },
    {
      "Time_Start": 2326.0,
      "Time_End": 2328.0,
      "Text": " and kind of potentially effectively"
    },
    {
      "Time_Start": 2328.0,
      "Time_End": 2331.0,
      "Text": " infiltrated a few organizations."
    },
    {
      "Time_Start": 2333.0,
      "Time_End": 2334.0,
      "Text": " Thanks, Tom."
    },
    {
      "Time_Start": 2334.0,
      "Time_End": 2336.0,
      "Text": " Right, so that's really it."
    },
    {
      "Time_Start": 2336.0,
      "Time_End": 2339.0,
      "Text": " I'll just quickly summarize and recap the things we went over."
    },
    {
      "Time_Start": 2339.0,
      "Time_End": 2341.0,
      "Text": " So in point number one,"
    },
    {
      "Time_Start": 2341.0,
      "Time_End": 2344.0,
      "Text": " we went about AV server distributing malware"
    },
    {
      "Time_Start": 2344.0,
      "Time_End": 2346.0,
      "Text": " for the attackers."
    },
    {
      "Time_Start": 2346.0,
      "Time_End": 2347.0,
      "Text": " A bit funny."
    },
    {
      "Time_Start": 2347.0,
      "Time_End": 2348.0,
      "Text": " In the second one,"
    },
    {
      "Time_Start": 2348.0,
      "Time_End": 2352.0,
      "Text": " we have breaking the secure USB devices"
    },
    {
      "Time_Start": 2352.0,
      "Time_End": 2354.0,
      "Text": " to ruin the air gap network."
    },
    {
      "Time_Start": 2354.0,
      "Time_End": 2355.0,
      "Text": " In point number three,"
    },
    {
      "Time_Start": 2355.0,
      "Time_End": 2357.0,
      "Text": " we went about SoundByte,"
    },
    {
      "Time_Start": 2357.0,
      "Time_End": 2361.0,
      "Text": " which is APT32 malware that was using DNS for C2."
    },
    {
      "Time_Start": 2361.0,
      "Time_End": 2362.0,
      "Text": " In point number four,"
    },
    {
      "Time_Start": 2362.0,
      "Time_End": 2364.0,
      "Text": " we went about a web shell"
    },
    {
      "Time_Start": 2364.0,
      "Time_End": 2368.0,
      "Text": " that required an OTP to allow the attacker in."
    },
    {
      "Time_Start": 2368.0,
      "Time_End": 2369.0,
      "Text": " Point number five,"
    },
    {
      "Time_Start": 2369.0,
      "Time_End": 2372.0,
      "Text": " we talked about a fairly uncommon persistence mechanism."
    },
    {
      "Time_Start": 2372.0,
      "Time_End": 2373.0,
      "Text": " Point number six,"
    },
    {
      "Time_Start": 2373.0,
      "Time_End": 2374.0,
      "Text": " we talked about transport agents"
    },
    {
      "Time_Start": 2374.0,
      "Time_End": 2377.0,
      "Text": " and how the attackers used those to steal emails."
    },
    {
      "Time_Start": 2377.0,
      "Time_End": 2378.0,
      "Text": " Point number seven,"
    },
    {
      "Time_Start": 2378.0,
      "Time_End": 2380.0,
      "Text": " we talked about special characters"
    },
    {
      "Time_Start": 2380.0,
      "Time_End": 2382.0,
      "Text": " that the attackers used to blend in"
    },
    {
      "Time_Start": 2382.0,
      "Time_End": 2384.0,
      "Text": " and disguise themselves."
    },
    {
      "Time_Start": 2384.0,
      "Time_End": 2386.0,
      "Text": " Point number seven, sorry, eight,"
    },
    {
      "Time_Start": 2386.0,
      "Time_End": 2390.0,
      "Text": " we talked about how creating good signatures"
    },
    {
      "Time_Start": 2390.0,
      "Time_End": 2391.0,
      "Text": " can be very difficult"
    },
    {
      "Time_Start": 2391.0,
      "Time_End": 2394.0,
      "Text": " when the attackers really try hard to hide themselves."
    },
    {
      "Time_Start": 2394.0,
      "Time_End": 2395.0,
      "Text": " Point number nine,"
    },
    {
      "Time_Start": 2395.0,
      "Time_End": 2397.0,
      "Text": " we talked about agility of the attackers"
    },
    {
      "Time_Start": 2397.0,
      "Time_End": 2401.0,
      "Text": " and how they can adapt and use the new techniques"
    },
    {
      "Time_Start": 2401.0,
      "Time_End": 2403.0,
      "Text": " even within 24 hours"
    },
    {
      "Time_Start": 2403.0,
      "Time_End": 2407.0,
      "Text": " and use them to target victims."
    },
    {
      "Time_Start": 2407.0,
      "Time_End": 2409.0,
      "Text": " So that's all from us."
    },
    {
      "Time_Start": 2409.0,
      "Time_End": 2412.0,
      "Text": " I don't know if we have time for questions."
    },
    {
      "Time_Start": 2412.0,
      "Time_End": 2415.0,
      "Text": " Two questions?"
    },
    {
      "Time_Start": 2415.0,
      "Time_End": 2416.0,
      "Text": " All right."
    },
    {
      "Time_Start": 2416.0,
      "Time_End": 2419.0,
      "Text": " Well, then we'll open to questions."
    },
    {
      "Time_Start": 2420.0,
      "Time_End": 2422.0,
      "Text": " No questions?"
    },
    {
      "Time_Start": 2422.0,
      "Time_End": 2425.0,
      "Text": " I don't know if it's a good or a bad thing."
    },
    {
      "Time_Start": 2425.0,
      "Time_End": 2426.0,
      "Text": " All right."
    },
    {
      "Time_Start": 2426.0,
      "Time_End": 2429.0,
      "Text": " Well, in that case, thank you very much."
    },
    {
      "Time_Start": 2429.0,
      "Time_End": 2431.0,
      "Text": " Thanks for your time, guys."
    }
  ]
}