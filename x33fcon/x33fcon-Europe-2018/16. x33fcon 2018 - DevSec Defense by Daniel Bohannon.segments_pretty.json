{
  "segments": [
    {
      "Time_Start": 0.0,
      "Time_End": 14.280000000000001,
      "Text": "This text was transcribed using whisper model: large-v2\n\n All right, so last session, I'm going to try to bring the energy up, end on an energetic"
    },
    {
      "Time_Start": 14.280000000000001,
      "Time_End": 16.240000000000002,
      "Text": " note if not a high note."
    },
    {
      "Time_Start": 16.240000000000002,
      "Time_End": 18.72,
      "Text": " Today I'm going to be talking about DevSec defense."
    },
    {
      "Time_Start": 18.72,
      "Time_End": 23.18,
      "Text": " I'm going to be looking at some DevSec principles that we as defenders can use when we're going"
    },
    {
      "Time_Start": 23.18,
      "Time_End": 28.28,
      "Text": " about developing detections as well as kind of the full life cycle of developing, tuning,"
    },
    {
      "Time_Start": 28.28,
      "Time_End": 30.96,
      "Text": " and maintaining detections."
    },
    {
      "Time_Start": 30.96,
      "Time_End": 36.68,
      "Text": " So I work for Mandiant FireEye, I started doing incident response on the Mandiant consulting"
    },
    {
      "Time_Start": 36.68,
      "Time_End": 40.52,
      "Text": " side and then moved into an applied research position basically doing detection stuff all"
    },
    {
      "Time_Start": 40.52,
      "Time_End": 42.480000000000004,
      "Text": " day long."
    },
    {
      "Time_Start": 42.480000000000004,
      "Time_End": 45.32,
      "Text": " I like writing obfuscation stuff."
    },
    {
      "Time_Start": 45.32,
      "Time_End": 48.56,
      "Text": " Here's a couple of the projects that I've worked on, Cradle Crafter was actually released"
    },
    {
      "Time_Start": 48.56,
      "Time_End": 53.760000000000005,
      "Text": " here last year, and then I also really like writing detection stuff, which is the reason"
    },
    {
      "Time_Start": 53.760000000000005,
      "Time_End": 57.68000000000001,
      "Text": " I do obfuscation, which we'll look at in this talk."
    },
    {
      "Time_Start": 57.68,
      "Time_End": 63.06,
      "Text": " So my motivation for this, we're really going to kind of do a deep dive on three case studies"
    },
    {
      "Time_Start": 63.06,
      "Time_End": 66.12,
      "Text": " and we're going to kind of walk through my methodology as a defender."
    },
    {
      "Time_Start": 66.12,
      "Time_End": 70.03999999999999,
      "Text": " I'm going to look at some of the tool sets and some of the frameworks that I use to kind"
    },
    {
      "Time_Start": 70.03999999999999,
      "Time_End": 74.36,
      "Text": " of automate some of the process around detection development and kind of enumerating problem"
    },
    {
      "Time_Start": 74.36,
      "Time_End": 81.96000000000001,
      "Text": " spaces so that I can be developing more resilient detections."
    },
    {
      "Time_Start": 81.96000000000001,
      "Time_End": 86.8,
      "Text": " So I started out in IT operations, then I moved into security, as I said, I then moved"
    },
    {
      "Time_Start": 86.84,
      "Time_End": 91.28,
      "Text": " into consulting, and then now I'm in kind of applied research and development at scale"
    },
    {
      "Time_Start": 91.28,
      "Time_End": 94.84,
      "Text": " for all of the product suite that we have at FireEye and all the tools that we use as"
    },
    {
      "Time_Start": 94.84,
      "Time_End": 98.66,
      "Text": " Mandiant consultants, but there have been two things that have remained consistent across"
    },
    {
      "Time_Start": 98.66,
      "Time_End": 100.67999999999999,
      "Text": " all of these changes."
    },
    {
      "Time_Start": 100.67999999999999,
      "Time_End": 103.19999999999999,
      "Text": " One is very, very high quality coffee."
    },
    {
      "Time_Start": 103.19999999999999,
      "Time_End": 104.88,
      "Text": " I'm a huge coffee snob."
    },
    {
      "Time_Start": 104.88,
      "Time_End": 108.84,
      "Text": " And the other one is an aspiring PowerShell aficionado."
    },
    {
      "Time_Start": 108.84,
      "Time_End": 110.52,
      "Text": " Now why do I say this?"
    },
    {
      "Time_Start": 110.52,
      "Time_End": 114.47999999999999,
      "Text": " Well, attackers love PowerShell as well, and this is kind of what got me started into detection"
    },
    {
      "Time_Start": 114.48,
      "Time_End": 120.88000000000001,
      "Text": " work is seeing this tool that I'd used for, I would say, legitimate purposes for operationalizing"
    },
    {
      "Time_Start": 120.88000000000001,
      "Time_End": 124.76,
      "Text": " tasks, and now I see attackers using it, and I really got curious, how can I better detect"
    },
    {
      "Time_Start": 124.76,
      "Time_End": 125.76,
      "Text": " this?"
    },
    {
      "Time_Start": 125.76,
      "Time_End": 130.44,
      "Text": " And there's a ton of offensive tradecraft available for attackers for free, and a lot"
    },
    {
      "Time_Start": 130.44,
      "Time_End": 135.0,
      "Text": " of times you'll see, in a ton of our investigations, we'll see attackers just doing really simple"
    },
    {
      "Time_Start": 135.0,
      "Time_End": 137.48000000000002,
      "Text": " one-liner remote download cradles."
    },
    {
      "Time_Start": 137.48000000000002,
      "Time_End": 142.08,
      "Text": " This would only work on PowerShell 3 for this IWR's invoke web request, but typically you'd"
    },
    {
      "Time_Start": 142.08,
      "Time_End": 147.48000000000002,
      "Text": " see attackers do something more like this, and say PowerShell 2.0 compliant."
    },
    {
      "Time_Start": 147.48000000000002,
      "Time_End": 151.04000000000002,
      "Text": " So when I started to see this, I said, okay, what are the artifacts?"
    },
    {
      "Time_Start": 151.04000000000002,
      "Time_End": 152.04000000000002,
      "Text": " What are the behaviors?"
    },
    {
      "Time_Start": 152.04000000000002,
      "Time_End": 157.52,
      "Text": " What are the heuristics I can use to start to detect this kind of malicious activity?"
    },
    {
      "Time_Start": 157.52,
      "Time_End": 163.60000000000002,
      "Text": " And a big distinction I want to make is rigid signatures versus resilient detections."
    },
    {
      "Time_Start": 163.60000000000002,
      "Time_End": 166.44,
      "Text": " And there's a very, very big difference."
    },
    {
      "Time_Start": 166.44,
      "Time_End": 168.20000000000002,
      "Text": " One is very reactive."
    },
    {
      "Time_Start": 168.20000000000002,
      "Time_End": 171.76000000000002,
      "Text": " It's saying, I saw this thing, and there's a time and a place for that."
    },
    {
      "Time_Start": 171.79999999999998,
      "Time_End": 172.79999999999998,
      "Text": " I saw this thing."
    },
    {
      "Time_Start": 172.79999999999998,
      "Time_End": 179.39999999999998,
      "Text": " I want to detect just this thing, and we have a very focused IOC or Yara rule or snort signature"
    },
    {
      "Time_Start": 179.39999999999998,
      "Time_End": 180.39999999999998,
      "Text": " for this one thing."
    },
    {
      "Time_Start": 180.39999999999998,
      "Time_End": 181.39999999999998,
      "Text": " Maybe it's a family."
    },
    {
      "Time_Start": 181.39999999999998,
      "Time_End": 182.79999999999998,
      "Text": " Maybe it's a tool."
    },
    {
      "Time_Start": 182.79999999999998,
      "Time_End": 187.44,
      "Text": " But then we should also step back and say, well, might the attacker ever change something"
    },
    {
      "Time_Start": 187.44,
      "Time_End": 188.44,
      "Text": " about this?"
    },
    {
      "Time_Start": 188.44,
      "Time_End": 192.12,
      "Text": " How can we take a step back with a second detection and say, how can we detect this"
    },
    {
      "Time_Start": 192.12,
      "Time_End": 197.04,
      "Text": " categorically, or from a methodology perspective?"
    },
    {
      "Time_Start": 197.04,
      "Time_End": 202.72,
      "Text": " And as attacker TTPs change, so should our detections kind of."
    },
    {
      "Time_Start": 202.72,
      "Time_End": 206.0,
      "Text": " Some detections maybe don't need to change, because they're resilient enough."
    },
    {
      "Time_Start": 206.0,
      "Time_End": 207.0,
      "Text": " They're broad enough."
    },
    {
      "Time_Start": 207.0,
      "Time_End": 208.0,
      "Text": " But others do."
    },
    {
      "Time_Start": 208.0,
      "Time_End": 212.34,
      "Text": " Just as in the last talk we saw that Casey Smith or sub T tweeting out something was"
    },
    {
      "Time_Start": 212.34,
      "Time_End": 215.82,
      "Text": " being used by Finn 7 within 24 hours."
    },
    {
      "Time_Start": 215.82,
      "Time_End": 219.92,
      "Text": " We need to stay on top of this kind of stuff and say, okay, did this new technique that"
    },
    {
      "Time_Start": 219.92,
      "Time_End": 224.72,
      "Text": " just became more broadly communicated, did it affect our existing detections?"
    },
    {
      "Time_Start": 224.8,
      "Time_End": 225.8,
      "Text": " And if so, which ones?"
    },
    {
      "Time_Start": 225.8,
      "Time_End": 228.56,
      "Text": " And do we need to modify an existing one or add a new one?"
    },
    {
      "Time_Start": 228.56,
      "Time_End": 233.48,
      "Text": " Or is it covered under a larger umbrella of more methodology-based detections?"
    },
    {
      "Time_Start": 233.48,
      "Time_End": 234.48,
      "Text": " So what is this talk?"
    },
    {
      "Time_Start": 234.48,
      "Time_End": 235.48,
      "Text": " Is it about automation?"
    },
    {
      "Time_Start": 235.48,
      "Time_End": 236.48,
      "Text": " DevSec is in the title."
    },
    {
      "Time_Start": 236.48,
      "Time_End": 238.07999999999998,
      "Text": " So are you some DevOps wizard?"
    },
    {
      "Time_Start": 238.07999999999998,
      "Time_End": 239.07999999999998,
      "Text": " No."
    },
    {
      "Time_Start": 239.07999999999998,
      "Time_End": 240.07999999999998,
      "Text": " Is it about detection development?"
    },
    {
      "Time_Start": 240.07999999999998,
      "Time_End": 245.6,
      "Text": " And the answer is kind of yes to all three of those."
    },
    {
      "Time_Start": 245.6,
      "Time_End": 248.36,
      "Text": " So we're going to look at three case studies."
    },
    {
      "Time_Start": 248.36,
      "Time_End": 253.28,
      "Text": " I got more laughs out of this one than the only other time I've used this meme."
    },
    {
      "Time_Start": 253.28,
      "Time_End": 256.12,
      "Text": " So I'm glad that a couple people thought it was funny."
    },
    {
      "Time_Start": 256.12,
      "Time_End": 259.12,
      "Text": " I got, like, a lot of mixed results in the office when I asked."
    },
    {
      "Time_Start": 259.12,
      "Time_End": 262.0,
      "Text": " But I was like, I'm going to use it and see what happens."
    },
    {
      "Time_Start": 262.0,
      "Time_End": 265.6,
      "Text": " So I want to talk about my methodology for crafting detections around each of these categories."
    },
    {
      "Time_Start": 265.6,
      "Time_End": 269.36,
      "Text": " And specifically, I'm going to pull back the curtains on some of the tools that I've built"
    },
    {
      "Time_Start": 269.36,
      "Time_End": 271.72,
      "Text": " as well as tools that are publicly available."
    },
    {
      "Time_Start": 271.72,
      "Time_End": 276.78,
      "Text": " The kind of frameworks that I use to help me with this development process."
    },
    {
      "Time_Start": 276.78,
      "Time_End": 280.96,
      "Text": " So first, PowerShell obfuscation."
    },
    {
      "Time_Start": 280.96,
      "Time_End": 284.88,
      "Text": " Whenever I'm approaching a problem of detection, it's important to define what the problem"
    },
    {
      "Time_Start": 284.88,
      "Time_End": 285.88,
      "Text": " is."
    },
    {
      "Time_Start": 285.88,
      "Time_End": 286.88,
      "Text": " How prevalent is it?"
    },
    {
      "Time_Start": 286.88,
      "Time_End": 290.28,
      "Text": " What are the tools that we have at our disposal to detect this?"
    },
    {
      "Time_Start": 290.28,
      "Time_End": 294.56,
      "Text": " And what tools, if we had, we do a better job of detecting?"
    },
    {
      "Time_Start": 294.56,
      "Time_End": 297.03999999999996,
      "Text": " Sometimes we need to build tools if they don't exist."
    },
    {
      "Time_Start": 297.03999999999996,
      "Time_End": 301.88,
      "Text": " And then, obviously, develop detections and go back and test and see, does this need to"
    },
    {
      "Time_Start": 301.88,
      "Time_End": 304.88,
      "Text": " be tuned to make it more effective?"
    },
    {
      "Time_Start": 304.88,
      "Time_End": 308.67999999999995,
      "Text": " So the problem is PowerShell argument and script obfuscation can evade a lot of rigid"
    },
    {
      "Time_Start": 308.67999999999995,
      "Time_End": 309.67999999999995,
      "Text": " detections."
    },
    {
      "Time_Start": 309.68,
      "Time_End": 314.48,
      "Text": " And I want to quickly show that if we have an attacker, let's say we create a simple"
    },
    {
      "Time_Start": 314.48,
      "Time_End": 317.0,
      "Text": " URL looking for all these strings to be present."
    },
    {
      "Time_Start": 317.0,
      "Time_End": 318.0,
      "Text": " That would detect this command."
    },
    {
      "Time_Start": 318.0,
      "Time_End": 320.52,
      "Text": " But there's a lot of things that attackers can do."
    },
    {
      "Time_Start": 320.52,
      "Time_End": 326.12,
      "Text": " Like concatenating strings or PowerShell is very compliant with slashes."
    },
    {
      "Time_Start": 326.12,
      "Time_End": 332.8,
      "Text": " So when you have HTTP colon, you can have mismatched slashes and it still works."
    },
    {
      "Time_Start": 332.8,
      "Time_End": 337.64,
      "Text": " Download string, if you tokenize a PowerShell command, this is called a member token."
    },
    {
      "Time_Start": 337.64,
      "Time_End": 340.24,
      "Text": " And so you can actually put single quotes around it and double quotes."
    },
    {
      "Time_Start": 340.24,
      "Time_End": 343.24,
      "Text": " And then if you have double quotes, you can put a tick mark in front of it."
    },
    {
      "Time_Start": 343.24,
      "Time_End": 345.76,
      "Text": " That's because the tick mark is the escape character for PowerShell."
    },
    {
      "Time_Start": 345.76,
      "Time_End": 350.52,
      "Text": " And if it's escaping something that is not 0ABFNRTV, and I think in PowerShell 6 they"
    },
    {
      "Time_Start": 350.52,
      "Time_End": 353.47999999999996,
      "Text": " introduced you as another character."
    },
    {
      "Time_Start": 353.47999999999996,
      "Time_End": 356.56,
      "Text": " If you escape something that's not one of those special characters, then it doesn't"
    },
    {
      "Time_Start": 356.56,
      "Time_End": 358.28,
      "Text": " have any meaning at all."
    },
    {
      "Time_Start": 358.28,
      "Time_End": 361.71999999999997,
      "Text": " And the problem is it still appears in the arguments and the script block logs."
    },
    {
      "Time_Start": 361.71999999999997,
      "Time_End": 364.2,
      "Text": " So you can put a lot of tick marks in there."
    },
    {
      "Time_Start": 364.2,
      "Time_End": 367.8,
      "Text": " As long as you stay away from the ABFNRTV and 0."
    },
    {
      "Time_Start": 367.8,
      "Time_End": 371.0,
      "Text": " But if you really want to put ticks in front of those, you have to uppercase it and now"
    },
    {
      "Time_Start": 371.0,
      "Time_End": 372.0,
      "Text": " ticks will work."
    },
    {
      "Time_Start": 372.0,
      "Time_End": 376.08,
      "Text": " There's no uppercase 0, so that one still can't really do."
    },
    {
      "Time_Start": 376.08,
      "Time_End": 381.2,
      "Text": " But as an attacker, we can really screw around with a lot of the data set that we as defenders"
    },
    {
      "Time_Start": 381.2,
      "Time_End": 383.15999999999997,
      "Text": " rely on."
    },
    {
      "Time_Start": 383.15999999999997,
      "Time_End": 385.68,
      "Text": " So what if we wanted to treat this truly as a string?"
    },
    {
      "Time_Start": 385.68,
      "Time_End": 390.52,
      "Text": " All we have to do is encapsulate it with parentheses and concatenate it like a string."
    },
    {
      "Time_Start": 390.52,
      "Time_End": 393.71999999999997,
      "Text": " Now if you're using PowerShell 2, you're going to need to add a .invoke member, but"
    },
    {
      "Time_Start": 393.71999999999997,
      "Time_End": 398.71999999999997,
      "Text": " PowerShell 3 doesn't need it, you can have white space in that location."
    },
    {
      "Time_Start": 398.71999999999997,
      "Time_End": 402.68,
      "Text": " But we'll leave .invoke in there so it works because attackers love PowerShell 2 because"
    },
    {
      "Time_Start": 402.68,
      "Time_End": 406.79999999999995,
      "Text": " that's the lowest common denominator on all the systems that they might hit."
    },
    {
      "Time_Start": 406.79999999999995,
      "Time_End": 411.32,
      "Text": " So we can concatenate it, we can use the dash F format operator and start to reorder the"
    },
    {
      "Time_Start": 411.32,
      "Time_End": 412.32,
      "Text": " string."
    },
    {
      "Time_Start": 412.32,
      "Time_End": 413.71999999999997,
      "Text": " Again, this is just taking download string."
    },
    {
      "Time_Start": 413.71999999999997,
      "Time_End": 417.44,
      "Text": " We can go a step further and say why don't we have an array of ASCII character values"
    },
    {
      "Time_Start": 417.6,
      "Time_End": 422.0,
      "Text": " and then convert it back in memory and that's download string now."
    },
    {
      "Time_Start": 422.0,
      "Time_End": 425.28,
      "Text": " So how else can we produce a string download string?"
    },
    {
      "Time_Start": 425.28,
      "Time_End": 427.2,
      "Text": " Where do these ideas come from?"
    },
    {
      "Time_Start": 427.2,
      "Time_End": 433.32,
      "Text": " So I thought it would be cool to kind of just walk through a demo of one of the ways I thought"
    },
    {
      "Time_Start": 433.32,
      "Time_End": 438.04,
      "Text": " was okay, what if I just say new object net.web client, it creates the object, what if I pipe"
    },
    {
      "Time_Start": 438.04,
      "Time_End": 439.08,
      "Text": " it to get member?"
    },
    {
      "Time_Start": 439.08,
      "Time_End": 440.94,
      "Text": " Tell me something about this object."
    },
    {
      "Time_Start": 440.94,
      "Time_End": 443.84,
      "Text": " There's tons of methods and one of them happens to be download string."
    },
    {
      "Time_Start": 443.84,
      "Time_End": 446.32,
      "Text": " Okay, that makes sense, that's what I want."
    },
    {
      "Time_Start": 446.32,
      "Time_End": 449.7,
      "Text": " So let me actually filter down and get just that method name."
    },
    {
      "Time_Start": 449.7,
      "Time_End": 454.0,
      "Text": " So I'm going to say, hey, give this data and just let me have the object where the name"
    },
    {
      "Time_Start": 454.0,
      "Time_End": 457.0,
      "Text": " matches or like download string."
    },
    {
      "Time_Start": 457.0,
      "Time_End": 458.28,
      "Text": " Boom, there we go."
    },
    {
      "Time_Start": 458.28,
      "Time_End": 460.56,
      "Text": " And actually I'm only interested in the name field."
    },
    {
      "Time_Start": 460.56,
      "Time_End": 462.7,
      "Text": " So let me go ahead and add parentheses.name."
    },
    {
      "Time_Start": 462.7,
      "Time_End": 466.28,
      "Text": " So we'll just return the string download string."
    },
    {
      "Time_Start": 466.28,
      "Time_End": 467.52,
      "Text": " Perfect."
    },
    {
      "Time_Start": 467.52,
      "Time_End": 469.2,
      "Text": " Now how can we obfuscate this?"
    },
    {
      "Time_Start": 469.2,
      "Time_End": 473.84,
      "Text": " Well, since like is like a match, regular expression, we can use wild cards like that"
    },
    {
      "Time_Start": 473.84,
      "Time_End": 475.6,
      "Text": " and we still get download string."
    },
    {
      "Time_Start": 476.36,
      "Time_End": 479.76000000000005,
      "Text": " I like and see like is case sensitive and case insensitive."
    },
    {
      "Time_Start": 479.76000000000005,
      "Time_End": 481.64000000000004,
      "Text": " Most people don't write detections for that."
    },
    {
      "Time_Start": 481.64000000000004,
      "Time_End": 483.28000000000003,
      "Text": " Dollar sign underscore is current variable."
    },
    {
      "Time_Start": 483.28000000000003,
      "Time_End": 486.28000000000003,
      "Text": " So we can do a lot of different things like do a directory listing on a variable name"
    },
    {
      "Time_Start": 486.28000000000003,
      "Time_End": 488.40000000000003,
      "Text": " of underscore and then add a dot value."
    },
    {
      "Time_Start": 488.40000000000003,
      "Time_End": 491.6,
      "Text": " Where object, we can replace this with a question mark if we want."
    },
    {
      "Time_Start": 491.6,
      "Time_End": 494.72,
      "Text": " Get member, you can just remove get dash from any PowerShell commandlet."
    },
    {
      "Time_Start": 494.72,
      "Time_End": 497.32000000000005,
      "Text": " It automatically interprets it as the correct name."
    },
    {
      "Time_Start": 497.32000000000005,
      "Time_End": 502.24,
      "Text": " You can also use GM or you can do gal, which is the alias for get alias and pipe GM and"
    },
    {
      "Time_Start": 502.24,
      "Time_End": 504.12,
      "Text": " then pipe that into an invocation operator."
    },
    {
      "Time_Start": 504.12,
      "Time_End": 505.12,
      "Text": " Now it's get member."
    },
    {
      "Time_Start": 505.12,
      "Time_End": 506.12,
      "Text": " All right."
    },
    {
      "Time_Start": 506.12,
      "Time_End": 507.12,
      "Text": " We're still going."
    },
    {
      "Time_Start": 507.12,
      "Time_End": 511.56,
      "Text": " For an argument, net.webclient, we can throw parentheses around it and we can just concatenate"
    },
    {
      "Time_Start": 511.56,
      "Time_End": 512.5600000000001,
      "Text": " it in line."
    },
    {
      "Time_Start": 512.5600000000001,
      "Time_End": 514.16,
      "Text": " It still works."
    },
    {
      "Time_Start": 514.16,
      "Time_End": 516.2,
      "Text": " And lastly, we'll go back to new object, which is a commandlet."
    },
    {
      "Time_Start": 516.2,
      "Time_End": 520.32,
      "Text": " And in this case, we'll just use the dash F format operator and we're going to invoke"
    },
    {
      "Time_Start": 520.32,
      "Time_End": 521.32,
      "Text": " it with a dot."
    },
    {
      "Time_Start": 521.32,
      "Time_End": 522.32,
      "Text": " You could also use an ampersand."
    },
    {
      "Time_Start": 522.32,
      "Time_End": 524.28,
      "Text": " Those are both invocation operators."
    },
    {
      "Time_Start": 524.28,
      "Time_End": 529.14,
      "Text": " So we're basically going to say chop it into two substrings and then reverse the order"
    },
    {
      "Time_Start": 529.14,
      "Time_End": 532.0,
      "Text": " of those two substrings to get it to work."
    },
    {
      "Time_Start": 532.0,
      "Time_End": 533.0,
      "Text": " Perfect."
    },
    {
      "Time_Start": 533.0,
      "Time_End": 534.92,
      "Text": " So this is download string now."
    },
    {
      "Time_Start": 534.92,
      "Time_End": 538.64,
      "Text": " So let's copy this and let's create just a simple download cradle, again, something an"
    },
    {
      "Time_Start": 538.64,
      "Time_End": 542.32,
      "Text": " attacker might use."
    },
    {
      "Time_Start": 542.32,
      "Time_End": 544.28,
      "Text": " Let's just make sure that it works."
    },
    {
      "Time_Start": 544.28,
      "Time_End": 547.56,
      "Text": " And we're going to use the bit.ly totally legit link."
    },
    {
      "Time_Start": 547.56,
      "Time_End": 551.08,
      "Text": " It should just print out a green statement."
    },
    {
      "Time_Start": 551.08,
      "Time_End": 552.08,
      "Text": " Perfect."
    },
    {
      "Time_Start": 552.08,
      "Time_End": 554.48,
      "Text": " Now, let's go back and let's replace that download string."
    },
    {
      "Time_Start": 554.48,
      "Time_End": 559.36,
      "Text": " We'll just throw in our parentheses and then paste in our payload here, adjust for that"
    },
    {
      "Time_Start": 559.36,
      "Time_End": 562.36,
      "Text": " new line, hit enter, and our command works."
    },
    {
      "Time_Start": 562.36,
      "Time_End": 565.72,
      "Text": " So we can iterate like that."
    },
    {
      "Time_Start": 565.72,
      "Time_End": 570.08,
      "Text": " When I say we, I mean attackers can do that."
    },
    {
      "Time_Start": 570.08,
      "Time_End": 572.6800000000001,
      "Text": " So how does this affect my data as a defender?"
    },
    {
      "Time_Start": 572.6800000000001,
      "Time_End": 578.2,
      "Text": " How does this affect my detections as a defender?"
    },
    {
      "Time_Start": 578.2,
      "Time_End": 579.52,
      "Text": " So let's paste that in."
    },
    {
      "Time_Start": 579.52,
      "Time_End": 580.76,
      "Text": " This is now download string."
    },
    {
      "Time_Start": 580.76,
      "Time_End": 587.9200000000001,
      "Text": " And I'm kind of calling this member enumeration or string substitution obfuscation."
    },
    {
      "Time_Start": 587.9200000000001,
      "Time_End": 589.24,
      "Text": " And we can keep going."
    },
    {
      "Time_Start": 589.24,
      "Time_End": 590.24,
      "Text": " Add ticks there."
    },
    {
      "Time_Start": 591.12,
      "Time_End": 592.2,
      "Text": " Yeah, let's just keep going."
    },
    {
      "Time_Start": 592.2,
      "Time_End": 595.88,
      "Text": " New object, format operator, ASCII."
    },
    {
      "Time_Start": 595.88,
      "Time_End": 599.32,
      "Text": " In this case, we're using get command, new object with some wildcards and invoking that"
    },
    {
      "Time_Start": 599.32,
      "Time_End": 602.88,
      "Text": " with a dot from the object that's returned."
    },
    {
      "Time_Start": 602.88,
      "Time_End": 607.6800000000001,
      "Text": " And invoke expression is kind of the intelligible piece of what's left here, right?"
    },
    {
      "Time_Start": 607.6800000000001,
      "Time_End": 610.78,
      "Text": " But there's a ton of ways that you can actually invoke code."
    },
    {
      "Time_Start": 610.78,
      "Time_End": 615.2,
      "Text": " So let's just take the whole body, the rest of the command, and we'll store it in this"
    },
    {
      "Time_Start": 615.2,
      "Time_End": 616.2,
      "Text": " expression variable."
    },
    {
      "Time_Start": 616.2,
      "Time_End": 620.4000000000001,
      "Text": " And let's walk through some ways we can invoke the contents of that expression variable."
    },
    {
      "Time_Start": 620.4000000000001,
      "Time_End": 622.96,
      "Text": " So since it's a command, we can use tick marks."
    },
    {
      "Time_Start": 622.96,
      "Time_End": 626.0400000000001,
      "Text": " We can invoke it with the invocation operator."
    },
    {
      "Time_Start": 626.0400000000001,
      "Time_End": 629.0400000000001,
      "Text": " And just basically any way we can get IEX, right?"
    },
    {
      "Time_Start": 629.0400000000001,
      "Time_End": 632.08,
      "Text": " Concatenation, reordering, ASCII conversion."
    },
    {
      "Time_Start": 632.08,
      "Time_End": 634.24,
      "Text": " In this case, we're saying let me take a string."
    },
    {
      "Time_Start": 634.24,
      "Time_End": 636.1600000000001,
      "Text": " In this case, it's an empty string."
    },
    {
      "Time_Start": 636.1600000000001,
      "Time_End": 638.08,
      "Text": " And let me see this member."
    },
    {
      "Time_Start": 638.08,
      "Time_End": 639.96,
      "Text": " Now this member happens to be an overloaded member."
    },
    {
      "Time_Start": 639.96,
      "Time_End": 641.24,
      "Text": " So it will show us many members."
    },
    {
      "Time_Start": 641.24,
      "Time_End": 642.4000000000001,
      "Text": " Let me take that."
    },
    {
      "Time_Start": 642.4000000000001,
      "Time_End": 644.2,
      "Text": " Cast all that text to a string."
    },
    {
      "Time_Start": 644.2,
      "Time_End": 647.9200000000001,
      "Text": " And the 84th, 11th, and the 80th indexes are going to be I, E, and an X."
    },
    {
      "Time_Start": 647.9200000000001,
      "Time_End": 650.2,
      "Text": " And we're going to join that back together and invoke it."
    },
    {
      "Time_Start": 650.2,
      "Time_End": 651.2,
      "Text": " That is IEX."
    },
    {
      "Time_Start": 651.2,
      "Time_End": 652.96,
      "Text": " So as you can see, there's really no end."
    },
    {
      "Time_Start": 652.96,
      "Time_End": 653.96,
      "Text": " There's no limit."
    },
    {
      "Time_Start": 653.96,
      "Time_End": 658.24,
      "Text": " We're just manipulating strings and pulling the data from weird places."
    },
    {
      "Time_Start": 658.24,
      "Time_End": 662.9200000000001,
      "Text": " We could also use git command or git alias or their aliases themselves and use wildcards"
    },
    {
      "Time_Start": 662.9200000000001,
      "Time_End": 663.9200000000001,
      "Text": " there."
    },
    {
      "Time_Start": 663.9200000000001,
      "Time_End": 668.24,
      "Text": " We can take expressions, cast them to script blocks, run spaces, invoke as a workflow."
    },
    {
      "Time_Start": 668.24,
      "Time_End": 670.9200000000001,
      "Text": " This is PowerShell 3 or later."
    },
    {
      "Time_Start": 670.92,
      "Time_End": 674.28,
      "Text": " We can also go to PowerShell 1 and use this execution context."
    },
    {
      "Time_Start": 674.28,
      "Time_End": 676.52,
      "Text": " This is an automatic variable in PowerShell."
    },
    {
      "Time_Start": 676.52,
      "Time_End": 681.1999999999999,
      "Text": " And there are tons of ways that you can execute code and do a lot of stuff."
    },
    {
      "Time_Start": 681.1999999999999,
      "Time_End": 684.04,
      "Text": " And I've still only seen, like, one or two attackers use this."
    },
    {
      "Time_Start": 684.04,
      "Time_End": 687.16,
      "Text": " And I bet you a lot of defenders aren't looking for execution context."
    },
    {
      "Time_Start": 687.16,
      "Time_End": 688.36,
      "Text": " Which you should be."
    },
    {
      "Time_Start": 688.36,
      "Time_End": 690.28,
      "Text": " But if you are, attackers could just do that."
    },
    {
      "Time_Start": 690.28,
      "Time_End": 693.24,
      "Text": " And it's kind of like, ugh, how do you deal with that, right?"
    },
    {
      "Time_Start": 693.24,
      "Time_End": 696.24,
      "Text": " And this is using that substitution obfuscation."
    },
    {
      "Time_Start": 696.24,
      "Time_End": 701.32,
      "Text": " So basically, there's a lot of ways you can obfuscate any component of PowerShell."
    },
    {
      "Time_Start": 701.32,
      "Time_End": 706.76,
      "Text": " In invoke cradle crafter, which I talked about last year, I basically built out this huge"
    },
    {
      "Time_Start": 706.76,
      "Time_End": 710.4,
      "Text": " invocation list where you can go through and enumerate any of these options to kind of"
    },
    {
      "Time_Start": 710.4,
      "Time_End": 714.64,
      "Text": " have each of these components randomized so you can basically say as a defender, crap,"
    },
    {
      "Time_Start": 714.64,
      "Time_End": 715.64,
      "Text": " do I detect this?"
    },
    {
      "Time_Start": 715.64,
      "Time_End": 719.0,
      "Text": " Or what if I just generate a thousand payloads with all these options?"
    },
    {
      "Time_Start": 719.0,
      "Time_End": 722.8,
      "Text": " How many of these would I detect based on invocation syntax?"
    },
    {
      "Time_Start": 722.8,
      "Time_End": 725.76,
      "Text": " The important thing to note is that PowerShell logging is awesome."
    },
    {
      "Time_Start": 725.76,
      "Time_End": 728.16,
      "Text": " PowerShell logs are not affected by this obfuscation."
    },
    {
      "Time_Start": 728.16,
      "Time_End": 732.8,
      "Text": " But script block logs are."
    },
    {
      "Time_Start": 732.8,
      "Time_End": 740.48,
      "Text": " So invoke obfuscation, invoke cradle crafter are two or the first two obfuscation frameworks"
    },
    {
      "Time_Start": 740.48,
      "Time_End": 743.12,
      "Text": " that I wrote to make this kind of stuff easy."
    },
    {
      "Time_Start": 743.12,
      "Time_End": 748.0,
      "Text": " And again, for me, I basically wrote these as, like, custom fuzzers kind of."
    },
    {
      "Time_Start": 748.0,
      "Time_End": 753.48,
      "Text": " So that if I know something is able to be executed or moved around in a certain way,"
    },
    {
      "Time_Start": 753.48,
      "Time_End": 757.36,
      "Text": " if I can build that logic into an automated tool, then I can generate thousands of examples"
    },
    {
      "Time_Start": 757.36,
      "Time_End": 761.96,
      "Text": " that still execute properly and then write my detections off of that."
    },
    {
      "Time_Start": 761.96,
      "Time_End": 765.5600000000001,
      "Text": " So we input a simple write host command and we can go through each of the tokens and say"
    },
    {
      "Time_Start": 765.5600000000001,
      "Time_End": 771.16,
      "Text": " obfuscate the strings, obfuscate the command, the members, et cetera."
    },
    {
      "Time_Start": 771.16,
      "Time_End": 776.96,
      "Text": " Or we can just obfuscate all of it together as many times as we want and it will randomly"
    },
    {
      "Time_Start": 776.96,
      "Time_End": 779.28,
      "Text": " go through and obfuscate all of those."
    },
    {
      "Time_Start": 779.28,
      "Time_End": 783.32,
      "Text": " And at any point you can go back and say let me wrap all that in as a string layer obfuscation"
    },
    {
      "Time_Start": 783.32,
      "Time_End": 786.08,
      "Text": " and treat the whole thing as a string, in this case, let's just reverse the whole command"
    },
    {
      "Time_Start": 786.08,
      "Time_End": 790.2800000000001,
      "Text": " and concatenate it and you can do that many times over and over again and it still works."
    },
    {
      "Time_Start": 790.2800000000001,
      "Time_End": 793.8000000000001,
      "Text": " But, hey, we're almost at 3,000 characters, maybe we should compress it and save some"
    },
    {
      "Time_Start": 793.8000000000001,
      "Time_End": 794.8000000000001,
      "Text": " space."
    },
    {
      "Time_Start": 794.8000000000001,
      "Time_End": 796.7600000000001,
      "Text": " That's a function I added a couple months ago."
    },
    {
      "Time_Start": 796.7600000000001,
      "Time_End": 798.1600000000001,
      "Text": " So we just chopped off 1,000 characters."
    },
    {
      "Time_Start": 798.1600000000001,
      "Time_End": 799.1600000000001,
      "Text": " Perfect."
    },
    {
      "Time_Start": 799.1600000000001,
      "Time_End": 805.32,
      "Text": " We'll grab it to the clipboard, copy it in PowerShell and our testing 123 still works."
    },
    {
      "Time_Start": 805.32,
      "Time_End": 806.32,
      "Text": " So let's remove all that."
    },
    {
      "Time_Start": 806.32,
      "Time_End": 807.32,
      "Text": " Let's go to encoding."
    },
    {
      "Time_Start": 807.32,
      "Time_End": 808.5200000000001,
      "Text": " There's a ton of encoding here."
    },
    {
      "Time_Start": 808.5200000000001,
      "Time_End": 812.6,
      "Text": " The two ones I released last year are special character only."
    },
    {
      "Time_Start": 812.6,
      "Time_End": 814.5600000000001,
      "Text": " So 100% special characters."
    },
    {
      "Time_Start": 814.5600000000001,
      "Time_End": 818.32,
      "Text": " This was originally found by a Japanese researcher back in 2010."
    },
    {
      "Time_Start": 818.32,
      "Time_End": 819.32,
      "Text": " Payload still works."
    },
    {
      "Time_Start": 819.32,
      "Time_End": 822.76,
      "Text": " It's a really brilliant way that he came up with that."
    },
    {
      "Time_Start": 822.76,
      "Time_End": 824.16,
      "Text": " And then this is whitespace encoding."
    },
    {
      "Time_Start": 824.16,
      "Time_End": 829.44,
      "Text": " So our entire command is whitespace delimited by tabs or tabs delimited by whitespace and"
    },
    {
      "Time_Start": 829.44,
      "Time_End": 831.4,
      "Text": " then decoded by a stub at the end."
    },
    {
      "Time_Start": 831.4,
      "Time_End": 834.08,
      "Text": " As you can see, it still works."
    },
    {
      "Time_Start": 834.08,
      "Time_End": 835.76,
      "Text": " Defenders in the house feeling pretty good?"
    },
    {
      "Time_Start": 835.76,
      "Time_End": 836.76,
      "Text": " Yeah."
    },
    {
      "Time_Start": 836.76,
      "Time_End": 837.76,
      "Text": " All right."
    },
    {
      "Time_Start": 837.76,
      "Time_End": 839.36,
      "Text": " Rob's feeling good."
    },
    {
      "Time_Start": 839.36,
      "Time_End": 843.2,
      "Text": " So as a cradle crafter, you can basically just say, okay, well, let me take a completely"
    },
    {
      "Time_Start": 843.2,
      "Time_End": 844.2,
      "Text": " different approach."
    },
    {
      "Time_Start": 844.2,
      "Time_End": 846.2,
      "Text": " Maybe I don't want tick marks and stuff in my command."
    },
    {
      "Time_Start": 846.2,
      "Time_End": 853.5600000000001,
      "Text": " Maybe I just want to feed a URL to that same bitly link and explore that substitution obfuscation."
    },
    {
      "Time_Start": 853.5600000000001,
      "Time_End": 855.88,
      "Text": " So in this case, we'll set our URL to that link."
    },
    {
      "Time_Start": 855.88,
      "Time_End": 858.12,
      "Text": " We can choose between memory or disk-based cradles."
    },
    {
      "Time_Start": 858.12,
      "Time_End": 864.1800000000001,
      "Text": " We'll just go to the regular download string option and we can basically similarly choose"
    },
    {
      "Time_Start": 864.1800000000001,
      "Time_End": 868.12,
      "Text": " between different token types and obfuscate that and it highlights it yellow so you can"
    },
    {
      "Time_Start": 868.12,
      "Time_End": 869.68,
      "Text": " see the changes that happened."
    },
    {
      "Time_Start": 869.68,
      "Time_End": 873.68,
      "Text": " So now we're using git command and kind of showing it's producing different options there."
    },
    {
      "Time_Start": 873.68,
      "Time_End": 877.92,
      "Text": " Or we can use PowerShell 1.0 syntax, which gets really crazy really fast."
    },
    {
      "Time_Start": 877.92,
      "Time_End": 881.0,
      "Text": " And as you can see, it downloaded the code."
    },
    {
      "Time_Start": 881.0,
      "Time_End": 884.4,
      "Text": " It didn't actually invoke it because we didn't add an invocation syntax."
    },
    {
      "Time_Start": 884.4,
      "Time_End": 886.6,
      "Text": " But for that, this is what the screenshot was earlier."
    },
    {
      "Time_Start": 886.6,
      "Time_End": 888.04,
      "Text": " Here's the invocation menu."
    },
    {
      "Time_Start": 888.04,
      "Time_End": 889.04,
      "Text": " We'll just choose one of those."
    },
    {
      "Time_Start": 889.04,
      "Time_End": 893.64,
      "Text": " And that now is IEX."
    },
    {
      "Time_Start": 893.64,
      "Time_End": 895.44,
      "Text": " So again, it gets pretty crazy pretty fast."
    },
    {
      "Time_Start": 895.44,
      "Time_End": 896.72,
      "Text": " And as you can see, that command still works."
    },
    {
      "Time_Start": 896.72,
      "Time_End": 900.5600000000001,
      "Text": " But what you can do is you can just go to all and just run that as many times as you"
    },
    {
      "Time_Start": 900.5600000000001,
      "Time_End": 904.72,
      "Text": " want and have it go through all the pieces and randomize all of those."
    },
    {
      "Time_Start": 904.72,
      "Time_End": 910.84,
      "Text": " But then after testing to make sure it still works, you can put it in the clipboard."
    },
    {
      "Time_Start": 910.84,
      "Time_End": 915.9200000000001,
      "Text": " And then you can set it back into invoke obfuscation and say I've used cradle crafter to get substitution"
    },
    {
      "Time_Start": 915.9200000000001,
      "Time_End": 916.9200000000001,
      "Text": " obfuscation."
    },
    {
      "Time_Start": 916.9200000000001,
      "Time_End": 920.6800000000001,
      "Text": " Let me take it back into invoke obfuscation and do token layer obfuscation."
    },
    {
      "Time_Start": 920.6800000000001,
      "Time_End": 921.6800000000001,
      "Text": " Then let me go back."
    },
    {
      "Time_Start": 921.6800000000001,
      "Time_End": 924.48,
      "Text": " And it's going through randomly all the tokens that are there, which is a lot more than the"
    },
    {
      "Time_Start": 924.48,
      "Time_End": 925.48,
      "Text": " original one."
    },
    {
      "Time_Start": 925.8000000000001,
      "Time_End": 929.6800000000001,
      "Text": " And then you can go back and add all that string layer, encoding layer, all that kind"
    },
    {
      "Time_Start": 929.6800000000001,
      "Time_End": 931.0,
      "Text": " of stuff."
    },
    {
      "Time_Start": 931.0,
      "Time_End": 934.48,
      "Text": " And PowerShell script block logs will log every unwrapped layer except for the very"
    },
    {
      "Time_Start": 934.48,
      "Time_End": 935.48,
      "Text": " last one."
    },
    {
      "Time_Start": 935.48,
      "Time_End": 939.9200000000001,
      "Text": " And all that obfuscation is still going to be present."
    },
    {
      "Time_Start": 939.9200000000001,
      "Time_End": 941.28,
      "Text": " So okay."
    },
    {
      "Time_Start": 941.28,
      "Time_End": 944.96,
      "Text": " Now that we know that attackers can do that with a few clicks of a button, why did you"
    },
    {
      "Time_Start": 944.96,
      "Time_End": 945.96,
      "Text": " do that?"
    },
    {
      "Time_Start": 945.96,
      "Time_End": 946.96,
      "Text": " Like, how do we detect this?"
    },
    {
      "Time_Start": 946.96,
      "Time_End": 949.0,
      "Text": " Well, again, as defenders, let's assess our tools."
    },
    {
      "Time_Start": 949.0,
      "Time_End": 950.0,
      "Text": " What do we have?"
    },
    {
      "Time_Start": 950.0,
      "Time_End": 953.2,
      "Text": " Well, Microsoft has given us awesome PowerShell logging."
    },
    {
      "Time_Start": 954.2,
      "Time_End": 959.2800000000001,
      "Text": " But you have to know some of the limitations there in terms of how the data is still polluted"
    },
    {
      "Time_Start": 959.2800000000001,
      "Time_End": 961.9200000000001,
      "Text": " at that last level."
    },
    {
      "Time_Start": 961.9200000000001,
      "Time_End": 965.2800000000001,
      "Text": " The abstract syntax tree and the PS script analyzer are the two ones I want to focus"
    },
    {
      "Time_Start": 965.2800000000001,
      "Time_End": 967.0400000000001,
      "Text": " on here."
    },
    {
      "Time_Start": 967.0400000000001,
      "Time_End": 970.6800000000001,
      "Text": " If you take a PowerShell command, in PowerShell 2, you could use the .net language parser"
    },
    {
      "Time_Start": 970.6800000000001,
      "Time_End": 971.6800000000001,
      "Text": " to tokenize it."
    },
    {
      "Time_Start": 971.6800000000001,
      "Time_End": 976.96,
      "Text": " To say in this command, this is your parenthesis, this is a format operator, this is a string,"
    },
    {
      "Time_Start": 976.96,
      "Time_End": 977.96,
      "Text": " et cetera."
    },
    {
      "Time_Start": 977.96,
      "Time_End": 981.0,
      "Text": " But with abstract syntax tree, you get all that information, but you actually get its"
    },
    {
      "Time_Start": 981.0,
      "Time_End": 982.0,
      "Text": " relationship."
    },
    {
      "Time_Start": 982.8,
      "Time_End": 985.44,
      "Text": " Now this is really, really cool."
    },
    {
      "Time_Start": 985.44,
      "Time_End": 989.64,
      "Text": " One way that you can actually explore the AST is through this AST Explorer, which is"
    },
    {
      "Time_Start": 989.64,
      "Time_End": 992.84,
      "Text": " a nice little GUI tool that you can just throw commands in there and kind of graphically"
    },
    {
      "Time_Start": 992.84,
      "Time_End": 993.84,
      "Text": " explore."
    },
    {
      "Time_Start": 993.84,
      "Time_End": 996.72,
      "Text": " But how can we use AST?"
    },
    {
      "Time_Start": 996.72,
      "Time_End": 1001.92,
      "Text": " One thing we can do is we can use it in rickroll, because AST conveniently is in the name Rick"
    },
    {
      "Time_Start": 1001.92,
      "Time_End": 1002.92,
      "Text": " Astley."
    },
    {
      "Time_Start": 1002.92,
      "Time_End": 1003.92,
      "Text": " All right?"
    },
    {
      "Time_Start": 1003.92,
      "Time_End": 1006.88,
      "Text": " That unfortunately doesn't help you find evil, it just kind of makes new friends or enemies"
    },
    {
      "Time_Start": 1006.88,
      "Time_End": 1009.48,
      "Text": " depending on how the person received it."
    },
    {
      "Time_Start": 1009.48,
      "Time_End": 1015.32,
      "Text": " But we can also use the AST to basically extract features and say, tell me something"
    },
    {
      "Time_Start": 1015.32,
      "Time_End": 1017.48,
      "Text": " about this PowerShell command or script."
    },
    {
      "Time_Start": 1017.48,
      "Time_End": 1020.64,
      "Text": " And this is some research that Lee Holmes and I worked on last year, where we basically"
    },
    {
      "Time_Start": 1020.64,
      "Time_End": 1027.0,
      "Text": " assembled a corpus of 408,000 publicly available PowerShell scripts from GitHub, TechNet, Posh"
    },
    {
      "Time_Start": 1027.0,
      "Time_End": 1032.96,
      "Text": " Code, PowerShell Gallery, et cetera, and then we labeled portions of those scripts as obfuscated"
    },
    {
      "Time_Start": 1032.96,
      "Time_End": 1038.82,
      "Text": " or not obfuscated, and then we basically used the AST to be able to lift and extract features"
    },
    {
      "Time_Start": 1038.82,
      "Time_End": 1045.58,
      "Text": " over 5,000 features from all of these input PowerShell scripts to then use it for detection"
    },
    {
      "Time_Start": 1045.58,
      "Time_End": 1046.58,
      "Text": " purposes."
    },
    {
      "Time_Start": 1046.58,
      "Time_End": 1047.58,
      "Text": " Now, what do I mean by that?"
    },
    {
      "Time_Start": 1047.58,
      "Time_End": 1051.46,
      "Text": " Well, in this case, let's say that we use this as our download string obfuscation."
    },
    {
      "Time_Start": 1051.46,
      "Time_End": 1056.26,
      "Text": " Well, maybe as a defender I would say, well, how many in any given member, how many of"
    },
    {
      "Time_Start": 1056.26,
      "Time_End": 1060.3,
      "Text": " the characters should be alphanumeric versus special characters?"
    },
    {
      "Time_Start": 1060.3,
      "Time_End": 1061.78,
      "Text": " So here's just a little one-liner in PowerShell."
    },
    {
      "Time_Start": 1061.78,
      "Time_End": 1065.62,
      "Text": " In this case, almost half of the characters in this example are special characters."
    },
    {
      "Time_Start": 1065.62,
      "Time_End": 1067.7,
      "Text": " That's really weird in a member, right?"
    },
    {
      "Time_Start": 1067.7,
      "Time_End": 1071.76,
      "Text": " This shouldn't be the case, but I shouldn't be trying to figure out, well, how much is"
    },
    {
      "Time_Start": 1071.76,
      "Time_End": 1073.02,
      "Text": " too much, right?"
    },
    {
      "Time_Start": 1073.02,
      "Time_End": 1077.26,
      "Text": " If we have this huge corpus of scripts, we can use data science techniques to basically"
    },
    {
      "Time_Start": 1077.26,
      "Time_End": 1082.02,
      "Text": " let it decide how important is the count of special characters or the ratio, or maybe"
    },
    {
      "Time_Start": 1082.02,
      "Time_End": 1086.6200000000001,
      "Text": " the ratio of uppercase to lowercase, and all these kinds of things are what we did and"
    },
    {
      "Time_Start": 1086.6200000000001,
      "Time_End": 1093.66,
      "Text": " pull out of every single PowerShell script and command as features to say, is this obfuscated"
    },
    {
      "Time_Start": 1093.66,
      "Time_End": 1094.66,
      "Text": " or is it not?"
    },
    {
      "Time_Start": 1094.66,
      "Time_End": 1098.38,
      "Text": " And what that looks like in the end result is, in this case, we're pointing it to a directory"
    },
    {
      "Time_Start": 1098.38,
      "Time_End": 1099.8200000000002,
      "Text": " of event log files."
    },
    {
      "Time_Start": 1099.8200000000002,
      "Time_End": 1104.38,
      "Text": " We're saying, take these event log files, reassemble PowerShell scripts out of the script"
    },
    {
      "Time_Start": 1104.38,
      "Time_End": 1109.5800000000002,
      "Text": " log, the 4104s, and then pipe that into this measure RVO obfuscation function and store"
    },
    {
      "Time_Start": 1109.5800000000002,
      "Time_End": 1110.5800000000002,
      "Text": " that in res."
    },
    {
      "Time_Start": 1110.5800000000002,
      "Time_End": 1114.18,
      "Text": " And as you can see here, it's going through these scripts and it's extracting 5,000 features,"
    },
    {
      "Time_Start": 1114.18,
      "Time_End": 1118.6200000000001,
      "Text": " it's measuring them and saying, are you obfuscated, are you not, based on the learning model that"
    },
    {
      "Time_Start": 1118.6200000000001,
      "Time_End": 1119.6200000000001,
      "Text": " we built."
    },
    {
      "Time_Start": 1119.6200000000001,
      "Time_End": 1122.94,
      "Text": " And then as you can see, we have the full contents of the scripts that it's labeled"
    },
    {
      "Time_Start": 1122.94,
      "Time_End": 1125.14,
      "Text": " as malicious, or as obfuscated."
    },
    {
      "Time_Start": 1125.14,
      "Time_End": 1129.3,
      "Text": " So in this case, this is one of those whitespace only payloads."
    },
    {
      "Time_Start": 1129.3,
      "Time_End": 1130.46,
      "Text": " This is the second stage."
    },
    {
      "Time_Start": 1130.46,
      "Time_End": 1135.46,
      "Text": " This is actually what that whitespace only resolves to and script lock logging captures"
    },
    {
      "Time_Start": 1135.46,
      "Time_End": 1139.78,
      "Text": " that."
    },
    {
      "Time_Start": 1139.78,
      "Time_End": 1144.38,
      "Text": " And then also in the data, we have all 5,000 features and all the values associated with"
    },
    {
      "Time_Start": 1144.38,
      "Time_End": 1147.9,
      "Text": " that as well as things like how much time did it take to extract those features, how"
    },
    {
      "Time_Start": 1147.9,
      "Time_End": 1155.94,
      "Text": " much time did it take to measure, all that fun stuff."
    },
    {
      "Time_Start": 1155.94,
      "Time_End": 1159.74,
      "Text": " So if you're interested in that, then Lee and I published a blog post on this, or you"
    },
    {
      "Time_Start": 1159.74,
      "Time_End": 1161.2,
      "Text": " can watch us ramble on about this."
    },
    {
      "Time_Start": 1161.2,
      "Time_End": 1163.5400000000002,
      "Text": " Or just check out the source code for yourself."
    },
    {
      "Time_Start": 1163.5400000000002,
      "Time_End": 1168.94,
      "Text": " Or if you open up PowerShell and just do install-module, revoke-obfuscation, then you'll pull it from"
    },
    {
      "Time_Start": 1168.94,
      "Time_End": 1174.7,
      "Text": " the PowerShell gallery and be up and running in, like, 20 seconds."
    },
    {
      "Time_Start": 1174.7,
      "Time_End": 1177.8600000000001,
      "Text": " So attackers could also use the AST."
    },
    {
      "Time_Start": 1177.8600000000001,
      "Time_End": 1181.6200000000001,
      "Text": " Ryan Cobb is a consultant out in Texas who's done some really interesting work."
    },
    {
      "Time_Start": 1181.6200000000001,
      "Time_End": 1186.6200000000001,
      "Text": " He released this tool called PSAMSY at DerbyCon last year, a conference in Kentucky."
    },
    {
      "Time_Start": 1186.6200000000001,
      "Time_End": 1190.8600000000001,
      "Text": " Basically he used the AST and paired it with, so AMSY is the Anti-Malware Scan Interface."
    },
    {
      "Time_Start": 1190.8600000000001,
      "Time_End": 1195.3400000000001,
      "Text": " It's Microsoft's interface to say, hey, any registered AV vendors, you're welcome to interface"
    },
    {
      "Time_Start": 1195.3400000000001,
      "Time_End": 1200.98,
      "Text": " with this and actually get visibility into all this awesome script lock logging for PowerShell"
    },
    {
      "Time_Start": 1200.98,
      "Time_End": 1204.6000000000001,
      "Text": " and its additional visibility into a lot of other scripting languages to actually make"
    },
    {
      "Time_Start": 1204.6000000000001,
      "Time_End": 1209.88,
      "Text": " in-memory, have in-memory visibility to make block, no-block decisions on whether something"
    },
    {
      "Time_Start": 1209.88,
      "Time_End": 1211.4800000000002,
      "Text": " is malicious or not."
    },
    {
      "Time_Start": 1211.4800000000002,
      "Time_End": 1216.3600000000001,
      "Text": " So what he found was, okay, well, before, we as attackers could just obfuscate everything"
    },
    {
      "Time_Start": 1216.3600000000001,
      "Time_End": 1218.88,
      "Text": " with all these tools and no one detected us."
    },
    {
      "Time_Start": 1218.88,
      "Time_End": 1222.88,
      "Text": " But now with this, like, science-y kind of stuff, it's actually really easy to detect"
    },
    {
      "Time_Start": 1222.88,
      "Time_End": 1224.7600000000002,
      "Text": " super obfuscated stuff."
    },
    {
      "Time_Start": 1224.7600000000002,
      "Time_End": 1230.4,
      "Text": " So his thought process was, I can actually use the AST and say, okay, registered AV vendor,"
    },
    {
      "Time_Start": 1230.4,
      "Time_End": 1232.92,
      "Text": " you say invoke MimiKatz is malicious."
    },
    {
      "Time_Start": 1232.92,
      "Time_End": 1233.92,
      "Text": " I'm gonna obfuscate it."
    },
    {
      "Time_Start": 1234.24,
      "Time_End": 1235.24,
      "Text": " Okay."
    },
    {
      "Time_Start": 1235.24,
      "Time_End": 1236.24,
      "Text": " Will you still say it's obfuscated?"
    },
    {
      "Time_Start": 1236.24,
      "Time_End": 1237.24,
      "Text": " Okay."
    },
    {
      "Time_Start": 1237.24,
      "Time_End": 1241.3600000000001,
      "Text": " Well, maybe I'll take the plain text version and let me traverse the tree and hand you"
    },
    {
      "Time_Start": 1241.3600000000001,
      "Time_End": 1244.48,
      "Text": " every piece of the tree and say, do you think this part of the script is obfuscated?"
    },
    {
      "Time_Start": 1244.48,
      "Time_End": 1245.48,
      "Text": " No?"
    },
    {
      "Time_Start": 1245.48,
      "Time_End": 1246.48,
      "Text": " Okay."
    },
    {
      "Time_Start": 1246.48,
      "Time_End": 1247.48,
      "Text": " That's clean."
    },
    {
      "Time_Start": 1247.48,
      "Time_End": 1248.48,
      "Text": " I don't have to obfuscate any of that."
    },
    {
      "Time_Start": 1248.48,
      "Time_End": 1249.48,
      "Text": " But you say this one is obfuscated."
    },
    {
      "Time_Start": 1249.48,
      "Time_End": 1250.48,
      "Text": " All right."
    },
    {
      "Time_Start": 1250.48,
      "Time_End": 1251.48,
      "Text": " Let me find what pieces of the script are obfuscated."
    },
    {
      "Time_Start": 1251.48,
      "Time_End": 1252.48,
      "Text": " Okay."
    },
    {
      "Time_Start": 1252.48,
      "Time_End": 1253.48,
      "Text": " It's just this one chunk here and one chunk here."
    },
    {
      "Time_Start": 1253.48,
      "Time_End": 1256.3200000000002,
      "Text": " Then he just obfuscates just those two chunks."
    },
    {
      "Time_Start": 1256.3200000000002,
      "Time_End": 1262.4,
      "Text": " So he's used the AST to basically systematically minimally obfuscate PowerShell scripts based"
    },
    {
      "Time_Start": 1262.4,
      "Time_End": 1265.16,
      "Text": " on signatures for an AV vendor."
    },
    {
      "Time_Start": 1265.16,
      "Time_End": 1266.5800000000002,
      "Text": " That's really cool."
    },
    {
      "Time_Start": 1266.5800000000002,
      "Time_End": 1271.52,
      "Text": " So and he actually demonstrated on stage a minimally obfuscated script that bypassed"
    },
    {
      "Time_Start": 1271.52,
      "Time_End": 1275.44,
      "Text": " our revoke obfuscation framework."
    },
    {
      "Time_Start": 1275.44,
      "Time_End": 1276.44,
      "Text": " That was really cool."
    },
    {
      "Time_Start": 1276.44,
      "Time_End": 1278.4,
      "Text": " A really neat way to use the AST."
    },
    {
      "Time_Start": 1278.4,
      "Time_End": 1282.8400000000001,
      "Text": " So that got me thinking, how can we use the AST to detect minimal obfuscation?"
    },
    {
      "Time_Start": 1282.8400000000001,
      "Time_End": 1286.7800000000002,
      "Text": " Using purely signature-based approach for an entire PowerShell script, you can bypass"
    },
    {
      "Time_Start": 1286.7800000000002,
      "Time_End": 1288.4,
      "Text": " that so many different ways."
    },
    {
      "Time_Start": 1288.4,
      "Time_End": 1289.4,
      "Text": " Do we still do it?"
    },
    {
      "Time_Start": 1289.4,
      "Time_End": 1293.24,
      "Text": " You better believe we do, because we still get value out of that."
    },
    {
      "Time_Start": 1293.24,
      "Time_End": 1297.64,
      "Text": " If we use revoke obfuscation or something like that, then we can detect obfuscated scripts."
    },
    {
      "Time_Start": 1297.64,
      "Time_End": 1301.16,
      "Text": " But what about people who are really fine-tuning and minimally obfuscating?"
    },
    {
      "Time_Start": 1301.16,
      "Time_End": 1305.8000000000002,
      "Text": " Well, the AST will let us write signatures not on the whole script, but we can drill"
    },
    {
      "Time_Start": 1305.8000000000002,
      "Time_End": 1309.94,
      "Text": " down on very specific components of any PowerShell script or command."
    },
    {
      "Time_Start": 1309.94,
      "Time_End": 1315.3200000000002,
      "Text": " So in this case, this is basically using PS script analyzer as a framework that lets you"
    },
    {
      "Time_Start": 1315.3200000000002,
      "Time_End": 1317.64,
      "Text": " write AST-based rules."
    },
    {
      "Time_Start": 1317.64,
      "Time_End": 1321.0,
      "Text": " And most people in the PowerShell world will use it to basically do syntax checking and"
    },
    {
      "Time_Start": 1321.0,
      "Time_End": 1322.76,
      "Text": " stuff like that."
    },
    {
      "Time_Start": 1322.76,
      "Time_End": 1324.5200000000002,
      "Text": " But you can actually use it for security."
    },
    {
      "Time_Start": 1324.5200000000002,
      "Time_End": 1329.6000000000001,
      "Text": " So I'm basically saying, take any PowerShell script and give me its abstract syntax tree,"
    },
    {
      "Time_Start": 1329.6000000000001,
      "Time_End": 1334.2800000000002,
      "Text": " and then pull out all of the member expressions, all those download strings, and if any of"
    },
    {
      "Time_Start": 1334.2800000000002,
      "Time_End": 1339.5200000000002,
      "Text": " them contain a tick mark, return is true, and say, this has tick usage, this is suspicious."
    },
    {
      "Time_Start": 1339.5200000000002,
      "Time_End": 1343.0800000000002,
      "Text": " And on top of that, why don't we say, how many non-alphanumeric characters would we"
    },
    {
      "Time_Start": 1343.0800000000002,
      "Time_End": 1345.2800000000002,
      "Text": " expect to see in methods?"
    },
    {
      "Time_Start": 1345.2800000000002,
      "Time_End": 1347.0400000000002,
      "Text": " Or in members, sorry."
    },
    {
      "Time_Start": 1347.04,
      "Time_End": 1350.92,
      "Text": " And so with this corpus of almost half a million scripts, I have all this data I can"
    },
    {
      "Time_Start": 1350.92,
      "Time_End": 1353.32,
      "Text": " play with and be like, well, let me see how common this is."
    },
    {
      "Time_Start": 1353.32,
      "Time_End": 1356.8,
      "Text": " And actually, there are some cases in which these trims and trim starts and stuff like"
    },
    {
      "Time_Start": 1356.8,
      "Time_End": 1358.0,
      "Text": " that are used for."
    },
    {
      "Time_Start": 1358.0,
      "Time_End": 1367.96,
      "Text": " But basically, with this talk, I've released these just six kind of starter detection rules,"
    },
    {
      "Time_Start": 1367.96,
      "Time_End": 1371.08,
      "Text": " and they're as script analyzer rules, so you can just run invoke script analyzer, and it"
    },
    {
      "Time_Start": 1371.08,
      "Time_End": 1372.08,
      "Text": " will run all these."
    },
    {
      "Time_Start": 1372.08,
      "Time_End": 1373.8,
      "Text": " But then I wrote this wrapper function."
    },
    {
      "Time_Start": 1373.8,
      "Time_End": 1378.8799999999999,
      "Text": " So basically, this wrapper module makes it easier to kind of visualize what these rules"
    },
    {
      "Time_Start": 1378.8799999999999,
      "Time_End": 1381.04,
      "Text": " are and how they're hitting."
    },
    {
      "Time_Start": 1381.04,
      "Time_End": 1382.04,
      "Text": " So what do I mean by that?"
    },
    {
      "Time_Start": 1382.04,
      "Time_End": 1386.44,
      "Text": " Well, in this huge corpus of obfuscated scripts, we have ones that are obfuscated with invoke"
    },
    {
      "Time_Start": 1386.44,
      "Time_End": 1394.28,
      "Text": " obfuscation, and as we're running it, you can see it's showing, hey, here's the number"
    },
    {
      "Time_Start": 1394.28,
      "Time_End": 1399.1599999999999,
      "Text": " of times this element was in, this member was in your script."
    },
    {
      "Time_Start": 1399.1599999999999,
      "Time_End": 1402.48,
      "Text": " Here's the rule that it was matched on."
    },
    {
      "Time_Start": 1403.04,
      "Time_End": 1407.76,
      "Text": " I think it's number 22, I think, is using the special characters only."
    },
    {
      "Time_Start": 1407.76,
      "Time_End": 1411.96,
      "Text": " And so it's going to have, like, hundreds of examples of variables of actually methods"
    },
    {
      "Time_Start": 1411.96,
      "Time_End": 1414.92,
      "Text": " that are variables that are just special characters, like those right there."
    },
    {
      "Time_Start": 1414.92,
      "Time_End": 1417.16,
      "Text": " 500 samples of those."
    },
    {
      "Time_Start": 1417.16,
      "Time_End": 1423.2,
      "Text": " Really crazy."
    },
    {
      "Time_Start": 1423.2,
      "Time_End": 1425.88,
      "Text": " And then if you go just to the clean samples, then it just shows clean."
    },
    {
      "Time_Start": 1425.88,
      "Time_End": 1429.1200000000001,
      "Text": " But it's basically kind of a way to say, okay, what kinds of rules, like, for invoke cradle"
    },
    {
      "Time_Start": 1429.1200000000001,
      "Time_End": 1432.4,
      "Text": " craft are the kinds of rules that are hitting our ones that are looking for really long"
    },
    {
      "Time_Start": 1432.4,
      "Time_End": 1433.4,
      "Text": " member values."
    },
    {
      "Time_Start": 1433.4,
      "Time_End": 1435.24,
      "Text": " Like, that's not normal."
    },
    {
      "Time_Start": 1435.24,
      "Time_End": 1437.48,
      "Text": " The average member value is, like, 22 characters."
    },
    {
      "Time_Start": 1437.48,
      "Time_End": 1438.68,
      "Text": " Why are you over 100?"
    },
    {
      "Time_Start": 1438.68,
      "Time_End": 1440.3200000000002,
      "Text": " That's weird."
    },
    {
      "Time_Start": 1440.3200000000002,
      "Time_End": 1446.96,
      "Text": " So again, it's allowing you to write signature-like things, but very fine-tuned, focused on certain"
    },
    {
      "Time_Start": 1446.96,
      "Time_End": 1449.74,
      "Text": " elements of the language, and I think that's really cool."
    },
    {
      "Time_Start": 1449.74,
      "Time_End": 1453.88,
      "Text": " And this is a way that we can detect this minimally obfuscated stuff, just by saying,"
    },
    {
      "Time_Start": 1453.88,
      "Time_End": 1458.0400000000002,
      "Text": " let's try to define what normal is for members and then look for anything that deviates from"
    },
    {
      "Time_Start": 1458.04,
      "Time_End": 1464.24,
      "Text": " that or what normal is for strings or commands or array sizes or things of that nature."
    },
    {
      "Time_Start": 1464.24,
      "Time_End": 1467.8,
      "Text": " Anything you can dream up with the AST, you can plug into that kind of detection."
    },
    {
      "Time_Start": 1467.8,
      "Time_End": 1468.8,
      "Text": " All right."
    },
    {
      "Time_Start": 1468.8,
      "Time_End": 1470.6399999999999,
      "Text": " Enough of PowerShell."
    },
    {
      "Time_Start": 1470.6399999999999,
      "Time_End": 1471.6399999999999,
      "Text": " Command obfuscation."
    },
    {
      "Time_Start": 1471.6399999999999,
      "Time_End": 1473.1599999999999,
      "Text": " What can you possibly do with this?"
    },
    {
      "Time_Start": 1473.1599999999999,
      "Time_End": 1479.2,
      "Text": " Well, defining the problem, you can obfuscate command.x's arguments to evade rigid detections,"
    },
    {
      "Time_Start": 1479.2,
      "Time_End": 1482.56,
      "Text": " and the tools we're going to use are Pester, which is another PowerShell framework for"
    },
    {
      "Time_Start": 1482.56,
      "Time_End": 1490.52,
      "Text": " unit testing, as well as the concept of building a custom fuzzer, which I alluded to earlier."
    },
    {
      "Time_Start": 1490.52,
      "Time_End": 1494.1599999999999,
      "Text": " So attackers are already doing all cool kinds of obfuscation."
    },
    {
      "Time_Start": 1494.1599999999999,
      "Time_End": 1496.6,
      "Text": " I obsess over this every day."
    },
    {
      "Time_Start": 1496.6,
      "Time_End": 1499.6799999999998,
      "Text": " Fin 7, fin 8, and APT32 do some really cool stuff."
    },
    {
      "Time_Start": 1499.6799999999998,
      "Time_End": 1504.44,
      "Text": " Fin 7 and 32 continually vie for first place in my heart of favorite obfuscators."
    },
    {
      "Time_Start": 1504.44,
      "Time_End": 1506.5,
      "Text": " They do some really tasteful stuff."
    },
    {
      "Time_Start": 1506.5,
      "Time_End": 1512.02,
      "Text": " So to enumerate the problem space or to create better detections, I wanted to see what's"
    },
    {
      "Time_Start": 1512.02,
      "Time_End": 1513.5,
      "Text": " all possible here."
    },
    {
      "Time_Start": 1513.5,
      "Time_End": 1517.18,
      "Text": " And what got me started down this path was last June."
    },
    {
      "Time_Start": 1517.18,
      "Time_End": 1520.14,
      "Text": " We basically discovered fin 7 testing some payloads."
    },
    {
      "Time_Start": 1520.14,
      "Time_End": 1522.22,
      "Text": " Have some JavaScript obfuscation here."
    },
    {
      "Time_Start": 1522.22,
      "Time_End": 1526.34,
      "Text": " Instead of eval, they have this nice ASCII conversion from 101."
    },
    {
      "Time_Start": 1526.34,
      "Time_End": 1531.02,
      "Text": " But these two boxes in red here, this is dumped from a malicious link file."
    },
    {
      "Time_Start": 1531.02,
      "Time_End": 1533.66,
      "Text": " This really had me confused."
    },
    {
      "Time_Start": 1533.66,
      "Time_End": 1534.66,
      "Text": " What's going on here?"
    },
    {
      "Time_Start": 1534.66,
      "Time_End": 1539.8200000000002,
      "Text": " Well, they're setting this W script command into this environment variable X."
    },
    {
      "Time_Start": 1539.8200000000002,
      "Time_End": 1541.66,
      "Text": " And then at the end, they're echoing that into command."
    },
    {
      "Time_Start": 1541.66,
      "Time_End": 1542.66,
      "Text": " Okay."
    },
    {
      "Time_Start": 1542.66,
      "Time_End": 1543.66,
      "Text": " That makes sense."
    },
    {
      "Time_Start": 1543.66,
      "Time_End": 1544.66,
      "Text": " Command is doing this stuff."
    },
    {
      "Time_Start": 1544.66,
      "Time_End": 1547.1000000000001,
      "Text": " And then it's launching a child process of command and echoing the contents in."
    },
    {
      "Time_Start": 1547.1000000000001,
      "Time_End": 1549.74,
      "Text": " But what I didn't get was they had these garbage delimiters."
    },
    {
      "Time_Start": 1549.74,
      "Time_End": 1554.1000000000001,
      "Text": " They had these at signs put in W script and J script."
    },
    {
      "Time_Start": 1554.1000000000001,
      "Time_End": 1555.3400000000001,
      "Text": " And this doesn't work when you run it."
    },
    {
      "Time_Start": 1555.3400000000001,
      "Time_End": 1556.3400000000001,
      "Text": " It didn't make any sense."
    },
    {
      "Time_Start": 1556.3400000000001,
      "Time_End": 1560.8000000000002,
      "Text": " But what you'll notice is at the end, when they echo that X, they actually create space"
    },
    {
      "Time_Start": 1560.8,
      "Time_End": 1565.28,
      "Text": " after the variable name, and then they insert the syntax, which is amazing."
    },
    {
      "Time_Start": 1565.28,
      "Time_End": 1570.2,
      "Text": " It's a string replacement syntax native to command.exe that says replace the string."
    },
    {
      "Time_Start": 1570.2,
      "Time_End": 1572.52,
      "Text": " In this case, it's just the at sign."
    },
    {
      "Time_Start": 1572.52,
      "Time_End": 1575.04,
      "Text": " Replace that with whatever is on the right side of the equal sign."
    },
    {
      "Time_Start": 1575.04,
      "Time_End": 1576.56,
      "Text": " Which in this case is nothing."
    },
    {
      "Time_Start": 1576.56,
      "Time_End": 1581.04,
      "Text": " So in memory, it's saying take the variable X, remove all the at signs, and then that's"
    },
    {
      "Time_Start": 1581.04,
      "Time_End": 1582.6,
      "Text": " your value now."
    },
    {
      "Time_Start": 1582.6,
      "Time_End": 1583.6,
      "Text": " This is really cool."
    },
    {
      "Time_Start": 1583.6,
      "Time_End": 1586.6,
      "Text": " When I saw this, I was like, crap."
    },
    {
      "Time_Start": 1586.6,
      "Time_End": 1587.6,
      "Text": " What finesse."
    },
    {
      "Time_Start": 1587.6,
      "Time_End": 1589.08,
      "Text": " How awesome is that?"
    },
    {
      "Time_Start": 1589.08,
      "Time_End": 1593.4399999999998,
      "Text": " This can evade static detections looking for common W script strings in this example."
    },
    {
      "Time_Start": 1593.4399999999998,
      "Time_End": 1595.08,
      "Text": " But it removes it in memory."
    },
    {
      "Time_Start": 1595.08,
      "Time_End": 1599.6,
      "Text": " And I had no idea command.exe was capable of this."
    },
    {
      "Time_Start": 1599.6,
      "Time_End": 1603.24,
      "Text": " So basically, I spent the next nine months researching it and obsessing over it and being"
    },
    {
      "Time_Start": 1603.24,
      "Time_End": 1605.4399999999998,
      "Text": " like, what else can you do with command.exe?"
    },
    {
      "Time_Start": 1605.4399999999998,
      "Time_End": 1608.34,
      "Text": " And just last month, I released a white paper on this."
    },
    {
      "Time_Start": 1608.34,
      "Time_End": 1611.4399999999998,
      "Text": " If you have trouble sleeping, it's 36 pages, and it will put you to sleep unless you're"
    },
    {
      "Time_Start": 1611.4399999999998,
      "Time_End": 1613.84,
      "Text": " crazy about obfuscation."
    },
    {
      "Time_Start": 1613.84,
      "Time_End": 1615.6799999999998,
      "Text": " Also released this tool called invoke.obfuscation."
    },
    {
      "Time_Start": 1615.6799999999998,
      "Time_End": 1616.6799999999998,
      "Text": " Why?"
    },
    {
      "Time_Start": 1616.6799999999998,
      "Time_End": 1617.96,
      "Text": " Why in the world did I do this?"
    },
    {
      "Time_Start": 1618.04,
      "Time_End": 1622.8400000000001,
      "Text": " Well, for me, when it comes to obfuscation, it gets so deep that I can't keep all of the"
    },
    {
      "Time_Start": 1622.8400000000001,
      "Time_End": 1625.24,
      "Text": " pieces in my head to know what's possible."
    },
    {
      "Time_Start": 1625.24,
      "Time_End": 1626.76,
      "Text": " And I know I'm going to miss things."
    },
    {
      "Time_Start": 1626.76,
      "Time_End": 1632.6000000000001,
      "Text": " So basically, as I discover a possibility, like with that string replacement, the best"
    },
    {
      "Time_Start": 1632.6000000000001,
      "Time_End": 1635.0,
      "Text": " way for me to track that is to code it."
    },
    {
      "Time_Start": 1635.0,
      "Time_End": 1642.04,
      "Text": " If I can write that law or that rule as code, then I can get it out of my brain and know"
    },
    {
      "Time_Start": 1642.04,
      "Time_End": 1646.52,
      "Text": " my code knows this now, and it will produce this for me at the click of a button."
    },
    {
      "Time_Start": 1646.92,
      "Time_End": 1649.48,
      "Text": " It will produce 1,000 of these at the click of a button."
    },
    {
      "Time_Start": 1649.48,
      "Time_End": 1653.32,
      "Text": " And as you start to build all these little discoveries into this tool, that's how it"
    },
    {
      "Time_Start": 1653.32,
      "Time_End": 1657.12,
      "Text": " starts to mush all this stuff together, and as long as you're checking that it's still"
    },
    {
      "Time_Start": 1657.12,
      "Time_End": 1661.48,
      "Text": " producing valid output, then your tool will start to find things you never thought about"
    },
    {
      "Time_Start": 1661.48,
      "Time_End": 1665.92,
      "Text": " and find these really weird fringe cases that, as a defender, is awesome because it's finding"
    },
    {
      "Time_Start": 1665.92,
      "Time_End": 1671.56,
      "Text": " the things I wouldn't have thought about doing except that I built it to do that."
    },
    {
      "Time_Start": 1671.56,
      "Time_End": 1675.24,
      "Text": " So what you can do with this tool is you can take any arbitrary input to command, and you"
    },
    {
      "Time_Start": 1675.24,
      "Time_End": 1683.32,
      "Text": " can add layer upon layer upon layer of obfuscation to get something that looks like that."
    },
    {
      "Time_Start": 1683.32,
      "Time_End": 1686.76,
      "Text": " So I suffer from FOMO, except for me."
    },
    {
      "Time_Start": 1686.76,
      "Time_End": 1690.52,
      "Text": " It's a fear of missing obfuscation because I love it, and I love learning how other people"
    },
    {
      "Time_Start": 1690.52,
      "Time_End": 1693.84,
      "Text": " are obfuscating."
    },
    {
      "Time_Start": 1693.84,
      "Time_End": 1698.64,
      "Text": " So with invoked obfuscation, this I built as a custom fuzzing framework and also to"
    },
    {
      "Time_Start": 1698.64,
      "Time_End": 1702.04,
      "Text": " automate my detection."
    },
    {
      "Time_Start": 1702.04,
      "Time_End": 1707.08,
      "Text": " The ability to kind of have to build a corpus because the stuff, basically, we've not seen"
    },
    {
      "Time_Start": 1707.08,
      "Time_End": 1708.1599999999999,
      "Text": " it used in the wild."
    },
    {
      "Time_Start": 1708.1599999999999,
      "Time_End": 1710.8799999999999,
      "Text": " So how do you build a corpus of things that don't even exist yet?"
    },
    {
      "Time_Start": 1710.8799999999999,
      "Time_End": 1714.6399999999999,
      "Text": " Well, you build a tool to make it, and then you build that corpus yourself."
    },
    {
      "Time_Start": 1714.6399999999999,
      "Time_End": 1719.48,
      "Text": " And so I use Pester to basically say any time I found a new capability, I'd write Pester"
    },
    {
      "Time_Start": 1719.48,
      "Time_End": 1724.12,
      "Text": " test to basically say make sure this doesn't break functionality, and whenever I'd introduce"
    },
    {
      "Time_Start": 1724.12,
      "Time_End": 1726.96,
      "Text": " something that did, Pester would say, hey, here's exactly where you broke this."
    },
    {
      "Time_Start": 1726.96,
      "Time_End": 1729.56,
      "Text": " You need to go into the framework and fix that."
    },
    {
      "Time_Start": 1729.56,
      "Time_End": 1734.12,
      "Text": " And also Pester can say, hey, are you detecting this kind of obfuscation?"
    },
    {
      "Time_Start": 1734.12,
      "Time_End": 1738.52,
      "Text": " But the obfuscation was so many layers deep, I needed something more."
    },
    {
      "Time_Start": 1738.52,
      "Time_End": 1743.98,
      "Text": " So similar to the last example, I created a wrapper, invoked test harness, which wraps"
    },
    {
      "Time_Start": 1743.98,
      "Time_End": 1747.08,
      "Text": " around these detections."
    },
    {
      "Time_Start": 1747.08,
      "Time_End": 1750.8,
      "Text": " And this is actually what I've done with all of my obfuscation frameworks is I've done"
    },
    {
      "Time_Start": 1750.8,
      "Time_End": 1753.72,
      "Text": " this kind of stuff behind the scenes, but with invoked obfuscation, this is the first"
    },
    {
      "Time_Start": 1753.72,
      "Time_End": 1757.96,
      "Text": " time I actually released, built like a legit test harness and released it so other people"
    },
    {
      "Time_Start": 1757.96,
      "Time_End": 1759.76,
      "Text": " could benefit from it."
    },
    {
      "Time_Start": 1759.76,
      "Time_End": 1763.8400000000001,
      "Text": " So here's the animated ASCII art from invoked obfuscation, we'll just do a quick simple"
    },
    {
      "Time_Start": 1763.8400000000001,
      "Time_End": 1766.24,
      "Text": " demo of that."
    },
    {
      "Time_Start": 1766.24,
      "Time_End": 1769.68,
      "Text": " But again, you can input any arbitrary command."
    },
    {
      "Time_Start": 1769.68,
      "Time_End": 1773.3600000000001,
      "Text": " So in this case, we'll just do an echo testing obfuscation."
    },
    {
      "Time_Start": 1773.3600000000001,
      "Time_End": 1775.3600000000001,
      "Text": " We'll go straight to the payload."
    },
    {
      "Time_Start": 1775.3600000000001,
      "Time_End": 1780.76,
      "Text": " There's four main like payload encoding options, and so we'll go with fin coding or fin seven"
    },
    {
      "Time_Start": 1780.76,
      "Time_End": 1781.76,
      "Text": " style encoding."
    },
    {
      "Time_Start": 1781.76,
      "Time_End": 1785.76,
      "Text": " And we'll just choose the option three, which is the highest level kind of, we'll get to"
    },
    {
      "Time_Start": 1785.76,
      "Time_End": 1786.76,
      "Text": " that in a second."
    },
    {
      "Time_Start": 1786.76,
      "Time_End": 1787.96,
      "Text": " And it produces something like that."
    },
    {
      "Time_Start": 1787.96,
      "Time_End": 1792.08,
      "Text": " And we'll copy that to the clipboard, throw it into command prompt, and as you can see,"
    },
    {
      "Time_Start": 1792.08,
      "Time_End": 1793.08,
      "Text": " it works."
    },
    {
      "Time_Start": 1793.08,
      "Time_End": 1796.48,
      "Text": " Fun, right?"
    },
    {
      "Time_Start": 1796.48,
      "Time_End": 1799.08,
      "Text": " So as defenders, this is what you want to do, though."
    },
    {
      "Time_Start": 1799.08,
      "Time_End": 1803.6,
      "Text": " You want to say invoke pester and say, okay, this is checking to make sure all the stuff"
    },
    {
      "Time_Start": 1803.6,
      "Time_End": 1806.64,
      "Text": " you built still works and it's still producing valid code."
    },
    {
      "Time_Start": 1806.64,
      "Time_End": 1811.84,
      "Text": " And it will show some kind of basic detection of did your rules detect this obfuscated thing."
    },
    {
      "Time_Start": 1811.8400000000001,
      "Time_End": 1816.5200000000002,
      "Text": " But the real thing you want to do is run invoke dos test harness."
    },
    {
      "Time_Start": 1816.5200000000002,
      "Time_End": 1821.64,
      "Text": " And what this will do, and the version I released contains the exact commands that I use for"
    },
    {
      "Time_Start": 1821.64,
      "Time_End": 1823.1200000000001,
      "Text": " all of my testing."
    },
    {
      "Time_Start": 1823.1200000000001,
      "Time_End": 1824.1200000000001,
      "Text": " Exact commands."
    },
    {
      "Time_Start": 1824.1200000000001,
      "Time_End": 1828.0800000000002,
      "Text": " And it will basically go through and generate obfuscated versions."
    },
    {
      "Time_Start": 1828.0800000000002,
      "Time_End": 1829.1200000000001,
      "Text": " And I'll pause this for a second."
    },
    {
      "Time_Start": 1829.1200000000001,
      "Time_End": 1833.6000000000001,
      "Text": " In the tool, you basically get to choose between one, two, and three for low, medium, high."
    },
    {
      "Time_Start": 1833.6000000000001,
      "Time_End": 1835.2400000000002,
      "Text": " That's choosing like a profile."
    },
    {
      "Time_Start": 1835.2400000000002,
      "Time_End": 1838.7600000000002,
      "Text": " There's like over 20 different knobs you can adjust for every single one of these functions."
    },
    {
      "Time_Start": 1838.76,
      "Time_End": 1842.56,
      "Text": " And it's kind of choosing a set slightly randomized profile."
    },
    {
      "Time_Start": 1842.56,
      "Time_End": 1847.08,
      "Text": " But when you run invoke dos test harness, it randomly chooses every single time all"
    },
    {
      "Time_Start": 1847.08,
      "Time_End": 1848.08,
      "Text": " 20 of those flips."
    },
    {
      "Time_Start": 1848.08,
      "Time_End": 1850.68,
      "Text": " Just like a kid in an elevator flips all of them."
    },
    {
      "Time_Start": 1850.68,
      "Time_End": 1855.52,
      "Text": " So when you run the test harness, you get a much richer obfuscation range than you ever"
    },
    {
      "Time_Start": 1855.52,
      "Time_End": 1859.24,
      "Text": " would as an attacker using the tool interactively."
    },
    {
      "Time_Start": 1859.24,
      "Time_End": 1863.56,
      "Text": " So again, I tried to make the tool more user friendly for defenders than attackers because"
    },
    {
      "Time_Start": 1863.56,
      "Time_End": 1865.64,
      "Text": " that's who I made it for."
    },
    {
      "Time_Start": 1865.64,
      "Time_End": 1867.96,
      "Text": " And hopefully this test harness helps with that."
    },
    {
      "Time_Start": 1868.16,
      "Time_End": 1872.0,
      "Text": " But basically, as it's generating payloads, you'll notice there's a detection function."
    },
    {
      "Time_Start": 1872.0,
      "Time_End": 1873.3600000000001,
      "Text": " And this is the only difference in what I released."
    },
    {
      "Time_Start": 1873.3600000000001,
      "Time_End": 1875.68,
      "Text": " I didn't release my full rule set."
    },
    {
      "Time_Start": 1875.68,
      "Time_End": 1878.6000000000001,
      "Text": " Because my company spent a lot of money for me to spend nine months building that rule"
    },
    {
      "Time_Start": 1878.6000000000001,
      "Time_End": 1879.6000000000001,
      "Text": " set."
    },
    {
      "Time_Start": 1879.6000000000001,
      "Time_End": 1880.6000000000001,
      "Text": " But the concept is the same."
    },
    {
      "Time_Start": 1880.6000000000001,
      "Time_End": 1881.6000000000001,
      "Text": " You basically put in a rule."
    },
    {
      "Time_Start": 1881.6000000000001,
      "Time_End": 1883.04,
      "Text": " In this case, it's just a regex."
    },
    {
      "Time_Start": 1883.04,
      "Time_End": 1885.88,
      "Text": " And say let me say what this rule is looking for."
    },
    {
      "Time_Start": 1885.88,
      "Time_End": 1887.08,
      "Text": " And then add the regex in."
    },
    {
      "Time_Start": 1887.08,
      "Time_End": 1890.44,
      "Text": " And I'll fast forward just a second."
    },
    {
      "Time_Start": 1890.44,
      "Time_End": 1894.18,
      "Text": " And when it's done generating all these payloads, what it's going to do is it will execute the"
    },
    {
      "Time_Start": 1894.18,
      "Time_End": 1897.24,
      "Text": " command locally just to say I want to make sure this thing actually runs and that it's"
    },
    {
      "Time_Start": 1897.24,
      "Time_End": 1899.6,
      "Text": " producing the correct output."
    },
    {
      "Time_Start": 1899.6,
      "Time_End": 1903.96,
      "Text": " And then it's going to check the detection rules and say did this payload match on anything?"
    },
    {
      "Time_Start": 1903.96,
      "Time_End": 1907.44,
      "Text": " And as you can see, several of these match on a lot of them."
    },
    {
      "Time_Start": 1907.44,
      "Time_End": 1911.6,
      "Text": " But I removed a couple of my rules so that, hey, these two didn't match on anything."
    },
    {
      "Time_Start": 1911.6,
      "Time_End": 1912.6,
      "Text": " Now why is this important?"
    },
    {
      "Time_Start": 1912.6,
      "Time_End": 1916.08,
      "Text": " Well, this is important because when I run a couple thousand commands when I go to bed"
    },
    {
      "Time_Start": 1916.08,
      "Time_End": 1921.0,
      "Text": " and I wake up and see a few that I missed, my tool just helped me find a false negative"
    },
    {
      "Time_Start": 1921.0,
      "Time_End": 1923.72,
      "Text": " that I thought I had covered but I didn't."
    },
    {
      "Time_Start": 1923.72,
      "Time_End": 1927.08,
      "Text": " So then I get to look at it and go, okay, what about this evaded my detection?"
    },
    {
      "Time_Start": 1927.08,
      "Time_End": 1931.1999999999998,
      "Text": " Because the new thing I added last night, this new capability."
    },
    {
      "Time_Start": 1931.1999999999998,
      "Time_End": 1934.48,
      "Text": " And then you can see some of these rules, some of these commands actually had over ten"
    },
    {
      "Time_Start": 1934.48,
      "Time_End": 1935.48,
      "Text": " different hits."
    },
    {
      "Time_Start": 1935.48,
      "Time_End": 1936.48,
      "Text": " Awesome."
    },
    {
      "Time_Start": 1936.48,
      "Time_End": 1938.08,
      "Text": " I like detecting stuff over ten different ways."
    },
    {
      "Time_Start": 1938.08,
      "Time_End": 1940.76,
      "Text": " But some of them only had one or two."
    },
    {
      "Time_Start": 1940.76,
      "Time_End": 1943.6,
      "Text": " That means an attacker only has to change those two pieces to evade."
    },
    {
      "Time_Start": 1943.6,
      "Time_End": 1951.0,
      "Text": " So I really want multiple hits on all of these detections or on all of these samples."
    },
    {
      "Time_Start": 1951.0,
      "Time_End": 1952.52,
      "Text": " So that's how I use the test harness."
    },
    {
      "Time_Start": 1952.52,
      "Time_End": 1956.6,
      "Text": " And that's the concept I really do apply to all of the obfuscation stuff I do."
    },
    {
      "Time_Start": 1956.6000000000001,
      "Time_End": 1959.2,
      "Text": " The very last one is framework fuzzing."
    },
    {
      "Time_Start": 1959.2,
      "Time_End": 1963.88,
      "Text": " So there's people who add obfuscation to frameworks, publicly available frameworks, and the tools"
    },
    {
      "Time_Start": 1963.88,
      "Time_End": 1968.2,
      "Text": " we have here are called control C and control V to copy source code because that's really"
    },
    {
      "Time_Start": 1968.2,
      "Time_End": 1972.6000000000001,
      "Text": " nice and then the for loop of any sort you're choosing to basically say let me generate"
    },
    {
      "Time_Start": 1972.6000000000001,
      "Time_End": 1976.72,
      "Text": " a lot of this thing and see what the results kind of look like."
    },
    {
      "Time_Start": 1976.72,
      "Time_End": 1977.72,
      "Text": " Why do we do this?"
    },
    {
      "Time_Start": 1977.72,
      "Time_End": 1980.44,
      "Text": " Well, because developing a custom fuzzer takes a lot of time."
    },
    {
      "Time_Start": 1980.44,
      "Time_End": 1984.0000000000002,
      "Text": " It took me nine months to do that obfuscation stuff and now the community can benefit from"
    },
    {
      "Time_Start": 1984.0000000000002,
      "Time_End": 1986.3400000000001,
      "Text": " it with zero hours of effort."
    },
    {
      "Time_Start": 1986.3400000000001,
      "Time_End": 1990.5400000000002,
      "Text": " But there's a lot of tools out there that you don't have to actually build any custom"
    },
    {
      "Time_Start": 1990.5400000000002,
      "Time_End": 1991.5400000000002,
      "Text": " stuff."
    },
    {
      "Time_Start": 1991.5400000000002,
      "Time_End": 1995.46,
      "Text": " And so no, just so no tool developers would think I'm picking on them, I'm picking on"
    },
    {
      "Time_Start": 1995.46,
      "Time_End": 1996.8600000000001,
      "Text": " my own tool."
    },
    {
      "Time_Start": 1996.8600000000001,
      "Time_End": 2000.2,
      "Text": " I said invoke obfuscation does that crazy IEX stuff, right?"
    },
    {
      "Time_Start": 2000.2,
      "Time_End": 2003.18,
      "Text": " So let me go to the source code of this invoke obfuscation project."
    },
    {
      "Time_Start": 2003.18,
      "Time_End": 2007.7,
      "Text": " Lines 873 through 888 contain these several lines that are basically for every loop it"
    },
    {
      "Time_Start": 2007.7,
      "Time_End": 2013.3000000000002,
      "Text": " adds six randomly generated payload options for obfuscated IEX."
    },
    {
      "Time_Start": 2013.3,
      "Time_End": 2016.02,
      "Text": " I'm going to run this ten times, which means we're going to get ten times six."
    },
    {
      "Time_Start": 2016.02,
      "Time_End": 2020.74,
      "Text": " We're going to get 60 samples and then going to sort and unique them and then there's output."
    },
    {
      "Time_Start": 2020.74,
      "Time_End": 2026.34,
      "Text": " Here's how many samples we created and here's how many samples were unique."
    },
    {
      "Time_Start": 2026.34,
      "Time_End": 2029.98,
      "Text": " And this is just kind of generating just the sample data set."
    },
    {
      "Time_Start": 2029.98,
      "Time_End": 2032.86,
      "Text": " So with 60 we got 39."
    },
    {
      "Time_Start": 2032.86,
      "Time_End": 2033.86,
      "Text": " Let's increase it to 100."
    },
    {
      "Time_Start": 2033.86,
      "Time_End": 2036.02,
      "Text": " So in 600 we get 56."
    },
    {
      "Time_Start": 2036.02,
      "Time_End": 2037.7,
      "Text": " Let's increase it more and see if we get more than 56."
    },
    {
      "Time_Start": 2037.7,
      "Time_End": 2041.98,
      "Text": " I'm kind of enumerating this problem space so I can get the complete list of what's possible"
    },
    {
      "Time_Start": 2042.14,
      "Time_End": 2043.14,
      "Text": " with this exact code."
    },
    {
      "Time_Start": 2043.14,
      "Time_End": 2044.14,
      "Text": " All right."
    },
    {
      "Time_Start": 2044.14,
      "Time_End": 2045.8600000000001,
      "Text": " So 56 seems to be the limit we're hitting there."
    },
    {
      "Time_Start": 2045.8600000000001,
      "Time_End": 2048.66,
      "Text": " And one thing I can do is say let me just remove white space because I know that's going"
    },
    {
      "Time_Start": 2048.66,
      "Time_End": 2052.94,
      "Text": " to be randomly added in and see if that reduces our data set."
    },
    {
      "Time_Start": 2052.94,
      "Time_End": 2056.06,
      "Text": " And when we do, we'll see it goes from 56 down to 28."
    },
    {
      "Time_Start": 2056.06,
      "Time_End": 2057.06,
      "Text": " Perfect."
    },
    {
      "Time_Start": 2057.06,
      "Time_End": 2059.18,
      "Text": " So it's stored in this unique syntaxes."
    },
    {
      "Time_Start": 2059.18,
      "Time_End": 2064.06,
      "Text": " So here's all the different syntaxes of IEX that this source code will produce."
    },
    {
      "Time_Start": 2064.06,
      "Time_End": 2071.62,
      "Text": " Now I'm going to jump over and basically apply the same idea that the test harness was, which"
    },
    {
      "Time_Start": 2071.7799999999997,
      "Time_End": 2077.42,
      "Text": " let me just have an array of regexes to look at this and say would I detect any of these"
    },
    {
      "Time_Start": 2077.42,
      "Time_End": 2082.66,
      "Text": " payloads or any of these syntaxes and then kind of output just the detection rate."
    },
    {
      "Time_Start": 2082.66,
      "Time_End": 2086.8199999999997,
      "Text": " So if we run it right now with the regex being detection regex goes here, surprisingly we"
    },
    {
      "Time_Start": 2086.8199999999997,
      "Time_End": 2087.8199999999997,
      "Text": " catch none of it."
    },
    {
      "Time_Start": 2087.8199999999997,
      "Time_End": 2088.8199999999997,
      "Text": " It makes sense."
    },
    {
      "Time_Start": 2088.8199999999997,
      "Time_End": 2089.8199999999997,
      "Text": " All right."
    },
    {
      "Time_Start": 2089.8199999999997,
      "Time_End": 2090.8199999999997,
      "Text": " We caught zero."
    },
    {
      "Time_Start": 2090.8199999999997,
      "Time_End": 2092.46,
      "Text": " So let's look at some of this and kind of scroll through and see, okay, what are some"
    },
    {
      "Time_Start": 2092.46,
      "Time_End": 2093.46,
      "Text": " patterns we see?"
    },
    {
      "Time_Start": 2093.46,
      "Time_End": 2094.46,
      "Text": " All right."
    },
    {
      "Time_Start": 2094.46,
      "Time_End": 2096.7,
      "Text": " Well, I see some variables that are being added."
    },
    {
      "Time_Start": 2096.7,
      "Time_End": 2099.14,
      "Text": " So let's just go with this first one, PS home."
    },
    {
      "Time_Start": 2099.14,
      "Time_End": 2100.7,
      "Text": " The numbers are kind of different."
    },
    {
      "Time_Start": 2100.7799999999997,
      "Time_End": 2108.5,
      "Text": " Sometimes it's one character, two characters, but let's just go with it."
    },
    {
      "Time_Start": 2108.5,
      "Time_End": 2111.8599999999997,
      "Text": " So in this case, we're using regex so we want to make sure we escape our characters, escape"
    },
    {
      "Time_Start": 2111.8599999999997,
      "Time_End": 2114.02,
      "Text": " the dollar sign, the brackets."
    },
    {
      "Time_Start": 2114.02,
      "Time_End": 2117.18,
      "Text": " Instead of trying to find all the exact characters, maybe an attacker is going to actually go"
    },
    {
      "Time_Start": 2117.18,
      "Time_End": 2118.18,
      "Text": " in and change some of those."
    },
    {
      "Time_Start": 2118.18,
      "Time_End": 2119.18,
      "Text": " So let me just use digits."
    },
    {
      "Time_Start": 2119.18,
      "Time_End": 2120.18,
      "Text": " One to two."
    },
    {
      "Time_Start": 2120.18,
      "Time_End": 2123.8199999999997,
      "Text": " Go through and do some more escaping."
    },
    {
      "Time_Start": 2123.8199999999997,
      "Time_End": 2128.58,
      "Text": " And then when we run this, we'll see that detection rate go from zero up to eight."
    },
    {
      "Time_Start": 2128.58,
      "Time_End": 2130.42,
      "Text": " Eight of 28 we detected."
    },
    {
      "Time_Start": 2130.42,
      "Time_End": 2131.42,
      "Text": " Awesome."
    },
    {
      "Time_Start": 2131.42,
      "Time_End": 2136.38,
      "Text": " Let me go back and add in the potential white space in between the brackets on either side"
    },
    {
      "Time_Start": 2136.38,
      "Time_End": 2139.74,
      "Text": " of the plus sign and make sure that I didn't mess that up."
    },
    {
      "Time_Start": 2139.74,
      "Time_End": 2148.9,
      "Text": " And we'll run it again and hopefully we'll still get those eight detections."
    },
    {
      "Time_Start": 2148.9,
      "Time_End": 2150.5,
      "Text": " So we have the white space in our rule."
    },
    {
      "Time_Start": 2150.5,
      "Time_End": 2151.5,
      "Text": " Run again."
    },
    {
      "Time_Start": 2151.5,
      "Time_End": 2152.5,
      "Text": " Eight detections."
    },
    {
      "Time_Start": 2152.5,
      "Time_End": 2153.5,
      "Text": " Perfect."
    },
    {
      "Time_Start": 2153.5,
      "Time_End": 2154.5,
      "Text": " All right."
    },
    {
      "Time_Start": 2154.5,
      "Time_End": 2155.5,
      "Text": " I don't see any more PS home."
    },
    {
      "Time_Start": 2155.5,
      "Time_End": 2156.5,
      "Text": " Let's go and look."
    },
    {
      "Time_Start": 2156.5,
      "Time_End": 2157.8199999999997,
      "Text": " It looks like we're doing a very similar thing with the shell ID."
    },
    {
      "Time_Start": 2157.98,
      "Time_End": 2159.98,
      "Text": " So maybe we'll just tackle that next."
    },
    {
      "Time_Start": 2159.98,
      "Time_End": 2161.7400000000002,
      "Text": " In this case, you could put it all in one regex."
    },
    {
      "Time_Start": 2161.7400000000002,
      "Time_End": 2165.1000000000004,
      "Text": " I like to kind of have it separated out just to kind of think a little more clearly."
    },
    {
      "Time_Start": 2165.1000000000004,
      "Time_End": 2167.1800000000003,
      "Text": " But we'll just change PS home to shell ID and run that."
    },
    {
      "Time_Start": 2167.1800000000003,
      "Time_End": 2169.5,
      "Text": " We're going to go from eight detections up to ten detections."
    },
    {
      "Time_Start": 2169.5,
      "Time_End": 2170.5,
      "Text": " Perfect."
    },
    {
      "Time_Start": 2170.5,
      "Time_End": 2174.42,
      "Text": " And I just keep popping off the queue and say, all right, what do I detect next?"
    },
    {
      "Time_Start": 2174.42,
      "Time_End": 2177.06,
      "Text": " Again, can an attacker go and change the source code?"
    },
    {
      "Time_Start": 2177.06,
      "Time_End": 2178.06,
      "Text": " Absolutely."
    },
    {
      "Time_Start": 2178.06,
      "Time_End": 2179.06,
      "Text": " How many people do that?"
    },
    {
      "Time_Start": 2179.06,
      "Time_End": 2180.1800000000003,
      "Text": " Not all of them."
    },
    {
      "Time_Start": 2180.1800000000003,
      "Time_End": 2181.1800000000003,
      "Text": " Most don't."
    },
    {
      "Time_Start": 2181.1800000000003,
      "Time_End": 2184.02,
      "Text": " And here's a way you can just very simply enumerate."
    },
    {
      "Time_Start": 2184.02,
      "Time_End": 2188.54,
      "Text": " Find the code, enumerate to create your corpus, your data set, and then start to apply this"
    },
    {
      "Time_Start": 2188.54,
      "Time_End": 2190.02,
      "Text": " logic to say, would I detect this?"
    },
    {
      "Time_Start": 2190.02,
      "Time_End": 2195.1,
      "Text": " And here's just a couple sample rules that I built to say, all right, if you had these"
    },
    {
      "Time_Start": 2195.1,
      "Time_End": 2199.18,
      "Text": " rules looking, it would detect every single instance of obfuscated IEX produced by the"
    },
    {
      "Time_Start": 2199.18,
      "Time_End": 2201.94,
      "Text": " public version of invoke obfuscation."
    },
    {
      "Time_Start": 2201.94,
      "Time_End": 2203.7599999999998,
      "Text": " That's pretty easy, right?"
    },
    {
      "Time_Start": 2203.7599999999998,
      "Time_End": 2204.7599999999998,
      "Text": " That's awesome."
    },
    {
      "Time_Start": 2204.7599999999998,
      "Time_End": 2209.06,
      "Text": " And this is just looking at public code and just running it and looking at the data that"
    },
    {
      "Time_Start": 2209.06,
      "Time_End": 2214.22,
      "Text": " comes out and then systematically tackling it."
    },
    {
      "Time_Start": 2214.22,
      "Time_End": 2218.2599999999998,
      "Text": " All right."
    },
    {
      "Time_Start": 2218.2599999999998,
      "Time_End": 2219.2599999999998,
      "Text": " Key takeaways."
    },
    {
      "Time_Start": 2219.2599999999998,
      "Time_End": 2222.66,
      "Text": " I know that was a lot."
    },
    {
      "Time_Start": 2222.66,
      "Time_End": 2225.46,
      "Text": " Offensive research for detection development."
    },
    {
      "Time_Start": 2225.46,
      "Time_End": 2227.62,
      "Text": " There's some components that are reactive."
    },
    {
      "Time_Start": 2227.62,
      "Time_End": 2230.58,
      "Text": " When Casey tweets something, then you need to go look at it and maybe you need new detections"
    },
    {
      "Time_Start": 2230.58,
      "Time_End": 2231.58,
      "Text": " for it."
    },
    {
      "Time_Start": 2231.58,
      "Time_End": 2232.7799999999997,
      "Text": " But we can actually be very proactive."
    },
    {
      "Time_Start": 2232.7799999999997,
      "Time_End": 2236.62,
      "Text": " We can go out and say, there's this code that exists that I've never seen an attacker use"
    },
    {
      "Time_Start": 2236.62,
      "Time_End": 2238.62,
      "Text": " before, but they very well could."
    },
    {
      "Time_Start": 2238.62,
      "Time_End": 2241.7,
      "Text": " So let me take that code, let me put it in a for loop and see what it generates and write"
    },
    {
      "Time_Start": 2241.7,
      "Time_End": 2243.94,
      "Text": " some detections for it."
    },
    {
      "Time_Start": 2243.94,
      "Time_End": 2248.98,
      "Text": " Just as Tom was saying earlier, looking at this DDE stuff, let's create a Yara rule and"
    },
    {
      "Time_Start": 2248.98,
      "Time_End": 2251.7,
      "Text": " search virus total and see if we see any hits."
    },
    {
      "Time_Start": 2251.7,
      "Time_End": 2254.98,
      "Text": " Looking for things you've never seen before is the most exciting part of my day."
    },
    {
      "Time_Start": 2254.98,
      "Time_End": 2260.06,
      "Text": " Besides making coffee for my team and I, this is the most exciting part of my day when it"
    },
    {
      "Time_Start": 2260.06,
      "Time_End": 2261.06,
      "Text": " comes to work."
    },
    {
      "Time_Start": 2261.06,
      "Time_End": 2262.06,
      "Text": " It's really fun."
    },
    {
      "Time_Start": 2262.06,
      "Time_End": 2267.38,
      "Text": " And we as defenders actually have an active role in not only detecting attacker activity,"
    },
    {
      "Time_Start": 2267.42,
      "Time_End": 2269.82,
      "Text": " but also in a weird way kind of shaping it."
    },
    {
      "Time_Start": 2269.82,
      "Time_End": 2276.3,
      "Text": " Like, when it comes to obfuscation, attackers are enticed in a lot of scenarios to use obfuscation"
    },
    {
      "Time_Start": 2276.3,
      "Time_End": 2278.26,
      "Text": " because it will evade a lot of things."
    },
    {
      "Time_Start": 2278.26,
      "Time_End": 2282.34,
      "Text": " But they've basically taken this huge wide range of, let's say, PowerShell syntax they"
    },
    {
      "Time_Start": 2282.34,
      "Time_End": 2288.26,
      "Text": " could be using, and they funnel it all down into this really ugly, disgusting funnel of"
    },
    {
      "Time_Start": 2288.26,
      "Time_End": 2289.26,
      "Text": " obfuscation."
    },
    {
      "Time_Start": 2289.26,
      "Time_End": 2292.7400000000002,
      "Text": " But we've basically just reduced what they could be doing to this."
    },
    {
      "Time_Start": 2292.7400000000002,
      "Time_End": 2296.06,
      "Text": " Now, what if we got really good at detecting this at a lot of different angles?"
    },
    {
      "Time_Start": 2296.74,
      "Time_End": 2299.82,
      "Text": " Now, we're actually shaping and encouraging attacker activity."
    },
    {
      "Time_Start": 2299.82,
      "Time_End": 2305.5,
      "Text": " The fact that attackers, that good attackers love using stuff that Casey Smith tweets."
    },
    {
      "Time_Start": 2305.5,
      "Time_End": 2306.5,
      "Text": " That's awesome."
    },
    {
      "Time_Start": 2306.5,
      "Time_End": 2307.5,
      "Text": " That's shaping attacker activity."
    },
    {
      "Time_Start": 2307.5,
      "Time_End": 2308.5,
      "Text": " We should be looking for that."
    },
    {
      "Time_Start": 2308.5,
      "Time_End": 2310.34,
      "Text": " Those are wins for us."
    },
    {
      "Time_Start": 2310.34,
      "Time_End": 2311.82,
      "Text": " That dog thinks so."
    },
    {
      "Time_Start": 2311.82,
      "Time_End": 2315.46,
      "Text": " Where do we start?"
    },
    {
      "Time_Start": 2315.46,
      "Time_End": 2316.46,
      "Text": " Somewhere."
    },
    {
      "Time_Start": 2316.46,
      "Time_End": 2319.7799999999997,
      "Text": " You don't detect everything right at once."
    },
    {
      "Time_Start": 2319.7799999999997,
      "Time_End": 2320.7799999999997,
      "Text": " And we always miss stuff."
    },
    {
      "Time_Start": 2320.7799999999997,
      "Time_End": 2322.04,
      "Text": " Like, that's a given."
    },
    {
      "Time_Start": 2322.04,
      "Time_End": 2325.98,
      "Text": " We can't detect every single thing under the sun, but we detect what we can and we continually"
    },
    {
      "Time_Start": 2325.98,
      "Time_End": 2326.98,
      "Text": " improve."
    },
    {
      "Time_Start": 2326.98,
      "Time_End": 2330.26,
      "Text": " And we do it piece by piece."
    },
    {
      "Time_Start": 2330.26,
      "Time_End": 2338.3,
      "Text": " And this point may seem odd, but automate testing to preserve brain cycles."
    },
    {
      "Time_Start": 2338.3,
      "Time_End": 2343.94,
      "Text": " Pester testing saved brain cycles for me because instead of looking at a result and thinking"
    },
    {
      "Time_Start": 2343.94,
      "Time_End": 2346.22,
      "Text": " just for a quick second and being like, is that right?"
    },
    {
      "Time_Start": 2346.22,
      "Time_End": 2347.42,
      "Text": " Did this detection match?"
    },
    {
      "Time_Start": 2347.42,
      "Time_End": 2348.42,
      "Text": " Okay, yeah, it did."
    },
    {
      "Time_Start": 2348.42,
      "Time_End": 2349.66,
      "Text": " I'm gonna run it again."
    },
    {
      "Time_Start": 2349.66,
      "Time_End": 2350.66,
      "Text": " Is this right?"
    },
    {
      "Time_Start": 2350.66,
      "Time_End": 2351.66,
      "Text": " Did it match?"
    },
    {
      "Time_Start": 2351.66,
      "Time_End": 2352.66,
      "Text": " Okay, yeah, it did."
    },
    {
      "Time_Start": 2352.66,
      "Time_End": 2354.58,
      "Text": " That's stealing creative brain cycles from me."
    },
    {
      "Time_Start": 2354.58,
      "Time_End": 2359.74,
      "Text": " If I can put that in a test, in a unit test, and automate it, I never have to think about"
    },
    {
      "Time_Start": 2359.74,
      "Time_End": 2363.54,
      "Text": " that again unless it comes up in bright red and says, hey, this didn't match."
    },
    {
      "Time_Start": 2363.54,
      "Time_End": 2364.9,
      "Text": " You missed this."
    },
    {
      "Time_Start": 2364.9,
      "Time_End": 2368.2999999999997,
      "Text": " And this is what allows me to not have to look at thousands and thousands of payloads"
    },
    {
      "Time_Start": 2368.2999999999997,
      "Time_End": 2373.62,
      "Text": " and see did I detect it, but just run a test and go to bed or go for a run and then come"
    },
    {
      "Time_Start": 2373.62,
      "Time_End": 2375.14,
      "Text": " back and be like, did I miss anything?"
    },
    {
      "Time_Start": 2375.14,
      "Time_End": 2376.14,
      "Text": " No."
    },
    {
      "Time_Start": 2376.14,
      "Time_End": 2377.14,
      "Text": " Awesome."
    },
    {
      "Time_Start": 2377.14,
      "Time_End": 2378.14,
      "Text": " Or, hey, I missed one out of a thousand."
    },
    {
      "Time_Start": 2378.14,
      "Time_End": 2379.14,
      "Text": " Sweet."
    },
    {
      "Time_Start": 2379.14,
      "Time_End": 2380.14,
      "Text": " Let me look at that one."
    },
    {
      "Time_Start": 2380.7,
      "Time_End": 2385.46,
      "Text": " It seems simple and maybe overlooked, but it really makes a huge difference."
    },
    {
      "Time_Start": 2385.46,
      "Time_End": 2389.58,
      "Text": " I'm always thinking of ways I can preserve brain cycles to have the creative energy to"
    },
    {
      "Time_Start": 2389.58,
      "Time_End": 2391.98,
      "Text": " come up with detections."
    },
    {
      "Time_Start": 2391.98,
      "Time_End": 2396.3799999999997,
      "Text": " And finally, we should be sharing our successes, our failures, our methods, our toolings, et"
    },
    {
      "Time_Start": 2396.3799999999997,
      "Time_End": 2397.3799999999997,
      "Text": " cetera."
    },
    {
      "Time_Start": 2397.3799999999997,
      "Time_End": 2401.8199999999997,
      "Text": " And I really hope that's obvious in the obfuscation tools that I write because I'm trying to share"
    },
    {
      "Time_Start": 2401.8199999999997,
      "Time_End": 2405.62,
      "Text": " that research so other people don't have to go and stumble through all that development"
    },
    {
      "Time_Start": 2405.62,
      "Time_End": 2408.94,
      "Text": " but that they can benefit from it right away."
    },
    {
      "Time_Start": 2408.94,
      "Time_End": 2410.54,
      "Text": " So in summary, detection development."
    },
    {
      "Time_Start": 2410.54,
      "Time_End": 2413.02,
      "Text": " It's an iterative art and a science."
    },
    {
      "Time_Start": 2413.02,
      "Time_End": 2414.08,
      "Text": " And people do it differently."
    },
    {
      "Time_Start": 2414.08,
      "Time_End": 2416.66,
      "Text": " We all have different tools, and that's awesome."
    },
    {
      "Time_Start": 2416.66,
      "Time_End": 2418.86,
      "Text": " And we shouldn't be mad about tool differences."
    },
    {
      "Time_Start": 2418.86,
      "Time_End": 2422.5,
      "Text": " We should learn from one another and see what works better in some scenarios and all improve"
    },
    {
      "Time_Start": 2422.5,
      "Time_End": 2423.5,
      "Text": " together."
    },
    {
      "Time_Start": 2423.5,
      "Time_End": 2426.7400000000002,
      "Text": " DevSec principles empower more effective detection R&D."
    },
    {
      "Time_Start": 2426.7400000000002,
      "Time_End": 2427.98,
      "Text": " It definitely has for me."
    },
    {
      "Time_Start": 2427.98,
      "Time_End": 2432.9,
      "Text": " There's a lot of awesome and sexy PowerShell tooling that makes this really doable for"
    },
    {
      "Time_Start": 2432.9,
      "Time_End": 2433.9,
      "Text": " me."
    },
    {
      "Time_Start": 2433.9,
      "Time_End": 2435.06,
      "Text": " I'm a big PowerShell guru."
    },
    {
      "Time_Start": 2435.06,
      "Time_End": 2437.5,
      "Text": " But you don't have to use PowerShell."
    },
    {
      "Time_Start": 2437.5,
      "Time_End": 2442.94,
      "Text": " And then, again, automate point in time thinking to free up those creative brain cycles."
    },
    {
      "Time_Start": 2442.94,
      "Time_End": 2446.46,
      "Text": " The last points I'll say is it's important to have data."
    },
    {
      "Time_Start": 2446.46,
      "Time_End": 2450.3,
      "Text": " If you can't collect public data of the thing you're trying to detect, then copy that code"
    },
    {
      "Time_Start": 2450.3,
      "Time_End": 2451.38,
      "Text": " and generate it."
    },
    {
      "Time_Start": 2451.38,
      "Time_End": 2455.86,
      "Text": " Or if it's some crazy obfuscation thing that doesn't exist yet, build a thing to do that"
    },
    {
      "Time_Start": 2455.86,
      "Time_End": 2458.42,
      "Text": " and then create the data."
    },
    {
      "Time_Start": 2458.42,
      "Time_End": 2460.98,
      "Text": " And finally, these techniques are tool and language agnostic."
    },
    {
      "Time_Start": 2460.98,
      "Time_End": 2463.3,
      "Text": " I know I've been kind of focusing on the PowerShell component."
    },
    {
      "Time_Start": 2463.3,
      "Time_End": 2464.3,
      "Text": " That's just what I like."
    },
    {
      "Time_Start": 2464.3,
      "Time_End": 2467.3,
      "Text": " But you can use any tool to generate that data."
    },
    {
      "Time_Start": 2468.1000000000004,
      "Time_End": 2469.1000000000004,
      "Text": " And also, the detections."
    },
    {
      "Time_Start": 2469.1000000000004,
      "Time_End": 2470.1000000000004,
      "Text": " We just use reg access."
    },
    {
      "Time_Start": 2470.1000000000004,
      "Time_End": 2471.7400000000002,
      "Text": " But maybe that doesn't work for you."
    },
    {
      "Time_Start": 2471.7400000000002,
      "Time_End": 2477.1400000000003,
      "Text": " But you can put that logic in an IOC or a Yara rule or a splunk query or a carbon black"
    },
    {
      "Time_Start": 2477.1400000000003,
      "Time_End": 2478.1400000000003,
      "Text": " filter."
    },
    {
      "Time_Start": 2478.1400000000003,
      "Time_End": 2479.1400000000003,
      "Text": " All these different things."
    },
    {
      "Time_Start": 2479.1400000000003,
      "Time_End": 2483.34,
      "Text": " It's just providing an avenue to explore the concepts that you can then translate into"
    },
    {
      "Time_Start": 2483.34,
      "Time_End": 2487.54,
      "Text": " whatever tools you have at your disposal."
    },
    {
      "Time_Start": 2487.54,
      "Time_End": 2490.1800000000003,
      "Text": " So here's some of the references of some of the frameworks and stuff."
    },
    {
      "Time_Start": 2490.18,
      "Time_End": 2499.8199999999997,
      "Text": " All of the modules and the demo scripts that I did are in this DevSecDefense on my GitHub."
    },
    {
      "Time_Start": 2499.8199999999997,
      "Time_End": 2501.58,
      "Text": " And that reference is here on this next slide."
    },
    {
      "Time_Start": 2501.58,
      "Time_End": 2505.8199999999997,
      "Text": " Again, this is my Twitter, GitHub, blog."
    },
    {
      "Time_Start": 2505.8199999999997,
      "Time_End": 2509.46,
      "Text": " I just want to say I'm, again, just super honored to be here."
    },
    {
      "Time_Start": 2509.46,
      "Time_End": 2510.7,
      "Text": " Last year the first edition was awesome."
    },
    {
      "Time_Start": 2510.7,
      "Time_End": 2513.14,
      "Text": " I'm honored to be here for the second edition."
    },
    {
      "Time_Start": 2513.14,
      "Time_End": 2514.8599999999997,
      "Text": " And I just want to say thank you so much for your time."
    },
    {
      "Time_Start": 2520.18,
      "Time_End": 2525.2999999999997,
      "Text": " Thank you."
    },
    {
      "Time_Start": 2525.2999999999997,
      "Time_End": 2528.7799999999997,
      "Text": " It's awesome to have you here, Daniel, again."
    },
    {
      "Time_Start": 2528.7799999999997,
      "Time_End": 2530.3399999999997,
      "Text": " So thank you."
    },
    {
      "Time_Start": 2530.3399999999997,
      "Time_End": 2532.62,
      "Text": " Any questions from the audience?"
    },
    {
      "Time_Start": 2532.62,
      "Time_End": 2535.06,
      "Text": " Please raise your hand."
    },
    {
      "Time_Start": 2535.06,
      "Time_End": 2539.8599999999997,
      "Text": " It can be about coffee, too, if you want."
    },
    {
      "Time_Start": 2539.8599999999997,
      "Time_End": 2540.8599999999997,
      "Text": " Okay."
    },
    {
      "Time_Start": 2540.8599999999997,
      "Time_End": 2542.8599999999997,
      "Text": " I guess not."
    },
    {
      "Time_Start": 2542.8599999999997,
      "Time_End": 2547.7,
      "Text": " I think last year the very first question was how much coffee do you drink?"
    },
    {
      "Time_Start": 2547.7,
      "Time_End": 2549.4199999999996,
      "Text": " Because I was a bit hyper last year."
    },
    {
      "Time_Start": 2549.46,
      "Time_End": 2550.46,
      "Text": " Yeah."
    },
    {
      "Time_Start": 2550.46,
      "Time_End": 2551.46,
      "Text": " Awesome."
    },
    {
      "Time_Start": 2551.46,
      "Time_End": 2552.46,
      "Text": " Well, thank you again."
    },
    {
      "Time_Start": 2552.46,
      "Time_End": 2553.46,
      "Text": " I really appreciate it."
    },
    {
      "Time_Start": 2553.46,
      "Time_End": 2554.46,
      "Text": " Thank you."
    },
    {
      "Time_Start": 2554.46,
      "Time_End": 2555.46,
      "Text": " All right."
    },
    {
      "Time_Start": 2555.46,
      "Time_End": 2556.46,
      "Text": " Thank you."
    },
    {
      "Time_Start": 2556.46,
      "Time_End": 2557.46,
      "Text": " Applause."
    },
    {
      "Time_Start": 2557.46,
      "Time_End": 2558.46,
      "Text": " Music."
    },
    {
      "Time_Start": 2558.46,
      "Time_End": 2559.46,
      "Text": " Video."
    },
    {
      "Time_Start": 2559.46,
      "Time_End": 2560.46,
      "Text": " Video."
    },
    {
      "Time_Start": 2560.46,
      "Time_End": 2561.46,
      "Text": " Music."
    },
    {
      "Time_Start": 2561.46,
      "Time_End": 2562.46,
      "Text": " Video."
    },
    {
      "Time_Start": 2562.46,
      "Time_End": 2563.46,
      "Text": " Music."
    },
    {
      "Time_Start": 2563.46,
      "Time_End": 2564.46,
      "Text": " Video."
    },
    {
      "Time_Start": 2564.46,
      "Time_End": 2565.46,
      "Text": " Music."
    },
    {
      "Time_Start": 2565.46,
      "Time_End": 2566.46,
      "Text": " Video."
    },
    {
      "Time_Start": 2566.46,
      "Time_End": 2567.46,
      "Text": " Music."
    },
    {
      "Time_Start": 2567.46,
      "Time_End": 2568.46,
      "Text": " Video."
    },
    {
      "Time_Start": 2568.46,
      "Time_End": 2569.46,
      "Text": " Music."
    },
    {
      "Time_Start": 2569.46,
      "Time_End": 2570.46,
      "Text": " Video."
    },
    {
      "Time_Start": 2570.46,
      "Time_End": 2571.46,
      "Text": " Music."
    },
    {
      "Time_Start": 2571.46,
      "Time_End": 2572.46,
      "Text": " Video."
    },
    {
      "Time_Start": 2572.46,
      "Time_End": 2573.46,
      "Text": " Music."
    },
    {
      "Time_Start": 2573.46,
      "Time_End": 2574.46,
      "Text": " Video."
    },
    {
      "Time_Start": 2574.46,
      "Time_End": 2575.46,
      "Text": " Music."
    },
    {
      "Time_Start": 2575.46,
      "Time_End": 2576.46,
      "Text": " Video."
    },
    {
      "Time_Start": 2576.46,
      "Time_End": 2577.46,
      "Text": " Music."
    },
    {
      "Time_Start": 2577.46,
      "Time_End": 2578.46,
      "Text": " Video."
    },
    {
      "Time_Start": 2578.46,
      "Time_End": 2578.96,
      "Text": " Music."
    }
  ]
}