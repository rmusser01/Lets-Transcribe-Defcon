{"segments": [{"Time_Start": 0.0, "Time_End": 5.0, "Text": " web applications that use Oracle databases."}, {"Time_Start": 5.0, "Time_End": 9.16, "Text": " There are, of course, prerequisites, things you're going to have to know a little bit about"}, {"Time_Start": 9.16, "Time_End": 12.86, "Text": " to be able to get through this presentation, and that's going to be hopefully a little"}, {"Time_Start": 12.86, "Time_End": 16.2, "Text": " bit of our knowledge about how SQL works, I'll show you briefly, but if you know about"}, {"Time_Start": 16.2, "Time_End": 19.0, "Text": " that, that'll probably help you out figure out what's going on."}, {"Time_Start": 19.0, "Time_End": 23.94, "Text": " Also, if any of you guys have done, you know, developed in PHP or JSP or ASP, know a little"}, {"Time_Start": 23.94, "Time_End": 29.560000000000002, "Text": " bit about how web apps work and how they develop data, and how they access databases, that'll"}, {"Time_Start": 29.560000000000002, "Time_End": 33.6, "Text": " probably help you guys a lot. For everyone else, hopefully I'll do a good job and you'll"}, {"Time_Start": 33.6, "Time_End": 40.660000000000004, "Text": " be able to understand. So we're going to start out here. We're going to start out here"}, {"Time_Start": 40.660000000000004, "Time_End": 45.52, "Text": " looking at just what a normal web application looks like. I'm also going to note to everyone"}, {"Time_Start": 45.52, "Time_End": 50.28, "Text": " here that this was all put together in literally the last like 10 hours. I'd like to thank"}, {"Time_Start": 50.28, "Time_End": 54.980000000000004, "Text": " Phil Brass over there. Help me out a lot and a couple other people. So, you know, this isn't"}, {"Time_Start": 54.980000000000004, "Time_End": 58.760000000000005, "Text": " pretty and this isn't what you're likely to see on Major Corporation Incorporated's"}, {"Time_Start": 58.76, "Time_End": 64.72, "Text": " website or anything, but it will do for our demonstration purposes. So everyone's used to seeing"}, {"Time_Start": 64.72, "Time_End": 71.0, "Text": " stuff like this here. Can you guys hear me back there? Cool. Where let's say we know some"}, {"Time_Start": 71.0, "Time_End": 75.36, "Text": " of guys email address and they have a web application set up that I can get their phone number"}, {"Time_Start": 75.36, "Time_End": 80.08, "Text": " from the website, for instance. Again, this is all using the sample oracle presentation data"}, {"Time_Start": 80.08, "Time_End": 86.22, "Text": " and everything. So it's pretty simple. I enter that and I get back, their first name, the last name,"}, {"Time_Start": 86.22, "Time_End": 88.74, "Text": " and their phone number. What SQL injection is"}, {"Time_Start": 88.76, "Time_End": 91.68, "Text": " going to allow you to do is instead of getting back their first name, last name,"}, {"Time_Start": 91.68, "Time_End": 96.08000000000001, "Text": " and phone number, you're going to be able to actually control what information comes back"}, {"Time_Start": 96.08000000000001, "Time_End": 105.94, "Text": " from the database. Thanks. So the first thing we're going to look at here is the ASP source code"}, {"Time_Start": 105.94, "Time_End": 109.06, "Text": " of what we're going to be seeing because that's going to help us understand it. Normally, of course,"}, {"Time_Start": 109.06, "Time_End": 115.24000000000001, "Text": " you're not going to have access to their source code. But here is what we're looking at."}, {"Time_Start": 115.24000000000001, "Time_End": 118.74000000000001, "Text": " Everyone sees, here is the line we're interested in. Select. Select."}, {"Time_Start": 118.76, "Time_End": 125.16000000000001, "Text": " first name, last name, phone number from employees where email equals, and you see,"}, {"Time_Start": 125.80000000000001, "Time_End": 129.82, "Text": " this is the value that gets passed up here in the URI part of the request."}, {"Time_Start": 130.66, "Time_End": 137.06, "Text": " We control what that part is, and because we control what the value of email is, we can change"}, {"Time_Start": 137.06, "Time_End": 142.44, "Text": " this SQL statement and make it return different information back from the database other than"}, {"Time_Start": 142.44, "Time_End": 147.34, "Text": " first name, last name, and phone number. Now, you're going to run into a lot of sites that are"}, {"Time_Start": 147.34, "Time_End": 148.74, "Text": " going to stop you from doing this in a copy."}, {"Time_Start": 148.76, "Time_End": 152.85999999999999, "Text": " ways. They're not going to allow you to send characters like spaces or single quotes,"}, {"Time_Start": 152.85999999999999, "Time_End": 158.16, "Text": " and those are the pages that, other than a couple tricks that in certain circumstances can let you"}, {"Time_Start": 158.16, "Time_End": 162.64, "Text": " get through, which I may show you later if we have time, those are the pages that are not going"}, {"Time_Start": 162.64, "Time_End": 167.35999999999999, "Text": " to be vulnerable, but I don't know if anyone's used this technique before, probably. It's been"}, {"Time_Start": 167.35999999999999, "Time_End": 171.88, "Text": " around a couple years now, but the amount of sites that are vulnerable to this is just enormous."}, {"Time_Start": 171.88, "Time_End": 178.23999999999998, "Text": " I've seen major, you know, communications, corporations, credit card companies,"}, {"Time_Start": 178.76, "Time_End": 181.04, "Text": " investment banks, all kinds of stuff."}, {"Time_Start": 182.0, "Time_End": 186.04, "Text": " So the first thing I'm going to do to show you how we're going to change what's getting back to the server"}, {"Time_Start": 186.04, "Time_End": 189.07999999999998, "Text": " is we're going to throw in a single quote here."}, {"Time_Start": 194.51999999999998, "Time_End": 198.92, "Text": " Assuming this thing will work. Great."}, {"Time_Start": 208.76, "Time_End": 211.76, "Text": " Caleb, do you want to be up here?"}, {"Time_Start": 211.76, "Time_End": 214.76, "Text": " All right."}, {"Time_Start": 214.76, "Time_End": 216.76, "Text": " Forget that part."}, {"Time_Start": 216.76, "Time_End": 220.76, "Text": " Want to try again, guys?"}, {"Time_Start": 220.76, "Time_End": 222.76, "Text": " Up from the audience?"}, {"Time_Start": 222.76, "Time_End": 226.76, "Text": " There we go. Thank you very much."}, {"Time_Start": 226.76, "Time_End": 230.76, "Text": " What we have here is this is an error message that has come back from the database server."}, {"Time_Start": 230.76, "Time_End": 234.76, "Text": " And it says, quoted string, not properly terminated."}, {"Time_Start": 234.76, "Time_End": 238.73999999999998, "Text": " Let's look at when we send the value for email"}, {"Time_Start": 238.76, "Time_End": 241.76, "Text": " single quote what the database server saw."}, {"Time_Start": 245.76, "Time_End": 250.76, "Text": " This is Oracle SQL Plus Terminal. It's allowing me, normally again, you wouldn't have access to this."}, {"Time_Start": 250.76, "Time_End": 256.76, "Text": " But for demonstration purposes to show everyone, it's very helpful for my presentation."}, {"Time_Start": 256.76, "Time_End": 261.76, "Text": " So instead of all the stuff here for email where, you know, it's modifying the source code,"}, {"Time_Start": 261.76, "Time_End": 263.76, "Text": " we're going to put in that single quote."}, {"Time_Start": 263.76, "Time_End": 267.76, "Text": " So now we're going to see what happens here. It got sent this line."}, {"Time_Start": 267.76, "Time_End": 274.76, "Text": " got sent this line. Of course, having the three quotes in a row, anyone who's done any programming can tell you that that's not a valid literal value."}, {"Time_Start": 274.76, "Time_End": 277.76, "Text": " So it gave you back this error message."}, {"Time_Start": 277.76, "Time_End": 286.76, "Text": " Now our goal is to change that instead of using a single quote, put that little injection part to something very useful to be able to manipulate what comes back from the database."}, {"Time_Start": 286.76, "Time_End": 290.76, "Text": " So let's go back and let's look at the web applications we have available."}, {"Time_Start": 290.76, "Time_End": 293.76, "Text": " Here's another simple one, this is login."}, {"Time_Start": 293.76, "Time_End": 296.76, "Text": " Enter username and password. Let's change instead of using."}, {"Time_Start": 296.76, "Time_End": 300.76, "Text": " changed instead of using, you know, an invalid username and password."}, {"Time_Start": 300.76, "Time_End": 308.76, "Text": " Of course, you get invalid login. Let's try quote or one equals single quote one."}, {"Time_Start": 308.76, "Time_End": 312.76, "Text": " And we're going to use that for both of these."}, {"Time_Start": 312.76, "Time_End": 317.76, "Text": " See people laughing about there, maybe you've seen how many places this actually works on."}, {"Time_Start": 317.76, "Time_End": 326.76, "Text": " And of course, as we all know, behind, behind each login form,"}, {"Time_Start": 326.76, "Time_End": 331.15999999999997, "Text": " as we all know, exists very sensitive corporate information."}, {"Time_Start": 331.15999999999997, "Time_End": 337.76, "Text": " This actually happens to be a WorldCom SEC filing."}, {"Time_Start": 337.76, "Time_End": 341.76, "Text": " So we're going to go back and we're going to look, we're going to open up, I'm going to show you the source of the login."}, {"Time_Start": 341.76, "Time_End": 351.76, "Text": " We're going to see exactly what happened that allowed me to just jump right through the login and get to our sensitive financial information."}, {"Time_Start": 351.76, "Time_End": 355.76, "Text": " Let's look what goes on here. This is basic form stuff."}, {"Time_Start": 355.76, "Time_End": 356.76, "Text": " You send the username."}, {"Time_Start": 356.76, "Time_End": 359.76, "Text": " You send the password, and let's see what it does with it."}, {"Time_Start": 359.76, "Time_End": 362.76, "Text": " This is basic, you know, ASP, ODBC driver stuff."}, {"Time_Start": 362.76, "Time_End": 365.76, "Text": " We're connecting to the database, get the values from the URI."}, {"Time_Start": 365.76, "Time_End": 368.76, "Text": " Now, here's what goes on, here's how it authenticates."}, {"Time_Start": 368.76, "Time_End": 371.76, "Text": " Select username from users where"}, {"Time_Start": 371.76, "Time_End": 375.76, "Text": " username equals user name and password equals password."}, {"Time_Start": 375.76, "Time_End": 377.76, "Text": " Now let's see."}, {"Time_Start": 377.76, "Time_End": 381.76, "Text": " If that statement fails, for instance, there is no row"}, {"Time_Start": 381.76, "Time_End": 385.76, "Text": " in the database where username and password match like that,"}, {"Time_Start": 385.76, "Time_End": 386.76, "Text": " what's going to happen."}, {"Time_Start": 386.76, "Time_End": 393.76, "Text": " rs.eof, if there are no records in the return record set, then your login is invalid."}, {"Time_Start": 393.76, "Time_End": 399.76, "Text": " If not, and again, this is very simple sample stuff that I put together in the last couple hours,"}, {"Time_Start": 399.76, "Time_End": 401.76, "Text": " it's been unbelievable."}, {"Time_Start": 401.76, "Time_End": 407.76, "Text": " You get your access granted and you get sensitive financial information."}, {"Time_Start": 407.76, "Time_End": 412.76, "Text": " So let's see what happens when we take the SQL statement here"}, {"Time_Start": 412.76, "Time_End": 415.76, "Text": " and we plug in the values that"}, {"Time_Start": 415.76, "Time_End": 420.76, "Text": " that the quote quote thing, where username equals,"}, {"Time_Start": 424.76, "Time_End": 427.15999999999997, "Text": " quote, and here's where we start changing things,"}, {"Time_Start": 427.15999999999997, "Time_End": 429.36, "Text": " username equals no,"}, {"Time_Start": 429.36, "Time_End": 434.58, "Text": " or username can equal one equals one."}, {"Time_Start": 434.58, "Time_End": 436.52, "Text": " Here's the part where we manipulate it."}, {"Time_Start": 436.52, "Time_End": 439.59999999999997, "Text": " I want everyone to look real hard at that statement."}, {"Time_Start": 439.59999999999997, "Time_End": 442.56, "Text": " Where username equals no, there is no username,"}, {"Time_Start": 442.56, "Time_End": 445.59999999999997, "Text": " or where one is equal to one."}, {"Time_Start": 445.76, "Time_End": 452.76, "Text": " know if anyone here has ever done any programming, but that statement will always 100% of the time be true."}, {"Time_Start": 452.76, "Time_End": 458.76, "Text": " You will get records back from the database and they do the same exact thing with password."}, {"Time_Start": 458.76, "Time_End": 465.76, "Text": " And we're going to remove the double quotes there that came from the ASP."}, {"Time_Start": 465.76, "Time_End": 471.76, "Text": " Simple note for people who have SQL injected against SQL server, you can do quote quote equals quote."}, {"Time_Start": 471.76, "Time_End": 474.76, "Text": " Oracle for your information does not see that."}, {"Time_Start": 474.76, "Time_End": 475.76, "Text": " No equals no."}, {"Time_Start": 475.76, "Time_End": 477.76, "Text": " will return a no, it will not return true."}, {"Time_Start": 477.76, "Time_End": 482.76, "Text": " So you do have to actually use one, where you can use A or anything as long as they'll match up."}, {"Time_Start": 482.76, "Time_End": 485.76, "Text": " It's going to slap that single quote onto the end for you."}, {"Time_Start": 485.76, "Time_End": 486.76, "Text": " Is everyone following me here?"}, {"Time_Start": 486.76, "Time_End": 488.76, "Text": " Does anyone have any questions over for?"}, {"Time_Start": 488.76, "Time_End": 490.76, "Text": " Okay, then we're good."}, {"Time_Start": 490.76, "Time_End": 491.76, "Text": " Let's see what comes back there."}, {"Time_Start": 491.76, "Time_End": 494.76, "Text": " As you see, we can get the fullest of usernames that returns multiple records,"}, {"Time_Start": 494.76, "Time_End": 497.76, "Text": " so our statement evaluated true."}, {"Time_Start": 497.76, "Time_End": 502.76, "Text": " Now that we've got our basic stuff together, we're going to start looking at,"}, {"Time_Start": 502.76, "Time_End": 504.76, "Text": " and I've shown you the most simple thing, the authentication box,"}, {"Time_Start": 504.76, "Time_End": 507.76, "Text": " the authentication bypass is the easiest thing you can do."}, {"Time_Start": 507.76, "Time_End": 511.76, "Text": " We're going to go back to this script where it returns three columns of specific information"}, {"Time_Start": 511.76, "Time_End": 514.76, "Text": " from the database and displays them in the web application."}, {"Time_Start": 514.76, "Time_End": 520.76, "Text": " Now, I'm going to show you real simple here how select Union Quarry would work"}, {"Time_Start": 520.76, "Time_End": 522.76, "Text": " using what I have here."}, {"Time_Start": 522.76, "Time_End": 527.76, "Text": " Select, let's say, username that's, you know, change that's just sample information."}, {"Time_Start": 527.76, "Time_End": 532.76, "Text": " Change, you know, A and A, it'll return two rows."}, {"Time_Start": 532.76, "Time_End": 534.76, "Text": " Of course these are literals, not real records from the data."}, {"Time_Start": 534.76, "Time_End": 543.76, "Text": " database, select AA from, valid table name, where username equals condition."}, {"Time_Start": 543.76, "Time_End": 546.76, "Text": " And here's where we start with what he's doing called a union."}, {"Time_Start": 546.76, "Time_End": 550.76, "Text": " A union is used to put basically two select queries together."}, {"Time_Start": 550.76, "Time_End": 555.76, "Text": " It's just a programming device to help programmers return information from two"}, {"Time_Start": 555.76, "Time_End": 558.76, "Text": " different places in one SQL query."}, {"Time_Start": 558.76, "Time_End": 561.76, "Text": " Union select, and let's try different information."}, {"Time_Start": 561.76, "Time_End": 564.74, "Text": " B, comma, B, from,"}, {"Time_Start": 564.76, "Time_End": 570.76, "Text": " let's say different tables, a table, I happen to know, in all Oracle databases, there's a table called dual."}, {"Time_Start": 570.76, "Time_End": 573.76, "Text": " The table dual does not contain information."}, {"Time_Start": 573.76, "Time_End": 577.76, "Text": " It is a special kind of table. It exists, again, it's a programming device,"}, {"Time_Start": 577.76, "Time_End": 581.76, "Text": " that it will always return what's selected from it, one record set of it."}, {"Time_Start": 581.76, "Time_End": 586.76, "Text": " So on every Oracle server you ever see, you can guarantee that there's a table called dual."}, {"Time_Start": 586.76, "Time_End": 590.76, "Text": " And we'll make, you know, universally true condition."}, {"Time_Start": 590.76, "Time_End": 593.76, "Text": " Yeah."}, {"Time_Start": 593.76, "Time_End": 597.76, "Text": " As you can see, where username equals quote quote,"}, {"Time_Start": 597.76, "Time_End": 599.76, "Text": " quote, return false, it returned no records."}, {"Time_Start": 599.76, "Time_End": 602.76, "Text": " But the union select part returned both."}, {"Time_Start": 602.76, "Time_End": 606.76, "Text": " Now let's say if I were to modify that to where"}, {"Time_Start": 606.76, "Time_End": 611.76, "Text": " one equals one, we would get both back."}, {"Time_Start": 611.76, "Time_End": 614.76, "Text": " Does everyone understand how the union works?"}, {"Time_Start": 614.76, "Time_End": 615.76, "Text": " It just puts two queries together."}, {"Time_Start": 615.76, "Time_End": 617.76, "Text": " It's returning both."}, {"Time_Start": 617.76, "Time_End": 621.76, "Text": " Select BV from dual and select AA from users at the same time."}, {"Time_Start": 621.76, "Time_End": 628.76, "Text": " In SQL Plus worksheet, no, because Larry Ellison hates everyone and does everything in Java,"}, {"Time_Start": 628.76, "Time_End": 630.76, "Text": " which really hates everything."}, {"Time_Start": 630.76, "Time_End": 632.76, "Text": " We're going to go back here."}, {"Time_Start": 632.76, "Time_End": 634.76, "Text": " Could everyone see that, though?"}, {"Time_Start": 634.76, "Time_End": 636.76, "Text": " This is the important stuff, what you're doing from a web browser,"}, {"Time_Start": 636.76, "Time_End": 640.76, "Text": " what you're going to be actually doing when you're running this against a site."}, {"Time_Start": 640.76, "Time_End": 642.76, "Text": " So we're going to look here."}, {"Time_Start": 642.76, "Time_End": 647.76, "Text": " Union select, and here's where you have to start paying attention."}, {"Time_Start": 647.76, "Time_End": 648.76, "Text": " Let's try this."}, {"Time_Start": 648.76, "Time_End": 650.76, "Text": " Union select, table name,"}, {"Time_Start": 650.76, "Time_End": 657.76, "Text": " from all tables. All tables is another table that occurs in all Oracle databases."}, {"Time_Start": 657.76, "Time_End": 660.76, "Text": " It simply contains a list of all the tables that are on the database."}, {"Time_Start": 660.76, "Time_End": 665.76, "Text": " It's got the list of everything in there, and you can always depend that it's going to be there."}, {"Time_Start": 665.76, "Time_End": 669.76, "Text": " Where, and of course, we're going to put our magical little string here that'll make it return records,"}, {"Time_Start": 669.76, "Time_End": 673.76, "Text": " and I'm going to copy that so I can show you back in PLCQL Terminal."}, {"Time_Start": 673.76, "Time_End": 676.76, "Text": " For those of you are sitting close enough that you can actually see, I'm sorry."}, {"Time_Start": 676.76, "Time_End": 678.76, "Text": " We're going to see what we get back."}, {"Time_Start": 678.76, "Time_End": 679.76, "Text": " Query Block has incorrect number of results."}, {"Time_Start": 679.76, "Time_End": 683.76, "Text": " number of result columns. I'll show you why that happens."}, {"Time_Start": 683.76, "Time_End": 687.76, "Text": " What we got here, and I'm really sorry about the font size, but there's nothing you can do."}, {"Time_Start": 687.76, "Time_End": 693.76, "Text": " Oracle did not have the foresight to put font size information in the SQL Plus worksheet application"}, {"Time_Start": 693.76, "Time_End": 701.76, "Text": " is that when you run a union select query, you have to have the same amount of selected columns"}, {"Time_Start": 701.76, "Time_End": 708.76, "Text": " in select, and you have to have the same amount of columns in the second select, in the union part."}, {"Time_Start": 708.76, "Time_End": 709.76, "Text": " See if I were to delete the second."}, {"Time_Start": 709.76, "Time_End": 713.76, "Text": " second column, it's going to complain."}, {"Time_Start": 713.76, "Time_End": 716.76, "Text": " Well, that's complaint, but still have the comma there you go."}, {"Time_Start": 716.76, "Time_End": 721.76, "Text": " So what you have to do is you have to look at the legitimate output."}, {"Time_Start": 721.76, "Time_End": 726.76, "Text": " We also, that this returns three columns, first name, last name, and phone number."}, {"Time_Start": 726.76, "Time_End": 728.76, "Text": " So we need three columns here."}, {"Time_Start": 728.76, "Time_End": 733.76, "Text": " One, two, and of course I'm just using the literals here as dummy stringer things."}, {"Time_Start": 733.76, "Time_End": 738.76, "Text": " And this time, instead of getting back,"}, {"Time_Start": 738.76, "Time_End": 743.66, "Text": " Instead of getting back, first name, last name, and phone number, we have a list of every"}, {"Time_Start": 743.66, "Time_End": 747.76, "Text": " table in the Oracle database here."}, {"Time_Start": 747.76, "Time_End": 751.52, "Text": " Now what we're going to go through is we're going to look, and of course you go through and you"}, {"Time_Start": 751.52, "Time_End": 755.6, "Text": " find the table names that look interesting, but before we do that, I'm going to show you a couple"}, {"Time_Start": 755.6, "Time_End": 760.26, "Text": " things that can occur in the SQL syntax that can make this a little confusing."}, {"Time_Start": 760.26, "Time_End": 764.08, "Text": " Not all SQL statements are going to look exactly like this."}, {"Time_Start": 764.08, "Time_End": 768.74, "Text": " You're going to have some programmers who are going to do little different things. One thing you're"}, {"Time_Start": 768.76, "Time_End": 777.76, "Text": " to see is, let's get down to the SQL statement, in addition to the single quote,"}, {"Time_Start": 777.76, "Time_End": 782.76, "Text": " they're putting what you control, email, also around parentheses."}, {"Time_Start": 782.76, "Time_End": 784.76, "Text": " So let's go real simple, I'll show you how to get around that."}, {"Time_Start": 784.76, "Time_End": 785.76, "Text": " It's very simple."}, {"Time_Start": 785.76, "Time_End": 786.76, "Text": " It's the same concept."}, {"Time_Start": 786.76, "Time_End": 788.76, "Text": " Most of you probably caught on by now."}, {"Time_Start": 788.76, "Time_End": 790.76, "Text": " You end that right there."}, {"Time_Start": 790.76, "Time_End": 795.76, "Text": " Union select all tables."}, {"Time_Start": 795.76, "Time_End": 796.76, "Text": " Ah."}, {"Time_Start": 796.76, "Time_End": 797.76, "Text": " Sorry."}, {"Time_Start": 797.76, "Time_End": 798.76, "Text": " Sorry."}, {"Time_Start": 798.76, "Time_End": 820.0, "Text": " Table name A, A, A, got a door column matching from all tables where, and you put the parentheses right there so it matches up what it's got at the beginning in the end, just like we showed it to."}, {"Time_Start": 820.0, "Time_End": 821.48, "Text": " And you get your table back."}, {"Time_Start": 821.48, "Time_End": 827.74, "Text": " If you don't have the parentheses in there, Oracle actually, I don't know, I don't know, I don't"}, {"Time_Start": 827.76, "Time_End": 830.1, "Text": " enough if any of you are again, SQL server is the most common thing out there."}, {"Time_Start": 830.1, "Time_End": 832.4399999999999, "Text": " SQL server just tells you have a syntax error."}, {"Time_Start": 832.4399999999999, "Time_End": 838.64, "Text": " Oracle will actually tell you you're missing a parenthesis."}, {"Time_Start": 838.64, "Time_End": 844.98, "Text": " Now I know, just one thing I'm going to point out here, SQL injection is not a problem in the database."}, {"Time_Start": 844.98, "Time_End": 850.14, "Text": " The problem is it's occurring here in the ASP programmers code that they're not stripping out"}, {"Time_Start": 850.14, "Time_End": 854.6, "Text": " things like single quotes and they're not limiting the amount of information that can be passed."}, {"Time_Start": 854.6, "Time_End": 857.74, "Text": " For instance, this application that I've been showing you, there searches for an"}, {"Time_Start": 857.76, "Time_End": 858.76, "Text": " email address."}, {"Time_Start": 858.76, "Time_End": 862.64, "Text": " Does anyone know of anyone who has an email address that is that long?"}, {"Time_Start": 862.64, "Time_End": 867.1, "Text": " Your common sense for your programmer should be have maximum for your email address, something"}, {"Time_Start": 867.1, "Time_End": 872.0, "Text": " like 10 characters, do not let commas through, do not let single quotes through, do not let"}, {"Time_Start": 872.0, "Time_End": 873.72, "Text": " let spaces through."}, {"Time_Start": 873.72, "Time_End": 878.74, "Text": " So the problem isn't the database server, the problem is the web application programmer."}, {"Time_Start": 878.74, "Time_End": 881.2, "Text": " He's not doing what it's called input sanitization."}, {"Time_Start": 881.2, "Time_End": 882.2, "Text": " Yeah."}, {"Time_Start": 882.2, "Time_End": 886.7, "Text": " All of them, one is the straight that you show, because the number of applications in the first"}, {"Time_Start": 886.7, "Time_End": 887.74, "Text": " left to make sure."}, {"Time_Start": 887.76, "Time_End": 889.14, "Text": " number of having your second slides."}, {"Time_Start": 889.14, "Time_End": 889.76, "Text": " Yes."}, {"Time_Start": 889.76, "Time_End": 893.76, "Text": " In there, in the second section, say, you inject,"}, {"Time_Start": 893.76, "Time_End": 895.76, "Text": " are there any restraints on that?"}, {"Time_Start": 895.76, "Time_End": 897.08, "Text": " There will, and I will get to that later."}, {"Time_Start": 897.08, "Time_End": 899.88, "Text": " Another thing you have to do is you have to match the data types of the columns."}, {"Time_Start": 899.88, "Time_End": 901.76, "Text": " I'll show you that to you in a minute, though."}, {"Time_Start": 901.76, "Time_End": 904.76, "Text": " See, we're going to have here."}, {"Time_Start": 904.76, "Time_End": 906.76, "Text": " Yeah, you have to do that."}, {"Time_Start": 906.76, "Time_End": 910.76, "Text": " So while Oracle will return you, for instance, Oracle will say,"}, {"Time_Start": 910.76, "Time_End": 913.76, "Text": " you're missing the right parentheses, and of course this error message"}, {"Time_Start": 913.76, "Time_End": 917.74, "Text": " is for the benefit of the application developer and not"}, {"Time_Start": 917.76, "Time_End": 919.76, "Text": " the end user, the customer."}, {"Time_Start": 919.76, "Time_End": 921.76, "Text": " They're telling it to you anyway because the person who's"}, {"Time_Start": 921.76, "Time_End": 925.76, "Text": " running the web server and the ODBC server hasn't taken the time"}, {"Time_Start": 925.76, "Time_End": 927.76, "Text": " to disable error messages."}, {"Time_Start": 927.76, "Time_End": 930.76, "Text": " Some web user out there looking at their site on the internet should never"}, {"Time_Start": 930.76, "Time_End": 935.76, "Text": " be able to see debugging error messages that are coming from your site."}, {"Time_Start": 935.76, "Time_End": 939.76, "Text": " And while Oracle tells you missing right parentheses, one thing that it will not do is"}, {"Time_Start": 939.76, "Time_End": 942.76, "Text": " if you've ever seen a SQL server error message, it gives you parts"}, {"Time_Start": 942.76, "Time_End": 945.76, "Text": " of the SQL query that will run in the error message."}, {"Time_Start": 945.76, "Time_End": 947.76, "Text": " Oracle will never do that."}, {"Time_Start": 947.76, "Time_End": 954.76, "Text": " And while in SQL server, it's really easy to pick something like syntax or table name and stuff out of there because you get them in the air messages."}, {"Time_Start": 954.76, "Time_End": 957.76, "Text": " On Oracle, you are on your own."}, {"Time_Start": 957.76, "Time_End": 960.76, "Text": " Another thing you're going to run into is a like query."}, {"Time_Start": 960.76, "Time_End": 962.76, "Text": " Like queries are used in SQL for searching for things."}, {"Time_Start": 962.76, "Time_End": 964.76, "Text": " They use wild cards."}, {"Time_Start": 964.76, "Time_End": 966.76, "Text": " For instance, this one you'll notice."}, {"Time_Start": 966.76, "Time_End": 970.76, "Text": " Enter as much you know of a generic worker employee's last name to obtain their phone number."}, {"Time_Start": 970.76, "Time_End": 973.76, "Text": " Because I'm sure everyone saw the last time I used S King."}, {"Time_Start": 973.76, "Time_End": 977.74, "Text": " Let's say I forgot their first name, but I know that their email address"}, {"Time_Start": 977.76, "Time_End": 980.76, "Text": " ends in King."}, {"Time_Start": 980.76, "Time_End": 983.76, "Text": " And I got, look, two employees happen to have the last name king here."}, {"Time_Start": 983.76, "Time_End": 985.76, "Text": " Here's what it looks like in code."}, {"Time_Start": 985.76, "Time_End": 998.76, "Text": " First part's the same, but at the end, where email, like, and these percent signs here,"}, {"Time_Start": 998.76, "Time_End": 1002.76, "Text": " they're the same as asterks, they're basically wild cards."}, {"Time_Start": 1002.76, "Time_End": 1006.76, "Text": " Now the way you get around this, and remember, you want to make sure that their SQL query,"}, {"Time_Start": 1006.76, "Time_End": 1011.26, "Text": " SQL query, select last, first name, last name, phone number from employees."}, {"Time_Start": 1011.26, "Time_End": 1012.76, "Text": " You want to make sure that doesn't return records."}, {"Time_Start": 1012.76, "Time_End": 1013.76, "Text": " You don't want to see him."}, {"Time_Start": 1013.76, "Time_End": 1019.76, "Text": " So what we're going to do here is going to go something that's obviously not going to turn up in"}, {"Time_Start": 1019.76, "Time_End": 1020.76, "Text": " their email address database."}, {"Time_Start": 1020.76, "Time_End": 1023.76, "Text": " Return no records, for instance."}, {"Time_Start": 1023.76, "Time_End": 1027.76, "Text": " Union select, all tables."}, {"Time_Start": 1027.76, "Time_End": 1029.76, "Text": " Ah, did it again."}, {"Time_Start": 1029.76, "Time_End": 1031.76, "Text": " Table name, that's right."}, {"Time_Start": 1036.76, "Time_End": 1046.76, "Text": " where, and you have to match what they have, so we're going to use a like here, where table name,"}, {"Time_Start": 1046.76, "Time_End": 1051.76, "Text": " got to use a valid table name, like, makes, or you actually don't have to match,"}, {"Time_Start": 1051.76, "Time_End": 1054.76, "Text": " like, we're going to do it anyway here, I just thought of something,"}, {"Time_Start": 1054.76, "Time_End": 1060.76, "Text": " or like, and remember at the end of what you put, they are going to throw in percent"}, {"Time_Start": 1060.76, "Time_End": 1064.76, "Text": " quote, like, does not occur in the end of what you put, they are going to throw in percent quote, like, does not"}, {"Time_Start": 1064.76, "Time_End": 1071.76, "Text": " occur in DB, that should look good."}, {"Time_Start": 1071.76, "Time_End": 1074.76, "Text": " One sec."}, {"Time_Start": 1074.76, "Time_End": 1076.76, "Text": " No, you want, I'm sorry, everyone."}, {"Time_Start": 1076.76, "Time_End": 1079.76, "Text": " This one you want to return wild card, because this is your union select."}, {"Time_Start": 1079.76, "Time_End": 1081.76, "Text": " You want this one to return as many as possible."}, {"Time_Start": 1081.76, "Time_End": 1083.76, "Text": " So you're actually going to leave that blank."}, {"Time_Start": 1087.76, "Time_End": 1089.76, "Text": " And again, you get that back."}, {"Time_Start": 1089.76, "Time_End": 1091.76, "Text": " I'll show you this one."}, {"Time_Start": 1094.76, "Time_End": 1124.74, "Text": " And what you get, because you get, because you used a single, a single quote there, you get like a single quote there, you get like, percent,"}, {"Time_Start": 1124.76, "Time_End": 1130.76, "Text": " and I said, the like is wild card, you will get full matches, we'll return back."}, {"Time_Start": 1130.76, "Time_End": 1137.76, "Text": " The third thing you're going to see, where's my, there is, nope, that's all we're doing for, we have time constraints."}, {"Time_Start": 1137.76, "Time_End": 1140.76, "Text": " I wish I could show everyone everything with inserts, but we're going to move along here."}, {"Time_Start": 1140.76, "Time_End": 1144.76, "Text": " So now we're going to use the most simple one because it's going to be the easiest for me to get through the presentation,"}, {"Time_Start": 1144.76, "Time_End": 1146.76, "Text": " and I think you've all got the concept here."}, {"Time_Start": 1146.76, "Time_End": 1150.76, "Text": " Just to check, does anyone have any questions this far?"}, {"Time_Start": 1150.76, "Time_End": 1151.76, "Text": " Yeah."}, {"Time_Start": 1154.76, "Time_End": 1158.76, "Text": " Yeah, you can. I'm going to go through all the different stuff you can do."}, {"Time_Start": 1158.76, "Time_End": 1163.76, "Text": " So the first name, now that we've got our list of tables."}, {"Time_Start": 1163.76, "Time_End": 1180.76, "Text": " Ah, typo."}, {"Time_Start": 1180.76, "Time_End": 1189.76, "Text": " Now that we've got this list, we're going to look through and see what tables look interesting."}, {"Time_Start": 1189.76, "Time_End": 1198.76, "Text": " Since I happen to design this database myself, I will tell you that there is a very interesting table called users here."}, {"Time_Start": 1198.76, "Time_End": 1203.76, "Text": " We're going to look, and the next thing you need to do, now we've got a table name, right?"}, {"Time_Start": 1203.76, "Time_End": 1209.76, "Text": " We need to know, before we can do a query on this table, we need to know what the column names are or else what that kind of information are we going to get back."}, {"Time_Start": 1209.76, "Time_End": 1219.76, "Text": " we're going to get back. Just like there is, in all tables, there is a table called all tab columns."}, {"Time_Start": 1219.76, "Time_End": 1225.76, "Text": " It's got the argument names, column name, and you'll see up here the two seasons stuff, Internet Explorer,"}, {"Time_Start": 1225.76, "Time_End": 1229.76, "Text": " when you send through HTTP, it will encode certain things. I'll show that to you."}, {"Time_Start": 1229.76, "Time_End": 1239.26, "Text": " Union select, column name, again, garbage, garbage, from"}, {"Time_Start": 1239.26, "Time_End": 1242.36, "Text": " all, what is it, user columns?"}, {"Time_Start": 1242.76, "Time_End": 1244.5, "Text": " I guess I should know this when I'm asking you guys."}, {"Time_Start": 1245.66, "Time_End": 1246.0, "Text": " One second."}, {"Time_Start": 1251.12, "Time_End": 1264.3799999999999, "Text": " All tab columns, which is, of course, all table columns, where, and we specify, and again, all tab columns is another one of those standard oracle tables."}, {"Time_Start": 1264.3799999999999, "Time_End": 1268.64, "Text": " You can look it up in the Oracle reference documentation if you want what the rest of the column names are and stuff."}, {"Time_Start": 1269.26, "Time_End": 1271.4, "Text": " our table name equal, and here's what we want."}, {"Time_Start": 1271.46, "Time_End": 1277.26, "Text": " We want user. And remember that Oracle is most of the time with the NVAR chart data type that"}, {"Time_Start": 1277.26, "Time_End": 1280.72, "Text": " most database administrators are going to use, it will be case sensitive."}, {"Time_Start": 1281.02, "Time_End": 1284.54, "Text": " Capital user will not be the same table as lowercase user."}, {"Time_Start": 1285.54, "Time_End": 1290.0, "Text": " Of course, we know that our ASP scripts lands an extra single port onto the end and went on to the beginning,"}, {"Time_Start": 1290.12, "Time_End": 1291.32, "Text": " so we've got our syntax matched."}, {"Time_Start": 1293.64, "Time_End": 1296.18, "Text": " And amazingly enough, one sec."}, {"Time_Start": 1299.26, "Time_End": 1307.98, "Text": " Literally. Yeah. It's not that. Till over here, God, it was my savior. And we have to make sure it returns."}, {"Time_Start": 1310.68, "Time_End": 1311.54, "Text": " Yeah, what was that?"}, {"Time_Start": 1313.4, "Time_End": 1314.82, "Text": " What are a table name? What am I doing here?"}, {"Time_Start": 1316.28, "Time_End": 1320.1, "Text": " Users. From all table name. We're table name equals users. You guys are great. Thank you, everyone."}, {"Time_Start": 1321.4, "Time_End": 1329.24, "Text": " And incredibly difficult to guess. Column names in the super secret table users are, of course, username and pass."}, {"Time_Start": 1329.26, "Time_End": 1333.26, "Text": " Now that we know that, we're going to run back here."}, {"Time_Start": 1333.26, "Time_End": 1343.26, "Text": " We're going to plug in username, password, and it's coming from the table,"}, {"Time_Start": 1343.26, "Time_End": 1349.26, "Text": " users, where, and of course, we don't need this part anymore."}, {"Time_Start": 1349.26, "Time_End": 1354.26, "Text": " Check that up for a second."}, {"Time_Start": 1354.26, "Time_End": 1359.24, "Text": " We're selecting username, password, and A, from users, where one equal"}, {"Time_Start": 1359.26, "Time_End": 1365.68, "Text": " is one. And as you can see, they have a very strict password policy on this site. And"}, {"Time_Start": 1365.68, "Time_End": 1370.1, "Text": " for anyone who thinks things like this are unlikely, I recently did like a pen test on a large"}, {"Time_Start": 1370.1, "Time_End": 1375.42, "Text": " communications company, and their admin password really was the administrator's username, followed"}, {"Time_Start": 1375.42, "Time_End": 1382.82, "Text": " by 2002. So now we're going to use that, and we're going to go back to another login page."}, {"Time_Start": 1382.82, "Time_End": 1387.82, "Text": " Now this login page, because it's designed a slightly different way, and I'll show you, you can't"}, {"Time_Start": 1387.82, "Time_End": 1393.32, "Text": " do the quote equals one equals one thing on."}, {"Time_Start": 1393.32, "Time_End": 1398.86, "Text": " What happens in this one is it does the same thing, select username from users where"}, {"Time_Start": 1398.86, "Time_End": 1407.74, "Text": " username is password, but in ASP code, which we can't tamper with, it actually looks on this part"}, {"Time_Start": 1407.74, "Time_End": 1415.06, "Text": " to check, is the record that it returned back the same as the variable I have for username."}, {"Time_Start": 1415.06, "Time_End": 1417.8, "Text": " So in this one, we're not going to be able to sequence one."}, {"Time_Start": 1417.82, "Time_End": 1423.1, "Text": " our way through authorization bypass, excuse me, authentication bypass, I was waiting"}, {"Time_Start": 1423.1, "Time_End": 1429.22, "Text": " for someone to call me on that. So we have now, but since we SQL injected and we got"}, {"Time_Start": 1429.22, "Time_End": 1438.76, "Text": " Gidman's username and to secret password, we can go through and we can still recover sensitive"}, {"Time_Start": 1438.76, "Time_End": 1443.98, "Text": " financial information. Now that's the basics about how your select SQL injection"}, {"Time_Start": 1443.98, "Time_End": 1447.58, "Text": " is going to work, and now I'm going to go into some Oracle specific things I figured out."}, {"Time_Start": 1447.82, "Time_End": 1449.6799999999998, "Text": " going through reference manuals and things."}, {"Time_Start": 1450.3999999999999, "Time_End": 1455.52, "Text": " Oracle databases are huge, and they contain almost all of their configuration information"}, {"Time_Start": 1455.52, "Time_End": 1457.58, "Text": " within system tables."}, {"Time_Start": 1458.1599999999999, "Time_End": 1460.8, "Text": " There are system tables for all kinds of things."}, {"Time_Start": 1461.3, "Time_End": 1467.4399999999998, "Text": " One of the things that they have a table for is, for instance, the password policy."}, {"Time_Start": 1467.9399999999998, "Time_End": 1472.54, "Text": " If you can't get out, if in the improbable event, and I say improbable, because I've done this on many,"}, {"Time_Start": 1472.58, "Time_End": 1477.54, "Text": " many sites, and it seems like no one really understands that it's a pretty good idea to hash your passwords,"}, {"Time_Start": 1477.54, "Time_End": 1482.5, "Text": " instead of staying keeping them in clear text, you can get the password policy."}, {"Time_Start": 1483.24, "Time_End": 1485.74, "Text": " In this case, and this, by the way, is the default configuration."}, {"Time_Start": 1486.0, "Time_End": 1490.5, "Text": " I just want to point out that Oracle by default will let you try to log on as many times as you like"}, {"Time_Start": 1490.5, "Time_End": 1491.7, "Text": " and it will not bother you."}, {"Time_Start": 1492.52, "Time_End": 1495.04, "Text": " You can get failed login attempts."}, {"Time_Start": 1496.12, "Time_End": 1497.1599999999999, "Text": " Password grace time."}, {"Time_Start": 1497.32, "Time_End": 1500.36, "Text": " And this only will work, again, this is for the Oracle log-on."}, {"Time_Start": 1500.6, "Time_End": 1502.54, "Text": " This is not for the web application."}, {"Time_Start": 1502.68, "Time_End": 1503.72, "Text": " It may be completely different."}, {"Time_Start": 1504.52, "Time_End": 1507.52, "Text": " If you can get an order, the Oracle server by your network, this information."}, {"Time_Start": 1507.54, "Time_End": 1509.1, "Text": " is unbelievably useful."}, {"Time_Start": 1509.6, "Time_End": 1513.3999999999999, "Text": " If they do have a policy in place, and you have maximum amount of attempts,"}, {"Time_Start": 1513.48, "Time_End": 1517.42, "Text": " this stuff can really help you design tools that will cut down your brute force time dramatically."}, {"Time_Start": 1518.96, "Time_End": 1524.84, "Text": " Another interesting thing about modern database servers is they basically got their own"}, {"Time_Start": 1524.84, "Time_End": 1526.86, "Text": " enormous programming languages built in."}, {"Time_Start": 1527.2, "Time_End": 1529.74, "Text": " They want developers to use nothing but Oracle tools."}, {"Time_Start": 1529.84, "Time_End": 1531.1399999999999, "Text": " They want them to buy the dev kits."}, {"Time_Start": 1531.22, "Time_End": 1532.72, "Text": " They want them to do all kinds of stuff."}, {"Time_Start": 1533.22, "Time_End": 1537.52, "Text": " And as a result, they contain some very, very interesting procedures."}, {"Time_Start": 1537.54, "Time_End": 1540.04, "Text": " and built-in commands as part of their database."}, {"Time_Start": 1541.04, "Time_End": 1546.54, "Text": " One of the interesting things I've found in the Oracle is there is a package called UTL HTTP,"}, {"Time_Start": 1546.54, "Time_End": 1551.54, "Text": " the HTTP utility, and it has a method called request."}, {"Time_Start": 1551.54, "Time_End": 1560.54, "Text": " This will allow you in a SQL statement to make an HTTP request to another server and return your result as part of the record set."}, {"Time_Start": 1561.54, "Time_End": 1567.52, "Text": " If anyone can see up here and it's probably not large enough, what this basically looked, what this basically looked,"}, {"Time_Start": 1567.54, "Time_End": 1571.34, "Text": " what has happened here is as part of my SQL statement, and I'll show you again"}, {"Time_Start": 1571.34, "Time_End": 1578.74, "Text": " on the phoneer page in a minute, it has pulled back an HTTP request and put it in the record"}, {"Time_Start": 1578.74, "Time_End": 1579.04, "Text": " set."}, {"Time_Start": 1579.04, "Time_End": 1584.74, "Text": " And I'm also going to point out that there are like tens of thousands of these methods and procedures"}, {"Time_Start": 1584.74, "Time_End": 1589.04, "Text": " in Oracle, and there's not a database administrator in the face of the earth that, you know,"}, {"Time_Start": 1589.04, "Time_End": 1593.04, "Text": " remembers to lock all this stuff down, it's simply unbelievable."}, {"Time_Start": 1593.04, "Time_End": 1596.04, "Text": " So we're going to look at this and see how to do that."}, {"Time_Start": 1596.04, "Time_End": 1601.04, "Text": " Union Select, UTL, HDP, request."}, {"Time_Start": 1602.18, "Time_End": 1605.04, "Text": " And in this case, I'm not connecting this box to Infinet,"}, {"Time_Start": 1605.04, "Time_End": 1609.04, "Text": " so I'm just going to do local host, which I know is, you know,"}, {"Time_Start": 1609.04, "Time_End": 1614.04, "Text": " really impressive, scripts, what's another one, phone,"}, {"Time_Start": 1614.04, "Time_End": 1617.04, "Text": " or let's use login, like I showed you in the bookmark,"}, {"Time_Start": 1617.04, "Time_End": 1619.04, "Text": " login.asp."}, {"Time_Start": 1621.04, "Time_End": 1625.04, "Text": " Match your columns from Union Select, no, so log is to AMP."}, {"Time_Start": 1625.04, "Time_End": 1631.04, "Text": " I told you about the dual table. It doesn't really have anything in it, but it'll make sure you get your result back."}, {"Time_Start": 1631.04, "Time_End": 1636.04, "Text": " Where, and we're going to match the end so that it works nicely with what's in the ASP code."}, {"Time_Start": 1640.04, "Time_End": 1642.04, "Text": " Inval relational operator, one sec."}, {"Time_Start": 1642.04, "Time_End": 1646.04, "Text": " Community select, QQDP be requested."}, {"Time_Start": 1646.04, "Time_End": 1650.04, "Text": " A from June, where I'm wrong, sorry, guys."}, {"Time_Start": 1650.04, "Time_End": 1654.04, "Text": " Was it? Is that my relational operator problem?"}, {"Time_Start": 1654.04, "Time_End": 1655.04, "Text": " problem?"}, {"Time_Start": 1655.04, "Time_End": 1664.04, "Text": " Yeah, thank you for solving all of my relational operator problems, man in the back."}, {"Time_Start": 1664.04, "Time_End": 1665.04, "Text": " And we get that."}, {"Time_Start": 1665.04, "Time_End": 1670.04, "Text": " Now, I want everyone to think about the implication from this, of the implications of this."}, {"Time_Start": 1670.04, "Time_End": 1677.04, "Text": " This request is being made from where your Oracle database server is, which is probably,"}, {"Time_Start": 1677.04, "Time_End": 1682.04, "Text": " although in some places people really do put the Oracle server on the exact same box as the web server."}, {"Time_Start": 1682.04, "Time_End": 1683.04, "Text": " This is probably behind a firewall."}, {"Time_Start": 1683.04, "Time_End": 1684.04, "Text": " firewall."}, {"Time_Start": 1684.04, "Time_End": 1688.84, "Text": " There's a very good chance you have no other way of getting at this Oracle box."}, {"Time_Start": 1688.84, "Time_End": 1693.08, "Text": " You can make the Oracle box from inside the firewall."}, {"Time_Start": 1693.08, "Time_End": 1697.6599999999999, "Text": " You can make requests to internal IP addresses and you can scan for internet web servers"}, {"Time_Start": 1697.6599999999999, "Time_End": 1701.28, "Text": " using this thing that you would normally would not be able to get through from the internet,"}, {"Time_Start": 1701.28, "Time_End": 1702.6, "Text": " which is really great."}, {"Time_Start": 1702.6, "Time_End": 1707.54, "Text": " Another interesting thing about Oracle in order to show everyone how it integrates great with"}, {"Time_Start": 1707.54, "Time_End": 1712.6599999999999, "Text": " web services and web applications, Oracle has taken the liberty of when you install the Oracle"}, {"Time_Start": 1712.66, "Time_End": 1717.78, "Text": " database, it installs an HTTP server, it's built on top of Apache, its Oracle"}, {"Time_Start": 1717.78, "Time_End": 1721.42, "Text": " application server, on the same box as the Oracle server."}, {"Time_Start": 1721.42, "Time_End": 1726.0, "Text": " I just set an Oracle server up on this test box a couple hours ago, and I can tell you that"}, {"Time_Start": 1726.0, "Time_End": 1728.8400000000001, "Text": " it is impossible to disable it in the installation."}, {"Time_Start": 1728.8400000000001, "Time_End": 1733.3400000000001, "Text": " It will not like you uncheck the box, and by default it runs automatically as a service"}, {"Time_Start": 1733.3400000000001, "Time_End": 1734.72, "Text": " and it will start it."}, {"Time_Start": 1734.72, "Time_End": 1739.48, "Text": " So be sure you check Local Host 80 when you get this, because there's a good chance that"}, {"Time_Start": 1739.48, "Time_End": 1742.64, "Text": " you're going to have a web server running on the Oracle database server."}, {"Time_Start": 1742.66, "Time_End": 1744.22, "Text": " and the administrator doesn't even know it."}, {"Time_Start": 1746.9, "Time_End": 1752.26, "Text": " Other interesting stuff, you can get, union select,"}, {"Time_Start": 1753.14, "Time_End": 1759.3400000000001, "Text": " the column name is SQL text, and then you have SQL text."}, {"Time_Start": 1759.94, "Time_End": 1764.7, "Text": " There's the second one that, yeah, SQL text from, there's a table called SQL text."}, {"Time_Start": 1765.28, "Time_End": 1768.4, "Text": " These are all the previous SQL queries that have been run against the database."}, {"Time_Start": 1768.4, "Time_End": 1771.98, "Text": " They contain all kinds of interesting information."}, {"Time_Start": 1772.66, "Time_End": 1774.5400000000002, "Text": " I didn't even run any of these."}, {"Time_Start": 1774.5400000000002, "Time_End": 1775.3400000000001, "Text": " I never did this."}, {"Time_Start": 1775.3400000000001, "Time_End": 1779.94, "Text": " This is something the system does by itself, and you can go through it all at your leisure through"}, {"Time_Start": 1779.94, "Time_End": 1782.66, "Text": " SQL injection."}, {"Time_Start": 1782.66, "Time_End": 1783.66, "Text": " See it?"}, {"Time_Start": 1783.66, "Time_End": 1785.6200000000001, "Text": " You guys remember all this stuff?"}, {"Time_Start": 1785.6200000000001, "Time_End": 1786.66, "Text": " All stored in the database."}, {"Time_Start": 1786.66, "Time_End": 1788.94, "Text": " Worker forgets nothing."}, {"Time_Start": 1788.94, "Time_End": 1790.78, "Text": " Other interesting stuff?"}, {"Time_Start": 1790.78, "Time_End": 1792.78, "Text": " Yeah."}, {"Time_Start": 1792.78, "Time_End": 1796.98, "Text": " I apologize, like I said, I just set this up."}, {"Time_Start": 1796.98, "Time_End": 1801.8400000000001, "Text": " This is not on your DEFCON CD-ROMs, this presentation, but we will have it posted."}, {"Time_Start": 1801.8400000000001, "Time_End": 1802.64, "Text": " I'll get tangent."}, {"Time_Start": 1802.66, "Time_End": 1810.96, "Text": " put it on the defcon.org site and our company's website, www.spaidynamics.com."}, {"Time_Start": 1810.96, "Time_End": 1814.48, "Text": " We'll have all this information. You'll have a pretty document, white paper, whatever thing that"}, {"Time_Start": 1814.48, "Time_End": 1818.3400000000001, "Text": " we can give to suits, and it won't frighten them, and you guys can read, and pick out all kinds"}, {"Time_Start": 1818.3400000000001, "Time_End": 1822.16, "Text": " of interesting table names that I'm using here. You'll be able to have this information."}, {"Time_Start": 1822.16, "Time_End": 1825.16, "Text": " So if you're not writing everything down at the speed of light here, don't worry about it."}, {"Time_Start": 1829.16, "Time_End": 1832.64, "Text": " But since you asked, table name, SQL text,"}, {"Time_Start": 1832.66, "Time_End": 1835.24, "Text": " And remember, this is all in your standard Oracle documentation."}, {"Time_Start": 1835.3400000000001, "Time_End": 1837.6000000000001, "Text": " This is completely in there for anyone who bothers to read it."}, {"Time_Start": 1838.94, "Time_End": 1840.38, "Text": " Column name is SQL text."}, {"Time_Start": 1841.3400000000001, "Time_End": 1842.48, "Text": " Other great stuff?"}, {"Time_Start": 1843.22, "Time_End": 1843.8600000000001, "Text": " Your privileges."}, {"Time_Start": 1846.0600000000002, "Time_End": 1850.98, "Text": " Username, granted role, from user role privs."}, {"Time_Start": 1852.0, "Time_End": 1854.4, "Text": " Now, this will give you a couple of interesting things."}, {"Time_Start": 1854.46, "Time_End": 1857.42, "Text": " The first thing it tells you is what your username is."}, {"Time_Start": 1857.8200000000002, "Time_End": 1859.3200000000002, "Text": " In this case, I have it set up."}, {"Time_Start": 1859.38, "Time_End": 1861.3200000000002, "Text": " It uses the username web user."}, {"Time_Start": 1861.8400000000001, "Time_End": 1862.48, "Text": " And I see that I have it."}, {"Time_Start": 1862.66, "Time_End": 1865.3600000000001, "Text": " have rights to connect, which is an obvious one."}, {"Time_Start": 1865.6000000000001, "Time_End": 1867.88, "Text": " Also, interestingly enough, I have DBA privileges."}, {"Time_Start": 1868.48, "Time_End": 1873.9, "Text": " And for anyone who thinks it is unlikely that the Oracle administrators will set up the web"}, {"Time_Start": 1873.9, "Time_End": 1879.22, "Text": " application user as DBA, I can tell you for a fact that people do it all the time, because then"}, {"Time_Start": 1879.22, "Time_End": 1883.52, "Text": " they don't have to bother setting up like its privileges and rights and things like that."}, {"Time_Start": 1883.6200000000001, "Time_End": 1885.64, "Text": " It'll automatically have access to what it needs, you see."}, {"Time_Start": 1885.94, "Time_End": 1886.5600000000002, "Text": " And so will be."}, {"Time_Start": 1887.5600000000002, "Time_End": 1890.42, "Text": " So we've automatically got, we've got our privileges."}, {"Time_Start": 1890.78, "Time_End": 1891.88, "Text": " Other interesting stuff?"}, {"Time_Start": 1892.66, "Time_End": 1895.7, "Text": " Oracle version info."}, {"Time_Start": 1895.7, "Time_End": 1904.1000000000001, "Text": " This table name is called the dollar sign version and the column name is banner and the column name"}, {"Time_Start": 1904.1000000000001, "Time_End": 1908.3000000000002, "Text": " is banner and it gives you all the information about what it's running."}, {"Time_Start": 1908.3000000000002, "Time_End": 1912.48, "Text": " Other great stuff, and this one will take a minute because it's a very long point and I'll"}, {"Time_Start": 1912.48, "Time_End": 1914.5600000000002, "Text": " tell you why it's long."}, {"Time_Start": 1914.5600000000002, "Time_End": 1919.5800000000002, "Text": " Oracle stores stored procedure information in tables."}, {"Time_Start": 1919.5800000000002, "Time_End": 1922.64, "Text": " You can get the source to the Oracle stored procedure procedure."}, {"Time_Start": 1922.66, "Time_End": 1926.5400000000002, "Text": " by accessing tables you see it's loading real slow because it pulls back you"}, {"Time_Start": 1926.5400000000002, "Time_End": 1932.02, "Text": " can go through the source code for all the stored procedures on the database this"}, {"Time_Start": 1932.02, "Time_End": 1934.6000000000001, "Text": " one's going to take a minute so we're going to head to another browser while that one"}, {"Time_Start": 1934.6000000000001, "Time_End": 1943.0400000000002, "Text": " loads other great stuff god the Oracle server is going to be swamped this is"}, {"Time_Start": 1943.0400000000002, "Time_End": 1947.78, "Text": " running on like a VMware box and Win 2k Pro so this isn't happening none too quickly"}, {"Time_Start": 1952.66, "Time_End": 1954.16, "Text": " We may just have to wait for this one."}, {"Time_Start": 1955.3600000000001, "Time_End": 1956.9, "Text": " I tell you what, I'll do this one right."}, {"Time_Start": 1956.98, "Time_End": 1957.6200000000001, "Text": " Oh, there we go."}, {"Time_Start": 1958.72, "Time_End": 1959.6000000000001, "Text": " I have here."}, {"Time_Start": 1959.78, "Time_End": 1965.7, "Text": " We're selecting name, line number, and like I said, if you're trying to write this all down,"}, {"Time_Start": 1965.76, "Time_End": 1966.76, "Text": " you don't have to worry about it."}, {"Time_Start": 1966.8200000000002, "Time_End": 1969.1200000000001, "Text": " We'll get the stuff on the net so that everyone can not see it."}, {"Time_Start": 1970.0800000000002, "Time_End": 1976.3400000000001, "Text": " Select name, line, and text from table name is all underscore source."}, {"Time_Start": 1977.0400000000002, "Time_End": 1981.66, "Text": " And another good nice thing about Oracle is that it has an identifier called Ronum."}, {"Time_Start": 1982.66, "Time_End": 1989.0, "Text": " RONM is a universal column name, and you can use it to limit the amount of rows that are returned."}, {"Time_Start": 1989.16, "Time_End": 1994.44, "Text": " In fact, I will show you this query, and I'll actually inject it myself so that you can make sure you're getting all this."}, {"Time_Start": 1994.8600000000001, "Time_End": 1996.16, "Text": " But just go through this stuff."}, {"Time_Start": 1996.28, "Time_End": 2001.92, "Text": " It's all kinds of unbelievable stuff you can see in the stored procedure source about how the database is set up,"}, {"Time_Start": 2002.28, "Time_End": 2003.4, "Text": " what kind of other stuff is."}, {"Time_Start": 2003.5800000000002, "Time_End": 2007.14, "Text": " On a really large database, you can have so many user-defined table names."}, {"Time_Start": 2007.4, "Time_End": 2011.76, "Text": " If you look through the stored procedure source code, you can usually figure out which ones are interesting and which ones aren't."}, {"Time_Start": 2012.66, "Time_End": 2016.02, "Text": " I'll go back and that is name, 2, char line number, all source."}, {"Time_Start": 2018.74, "Time_End": 2022.66, "Text": " Union, select, fuck, I forgot, sorry."}, {"Time_Start": 2025.38, "Time_End": 2026.92, "Text": " Yeah, name to car and text."}, {"Time_Start": 2028.76, "Time_End": 2031.66, "Text": " Select name, which is going to be your procedure name,"}, {"Time_Start": 2032.7, "Time_End": 2037.14, "Text": " two char line, and I will show you while we do that two char in just a minute,"}, {"Time_Start": 2037.3000000000002, "Time_End": 2042.64, "Text": " just what I told that guy over there, is that you have to do certain type of data type matching on Union Quar."}, {"Time_Start": 2042.66, "Time_End": 2044.46, "Text": " I probably should have started with that at the beginning."}, {"Time_Start": 2044.5600000000002, "Time_End": 2054.0, "Text": " We'll have to go back to show a line and, of course, text from all source, where 1 equals 1."}, {"Time_Start": 2054.08, "Time_End": 2057.44, "Text": " And you'll notice that none of the stuff is using like exploits."}, {"Time_Start": 2057.52, "Time_End": 2059.14, "Text": " None of the stuff is underground information."}, {"Time_Start": 2059.26, "Time_End": 2060.38, "Text": " We're using the SQL injection."}, {"Time_Start": 2060.88, "Time_End": 2066.1800000000003, "Text": " This is just stuff that is stored in the Oracle database and yours for the taking if you want it and you know where it is."}, {"Time_Start": 2067.6800000000003, "Time_End": 2071.42, "Text": " And of course, as we can see, it would take another half an hour to load, but we're not going to wait."}, {"Time_Start": 2072.14, "Time_End": 2072.64, "Text": " That is how it."}, {"Time_Start": 2072.66, "Time_End": 2079.66, "Text": " works. Here is the part about type matching. I don't know I skipped over it, but"}, {"Time_Start": 2079.66, "Time_End": 2085.66, "Text": " it can take a minute. I'll open it up over the ASP and I'll show you what's happening."}, {"Time_Start": 2102.66, "Time_End": 2105.08, "Text": " And I'll do this with literals and numbers to make it real simple."}, {"Time_Start": 2105.64, "Time_End": 2110.48, "Text": " From dual, and remember I just told you guys again, the dual table, it's not a real table."}, {"Time_Start": 2110.56, "Time_End": 2111.8199999999997, "Text": " It'll just return back what you give it."}, {"Time_Start": 2111.8599999999997, "Time_End": 2115.7599999999998, "Text": " In this case, it will return A and 1, where 1 equals 1."}, {"Time_Start": 2118.1, "Time_End": 2119.14, "Text": " Union select."}, {"Time_Start": 2119.3399999999997, "Time_End": 2120.14, "Text": " Now watch this."}, {"Time_Start": 2120.8799999999997, "Time_End": 2127.3799999999997, "Text": " Let's say we have A and A from dual for 1 equals 1."}, {"Time_Start": 2128.98, "Time_End": 2130.92, "Text": " Oracle does not like this."}, {"Time_Start": 2130.92, "Time_End": 2132.2799999999997, "Text": " I'll show you what's happening."}, {"Time_Start": 2132.66, "Time_End": 2135.98, "Text": " Expression must have some data type as corresponding expression."}, {"Time_Start": 2136.7799999999997, "Time_End": 2139.8799999999997, "Text": " Not only do you have to have one, two columns here and one two columns here."}, {"Time_Start": 2140.56, "Time_End": 2142.3399999999997, "Text": " The types have to match."}, {"Time_Start": 2142.44, "Time_End": 2143.72, "Text": " If they don't match, you're in trouble."}, {"Time_Start": 2144.7999999999997, "Time_End": 2148.3799999999997, "Text": " So what you have to do is once you know how many columns there are,"}, {"Time_Start": 2148.92, "Time_End": 2151.48, "Text": " what you're going to want to do is if you start getting errors,"}, {"Time_Start": 2152.7599999999998, "Time_End": 2154.12, "Text": " you're going to have to start playing with things."}, {"Time_Start": 2154.2999999999997, "Time_End": 2158.8599999999997, "Text": " Generally, people are going to have three different kinds of general data types."}, {"Time_Start": 2158.8599999999997, "Time_End": 2162.46, "Text": " Of course, NVAR char is different from NVAR 2, but they convert implicitly."}, {"Time_Start": 2162.66, "Time_End": 2168.96, "Text": " But when you're going to have, you're going to try a letter, you're going to try a number, and you're going to try a date."}, {"Time_Start": 2169.06, "Time_End": 2172.7599999999998, "Text": " And I'll tell you the easiest way to do dates is not to try to do stuff like this."}, {"Time_Start": 2173.2999999999997, "Time_End": 2179.5, "Text": " There is a function called CISDate, and it will hand you back the current date in that record set."}, {"Time_Start": 2180.8199999999997, "Time_End": 2183.52, "Text": " In this case, let's say I try CISTate first."}, {"Time_Start": 2185.42, "Time_End": 2186.7599999999998, "Text": " DrunkCube would not find unexpected."}, {"Time_Start": 2188.2, "Time_End": 2192.64, "Text": " CState may not be a function, it just may be involved in there."}, {"Time_Start": 2192.66, "Time_End": 2193.16, "Text": " One second."}, {"Time_Start": 2198.8199999999997, "Time_End": 2203.04, "Text": " There you go. It doesn't like CISD, which, by the way, case sensitive, have to have it like that."}, {"Time_Start": 2203.74, "Time_End": 2206.8999999999996, "Text": " But let's say we make it one, and it gets happy."}, {"Time_Start": 2207.8399999999997, "Time_End": 2209.2599999999998, "Text": " Gets happy. Real technical here."}, {"Time_Start": 2212.3199999999997, "Time_End": 2213.98, "Text": " So you don't have any questions at this point."}, {"Time_Start": 2214.12, "Time_End": 2215.92, "Text": " I've been looking kind of quickly and haphazardly."}, {"Time_Start": 2216.02, "Time_End": 2216.7999999999997, "Text": " Anyone want to know anything?"}, {"Time_Start": 2220.42, "Time_End": 2222.3799999999997, "Text": " Yeah, and that's what we do here in this one, which."}, {"Time_Start": 2222.66, "Time_End": 2225.06, "Text": " is still trying to load it for some silly reason."}, {"Time_Start": 2227.3599999999997, "Time_End": 2227.7599999999998, "Text": " Hmm?"}, {"Time_Start": 2229.8599999999997, "Time_End": 2230.7599999999998, "Text": " Top 10, what?"}, {"Time_Start": 2232.8999999999996, "Time_End": 2233.6, "Text": " The loading."}, {"Time_Start": 2234.3999999999996, "Time_End": 2236.5, "Text": " This is only like a VMO box with no RAM,"}, {"Time_Start": 2236.62, "Time_End": 2238.7799999999997, "Text": " so if it's taking a long time, we can't do much about it."}, {"Time_Start": 2239.8999999999996, "Time_End": 2241.7599999999998, "Text": " You see here, line is a number."}, {"Time_Start": 2242.02, "Time_End": 2243.6, "Text": " And in order to get it to return it"}, {"Time_Start": 2243.6, "Time_End": 2247.52, "Text": " in the column,"}, {"Time_Start": 2249.08, "Time_End": 2250.64, "Text": " yeah, this one just takes a long time."}, {"Time_Start": 2252.04, "Time_End": 2252.64, "Text": " Let's limit it."}, {"Time_Start": 2252.66, "Time_End": 2260.1, "Text": " this with Roanum. It's less than one. Roanum very useful."}, {"Time_Start": 2266.74, "Time_End": 2271.3399999999997, "Text": " It still may actually go through and seek all of them and only return with Roanum is less than one."}, {"Time_Start": 2272.2799999999997, "Time_End": 2276.66, "Text": " Anyway, I don't, we don't have probably time for this. I don't want to cut into the next speaker's time."}, {"Time_Start": 2278.1, "Time_End": 2282.64, "Text": " We have two char here, and we're using this to convert line, which is a number, so we"}, {"Time_Start": 2282.66, "Time_End": 2285.42, "Text": " can do our character type matching to that."}, {"Time_Start": 2286.42, "Time_End": 2287.72, "Text": " Other good stuff you can find?"}, {"Time_Start": 2295.1, "Time_End": 2298.5, "Text": " This whole thing may be waiting on the queries that we'll run whether or not I've"}, {"Time_Start": 2298.5, "Time_End": 2299.2599999999998, "Text": " canceled this thing."}, {"Time_Start": 2299.96, "Time_End": 2304.8199999999997, "Text": " You can get the name of the operating system, the operating system user you are running"}, {"Time_Start": 2304.8199999999997, "Time_End": 2308.24, "Text": " under using this query."}, {"Time_Start": 2309.7799999999997, "Time_End": 2311.12, "Text": " Oh, that's right."}, {"Time_Start": 2311.14, "Time_End": 2311.8999999999996, "Text": " I should go through that."}, {"Time_Start": 2312.66, "Time_End": 2315.08, "Text": " There is a function in Oracle."}, {"Time_Start": 2315.24, "Time_End": 2316.54, "Text": " Most functions are stuff like"}, {"Time_Start": 2316.54, "Time_End": 2317.2799999999997, "Text": " 2char."}, {"Time_Start": 2317.94, "Time_End": 2320.6, "Text": " Most functions, you know, are things like they're going to help you add,"}, {"Time_Start": 2320.8399999999997, "Time_End": 2324.3199999999997, "Text": " divide, multiply, subtract, or put data types together, things like that."}, {"Time_Start": 2324.7799999999997, "Time_End": 2328.46, "Text": " There's a very interesting one called Union."}, {"Time_Start": 2329.3799999999997, "Time_End": 2331.02, "Text": " It's called SISContext."}, {"Time_Start": 2331.2599999999998, "Time_End": 2335.14, "Text": " It returns information about the current session you're in."}, {"Time_Start": 2336.04, "Time_End": 2339.2, "Text": " You give it a table space, which the one you want to use is user N,"}, {"Time_Start": 2339.2, "Time_End": 2341.02, "Text": " if it's probably the only ones you have permissions to."}, {"Time_Start": 2341.62, "Time_End": 2342.58, "Text": " And you can get interesting."}, {"Time_Start": 2342.66, "Time_End": 2350.42, "Text": " stuff and the second argument in the syscontext function for instance IP address it"}, {"Time_Start": 2350.42, "Time_End": 2354.8999999999996, "Text": " will tell you the IP address of the box you're running on in selects this context there"}, {"Time_Start": 2354.8999999999996, "Time_End": 2362.7, "Text": " of course we have three columns we're going to use dual don't have to bother with"}, {"Time_Start": 2362.7, "Time_End": 2372.22, "Text": " going to real table just return back what we want this context missing select keyword"}, {"Time_Start": 2372.2200000000003, "Time_End": 2373.6000000000004, "Text": " I'm a real genius."}, {"Time_Start": 2373.88, "Time_End": 2375.3, "Text": " You've all figured it out by now."}, {"Time_Start": 2375.92, "Time_End": 2376.6800000000003, "Text": " There we go."}, {"Time_Start": 2378.3, "Time_End": 2380.88, "Text": " And we get back an IP address."}, {"Time_Start": 2381.0000000000005, "Time_End": 2384.5400000000004, "Text": " Now you're noticing, of course, this is 192-168,"}, {"Time_Start": 2384.6400000000003, "Time_End": 2385.7000000000003, "Text": " which is, of course, disappointing."}, {"Time_Start": 2385.8, "Time_End": 2387.1000000000004, "Text": " I'll tell you two reasons that happening."}, {"Time_Start": 2387.7000000000003, "Time_End": 2390.0200000000004, "Text": " One reason is, of course, I'm not connected to a land."}, {"Time_Start": 2390.1000000000004, "Time_End": 2391.94, "Text": " That's really this box's only IP address."}, {"Time_Start": 2395.5600000000004, "Time_End": 2399.44, "Text": " The second reason it's happening is because there's certain ways of configure to Oracle"}, {"Time_Start": 2399.44, "Time_End": 2402.2000000000003, "Text": " that it's the only Ethernet adapter that it will recognize as your..."}, {"Time_Start": 2402.2200000000003, "Time_End": 2408.5200000000004, "Text": " local one. However, this information is still very, very useful because we can"}, {"Time_Start": 2408.5200000000004, "Time_End": 2418.7200000000003, "Text": " use our HTTP proxy, we now know what to start scanning for when we, like, for instance,"}, {"Time_Start": 2422.7200000000003, "Time_End": 2431.1000000000004, "Text": " we've already determined that we can use htl-l-d-d-d-d-prequest to pull information back, and what"}, {"Time_Start": 2431.1, "Time_End": 2436.96, "Text": " you can do is you can set up a script that'll try 192.168. This is stuff on the internal"}, {"Time_Start": 2436.96, "Time_End": 2440.7999999999997, "Text": " network. Obviously, you can't get it from the net, but if you can SQL inject to an Oracle host,"}, {"Time_Start": 2441.1, "Time_End": 2446.7, "Text": " you can get your information back. You can start it, you know, dot 1.0. You can make that request."}, {"Time_Start": 2447.12, "Time_End": 2452.24, "Text": " See if there's a web server there. If you get a null response, there's nothing there, try two,"}, {"Time_Start": 2452.62, "Time_End": 2456.74, "Text": " and try three, and you can work that way, and you can basically turn the Oracle box into an HTTP port"}, {"Time_Start": 2456.74, "Time_End": 2460.5, "Text": " scanner. And if there are intranet web servers running, they're going to have interesting stuff on them."}, {"Time_Start": 2461.1, "Time_End": 2462.1, "Text": " Does it work?"}, {"Time_Start": 2462.1, "Time_End": 2463.1, "Text": " Yeah, absolutely."}, {"Time_Start": 2463.1, "Time_End": 2465.1, "Text": " This works pretty standard sequence."}, {"Time_Start": 2465.1, "Time_End": 2468.1, "Text": " One thing I tried, I was disappointed, does not work."}, {"Time_Start": 2468.1, "Time_End": 2474.1, "Text": " I know you cannot do, like, file, colon, slash, slash."}, {"Time_Start": 2474.1, "Time_End": 2476.1, "Text": " And that pissed me off, because I was hoping for that."}, {"Time_Start": 2476.1, "Time_End": 2478.1, "Text": " You could pull files with local host."}, {"Time_Start": 2478.1, "Time_End": 2479.1, "Text": " Yeah."}, {"Time_Start": 2479.1, "Time_End": 2480.1, "Text": " What?"}, {"Time_Start": 2480.1, "Time_End": 2484.1, "Text": " Mr. Your question requires a pretty lengthy answer."}, {"Time_Start": 2484.1, "Time_End": 2487.1, "Text": " The answer I'll get to in a pretty lengthy answer."}, {"Time_Start": 2487.1, "Time_End": 2488.1, "Text": " I'll get to in a minute."}, {"Time_Start": 2488.1, "Time_End": 2490.1, "Text": " Yours, yeah, you can do HTTP."}, {"Time_Start": 2490.1, "Time_End": 2491.1, "Text": " Good old."}, {"Time_Start": 2491.1, "Time_End": 2493.1, "Text": " do all the negotiates stuff for you."}, {"Time_Start": 2493.1, "Time_End": 2494.1, "Text": " Yeah?"}, {"Time_Start": 2494.1, "Time_End": 2495.1, "Text": " Okay."}, {"Time_Start": 2495.1, "Time_End": 2501.1, "Text": " Can you do, like, any other characters besides the single quote to break out of the..."}, {"Time_Start": 2501.1, "Time_End": 2506.1, "Text": " Generally not."}, {"Time_Start": 2506.1, "Time_End": 2513.1, "Text": " If you can use parentheses, I haven't actually tested on this one, but let's see."}, {"Time_Start": 2513.1, "Time_End": 2520.1, "Text": " He wants to know, let's say that you can't get single quotes through the web service, your question, right?"}, {"Time_Start": 2520.1, "Time_End": 2521.1, "Text": " question, right?"}, {"Time_Start": 2521.1, "Time_End": 2523.1, "Text": " The web application is filtering out single quotes."}, {"Time_Start": 2523.1, "Time_End": 2526.1, "Text": " You want enough so you can use double quotes and stuff like that."}, {"Time_Start": 2526.1, "Time_End": 2527.1, "Text": " Double quotes will not work."}, {"Time_Start": 2527.1, "Time_End": 2530.1, "Text": " What you want to look for, and I don't have the information in front of me."}, {"Time_Start": 2530.1, "Time_End": 2533.1, "Text": " I'm sorry when I post the information, I'll get it to you."}, {"Time_Start": 2533.1, "Time_End": 2539.1, "Text": " Is, like, if there's a char function, for instance, that's going to be a good, bad one."}, {"Time_Start": 2539.1, "Time_End": 2543.1, "Text": " Let's see if we get a character in the first column."}, {"Time_Start": 2550.1, "Time_End": 2551.1, "Text": " There's an expression."}, {"Time_Start": 2551.1, "Time_End": 2555.1, "Text": " No, I don't have syntax information for this in front of me."}, {"Time_Start": 2555.1, "Time_End": 2557.1, "Text": " I'll find out about that, though."}, {"Time_Start": 2557.1, "Time_End": 2558.1, "Text": " Yes, you're back there?"}, {"Time_Start": 2558.1, "Time_End": 2560.1, "Text": " What if you use the hex code?"}, {"Time_Start": 2560.1, "Time_End": 2562.1, "Text": " The hex code in here and the char function?"}, {"Time_Start": 2562.1, "Time_End": 2566.1, "Text": " No, just like, you know, for Sanchez."}, {"Time_Start": 2566.1, "Time_End": 2572.1, "Text": " Your web server, when it gets to the web server, the web server will understand that,"}, {"Time_Start": 2572.1, "Time_End": 2576.1, "Text": " but what it will do is it will convert that to the real character"}, {"Time_Start": 2576.1, "Time_End": 2578.1, "Text": " before the ASP script gets a hold of it."}, {"Time_Start": 2578.1, "Time_End": 2579.1, "Text": " So the ASP script will see."}, {"Time_Start": 2579.1, "Time_End": 2587.1, "Text": " script will see not the hex to escape code it'll see the real character and if it's told to block single quotes even if you have some coded it'll still block it."}, {"Time_Start": 2587.1, "Time_End": 2589.1, "Text": " Yes, sir?"}, {"Time_Start": 2589.1, "Time_End": 2592.1, "Text": " Do you know why single support the user?"}, {"Time_Start": 2592.1, "Time_End": 2597.1, "Text": " Does not until 4.0 this man right here says."}, {"Time_Start": 2597.1, "Time_End": 2605.1, "Text": " The other question about is there, do you have XP command shell, do you have arbitrary command execution?"}, {"Time_Start": 2605.1, "Time_End": 2608.1, "Text": " The answer to that is I haven't found a way yet."}, {"Time_Start": 2608.1, "Time_End": 2612.1, "Text": " found a way yet, I'm still working on it. The problem with this is I'm not an Oracle DBA."}, {"Time_Start": 2612.1, "Time_End": 2617.1, "Text": " I'm a web application security guy. So there are all kinds of stuff in Oracle that I've been looking through."}, {"Time_Start": 2617.1, "Time_End": 2622.1, "Text": " One thing I will tell you, and that anyone who's done this with SQL server loves, is you can use"}, {"Time_Start": 2622.1, "Time_End": 2626.1, "Text": " semicolon to do multiple command statements."}, {"Time_Start": 2626.1, "Time_End": 2630.1, "Text": " The Oracle, ODBC driver will not let you pass a semicolon."}, {"Time_Start": 2630.1, "Time_End": 2635.1, "Text": " The semicolons will never see the web server and you'll get an error message back."}, {"Time_Start": 2635.1, "Time_End": 2638.1, "Text": " As far as arbitrage, is there a story?"}, {"Time_Start": 2638.1, "Time_End": 2642.1, "Text": " procedure to execute OS level commands. I don't think there is."}, {"Time_Start": 2642.1, "Time_End": 2643.1, "Text": " So over here."}, {"Time_Start": 2643.1, "Time_End": 2644.1, "Text": " Yeah."}, {"Time_Start": 2644.1, "Time_End": 2646.1, "Text": " I'm Patrick."}, {"Time_Start": 2646.1, "Time_End": 2649.1, "Text": " You're on the side on the database of secure"}, {"Time_Start": 2649.1, "Time_End": 2650.1, "Text": " about math."}, {"Time_Start": 2650.1, "Time_End": 2652.1, "Text": " It's a really funny."}, {"Time_Start": 2652.1, "Time_End": 2656.1, "Text": " It's a good for a or a Oracle."}, {"Time_Start": 2656.1, "Time_End": 2661.1, "Text": " And it also uploads the team down"}, {"Time_Start": 2661.1, "Time_End": 2664.1, "Text": " and executes it."}, {"Time_Start": 2664.1, "Time_End": 2666.1, "Text": " And it's also"}, {"Time_Start": 2666.1, "Time_End": 2675.1, "Text": " Okay, what he's saying is that, what is the URL there again?"}, {"Time_Start": 2675.1, "Time_End": 2676.1, "Text": " What?"}, {"Time_Start": 2676.1, "Time_End": 2677.1, "Text": " Your friend's site?"}, {"Time_Start": 2677.1, "Time_End": 2679.1, "Text": " Where can you get the tool?"}, {"Time_Start": 2679.1, "Time_End": 2680.1, "Text": " Hmm?"}, {"Time_Start": 2680.1, "Time_End": 2683.1, "Text": " I don't have net access on this right now."}, {"Time_Start": 2683.1, "Time_End": 2685.1, "Text": " Can you just tell us again?"}, {"Time_Start": 2685.1, "Time_End": 2686.1, "Text": " Yeah."}, {"Time_Start": 2686.1, "Time_End": 2687.1, "Text": " Yeah."}, {"Time_Start": 2687.1, "Time_End": 2688.1, "Text": " Okay."}, {"Time_Start": 2688.1, "Time_End": 2692.1, "Text": " While he's running up here,"}, {"Time_Start": 2692.1, "Time_End": 2695.1, "Text": " I'm going to tell you that my presentation is covering clean things you can do with SQL"}, {"Time_Start": 2695.1, "Time_End": 2697.1, "Text": " you can do with SQL injections."}, {"Time_Start": 2697.1, "Time_End": 2699.1, "Text": " Just type it up there, people see it."}, {"Time_Start": 2699.1, "Time_End": 2701.1, "Text": " Is that, of course there are,"}, {"Time_Start": 2701.1, "Time_End": 2704.1, "Text": " you've got buffer overflow exports for Oracle,"}, {"Time_Start": 2704.1, "Time_End": 2706.1, "Text": " you've got privilege escalation techniques,"}, {"Time_Start": 2706.1, "Time_End": 2708.1, "Text": " my presentation isn't on that stuff,"}, {"Time_Start": 2708.1, "Time_End": 2710.1, "Text": " that's database layer security, I'm doing web application stuff,"}, {"Time_Start": 2710.1, "Time_End": 2712.1, "Text": " just showing you what you can do"}, {"Time_Start": 2712.1, "Time_End": 2715.1, "Text": " without getting to Oracle-specific exploits."}, {"Time_Start": 2715.1, "Time_End": 2717.1, "Text": " If you guys, you know, follow bug track,"}, {"Time_Start": 2717.1, "Time_End": 2720.1, "Text": " there's a ton of ways that once you are really putting information in there,"}, {"Time_Start": 2720.1, "Time_End": 2722.1, "Text": " you can, you can use buffer overflows,"}, {"Time_Start": 2722.1, "Time_End": 2724.1, "Text": " you can probably get OS commands executed."}, {"Time_Start": 2724.1, "Time_End": 2725.1, "Text": " But,"}, {"Time_Start": 2725.1, "Time_End": 2730.1, "Text": " For instance, in SQL server, an MSSQL server, they have a procedure called XP Command Shell"}, {"Time_Start": 2730.1, "Time_End": 2735.1, "Text": " that very cleanly and with the server's permission will execute your commands for you."}, {"Time_Start": 2735.1, "Time_End": 2738.1, "Text": " Oracle doesn't have that nice, easy functionality to get that done."}, {"Time_Start": 2738.1, "Time_End": 2739.1, "Text": " Yes, sir."}, {"Time_Start": 2739.1, "Time_End": 2752.1, "Text": " If you are using stored procedures, I don't have a demo web application for that,"}, {"Time_Start": 2752.1, "Time_End": 2753.1, "Text": " yes."}, {"Time_Start": 2753.1, "Time_End": 2754.1, "Text": " You can, you know, you can adjust."}, {"Time_Start": 2754.1, "Time_End": 2761.1, "Text": " know you can inject into store procedures let's say right just a second"}, {"Time_Start": 2761.1, "Time_End": 2770.1, "Text": " sorry about that let's say that they've got you know stored procedure my stored"}, {"Time_Start": 2770.1, "Time_End": 2775.1, "Text": " procedure and they've got what you need to do you need to match when you're breaking"}, {"Time_Start": 2775.1, "Time_End": 2781.1, "Text": " through stored procedures is you need to match the number of arguments so and"}, {"Time_Start": 2781.1, "Time_End": 2784.08, "Text": " you have to match it at the end so let's say they got a stored procedure and they're"}, {"Time_Start": 2784.1, "Time_End": 2789.1, "Text": " correct syntax, the store procedure, and I'm just typing it up here, this isn't,"}, {"Time_Start": 2789.1, "Time_End": 2793.1, "Text": " you know, this is obviously, this is ASP, this isn't how you would do it."}, {"Time_Start": 2793.1, "Time_End": 2795.1, "Text": " This isn't how it appear on the web server."}, {"Time_Start": 2795.1, "Time_End": 2797.1, "Text": " Great, I'm losing people."}, {"Time_Start": 2797.1, "Time_End": 2799.1, "Text": " Bye guys."}, {"Time_Start": 2799.1, "Time_End": 2803.1, "Text": " Let's say that your correct syntax look like this, right?"}, {"Time_Start": 2803.1, "Time_End": 2805.1, "Text": " Three arguments."}, {"Time_Start": 2805.1, "Time_End": 2813.1, "Text": " And your injection, and let's say you've got to control"}, {"Time_Start": 2813.1, "Time_End": 2816.1, "Text": " control the value of the first argument, right?"}, {"Time_Start": 2816.1, "Time_End": 2823.1, "Text": " If your injection string looked like that, union select, and then blah, blah, blah,"}, {"Time_Start": 2823.1, "Time_End": 2827.1, "Text": " and that was in there, yeah."}, {"Time_Start": 2827.1, "Time_End": 2832.1, "Text": " This stuff here is no good because this is what it would look like."}, {"Time_Start": 2832.1, "Time_End": 2836.1, "Text": " There."}, {"Time_Start": 2836.1, "Time_End": 2842.1, "Text": " That's obviously not valid syntax."}, {"Time_Start": 2842.1, "Time_End": 2843.1, "Text": " So what you would have to do."}, {"Time_Start": 2843.1, "Time_End": 2845.1, "Text": " do is your injection string."}, {"Time_Start": 2845.1, "Time_End": 2848.1, "Text": " You would have to, and it'll do the same way it will give you an error message as it'll tell you"}, {"Time_Start": 2848.1, "Time_End": 2851.1, "Text": " when you've got the wrong number of columns."}, {"Time_Start": 2851.1, "Time_End": 2857.1, "Text": " You'd have to go A, close the parentheses, send it, see if you get an error message."}, {"Time_Start": 2857.1, "Time_End": 2859.1, "Text": " If not, you keep adding them."}, {"Time_Start": 2859.1, "Time_End": 2867.1, "Text": " And eventually, you'd have to go like that, and you'd put that in there, and the database server"}, {"Time_Start": 2867.1, "Time_End": 2870.1, "Text": " would end up seeing something that would look like that."}, {"Time_Start": 2870.1, "Time_End": 2873.08, "Text": " And of course, at the end you would have to clean it up and have something with three arguments"}, {"Time_Start": 2873.1, "Time_End": 2874.1, "Text": " but you can do it."}, {"Time_Start": 2874.1, "Time_End": 2875.1, "Text": " Any other questions?"}, {"Time_Start": 2875.1, "Time_End": 2876.1, "Text": " Yes, you?"}, {"Time_Start": 2876.1, "Time_End": 2878.1, "Text": " So you've been out, you've looked for a lot of websites,"}, {"Time_Start": 2878.1, "Time_End": 2881.1, "Text": " go to assessments and so forth, see a lot of select statements."}, {"Time_Start": 2881.1, "Time_End": 2885.1, "Text": " Do you see a lot of insert statements that would also open itself up in the same?"}, {"Time_Start": 2885.1, "Time_End": 2887.1, "Text": " Yeah, insert is vulnerable in the same kind of way."}, {"Time_Start": 2887.1, "Time_End": 2892.1, "Text": " The insert syntax was different and we have time constraints here."}, {"Time_Start": 2892.1, "Time_End": 2894.1, "Text": " How much time do I've left here?"}, {"Time_Start": 2894.1, "Time_End": 2900.1, "Text": " All right, yeah, like I said, if I tried to do insert two, it requires its own unique set of things to look for."}, {"Time_Start": 2900.1, "Time_End": 2902.1, "Text": " I just didn't have the time to present it here."}, {"Time_Start": 2902.1, "Time_End": 2903.1, "Text": " You can do it with insert."}, {"Time_Start": 2903.1, "Time_End": 2908.1, "Text": " insert, occasionally you run across the sites that are running really weird-looking SQL queries."}, {"Time_Start": 2908.1, "Time_End": 2912.1, "Text": " If you're changing your password, it may have like an alter command or something like that."}, {"Time_Start": 2912.1, "Time_End": 2920.1, "Text": " Nearly anything is injectable as long as your web application is not protecting against single quotes and stuff like that."}, {"Time_Start": 2920.1, "Time_End": 2922.1, "Text": " Any other questions?"}, {"Time_Start": 2922.1, "Time_End": 2925.1, "Text": " Can you do as tighten it up?"}, {"Time_Start": 2925.1, "Time_End": 2929.1, "Text": " Yeah, I guess some people here want to know that."}, {"Time_Start": 2929.1, "Time_End": 2932.1, "Text": " Here is a real simple"}, {"Time_Start": 2932.1, "Time_End": 2939.1, "Text": " simple, I'm about to release check www.spidynamics.com, spy is SPI."}, {"Time_Start": 2939.1, "Time_End": 2944.1, "Text": " It's about to be, I have a whole paper written on secure web application and database server interaction,"}, {"Time_Start": 2944.1, "Time_End": 2952.1, "Text": " which covers what you need to do to tighten up in terms of web application and how to lock down your database server with corrects rules and permissions"}, {"Time_Start": 2952.1, "Time_End": 2958.1, "Text": " in case if someone can inject, the amount of damage they can do is greatly minimized."}, {"Time_Start": 2958.1, "Time_End": 2961.1, "Text": " So let's look at, let's take Fonder. ASP."}, {"Time_Start": 2961.1, "Time_End": 2968.1, "Text": " and let's say email request that's where it pulls it off"}, {"Time_Start": 2968.1, "Time_End": 2972.1, "Text": " that's where it pulls your user argument from your UI out."}, {"Time_Start": 2972.1, "Time_End": 2975.1, "Text": " Let's say we did two things here."}, {"Time_Start": 2975.1, "Time_End": 2982.1, "Text": " Replace, I'm not an ASP programmer and I don't intend to be,"}, {"Time_Start": 2982.1, "Time_End": 2985.1, "Text": " but this is what I had in front of me when I had to build this."}, {"Time_Start": 2985.1, "Time_End": 2990.1, "Text": " Replace single quote with, let's say this is what PHP does."}, {"Time_Start": 2990.1, "Time_End": 2994.1, "Text": " PHP does, backslash single quote, or you can do it with null."}, {"Time_Start": 2994.1, "Time_End": 2998.1, "Text": " It'll kick all of the single quotes out of there."}, {"Time_Start": 2998.1, "Time_End": 3000.1, "Text": " What else you might want to do?"}, {"Time_Start": 3004.1, "Time_End": 3006.1, "Text": " Replace commas."}, {"Time_Start": 3006.1, "Time_End": 3010.1, "Text": " What does an email address need commas in it for?"}, {"Time_Start": 3010.1, "Time_End": 3014.1, "Text": " And place it with a bad character, or for instance, nothing."}, {"Time_Start": 3014.1, "Time_End": 3016.1, "Text": " Yeah."}, {"Time_Start": 3016.1, "Time_End": 3017.1, "Text": " Yeah."}, {"Time_Start": 3017.1, "Time_End": 3022.1, "Text": " probably only that the best way to do it is to rejects everything else out,"}, {"Time_Start": 3022.1, "Time_End": 3024.1, "Text": " but I don't even know how to run REGX on ASP."}, {"Time_Start": 3024.1, "Time_End": 3026.1, "Text": " It probably doesn't support it."}, {"Time_Start": 3026.1, "Time_End": 3027.1, "Text": " It does?"}, {"Time_Start": 3027.1, "Time_End": 3028.1, "Text": " Thank you, Phil."}, {"Time_Start": 3032.1, "Time_End": 3035.1, "Text": " Like I said, I'll have all this in a paper proper."}, {"Time_Start": 3035.1, "Time_End": 3040.1, "Text": " It's default and eye filtering is always the best way to do things."}, {"Time_Start": 3040.1, "Time_End": 3044.1, "Text": " This is basic stuff you can do real quick."}, {"Time_Start": 3044.1, "Time_End": 3046.1, "Text": " Other stuff you want to do is simply"}, {"Time_Start": 3046.1, "Time_End": 3048.1, "Text": " is simply limit the length."}, {"Time_Start": 3048.1, "Time_End": 3051.1, "Text": " You would do that really easy."}, {"Time_Start": 3051.1, "Time_End": 3053.1, "Text": " Email equals left."}, {"Time_Start": 3053.1, "Time_End": 3058.1, "Text": " No, not quote email, email."}, {"Time_Start": 3058.1, "Time_End": 3060.1, "Text": " Email, and I think that's the correct syntax"}, {"Time_Start": 3060.1, "Time_End": 3062.1, "Text": " on that ASP programmer."}, {"Time_Start": 3062.1, "Time_End": 3064.1, "Text": " You would limit it to 10 characters."}, {"Time_Start": 3064.1, "Time_End": 3066.1, "Text": " You're not going to be able to do a whole lot"}, {"Time_Start": 3066.1, "Time_End": 3068.1, "Text": " in SQL with only 10 characters"}, {"Time_Start": 3068.1, "Time_End": 3071.1, "Text": " to clean everything up and I get what you want back."}, {"Time_Start": 3071.1, "Time_End": 3074.1, "Text": " So those are your quick steps."}, {"Time_Start": 3074.1, "Time_End": 3076.1, "Text": " Default and eye filtering like this guy"}, {"Time_Start": 3076.1, "Time_End": 3077.1, "Text": " said he was completely right."}, {"Time_Start": 3077.1, "Time_End": 3078.1, "Text": " I wasn't thinking up here."}, {"Time_Start": 3078.1, "Time_End": 3080.1, "Text": " And limiting length."}, {"Time_Start": 3080.1, "Time_End": 3082.1, "Text": " And also data type."}, {"Time_Start": 3082.1, "Time_End": 3084.1, "Text": " If your argument, in this case it's a"}, {"Time_Start": 3084.1, "Time_End": 3086.1, "Text": " string, but if your argument is a"}, {"Time_Start": 3086.1, "Time_End": 3088.1, "Text": " numeric type and someone is trying to pass"}, {"Time_Start": 3088.1, "Time_End": 3090.1, "Text": " letters into it, goes with the deny filtering,"}, {"Time_Start": 3090.1, "Time_End": 3092.1, "Text": " don't let them do that."}, {"Time_Start": 3092.1, "Time_End": 3094.1, "Text": " Other things you want to do is on the database server."}, {"Time_Start": 3094.1, "Time_End": 3097.1, "Text": " It's a really bad idea to let the web application"}, {"Time_Start": 3097.1, "Time_End": 3100.1, "Text": " access your database server with, you know,"}, {"Time_Start": 3100.1, "Time_End": 3102.1, "Text": " DBA privileges and stuff."}, {"Time_Start": 3102.1, "Time_End": 3104.1, "Text": " What you want to do is you want to take"}, {"Time_Start": 3104.1, "Time_End": 3106.1, "Text": " what all you take, all the function of your web application"}, {"Time_Start": 3106.1, "Time_End": 3108.1, "Text": " location, break it down into roles,"}, {"Time_Start": 3108.1, "Time_End": 3110.1, "Text": " logically break that down into users,"}, {"Time_Start": 3110.1, "Time_End": 3113.1, "Text": " and default deny and only grant those users"}, {"Time_Start": 3113.1, "Time_End": 3116.1, "Text": " the right to execute certain store procedures."}, {"Time_Start": 3116.1, "Time_End": 3117.1, "Text": " It's another thing."}, {"Time_Start": 3117.1, "Time_End": 3119.1, "Text": " Try to stay away from building SQL statements."}, {"Time_Start": 3119.1, "Time_End": 3120.1, "Text": " It's not a great idea."}, {"Time_Start": 3120.1, "Time_End": 3123.1, "Text": " You're much better off using prepared statements and stored procedures."}, {"Time_Start": 3123.1, "Time_End": 3126.1, "Text": " That gets into the database programming,"}, {"Time_Start": 3126.1, "Time_End": 3128.1, "Text": " which this isn't a presentation on."}, {"Time_Start": 3128.1, "Time_End": 3130.1, "Text": " Like I said, there'll be a separate paper on this."}, {"Time_Start": 3130.1, "Time_End": 3132.1, "Text": " This is really a demonstration of attack techniques."}, {"Time_Start": 3132.1, "Time_End": 3133.1, "Text": " Yes, sir?"}, {"Time_Start": 3133.1, "Time_End": 3135.1, "Text": " We're pretty usually for denial of services."}, {"Time_Start": 3135.1, "Time_End": 3145.1, "Text": " There is all kinds of stuff, particularly if you're in DBA, you can go to those system tables like all tables or all columns."}, {"Time_Start": 3145.1, "Time_End": 3151.1, "Text": " You can start messing with stuff, and their database will probably stop working."}, {"Time_Start": 3151.1, "Time_End": 3154.1, "Text": " Have any other questions?"}, {"Time_Start": 3154.1, "Time_End": 3157.1, "Text": " Okay, I think I am done up here then."}, {"Time_Start": 3157.1, "Time_End": 3161.1, "Text": " I apologize again for having this thrown together so quickly."}, {"Time_Start": 3165.1, "Time_End": 3169.04, "Text": " Thank you very much."}]}