{"segments": [{"Time_Start": 0.0, "Time_End": 9.0, "Text": " Just a couple minutes early just to get some of the administrative out of the way."}, {"Time_Start": 9.0, "Time_End": 17.0, "Text": " First of all, this session is usefully labeled no IP, which is some kind of shorthand for"}, {"Time_Start": 17.0, "Time_End": 20.0, "Text": " stealthy, sniffing, logging, and intrusion detection."}, {"Time_Start": 20.0, "Time_End": 22.0, "Text": " Useful and fun things you can do without an IP address."}, {"Time_Start": 22.0, "Time_End": 27.0, "Text": " I'm not here to advocate the doing away with the IP protocol."}, {"Time_Start": 27.0, "Time_End": 29.0, "Text": " I'm just here to talk about how you can live without an IP address."}, {"Time_Start": 29.0, "Time_End": 32.4, "Text": " an IP address on one or more of your security systems."}, {"Time_Start": 32.4, "Time_End": 38.0, "Text": " Following this presentation in this exact same room will be Huovan Tzir"}, {"Time_Start": 38.0, "Time_End": 43.0, "Text": " with his presentation on Lids, the Linux Intrusion Detection System, I think is that right?"}, {"Time_Start": 43.0, "Time_End": 44.0, "Text": " And, huh?"}, {"Time_Start": 44.0, "Time_End": 45.0, "Text": " Yes."}, {"Time_Start": 45.0, "Time_End": 46.0, "Text": " I'll move it down."}, {"Time_Start": 46.0, "Time_End": 47.0, "Text": " I'm too loud?"}, {"Time_Start": 47.0, "Time_End": 48.0, "Text": " No."}, {"Time_Start": 48.0, "Time_End": 50.0, "Text": " Oh, muffled."}, {"Time_Start": 50.0, "Time_End": 57.0, "Text": " My speech is slurred and I haven't even earned it."}, {"Time_Start": 57.0, "Time_End": 58.0, "Text": " No, but I drink it."}, {"Time_Start": 58.0, "Time_End": 63.0, "Text": " drink it. Is that better? Is that less muffly? Okay."}, {"Time_Start": 67.0, "Time_End": 77.0, "Text": " And after that, at the 1,300 hour, 1 o'clock p.m., Thomas Rood is not going to be presenting."}, {"Time_Start": 77.0, "Time_End": 83.0, "Text": " Instead, we will have T. Dragon, who will be speaking about making non-portable systems portable."}, {"Time_Start": 83.0, "Time_End": 87.98, "Text": " So, any systems portable, if you've got the physical strength."}, {"Time_Start": 88.0, "Time_End": 89.0, "Text": " I guess."}, {"Time_Start": 89.0, "Time_End": 90.0, "Text": " Okay."}, {"Time_Start": 90.0, "Time_End": 91.0, "Text": " And what else?"}, {"Time_Start": 91.0, "Time_End": 95.0, "Text": " Oh, this year's conference is being recorded on video and audio CD-ROM."}, {"Time_Start": 95.0, "Time_End": 99.0, "Text": " The recordings may be purchased, or the recording sales desk located in a parthenum foyer."}, {"Time_Start": 99.0, "Time_End": 102.0, "Text": " Thank you, DefCon."}, {"Time_Start": 102.0, "Time_End": 103.0, "Text": " Yeah."}, {"Time_Start": 103.0, "Time_End": 106.0, "Text": " All right."}, {"Time_Start": 106.0, "Time_End": 107.0, "Text": " And, oh, and what else?"}, {"Time_Start": 107.0, "Time_End": 115.0, "Text": " I got some stuff I'm supposed to give away, and I think I'll start off with a trivia question,"}, {"Time_Start": 115.0, "Time_End": 117.0, "Text": " and that is"}, {"Time_Start": 117.0, "Time_End": 124.0, "Text": " At what layer of the OSI, seven-layer model, do IP addresses reside?"}, {"Time_Start": 124.0, "Time_End": 127.0, "Text": " You, who are softwareists?"}, {"Time_Start": 127.0, "Time_End": 128.0, "Text": " Yeah."}, {"Time_Start": 128.0, "Time_End": 129.0, "Text": " Layer three."}, {"Time_Start": 129.0, "Time_End": 130.0, "Text": " That is correct."}, {"Time_Start": 130.0, "Time_End": 131.0, "Text": " We have a winner."}, {"Time_Start": 131.0, "Time_End": 134.0, "Text": " It wasn't in the phone of the question, but I don't give a rip."}, {"Time_Start": 134.0, "Time_End": 135.0, "Text": " Okay."}, {"Time_Start": 135.0, "Time_End": 137.0, "Text": " You have your choice."}, {"Time_Start": 137.0, "Time_End": 142.0, "Text": " You can have a glamorous and useful spark IPX,"}, {"Time_Start": 142.0, "Time_End": 146.0, "Text": " or you can have a xiplex mongo switch."}, {"Time_Start": 146.0, "Time_End": 147.0, "Text": " I don't know what that."}, {"Time_Start": 147.0, "Time_End": 151.0, "Text": " speed it is, but it does appear to be Ethernet."}, {"Time_Start": 151.0, "Time_End": 155.0, "Text": " Damn, I wanted Arknet."}, {"Time_Start": 155.0, "Time_End": 158.0, "Text": " You can run Barbao over Arknet. It's been done."}, {"Time_Start": 158.0, "Time_End": 161.0, "Text": " I'll tell you what, you come here and grab a piece of gear,"}, {"Time_Start": 161.0, "Time_End": 165.0, "Text": " and as long as it doesn't affect the audio presentation, I'll be cool with it."}, {"Time_Start": 165.0, "Time_End": 167.0, "Text": " So..."}, {"Time_Start": 167.0, "Time_End": 168.0, "Text": " Biggest laptop."}, {"Time_Start": 168.0, "Time_End": 173.0, "Text": " Yeah, I'd probably be happier than IPX."}, {"Time_Start": 173.0, "Time_End": 176.0, "Text": " Yeah, this is a bit all syrup."}, {"Time_Start": 176.0, "Time_End": 177.0, "Text": " Oh, sir."}, {"Time_Start": 177.0, "Time_End": 182.0, "Text": " Okay, for the second one, let's see, I'll do another giveaway,"}, {"Time_Start": 182.0, "Time_End": 184.0, "Text": " and then if people stick on at the end,"}, {"Time_Start": 184.0, "Time_End": 185.0, "Text": " that I'll do another giveaway."}, {"Time_Start": 185.0, "Time_End": 188.0, "Text": " There's an incentive to not bail on me."}, {"Time_Start": 188.0, "Time_End": 190.0, "Text": " The second trivia question is,"}, {"Time_Start": 190.0, "Time_End": 197.0, "Text": " oh, shoot, you have to know stuff to ask questions."}, {"Time_Start": 201.0, "Time_End": 202.0, "Text": " I know."}, {"Time_Start": 202.0, "Time_End": 206.0, "Text": " Those of you who might have been here at Hackage Upry last night."}, {"Time_Start": 206.0, "Time_End": 211.0, "Text": " last night. What is the number of the request for comments dealing with the TCP protocol?"}, {"Time_Start": 211.0, "Time_End": 214.0, "Text": " Someone way in the back there with the beer."}, {"Time_Start": 214.0, "Time_End": 216.0, "Text": " Yes, yourself."}, {"Time_Start": 220.0, "Time_End": 222.0, "Text": " I'm looking for a large positive integer."}, {"Time_Start": 222.0, "Time_End": 226.0, "Text": " Let's see. You in the yellow shirt."}, {"Time_Start": 226.0, "Time_End": 227.0, "Text": " 7994?"}, {"Time_Start": 227.0, "Time_End": 228.0, "Text": " No."}, {"Time_Start": 228.0, "Time_End": 229.0, "Text": " You."}, {"Time_Start": 229.0, "Time_End": 231.0, "Text": " 793."}, {"Time_Start": 231.0, "Time_End": 232.0, "Text": " Thank you."}, {"Time_Start": 232.0, "Time_End": 235.0, "Text": " The man knows his RFCs, or at least he knows his drinking games."}, {"Time_Start": 235.0, "Time_End": 238.0, "Text": " drinking games. His punishment is a Spark Station 10."}, {"Time_Start": 238.0, "Time_End": 242.0, "Text": " His punishment is a Spark Station 10."}, {"Time_Start": 242.0, "Time_End": 258.0, "Text": " It appears to have a processor. Congratulations, sir. It'll take two, you know. You can get"}, {"Time_Start": 258.0, "Time_End": 264.98, "Text": " them on eBay like for 300 bucks. Okay. Oh yeah, I'm supposed to give a"}, {"Time_Start": 265.0, "Time_End": 266.0, "Text": " beach."}, {"Time_Start": 266.0, "Time_End": 267.0, "Text": " Okay."}, {"Time_Start": 267.0, "Time_End": 271.0, "Text": " So, stealth receiving logging and intrusion detection."}, {"Time_Start": 271.0, "Time_End": 273.0, "Text": " Stuff you can do without an IP address."}, {"Time_Start": 273.0, "Time_End": 276.0, "Text": " The program today is as follows."}, {"Time_Start": 276.0, "Time_End": 279.0, "Text": " I'm going to introduce why you would want to do this."}, {"Time_Start": 279.0, "Time_End": 281.0, "Text": " I'm going to talk about how to do it."}, {"Time_Start": 281.0, "Time_End": 285.0, "Text": " I'm going to talk about network architectures in which it might be useful"}, {"Time_Start": 285.0, "Time_End": 288.0, "Text": " to run one or more systems without IP addresses."}, {"Time_Start": 288.0, "Time_End": 291.0, "Text": " I'm going to talk about some specific configuration tips,"}, {"Time_Start": 291.0, "Time_End": 294.0, "Text": " mainly focusing on stealth logging, because to be perfectly on"}, {"Time_Start": 294.0, "Time_End": 299.0, "Text": " To be perfectly honest, it's trivially easy to set up a stealth sniffer."}, {"Time_Start": 299.0, "Time_End": 302.0, "Text": " There's one command, exactly."}, {"Time_Start": 302.0, "Time_End": 307.0, "Text": " But stealth logging, centralized logging, is a little bit trickier,"}, {"Time_Start": 307.0, "Time_End": 311.0, "Text": " and so that's where a lot of the examples will come from."}, {"Time_Start": 311.0, "Time_End": 314.0, "Text": " And in fact, as I'll mention,"}, {"Time_Start": 314.0, "Time_End": 322.0, "Text": " a lot of network applications can use IP-free interfaces."}, {"Time_Start": 322.0, "Time_End": 329.0, "Text": " you know, TCP dump, snort, pretty much anything that looks at packets below layer three."}, {"Time_Start": 329.0, "Time_End": 331.0, "Text": " So, okay."}, {"Time_Start": 331.0, "Time_End": 333.0, "Text": " Excuse me."}, {"Time_Start": 333.0, "Time_End": 336.0, "Text": " And then I don't really know why I made six and seven separate points."}, {"Time_Start": 336.0, "Time_End": 337.0, "Text": " Oh, I know."}, {"Time_Start": 337.0, "Time_End": 341.0, "Text": " Point six is where I ask for people to show their own stealth war stories"}, {"Time_Start": 341.0, "Time_End": 345.0, "Text": " and ask questions, and part seven is where I shut up all together and leave."}, {"Time_Start": 345.0, "Time_End": 347.0, "Text": " So, okay."}, {"Time_Start": 347.0, "Time_End": 349.0, "Text": " There's not a slide for that last one, though."}, {"Time_Start": 349.0, "Time_End": 350.0, "Text": " Okay."}, {"Time_Start": 350.0, "Time_End": 351.0, "Text": " In direction."}, {"Time_Start": 351.0, "Time_End": 352.0, "Text": " Who I am and where I'm coming from."}, {"Time_Start": 352.0, "Time_End": 356.0, "Text": " I wrote this slide not so much because I'm an ego maniac,"}, {"Time_Start": 356.0, "Time_End": 359.0, "Text": " which isn't to say that I'm not, I guess,"}, {"Time_Start": 359.0, "Time_End": 363.0, "Text": " but rather to give a little bit of context for why I'm here"}, {"Time_Start": 363.0, "Time_End": 367.0, "Text": " and why I'm standing on the stage instead of sitting in there."}, {"Time_Start": 367.0, "Time_End": 371.0, "Text": " And basically, I'm a security consultant, like many of us."}, {"Time_Start": 371.0, "Time_End": 378.0, "Text": " My day job is mainly with firewalls and with secure network infrastructure design."}, {"Time_Start": 378.0, "Time_End": 382.0, "Text": " And the long and sure of it is, lately what I've most"}, {"Time_Start": 382.0, "Time_End": 388.0, "Text": " been doing is working in financial sectors and keeping the bad guys out of bank accounts."}, {"Time_Start": 388.0, "Time_End": 392.0, "Text": " What I also do on the side quite a bit, and it's kind of ludicrous to say on the side,"}, {"Time_Start": 392.0, "Time_End": 395.0, "Text": " since it takes about as much time, is writing."}, {"Time_Start": 395.0, "Time_End": 399.0, "Text": " Anybody here will read Linux Journal?"}, {"Time_Start": 399.0, "Time_End": 402.0, "Text": " And you still came. Wow, that's so cool."}, {"Time_Start": 402.0, "Time_End": 405.0, "Text": " I write the security column for Linux journal. It's called The Paranoid Penguin."}, {"Time_Start": 405.0, "Time_End": 408.0, "Text": " And if you read that column, you know that my whole thing is a writer."}, {"Time_Start": 408.0, "Time_End": 411.0, "Text": " Isn't really so much that I'm an expert do, as I say, but more along the line."}, {"Time_Start": 411.0, "Time_End": 414.0, "Text": " but more along the lines of, or at least that's how I think of it,"}, {"Time_Start": 414.0, "Time_End": 416.0, "Text": " is, hey, I got this working in my basement."}, {"Time_Start": 416.0, "Time_End": 418.0, "Text": " You probably can, too."}, {"Time_Start": 418.0, "Time_End": 421.0, "Text": " So that's very much the spirit of this talk."}, {"Time_Start": 421.0, "Time_End": 424.0, "Text": " This, I'm going to warn you, and feel free to leave"}, {"Time_Start": 424.0, "Time_End": 426.0, "Text": " if this really disgusts and disappoint you."}, {"Time_Start": 426.0, "Time_End": 428.0, "Text": " But the stuff that I'm about to talk about"}, {"Time_Start": 428.0, "Time_End": 431.0, "Text": " isn't the result of decades of experience running systems"}, {"Time_Start": 431.0, "Time_End": 436.0, "Text": " without IP addresses as much as it is about me messing around in the basement"}, {"Time_Start": 436.0, "Time_End": 438.0, "Text": " in figuring out some kind of groovy stuff"}, {"Time_Start": 438.0, "Time_End": 440.0, "Text": " that you might find groovy and useful too."}, {"Time_Start": 440.0, "Time_End": 442.0, "Text": " So that's the disclaimer."}, {"Time_Start": 442.0, "Time_End": 445.0, "Text": " And that's my excuse for anything that I say"}, {"Time_Start": 445.0, "Time_End": 449.0, "Text": " that is some combination of lame, stupid, or inaccurate."}, {"Time_Start": 449.0, "Time_End": 451.0, "Text": " So, okay."}, {"Time_Start": 451.0, "Time_End": 452.0, "Text": " And what else?"}, {"Time_Start": 452.0, "Time_End": 454.0, "Text": " Oh, and the other point that I wanted to make about myself"}, {"Time_Start": 454.0, "Time_End": 456.0, "Text": " is that I'm into digital defense."}, {"Time_Start": 456.0, "Time_End": 459.0, "Text": " I was really delighted that that was the track this talk"}, {"Time_Start": 459.0, "Time_End": 462.0, "Text": " got put into, because that's what my work is all about."}, {"Time_Start": 462.0, "Time_End": 465.0, "Text": " I think that it's a lot of fun defending systems"}, {"Time_Start": 465.0, "Time_End": 467.0, "Text": " and it's really challenging and interesting."}, {"Time_Start": 467.0, "Time_End": 469.0, "Text": " And you get to use pretty, most of the things"}, {"Time_Start": 469.0, "Time_End": 471.0, "Text": " most of the same skills that you would use"}, {"Time_Start": 471.0, "Time_End": 473.0, "Text": " if you were of a more evil bent."}, {"Time_Start": 473.0, "Time_End": 475.0, "Text": " Myself, I really suck at evil,"}, {"Time_Start": 475.0, "Time_End": 478.0, "Text": " so there hasn't been too much of an option."}, {"Time_Start": 478.0, "Time_End": 481.0, "Text": " Please don't use what I'm about to tell you for evil."}, {"Time_Start": 481.0, "Time_End": 482.0, "Text": " Thank you."}, {"Time_Start": 482.0, "Time_End": 484.0, "Text": " If you do, don't mention my name."}, {"Time_Start": 484.0, "Time_End": 485.0, "Text": " Thank you."}, {"Time_Start": 485.0, "Time_End": 486.0, "Text": " Okay."}, {"Time_Start": 486.0, "Time_End": 490.0, "Text": " So, why on Earth would you want to run a system without an IP address?"}, {"Time_Start": 490.0, "Time_End": 494.0, "Text": " Well, in the particular cases of intrusion detection"}, {"Time_Start": 494.0, "Time_End": 499.0, "Text": " system probes, which is to say a box running"}, {"Time_Start": 499.0, "Time_End": 504.0, "Text": " something like snort, to do network intrusion detection,"}, {"Time_Start": 504.0, "Time_End": 508.0, "Text": " or in the case of a centralized log host,"}, {"Time_Start": 508.0, "Time_End": 511.0, "Text": " where you want your web servers and your FTP servers"}, {"Time_Start": 511.0, "Time_End": 513.0, "Text": " to send its logs to."}, {"Time_Start": 513.0, "Time_End": 516.0, "Text": " Since they are on the network,"}, {"Time_Start": 516.0, "Time_End": 519.0, "Text": " they are obviously subject to the same sorts of vulnerabilities"}, {"Time_Start": 519.0, "Time_End": 521.0, "Text": " as any other system on that network."}, {"Time_Start": 521.0, "Time_End": 523.0, "Text": " So this is kind of a paradox."}, {"Time_Start": 523.0, "Time_End": 525.0, "Text": " You've got systems on a network"}, {"Time_Start": 525.0, "Time_End": 527.0, "Text": " that are trying to protect that network,"}, {"Time_Start": 527.0, "Time_End": 528.0, "Text": " but they're vulnerable to exactly the same stuff as everything."}, {"Time_Start": 528.0, "Time_End": 531.0, "Text": " same stuff as everything else on that network."}, {"Time_Start": 531.0, "Time_End": 532.0, "Text": " Okay?"}, {"Time_Start": 532.0, "Time_End": 534.0, "Text": " It's particularly important, obviously,"}, {"Time_Start": 534.0, "Time_End": 537.0, "Text": " with such systems that they not be rooted"}, {"Time_Start": 537.0, "Time_End": 540.0, "Text": " and remain available,"}, {"Time_Start": 540.0, "Time_End": 543.0, "Text": " and that the data stored on them is trustworthy."}, {"Time_Start": 543.0, "Time_End": 544.0, "Text": " Okay?"}, {"Time_Start": 544.0, "Time_End": 547.0, "Text": " The first thing anybody with a root kit does"}, {"Time_Start": 547.0, "Time_End": 549.0, "Text": " after they root a system, if they know anything,"}, {"Time_Start": 549.0, "Time_End": 553.0, "Text": " is commence to erasing and altering logs."}, {"Time_Start": 553.0, "Time_End": 555.0, "Text": " Okay?"}, {"Time_Start": 555.0, "Time_End": 557.0, "Text": " The cool thing about a stealth logger is"}, {"Time_Start": 557.0, "Time_End": 562.0, "Text": " is it has no IP address and so it's very difficult,"}, {"Time_Start": 562.0, "Time_End": 564.0, "Text": " if not impossible, in practical terms,"}, {"Time_Start": 564.0, "Time_End": 566.0, "Text": " to attack remotely."}, {"Time_Start": 566.0, "Time_End": 570.0, "Text": " I mean, I guess if you rooted a box on the same network"}, {"Time_Start": 570.0, "Time_End": 572.0, "Text": " and laid some layer two voodoo on it,"}, {"Time_Start": 572.0, "Time_End": 574.0, "Text": " you could DOS it or something,"}, {"Time_Start": 574.0, "Time_End": 576.0, "Text": " but I don't think it'd be practical"}, {"Time_Start": 576.0, "Time_End": 580.0, "Text": " to get too much further than that."}, {"Time_Start": 580.0, "Time_End": 583.0, "Text": " If you've got your logger just sitting on the wire"}, {"Time_Start": 583.0, "Time_End": 586.0, "Text": " and listening to packets that go through,"}, {"Time_Start": 586.0, "Time_End": 591.0, "Text": " those packets you can be reasonably sure haven't been messed with"}, {"Time_Start": 591.0, "Time_End": 593.0, "Text": " because logging typically uses UDP."}, {"Time_Start": 593.0, "Time_End": 595.0, "Text": " That goes by pretty quickly."}, {"Time_Start": 595.0, "Time_End": 598.0, "Text": " It's not really feasible to hijack a log session."}, {"Time_Start": 598.0, "Time_End": 602.0, "Text": " Now you can construct false packets and put those on the wire."}, {"Time_Start": 602.0, "Time_End": 606.0, "Text": " So you're still vulnerable to that sort of log data tampering, right?"}, {"Time_Start": 606.0, "Time_End": 610.0, "Text": " But, you know, that's one risk with the others"}, {"Time_Start": 610.0, "Time_End": 612.0, "Text": " that you're going to kind of lump into the back of your mind"}, {"Time_Start": 612.0, "Time_End": 615.0, "Text": " and say, eh, hope that doesn't happen."}, {"Time_Start": 615.0, "Time_End": 622.0, "Text": " So that's the value of a stealth log system."}, {"Time_Start": 622.0, "Time_End": 626.0, "Text": " In the case of an IDS probe, same thing."}, {"Time_Start": 626.0, "Time_End": 627.0, "Text": " You don't want it to get attacked."}, {"Time_Start": 627.0, "Time_End": 629.0, "Text": " You don't want it to be compromised."}, {"Time_Start": 629.0, "Time_End": 634.0, "Text": " You want to be able to trust the things that it tells you."}, {"Time_Start": 634.0, "Time_End": 635.0, "Text": " Okay."}, {"Time_Start": 635.0, "Time_End": 636.0, "Text": " How do you do that?"}, {"Time_Start": 636.0, "Time_End": 637.0, "Text": " How do you protect those boxes?"}, {"Time_Start": 637.0, "Time_End": 641.0, "Text": " The answer obviously is by not using an IPDress."}, {"Time_Start": 641.0, "Time_End": 644.0, "Text": " In that way you have eliminated, or at least,"}, {"Time_Start": 644.0, "Time_End": 648.0, "Text": " eliminated or at least heavily mitigated entire classes of attack vectors,"}, {"Time_Start": 648.0, "Time_End": 650.0, "Text": " IP-based attack vectors, right?"}, {"Time_Start": 650.0, "Time_End": 652.0, "Text": " And that, of course, is the main vector"}, {"Time_Start": 652.0, "Time_End": 654.0, "Text": " that you're trying to protect the other systems against."}, {"Time_Start": 654.0, "Time_End": 656.0, "Text": " Okay. Any questions so far?"}, {"Time_Start": 656.0, "Time_End": 659.0, "Text": " Not that any of this is terribly deep, but..."}, {"Time_Start": 659.0, "Time_End": 660.0, "Text": " Okay, cool."}, {"Time_Start": 660.0, "Time_End": 663.0, "Text": " So, what do you do?"}, {"Time_Start": 663.0, "Time_End": 668.0, "Text": " You, in a nutshell, you configure the box that's going to receive stuff."}, {"Time_Start": 668.0, "Time_End": 672.0, "Text": " In other words, you install an Ether interface in it."}, {"Time_Start": 672.0, "Time_End": 673.0, "Text": " Maybe it's an additional interface."}, {"Time_Start": 673.0, "Time_End": 677.0, "Text": " I'll talk about uses of multiple interfaces."}, {"Time_Start": 677.0, "Time_End": 679.0, "Text": " You bring it up."}, {"Time_Start": 679.0, "Time_End": 683.0, "Text": " If you're going to be doing your stealth with stuff"}, {"Time_Start": 683.0, "Time_End": 686.0, "Text": " on a switched environment, it may be necessary"}, {"Time_Start": 686.0, "Time_End": 688.0, "Text": " desirable to hang a little hub off one of those ports"}, {"Time_Start": 688.0, "Time_End": 691.0, "Text": " and then connect it to the hub."}, {"Time_Start": 691.0, "Time_End": 695.0, "Text": " If you're really paranoid, you can use a sniffing cable."}, {"Time_Start": 695.0, "Time_End": 698.0, "Text": " That's a one-way cable, it's receive only."}, {"Time_Start": 698.0, "Time_End": 702.0, "Text": " That makes it physically impossible for your system to transmit packets."}, {"Time_Start": 702.0, "Time_End": 707.0, "Text": " packets. Okay? This is cool both for purposes of stealthfulness."}, {"Time_Start": 707.0, "Time_End": 711.0, "Text": " It won't respond, for example, to port scans that way."}, {"Time_Start": 711.0, "Time_End": 714.0, "Text": " I mean, it wouldn't anyhow if they didn't have an IP address,"}, {"Time_Start": 714.0, "Time_End": 717.0, "Text": " but layer two type of scans that won't respond to,"}, {"Time_Start": 717.0, "Time_End": 719.0, "Text": " our broadcast, that sort of thing."}, {"Time_Start": 719.0, "Time_End": 723.0, "Text": " And the other value of the sniffing cable is that"}, {"Time_Start": 723.0, "Time_End": 727.0, "Text": " if somebody were to do something weird to this machine somehow,"}, {"Time_Start": 727.0, "Time_End": 731.0, "Text": " they wouldn't be able to do weirdness out through that interface at least."}, {"Time_Start": 731.0, "Time_End": 732.0, "Text": " Okay."}, {"Time_Start": 732.0, "Time_End": 740.0, "Text": " Another thing you might need to do on systems that send to a stealth logger is map a bogus static arpentry"}, {"Time_Start": 740.0, "Time_End": 745.0, "Text": " to the bogus IP address that you have everyone send their log data to."}, {"Time_Start": 745.0, "Time_End": 747.0, "Text": " I'll talk about that in greater depth for a minute."}, {"Time_Start": 747.0, "Time_End": 749.0, "Text": " And that's pretty much it."}, {"Time_Start": 749.0, "Time_End": 753.0, "Text": " And if you really understand that stuff, that might be all you need to know and you can go."}, {"Time_Start": 753.0, "Time_End": 756.0, "Text": " But I've got pictures, so stick on for the pictures."}, {"Time_Start": 756.0, "Time_End": 757.0, "Text": " Here's picture number one."}, {"Time_Start": 757.0, "Time_End": 759.0, "Text": " Let's talk about architectures."}, {"Time_Start": 759.0, "Time_End": 761.0, "Text": " Architectural considerations for using."}, {"Time_Start": 761.0, "Time_End": 765.0, "Text": " for using a stealth sniffer."}, {"Time_Start": 765.0, "Time_End": 768.0, "Text": " Proving the DMZ."}, {"Time_Start": 768.0, "Time_End": 771.0, "Text": " This is, of course, where you've got the crown jewels."}, {"Time_Start": 771.0, "Time_End": 775.0, "Text": " A DMZ network, if you're cool, is where you isolate"}, {"Time_Start": 775.0, "Time_End": 778.0, "Text": " all of your publicly accessible systems from your internal network."}, {"Time_Start": 778.0, "Time_End": 781.0, "Text": " And I could talk on and on about network architectures"}, {"Time_Start": 781.0, "Time_End": 783.0, "Text": " because, like I said, that's my day job."}, {"Time_Start": 783.0, "Time_End": 787.0, "Text": " But if you're unfamiliar with it,"}, {"Time_Start": 787.0, "Time_End": 790.0, "Text": " in a DMZ network, what you typically do is you break off a dedicated"}, {"Time_Start": 790.0, "Time_End": 793.0, "Text": " break off a dedicated interface on your firewall,"}, {"Time_Start": 793.0, "Time_End": 797.0, "Text": " and that is what you will connect your DMZ network to."}, {"Time_Start": 797.0, "Time_End": 800.0, "Text": " What this allows you to do"}, {"Time_Start": 800.0, "Time_End": 803.0, "Text": " is it allows you to define different rules on the firewall"}, {"Time_Start": 803.0, "Time_End": 806.0, "Text": " for this stuff than you would on the inside."}, {"Time_Start": 806.0, "Time_End": 810.0, "Text": " In other words, it lets you treat traffic destined for"}, {"Time_Start": 810.0, "Time_End": 814.0, "Text": " and originating from, and that's really the important one,"}, {"Time_Start": 814.0, "Time_End": 817.0, "Text": " that network from your internal hosts."}, {"Time_Start": 817.0, "Time_End": 819.0, "Text": " The beauty of that, of course, is that should one of these bodies"}, {"Time_Start": 819.0, "Time_End": 823.0, "Text": " one of these boxes in the DMZ get rooted,"}, {"Time_Start": 823.0, "Time_End": 829.0, "Text": " say somebody exploits a vulnerability on your Apache web server."}, {"Time_Start": 829.0, "Time_End": 831.0, "Text": " Okay, they've rooted that box."}, {"Time_Start": 831.0, "Time_End": 834.0, "Text": " Well, now they still have to hack their way through your firewall"}, {"Time_Start": 834.0, "Time_End": 836.0, "Text": " to get at anything on the inside."}, {"Time_Start": 836.0, "Time_End": 838.0, "Text": " And the chances are, if you've done this right,"}, {"Time_Start": 838.0, "Time_End": 841.0, "Text": " you will be allowing practically nothing"}, {"Time_Start": 841.0, "Time_End": 845.0, "Text": " originating from the DMZ to enter into the internal network."}, {"Time_Start": 845.0, "Time_End": 848.0, "Text": " So anyhow, that's the obvious place to put an IDS probe."}, {"Time_Start": 848.0, "Time_End": 852.0, "Text": " an IDS probe or a packet logger or whatever."}, {"Time_Start": 852.0, "Time_End": 856.0, "Text": " Now in this diagram, I show only one interface on the stealth probe,"}, {"Time_Start": 856.0, "Time_End": 861.0, "Text": " and the assumption is that you would administer this from the console,"}, {"Time_Start": 861.0, "Time_End": 865.0, "Text": " or you could put another interface in the box,"}, {"Time_Start": 865.0, "Time_End": 870.0, "Text": " one with an IP address, and connect that to a dedicated admin land."}, {"Time_Start": 870.0, "Time_End": 875.0, "Text": " I know people who do this, and they'll have a separate physical media,"}, {"Time_Start": 875.0, "Time_End": 878.0, "Text": " you know, network devices, separate IP space,"}, {"Time_Start": 878.0, "Time_End": 882.6, "Text": " that they use for administering boxes that are connected to other networks."}, {"Time_Start": 882.6, "Time_End": 885.9, "Text": " Those, the machines on that network don't do any routing."}, {"Time_Start": 885.9, "Time_End": 888.6, "Text": " They're specifically configured, not to forward packets,"}, {"Time_Start": 888.6, "Time_End": 894.0, "Text": " but they allow the administrators to, you know, secure shell into that box or whatever"}, {"Time_Start": 894.0, "Time_End": 898.0, "Text": " and see what's going on on the non-IP interface."}, {"Time_Start": 898.0, "Time_End": 901.0, "Text": " Is that clear so far, by the way?"}, {"Time_Start": 901.0, "Time_End": 904.0, "Text": " I kind of threw a lot of architecture stuff for you in just a couple minutes."}, {"Time_Start": 904.0, "Time_End": 905.0, "Text": " Okay."}, {"Time_Start": 905.0, "Time_End": 907.0, "Text": " Here's another architecture."}, {"Time_Start": 907.0, "Time_End": 908.0, "Text": " Same thing, but."}, {"Time_Start": 908.0, "Time_End": 910.0, "Text": " including a probe on the internet,"}, {"Time_Start": 910.0, "Time_End": 912.0, "Text": " um,"}, {"Time_Start": 912.0, "Time_End": 918.0, "Text": " take that a step further and you can have probes everywhere."}, {"Time_Start": 918.0, "Time_End": 920.0, "Text": " Now you notice that at this point,"}, {"Time_Start": 920.0, "Time_End": 924.0, "Text": " you're running into, you know, kind of a scalability issue."}, {"Time_Start": 924.0, "Time_End": 926.0, "Text": " You've got probes all over the place."}, {"Time_Start": 926.0, "Time_End": 929.0, "Text": " This is not something you can really get around"}, {"Time_Start": 929.0, "Time_End": 932.0, "Text": " in a large environment, right?"}, {"Time_Start": 932.0, "Time_End": 935.0, "Text": " You need different logical and physical subnets"}, {"Time_Start": 935.0, "Time_End": 937.0, "Text": " are going to need different IDS probes."}, {"Time_Start": 937.0, "Time_End": 938.0, "Text": " And incidentally,"}, {"Time_Start": 938.0, "Time_End": 942.0, "Text": " I should mention that if you've got a switched environment,"}, {"Time_Start": 942.0, "Time_End": 946.0, "Text": " one of the challenges is that"}, {"Time_Start": 946.0, "Time_End": 949.0, "Text": " if you have low-end switches,"}, {"Time_Start": 949.0, "Time_End": 953.0, "Text": " you can't really do sniffing across switch parts very easily."}, {"Time_Start": 953.0, "Time_End": 955.0, "Text": " I mean, there may be, you know,"}, {"Time_Start": 955.0, "Time_End": 958.0, "Text": " there may be a means of tricking it"}, {"Time_Start": 958.0, "Time_End": 960.0, "Text": " and do to broadcasting,"}, {"Time_Start": 960.0, "Time_End": 963.0, "Text": " but that probably isn't even desirable from a performance standpoint."}, {"Time_Start": 963.0, "Time_End": 966.0, "Text": " If you have a high-end switch, however, it may have a mirror port."}, {"Time_Start": 966.0, "Time_End": 967.0, "Text": " And actually, this is something to consider"}, {"Time_Start": 967.0, "Time_End": 969.0, "Text": " is something to consider when you're designing"}, {"Time_Start": 969.0, "Time_End": 972.0, "Text": " lands that you intend to hold to hang IDS probes."}, {"Time_Start": 972.0, "Time_End": 974.0, "Text": " There are a couple of considerations with a mere port."}, {"Time_Start": 974.0, "Time_End": 979.0, "Text": " A mere port is a port that you tell the switch to send all traffic to."}, {"Time_Start": 979.0, "Time_End": 981.0, "Text": " Normally a switch is selective."}, {"Time_Start": 981.0, "Time_End": 987.0, "Text": " It only sends packets to the hosts to which those packets are addressed."}, {"Time_Start": 987.0, "Time_End": 989.0, "Text": " I'm like a hub that just broadcasts everything."}, {"Time_Start": 989.0, "Time_End": 994.0, "Text": " And with a mere port you're saying, okay, for just this one port,"}, {"Time_Start": 994.0, "Time_End": 996.0, "Text": " I kind of like a hub, send everything there."}, {"Time_Start": 996.0, "Time_End": 997.0, "Text": " Now there are a couple of things."}, {"Time_Start": 997.0, "Time_End": 999.0, "Text": " problems with this. The first is that"}, {"Time_Start": 999.0, "Time_End": 1002.0, "Text": " the whole purpose of a mural port is for"}, {"Time_Start": 1002.0, "Time_End": 1004.0, "Text": " land diagnostics."}, {"Time_Start": 1004.0, "Time_End": 1007.0, "Text": " And so you as a security admin"}, {"Time_Start": 1007.0, "Time_End": 1010.0, "Text": " may potentially be competing with your network colleagues"}, {"Time_Start": 1010.0, "Time_End": 1012.0, "Text": " for use of that port."}, {"Time_Start": 1012.0, "Time_End": 1016.0, "Text": " I actually work with one client who has that situation"}, {"Time_Start": 1016.0, "Time_End": 1018.0, "Text": " and it works okay."}, {"Time_Start": 1018.0, "Time_End": 1021.0, "Text": " But once in a while, an IDS program to give in mind"}, {"Time_Start": 1021.0, "Time_End": 1023.0, "Text": " will have to be unplugged"}, {"Time_Start": 1023.0, "Time_End": 1025.0, "Text": " so that they can plug in a sniffer and figure out"}, {"Time_Start": 1025.0, "Time_End": 1026.0, "Text": " you know why their Novell Network doesn't work."}, {"Time_Start": 1026.0, "Time_End": 1028.0, "Text": " novel network doesn't work or whatever."}, {"Time_Start": 1028.0, "Time_End": 1031.0, "Text": " Not something that seems"}, {"Time_Start": 1031.0, "Time_End": 1033.0, "Text": " but something to consider."}, {"Time_Start": 1033.0, "Time_End": 1036.0, "Text": " The other problem with mirror ports is that"}, {"Time_Start": 1036.0, "Time_End": 1039.0, "Text": " the very types of switches that are likely to have"}, {"Time_Start": 1039.0, "Time_End": 1041.0, "Text": " a new port are also likely to have an ungodly"}, {"Time_Start": 1041.0, "Time_End": 1043.0, "Text": " huge backplane."}, {"Time_Start": 1043.0, "Time_End": 1047.0, "Text": " And even if that mirror port is a gigabit ethernet port,"}, {"Time_Start": 1047.0, "Time_End": 1050.0, "Text": " if you've got a 9 gigabit backplane,"}, {"Time_Start": 1050.0, "Time_End": 1053.0, "Text": " you're obviously not going to see quite everything."}, {"Time_Start": 1053.0, "Time_End": 1055.0, "Text": " Now if anybody has had experience of the contrary"}, {"Time_Start": 1055.0, "Time_End": 1056.0, "Text": " or knows of a little bit."}, {"Time_Start": 1056.0, "Time_End": 1058.0, "Text": " around this, by all means speak up."}, {"Time_Start": 1058.0, "Time_End": 1061.0, "Text": " But the guys that I've talked to"}, {"Time_Start": 1061.0, "Time_End": 1065.0, "Text": " that focus solely on IDS, you know, agree that, yeah,"}, {"Time_Start": 1065.0, "Time_End": 1068.0, "Text": " I mean, you do wind up missing some stuff that way."}, {"Time_Start": 1068.0, "Time_End": 1070.0, "Text": " Okay."}, {"Time_Start": 1070.0, "Time_End": 1073.0, "Text": " Now, if you're like me and you've got a little spaghetti network"}, {"Time_Start": 1073.0, "Time_End": 1078.0, "Text": " of your own at home with not too horribly many boxing,"}, {"Time_Start": 1078.0, "Time_End": 1083.0, "Text": " it is possible to have a box with three interfaces."}, {"Time_Start": 1083.0, "Time_End": 1085.0, "Text": " One for the DMZ, one for the internal network,"}, {"Time_Start": 1085.0, "Time_End": 1086.0, "Text": " and one for the Internet,"}, {"Time_Start": 1086.0, "Time_End": 1088.0, "Text": " for the outside world."}, {"Time_Start": 1088.0, "Time_End": 1090.0, "Text": " And there's a couple of different,"}, {"Time_Start": 1090.0, "Time_End": 1093.0, "Text": " the obvious benefit to this architecture is"}, {"Time_Start": 1093.0, "Time_End": 1097.0, "Text": " you only need one computer to dedicate to this purpose, right?"}, {"Time_Start": 1097.0, "Time_End": 1099.0, "Text": " Now, if it's actually going to be doing"}, {"Time_Start": 1099.0, "Time_End": 1102.0, "Text": " network-based IDS on two different networks"}, {"Time_Start": 1102.0, "Time_End": 1107.0, "Text": " that's going to have to be better than a P-180, let's say, right?"}, {"Time_Start": 1107.0, "Time_End": 1111.0, "Text": " But on the other hand, if you've got a relatively low-impact site,"}, {"Time_Start": 1111.0, "Time_End": 1115.0, "Text": " you don't necessarily need a 2 gigahertz monster in there either."}, {"Time_Start": 1115.0, "Time_End": 1121.0, "Text": " This is, however, kind of dangerous, because what are you doing here?"}, {"Time_Start": 1121.0, "Time_End": 1126.0, "Text": " What's the difference between your stealth probe and your firewall at this point?"}, {"Time_Start": 1126.0, "Time_End": 1128.0, "Text": " Physically, very little."}, {"Time_Start": 1128.0, "Time_End": 1130.0, "Text": " Logically, a lot, of course."}, {"Time_Start": 1130.0, "Time_End": 1135.0, "Text": " I mean, in this architecture, you don't have an IP address on the DMZ."}, {"Time_Start": 1135.0, "Time_End": 1138.0, "Text": " You don't have an IP address on the outside,"}, {"Time_Start": 1138.0, "Time_End": 1141.0, "Text": " and you may or may not have one in the inside."}, {"Time_Start": 1141.0, "Time_End": 1144.0, "Text": " It's certainly justifiable, depending on your own."}, {"Time_Start": 1144.0, "Time_End": 1146.0, "Text": " depending on your stomach for risk, to say,"}, {"Time_Start": 1146.0, "Time_End": 1148.0, "Text": " well, I'm going to IP the internal interface"}, {"Time_Start": 1148.0, "Time_End": 1151.0, "Text": " so that I can administer this box."}, {"Time_Start": 1151.0, "Time_End": 1154.0, "Text": " Because if anyone gets so far as they're able to attack that interface,"}, {"Time_Start": 1154.0, "Time_End": 1156.0, "Text": " they're already inside."}, {"Time_Start": 1156.0, "Time_End": 1157.0, "Text": " It's game over."}, {"Time_Start": 1157.0, "Time_End": 1161.0, "Text": " So you may or may not consider this really dangerous."}, {"Time_Start": 1161.0, "Time_End": 1163.0, "Text": " The other reason, of course, is dangerous"}, {"Time_Start": 1163.0, "Time_End": 1165.0, "Text": " is because it's connected to all three networks."}, {"Time_Start": 1165.0, "Time_End": 1169.0, "Text": " If this box gets owned and reconfigured with IPs,"}, {"Time_Start": 1169.0, "Time_End": 1173.0, "Text": " then they've got carte blanche axis."}, {"Time_Start": 1173.0, "Time_End": 1174.0, "Text": " But again, you know,"}, {"Time_Start": 1174.0, "Time_End": 1176.5, "Text": " if they own this box, you're in deep trouble anyhow."}, {"Time_Start": 1176.5, "Time_End": 1180.0, "Text": " So that may or may not be a showstopper for you."}, {"Time_Start": 1180.0, "Time_End": 1182.0, "Text": " Obviously, however, this doesn't scale."}, {"Time_Start": 1182.0, "Time_End": 1187.0, "Text": " You would never ever do this in anything but a relatively small network,"}, {"Time_Start": 1187.0, "Time_End": 1189.0, "Text": " or a set of networks."}, {"Time_Start": 1189.0, "Time_End": 1192.0, "Text": " Okay, so those are some architecture considerations."}, {"Time_Start": 1192.0, "Time_End": 1196.0, "Text": " They apply equally to IDS environments"}, {"Time_Start": 1196.0, "Time_End": 1199.0, "Text": " and to packet logging"}, {"Time_Start": 1199.0, "Time_End": 1203.0, "Text": " and centralized logging things as well."}, {"Time_Start": 1203.0, "Time_End": 1204.0, "Text": " Although, in the case of centralized logging,"}, {"Time_Start": 1204.0, "Time_End": 1210.0, "Text": " logging, you know, you're not going to be receiving logs from the internet, probably."}, {"Time_Start": 1210.0, "Time_End": 1214.0, "Text": " You're probably just going to be receiving them from hosting the DMZ and on the inside."}, {"Time_Start": 1214.0, "Time_End": 1221.0, "Text": " And on the inside, you may decide that it isn't necessary to do the stealth thing at all for logging."}, {"Time_Start": 1221.0, "Time_End": 1225.0, "Text": " Okay, so you've got a box, and it's going to be a stealth box."}, {"Time_Start": 1225.0, "Time_End": 1228.0, "Text": " You install your network interface card."}, {"Time_Start": 1228.0, "Time_End": 1232.0, "Text": " You fire up Linux or whatever, and the kernel recognizes the card."}, {"Time_Start": 1232.0, "Time_End": 1233.0, "Text": " What do you need to do now?"}, {"Time_Start": 1233.0, "Time_End": 1235.0, "Text": " you need to do now to configure it?"}, {"Time_Start": 1235.0, "Time_End": 1237.0, "Text": " Well, if a Unix box, if it's a Unix box,"}, {"Time_Start": 1237.0, "Time_End": 1240.0, "Text": " and the interface comes up as ETH1,"}, {"Time_Start": 1240.0, "Time_End": 1243.0, "Text": " you just do an IF config, ETH1 up."}, {"Time_Start": 1243.0, "Time_End": 1245.0, "Text": " Any questions?"}, {"Time_Start": 1245.0, "Time_End": 1249.0, "Text": " That's literally all there is to it."}, {"Time_Start": 1249.0, "Time_End": 1252.0, "Text": " Now, if you rely heavily on things like,"}, {"Time_Start": 1252.0, "Time_End": 1254.0, "Text": " in the case of Sousa, you asked and YAST and YAST2,"}, {"Time_Start": 1254.0, "Time_End": 1258.0, "Text": " or in the case of Red Hat Net config,"}, {"Time_Start": 1258.0, "Time_End": 1260.0, "Text": " um, life can get a little bit weird,"}, {"Time_Start": 1260.0, "Time_End": 1263.0, "Text": " and you may wind up having to go in and hack your"}, {"Time_Start": 1263.0, "Time_End": 1268.0, "Text": " auto-config scripts to, I had to do this with my Sousa box,"}, {"Time_Start": 1268.0, "Time_End": 1273.0, "Text": " I had to put some information in RC.config"}, {"Time_Start": 1273.0, "Time_End": 1275.0, "Text": " so that it would cope with the fact that there was"}, {"Time_Start": 1275.0, "Time_End": 1277.0, "Text": " this additional physical interface,"}, {"Time_Start": 1277.0, "Time_End": 1280.0, "Text": " but not actually assigned the darn thing in IP address."}, {"Time_Start": 1280.0, "Time_End": 1282.0, "Text": " But at the low level, you know,"}, {"Time_Start": 1282.0, "Time_End": 1285.0, "Text": " as far as the kernel itself is concerned,"}, {"Time_Start": 1285.0, "Time_End": 1289.0, "Text": " this is all that's required to activate the interface."}, {"Time_Start": 1289.0, "Time_End": 1290.0, "Text": " Just bring it up."}, {"Time_Start": 1290.0, "Time_End": 1293.0, "Text": " At that point, your user space applications will be"}, {"Time_Start": 1293.0, "Time_End": 1297.2, "Text": " be able to access that device by name, by, you know, dev, ETH1."}, {"Time_Start": 1301.3, "Time_End": 1307.84, "Text": " Okay, let us depart for a second from the Unix operating system and talk about building a stealth"}, {"Time_Start": 1307.84, "Time_End": 1313.86, "Text": " cable. Not a whole lot to this. They don't work, this particular stealth cable design doesn't work"}, {"Time_Start": 1313.86, "Time_End": 1322.1, "Text": " for switches. It only works for hubs. But it's cool because you'll notice that you've got some"}, {"Time_Start": 1322.1000000000001, "Time_End": 1328.1000000000001, "Text": " loop back going on. What happens here is the green, of course, is receive. When packets come in,"}, {"Time_Start": 1328.1000000000001, "Time_End": 1334.1000000000001, "Text": " they come down the cable just as they would normally. They also get looped back to the transmit"}, {"Time_Start": 1334.1000000000001, "Time_End": 1339.1000000000001, "Text": " wires, to the transmit terminations. That gives you a link light on your hub."}, {"Time_Start": 1339.1000000000001, "Time_End": 1347.1000000000001, "Text": " It's a bogus link light. The hub thinks that you're sending traffic every time you receive traffic,"}, {"Time_Start": 1347.1000000000001, "Time_End": 1351.1000000000001, "Text": " but you're not. You're just bouncing everything you receive back out to the hub."}, {"Time_Start": 1352.1000000000001, "Time_End": 1355.5400000000002, "Text": " might think that that would cause some sort of, you know, endless loop, but it doesn't."}, {"Time_Start": 1357.7, "Time_End": 1363.96, "Text": " I use these at home. If you build one yourself, I highly, highly recommend that you use solid core"}, {"Time_Start": 1363.96, "Time_End": 1372.72, "Text": " cable. It's a lot easier to, to cram two solid pieces of wire together and squeeze them like"}, {"Time_Start": 1372.72, "Time_End": 1378.7600000000002, "Text": " with a wrench a whole bunch of times and cram them into an RJ45 connector than it is stranded cable."}, {"Time_Start": 1379.7600000000002, "Time_End": 1381.96, "Text": " Stranded cable, of course, basically turns to mush."}, {"Time_Start": 1382.1000000000001, "Time_End": 1386.1000000000001, "Text": " So you push and it just goes, phth."}, {"Time_Start": 1386.1000000000001, "Time_End": 1389.6000000000001, "Text": " I've tried to doing it both ways and I got nowhere with stranded cable."}, {"Time_Start": 1389.6000000000001, "Time_End": 1395.6000000000001, "Text": " Maybe there's some type of, maybe it was just the type of mail connector that I was trying to use."}, {"Time_Start": 1395.6000000000001, "Time_End": 1404.6000000000001, "Text": " But the other thing is, and I should have mentioned this a lot earlier, the resolution on these projectors is kind of crummy."}, {"Time_Start": 1404.6000000000001, "Time_End": 1407.6000000000001, "Text": " Don't be alarmed by the fact that this is blurry."}, {"Time_Start": 1407.6000000000001, "Time_End": 1411.6000000000001, "Text": " The slides on your CD-ROM are perfectly legible."}, {"Time_Start": 1411.6000000000001, "Time_End": 1414.6000000000001, "Text": " And so if you want to refer to this diagram, check it on the CD-ROM."}, {"Time_Start": 1414.6000000000001, "Time_End": 1415.6000000000001, "Text": " Yes."}, {"Time_Start": 1415.6000000000001, "Time_End": 1418.6000000000001, "Text": " What is the problem with using this with a switch?"}, {"Time_Start": 1418.6000000000001, "Time_End": 1420.6000000000001, "Text": " Doesn't work."}, {"Time_Start": 1424.6000000000001, "Time_End": 1425.6000000000001, "Text": " Huh?"}, {"Time_Start": 1425.6000000000001, "Time_End": 1427.6000000000001, "Text": " Right, right, no."}, {"Time_Start": 1427.6000000000001, "Time_End": 1431.6000000000001, "Text": " The problem is that there's no way for a switch to receive your Mac address."}, {"Time_Start": 1431.6000000000001, "Time_End": 1435.6000000000001, "Text": " A switch won't give you the time of day unless it recognizes a Mac address at your port."}, {"Time_Start": 1435.6000000000001, "Time_End": 1438.6000000000001, "Text": " That's, I'm sorry, I was a smart ass."}, {"Time_Start": 1438.6000000000001, "Time_End": 1440.6000000000001, "Text": " Won't help again, again, I promise."}, {"Time_Start": 1440.6000000000001, "Time_End": 1447.6000000000001, "Text": " promise."}, {"Time_Start": 1447.6000000000001, "Time_End": 1448.6000000000001, "Text": " I don't think it would."}, {"Time_Start": 1448.6000000000001, "Time_End": 1449.6000000000001, "Text": " I don't think it would."}, {"Time_Start": 1449.6000000000001, "Time_End": 1451.6000000000001, "Text": " I guess it depends."}, {"Time_Start": 1451.6000000000001, "Time_End": 1457.6000000000001, "Text": " I mean, switches tend to vary somewhat between manufacturer and how they handle the airports, I would guess."}, {"Time_Start": 1457.6000000000001, "Time_End": 1459.6000000000001, "Text": " It ain't like I have one, so I don't know."}, {"Time_Start": 1459.6000000000001, "Time_End": 1460.6000000000001, "Text": " Huh?"}, {"Time_Start": 1460.6000000000001, "Time_End": 1465.6000000000001, "Text": " Wouldn't this cause a collision for every time it sets up?"}, {"Time_Start": 1465.6000000000001, "Time_End": 1468.6000000000001, "Text": " Hasn't so far on my hubs."}, {"Time_Start": 1468.6000000000001, "Time_End": 1469.6000000000001, "Text": " On a switch, I don't know."}, {"Time_Start": 1469.6000000000001, "Time_End": 1473.6000000000001, "Text": " That's quite a idea of why it doesn't work on a switch, because it's"}, {"Time_Start": 1473.6000000000001, "Time_End": 1476.6000000000001, "Text": " quite possible."}, {"Time_Start": 1476.6000000000001, "Time_End": 1479.6000000000001, "Text": " I'm sorry, I should be repeating questions."}, {"Time_Start": 1479.6000000000001, "Time_End": 1485.6000000000001, "Text": " The gentleman asked whether this would cause massive collisions on a switch."}, {"Time_Start": 1485.6000000000001, "Time_End": 1491.6000000000001, "Text": " And I think that that very likely is why it would not work."}, {"Time_Start": 1491.6000000000001, "Time_End": 1496.6000000000001, "Text": " Now, I shouldn't stress, however, that the method of using no IP on a switch"}, {"Time_Start": 1496.6000000000001, "Time_End": 1498.6000000000001, "Text": " can work in the specific case of"}, {"Time_Start": 1498.6000000000001, "Time_End": 1504.6000000000001, "Text": " of stealth logging, and I'll talk about how, using bogus arp entries."}, {"Time_Start": 1504.6000000000001, "Time_End": 1507.6000000000001, "Text": " That works just fine across the switch."}, {"Time_Start": 1507.6000000000001, "Time_End": 1512.6000000000001, "Text": " It's just for sniffing proper, you know, where you want to see everything on the wire"}, {"Time_Start": 1512.6000000000001, "Time_End": 1516.6000000000001, "Text": " that you pretty much have to be on a hub port and on a switch port,"}, {"Time_Start": 1516.6000000000001, "Time_End": 1518.6000000000001, "Text": " unless it's a newer port."}, {"Time_Start": 1518.6000000000001, "Time_End": 1520.6000000000001, "Text": " Any other questions about receiving only cable?"}, {"Time_Start": 1520.6000000000001, "Time_End": 1521.6000000000001, "Text": " Yes."}, {"Time_Start": 1526.6000000000001, "Time_End": 1527.6000000000001, "Text": " Oh, okay."}, {"Time_Start": 1527.6000000000001, "Time_End": 1528.6000000000001, "Text": " The gentleman's important."}, {"Time_Start": 1528.6000000000001, "Time_End": 1532.6000000000001, "Text": " that to get rid of the collision, all you have to do is set the port to full duplex."}, {"Time_Start": 1536.6000000000001, "Time_End": 1540.6000000000001, "Text": " Cool. See, now you've got access to super elite hardware that you can manage."}, {"Time_Start": 1540.6000000000001, "Time_End": 1544.6000000000001, "Text": " I don't. The switch does what it does."}, {"Time_Start": 1544.6000000000001, "Time_End": 1550.6000000000001, "Text": " But yeah, a managed switch, on a managed 10-100 switch,"}, {"Time_Start": 1550.6000000000001, "Time_End": 1554.6000000000001, "Text": " you would be able to set it to full duplex and the collision problem would be solved."}, {"Time_Start": 1554.6000000000001, "Time_End": 1555.6000000000001, "Text": " Yeah."}, {"Time_Start": 1555.6000000000001, "Time_End": 1557.6000000000001, "Text": " So maybe you could make this work."}, {"Time_Start": 1557.6000000000001, "Time_End": 1563.6000000000001, "Text": " work the fact I didn't have the time with the inclination to figure out how to build a"}, {"Time_Start": 1563.6000000000001, "Time_End": 1569.6000000000001, "Text": " receive-only cable for a switch but that certainly sounds like it could work."}, {"Time_Start": 1569.6000000000001, "Time_End": 1574.6000000000001, "Text": " Okay, oh and incidentally I got to give full credit."}, {"Time_Start": 1574.6000000000001, "Time_End": 1577.6000000000001, "Text": " I didn't think of this myself. This is not original."}, {"Time_Start": 1577.6000000000001, "Time_End": 1581.6000000000001, "Text": " I took this from the snort FAQ and converted it to the beautiful graphic before you."}, {"Time_Start": 1581.6000000000001, "Time_End": 1585.6000000000001, "Text": " It was originally ASCII art, so I did do something."}, {"Time_Start": 1585.6000000000001, "Time_End": 1586.6000000000001, "Text": " Yes."}, {"Time_Start": 1586.6000000000001, "Time_End": 1593.6000000000001, "Text": " Oh, right, right."}, {"Time_Start": 1593.6000000000001, "Time_End": 1594.6000000000001, "Text": " Yeah."}, {"Time_Start": 1594.6000000000001, "Time_End": 1598.6000000000001, "Text": " Your arc table on the switch would get really screwed up by the loopback."}, {"Time_Start": 1598.6000000000001, "Time_End": 1599.6000000000001, "Text": " That's absolutely right."}, {"Time_Start": 1599.6000000000001, "Time_End": 1600.6000000000001, "Text": " It would fill up."}, {"Time_Start": 1600.6000000000001, "Time_End": 1604.6000000000001, "Text": " Then it would revert to a hub behavior, and you'd be home free."}, {"Time_Start": 1608.6000000000001, "Time_End": 1612.6000000000001, "Text": " At which point you'd get like two megabits throughput."}, {"Time_Start": 1612.6000000000001, "Time_End": 1613.6000000000001, "Text": " Okay."}, {"Time_Start": 1613.6000000000001, "Time_End": 1615.6000000000001, "Text": " Let's..."}, {"Time_Start": 1615.6000000000001, "Time_End": 1616.6000000000001, "Text": " Let's..."}, {"Time_Start": 1616.6000000000001, "Time_End": 1621.6000000000001, "Text": " Let's shift the discussion now to a somewhat narrow focus and that of stealth logging."}, {"Time_Start": 1621.6000000000001, "Time_End": 1628.6000000000001, "Text": " The reason I'm not going to talk about stealth IDS explicitly or stealth packet logging any further"}, {"Time_Start": 1628.6000000000001, "Time_End": 1630.6000000000001, "Text": " is because it's just, it's easy."}, {"Time_Start": 1630.6000000000001, "Time_End": 1632.6000000000001, "Text": " There's nothing to do at this point."}, {"Time_Start": 1632.6000000000001, "Time_End": 1638.6000000000001, "Text": " You know, after you've brought up the interface, it optionally used a super paranoid receive-only cable."}, {"Time_Start": 1638.6000000000001, "Time_End": 1646.6000000000001, "Text": " There's nothing else to do other than to do a SMART-I-E-T-H-1, you know, maybe specified"}, {"Time_Start": 1646.6000000000001, "Time_End": 1647.6000000000001, "Text": " config file, whatever."}, {"Time_Start": 1647.6000000000001, "Time_End": 1649.6000000000001, "Text": " I mean, it'll work just fine at that point."}, {"Time_Start": 1649.6000000000001, "Time_End": 1651.6000000000001, "Text": " TCP dump, same thing."}, {"Time_Start": 1651.6000000000001, "Time_End": 1653.6000000000001, "Text": " Specify the interface and it'll just work."}, {"Time_Start": 1653.6000000000001, "Time_End": 1657.6000000000001, "Text": " We've got a little bit more work to do, however, if we're going to do stealth logging."}, {"Time_Start": 1657.6000000000001, "Time_End": 1662.6000000000001, "Text": " Now, if you're doing IDS, you can just configure it snort the way you normally would"}, {"Time_Start": 1662.6000000000001, "Time_End": 1668.6000000000001, "Text": " and point, you know, configure Etsy snort, snort.com with the rules,"}, {"Time_Start": 1668.6000000000001, "Time_End": 1673.6000000000001, "Text": " or pointers to the files, the container rules, and so forth."}, {"Time_Start": 1673.6000000000001, "Time_End": 1675.6000000000001, "Text": " And that's no different whether the interface in question has a"}, {"Time_Start": 1675.6000000000001, "Time_End": 1677.6000000000001, "Text": " question has an IP address or not."}, {"Time_Start": 1677.6000000000001, "Time_End": 1680.6000000000001, "Text": " That in itself is actually kind of cool, isn't it?"}, {"Time_Start": 1680.6000000000001, "Time_End": 1683.6000000000001, "Text": " But doesn't involve extra work."}, {"Time_Start": 1683.6000000000001, "Time_End": 1687.6000000000001, "Text": " But for stealth logging, you're going to need a special rule."}, {"Time_Start": 1687.6000000000001, "Time_End": 1690.6000000000001, "Text": " Now the stuff, oh man, that's totally illegible."}, {"Time_Start": 1690.6000000000001, "Time_End": 1692.6000000000001, "Text": " That a total drag."}, {"Time_Start": 1692.6000000000001, "Time_End": 1696.6000000000001, "Text": " And you know what? This is not on the slides on your CD-ROM."}, {"Time_Start": 1696.6000000000001, "Time_End": 1697.6000000000001, "Text": " I apologize."}, {"Time_Start": 1697.6000000000001, "Time_End": 1702.6000000000001, "Text": " At the time that I was frantically trying to get these slides ready,"}, {"Time_Start": 1702.6000000000001, "Time_End": 1704.6000000000001, "Text": " which was like three weeks ago,"}, {"Time_Start": 1704.6000000000001, "Time_End": 1705.6000000000001, "Text": " I was also"}, {"Time_Start": 1705.6000000000001, "Time_End": 1710.6000000000001, "Text": " finishing a book, building secure servers with Linux, O'Reillian Associates, October 2002."}, {"Time_Start": 1710.6000000000001, "Time_End": 1714.6000000000001, "Text": " I'll try not to plug it."}, {"Time_Start": 1714.6000000000001, "Time_End": 1716.6000000000001, "Text": " So I didn't really have my act fully together."}, {"Time_Start": 1716.6000000000001, "Time_End": 1717.6000000000001, "Text": " So I apologize for that."}, {"Time_Start": 1717.6000000000001, "Time_End": 1721.6000000000001, "Text": " But if you go, and this URL is at the end of the presentation too."}, {"Time_Start": 1721.6000000000001, "Time_End": 1725.6000000000001, "Text": " And it's also apologetically inserted on the dummy slides on your CUM."}, {"Time_Start": 1725.6000000000001, "Time_End": 1730.6000000000001, "Text": " If you go to DefConX.Yermonkeys.org,"}, {"Time_Start": 1730.6000000000001, "Time_End": 1734.6000000000001, "Text": " you will find this slide in all its glory and in full resolution."}, {"Time_Start": 1734.6000000000001, "Time_End": 1735.6000000000001, "Text": " full resolution."}, {"Time_Start": 1735.6000000000001, "Time_End": 1742.6000000000001, "Text": " But anyhow, what it says is, okay, any net is considered the external net,"}, {"Time_Start": 1742.6000000000001, "Time_End": 1749.6000000000001, "Text": " with, you know, in other words, look at everything in the same, with the same weight, basically."}, {"Time_Start": 1749.6000000000001, "Time_End": 1751.6000000000001, "Text": " We want to look at packet contents."}, {"Time_Start": 1751.6000000000001, "Time_End": 1753.6000000000001, "Text": " We've got a config, dump underscore payload."}, {"Time_Start": 1753.6000000000001, "Time_End": 1754.6000000000001, "Text": " But we want to see ASCII."}, {"Time_Start": 1754.6000000000001, "Time_End": 1758.6000000000001, "Text": " There's really no reason to have the hex stump."}, {"Time_Start": 1758.6000000000001, "Time_End": 1760.6000000000001, "Text": " And I'll let me back up a second."}, {"Time_Start": 1760.6000000000001, "Time_End": 1761.6000000000001, "Text": " What are we doing here?"}, {"Time_Start": 1761.6000000000001, "Time_End": 1764.6000000000001, "Text": " What we're going to do is we're going to configure a stealth logger, right?"}, {"Time_Start": 1764.6000000000001, "Time_End": 1766.72, "Text": " It's got an interface without an IP address,"}, {"Time_Start": 1766.72, "Time_End": 1771.2400000000002, "Text": " and what we wanted to do is listen on that interface for syslog,"}, {"Time_Start": 1771.2400000000002, "Time_End": 1775.6000000000001, "Text": " or syslog nG packet, it's sent to UDP port 514."}, {"Time_Start": 1775.6000000000001, "Time_End": 1779.68, "Text": " Is anybody here completely unfamiliar with the concept of remote logging?"}, {"Time_Start": 1779.68, "Time_End": 1782.6000000000001, "Text": " Don't be shy."}, {"Time_Start": 1782.6000000000001, "Time_End": 1788.1000000000001, "Text": " But just in case anyone is both ignorant and shy, I'll explain it."}, {"Time_Start": 1788.1000000000001, "Time_End": 1791.6000000000001, "Text": " In remote logging, you're ignorant to school, you can fix that."}, {"Time_Start": 1791.6000000000001, "Time_End": 1796.6000000000001, "Text": " With remote logging, what you do is instead of,"}, {"Time_Start": 1796.6000000000001, "Time_End": 1799.6000000000001, "Text": " well, in addition to configuring syslog, or syslog,"}, {"Time_Start": 1799.6000000000001, "Time_End": 1803.1000000000001, "Text": " or whatever you use on your unit system, to log to a file,"}, {"Time_Start": 1803.1000000000001, "Time_End": 1807.6000000000001, "Text": " you also say, send some or all log packets to this host."}, {"Time_Start": 1807.6000000000001, "Time_End": 1810.6000000000001, "Text": " And by convention, this happens on UDP 514."}, {"Time_Start": 1810.6000000000001, "Time_End": 1814.6000000000001, "Text": " So you have some central logger, you know, with an IP address usually,"}, {"Time_Start": 1814.6000000000001, "Time_End": 1817.6000000000001, "Text": " listening on UDP port 514."}, {"Time_Start": 1817.6000000000001, "Time_End": 1820.6000000000001, "Text": " And the packet format's really simple."}, {"Time_Start": 1820.6000000000001, "Time_End": 1821.6000000000001, "Text": " It's just IP-house."}, {"Time_Start": 1821.6000000000001, "Time_End": 1827.6000000000001, "Text": " header, UDP header, such as it is, and let's see."}, {"Time_Start": 1827.6000000000001, "Time_End": 1834.6000000000001, "Text": " Sending host's name, as the sending host specifies it, you can lie, that can be fun."}, {"Time_Start": 1834.6000000000001, "Time_End": 1837.6000000000001, "Text": " Priority level and facility."}, {"Time_Start": 1837.6000000000001, "Time_End": 1840.6000000000001, "Text": " Priority level, of course, is the severity of the message."}, {"Time_Start": 1840.6000000000001, "Time_End": 1844.6000000000001, "Text": " Facility is the type of log message, which is sort of arbitrary."}, {"Time_Start": 1844.6000000000001, "Time_End": 1846.6000000000001, "Text": " It's user definable."}, {"Time_Start": 1846.6000000000001, "Time_End": 1850.6000000000001, "Text": " I mean, there are standard categories like mail and kernel and so forth."}, {"Time_Start": 1850.6000000000001, "Time_End": 1856.6000000000001, "Text": " and so forth, but it's perfectly possible to configure your logger to send mail messages,"}, {"Time_Start": 1856.6000000000001, "Time_End": 1858.6000000000001, "Text": " you know, to the current facility."}, {"Time_Start": 1858.6000000000001, "Time_End": 1861.6000000000001, "Text": " But anyhow, what was I going with this?"}, {"Time_Start": 1861.6000000000001, "Time_End": 1862.6000000000001, "Text": " Oh, yeah."}, {"Time_Start": 1862.6000000000001, "Time_End": 1864.6000000000001, "Text": " So that normally happens on UDP 514."}, {"Time_Start": 1864.6000000000001, "Time_End": 1866.6000000000001, "Text": " What we're going to do here is configure a stealth logger"}, {"Time_Start": 1866.6000000000001, "Time_End": 1869.6000000000001, "Text": " to sniff packets that it sees"}, {"Time_Start": 1869.6000000000001, "Time_End": 1873.6000000000001, "Text": " optionally address to a specific bogus stealth logger ID,"}, {"Time_Start": 1873.6000000000001, "Time_End": 1876.6000000000001, "Text": " or IP address, sniff those packets,"}, {"Time_Start": 1876.6000000000001, "Time_End": 1879.6000000000001, "Text": " strip away the IP header info, and just save the payload of the left"}, {"Time_Start": 1879.6000000000001, "Time_End": 1881.1000000000001, "Text": " the payload of the log packet."}, {"Time_Start": 1881.1000000000001, "Time_End": 1884.6000000000001, "Text": " And so, okay, so we're going to tell it,"}, {"Time_Start": 1884.6000000000001, "Time_End": 1888.6000000000001, "Text": " dump the packet payload, that's the part we're interested in."}, {"Time_Start": 1888.6000000000001, "Time_End": 1891.6000000000001, "Text": " Don't bother with the hex, just give me ASCII."}, {"Time_Start": 1891.6000000000001, "Time_End": 1896.6000000000001, "Text": " And, you know, I've got a default log directory with snow logs go."}, {"Time_Start": 1896.6000000000001, "Time_End": 1900.6000000000001, "Text": " That actually won't be used in this case, except as,"}, {"Time_Start": 1900.6000000000001, "Time_End": 1904.6000000000001, "Text": " if I were to not use fully, a fully qualified path name,"}, {"Time_Start": 1904.6000000000001, "Time_End": 1905.6000000000001, "Text": " it'll stick that in front."}, {"Time_Start": 1905.6000000000001, "Time_End": 1908.6000000000001, "Text": " Pre-process or frag tool, we want it to rebuild fragments."}, {"Time_Start": 1908.6000000000001, "Time_End": 1912.6000000000001, "Text": " fragments. Fragged log packets would probably not be"}, {"Time_Start": 1912.6000000000001, "Time_End": 1916.6000000000001, "Text": " as useful to us as complete log packets, right?"}, {"Time_Start": 1916.6000000000001, "Time_End": 1919.6000000000001, "Text": " And then now here's the meat of the config file."}, {"Time_Start": 1919.6000000000001, "Time_End": 1924.6000000000001, "Text": " There's a line that says log, UDP, source, in this case,"}, {"Time_Start": 1924.6000000000001, "Time_End": 1927.6000000000001, "Text": " you know, 192.162.12.0.0."}, {"Time_Start": 1927.6000000000001, "Time_End": 1928.6000000000001, "Text": " slash 24."}, {"Time_Start": 1928.6000000000001, "Time_End": 1932.6000000000001, "Text": " In other words, the Class C address, .123."}, {"Time_Start": 1932.6000000000001, "Time_End": 1936.6000000000001, "Text": " On any source port, source ports are arbitrary,"}, {"Time_Start": 1936.6000000000001, "Time_End": 1937.6000000000001, "Text": " right?"}, {"Time_Start": 1937.6000000000001, "Time_End": 1938.6000000000001, "Text": " More or less."}, {"Time_Start": 1938.6000000000001, "Time_End": 1943.6000000000001, "Text": " match packets that are addressed to 192.168.123."}, {"Time_Start": 1943.6000000000001, "Time_End": 1944.6000000000001, "Text": " 111."}, {"Time_Start": 1944.6000000000001, "Time_End": 1947.6000000000001, "Text": " Is there a host that actually has that IP address?"}, {"Time_Start": 1947.6000000000001, "Time_End": 1949.6000000000001, "Text": " No, emphatically not."}, {"Time_Start": 1949.6000000000001, "Time_End": 1951.6000000000001, "Text": " The whole point of this exercise,"}, {"Time_Start": 1951.6000000000001, "Time_End": 1955.6000000000001, "Text": " the only reason that you could write this rule"}, {"Time_Start": 1955.6000000000001, "Time_End": 1959.6000000000001, "Text": " to say any as the destination, right?"}, {"Time_Start": 1959.6000000000001, "Time_End": 1961.6000000000001, "Text": " But what I like to do,"}, {"Time_Start": 1961.6000000000001, "Time_End": 1964.6000000000001, "Text": " what I like to do is pick some IP address at random"}, {"Time_Start": 1964.6000000000001, "Time_End": 1967.6000000000001, "Text": " that none of the hosts on this segment are actually using"}, {"Time_Start": 1967.6000000000001, "Time_End": 1968.6000000000001, "Text": " and send packets."}, {"Time_Start": 1968.6000000000001, "Time_End": 1975.6000000000001, "Text": " there in the sadistic hope that an attacker will try to identify and attack that system."}, {"Time_Start": 1975.6000000000001, "Time_End": 1977.6000000000001, "Text": " But it doesn't exist."}, {"Time_Start": 1977.6000000000001, "Time_End": 1982.6000000000001, "Text": " So it involves a little bit of extra work with configuration."}, {"Time_Start": 1982.6000000000001, "Time_End": 1986.6000000000001, "Text": " And my loggers I'm going to have to put a bogus arpentrine for that IP address."}, {"Time_Start": 1986.6000000000001, "Time_End": 1989.6000000000001, "Text": " But anyhow, that's what this rule says is look for packets."}, {"Time_Start": 1989.6000000000001, "Time_End": 1997.6000000000001, "Text": " To me, I don't know, I like the idea of specifying the destination on my snort rule for sniffing packets."}, {"Time_Start": 1997.6000000000001, "Time_End": 2006.6000000000001, "Text": " and then in parentheses at the end then it says log to my file and my, you know, my log file."}, {"Time_Start": 2006.6000000000001, "Time_End": 2009.6000000000001, "Text": " That's just the name of the file that I want to stick these packets in."}, {"Time_Start": 2009.6000000000001, "Time_End": 2012.6000000000001, "Text": " Now at this point we're telling Snort to log the whole packet."}, {"Time_Start": 2012.6000000000001, "Time_End": 2014.6000000000001, "Text": " We kind of have to."}, {"Time_Start": 2014.6000000000001, "Time_End": 2021.6000000000001, "Text": " We can't, there isn't any easy way that I know of to get Snort to only log the packet."}, {"Time_Start": 2025.6000000000001, "Time_End": 2026.6000000000001, "Text": " Wow, is that ever disturbing."}, {"Time_Start": 2026.6000000000001, "Time_End": 2027.6000000000001, "Text": " disturbing."}, {"Time_Start": 2027.6000000000001, "Time_End": 2030.6000000000001, "Text": " I guess I'm glad I skipped breakfast."}, {"Time_Start": 2030.6000000000001, "Time_End": 2031.6000000000001, "Text": " Okay."}, {"Time_Start": 2031.6000000000001, "Time_End": 2045.6000000000001, "Text": " I'm going to hope that wasn't some sort of statement, you know, as to the..."}, {"Time_Start": 2045.6000000000001, "Time_End": 2049.6000000000004, "Text": " Oh, the dude scored 75 points in the scavenger hunt that way."}, {"Time_Start": 2049.6000000000004, "Time_End": 2054.6000000000004, "Text": " I think we all should get some points for that, though, yeah, yeah."}, {"Time_Start": 2054.6000000000004, "Time_End": 2055.6000000000004, "Text": " If anybody feels really traumatized."}, {"Time_Start": 2055.6, "Time_End": 2060.1, "Text": " is really traumatized and having some obsolete junk would help."}, {"Time_Start": 2063.1, "Time_End": 2064.1, "Text": " I can help."}, {"Time_Start": 2064.1, "Time_End": 2067.1, "Text": " I can offer some junk therapy a little later on here."}, {"Time_Start": 2071.1, "Time_End": 2073.6, "Text": " Thank the vendors who contributed the use of this time."}, {"Time_Start": 2073.6, "Time_End": 2074.6, "Text": " Not me."}, {"Time_Start": 2074.6, "Time_End": 2075.6, "Text": " Okay."}, {"Time_Start": 2075.6, "Time_End": 2077.1, "Text": " Where was I?"}, {"Time_Start": 2077.1, "Time_End": 2078.1, "Text": " Oh, yeah."}, {"Time_Start": 2078.1, "Time_End": 2079.6, "Text": " So we've got to add this log rule."}, {"Time_Start": 2079.6, "Time_End": 2085.1, "Text": " Obviously on a stealth log system, we don't want to actually be looking for intrusion detection."}, {"Time_Start": 2085.1, "Time_End": 2085.58, "Text": " I mean, I guess,"}, {"Time_Start": 2085.6, "Time_End": 2087.6, "Text": " maybe you do. I guess you could have it do both, but"}, {"Time_Start": 2087.6, "Time_End": 2091.6, "Text": " that would make for a more complicated example, so it doesn't show that here."}, {"Time_Start": 2091.6, "Time_End": 2092.6, "Text": " Okay."}, {"Time_Start": 2092.6, "Time_End": 2095.6, "Text": " Now the way that you would fire up snort to act that way"}, {"Time_Start": 2095.6, "Time_End": 2097.6, "Text": " looks a lot like the way that you would fire up to do IDS."}, {"Time_Start": 2097.6, "Time_End": 2101.6, "Text": " You specify a configuration file and you tell it to run in Damon mode."}, {"Time_Start": 2101.6, "Time_End": 2105.6, "Text": " Obviously, in this case, it's our truncated little teeny snort.com file"}, {"Time_Start": 2105.6, "Time_End": 2109.6, "Text": " that just has the one rule saying look for log packets."}, {"Time_Start": 2109.6, "Time_End": 2113.6, "Text": " We also use the dash i flag to specify an interface."}, {"Time_Start": 2113.6, "Time_End": 2115.6, "Text": " Actually, you probably, you probably want."}, {"Time_Start": 2115.6, "Time_End": 2118.6, "Text": " to, you know, anytime you fire up snort, but for sure you need to hear."}, {"Time_Start": 2118.6, "Time_End": 2122.6, "Text": " You need to tell it, listen on that stealth interface, what has no IPE."}, {"Time_Start": 2122.6, "Time_End": 2123.6, "Text": " Okay."}, {"Time_Start": 2123.6, "Time_End": 2126.6, "Text": " Now, are you following me so far?"}, {"Time_Start": 2126.6, "Time_End": 2129.6, "Text": " We've just configured our central log server"}, {"Time_Start": 2129.6, "Time_End": 2133.6, "Text": " to sniff its log packets off the wire, right?"}, {"Time_Start": 2133.6, "Time_End": 2138.6, "Text": " Now we're going to do on each host that actually sends log data,"}, {"Time_Start": 2138.6, "Time_End": 2140.6, "Text": " what we're going to do are two things."}, {"Time_Start": 2140.6, "Time_End": 2144.6, "Text": " First, we're going to configure our logger on that system, our log facility."}, {"Time_Start": 2144.6, "Time_End": 2151.6, "Text": " facility to send to the bogus IP address so that it puts the packets out on the wire."}, {"Time_Start": 2151.6, "Time_End": 2156.6, "Text": " Now, if you use a bogus IP that's local to the land, you are going to need,"}, {"Time_Start": 2156.6, "Time_End": 2163.6, "Text": " in addition to the appropriate configuration stuff in syslog.com or in syslog dash ng.comf,"}, {"Time_Start": 2163.6, "Time_End": 2166.6, "Text": " you're also going to need that static arp entry,"}, {"Time_Start": 2166.6, "Time_End": 2171.6, "Text": " if you skip that part, if you don't have a static arp entry saying,"}, {"Time_Start": 2171.6, "Time_End": 2174.58, "Text": " hey, the MAC address of this bogus IP is this bogus"}, {"Time_Start": 2174.6, "Time_End": 2181.6, "Text": " Mac address. In this case, E-I-E-I-O, because I have little kids, and that was on my mind"}, {"Time_Start": 2181.6, "Time_End": 2190.1, "Text": " at the time. And if you're doing this across the switch, you could, in fact, make that the real Mac"}, {"Time_Start": 2190.1, "Time_End": 2196.6, "Text": " address of your log server, so that the packets actually get to the stealth logger."}, {"Time_Start": 2196.6, "Time_End": 2204.58, "Text": " Obviously, you are now making this system known to the switch, right? But you see, but it, you"}, {"Time_Start": 2204.6, "Time_End": 2207.9, "Text": " the system isn't actually configured with that bogus IP address."}, {"Time_Start": 2209.9, "Time_End": 2215.1, "Text": " So it will be possible for people, if they want to, to deliver packets to that host,"}, {"Time_Start": 2215.6, "Time_End": 2218.2599999999998, "Text": " but that host will drop them because it doesn't have an IP address."}, {"Time_Start": 2218.7599999999998, "Time_End": 2219.0, "Text": " Okay."}, {"Time_Start": 2220.2599999999998, "Time_End": 2222.2599999999998, "Text": " Except, of course, for log packets."}, {"Time_Start": 2222.44, "Time_End": 2223.92, "Text": " Was that confusing? Was that clear?"}, {"Time_Start": 2226.18, "Time_End": 2228.66, "Text": " Ask two yes or no questions and then figure out which the answer applies to."}, {"Time_Start": 2228.66, "Time_End": 2231.22, "Text": " Good, Nick."}, {"Time_Start": 2231.8399999999997, "Time_End": 2233.94, "Text": " Was that, should I explain that further?"}, {"Time_Start": 2234.6, "Time_End": 2235.6, "Text": " No?"}, {"Time_Start": 2235.6, "Time_End": 2236.6, "Text": " Okay."}, {"Time_Start": 2236.6, "Time_End": 2237.6, "Text": " Okay."}, {"Time_Start": 2237.6, "Time_End": 2238.6, "Text": " Okay."}, {"Time_Start": 2238.6, "Time_End": 2240.6, "Text": " So the static up entry."}, {"Time_Start": 2240.6, "Time_End": 2241.6, "Text": " Entry."}, {"Time_Start": 2241.6, "Time_End": 2242.6, "Text": " Okay."}, {"Time_Start": 2242.6, "Time_End": 2249.6, "Text": " Once we've done that, oh, and when I talk briefly about what I added to syslog.com, that's really easy."}, {"Time_Start": 2249.6, "Time_End": 2253.6, "Text": " I'm telling you in this example, what I've got is star that star, semicolon mail.9,"}, {"Time_Start": 2253.6, "Time_End": 2255.6, "Text": " semicolon news.9."}, {"Time_Start": 2255.6, "Time_End": 2256.6, "Text": " I'm looking at the second line here."}, {"Time_Start": 2256.6, "Time_End": 2263.6, "Text": " What this is going to match is all packets, all log messages, except"}, {"Time_Start": 2263.6, "Time_End": 2268.1, "Text": " Those that involve mail and those that involve news."}, {"Time_Start": 2268.1, "Time_End": 2270.6, "Text": " Because typically you've got a dedicated log file for those."}, {"Time_Start": 2270.6, "Time_End": 2275.6, "Text": " And unless this is an SMTP gateway or a new server,"}, {"Time_Start": 2275.6, "Time_End": 2278.1, "Text": " you probably don't care about seeing news and log packets."}, {"Time_Start": 2278.1, "Time_End": 2280.1, "Text": " You know, from the security standpoint so much."}, {"Time_Start": 2280.1, "Time_End": 2282.1, "Text": " Well, you know, actually you probably do."}, {"Time_Start": 2282.1, "Time_End": 2286.1, "Text": " Well, anyhow, for whatever reason, I've configured this to not send those to the log server."}, {"Time_Start": 2286.1, "Time_End": 2290.1, "Text": " And what it's going to do is instead of logging to a file, like the first line,"}, {"Time_Start": 2290.1, "Time_End": 2292.6, "Text": " I'm going to send to an IP address."}, {"Time_Start": 2292.6, "Time_End": 2293.1, "Text": " So I use an app."}, {"Time_Start": 2293.1, "Time_End": 2297.7599999999998, "Text": " I use an at sign, and then the IP address or host name of my central log server."}, {"Time_Start": 2297.96, "Time_End": 2300.4, "Text": " Now remember that dot 111 is a bogus IP address."}, {"Time_Start": 2300.5, "Time_End": 2304.6, "Text": " But what this is going to cause my logging host, my web server, or whatever,"}, {"Time_Start": 2305.06, "Time_End": 2309.48, "Text": " is to construct these packets, address to this bogus IP, and slap them out on the wire."}, {"Time_Start": 2309.8199999999997, "Time_End": 2310.1, "Text": " Okay."}, {"Time_Start": 2310.68, "Time_End": 2312.46, "Text": " CISLG looks more complicated."}, {"Time_Start": 2312.6, "Time_End": 2313.64, "Text": " I guess it sort of is."}, {"Time_Start": 2314.02, "Time_End": 2319.58, "Text": " But if you use CISLogNG, which I highly recommend, it's much more powerful."}, {"Time_Start": 2319.58, "Time_End": 2321.86, "Text": " So we need to define a destination."}, {"Time_Start": 2321.86, "Time_End": 2325.02, "Text": " We've got a destination named D underscore Loghost,"}, {"Time_Start": 2325.38, "Time_End": 2329.54, "Text": " and that's a destination that uses UDP."}, {"Time_Start": 2330.02, "Time_End": 2331.76, "Text": " We give the Borges IP, we give the port."}, {"Time_Start": 2332.1, "Time_End": 2333.7400000000002, "Text": " We can use any port we want, by the way."}, {"Time_Start": 2333.8, "Time_End": 2335.6800000000003, "Text": " We don't have to use 514 for this."}, {"Time_Start": 2336.1400000000003, "Time_End": 2342.46, "Text": " As long as you're sniffing for packets using the port that you set here"}, {"Time_Start": 2342.46, "Time_End": 2345.76, "Text": " on your sending machines, it can be anything you want."}, {"Time_Start": 2346.52, "Time_End": 2348.6200000000003, "Text": " I used 514 out of mental laziness."}, {"Time_Start": 2349.4, "Time_End": 2350.6800000000003, "Text": " So we've got a destination."}, {"Time_Start": 2351.86, "Time_End": 2357.36, "Text": " Let's, we want all packets that have got severity of info or higher, okay?"}, {"Time_Start": 2358.36, "Time_End": 2359.82, "Text": " Um, so that's what that filter says."}, {"Time_Start": 2359.9, "Time_End": 2365.7000000000003, "Text": " And then we've got a logging rule that says, log, anything that matches our filter called filter,"}, {"Time_Start": 2366.38, "Time_End": 2370.1800000000003, "Text": " and send packets that match to the destination D underscore log host."}, {"Time_Start": 2371.3, "Time_End": 2371.6800000000003, "Text": " Okay."}, {"Time_Start": 2371.82, "Time_End": 2376.3, "Text": " Any questions on, I'm configuring your logger to send to the bogus IP address?"}, {"Time_Start": 2376.78, "Time_End": 2377.04, "Text": " Yes."}, {"Time_Start": 2381.86, "Time_End": 2389.2000000000003, "Text": " Um, how do you, the question is, how do you prevent up poisoning?"}, {"Time_Start": 2390.04, "Time_End": 2390.94, "Text": " I don't know. How do you?"}, {"Time_Start": 2392.6600000000003, "Time_End": 2393.1400000000003, "Text": " Huh?"}, {"Time_Start": 2394.44, "Time_End": 2395.82, "Text": " Yeah, I don't hope it doesn't matter."}, {"Time_Start": 2396.06, "Time_End": 2399.5, "Text": " Our poisoning really is only going to pertain to switches."}, {"Time_Start": 2399.6400000000003, "Time_End": 2406.7000000000003, "Text": " I guess what you could do is, I mean, if you knew that, if you as an attacker knew, that the"}, {"Time_Start": 2406.7000000000003, "Time_End": 2411.6400000000003, "Text": " sysadmin had set up a stealth logger and that the box that you just"}, {"Time_Start": 2411.64, "Time_End": 2416.68, "Text": " rooted is sending its laws to a bogus IP. I guess you could mess with that ARP entry for"}, {"Time_Start": 2416.68, "Time_End": 2425.58, "Text": " some reason. And I mean, that's not really art poisoning. That's just ARP Fetzen. But, you know, I mean,"}, {"Time_Start": 2425.6, "Time_End": 2431.1, "Text": " at that point, I'm not too sure how much worse that is going to make your life than it already"}, {"Time_Start": 2431.1, "Time_End": 2438.7999999999997, "Text": " will be at that point. I mean, which is to say, obviously, if somebody roots a box that is doing"}, {"Time_Start": 2438.8, "Time_End": 2443.86, "Text": " remote logging. From that point forward, the logs aren't trustworthy whether they're being"}, {"Time_Start": 2443.86, "Time_End": 2452.0, "Text": " logged locally or being transmitted. The whole point of this exercise is that the logs sent up to the"}, {"Time_Start": 2452.0, "Time_End": 2457.6600000000003, "Text": " point where the attack succeeded will be on the central log server in a place that they can't easily"}, {"Time_Start": 2457.6600000000003, "Time_End": 2462.88, "Text": " be erased or tampered with, okay? So our poisoning, yeah, I don't know how you'd prevent in this case."}, {"Time_Start": 2463.1800000000003, "Time_End": 2463.42, "Text": " Yes."}, {"Time_Start": 2468.8, "Time_End": 2477.1800000000003, "Text": " higher end switches can lock a port to a specific Mac address."}, {"Time_Start": 2478.26, "Time_End": 2482.02, "Text": " Again, I have no experience with higher end switches. I use cheap Aussie crap."}, {"Time_Start": 2486.82, "Time_End": 2488.5, "Text": " Can you tell that I've got issues with that?"}, {"Time_Start": 2488.5, "Time_End": 2490.26, "Text": " I've got a little bit of resentment there."}, {"Time_Start": 2492.32, "Time_End": 2498.6800000000003, "Text": " Okay. So, we've set up our receiver, you know, we've set up our stealth log point. We've set up our senders. We've set up our senders."}, {"Time_Start": 2498.8, "Time_End": 2502.0, "Text": " And now packets start going over the wire."}, {"Time_Start": 2502.0600000000004, "Time_End": 2502.7400000000002, "Text": " What do they look like?"}, {"Time_Start": 2504.02, "Time_End": 2505.2400000000002, "Text": " They look really blurry."}, {"Time_Start": 2507.5800000000004, "Time_End": 2512.1800000000003, "Text": " Here we've got a standard snort-outputed packet on top."}, {"Time_Start": 2512.28, "Time_End": 2517.0800000000004, "Text": " We've got your IP header and timestamp and then the data payload."}, {"Time_Start": 2518.0, "Time_End": 2519.5, "Text": " Now, this isn't too bad."}, {"Time_Start": 2519.5, "Time_End": 2527.46, "Text": " I mean, you know, you can quite possibly live with this as your syslog file format, you know,"}, {"Time_Start": 2527.46, "Time_End": 2529.58, "Text": " and make sense out of these"}, {"Time_Start": 2529.58, "Time_End": 2532.08, "Text": " and just kind of mentally ignore the first three lines."}, {"Time_Start": 2532.2400000000002, "Time_End": 2534.64, "Text": " And the first three lines, you might say to you,"}, {"Time_Start": 2534.78, "Time_End": 2536.48, "Text": " I mean, you might think, well, that's really important"}, {"Time_Start": 2536.48, "Time_End": 2538.1, "Text": " to log the IP header, right?"}, {"Time_Start": 2538.14, "Time_End": 2540.54, "Text": " So you know that the packet really came from the host"}, {"Time_Start": 2540.54, "Time_End": 2541.84, "Text": " that it said it came from."}, {"Time_Start": 2541.88, "Time_End": 2545.38, "Text": " But see, the thing is, to a point, you sort of trust,"}, {"Time_Start": 2545.68, "Time_End": 2546.76, "Text": " you know, until they've been rooted,"}, {"Time_Start": 2547.04, "Time_End": 2549.2400000000002, "Text": " you trust the host sending the packet"}, {"Time_Start": 2549.2400000000002, "Time_End": 2552.04, "Text": " to not use a bogus name in the data payload"}, {"Time_Start": 2552.04, "Time_End": 2554.32, "Text": " versus whatever would reverse resolve"}, {"Time_Start": 2554.32, "Time_End": 2555.82, "Text": " from the IP address and the IP header."}, {"Time_Start": 2556.46, "Time_End": 2557.3, "Text": " So in my opinion,"}, {"Time_Start": 2557.46, "Time_End": 2562.0, "Text": " In practical terms, there's really very little of value in that IP header."}, {"Time_Start": 2562.48, "Time_End": 2562.7200000000003, "Text": " Okay?"}, {"Time_Start": 2563.2, "Time_End": 2569.9, "Text": " So what I like to do is I like to pipe these packets as they're large using tail."}, {"Time_Start": 2570.08, "Time_End": 2570.18, "Text": " Tail."}, {"Time_Start": 2570.18, "Time_End": 2576.7400000000002, "Text": " That F through arc and strip away everything up to the first left angle bracket,"}, {"Time_Start": 2577.68, "Time_End": 2582.12, "Text": " which as it happens in SISLG packets, so far as I've seen them so far,"}, {"Time_Start": 2582.28, "Time_End": 2586.92, "Text": " doesn't show up until you hit the, um, the, um,"}, {"Time_Start": 2587.46, "Time_End": 2589.62, "Text": " What does that number refer to?"}, {"Time_Start": 2589.7200000000003, "Time_End": 2592.2200000000003, "Text": " I guess, um, message, excuse me?"}, {"Time_Start": 2593.62, "Time_End": 2594.66, "Text": " Process ID, thank you."}, {"Time_Start": 2594.8, "Time_End": 2595.34, "Text": " Process ID."}, {"Time_Start": 2596.54, "Time_End": 2598.52, "Text": " That's going to be the first, uh,"}, {"Time_Start": 2598.58, "Time_End": 2603.12, "Text": " left angle bracket that block encounters as it parses this packet."}, {"Time_Start": 2603.12, "Time_End": 2607.96, "Text": " And then I have it take everything after and including that left angle bracket"}, {"Time_Start": 2607.96, "Time_End": 2615.18, "Text": " to that string of equal plus, equal plus, equal plus that snort uses as a delimiter between packets."}, {"Time_Start": 2615.6, "Time_End": 2617.44, "Text": " So then what you wind up with is this."}, {"Time_Start": 2617.46, "Time_End": 2619.28, "Text": " same thing, but missing the first two lines."}, {"Time_Start": 2620.66, "Time_End": 2623.6, "Text": " You get slightly more compact logs that way."}, {"Time_Start": 2624.2, "Time_End": 2630.08, "Text": " So let's, uh, this is another slide, incidentally, that is not in, um, on the CDOM,"}, {"Time_Start": 2630.16, "Time_End": 2632.2400000000002, "Text": " but is on my website, the DefconX."}, {"Time_Start": 2632.2400000000002, "Time_End": 2633.44, "Text": "Wilmonkeys.org site."}, {"Time_Start": 2635.06, "Time_End": 2637.2200000000003, "Text": " Oh, that's right, because I did this one like yesterday."}, {"Time_Start": 2637.66, "Time_End": 2638.6, "Text": " It will be there."}, {"Time_Start": 2638.6, "Time_End": 2645.76, "Text": " It will be there, like, within 48 to 10, 24 hours."}, {"Time_Start": 2647.46, "Time_End": 2651.54, "Text": " Okay, so that's it."}, {"Time_Start": 2651.58, "Time_End": 2653.2400000000002, "Text": " I mean, that's really all there is, too."}, {"Time_Start": 2653.32, "Time_End": 2658.46, "Text": " At that point, now your self-logger will be sniffing the wire for log packets,"}, {"Time_Start": 2658.86, "Time_End": 2664.64, "Text": " stripping away, optionally stripping away the IP header and saving the data in a big file."}, {"Time_Start": 2666.36, "Time_End": 2672.6, "Text": " You can run multiple instances of snort if you want so that you can write those to different files."}, {"Time_Start": 2672.6, "Time_End": 2677.44, "Text": " You can, there's all kinds of different ways that you can, um, uh, fit this,"}, {"Time_Start": 2677.46, "Time_End": 2679.2, "Text": " to your own needs."}, {"Time_Start": 2679.2, "Time_End": 2685.7, "Text": " At this point, um, I'd like to open the floor to questions, comments, observations."}, {"Time_Start": 2685.7, "Time_End": 2686.46, "Text": " Let a rip."}, {"Time_Start": 2686.46, "Time_End": 2692.7, "Text": " It'd be a very simple living-net program to write a UDP generator that would just flood"}, {"Time_Start": 2692.7, "Time_End": 2694.34, "Text": " as normal as with fake record."}, {"Time_Start": 2694.34, "Time_End": 2696.1, "Text": " Not having to remove the box at all."}, {"Time_Start": 2696.1, "Time_End": 2696.2200000000003, "Text": " Yeah."}, {"Time_Start": 2696.2200000000003, "Time_End": 2698.2200000000003, "Text": " Yeah."}, {"Time_Start": 2698.2200000000003, "Time_End": 2705.06, "Text": " Um, the, the gentleman observed that it'd be really simple to write a packet, a program that would flood"}, {"Time_Start": 2705.06, "Time_End": 2707.28, "Text": " your network with bogus log packets."}, {"Time_Start": 2707.46, "Time_End": 2709.46, "Text": " what, fill up the server that way?"}, {"Time_Start": 2709.46, "Time_End": 2713.18, "Text": " Absolutely. That's true whether you've got a stealth logger or a regular"}, {"Time_Start": 2713.18, "Time_End": 2718.46, "Text": " centralized logger. That's, that's a problem that's inherent to remote logging."}, {"Time_Start": 2718.46, "Time_End": 2721.46, "Text": " So you're right. That's a problem."}, {"Time_Start": 2721.46, "Time_End": 2722.46, "Text": " The..."}, {"Time_Start": 2722.46, "Time_End": 2726.46, "Text": " I'm sorry, what, sir?"}, {"Time_Start": 2726.46, "Time_End": 2727.46, "Text": " What, sir?"}, {"Time_Start": 2727.46, "Time_End": 2730.46, "Text": " Yeah, if..."}, {"Time_Start": 2730.46, "Time_End": 2735.46, "Text": " This sermon pointed out that if you use a non-standard port number, then that's a little bit less obvious."}, {"Time_Start": 2735.46, "Time_End": 2737.44, "Text": " I mean, if you're filtering on"}, {"Time_Start": 2737.46, "Time_End": 2743.56, "Text": " port, I don't know, 999, then people can send, ports, packets sent to some other port"}, {"Time_Start": 2743.56, "Time_End": 2745.46, "Text": " will be dropped by SNOT. They won't be logged."}, {"Time_Start": 2745.46, "Time_End": 2749.46, "Text": " Are you not TCP-based log packages, though?"}, {"Time_Start": 2749.46, "Time_End": 2753.46, "Text": " You can use, you can certainly use TCP-based log packages, yes."}, {"Time_Start": 2753.46, "Time_End": 2756.46, "Text": " And that's the cool thing about syslog NG."}, {"Time_Start": 2756.46, "Time_End": 2761.46, "Text": " Syslog NG can let you define a destination that uses TCP rather than the UEP."}, {"Time_Start": 2761.46, "Time_End": 2766.46, "Text": " Again, you can use any port you want, and you get increased reliability."}, {"Time_Start": 2766.46, "Time_End": 2772.56, "Text": " you also get increased process overhead, but that's, you know, if it's a dedicated logger, that probably is not a problem."}, {"Time_Start": 2772.96, "Time_End": 2776.36, "Text": " So, yes, excellent observation. I should have mentioned that myself earlier."}, {"Time_Start": 2776.36, "Time_End": 2779.36, "Text": " You need heat-flood problem with the mentioned."}, {"Time_Start": 2779.36, "Time_End": 2782.46, "Text": " Just use, like, any filter, and that, to specify certain,"}, {"Time_Start": 2782.46, "Time_End": 2785.66, "Text": " until loading log, packets coming from certain IP addresses?"}, {"Time_Start": 2786.76, "Time_End": 2789.46, "Text": " Yeah, yeah, definitely. That's an excellent idea."}, {"Time_Start": 2790.46, "Time_End": 2795.64, "Text": " You could use IP tables, or for that matter, or IP chains,"}, {"Time_Start": 2795.64, "Time_End": 2805.74, "Text": " running locally on the stealth logger to filter out any packets not originating from your actual DMZ servers that are sending the logs."}, {"Time_Start": 2806.2799999999997, "Time_End": 2812.04, "Text": " Yeah. Now, if one of those gets owned, it can be used to do the flood, but if it doesn't, it can't."}, {"Time_Start": 2812.7999999999997, "Time_End": 2813.0, "Text": " Yes."}, {"Time_Start": 2813.3399999999997, "Time_End": 2818.16, "Text": " I'm going to say, when you were saying before the same thing applies, you already have the attack antinful, so do you really care?"}, {"Time_Start": 2818.3599999999997, "Time_End": 2819.64, "Text": " I don't just say no, first of all."}, {"Time_Start": 2820.1, "Time_End": 2825.62, "Text": " Yeah, I do, too. I mean, this is not a technique that will prevent any type of attack."}, {"Time_Start": 2825.64, "Time_End": 2833.68, "Text": " attack, right? Except specifically IP-based attacks on the stealth server itself."}, {"Time_Start": 2833.7599999999998, "Time_End": 2841.3599999999997, "Text": " That is to say IP attacks that are meant to actually compromise the box, gain access to it."}, {"Time_Start": 2842.08, "Time_End": 2845.68, "Text": " You are not going to prevent other types of weirdness happening on the wire."}, {"Time_Start": 2845.68, "Time_End": 2852.6, "Text": " You're just going to improve your odds of logging that activity or detecting it with an IDS probe."}, {"Time_Start": 2852.6, "Time_End": 2859.94, "Text": " This is really a last line of defense kind of technique, as remote logging and IDSR anyhow."}, {"Time_Start": 2860.8399999999997, "Time_End": 2861.06, "Text": " Yes."}, {"Time_Start": 2861.22, "Time_End": 2868.6, "Text": " An early slide had a parenthetical statement about something being on the name of the name of it."}, {"Time_Start": 2869.2799999999997, "Time_End": 2875.2, "Text": " Yeah. How do you protect your hosts from IP-based, how do you protect your loggers from IP-based attacks?"}, {"Time_Start": 2875.7599999999998, "Time_End": 2879.4, "Text": " By stealth logging, that's how. By not using an IP address."}, {"Time_Start": 2879.4, "Time_End": 2881.16, "Text": " It was a lame attempted to joke."}, {"Time_Start": 2881.2799999999997, "Time_End": 2881.8399999999997, "Text": " Sorry about that."}, {"Time_Start": 2882.6, "Time_End": 2885.36, "Text": " Other questions?"}, {"Time_Start": 2887.0, "Time_End": 2887.2999999999997, "Text": " Yes."}, {"Time_Start": 2892.0, "Time_End": 2893.36, "Text": " Yeah, could you use the same machine to do as a stored IDS logger and a SIS log?"}, {"Time_Start": 2894.1, "Time_End": 2898.88, "Text": " Yeah, can you use the same machine both as a stealth logger and as an IDS probe?"}, {"Time_Start": 2898.96, "Time_End": 2899.8199999999997, "Text": " Absolutely, yes."}, {"Time_Start": 2900.7599999999998, "Time_End": 2902.8399999999997, "Text": " That wouldn't scale for sour grapes."}, {"Time_Start": 2903.14, "Time_End": 2908.62, "Text": " You wouldn't want to do that on a really large 100-based T network with a bunch of really busy servers."}, {"Time_Start": 2909.18, "Time_End": 2912.58, "Text": " You wouldn't want to do it on, you know, a gigahertz ether."}, {"Time_Start": 2912.6, "Time_End": 2916.98, "Text": " that switch with a mirror port, you know, or gigabit, I mean, excuse me."}, {"Time_Start": 2918.36, "Time_End": 2921.44, "Text": " But something like mix-home network, yeah, that would work."}, {"Time_Start": 2922.4, "Time_End": 2926.42, "Text": " There might be certain advantages to separating the functionality, but I guess I kind of doubt it."}, {"Time_Start": 2926.64, "Time_End": 2932.2999999999997, "Text": " See, the thing is, I guess the reason my whole mindset is that you dedicate a host to being your stealth"}, {"Time_Start": 2932.2999999999997, "Time_End": 2937.44, "Text": " logger is, because I've got really old slow hardware at home that I use for this kind of thing."}, {"Time_Start": 2938.3199999999997, "Time_End": 2939.24, "Text": " So, that mirror not."}, {"Time_Start": 2939.6, "Time_End": 2941.5, "Text": " Oh, here's the guy with the high-end switches."}, {"Time_Start": 2941.5, "Time_End": 2942.48, "Text": " Yeah, what do you want?"}, {"Time_Start": 2942.6, "Time_End": 2950.46, "Text": " Yeah, you could do that point in the static address at a specific app,"}, {"Time_Start": 2950.46, "Time_End": 2954.46, "Text": " yeah, you could do that."}, {"Time_Start": 2954.64, "Time_End": 2955.94, "Text": " That's a really good suggestion."}, {"Time_Start": 2956.2999999999997, "Time_End": 2962.96, "Text": " Rather than, if you didn't want to use a bogus IP address in the way that I described,"}, {"Time_Start": 2963.3399999999997, "Time_End": 2967.88, "Text": " could you use, could you map your static ARP address, excuse me,"}, {"Time_Start": 2968.08, "Time_End": 2971.68, "Text": " your static ARP entry to FF, FF, FF, FF, FF."}, {"Time_Start": 2972.6, "Time_End": 2979.66, "Text": " FF. Yes, you definitely could. And at that point, your log packets would be broadcast,"}, {"Time_Start": 2980.02, "Time_End": 2986.36, "Text": " even on a switch. Oh, I see. Oh, that's so cool. I'm really glad I came today."}, {"Time_Start": 2987.98, "Time_End": 2992.62, "Text": " You win some hardware, sir, because I think, I get the impression that you don't have enough"}, {"Time_Start": 2992.62, "Time_End": 2993.52, "Text": " really old hardware."}, {"Time_Start": 2993.52, "Time_End": 3002.46, "Text": " So, what is this? This one has got. This one has got"}, {"Time_Start": 3002.46, "Time_End": 3008.12, "Text": " 20 ports. Ooh, it's got serial ports. You can't have got T1s to the sucker. Except, you know,"}, {"Time_Start": 3008.2400000000002, "Time_End": 3013.64, "Text": " I'm going to give you the really cool one. It's got gazillions of etherports. Oh, my goodness."}, {"Time_Start": 3016.02, "Time_End": 3019.5, "Text": " And at no extra charge, you get this Ethernet module, too."}, {"Time_Start": 3021.98, "Time_End": 3023.28, "Text": " Gee, I hope I didn't break it."}, {"Time_Start": 3024.78, "Time_End": 3027.5, "Text": " It won't be replacing my 36.60 any time soon."}, {"Time_Start": 3028.94, "Time_End": 3030.92, "Text": " Ah, but it could be a backup to it, couldn't it?"}, {"Time_Start": 3032.46, "Time_End": 3039.96, "Text": " Ooh, I shudder to think what airport security would think of that thing."}, {"Time_Start": 3045.2200000000003, "Time_End": 3048.54, "Text": " Well, it's got these fingerprints on it. Are they my fingerprints?"}, {"Time_Start": 3050.14, "Time_End": 3053.52, "Text": " You don't know. There could just be gummy bear fingerprints, couldn't they?"}, {"Time_Start": 3055.18, "Time_End": 3058.32, "Text": " Okay, well, anything else? I guess I'm supposed to shut up soon. Yeah?"}, {"Time_Start": 3058.92, "Time_End": 3061.52, "Text": " I'd like to thank you for not using Microsoft PowerPoint."}, {"Time_Start": 3062.46, "Time_End": 3065.36, "Text": " It is my pleasure to not use Microsoft PowerPoint."}, {"Time_Start": 3070.96, "Time_End": 3073.62, "Text": " But then I'd have to pay for Microsoft PowerPoint, weren't I?"}, {"Time_Start": 3074.08, "Time_End": 3076.62, "Text": " I mean, have we not established that I'm a total scrooge?"}, {"Time_Start": 3078.76, "Time_End": 3080.7200000000003, "Text": " No real virtue there, I'm afraid."}, {"Time_Start": 3083.1, "Time_End": 3083.54, "Text": " Yes."}, {"Time_Start": 3086.76, "Time_End": 3087.44, "Text": " Come again?"}, {"Time_Start": 3089.14, "Time_End": 3090.28, "Text": " Oh, of course."}, {"Time_Start": 3090.28, "Time_End": 3092.44, "Text": " The schedule changes are, as far as."}, {"Time_Start": 3092.46, "Time_End": 3096.64, "Text": " follows. Next, as scheduled, will be"}, {"Time_Start": 3096.64, "Time_End": 3100.66, "Text": " Huagongxir, who, and if I mispronounced it, I really"}, {"Time_Start": 3100.66, "Time_End": 3102.76, "Text": " apologize, who will be presenting on lids,"}, {"Time_Start": 3103.54, "Time_End": 3106.82, "Text": " which is really cool. So I highly recommend you stick around for that."}, {"Time_Start": 3107.2, "Time_End": 3110.7200000000003, "Text": " If you're interested in kernel level, IP protection,"}, {"Time_Start": 3111.12, "Time_End": 3112.7, "Text": " or actually the system protection,"}, {"Time_Start": 3112.86, "Time_End": 3113.9, "Text": " it goes way beyond a snowworking."}, {"Time_Start": 3115.26, "Time_End": 3118.56, "Text": " And then after that, rather than Thomas Wood"}, {"Time_Start": 3118.56, "Time_End": 3121.48, "Text": " doing next generation data forensics,"}, {"Time_Start": 3121.48, "Time_End": 3122.44, "Text": " we will instead have,"}, {"Time_Start": 3122.46, "Time_End": 3126.94, "Text": " T. Dragon, who will speak about making non-portable systems portable."}, {"Time_Start": 3128.1, "Time_End": 3132.32, "Text": " And, oh, and also, I've skipped this one before."}, {"Time_Start": 3132.82, "Time_End": 3136.82, "Text": " Fuzzy, or is it Fuzzy, will not be speaking on shell card."}, {"Time_Start": 3137.2400000000002, "Time_End": 3143.3, "Text": " Instead, the ever popular speaker, I think I met this guy once, TBA, will be presenting."}, {"Time_Start": 3145.7200000000003, "Time_End": 3147.3, "Text": " Greets to TBA if he's here."}, {"Time_Start": 3147.3, "Time_End": 3147.8, "Text": " Huh?"}, {"Time_Start": 3149.18, "Time_End": 3150.62, "Text": " Oh, he's in the third room."}, {"Time_Start": 3150.88, "Time_End": 3151.96, "Text": " That one, uh,"}, {"Time_Start": 3152.46, "Time_End": 3158.9, "Text": " And incidentally, that the one that Fazi was scheduled for was for 1 o'clock."}, {"Time_Start": 3159.44, "Time_End": 3164.12, "Text": " In the third one, we'll be as scheduled Nate Wirtchaffer doing a thing on biometrics."}, {"Time_Start": 3165.96, "Time_End": 3167.68, "Text": " What is his subject?"}, {"Time_Start": 3171.02, "Time_End": 3171.88, "Text": " It's secret."}, {"Time_Start": 3173.16, "Time_End": 3174.36, "Text": " It's undisclosed."}, {"Time_Start": 3174.54, "Time_End": 3174.76, "Text": " Yeah."}, {"Time_Start": 3175.7200000000003, "Time_End": 3179.38, "Text": " Anyone need, like, directions at the airport, the current time."}, {"Time_Start": 3180.34, "Time_End": 3181.98, "Text": " Something related in my talk."}, {"Time_Start": 3182.46, "Time_End": 3184.5, "Text": " Um, afterwards, oh."}, {"Time_Start": 3191.58, "Time_End": 3192.2400000000002, "Text": " Thanks a lot."}, {"Time_Start": 3192.3, "Time_End": 3193.14, "Text": " Thanks a lot for coming."}, {"Time_Start": 3193.26, "Time_End": 3193.94, "Text": " Thanks for getting up."}, {"Time_Start": 3196.68, "Time_End": 3197.86, "Text": " Enjoy the rest of you to stay."}, {"Time_Start": 3198.28, "Time_End": 3198.96, "Text": " I will be."}]}