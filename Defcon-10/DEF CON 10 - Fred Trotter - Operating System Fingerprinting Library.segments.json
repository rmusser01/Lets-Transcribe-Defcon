{"segments": [{"Time_Start": 0.0, "Time_End": 2.16, "Text": " As you've just been hearing, everybody hear me clearly?"}, {"Time_Start": 6.48, "Time_End": 10.32, "Text": " X, KSO, MAP, most recently, Wing,"}, {"Time_Start": 10.94, "Time_End": 14.620000000000001, "Text": " these are examples of operating system tests."}, {"Time_Start": 15.16, "Time_End": 18.32, "Text": " Methods to detect what operating system is running on a computer"}, {"Time_Start": 18.32, "Time_End": 21.36, "Text": " over the internet or on the same land from another computer"}, {"Time_Start": 21.36, "Time_End": 25.82, "Text": " by testing how it looks at the network."}, {"Time_Start": 26.060000000000002, "Time_End": 29.94, "Text": " Now that can mean looking at its TCVIP stack or its ICMP,"}, {"Time_Start": 30.0, "Time_End": 34.9, "Text": " implementation, or maybe its services, or its services pattern."}, {"Time_Start": 34.9, "Time_End": 37.2, "Text": " There's lots of ways to do that."}, {"Time_Start": 38.1, "Time_End": 43.6, "Text": " Up till now, though, you have had to access these things in a tool,"}, {"Time_Start": 44.22, "Time_End": 50.900000000000006, "Text": " such as the X tool, X probe 2 tool, or NMAP, or KSO, or whatever,"}, {"Time_Start": 50.900000000000006, "Time_End": 53.46, "Text": " or Wring, I don't know if any, how many people have looked at Ring?"}, {"Time_Start": 55.5, "Time_End": 56.1, "Text": " Seen Ring?"}, {"Time_Start": 56.260000000000005, "Time_End": 56.900000000000006, "Text": " Okay, cool."}, {"Time_Start": 58.08, "Time_End": 58.480000000000004, "Text": " Some."}, {"Time_Start": 60.0, "Time_End": 79.0, "Text": " Now I start with, that's why you should not leave me in the middle of this thing, is I'm going to show you what I've been doing."}, {"Time_Start": 79.0, "Time_End": 85.0, "Text": " This is a program that I've written using my library."}, {"Time_Start": 85.0, "Time_End": 89.98, "Text": " Now, right now the library works in C and Jolly."}, {"Time_Start": 90.0, "Time_End": 92.86, "Text": " you're looking at Java because Java's easy to make a GUI in."}, {"Time_Start": 95.02, "Time_End": 104.0, "Text": " What you see in the bottom right window is loads of modified versions of the inMAP database and the KSAR database."}, {"Time_Start": 104.6, "Time_End": 111.32, "Text": " Very soon, once I look at X probe 2 and look at its database, since it's now in a file, they'll be in there too."}, {"Time_Start": 111.62, "Time_End": 117.36, "Text": " It's a list of all the operating systems that you find in those databases."}, {"Time_Start": 117.36, "Time_End": 122.56, "Text": " And then over here, you'll find little checkboxes for the tests."}, {"Time_Start": 123.02, "Time_End": 127.36, "Text": " So far, in Java, I've implemented the Mango Packet tests."}, {"Time_Start": 128.76, "Time_End": 130.16, "Text": " Of in that fame and of Koso fame."}, {"Time_Start": 131.12, "Time_End": 133.54, "Text": " And I've also done the X stuff."}, {"Time_Start": 134.16, "Time_End": 136.74, "Text": " Next is going to be the T-sequence test and a ring."}, {"Time_Start": 138.68, "Time_End": 140.7, "Text": " So let's see if I can get it to work the first time."}, {"Time_Start": 147.36, "Time_End": 158.82000000000002, "Text": " All right. Now, earlier you were mentioning somebody here was mentioning the fact that X-121 used a tree,"}, {"Time_Start": 159.44000000000003, "Time_End": 166.60000000000002, "Text": " used a sit-one packet and then based on a tree that it had in its memory, would send the next packet based on the result of the first packet,"}, {"Time_Start": 166.74, "Time_End": 173.78000000000003, "Text": " and as a result would send in total less packets than in-mat, or I think any other test at the time."}, {"Time_Start": 174.4, "Time_End": 177.34, "Text": " And as a result, it could limit the number of packets."}, {"Time_Start": 177.36, "Time_End": 183.28, "Text": " consent, reducing its IDS profile, reducing, increasing speed, all these kind of things."}, {"Time_Start": 183.82000000000002, "Time_End": 185.56, "Text": " So what if you could do the same thing with InMAP?"}, {"Time_Start": 185.66000000000003, "Time_End": 191.24, "Text": " What if you could run the NMAP, one step at a time, and then use the results that you got back."}, {"Time_Start": 191.56, "Time_End": 196.86, "Text": " Since EnMAP runs, UMAP alone has the seven-Mangle packet tests that you see there,"}, {"Time_Start": 196.86, "Time_End": 204.86, "Text": " and a T-Sequence test, which tests initial sequence numbers, and a poor and reachable UDP test."}, {"Time_Start": 205.36, "Time_End": 207.24, "Text": " What if you could use those one at a time?"}, {"Time_Start": 207.36, "Time_End": 212.58, "Text": " Well, this program right here shows what happens if you do that."}, {"Time_Start": 213.18, "Time_End": 219.74, "Text": " If I run the MAP 4 and the KSO2 tests, the source board of 10,000,"}, {"Time_Start": 222.68, "Time_End": 223.96, "Text": " I hope this is open."}, {"Time_Start": 225.0, "Time_End": 225.94000000000003, "Text": " I hope this is closed."}, {"Time_Start": 229.08, "Time_End": 233.70000000000002, "Text": " Now, a lot of the values in the tests are based on starting sequence number,"}, {"Time_Start": 233.88000000000002, "Time_End": 235.08, "Text": " and this allows you to play with that."}, {"Time_Start": 237.36, "Time_End": 240.36, "Text": " Now, no suitable device found."}, {"Time_Start": 267.36, "Time_End": 273.92, "Text": " the fact that I'm going to move on now anyways, and I'll come back to that."}, {"Time_Start": 276.48, "Time_End": 278.56, "Text": " But that's the kind of thing that you can do."}, {"Time_Start": 279.26, "Time_End": 282.32, "Text": " I'll just keep that up since I think it's cool."}, {"Time_Start": 286.88, "Time_End": 292.16, "Text": " That's the kind of thing you can do when you're able to access the tests in a systematic way."}, {"Time_Start": 293.2, "Time_End": 297.04, "Text": " So hopefully now you should be convinced that you might want to hear the lesson presentation."}, {"Time_Start": 297.36, "Time_End": 299.6, "Text": " Time again, easily don't feel free to leave."}, {"Time_Start": 306.32, "Time_End": 311.74, "Text": " Especially since I know that some of you who dream and pearl"}, {"Time_Start": 311.74, "Time_End": 316.42, "Text": " could be very upset with the fact that you're not getting coal code right now."}, {"Time_Start": 316.68, "Time_End": 317.34000000000003, "Text": " I understand."}, {"Time_Start": 317.64, "Time_End": 318.34000000000003, "Text": " I feel your pain."}, {"Time_Start": 321.32, "Time_End": 321.78000000000003, "Text": " Okay."}, {"Time_Start": 322.32, "Time_End": 322.88, "Text": " Another thing?"}, {"Time_Start": 323.24, "Time_End": 325.32, "Text": " The TGZLM the CD is useless."}, {"Time_Start": 325.32, "Time_End": 326.16, "Text": " Go to my website."}, {"Time_Start": 327.36, "Time_End": 330.36, "Text": " All right, who is this code for?"}, {"Time_Start": 330.36, "Time_End": 333.36, "Text": " Well, the answer is kind of everybody."}, {"Time_Start": 333.36, "Time_End": 337.36, "Text": " If you're a hacker, you won't be able to write a script that says,"}, {"Time_Start": 337.36, "Time_End": 342.36, "Text": " don't run my exploit on anything except an exploitable box."}, {"Time_Start": 342.36, "Time_End": 347.36, "Text": " If you were able to detect that you can sort out, Windows 2000,"}, {"Time_Start": 347.36, "Time_End": 351.36, "Text": " version this, rev this, with this service running,"}, {"Time_Start": 351.36, "Time_End": 353.36, "Text": " and this version, before you ran your tests,"}, {"Time_Start": 353.36, "Time_End": 356.36, "Text": " what you'd be able to do is have a mini vulnerability,"}, {"Time_Start": 356.36, "Time_End": 360.36, "Text": " vulnerability test right before you actually ran your exploit."}, {"Time_Start": 360.36, "Time_End": 365.36, "Text": " Which means that instead of like running a system where you scan the host,"}, {"Time_Start": 365.36, "Time_End": 368.36, "Text": " you figure out what operating system is running, you figure out what ports are open,"}, {"Time_Start": 368.36, "Time_End": 372.36, "Text": " you research what hacks were available, you could just run the hack and it would stop"}, {"Time_Start": 372.36, "Time_End": 374.36, "Text": " if it wasn't the right operating system."}, {"Time_Start": 374.36, "Time_End": 376.36, "Text": " It would just not run."}, {"Time_Start": 376.36, "Time_End": 380.36, "Text": " Only then, if you're writing a worm, I'm not recommending that you write a worm."}, {"Time_Start": 380.36, "Time_End": 386.34000000000003, "Text": " But if you're writing a worm, you might not want to scan Linux house over and over and"}, {"Time_Start": 386.36, "Time_End": 388.86, "Text": " over and over again like you've all seen in your logs."}, {"Time_Start": 388.86, "Time_End": 391.86, "Text": " You might just want to scan Windows 2000 boxes."}, {"Time_Start": 391.86, "Time_End": 395.36, "Text": " Well, by including all a portion of an operating system thing"}, {"Time_Start": 395.36, "Time_End": 398.36, "Text": " to bring library in your code, you can do that."}, {"Time_Start": 398.36, "Time_End": 400.36, "Text": " White hats."}, {"Time_Start": 400.36, "Time_End": 404.86, "Text": " The same reason the black hat is interested in what operating system is running on your network,"}, {"Time_Start": 404.86, "Time_End": 407.86, "Text": " you should be interested in what operating system is running on your network."}, {"Time_Start": 407.86, "Time_End": 411.36, "Text": " Vulnerities are based on operating system and service version."}, {"Time_Start": 411.36, "Time_End": 415.36, "Text": " Not all versions of vulnerable, sometimes it's all of PSD."}, {"Time_Start": 415.36, "Time_End": 415.86, "Text": " Sometimes it's all of PSD."}, {"Time_Start": 415.86, "Time_End": 417.86, "Text": " Sometimes it's just 3BSD. Sometimes it's just Linux."}, {"Time_Start": 417.86, "Time_End": 419.86, "Text": " Sometimes it's just Linux 2-2."}, {"Time_Start": 419.86, "Time_End": 423.86, "Text": " You care because you're going to be able to get broken into"}, {"Time_Start": 423.86, "Time_End": 427.86, "Text": " based on what you're running on your network."}, {"Time_Start": 427.86, "Time_End": 430.86, "Text": " Now, on the other hand, besides from the security perspective,"}, {"Time_Start": 430.86, "Time_End": 435.86, "Text": " it would be nice for administrators to know what it's running on the network."}, {"Time_Start": 435.86, "Time_End": 440.86, "Text": " So these are just the reasons that you are interested in operating system fingerprinting."}, {"Time_Start": 440.86, "Time_End": 444.86, "Text": " Asher's talk is so deep that he just kind of goes into it."}, {"Time_Start": 444.86, "Time_End": 451.86, "Text": " into it and he doesn't realize, I'm sorry, he doesn't talk to why people are enjoying his code."}, {"Time_Start": 451.86, "Time_End": 457.86, "Text": " Most of the people who enjoy his code don't actually do bad things with it, I hope."}, {"Time_Start": 457.86, "Time_End": 461.86, "Text": " Okay, this is a deep knowledge track about beta code."}, {"Time_Start": 461.86, "Time_End": 465.86, "Text": " If you're here expecting something you can go and then program in your application tomorrow,"}, {"Time_Start": 465.86, "Time_End": 471.86, "Text": " again, with apparel people, sorry, not going to happen."}, {"Time_Start": 471.86, "Time_End": 473.86, "Text": " Okay, why a library as opposed to a tool?"}, {"Time_Start": 473.86, "Time_End": 475.86, "Text": " as opposed to a tool."}, {"Time_Start": 475.86, "Time_End": 478.86, "Text": " Well, this way you can write things for yourself"}, {"Time_Start": 478.86, "Time_End": 480.86, "Text": " that are operating system sensitive."}, {"Time_Start": 480.86, "Time_End": 482.86, "Text": " Let's say you don't want to write a hack."}, {"Time_Start": 482.86, "Time_End": 486.86, "Text": " Maybe you want your web page to just be displayed for Windows 98."}, {"Time_Start": 486.86, "Time_End": 491.86, "Text": " Or maybe you want your web page just to be displayed for Windows."}, {"Time_Start": 491.86, "Time_End": 492.86, "Text": " As all of them."}, {"Time_Start": 492.86, "Time_End": 497.86, "Text": " Maybe you just want to be able to display one administrative homepage for Windows,"}, {"Time_Start": 497.86, "Time_End": 499.86, "Text": " one for Linux, one for this."}, {"Time_Start": 499.86, "Time_End": 503.86, "Text": " And you want that web page, hopefully we'll be talking about like,"}, {"Time_Start": 503.86, "Time_End": 507.86, "Text": " the Apache module of planning, you want that web page to be able to say,"}, {"Time_Start": 507.86, "Time_End": 511.86, "Text": " hey, I'm going to give you this content based on what you are."}, {"Time_Start": 511.86, "Time_End": 513.86, "Text": " That would be a very, very convenient way to hand out patches."}, {"Time_Start": 513.86, "Time_End": 516.86, "Text": " You could hand out exactly the patch that needs to be handed out"}, {"Time_Start": 516.86, "Time_End": 519.86, "Text": " to exactly the person that needs that patch."}, {"Time_Start": 519.86, "Time_End": 524.86, "Text": " It means less clicks, which administers of thousands of the users love."}, {"Time_Start": 524.86, "Time_End": 529.86, "Text": " So let's talk about the problems with tools, the problems with programs right now."}, {"Time_Start": 529.86, "Time_End": 531.86, "Text": " There's a bunch of tests, right?"}, {"Time_Start": 531.86, "Time_End": 532.86, "Text": " Some of the other case of tests."}, {"Time_Start": 532.86, "Time_End": 534.86, "Text": " caseo tests, some of them are X probe tests."}, {"Time_Start": 534.86, "Time_End": 536.86, "Text": " Some of them are, you know,"}, {"Time_Start": 536.86, "Time_End": 538.86, "Text": " ring, some of them are service tests."}, {"Time_Start": 538.86, "Time_End": 541.86, "Text": " Well, you have different algorithms that are using these things"}, {"Time_Start": 541.86, "Time_End": 542.86, "Text": " different ways."}, {"Time_Start": 542.86, "Time_End": 547.86, "Text": " Algorithm A by Afer and Fyodor is now using Fuzzy."}, {"Time_Start": 547.86, "Time_End": 550.86, "Text": " So what's the most sensitive and advanced algorithm out there?"}, {"Time_Start": 550.86, "Time_End": 552.86, "Text": " And that just uses a brute force."}, {"Time_Start": 552.86, "Time_End": 556.86, "Text": " It runs all the tests, all the time, and can come back with pretty good results usually."}, {"Time_Start": 556.86, "Time_End": 561.86, "Text": " So you've got some more advanced algorithms."}, {"Time_Start": 561.86, "Time_End": 566.86, "Text": " But at the same time, you want to be able to have more control over your algorithm."}, {"Time_Start": 566.86, "Time_End": 570.86, "Text": " If you're programming, say, Nessus, you might want to do different things"}, {"Time_Start": 570.86, "Time_End": 575.86, "Text": " and test differently than you are if you're doing another scanner."}, {"Time_Start": 575.86, "Time_End": 578.86, "Text": " If you're doing a web page for instance, you might want to scan another way."}, {"Time_Start": 578.86, "Time_End": 582.86, "Text": " If you're on a friendly network and you're responsible for a network and you're scanning it,"}, {"Time_Start": 582.86, "Time_End": 588.86, "Text": " you definitely don't want to do tests that are going to possibly hang up any operating systems."}, {"Time_Start": 588.86, "Time_End": 590.86, "Text": " There are operating systems, older ones, that are working."}, {"Time_Start": 590.86, "Time_End": 594.86, "Text": " other ones, that will hang up on different versions of MAPs test."}, {"Time_Start": 594.86, "Time_End": 595.86, "Text": " It's just a version of a DOS."}, {"Time_Start": 595.86, "Time_End": 597.86, "Text": " You run in MAP line and it turns it off."}, {"Time_Start": 597.86, "Time_End": 598.86, "Text": " This is a bad thing."}, {"Time_Start": 598.86, "Time_End": 602.86, "Text": " So you can have polite, you can have stealthy, things that don't get detected."}, {"Time_Start": 602.86, "Time_End": 605.86, "Text": " All these algorithms, though, are meta-tests."}, {"Time_Start": 605.86, "Time_End": 607.86, "Text": " They're above the test level."}, {"Time_Start": 607.86, "Time_End": 609.86, "Text": " They're not actually involved with the test themselves."}, {"Time_Start": 609.86, "Time_End": 611.86, "Text": " They're above the test."}, {"Time_Start": 611.86, "Time_End": 616.86, "Text": " And these kinds of algorithms have the problems"}, {"Time_Start": 616.86, "Time_End": 618.86, "Text": " that Avery was just talking about."}, {"Time_Start": 618.86, "Time_End": 620.86, "Text": " When he was saying, you know, how do you deal,"}, {"Time_Start": 620.86, "Time_End": 624.86, "Text": " with the results if you're talking about a load balance test."}, {"Time_Start": 624.86, "Time_End": 627.86, "Text": " How do you deal with the results if you're talking about this situation?"}, {"Time_Start": 627.86, "Time_End": 630.86, "Text": " How do you deal with the results in this situation, this situation?"}, {"Time_Start": 630.86, "Time_End": 633.86, "Text": " All that's dealing with interpreting the results with test,"}, {"Time_Start": 633.86, "Time_End": 636.86, "Text": " which is a metal-level algorithm issue."}, {"Time_Start": 636.86, "Time_End": 642.86, "Text": " So what I'm trying to do is provide a way for you to get very easy access to the test themselves"}, {"Time_Start": 642.86, "Time_End": 646.86, "Text": " so you can do whatever you want on top with an algorithm."}, {"Time_Start": 646.86, "Time_End": 649.86, "Text": " Okay, why not a library?"}, {"Time_Start": 649.86, "Time_End": 650.86, "Text": " Well, I'm always a library."}, {"Time_Start": 650.86, "Time_End": 651.86, "Text": " is going to be playing catch-up."}, {"Time_Start": 651.86, "Time_End": 653.86, "Text": " I'm not going to be able to write new tests."}, {"Time_Start": 653.86, "Time_End": 654.86, "Text": " I'm not going to be able to write,"}, {"Time_Start": 654.86, "Time_End": 655.86, "Text": " you know, zippy-dood out of things."}, {"Time_Start": 655.86, "Time_End": 659.86, "Text": " Maybe someday, like I'll be able to come up with something new."}, {"Time_Start": 659.86, "Time_End": 661.86, "Text": " But in June, people like Eiffel, Firedor,"}, {"Time_Start": 661.86, "Time_End": 664.86, "Text": " these are the people who are going to be writing the new tests."}, {"Time_Start": 664.86, "Time_End": 665.86, "Text": " They're going to be coming up with new algorithms."}, {"Time_Start": 665.86, "Time_End": 667.86, "Text": " They're going to be coming up with new algorithms."}, {"Time_Start": 667.86, "Time_End": 669.86, "Text": " They're going to be doing the new cool stuff."}, {"Time_Start": 669.86, "Time_End": 672.86, "Text": " What's in the library is going to be the yesterday old stuff,"}, {"Time_Start": 672.86, "Time_End": 674.86, "Text": " but just in a way that you can access."}, {"Time_Start": 674.86, "Time_End": 677.86, "Text": " Right, and this is not going to be a tool."}, {"Time_Start": 677.86, "Time_End": 679.86, "Text": " Like, I'm never going to hand out something that's going to be particular."}, {"Time_Start": 679.86, "Time_End": 682.86, "Text": " something that's going to be particularly useful to you right now."}, {"Time_Start": 682.86, "Time_End": 684.86, "Text": " If you're a script kitty, you're not going to get anything."}, {"Time_Start": 684.86, "Time_End": 687.86, "Text": " You can run on the command line."}, {"Time_Start": 687.86, "Time_End": 692.86, "Text": " Okay, let's talk about a little bit about the background of operating system fingerprinting."}, {"Time_Start": 692.86, "Time_End": 696.86, "Text": " The first grandfather of all fingerprintings is Koso."}, {"Time_Start": 696.86, "Time_End": 699.86, "Text": " How many people have used or horrid of Kayso?"}, {"Time_Start": 699.86, "Time_End": 702.86, "Text": " How many of you like Koso?"}, {"Time_Start": 702.86, "Time_End": 704.86, "Text": " Okay."}, {"Time_Start": 704.86, "Time_End": 705.86, "Text": " Less."}, {"Time_Start": 705.86, "Time_End": 706.86, "Text": " That's first generation."}, {"Time_Start": 706.86, "Time_End": 707.86, "Text": " Why was the first generation?"}, {"Time_Start": 707.86, "Time_End": 708.86, "Text": " It was the first operating system fingerprinting."}, {"Time_Start": 708.86, "Time_End": 718.86, "Text": " operating system fingerprinting code, and I'll talk about this a little later, to pool the database outside of the program itself, so that the database of fingerprints and the logic to fingerprint them were separate."}, {"Time_Start": 718.86, "Time_End": 725.86, "Text": " After that, we have the passive side, PLS, siphon, stuff that's looking at traffic doing fingerprinting."}, {"Time_Start": 725.86, "Time_End": 732.86, "Text": " Right now, I'm not implementing these tests, and these are probably the last test that I use, and the reason is that they're not particularly useful for administrators."}, {"Time_Start": 732.86, "Time_End": 737.86, "Text": " If you're interested in doing passive fingerprinting, usually you're going to be a person."}, {"Time_Start": 737.86, "Time_End": 739.86, "Text": " a person who's interested in not being seen."}, {"Time_Start": 739.86, "Time_End": 743.86, "Text": " The other case is when you're interested in seeing what traffic is going out of your network."}, {"Time_Start": 743.86, "Time_End": 746.86, "Text": " And in that case, I think the fingerprinting, passive fingerprinting stuff,"}, {"Time_Start": 746.86, "Time_End": 748.86, "Text": " that's going to become available in snort."}, {"Time_Start": 748.86, "Time_End": 751.86, "Text": " It's going to be far better than what I could do real quick."}, {"Time_Start": 751.86, "Time_End": 753.86, "Text": " So I'm going to focus on the left side of the map here."}, {"Time_Start": 753.86, "Time_End": 755.86, "Text": " So you have inMAP."}, {"Time_Start": 755.86, "Time_End": 759.86, "Text": " InMAP is the Seminole operating system fingerprinting."}, {"Time_Start": 759.86, "Time_End": 763.86, "Text": " And the reason is, is it's the first to treat it as a real science."}, {"Time_Start": 763.86, "Time_End": 766.86, "Text": " If I don't use a statistical test,"}, {"Time_Start": 766.86, "Time_End": 771.86, "Text": " test, he used mangled packet tests, he used UDP tests."}, {"Time_Start": 771.86, "Time_End": 775.86, "Text": " That's a pretty broad spectrum of ways to guess at operating systems"}, {"Time_Start": 775.86, "Time_End": 777.86, "Text": " to use a test."}, {"Time_Start": 777.86, "Time_End": 779.86, "Text": " And the other thing that he did that's very significant"}, {"Time_Start": 779.86, "Time_End": 784.86, "Text": " is that he tested lots and lots and lots of operating systems."}, {"Time_Start": 784.86, "Time_End": 787.86, "Text": " If you've got OpenVSD running on a little Macintosh"}, {"Time_Start": 787.86, "Time_End": 791.86, "Text": " like they had last year here, you might be able to get him out to pick it up."}, {"Time_Start": 791.86, "Time_End": 793.86, "Text": " You never know what's going to be in a database though,"}, {"Time_Start": 793.86, "Time_End": 795.86, "Text": " and that's a complaint that people like A4 had been made."}, {"Time_Start": 795.86, "Time_End": 797.86, "Text": " that people like Afrid have been pointing out"}, {"Time_Start": 797.86, "Time_End": 799.86, "Text": " because that database is so huge"}, {"Time_Start": 799.86, "Time_End": 801.86, "Text": " that it really is becoming unmanageable and kind of useless,"}, {"Time_Start": 801.86, "Time_End": 803.86, "Text": " like what he was talking about for the printers."}, {"Time_Start": 803.86, "Time_End": 805.86, "Text": " I mean, it's very difficult when you've got"}, {"Time_Start": 805.86, "Time_End": 808.86, "Text": " 20 signatures, 10 signatures for HP printers,"}, {"Time_Start": 808.86, "Time_End": 810.86, "Text": " and they all come up."}, {"Time_Start": 810.86, "Time_End": 811.86, "Text": " That's just not useful."}, {"Time_Start": 811.86, "Time_End": 813.86, "Text": " Okay, second generation is X."}, {"Time_Start": 813.86, "Time_End": 817.86, "Text": " X was the first test to use,"}, {"Time_Start": 817.86, "Time_End": 821.86, "Text": " to not send all the packets at once."}, {"Time_Start": 821.86, "Time_End": 824.86, "Text": " It made decisions based on previous tests"}, {"Time_Start": 824.86, "Time_End": 827.26, "Text": " about what test to do next."}, {"Time_Start": 827.46, "Time_End": 829.0600000000001, "Text": " The problem with that is it was static."}, {"Time_Start": 829.5600000000001, "Time_End": 832.1800000000001, "Text": " That means that the tree was hard coding."}, {"Time_Start": 833.3000000000001, "Time_End": 835.98, "Text": " So you had the tests and then you had the tree,"}, {"Time_Start": 836.52, "Time_End": 839.86, "Text": " but just like the early versions of fingerprinting software"}, {"Time_Start": 839.86, "Time_End": 842.42, "Text": " had both tests and algorithm inside the code,"}, {"Time_Start": 843.32, "Time_End": 848.22, "Text": " the tree and the tests both need to be outside the code."}, {"Time_Start": 848.22, "Time_End": 851.02, "Text": " So the algorithm for choosing what tests to do when"}, {"Time_Start": 851.02, "Time_End": 854.7, "Text": " and the test themselves,"}, {"Time_Start": 854.86, "Time_End": 855.86, "Text": " to be configurable."}, {"Time_Start": 855.86, "Time_End": 857.86, "Text": " So that makes it a second generation."}, {"Time_Start": 857.86, "Time_End": 859.86, "Text": " Now, third generation is X probe too,"}, {"Time_Start": 859.86, "Time_End": 862.86, "Text": " which I didn't know a whole lot about until today."}, {"Time_Start": 862.86, "Time_End": 868.86, "Text": " So that code is addressing a lot of the problems with X,"}, {"Time_Start": 868.86, "Time_End": 873.86, "Text": " which is making it the most advanced fingerprinting system available."}, {"Time_Start": 873.86, "Time_End": 875.86, "Text": " Now, once he does all the things that he's planning to,"}, {"Time_Start": 875.86, "Time_End": 877.86, "Text": " it will probably be creating the crop."}, {"Time_Start": 877.86, "Time_End": 879.86, "Text": " It will be the tool you want to use"}, {"Time_Start": 879.86, "Time_End": 882.86, "Text": " because it'll probably incorporate a lot of the tests"}, {"Time_Start": 882.86, "Time_End": 883.86, "Text": " that MAP is using."}, {"Time_Start": 883.86, "Time_End": 884.86, "Text": " The T-Squence test."}, {"Time_Start": 884.86, "Time_End": 887.86, "Text": " these kinds of things, hopefully what I'll be able to do,"}, {"Time_Start": 887.86, "Time_End": 890.86, "Text": " is look at their API, the one that he was just describing,"}, {"Time_Start": 890.86, "Time_End": 894.86, "Text": " and use my library to code tests for his API,"}, {"Time_Start": 894.86, "Time_End": 897.86, "Text": " which means the fact that I finished the KISO and NMAP tests"}, {"Time_Start": 897.86, "Time_End": 899.86, "Text": " and made them separate and pulled them out and done all that work"}, {"Time_Start": 899.86, "Time_End": 901.86, "Text": " will mean that he's kind of handed that on a silver platter,"}, {"Time_Start": 901.86, "Time_End": 905.86, "Text": " but we haven't talked about it, so that's up in the end."}, {"Time_Start": 905.86, "Time_End": 907.86, "Text": " Okay, the other thing is a wing."}, {"Time_Start": 907.86, "Time_End": 910.86, "Text": " Now the one unique thing about T-Squence tests and NMAP"}, {"Time_Start": 910.86, "Time_End": 913.86, "Text": " was that it was totally normal traffic."}, {"Time_Start": 913.86, "Time_End": 917.86, "Text": " traffic. What it did is it sent, sent a packet,"}, {"Time_Start": 917.86, "Time_End": 921.86, "Text": " how many people understand the TCP handshake?"}, {"Time_Start": 921.86, "Time_End": 923.86, "Text": " If you don't understand the TCP handshake,"}, {"Time_Start": 923.86, "Time_End": 927.86, "Text": " what I'm going to say right now is going to be just like gobbly good."}, {"Time_Start": 927.86, "Time_End": 929.86, "Text": " They have got into gravity, right?"}, {"Time_Start": 929.86, "Time_End": 932.86, "Text": " So, just forget it if you don't understand that."}, {"Time_Start": 932.86, "Time_End": 935.86, "Text": " You send the same packet with a sequence number,"}, {"Time_Start": 935.86, "Time_End": 938.86, "Text": " it's going to respond back with a CENAC,"}, {"Time_Start": 938.86, "Time_End": 943.86, "Text": " and it's in its packet that corresponds in"}, {"Time_Start": 943.86, "Time_End": 945.86, "Text": " some way to the value that you sent."}, {"Time_Start": 945.86, "Time_End": 948.86, "Text": " Now, by doing that over and over and over again,"}, {"Time_Start": 948.86, "Time_End": 952.86, "Text": " you could get a statistical relationship between what you sin"}, {"Time_Start": 952.86, "Time_End": 954.86, "Text": " and what you get back."}, {"Time_Start": 954.86, "Time_End": 957.86, "Text": " So you can find out if they're generating the sequence numbers"}, {"Time_Start": 957.86, "Time_End": 959.86, "Text": " to ones that are coming in response randomly,"}, {"Time_Start": 959.86, "Time_End": 961.86, "Text": " or they're adding something to your sequence number."}, {"Time_Start": 961.86, "Time_End": 964.86, "Text": " Very common is to add 100 bytes or add"}, {"Time_Start": 964.86, "Time_End": 967.86, "Text": " the value of 800 or some other constant."}, {"Time_Start": 967.86, "Time_End": 969.86, "Text": " But there's no way to detect that."}, {"Time_Start": 969.86, "Time_End": 971.86, "Text": " That was circular firewall."}, {"Time_Start": 971.86, "Time_End": 972.86, "Text": " As long as you've got a..."}, {"Time_Start": 972.86, "Time_End": 977.86, "Text": " a website running, that's it, all the firewalls,"}, {"Time_Start": 977.86, "Time_End": 979.86, "Text": " you'll be able to get that test through."}, {"Time_Start": 979.86, "Time_End": 983.86, "Text": " So the T-Squence test is unique because it's extremely stealthing."}, {"Time_Start": 983.86, "Time_End": 984.86, "Text": " It uses normal traffic."}, {"Time_Start": 984.86, "Time_End": 986.86, "Text": " It's not doing anything illegal at all."}, {"Time_Start": 986.86, "Time_End": 989.86, "Text": " If you stop T-Squence test, you stop your website."}, {"Time_Start": 989.86, "Time_End": 991.86, "Text": " It's the only way to stop that test."}, {"Time_Start": 991.86, "Time_End": 993.86, "Text": " It's normal TCP traffic."}, {"Time_Start": 993.86, "Time_End": 996.86, "Text": " Now the other thing is normal TCP traffic is a ring."}, {"Time_Start": 996.86, "Time_End": 998.86, "Text": " And the way the way ring works is that"}, {"Time_Start": 998.86, "Time_End": 1000.86, "Text": " when you send out a send back it,"}, {"Time_Start": 1000.86, "Time_End": 1002.86, "Text": " and then they send back a response, and then you,"}, {"Time_Start": 1002.86, "Time_End": 1006.86, "Text": " you do nothing, they're gonna try to repair that connection."}, {"Time_Start": 1006.86, "Time_End": 1008.86, "Text": " Like it's supposed to be, you talk, I talk, you talk,"}, {"Time_Start": 1008.86, "Time_End": 1010.86, "Text": " you talk, okay, we're talking."}, {"Time_Start": 1010.86, "Time_End": 1011.86, "Text": " That kind of thing?"}, {"Time_Start": 1011.86, "Time_End": 1014.86, "Text": " Well, instead I go, I talk, and they go, we talk,"}, {"Time_Start": 1014.86, "Time_End": 1017.86, "Text": " and then you go, and then you say,"}, {"Time_Start": 1017.86, "Time_End": 1021.86, "Text": " they're not gonna say it, we talk, we talk,"}, {"Time_Start": 1021.86, "Time_End": 1025.8600000000001, "Text": " and the periods between the we talks"}, {"Time_Start": 1025.8600000000001, "Time_End": 1028.8600000000001, "Text": " is something that's constant per DCPIP stack implementation,"}, {"Time_Start": 1028.8600000000001, "Time_End": 1031.8600000000001, "Text": " which means you can test for it, which means"}, {"Time_Start": 1031.8600000000001, "Time_End": 1032.8600000000001, "Text": " you can test for it,"}, {"Time_Start": 1032.8600000000001, "Time_End": 1034.3600000000001, "Text": " can determine which operating system is running."}, {"Time_Start": 1034.3600000000001, "Time_End": 1036.1000000000001, "Text": " Now, what's the significant thing about that?"}, {"Time_Start": 1036.1000000000001, "Time_End": 1039.8600000000001, "Text": " It's very much like FIDOR's, FIDO, NMAP,"}, {"Time_Start": 1039.8600000000001, "Time_End": 1043.3600000000001, "Text": " FIDO NMAP's T-S test in that it uses totally normal traffic."}, {"Time_Start": 1043.3600000000001, "Time_End": 1045.8600000000001, "Text": " It's not something you can detect with an IDS system."}, {"Time_Start": 1045.8600000000001, "Time_End": 1049.8600000000001, "Text": " It's the same from an IDS perspective as someone unplugging their Ethernet cord"}, {"Time_Start": 1049.8600000000001, "Time_End": 1052.3600000000001, "Text": " or a host's going down."}, {"Time_Start": 1052.3600000000001, "Time_End": 1056.8600000000001, "Text": " The number of false positives you get by writing an IDS signature for that kind of a test"}, {"Time_Start": 1056.8600000000001, "Time_End": 1057.8600000000001, "Text": " would be phenomenal."}, {"Time_Start": 1057.8600000000001, "Time_End": 1062.66, "Text": " So both the T-sequence test and the ring test represent"}, {"Time_Start": 1062.66, "Time_End": 1071.66, "Text": " methods for getting an operating system in a very stealthy way."}, {"Time_Start": 1071.66, "Time_End": 1073.66, "Text": " We're talking about KSO again."}, {"Time_Start": 1073.66, "Time_End": 1076.66, "Text": " If you want to know about KSO, read FIREDOR's paper."}, {"Time_Start": 1076.66, "Time_End": 1079.66, "Text": " In fact, if you want to know about operating system in fingerprinting,"}, {"Time_Start": 1079.66, "Time_End": 1081.66, "Text": " read FIREDOR's paper."}, {"Time_Start": 1081.66, "Time_End": 1083.66, "Text": " That's the seminal look in the field."}, {"Time_Start": 1083.66, "Time_End": 1085.66, "Text": " It's the first real scientific look at."}, {"Time_Start": 1085.66, "Time_End": 1087.66, "Text": " Now, if you really want to know about operating system,"}, {"Time_Start": 1087.66, "Time_End": 1091.66, "Text": " then read Afer's X paper, it's that thick,"}, {"Time_Start": 1091.66, "Time_End": 1092.66, "Text": " and you'll know a lot of it."}, {"Time_Start": 1092.66, "Time_End": 1095.66, "Text": " But if you want to start out, if you want to review these concepts,"}, {"Time_Start": 1095.66, "Time_End": 1098.66, "Text": " FIDO's paper is a great place to start."}, {"Time_Start": 1098.66, "Time_End": 1101.66, "Text": " In that, exactly what I just said."}, {"Time_Start": 1101.66, "Time_End": 1104.66, "Text": " Robust database, really big, and it's the first to be really scientific"}, {"Time_Start": 1104.66, "Time_End": 1107.66, "Text": " and really systematic about the way you fingerprint."}, {"Time_Start": 1107.66, "Time_End": 1108.66, "Text": " X."}, {"Time_Start": 1108.66, "Time_End": 1110.66, "Text": " First, use intelligence."}, {"Time_Start": 1110.66, "Time_End": 1112.66, "Text": " It's all scientific, but it's got a hard-coded algorithm"}, {"Time_Start": 1112.66, "Time_End": 1114.66, "Text": " for determining what tree it is."}, {"Time_Start": 1114.66, "Time_End": 1116.66, "Text": " Ring, we just talked about it."}, {"Time_Start": 1116.66, "Time_End": 1117.66, "Text": " X2."}, {"Time_Start": 1117.66, "Time_End": 1119.66, "Text": " You know as much as me."}, {"Time_Start": 1119.66, "Time_End": 1121.66, "Text": " All the stuff that you just said, that's what X2 is."}, {"Time_Start": 1121.66, "Time_End": 1122.66, "Text": " Can I want to hear me?"}, {"Time_Start": 1122.66, "Time_End": 1124.66, "Text": " still?"}, {"Time_Start": 1124.66, "Time_End": 1125.66, "Text": " Cool."}, {"Time_Start": 1125.66, "Time_End": 1128.66, "Text": " Okay, let's talk about the structure of my library."}, {"Time_Start": 1128.66, "Time_End": 1132.66, "Text": " All the tests right now are actually written in C."}, {"Time_Start": 1132.66, "Time_End": 1134.66, "Text": " The reason that that's the case is that"}, {"Time_Start": 1134.66, "Time_End": 1138.66, "Text": " C has the best and most documented method"}, {"Time_Start": 1138.66, "Time_End": 1141.66, "Text": " for accessing wall icon sockets."}, {"Time_Start": 1141.66, "Time_End": 1143.66, "Text": " Most of the tests, many of the tests,"}, {"Time_Start": 1143.66, "Time_End": 1147.66, "Text": " involve writing packets in very specific and non-usual ways."}, {"Time_Start": 1147.66, "Time_End": 1151.66, "Text": " So you need to have access to those raw libraries."}, {"Time_Start": 1151.66, "Time_End": 1152.66, "Text": " The other thing is that one."}, {"Time_Start": 1152.66, "Time_End": 1159.66, "Text": " I use Libnet, the beta version, because it's cool and does things for me that I don't have to sort things out because I use it."}, {"Time_Start": 1159.66, "Time_End": 1161.66, "Text": " It's got a lot of functionality, it's really cool."}, {"Time_Start": 1161.66, "Time_End": 1164.66, "Text": " So that's in C2."}, {"Time_Start": 1164.66, "Time_End": 1167.66, "Text": " The other thing is that actually running the tests is irrelevant."}, {"Time_Start": 1167.66, "Time_End": 1170.66, "Text": " The important thing is you have that information from somewhere."}, {"Time_Start": 1170.66, "Time_End": 1174.66, "Text": " So the easiest way to write the test in C, so that's how I do."}, {"Time_Start": 1174.66, "Time_End": 1179.66, "Text": " Okay, C applications, Java applications, C plus four applications across the top there."}, {"Time_Start": 1179.66, "Time_End": 1181.66, "Text": " And then on beneath those,"}, {"Time_Start": 1181.66, "Time_End": 1185.3600000000001, "Text": " And then underneath those, you have the C library, Java library, C plus library, and Pro library."}, {"Time_Start": 1185.3600000000001, "Time_End": 1190.3200000000002, "Text": " The Java library is the one that's most robust, obviously because that's the one that I just showed you."}, {"Time_Start": 1192.16, "Time_End": 1199.3600000000001, "Text": " So right now I'm going for implementing X, K-O, InMap, and Ring, and all these different tests,"}, {"Time_Start": 1199.3600000000001, "Time_End": 1202.26, "Text": " and having them move up in between these different programming languages."}, {"Time_Start": 1202.26, "Time_End": 1208.0600000000002, "Text": " So wouldn't it be cool if you could write a PURL script that says, if Windows do this,"}, {"Time_Start": 1208.0600000000002, "Time_End": 1211.16, "Text": " or if some function returns as Windows,"}, {"Time_Start": 1211.16, "Time_End": 1215.16, "Text": " do this. Or if some function returns as Windows 2000, you do this."}, {"Time_Start": 1215.16, "Time_End": 1217.16, "Text": " This would be a good thing."}, {"Time_Start": 1217.16, "Time_End": 1221.16, "Text": " The other thing with Pearl, and this is something that actually, I'd love to get this functionality"}, {"Time_Start": 1221.16, "Time_End": 1228.16, "Text": " from Pearl into other languages once I get done, is you can take a look at"}, {"Time_Start": 1228.16, "Time_End": 1231.16, "Text": " Rainforest Puppies, Lib Whisker."}, {"Time_Start": 1231.16, "Time_End": 1238.16, "Text": " Lib Whisker is capable of doing very, very accurate fingerprinting of the web port."}, {"Time_Start": 1238.16, "Time_End": 1240.16, "Text": " It can sort out what..."}, {"Time_Start": 1240.16, "Time_End": 1245.16, "Text": " what server is running on a particular computer."}, {"Time_Start": 1245.16, "Time_End": 1251.16, "Text": " I was doing a pen test recently, and they were using a free BSD,"}, {"Time_Start": 1251.16, "Time_End": 1253.16, "Text": " it was a product, it was based on 3BSD,"}, {"Time_Start": 1253.16, "Time_End": 1258.16, "Text": " and they were using it to proxy an NT 2000 web server."}, {"Time_Start": 1258.16, "Time_End": 1261.16, "Text": " Well, when Wisco first went into it, it said,"}, {"Time_Start": 1261.16, "Time_End": 1264.16, "Text": " oh, it's reporting back, it's saying it's Windows 2000,"}, {"Time_Start": 1264.16, "Time_End": 1267.16, "Text": " so that's what it is initially, and then it runs a bunch of other tests,"}, {"Time_Start": 1267.16, "Time_End": 1269.16, "Text": " it finds that the actual behavior of the server is more like"}, {"Time_Start": 1269.16, "Time_End": 1271.16, "Text": " like FreeBSD."}, {"Time_Start": 1271.16, "Time_End": 1273.16, "Text": " So it comes back and says, actually, no, this is Apache."}, {"Time_Start": 1273.16, "Time_End": 1274.16, "Text": " This is Apache."}, {"Time_Start": 1274.16, "Time_End": 1276.16, "Text": " It looked like Windows 2000 in the beginning,"}, {"Time_Start": 1276.16, "Time_End": 1277.16, "Text": " but it's really Apache."}, {"Time_Start": 1277.16, "Time_End": 1280.16, "Text": " Wouldn't it be neat if you could get the,"}, {"Time_Start": 1280.16, "Time_End": 1283.16, "Text": " this is what the web server really is"}, {"Time_Start": 1283.16, "Time_End": 1285.16, "Text": " from Lil Whisker and move it over"}, {"Time_Start": 1285.16, "Time_End": 1288.16, "Text": " and make decisions based on that in other programming languages."}, {"Time_Start": 1288.16, "Time_End": 1290.16, "Text": " So you could say,"}, {"Time_Start": 1290.16, "Time_End": 1293.16, "Text": " because Apache, for instance, runs on Windows 2000."}, {"Time_Start": 1293.16, "Time_End": 1296.16, "Text": " Rarely do people do that, but it does, it runs."}, {"Time_Start": 1296.16, "Time_End": 1299.16, "Text": " So you can get that legitimate header back from,"}, {"Time_Start": 1299.16, "Time_End": 1301.16, "Text": " from that web server."}, {"Time_Start": 1301.16, "Time_End": 1304.16, "Text": " And then if you're running IIS hacks against that box,"}, {"Time_Start": 1304.16, "Time_End": 1306.16, "Text": " why?"}, {"Time_Start": 1306.16, "Time_End": 1309.16, "Text": " So being able to say, for instance,"}, {"Time_Start": 1309.16, "Time_End": 1312.16, "Text": " run a T-sequence test against Port 80,"}, {"Time_Start": 1312.16, "Time_End": 1313.16, "Text": " get a sequence number,"}, {"Time_Start": 1313.16, "Time_End": 1315.16, "Text": " run a wing test against Port 80,"}, {"Time_Start": 1315.16, "Time_End": 1316.16, "Text": " those are both totally stealthy,"}, {"Time_Start": 1316.16, "Time_End": 1319.16, "Text": " and then just ask for what,"}, {"Time_Start": 1319.16, "Time_End": 1324.16, "Text": " do a service test to find out what web server is running,"}, {"Time_Start": 1324.16, "Time_End": 1326.16, "Text": " you'd be able to fingerprint a host"}, {"Time_Start": 1326.16, "Time_End": 1329.16, "Text": " with absolutely no IDS detectable"}, {"Time_Start": 1329.16, "Time_End": 1332.16, "Text": " stuff. All that stuff is totally legitimate traffic."}, {"Time_Start": 1332.16, "Time_End": 1334.16, "Text": " And it would tell you a lot of information."}, {"Time_Start": 1334.16, "Time_End": 1338.16, "Text": " So every language here has different advantages."}, {"Time_Start": 1338.16, "Time_End": 1342.16, "Text": " The reason under Java first is because most of what I want to focus on"}, {"Time_Start": 1342.16, "Time_End": 1345.16, "Text": " is how OOP, an object-oriented programming,"}, {"Time_Start": 1345.16, "Time_End": 1349.16, "Text": " really affects the thing in printing science and Java."}, {"Time_Start": 1349.16, "Time_End": 1352.16, "Text": " It's very easy to get threads and Oop out of Java."}, {"Time_Start": 1352.16, "Time_End": 1357.16, "Text": " So I started there and then I'll use what I've learned there to do the elements."}, {"Time_Start": 1357.16, "Time_End": 1358.16, "Text": " So we kind of understand."}, {"Time_Start": 1358.16, "Time_End": 1361.16, "Text": " understand what I'm talking about here."}, {"Time_Start": 1361.16, "Time_End": 1364.16, "Text": " Have I lost everyone?"}, {"Time_Start": 1364.16, "Time_End": 1368.16, "Text": " Have I not lost everyone?"}, {"Time_Start": 1368.16, "Time_End": 1371.16, "Text": " Okay."}, {"Time_Start": 1371.16, "Time_End": 1372.16, "Text": " Okay."}, {"Time_Start": 1372.16, "Time_End": 1375.16, "Text": " Right now, for my dot C files,"}, {"Time_Start": 1375.16, "Time_End": 1377.16, "Text": " each test is written as a listen function"}, {"Time_Start": 1377.16, "Time_End": 1380.16, "Text": " and as a send function."}, {"Time_Start": 1380.16, "Time_End": 1382.16, "Text": " Now, for instance, the sending portion"}, {"Time_Start": 1382.16, "Time_End": 1386.16, "Text": " of MAT T1 through T7 are very different,"}, {"Time_Start": 1386.16, "Time_End": 1388.16, "Text": " but the fingerprinting portion are all"}, {"Time_Start": 1388.16, "Time_End": 1395.16, "Text": " so you can collapse the listening file in the one."}, {"Time_Start": 1395.16, "Time_End": 1399.16, "Text": " So basically, from a C perspective, it's functional programming."}, {"Time_Start": 1399.16, "Time_End": 1404.16, "Text": " By using my C-LIDER, you should be able to just call functions with the right stuff"}, {"Time_Start": 1404.16, "Time_End": 1408.16, "Text": " and run whatever test you want."}, {"Time_Start": 1408.16, "Time_End": 1411.16, "Text": " Let's take a look at the C-Code."}, {"Time_Start": 1411.16, "Time_End": 1414.16, "Text": " Talk amongst your size."}, {"Time_Start": 1418.16, "Time_End": 1433.16, "Text": " You'll be seeing."}, {"Time_Start": 1433.16, "Time_End": 1438.16, "Text": " Am I on? Okay."}, {"Time_Start": 1438.16, "Time_End": 1445.16, "Text": " As you'll be saying in a moment, all my code is released in a canoe."}, {"Time_Start": 1448.16, "Time_End": 1453.16, "Text": " So you can use it to..."}, {"Time_Start": 1453.16, "Time_End": 1455.16, "Text": " Hello?"}, {"Time_Start": 1455.16, "Time_End": 1456.16, "Text": " Hello?"}, {"Time_Start": 1456.16, "Time_End": 1471.16, "Text": " Hello?"}, {"Time_Start": 1471.16, "Time_End": 1473.16, "Text": " Do you have any?"}, {"Time_Start": 1473.16, "Time_End": 1482.16, "Text": " Can you hear me now?"}, {"Time_Start": 1482.16, "Time_End": 1486.16, "Text": " So you have a function call."}, {"Time_Start": 1486.16, "Time_End": 1491.16, "Text": " It takes a source IP, destination IP, source port, destination port, and an initial sequence number."}, {"Time_Start": 1491.16, "Time_End": 1497.16, "Text": " Now, in C++, Java, what you can do is overload these functions so that you don't actually have to give it a sequence number."}, {"Time_Start": 1497.16, "Time_End": 1499.16, "Text": " You don't have to give it a source port number."}, {"Time_Start": 1499.16, "Time_End": 1502.16, "Text": " Basically, the source port, by in the in-map,"}, {"Time_Start": 1502.16, "Time_End": 1506.16, "Text": " MAP meta-level algorithm is chosen for you, it's chosen randomly."}, {"Time_Start": 1506.16, "Time_End": 1510.16, "Text": " But you don't have to do it that way, if you want to, you can configure just about everything."}, {"Time_Start": 1510.16, "Time_End": 1515.16, "Text": " On the other hand, the overloaded functions will allow you to run it the same way that NMAP does."}, {"Time_Start": 1515.16, "Time_End": 1522.16, "Text": " So if you just want to have a destination IP, assuming that you're using your own IP, so you don't need a source IP,"}, {"Time_Start": 1522.16, "Time_End": 1526.16, "Text": " assuming that you're going to generate a source port randomly, so you don't need a source port,"}, {"Time_Start": 1526.16, "Time_End": 1530.16, "Text": " and you need a destination port, you don't need a sequence number because it's going to choose that randomly."}, {"Time_Start": 1530.16, "Time_End": 1536.16, "Text": " then that function will just have destination port, destination IP."}, {"Time_Start": 1540.16, "Time_End": 1546.16, "Text": " You build the options, NMAP TCP tests, use crazy options."}, {"Time_Start": 1546.16, "Time_End": 1549.16, "Text": " It's one of the IDS signatures of the tests."}, {"Time_Start": 1549.16, "Time_End": 1556.16, "Text": " Anytime you see this particular set of options, all together in one place in a packet, it's usually an NMAP test."}, {"Time_Start": 1556.16, "Time_End": 1559.16, "Text": " Then you set up the..."}, {"Time_Start": 1559.16, "Time_End": 1565.16, "Text": " the build TCP port of it, portion of it, I don't know how many of you are familiar with LibNet."}, {"Time_Start": 1565.16, "Time_End": 1569.16, "Text": " And you use the Syn port and the bogus port here."}, {"Time_Start": 1569.16, "Time_End": 1579.16, "Text": " There are so many flags that a TCP packet can have."}, {"Time_Start": 1579.16, "Time_End": 1582.16, "Text": " There is one that is not defined."}, {"Time_Start": 1582.16, "Time_End": 1584.16, "Text": " That's a bogus."}, {"Time_Start": 1584.16, "Time_End": 1586.16, "Text": " InMAP sets that flag."}, {"Time_Start": 1586.16, "Time_End": 1589.16, "Text": " Most TCP IP implementations have no idea what to do with it."}, {"Time_Start": 1589.16, "Time_End": 1591.16, "Text": " So they can, they'll respond back."}, {"Time_Start": 1591.16, "Time_End": 1593.16, "Text": " Sometimes an operating system will read,"}, {"Time_Start": 1593.16, "Time_End": 1595.16, "Text": " will take the packet that it's reading in,"}, {"Time_Start": 1595.16, "Time_End": 1597.16, "Text": " change it into the response,"}, {"Time_Start": 1597.16, "Time_End": 1600.16, "Text": " which means they don't actually, like, write a new packet."}, {"Time_Start": 1600.16, "Time_End": 1603.16, "Text": " If they do that, then the bogus flag in the packet"}, {"Time_Start": 1603.16, "Time_End": 1605.16, "Text": " that comes back will also be set."}, {"Time_Start": 1605.16, "Time_End": 1607.16, "Text": " So, again, depending on how you implement it,"}, {"Time_Start": 1607.16, "Time_End": 1609.16, "Text": " the results are different."}, {"Time_Start": 1619.16, "Time_End": 1620.16, "Text": " and then you send the test."}, {"Time_Start": 1620.16, "Time_End": 1626.16, "Text": " All right, moving back to my PowerPoint,"}, {"Time_Start": 1626.16, "Time_End": 1627.16, "Text": " talk amongst yourselves."}, {"Time_Start": 1627.16, "Time_End": 1643.16, "Text": " Okay, here's something that I would actually like some feedback"}, {"Time_Start": 1643.16, "Time_End": 1645.16, "Text": " for people at this conference about."}, {"Time_Start": 1645.16, "Time_End": 1648.16, "Text": " And the question is how do you classify an operating system?"}, {"Time_Start": 1648.16, "Time_End": 1653.16, "Text": " For instance, the way I'm doing it right now is with OS family name, major version,"}, {"Time_Start": 1653.16, "Time_End": 1657.16, "Text": " minor version, other room formation, and architecture."}, {"Time_Start": 1657.16, "Time_End": 1660.16, "Text": " I know for a fact that this is not a good way to do it."}, {"Time_Start": 1660.16, "Time_End": 1664.16, "Text": " And the reason is, is think about how many BSD variants there are."}, {"Time_Start": 1664.16, "Time_End": 1669.16, "Text": " If you have a family and you want to be able to write a test that's for all BSD,"}, {"Time_Start": 1669.16, "Time_End": 1672.16, "Text": " or you want to be able to write an exploit that's for all BSD boxes,"}, {"Time_Start": 1672.16, "Time_End": 1677.16, "Text": " if you're doing that, you want to say if the family name, if this top-level group is BSD,"}, {"Time_Start": 1677.16, "Time_End": 1679.16, "Text": " is BSD, then run the test."}, {"Time_Start": 1679.16, "Time_End": 1681.16, "Text": " If not, then don't run the test or the exploit."}, {"Time_Start": 1681.16, "Time_End": 1685.16, "Text": " Okay, if you do that, then what goes in major versions,"}, {"Time_Start": 1685.16, "Time_End": 1688.16, "Text": " since that's the next touchdown, would be free BSD."}, {"Time_Start": 1688.16, "Time_End": 1690.16, "Text": " And then under that would be 4 point something."}, {"Time_Start": 1690.16, "Time_End": 1693.16, "Text": " Well, the problem is it just doesn't split up very well."}, {"Time_Start": 1693.16, "Time_End": 1695.16, "Text": " Like, for instance, Windows."}, {"Time_Start": 1695.16, "Time_End": 1699.16, "Text": " Windows is the family name, then you have 98 and all of the other things."}, {"Time_Start": 1699.16, "Time_End": 1702.16, "Text": " So when you're using Windows, and the major version is 98,"}, {"Time_Start": 1702.16, "Time_End": 1706.16, "Text": " that's comparable to the entire operating system of free BSD."}, {"Time_Start": 1706.16, "Time_End": 1707.16, "Text": " or free BSD?"}, {"Time_Start": 1707.16, "Time_End": 1710.16, "Text": " Probably shouldn't be."}, {"Time_Start": 1710.16, "Time_End": 1713.16, "Text": " So how do you classify an operating system?"}, {"Time_Start": 1713.16, "Time_End": 1714.16, "Text": " How do you group them?"}, {"Time_Start": 1714.16, "Time_End": 1718.16, "Text": " That's a difficult question, and it really takes some knowledge of operating system history,"}, {"Time_Start": 1718.16, "Time_End": 1722.16, "Text": " of which I unfortunately know a little out of part."}, {"Time_Start": 1722.16, "Time_End": 1727.16, "Text": " So I'd like some discussion, perhaps, if you'd like to come talk to me about this afterwards, please do."}, {"Time_Start": 1727.16, "Time_End": 1736.14, "Text": " But every class, JLS test, which every test is a subclass of, has this information"}, {"Time_Start": 1736.16, "Time_End": 1744.16, "Text": " Not only that, it has, again, if you don't know Java, then this is going to sound irrelevant to you, so just ignore it."}, {"Time_Start": 1744.16, "Time_End": 1757.16, "Text": " I've redone the equivalency stuff so that it does the equivalency in such a way that it won't order any given set of these operating systems by their actual classification."}, {"Time_Start": 1757.16, "Time_End": 1763.16, "Text": " So we'll take OS family name into account first, then major version, then minor version, then something like this,"}, {"Time_Start": 1763.16, "Time_End": 1766.14, "Text": " so that you can do, you can use the job"}, {"Time_Start": 1766.16, "Time_End": 1774.16, "Text": " the actual Java compared to function and it will actually return a negative or positive number based on the relationship between two operating systems."}, {"Time_Start": 1774.16, "Time_End": 1786.16, "Text": " Which means you can, you can, for a given operating system, you can, you can run tests based on less or more stuff."}, {"Time_Start": 1786.16, "Time_End": 1789.16, "Text": " If you know Java, then perhaps you know what I mean."}, {"Time_Start": 1789.16, "Time_End": 1792.16, "Text": " If not, perhaps you know what I mean."}, {"Time_Start": 1796.16, "Time_End": 1802.16, "Text": " Okay, threading."}, {"Time_Start": 1804.16, "Time_End": 1808.16, "Text": " Operating, system fingerprinting should be threaded."}, {"Time_Start": 1808.16, "Time_End": 1811.16, "Text": " And the reason is, is that there are some tests that are related to each other."}, {"Time_Start": 1811.16, "Time_End": 1813.16, "Text": " For instance, that tree that X did."}, {"Time_Start": 1813.16, "Time_End": 1815.16, "Text": " But there are other tests that are totally irrelevant."}, {"Time_Start": 1815.16, "Time_End": 1819.16, "Text": " So you could be running the X tree, all those IC&P tests."}, {"Time_Start": 1819.16, "Time_End": 1821.16, "Text": " At the same time, you're running in-map tests."}, {"Time_Start": 1821.16, "Time_End": 1824.16, "Text": " At the same time, you're running service tests."}, {"Time_Start": 1824.16, "Time_End": 1825.16, "Text": " And then the whole time, you could be used."}, {"Time_Start": 1825.16, "Time_End": 1836.16, "Text": " The whole time, you could be using, you know, race, condition, safe, data objects to move information about what tests should be run."}, {"Time_Start": 1836.16, "Time_End": 1846.16, "Text": " So you can have, basically what this allows you to do is write testing algorithms that will turn on its head based on the results of all one tests."}, {"Time_Start": 1846.16, "Time_End": 1848.16, "Text": " It means that you can write dynamic trees."}, {"Time_Start": 1848.16, "Time_End": 1854.16, "Text": " So you can say, well, let's start running these four tests, and then get those four tests back, and then as a result run,"}, {"Time_Start": 1854.16, "Time_End": 1856.16, "Text": " different other set of tests."}, {"Time_Start": 1856.16, "Time_End": 1860.16, "Text": " Now the reason that's important is that one of the problems with in maps"}, {"Time_Start": 1860.16, "Time_End": 1866.16, "Text": " fingerprinting and just just vulnerability assessment in general is that it tends to be slow."}, {"Time_Start": 1866.16, "Time_End": 1868.16, "Text": " It takes a long time to do this."}, {"Time_Start": 1868.16, "Time_End": 1872.16, "Text": " So if you can do stuff in parallel, if you can get information in different directions at the same time,"}, {"Time_Start": 1872.16, "Time_End": 1874.16, "Text": " that gives you a huge advantage."}, {"Time_Start": 1874.16, "Time_End": 1879.16, "Text": " Okay, you've already looked at the code."}, {"Time_Start": 1879.16, "Time_End": 1880.16, "Text": " Let's see."}, {"Time_Start": 1880.16, "Time_End": 1883.16, "Text": " Pearl module and C plus module will happen someday."}, {"Time_Start": 1883.16, "Time_End": 1890.16, "Text": " someday if you're a pro guy and you love writing modules that access C libraries and"}, {"Time_Start": 1890.16, "Time_End": 1894.16, "Text": " move large amounts of data back and forth, please come talk to me."}, {"Time_Start": 1894.16, "Time_End": 1896.16, "Text": " I'd love to have your help."}, {"Time_Start": 1896.16, "Time_End": 1901.16, "Text": " C++ plus I think I'll be able to handle just because it's easy."}, {"Time_Start": 1901.16, "Time_End": 1906.16, "Text": " Okay, what's the future of my fingerprinting library?"}, {"Time_Start": 1906.16, "Time_End": 1910.16, "Text": " Well, obviously it's to implement all the tests."}, {"Time_Start": 1910.16, "Time_End": 1913.16, "Text": " Like when you're able to access all the tests in my library in one place,"}, {"Time_Start": 1913.16, "Time_End": 1915.16, "Text": " even if that's all I give you."}, {"Time_Start": 1915.16, "Time_End": 1918.16, "Text": " That means that it's an easy place for you to start,"}, {"Time_Start": 1918.16, "Time_End": 1921.16, "Text": " assuming you want to write operating system fingerprint code."}, {"Time_Start": 1921.16, "Time_End": 1923.16, "Text": " The other thing is service fingerprinting."}, {"Time_Start": 1923.16, "Time_End": 1926.16, "Text": " There's a program called Winfingerprint that does nothing but fingerprint"}, {"Time_Start": 1926.16, "Time_End": 1930.16, "Text": " all those dangerous, turn them off please,"}, {"Time_Start": 1930.16, "Time_End": 1937.16, "Text": " 130X Windows ports that you should never be using, ever."}, {"Time_Start": 1937.16, "Time_End": 1942.16, "Text": " So you can run an entire sequence of service testing to fingerprint"}, {"Time_Start": 1942.16, "Time_End": 1949.16, "Text": " what MetBios, what SMB, all those things, what they're doing, what they mean."}, {"Time_Start": 1949.16, "Time_End": 1952.16, "Text": " The stuff that they can return, I haven't looked at the code carefully,"}, {"Time_Start": 1952.16, "Time_End": 1957.16, "Text": " looks like it's pretty impressive, very much like the Whiskers' ACTP ability."}, {"Time_Start": 1957.16, "Time_End": 1962.16, "Text": " And as a result, if you can get that service information, then what you can do is you can have"}, {"Time_Start": 1962.16, "Time_End": 1966.16, "Text": " associations between service generations, like,"}, {"Time_Start": 1966.16, "Time_End": 1972.14, "Text": " Sendmail version this, goes with Solaris version this, and IIS version this, goes with"}, {"Time_Start": 1972.16, "Time_End": 1975.66, "Text": " Windows version this. Like some of these things, you happen off the top of your head."}, {"Time_Start": 1975.66, "Time_End": 1978.16, "Text": " Some of them, on the other hand, are a little more complicated."}, {"Time_Start": 1978.16, "Time_End": 1981.66, "Text": " But since vulnerabilities are based on service member and operating system member,"}, {"Time_Start": 1981.66, "Time_End": 1985.66, "Text": " it would be nice to be able to use service to get operating system member guesses"}, {"Time_Start": 1985.66, "Time_End": 1989.66, "Text": " and use operating system guesses to get service member guesses."}, {"Time_Start": 1989.66, "Time_End": 1993.66, "Text": " So hopefully we'll be developing a database about what services go with what operating systems."}, {"Time_Start": 1993.66, "Time_End": 1995.16, "Text": " I'm sure somebody has done that."}, {"Time_Start": 1995.16, "Time_End": 1996.16, "Text": " So it wouldn't be hard."}, {"Time_Start": 1996.16, "Time_End": 2001.66, "Text": " The other thing is that what you can get if you have all this stuff is a CVE database, kind of a"}, {"Time_Start": 2001.66, "Time_End": 2006.66, "Text": " Nessis light. Nessus actually tests to figure out whether or not you're vulnerable."}, {"Time_Start": 2006.66, "Time_End": 2008.66, "Text": " What if you don't care?"}, {"Time_Start": 2008.66, "Time_End": 2010.66, "Text": " What if you don't care if you're really care if you're vulnerable or not?"}, {"Time_Start": 2010.66, "Time_End": 2014.66, "Text": " What if you're running a version of Windows, blah, blah, blah,"}, {"Time_Start": 2014.66, "Time_End": 2017.66, "Text": " or FreeBSD, blah, blah, that's vulnerable to five things."}, {"Time_Start": 2017.66, "Time_End": 2020.66, "Text": " Maybe all you care about is that you need to upgrade the next version."}, {"Time_Start": 2020.66, "Time_End": 2024.66, "Text": " Maybe you're on FreeBSD 4.0 and you need to be on 401."}, {"Time_Start": 2024.66, "Time_End": 2027.66, "Text": " Maybe you're on Windows 2000 and you really should be on Windows XP."}, {"Time_Start": 2027.66, "Time_End": 2031.66, "Text": " If that's all you care about and you're an administrator, you don't need to have a"}, {"Time_Start": 2031.66, "Time_End": 2035.8600000000001, "Text": " full-blown vulnerability test to make sure you are in fact vulnerable to something."}, {"Time_Start": 2035.8600000000001, "Time_End": 2039.16, "Text": " All you need to know is not current version, please patch."}, {"Time_Start": 2039.16, "Time_End": 2040.16, "Text": " That's it."}, {"Time_Start": 2040.16, "Time_End": 2044.66, "Text": " So if you can be very aware of operating system fingerprints and service fingerprints,"}, {"Time_Start": 2044.66, "Time_End": 2049.66, "Text": " you get a very, very, very, very fast vulnerability scanner."}, {"Time_Start": 2049.66, "Time_End": 2053.66, "Text": " The other thing is to develop a simple scanner."}, {"Time_Start": 2053.66, "Time_End": 2057.66, "Text": " Something that does, I don't know, a core of what M-MAT does."}, {"Time_Start": 2057.66, "Time_End": 2060.66, "Text": " I don't know if you guys have looked at M-MAT 3, it's up on InM-M-M-A-3."}, {"Time_Start": 2060.66, "Time_End": 2061.66, "Text": " It's up on In-Secure."}, {"Time_Start": 2061.66, "Time_End": 2063.66, "Text": " You definitely ought to go take a look."}, {"Time_Start": 2063.66, "Time_End": 2067.66, "Text": " The Windows versions of NMAP and the Unix versions are merged."}, {"Time_Start": 2067.66, "Time_End": 2069.66, "Text": " It's pretty cool."}, {"Time_Start": 2069.66, "Time_End": 2074.66, "Text": " But that's, I definitely don't want to write stuff that competes with these tools that are out there"}, {"Time_Start": 2074.66, "Time_End": 2078.66, "Text": " because they're so good that it's very unlikely that I'll ever be able to generate something"}, {"Time_Start": 2078.66, "Time_End": 2082.66, "Text": " that's going to be able to keep pace with those technological developments."}, {"Time_Start": 2082.66, "Time_End": 2085.66, "Text": " Rather, I'd prefer to kind of imitate what they did last week."}, {"Time_Start": 2085.66, "Time_End": 2091.64, "Text": " I think the coolest thing would be a little less Apache module so that you could give different information"}, {"Time_Start": 2091.66, "Time_End": 2095.66, "Text": " information to different users based on their operating system."}, {"Time_Start": 2095.66, "Time_End": 2102.66, "Text": " So you set your proxy up so that, let's say, you do, you combine your CD database scanner"}, {"Time_Start": 2102.66, "Time_End": 2109.66, "Text": " and your little S Apache model, you scan your network, you come up with 192-168, 1.5,"}, {"Time_Start": 2109.66, "Time_End": 2113.66, "Text": " is a vulnerable version of FreeBSD."}, {"Time_Start": 2113.66, "Time_End": 2120.66, "Text": " You associate, you put the patch up on a web server, and you say, if FreeBSD version missed, show this page."}, {"Time_Start": 2120.66, "Time_End": 2121.66, "Text": " And then you write this."}, {"Time_Start": 2121.66, "Time_End": 2128.66, "Text": " into your proxy for your web surfing that they have to go to the to the patch version update page first."}, {"Time_Start": 2128.66, "Time_End": 2131.66, "Text": " Well, that means that you scan your network for all the vulnerable things."}, {"Time_Start": 2131.66, "Time_End": 2134.66, "Text": " You put the patches that they need up on the website,"}, {"Time_Start": 2134.66, "Time_End": 2140.66, "Text": " and then those servers or workstations that are vulnerable will automatically be forced to go download the patches"}, {"Time_Start": 2140.66, "Time_End": 2142.66, "Text": " before they can go continue surfing."}, {"Time_Start": 2142.66, "Time_End": 2146.66, "Text": " I might not install the patches, but at least they download it and that's a start."}, {"Time_Start": 2146.66, "Time_End": 2150.66, "Text": " You cannot need, you cannot make a horse drink."}, {"Time_Start": 2150.66, "Time_End": 2154.66, "Text": " Okay, that's everything."}, {"Time_Start": 2154.66, "Time_End": 2155.66, "Text": " Thank you."}, {"Time_Start": 2155.66, "Time_End": 2157.66, "Text": " And do you have any questions?"}, {"Time_Start": 2157.66, "Time_End": 2158.66, "Text": " Yes."}, {"Time_Start": 2158.66, "Time_End": 2161.66, "Text": " Oh, and actually, I'm going to have to do microphone switching since nobody can hear."}, {"Time_Start": 2161.66, "Time_End": 2163.66, "Text": " So if you'll just come up."}, {"Time_Start": 2163.66, "Time_End": 2166.66, "Text": " Oh, I'm sorry."}, {"Time_Start": 2166.66, "Time_End": 2167.66, "Text": " That's a very good question."}, {"Time_Start": 2167.66, "Time_End": 2170.66, "Text": " And it's on the HTML documentation that's inside the CD."}, {"Time_Start": 2170.66, "Time_End": 2173.66, "Text": " It's www.sincere.net."}, {"Time_Start": 2173.66, "Time_End": 2176.66, "Text": " S-Y-N-S-E-E-E-R."}, {"Time_Start": 2180.66, "Time_End": 2190.66, "Text": " Good point."}, {"Time_Start": 2190.66, "Time_End": 2194.66, "Text": " Next question."}, {"Time_Start": 2194.66, "Time_End": 2196.66, "Text": " Next question."}, {"Time_Start": 2196.66, "Time_End": 2198.66, "Text": " Next question."}, {"Time_Start": 2198.66, "Time_End": 2209.66, "Text": " Can't hear, what you're saying?"}, {"Time_Start": 2209.66, "Time_End": 2213.66, "Text": " That would be a good idea."}, {"Time_Start": 2216.66, "Time_End": 2217.66, "Text": " Yes."}, {"Time_Start": 2217.66, "Time_End": 2218.66, "Text": " The G-S-T-CL."}, {"Time_Start": 2218.66, "Time_End": 2221.66, "Text": " And I said yes."}, {"Time_Start": 2221.66, "Time_End": 2224.66, "Text": " Anybody else?"}, {"Time_Start": 2224.66, "Time_End": 2229.66, "Text": " Okay, I officially am relinquishing the microphone."}, {"Time_Start": 2229.66, "Time_End": 2233.66, "Text": " Please feel free to come up and do the one-on-one questions if you feel like it."}, {"Time_Start": 2233.66, "Time_End": 2234.66, "Text": " Bye-bye now."}]}