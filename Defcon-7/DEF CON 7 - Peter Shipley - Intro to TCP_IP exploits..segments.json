{"segments": [{"Time_Start": 0.0, "Time_End": 4.0, "Text": " Welcome to the annual Def-Con Convention."}, {"Time_Start": 4.0, "Time_End": 10.0, "Text": " This meeting was held in exciting Las Vegas, Nevada from July 9 through the 11th, 1999."}, {"Time_Start": 10.0, "Time_End": 13.0, "Text": " This is videotape number 21."}, {"Time_Start": 13.0, "Time_End": 16.0, "Text": " Introduction to TCP IP exploits."}, {"Time_Start": 16.0, "Time_End": 27.0, "Text": " Okay, next up is Pete Shipley. He's going to elaborate on what I just talked about."}, {"Time_Start": 27.0, "Time_End": 29.0, "Text": " He's going to be talking about TCP IP and its weaknesses."}, {"Time_Start": 29.0, "Time_End": 33.0, "Text": " B.I. P.N.'s weaknesses."}, {"Time_Start": 33.0, "Time_End": 36.0, "Text": " Let's give a round of applause."}, {"Time_Start": 36.0, "Time_End": 54.0, "Text": " He's not going to be able to anywhere."}, {"Time_Start": 54.0, "Time_End": 55.0, "Text": " He's not melting."}, {"Time_Start": 55.0, "Time_End": 57.0, "Text": " No, his keyboard, Mike."}, {"Time_Start": 57.0, "Time_End": 62.0, "Text": " Okay, let's talk about that stuff."}, {"Time_Start": 62.0, "Time_End": 63.0, "Text": " Let's see."}, {"Time_Start": 63.0, "Time_End": 64.0, "Text": " Let's see."}, {"Time_Start": 64.0, "Time_End": 65.0, "Text": " Let's see."}, {"Time_Start": 65.0, "Time_End": 71.0, "Text": " Let's keep in mind."}, {"Time_Start": 71.0, "Time_End": 82.0, "Text": " Here we go."}, {"Time_Start": 82.0, "Time_End": 83.0, "Text": " We're back."}, {"Time_Start": 83.0, "Time_End": 85.0, "Text": " Let's review a little bit of what Puckus talked about."}, {"Time_Start": 85.0, "Time_End": 86.0, "Text": " Then go on, explain to general expert."}, {"Time_Start": 86.0, "Time_End": 90.0, "Text": " explain to general exploits you're seeing every other day on bug tracks."}, {"Time_Start": 90.0, "Time_End": 94.0, "Text": " If you're a security expert, I'm going to bore you to death."}, {"Time_Start": 94.0, "Time_End": 97.0, "Text": " This is newbie track."}, {"Time_Start": 97.0, "Time_End": 100.0, "Text": " The purpose of the newbie track is so you don't have to ask stupid questions."}, {"Time_Start": 100.0, "Time_End": 103.0, "Text": " We'll answer them for you."}, {"Time_Start": 103.0, "Time_End": 107.0, "Text": " Well, basically, cover here is what's TSPIP?"}, {"Time_Start": 107.0, "Time_End": 108.0, "Text": " Why do we need it?"}, {"Time_Start": 108.0, "Time_End": 115.0, "Text": " Basically, what are ports and sockets, known problems, and basically general attack methods."}, {"Time_Start": 115.0, "Time_End": 121.0, "Text": " If you're awake during the last hour, you already know this, what TSP is, set of protocols."}, {"Time_Start": 121.0, "Time_End": 124.0, "Text": " Arpinet basically became the internet, got fun stuff."}, {"Time_Start": 124.0, "Time_End": 129.0, "Text": " I'm going to skip all the first several slides, obviously, since it's kind of redundant from Pungus' talk."}, {"Time_Start": 129.0, "Time_End": 132.0, "Text": " We have basically your..."}, {"Time_Start": 132.0, "Time_End": 140.0, "Text": " I'm stupid enough to try to call me during my talk."}, {"Time_Start": 140.0, "Time_End": 144.0, "Text": " Basically, if you use the internet, you use TSP IP."}, {"Time_Start": 144.0, "Time_End": 146.0, "Text": " Here's TSP IP."}, {"Time_Start": 146.0, "Time_End": 148.0, "Text": " That's just the way life is."}, {"Time_Start": 148.0, "Time_End": 149.0, "Text": " What is IP?"}, {"Time_Start": 149.0, "Time_End": 153.0, "Text": " It's basically a collection of protocols that compromise the suite."}, {"Time_Start": 153.0, "Time_End": 157.0, "Text": " This is, well, well, you're at the last talk."}, {"Time_Start": 157.0, "Time_End": 159.0, "Text": " When my talks to skip this stuff?"}, {"Time_Start": 159.0, "Time_End": 160.0, "Text": " Yeah."}, {"Time_Start": 160.0, "Time_End": 162.0, "Text": " Yeah."}, {"Time_Start": 162.0, "Time_End": 165.0, "Text": " That's the ISO stack."}, {"Time_Start": 165.0, "Time_End": 169.0, "Text": " I'm going to, the reasons up here, you should actually know the ISO stack."}, {"Time_Start": 169.0, "Time_End": 170.0, "Text": " I think it's for bullshit."}, {"Time_Start": 170.0, "Time_End": 172.0, "Text": " You know, it might be a seven-layer burrito."}, {"Time_Start": 172.0, "Time_End": 173.0, "Text": " But, um."}, {"Time_Start": 173.0, "Time_End": 178.0, "Text": " I think layer one is your, you know, layer one is your, you know,"}, {"Time_Start": 178.0, "Time_End": 180.0, "Text": " layer one is basically your physical, that's your physical,"}, {"Time_Start": 180.0, "Time_End": 181.0, "Text": " that's your code, wire."}, {"Time_Start": 181.0, "Time_End": 184.0, "Text": " Layer two is the protocol on the wire to be the Ethernet."}, {"Time_Start": 184.0, "Time_End": 187.0, "Text": " Three, we're talking about IP, on top that's TCP,"}, {"Time_Start": 187.0, "Time_End": 190.0, "Text": " and then we jump up to six, which is probably the application."}, {"Time_Start": 190.0, "Time_End": 194.0, "Text": " Now, I want to keep an eye on this because as I talk about various exploits,"}, {"Time_Start": 194.0, "Time_End": 196.0, "Text": " I'm probably going to work from the top down."}, {"Time_Start": 196.0, "Time_End": 198.0, "Text": " But I'm going to do is point down,"}, {"Time_Start": 198.0, "Time_End": 200.0, "Text": " because everybody keeps saying, oh, what we're going to do is we're going to have a"}, {"Time_Start": 200.0, "Time_End": 202.0, "Text": " secure program."}, {"Time_Start": 202.0, "Time_End": 203.0, "Text": " Well, also, I'd burn."}, {"Time_Start": 203.0, "Time_End": 206.0, "Text": " break the foundation, the transport layer."}, {"Time_Start": 206.0, "Time_End": 208.0, "Text": " Well, I'm going to write a secure transport layer."}, {"Time_Start": 208.0, "Time_End": 210.0, "Text": " So I break the network layer."}, {"Time_Start": 210.0, "Time_End": 213.0, "Text": " You go, well, we're going to use better IP authentication."}, {"Time_Start": 213.0, "Time_End": 216.0, "Text": " Well, I'll just break your link layer."}, {"Time_Start": 216.0, "Time_End": 218.0, "Text": " This is what's happening in security continuously."}, {"Time_Start": 218.0, "Time_End": 223.0, "Text": " And that's what I'm going to try to point out in this talk while explaining things."}, {"Time_Start": 223.0, "Time_End": 226.0, "Text": " But everybody understands this, right?"}, {"Time_Start": 226.0, "Time_End": 227.0, "Text": " Good."}, {"Time_Start": 227.0, "Time_End": 232.0, "Text": " Now, what TCP does is provides a connectualist, basically provides reliable connection."}, {"Time_Start": 232.0, "Time_End": 237.0, "Text": " provides reliable connections over connectionless protocol."}, {"Time_Start": 237.0, "Time_End": 241.0, "Text": " As you know from his talk, he basically relies on three-way handshaking."}, {"Time_Start": 241.0, "Time_End": 245.0, "Text": " I'm going over this again because it's important that you understand this part."}, {"Time_Start": 245.0, "Time_End": 249.0, "Text": " It's ensured both sides agree that, hey, not only we're going to talk, but we're going to talk."}, {"Time_Start": 249.0, "Time_End": 255.0, "Text": " Like, for example, I go, hey, punkis, he goes, hey Pete, we've established a communication."}, {"Time_Start": 255.0, "Time_End": 256.0, "Text": " I've called him."}, {"Time_Start": 256.0, "Time_End": 261.0, "Text": " He acknowledges my request to him and we continue communication."}, {"Time_Start": 261.0, "Time_End": 263.0, "Text": " That's exactly a three-way handshake is."}, {"Time_Start": 263.0, "Time_End": 265.0, "Text": " So we have a client and server."}, {"Time_Start": 265.0, "Time_End": 267.0, "Text": " I send a sin packet."}, {"Time_Start": 267.0, "Time_End": 270.0, "Text": " That's basically sin equals x."}, {"Time_Start": 270.0, "Time_End": 273.0, "Text": " That is acknowledged with an..."}, {"Time_Start": 273.0, "Time_End": 277.0, "Text": " So the acknowledgement is a sin plus one, and it also stops a sequence."}, {"Time_Start": 277.0, "Time_End": 282.0, "Text": " Now, at this point, that second sequence is acknowledged."}, {"Time_Start": 282.0, "Time_End": 285.0, "Text": " There's a point out here."}, {"Time_Start": 285.0, "Time_End": 287.0, "Text": " Again, you send out this."}, {"Time_Start": 287.0, "Time_End": 290.0, "Text": " Now, the sequence of this direction is X."}, {"Time_Start": 290.0, "Time_End": 291.0, "Text": " Let's see what this direction is X."}, {"Time_Start": 291.0, "Time_End": 292.0, "Text": " is why."}, {"Time_Start": 292.0, "Time_End": 297.0, "Text": " Now we understand that this is how we establish that somebody has to be during the break,"}, {"Time_Start": 297.0, "Time_End": 301.0, "Text": " well, how do you, we have randomized sequences, how do you know which sequence to use?"}, {"Time_Start": 301.0, "Time_End": 302.0, "Text": " Well, what is the starting sequence?"}, {"Time_Start": 302.0, "Time_End": 306.0, "Text": " That's the important part."}, {"Time_Start": 306.0, "Time_End": 307.0, "Text": " Questions?"}, {"Time_Start": 307.0, "Time_End": 309.0, "Text": " Interrupt me any time for the question."}, {"Time_Start": 309.0, "Time_End": 311.0, "Text": " Okay, with three-way handchecks, we're basically, again,"}, {"Time_Start": 311.0, "Time_End": 315.0, "Text": " from utilizing this, he understands you don't get lost in five minutes."}, {"Time_Start": 315.0, "Time_End": 319.0, "Text": " That we now all agree that both sides are very strange data and we have fun."}, {"Time_Start": 319.0, "Time_End": 320.0, "Text": " Now, how we connect?"}, {"Time_Start": 320.0, "Time_End": 322.0, "Text": " highway connections fail."}, {"Time_Start": 322.0, "Time_End": 323.0, "Text": " That's actually kind of simple."}, {"Time_Start": 323.0, "Time_End": 326.0, "Text": " We are on a client and server."}, {"Time_Start": 326.0, "Time_End": 328.0, "Text": " I send us in."}, {"Time_Start": 328.0, "Time_End": 330.0, "Text": " It sends a reset."}, {"Time_Start": 330.0, "Time_End": 333.0, "Text": " Casey says, no thanks."}, {"Time_Start": 333.0, "Time_End": 337.0, "Text": " This is, oh, mind you, this is an oversimplified case,"}, {"Time_Start": 337.0, "Time_End": 340.0, "Text": " but in general, that's hopefully the way it's going to work."}, {"Time_Start": 340.0, "Time_End": 346.0, "Text": " Unfortunately, IP stack is susceptible to tons and tons"}, {"Time_Start": 346.0, "Time_End": 349.0, "Text": " of, while possible, attacks for anvillian spoofs."}, {"Time_Start": 349.0, "Time_End": 352.0, "Text": " proofs, and that's what the remainder of this talk is about."}, {"Time_Start": 352.0, "Time_End": 355.0, "Text": " With any questions at all, please just interrupt."}, {"Time_Start": 355.0, "Time_End": 358.0, "Text": " I mean, if I get ahead of you, just say so."}, {"Time_Start": 358.0, "Time_End": 363.0, "Text": " Now, before you go on to attacks, we should talk about what kind of attacks exist."}, {"Time_Start": 363.0, "Time_End": 366.0, "Text": " One frustration I see is like, oh, I've got a new exploit."}, {"Time_Start": 366.0, "Time_End": 368.0, "Text": " It's a denial of service attack."}, {"Time_Start": 368.0, "Time_End": 371.0, "Text": " Important security to classify your attacks."}, {"Time_Start": 371.0, "Time_End": 374.0, "Text": " So in general, I find there's four types."}, {"Time_Start": 374.0, "Time_End": 376.0, "Text": " There's disclosure information."}, {"Time_Start": 376.0, "Time_End": 378.0, "Text": " That's theft of information."}, {"Time_Start": 378.0, "Time_End": 379.0, "Text": " You know, getting your influence."}, {"Time_Start": 379.0, "Time_End": 382.0, "Text": " file, getting your credit report."}, {"Time_Start": 382.0, "Time_End": 386.0, "Text": " There's destruction of data, you know, erasing your files."}, {"Time_Start": 386.0, "Time_End": 389.0, "Text": " Alteration of data, changing your grades."}, {"Time_Start": 389.0, "Time_End": 391.0, "Text": " Yeah."}, {"Time_Start": 391.0, "Time_End": 392.0, "Text": " Well, yeah."}, {"Time_Start": 392.0, "Time_End": 395.0, "Text": " So this again, well, the disclosures, the tax gets confidentially"}, {"Time_Start": 395.0, "Time_End": 399.0, "Text": " of data, stealing it, exposing things, releasing quake before it's ready."}, {"Time_Start": 399.0, "Time_End": 404.0, "Text": " Passwords, e-mail sniffers, there's all disclosure information."}, {"Time_Start": 404.0, "Time_End": 406.0, "Text": " Destruction is wiping."}, {"Time_Start": 406.0, "Time_End": 408.0, "Text": " Alteration."}, {"Time_Start": 408.0, "Time_End": 410.0, "Text": " is basically modification data."}, {"Time_Start": 410.0, "Time_End": 411.0, "Text": " It doesn't have to happen on disk."}, {"Time_Start": 411.0, "Time_End": 413.0, "Text": " You'd actually happen on a network."}, {"Time_Start": 413.0, "Time_End": 417.0, "Text": " While you're logged in to a client to a server, for example,"}, {"Time_Start": 417.0, "Time_End": 419.0, "Text": " someone might insert data."}, {"Time_Start": 419.0, "Time_End": 420.0, "Text": " That's alteration of data."}, {"Time_Start": 420.0, "Time_End": 423.0, "Text": " And the most common is denial of service."}, {"Time_Start": 423.0, "Time_End": 426.0, "Text": " These really script these things are hackers because they could just flood your network."}, {"Time_Start": 426.0, "Time_End": 427.0, "Text": " No."}, {"Time_Start": 427.0, "Time_End": 428.0, "Text": " That is not a break-in."}, {"Time_Start": 428.0, "Time_End": 429.0, "Text": " That's denial of service."}, {"Time_Start": 429.0, "Time_End": 431.0, "Text": " That's the fourth type."}, {"Time_Start": 431.0, "Time_End": 435.0, "Text": " Now, what types of dust attacks exist?"}, {"Time_Start": 435.0, "Time_End": 437.0, "Text": " Well, we have ping flooding."}, {"Time_Start": 437.0, "Time_End": 440.0, "Text": " Then there's modification, echo reply flooding."}, {"Time_Start": 440.0, "Time_End": 443.0, "Text": " I'll explain these terms in next slide or two."}, {"Time_Start": 443.0, "Time_End": 446.0, "Text": " TCP looping, ping at death, some fragment overflow."}, {"Time_Start": 446.0, "Time_End": 450.0, "Text": " I'm going to explain to all these talks, all these exploits to you."}, {"Time_Start": 450.0, "Time_End": 455.0, "Text": " Ping flooding is the most simple one."}, {"Time_Start": 455.0, "Time_End": 458.0, "Text": " That's when you just basically, you know, send lots and lots and lots of pings."}, {"Time_Start": 458.0, "Time_End": 462.0, "Text": " Just run ping dash from the Unix shell, give an IP host name."}, {"Time_Start": 462.0, "Time_End": 466.0, "Text": " And the machine that you're on sends as many packets as possible to remote site."}, {"Time_Start": 466.0, "Time_End": 467.0, "Text": " Effect."}, {"Time_Start": 467.0, "Time_End": 471.0, "Text": " basically allows the attacker to possibly inhibit network activity."}, {"Time_Start": 471.0, "Time_End": 475.0, "Text": " Mind you, this is not going to work in your dial-up to my home T1."}, {"Time_Start": 475.0, "Time_End": 479.0, "Text": " They will work for my T1 to your dial-up."}, {"Time_Start": 479.0, "Time_End": 482.0, "Text": " And those out here, the OC-48 don't take out my T-1."}, {"Time_Start": 482.0, "Time_End": 485.0, "Text": " It's high bandwidth, he's low bandwidth."}, {"Time_Start": 485.0, "Time_End": 489.0, "Text": " I'm a friend who works at a large web development company,"}, {"Time_Start": 489.0, "Time_End": 491.0, "Text": " and they've got several OC-48s, and it's kind of humorous"}, {"Time_Start": 491.0, "Time_End": 494.0, "Text": " because people try to flood them out on IRC all the time."}, {"Time_Start": 494.0, "Time_End": 496.0, "Text": " It's a waste of time."}, {"Time_Start": 497.0, "Time_End": 500.0, "Text": " Okay, and well, another method is setting ping packets."}, {"Time_Start": 500.0, "Time_End": 501.0, "Text": " It's amazing."}, {"Time_Start": 501.0, "Time_End": 502.0, "Text": " You can send any kind of packet."}, {"Time_Start": 502.0, "Time_End": 505.0, "Text": " But the ping program comes with Unix as, you know,"}, {"Time_Start": 505.0, "Time_End": 506.0, "Text": " why write code?"}, {"Time_Start": 506.0, "Time_End": 508.0, "Text": " Why you just type ping-f?"}, {"Time_Start": 508.0, "Time_End": 510.0, "Text": " Well, if you really want to flood people out,"}, {"Time_Start": 510.0, "Time_End": 513.0, "Text": " you wouldn't use ping because router's going to filter that."}, {"Time_Start": 513.0, "Time_End": 515.0, "Text": " Now, how does it work? Simple."}, {"Time_Start": 515.0, "Time_End": 518.0, "Text": " You know, I'm sending packets to the internet, it's flooding your machine."}, {"Time_Start": 518.0, "Time_End": 519.0, "Text": " No-brainer."}, {"Time_Start": 519.0, "Time_End": 526.0, "Text": " To be effective again, I want to reinvite, you need greater bandwidth."}, {"Time_Start": 526.0, "Time_End": 533.0, "Text": " with, I reiterate this because I don't know how many kitties and their dial-ups try to flood my home to you want, it just doesn't work."}, {"Time_Start": 533.0, "Time_End": 542.0, "Text": " One common trick is if you're being flooded a lot, you will modify your firewall to say, for example, to block IC&P echo packets."}, {"Time_Start": 542.0, "Time_End": 546.0, "Text": " Well, in that case, the person can start studying reply packets."}, {"Time_Start": 546.0, "Time_End": 554.0, "Text": " If that doesn't work, they just literally start spawning a whole bunch of other, you know, host and reachable packets, just random UDP packets."}, {"Time_Start": 554.0, "Time_End": 560.0, "Text": " Now, when you went from, you have a small bandwidth that you have a"}, {"Time_Start": 560.0, "Time_End": 562.0, "Text": " small bandwidth, I have greater bandwidth?"}, {"Time_Start": 562.0, "Time_End": 563.0, "Text": " Well, how do we abuse this?"}, {"Time_Start": 563.0, "Time_End": 565.0, "Text": " Well, we can abuse other people's bandwidth."}, {"Time_Start": 565.0, "Time_End": 569.0, "Text": " As you know, Ping is a simple program where you send out a packet and you get a reply back."}, {"Time_Start": 569.0, "Time_End": 573.0, "Text": " Well, it comes back to you because you send it from your address."}, {"Time_Start": 573.0, "Time_End": 576.0, "Text": " Here's a situation, there's another notebook on the bottom,"}, {"Time_Start": 576.0, "Time_End": 581.0, "Text": " there's a bunch of badly set up machines on the right, and of course a nice little victim that want to take out."}, {"Time_Start": 581.0, "Time_End": 583.0, "Text": " Now, smurf attack is simple."}, {"Time_Start": 583.0, "Time_End": 584.0, "Text": " It's simple."}, {"Time_Start": 584.0, "Time_End": 588.5, "Text": " I send a single spoofed packet to that network."}, {"Time_Start": 588.5, "Time_End": 590.76, "Text": " This is tested to a broadcast address."}, {"Time_Start": 590.76, "Time_End": 595.34, "Text": " I don't know that was covered, but when you transmit, we have IP addresses, you transmit to a single"}, {"Time_Start": 595.34, "Time_End": 598.7, "Text": " host and you also transmit to all hosts on a network."}, {"Time_Start": 598.7, "Time_End": 602.5, "Text": " If you're done enough to leave your gateway open to allow inbound broadcast address, you're"}, {"Time_Start": 602.5, "Time_End": 605.0, "Text": " going to have problems."}, {"Time_Start": 605.0, "Time_End": 609.5, "Text": " And also, not only you have problems, but other people will have problems from you."}, {"Time_Start": 609.5, "Time_End": 612.46, "Text": " So when the government starts calling you up while you're flooding their network, somebody's"}, {"Time_Start": 612.46, "Time_End": 618.4000000000001, "Text": " probably using you as a group of hosts on the right. Now, I said one packet to that group"}, {"Time_Start": 618.4000000000001, "Time_End": 625.46, "Text": " of systems. What do all those hosts do? They apply. A lot."}, {"Time_Start": 625.46, "Time_End": 637.46, "Text": " Now, again, I iterate, one packet, many packets. This is a classic Smurf attack."}, {"Time_Start": 637.46, "Time_End": 642.44, "Text": " Now if I'm saying, so this is where your 144 modem can wipe out somebody's large,"}, {"Time_Start": 642.46, "Time_End": 643.46, "Text": " neck connection."}, {"Time_Start": 643.46, "Time_End": 652.46, "Text": " Again, flood attacks are easy to do, usually do it by filtering ICMP echo apply packets."}, {"Time_Start": 652.46, "Time_End": 656.46, "Text": " The annoying part is you start filtering those, you can't ping people from your site."}, {"Time_Start": 656.46, "Time_End": 659.46, "Text": " Other forms."}, {"Time_Start": 659.46, "Time_End": 662.46, "Text": " Well, we have UDP echo spoofing."}, {"Time_Start": 662.46, "Time_End": 664.46, "Text": " I'll explain this."}, {"Time_Start": 664.46, "Time_End": 666.46, "Text": " We don't know what a UDP is now."}, {"Time_Start": 666.46, "Time_End": 668.46, "Text": " Well, we have echo spoofing."}, {"Time_Start": 668.46, "Time_End": 669.46, "Text": " There's a nice little port."}, {"Time_Start": 669.46, "Time_End": 672.46, "Text": " There's a whole bunch of little ports called the internal service."}, {"Time_Start": 672.46, "Time_End": 676.46, "Text": " that come with your Unix machines and NT machines, one of which is Echo."}, {"Time_Start": 676.46, "Time_End": 680.46, "Text": " You tell it to that port, and whatever you type gets typed packet you."}, {"Time_Start": 680.46, "Time_End": 684.46, "Text": " If you send a UDP packet, it'll transmit the packet back to you."}, {"Time_Start": 684.46, "Time_End": 687.46, "Text": " Kind of a ping-like thing, but it's a different layer of service."}, {"Time_Start": 687.46, "Time_End": 690.46, "Text": " I don't know why it's there anymore."}, {"Time_Start": 690.46, "Time_End": 692.46, "Text": " It's more of a legacy service."}, {"Time_Start": 692.46, "Time_End": 695.46, "Text": " And if you, if then he brings it all, you automatically turn this off."}, {"Time_Start": 695.46, "Time_End": 697.46, "Text": " But we can have fun."}, {"Time_Start": 697.46, "Time_End": 700.46, "Text": " Like, there's a little NT box over on the right-hand side."}, {"Time_Start": 700.46, "Time_End": 702.46, "Text": " They put it, they installed all the networks where we're,"}, {"Time_Start": 702.46, "Time_End": 704.46, "Text": " including UDP ECHO."}, {"Time_Start": 704.46, "Time_End": 707.46, "Text": " So, me being a nice person on the left,"}, {"Time_Start": 707.46, "Time_End": 713.46, "Text": " I send a UDP packet with a from address and to address of my victim."}, {"Time_Start": 713.46, "Time_End": 717.46, "Text": " So where does my victim send the reply?"}, {"Time_Start": 717.46, "Time_End": 723.46, "Text": " Thus, what is that machine busy doing with all of its CPU time?"}, {"Time_Start": 723.46, "Time_End": 729.46, "Text": " Now this can go on for a while, eventually a CPU time,"}, {"Time_Start": 729.46, "Time_End": 731.46, "Text": " maxes out, you drop a packet, and it goes away."}, {"Time_Start": 731.46, "Time_End": 741.46, "Text": " Anyway, another method I can send a source address of local host, which is, again, kind of a unique host that always refers to yourself."}, {"Time_Start": 741.46, "Time_End": 745.46, "Text": " And some mobile packets, the machine keeps quite busy."}, {"Time_Start": 745.46, "Time_End": 748.46, "Text": " Variations include transmitting to a broadcast address."}, {"Time_Start": 748.46, "Time_End": 751.46, "Text": " We get a lot of machines broadcasting at each other and such."}, {"Time_Start": 751.46, "Time_End": 753.46, "Text": " But it's kind of simple."}, {"Time_Start": 753.46, "Time_End": 759.46, "Text": " There are patch versions of INETD, that's the demon that spawns most of your internet network services under UNIX."}, {"Time_Start": 759.46, "Time_End": 760.46, "Text": " There are patch versions that will block."}, {"Time_Start": 760.46, "Time_End": 765.46, "Text": " versions that would block these attacks as in, I'm not talking to myself, screw this, ignore it."}, {"Time_Start": 765.46, "Time_End": 767.46, "Text": " That type of thing."}, {"Time_Start": 767.46, "Time_End": 770.46, "Text": " IP field training helps, unprotected systems."}, {"Time_Start": 770.46, "Time_End": 773.46, "Text": " You know, I hope you all have a firewall."}, {"Time_Start": 773.46, "Time_End": 776.46, "Text": " Cyber who flaked out in his early morning talk will be rescheduled."}, {"Time_Start": 776.46, "Time_End": 778.46, "Text": " He's going to drop his PGI talk, he's got to drop his PGI talk,"}, {"Time_Start": 778.46, "Time_End": 780.46, "Text": " and he's got to build a firewall out of BSD."}, {"Time_Start": 780.46, "Time_End": 782.46, "Text": " That's going to be 5 o'clock in this room."}, {"Time_Start": 782.46, "Time_End": 786.46, "Text": " And if you do attend that talk, ask him where he was this morning."}, {"Time_Start": 786.46, "Time_End": 788.46, "Text": " He's out shooting his guns instead of talking to you."}, {"Time_Start": 788.46, "Time_End": 789.46, "Text": " So give him lots of help."}, {"Time_Start": 789.46, "Time_End": 791.46, "Text": " Give them lots of hell for that."}, {"Time_Start": 793.46, "Time_End": 794.46, "Text": " Now, sin flooding."}, {"Time_Start": 794.46, "Time_End": 796.46, "Text": " We all read the paper a few years ago."}, {"Time_Start": 796.46, "Time_End": 800.46, "Text": " Sin flooding has actually been around for, I don't know, about 15 years."}, {"Time_Start": 800.46, "Time_End": 803.46, "Text": " Although a couple years ago, we were actually released a public program"}, {"Time_Start": 803.46, "Time_End": 807.46, "Text": " and all of a sudden all the script kiddies can do it."}, {"Time_Start": 807.46, "Time_End": 809.46, "Text": " And all the script kiddies think is new technology."}, {"Time_Start": 809.46, "Time_End": 812.46, "Text": " Read a paper from a security period of 10 years ago."}, {"Time_Start": 812.46, "Time_End": 813.46, "Text": " It's all talked about."}, {"Time_Start": 813.46, "Time_End": 816.46, "Text": " It's like all of the attacks were talked about 15 years ago."}, {"Time_Start": 816.46, "Time_End": 818.46, "Text": " Here we are."}, {"Time_Start": 818.46, "Time_End": 819.46, "Text": " Basically, sin flooding allows a lot of technology."}, {"Time_Start": 819.46, "Time_End": 822.46, "Text": " attacker to die system, attacks a purport basis."}, {"Time_Start": 822.46, "Time_End": 823.46, "Text": " You can read."}, {"Time_Start": 823.46, "Time_End": 826.46, "Text": " Now, the way this simply works,"}, {"Time_Start": 826.46, "Time_End": 830.46, "Text": " again, we have my attacker system, non-existent, legitimate client."}, {"Time_Start": 830.46, "Time_End": 832.46, "Text": " It used to be that most information IP"}, {"Time_Start": 832.46, "Time_End": 836.46, "Text": " could only allow a certain number of starting connections."}, {"Time_Start": 836.46, "Time_End": 839.46, "Text": " Now, they can have an infinite amount of current connections,"}, {"Time_Start": 839.46, "Time_End": 842.46, "Text": " we're only a small amount of pending connections."}, {"Time_Start": 842.46, "Time_End": 845.46, "Text": " So if you're only allowed in pending connections,"}, {"Time_Start": 845.46, "Time_End": 847.46, "Text": " I can pick somebody and I go, hi."}, {"Time_Start": 847.46, "Time_End": 848.46, "Text": " And this person says hi back to me."}, {"Time_Start": 848.46, "Time_End": 850.46, "Text": " says hi back to me, but I don't respond to that."}, {"Time_Start": 850.46, "Time_End": 851.46, "Text": " Third person does it."}, {"Time_Start": 851.46, "Time_End": 852.46, "Text": " Fourth person does it."}, {"Time_Start": 852.46, "Time_End": 855.46, "Text": " Now his buffer is full of pending inbound connections."}, {"Time_Start": 855.46, "Time_End": 857.46, "Text": " And anybody else says hello to him."}, {"Time_Start": 857.46, "Time_End": 859.46, "Text": " He won't respond because he's too busy waiting for acknowledgment"}, {"Time_Start": 859.46, "Time_End": 861.46, "Text": " for me and the other people."}, {"Time_Start": 861.46, "Time_End": 862.46, "Text": " Understand?"}, {"Time_Start": 862.46, "Time_End": 863.46, "Text": " Hello?"}, {"Time_Start": 863.46, "Time_End": 867.46, "Text": " So, I sin flood that system."}, {"Time_Start": 867.46, "Time_End": 870.46, "Text": " Now, remember three, the handshake."}, {"Time_Start": 870.46, "Time_End": 873.46, "Text": " It sends all the acts to a non-existent into a black hole,"}, {"Time_Start": 873.46, "Time_End": 875.46, "Text": " a non-existent system."}, {"Time_Start": 875.46, "Time_End": 877.46, "Text": " Now, that victim system is waiting"}, {"Time_Start": 877.46, "Time_End": 880.46, "Text": " is waiting for the acknowledgement to its acts."}, {"Time_Start": 880.46, "Time_End": 883.46, "Text": " Are they going to come?"}, {"Time_Start": 883.46, "Time_End": 886.46, "Text": " No, we have to time out first."}, {"Time_Start": 886.46, "Time_End": 889.46, "Text": " So, since nobody can establish a new connection,"}, {"Time_Start": 889.46, "Time_End": 892.46, "Text": " a legitimate client cannot connect."}, {"Time_Start": 892.46, "Time_End": 896.46, "Text": " Now, if you're logged in the victim system,"}, {"Time_Start": 896.46, "Time_End": 897.46, "Text": " everything's just fine and dandy."}, {"Time_Start": 897.46, "Time_End": 900.46, "Text": " Your shell's working, you're typing away."}, {"Time_Start": 900.46, "Time_End": 902.46, "Text": " And the machine's load is nothing,"}, {"Time_Start": 902.46, "Time_End": 906.46, "Text": " but nobody else can establish any new connections."}, {"Time_Start": 906.46, "Time_End": 908.46, "Text": " What's the typical?"}, {"Time_Start": 908.46, "Time_End": 911.46, "Text": " It varies per host."}, {"Time_Start": 911.46, "Time_End": 915.46, "Text": " It's usually, I believe, I believe on 45 seconds, Puckus."}, {"Time_Start": 915.46, "Time_End": 916.46, "Text": " The average?"}, {"Time_Start": 916.46, "Time_End": 919.46, "Text": " It pretty much varies a lot per host."}, {"Time_Start": 919.46, "Time_End": 921.46, "Text": " There's a lot of software out there, actually."}, {"Time_Start": 921.46, "Time_End": 925.46, "Text": " More advanced firewalls these days will detect this."}, {"Time_Start": 925.46, "Time_End": 928.46, "Text": " And, you know, in the middle of the attacker victim system,"}, {"Time_Start": 928.46, "Time_End": 932.46, "Text": " the intelligent firewall or perhaps certain type of secure utilities,"}, {"Time_Start": 932.46, "Time_End": 935.46, "Text": " will start transmitting the resets, causing all the acts to be reset."}, {"Time_Start": 935.46, "Time_End": 936.46, "Text": " reset."}, {"Time_Start": 936.46, "Time_End": 937.46, "Text": " So"}, {"Time_Start": 937.46, "Time_End": 938.46, "Text": " So"}, {"Time_Start": 938.46, "Time_End": 939.46, "Text": " Do you use"}, {"Time_Start": 939.46, "Time_End": 940.46, "Text": " up in there"}, {"Time_Start": 940.46, "Time_End": 941.46, "Text": " can you"}, {"Time_Start": 941.46, "Time_End": 942.46, "Text": " have"}, {"Time_Start": 942.46, "Time_End": 943.46, "Text": " something"}, {"Time_Start": 943.46, "Time_End": 944.46, "Text": " and reachable?"}, {"Time_Start": 944.46, "Time_End": 947.46, "Text": " It depends"}, {"Time_Start": 947.46, "Time_End": 949.46, "Text": " on your"}, {"Time_Start": 949.46, "Time_End": 950.46, "Text": " firewall."}, {"Time_Start": 950.46, "Time_End": 951.46, "Text": " Some firewall"}, {"Time_Start": 951.46, "Time_End": 952.46, "Text": " type's by default"}, {"Time_Start": 952.46, "Time_End": 952.7, "Text": " to say host"}, {"Time_Start": 952.7, "Time_End": 953.46, "Text": " and reachable for any"}, {"Time_Start": 953.46, "Time_End": 954.46, "Text": " package they reject."}, {"Time_Start": 954.46, "Time_End": 955.46, "Text": " Some firewalls"}, {"Time_Start": 955.46, "Time_End": 956.46, "Text": " don't apply anything."}, {"Time_Start": 956.46, "Time_End": 957.46, "Text": " Other firewalls say"}, {"Time_Start": 957.46, "Time_End": 958.46, "Text": " never can reachable."}, {"Time_Start": 958.46, "Time_End": 959.46, "Text": " It really depends"}, {"Time_Start": 959.46, "Time_End": 960.46, "Text": " on what product"}, {"Time_Start": 960.46, "Time_End": 961.46, "Text": " or whose security"}, {"Time_Start": 961.46, "Time_End": 962.46, "Text": " company bought into."}, {"Time_Start": 962.46, "Time_End": 963.46, "Text": " What have you set"}, {"Time_Start": 963.46, "Time_End": 964.46, "Text": " in connection, though?"}, {"Time_Start": 964.46, "Time_End": 969.46, "Text": " Hopefully the firewall will reset will actually retrans with the connection."}, {"Time_Start": 969.46, "Time_End": 971.46, "Text": " Again, it really depends on your product."}, {"Time_Start": 971.46, "Time_End": 972.46, "Text": " I can't say what will want happen."}, {"Time_Start": 972.46, "Time_End": 975.46, "Text": " And most of my examples here, we're assuming there's no firewall involved."}, {"Time_Start": 975.46, "Time_End": 980.46, "Text": " And of course, you can't make the connection."}, {"Time_Start": 980.46, "Time_End": 983.46, "Text": " And thus, remote acts eviction systems block."}, {"Time_Start": 983.46, "Time_End": 984.46, "Text": " It takes very bandwidth."}, {"Time_Start": 984.46, "Time_End": 989.46, "Text": " You and your little dial-up of your ricochet modem can take out entire corporations this way."}, {"Time_Start": 989.46, "Time_End": 993.46, "Text": " This assumes that you're running an old version of Solaris or Sun-offs."}, {"Time_Start": 993.46, "Time_End": 996.46, "Text": " on us. Any modern system in the"}, {"Time_Start": 996.46, "Time_End": 999.46, "Text": " basically released in the last year or two is listen to this."}, {"Time_Start": 999.46, "Time_End": 1001.46, "Text": " Let's run into."}, {"Time_Start": 1001.46, "Time_End": 1007.46, "Text": " Again, strong filtering helps."}, {"Time_Start": 1007.46, "Time_End": 1010.46, "Text": " Since sniping."}, {"Time_Start": 1010.46, "Time_End": 1012.46, "Text": " There's a fun one."}, {"Time_Start": 1012.46, "Time_End": 1015.46, "Text": " Ever, like, be on a network and want to, like, shut people down?"}, {"Time_Start": 1015.46, "Time_End": 1018.46, "Text": " Well, this is how you do it."}, {"Time_Start": 1018.46, "Time_End": 1021.46, "Text": " Here's that layout again."}, {"Time_Start": 1021.46, "Time_End": 1022.46, "Text": " Here's that layout again."}, {"Time_Start": 1022.46, "Time_End": 1023.46, "Text": " Here's a little."}, {"Time_Start": 1023.46, "Time_End": 1024.46, "Text": " Is that sin packet again?"}, {"Time_Start": 1024.46, "Time_End": 1026.46, "Text": " Now remember how the three-way handshake?"}, {"Time_Start": 1026.46, "Time_End": 1029.46, "Text": " You remember how normally a connection fails?"}, {"Time_Start": 1029.46, "Time_End": 1035.46, "Text": " Now, you'd assume the reset would come from the person receiving a connection to serve on the right."}, {"Time_Start": 1035.46, "Time_End": 1038.46, "Text": " Instead, I fake the reset."}, {"Time_Start": 1038.46, "Time_End": 1042.46, "Text": " The Jima Client doesn't know any better."}, {"Time_Start": 1042.46, "Time_End": 1043.46, "Text": " Sin, reset."}, {"Time_Start": 1043.46, "Time_End": 1044.46, "Text": " Okay."}, {"Time_Start": 1044.46, "Time_End": 1046.46, "Text": " Port not open."}, {"Time_Start": 1046.46, "Time_End": 1052.46, "Text": " Now when the act does come along, the Jima Client sees a sin part of that and says,"}, {"Time_Start": 1052.46, "Time_End": 1054.46, "Text": " and says, reset."}, {"Time_Start": 1054.46, "Time_End": 1061.46, "Text": " Both machines did not establish TCP connection,"}, {"Time_Start": 1061.46, "Time_End": 1066.46, "Text": " and there are no errors in your logs."}, {"Time_Start": 1066.46, "Time_End": 1070.46, "Text": " Actually, the running away program will ARP watch is kind of fun,"}, {"Time_Start": 1070.46, "Time_End": 1072.46, "Text": " because ARP watch would notice that your,"}, {"Time_Start": 1072.46, "Time_End": 1076.46, "Text": " effectively, that your, the spoofed reset came from a wrong Mac address,"}, {"Time_Start": 1076.46, "Time_End": 1078.46, "Text": " but that could be fooled also."}, {"Time_Start": 1078.46, "Time_End": 1079.46, "Text": " Yes."}, {"Time_Start": 1079.46, "Time_End": 1081.46, "Text": " How do you do that?"}, {"Time_Start": 1081.46, "Time_End": 1082.46, "Text": " How do you know what you see?"}, {"Time_Start": 1082.46, "Time_End": 1085.46, "Text": " These old machines are on the same physical wire,"}, {"Time_Start": 1085.46, "Time_End": 1088.46, "Text": " on the same unswitched dumb hub,"}, {"Time_Start": 1088.46, "Time_End": 1092.46, "Text": " and the attacker sniffed the packet and said,"}, {"Time_Start": 1092.46, "Time_End": 1094.46, "Text": " oh, here it is, reset."}, {"Time_Start": 1094.46, "Time_End": 1097.46, "Text": " By the sequence number of the reset,"}, {"Time_Start": 1097.46, "Time_End": 1102.46, "Text": " your sequence number by default is zero unless you've established a sequence."}, {"Time_Start": 1102.46, "Time_End": 1106.46, "Text": " So in theory, the attacker can stream resets of sequence"}, {"Time_Start": 1106.46, "Time_End": 1110.46, "Text": " zero at legitimate client."}, {"Time_Start": 1110.46, "Time_End": 1111.46, "Text": " And a connection can never be established a sequence."}, {"Time_Start": 1111.46, "Time_End": 1113.46, "Text": " connection can never be established."}, {"Time_Start": 1117.46, "Time_End": 1119.46, "Text": " Again, the victim system can be selectively blocked."}, {"Time_Start": 1119.46, "Time_End": 1124.46, "Text": " It requires, as I pointed out, local or intermediate network access."}, {"Time_Start": 1124.46, "Time_End": 1128.46, "Text": " In other words, it has to be on one of the physical wires that this packet is traveling over"}, {"Time_Start": 1128.46, "Time_End": 1131.46, "Text": " to see the packets going back and forth."}, {"Time_Start": 1131.46, "Time_End": 1134.46, "Text": " And it's pretty hard to detect because you can always spoof that,"}, {"Time_Start": 1134.46, "Time_End": 1137.46, "Text": " you can basically spoof your Mac address, spoof your IP, spoof the IP address,"}, {"Time_Start": 1137.46, "Time_End": 1138.46, "Text": " obviously."}, {"Time_Start": 1138.46, "Time_End": 1140.46, "Text": " It's kind of a bearer track down."}, {"Time_Start": 1140.46, "Time_End": 1141.46, "Text": " Smart."}, {"Time_Start": 1141.46, "Time_End": 1145.46, "Text": " hubs help, buy your Cisco Catalyst, nice little VPN networks,"}, {"Time_Start": 1145.46, "Time_End": 1149.46, "Text": " spoof, you know, spoof protection, that I'll help a lot."}, {"Time_Start": 1149.46, "Time_End": 1153.46, "Text": " Then we don't know, but then, of course, I'd rather buy a nice car than decent, you know, 5500."}, {"Time_Start": 1153.46, "Time_End": 1157.46, "Text": " What, fully loaded Catalysts, $2,500 is like $110,000?"}, {"Time_Start": 1157.46, "Time_End": 1160.46, "Text": " Yeah."}, {"Time_Start": 1160.46, "Time_End": 1163.46, "Text": " Security is expensive sometimes."}, {"Time_Start": 1163.46, "Time_End": 1166.46, "Text": " Ping of death, we all know about this one."}, {"Time_Start": 1166.46, "Time_End": 1169.46, "Text": " It's really simple. This is a commonly implemented."}, {"Time_Start": 1169.46, "Time_End": 1171.44, "Text": " It can be any type of IP packet, but it's kind of"}, {"Time_Start": 1171.46, "Time_End": 1174.46, "Text": " normally implemented as a ping."}, {"Time_Start": 1174.46, "Time_End": 1176.46, "Text": " It implements a bug in layer 3."}, {"Time_Start": 1176.46, "Time_End": 1179.46, "Text": " Now, in all protocols, or most packet protocols,"}, {"Time_Start": 1179.46, "Time_End": 1181.46, "Text": " this is the concept of maximum size packet."}, {"Time_Start": 1181.46, "Time_End": 1185.46, "Text": " In pink of death, the error was,"}, {"Time_Start": 1185.46, "Time_End": 1190.46, "Text": " we would allocate a packet size, that's 65K,"}, {"Time_Start": 1190.46, "Time_End": 1193.46, "Text": " and then I would transmit a ping packet, which was fragmented."}, {"Time_Start": 1193.46, "Time_End": 1196.46, "Text": " When you reassembled all the parts of that packet,"}, {"Time_Start": 1196.46, "Time_End": 1198.46, "Text": " it was larger than the buffer."}, {"Time_Start": 1198.46, "Time_End": 1200.46, "Text": " So you received your first fragment, you write it to the buffer."}, {"Time_Start": 1200.46, "Time_End": 1201.46, "Text": " You see the second fragment,"}, {"Time_Start": 1201.46, "Time_End": 1202.46, "Text": " write it to the buffer."}, {"Time_Start": 1202.46, "Time_End": 1204.46, "Text": " Receive your third, right at the buffer."}, {"Time_Start": 1204.46, "Time_End": 1205.46, "Text": " You see your fourth."}, {"Time_Start": 1205.46, "Time_End": 1206.46, "Text": " Over the edge."}, {"Time_Start": 1206.46, "Time_End": 1208.46, "Text": " And you overwrite parts of your system or kernel memory."}, {"Time_Start": 1208.46, "Time_End": 1212.46, "Text": " A.K.A. Blue Screen of Death."}, {"Time_Start": 1212.46, "Time_End": 1217.46, "Text": " This worked on about every machine out there for a while."}, {"Time_Start": 1217.46, "Time_End": 1222.46, "Text": " Again, this has been known for about a decade."}, {"Time_Start": 1222.46, "Time_End": 1228.46, "Text": " Only really came to public light about a year or two ago."}, {"Time_Start": 1228.46, "Time_End": 1230.46, "Text": " Basic options?"}, {"Time_Start": 1230.46, "Time_End": 1231.46, "Text": " If you have a firewall,"}, {"Time_Start": 1231.46, "Time_End": 1235.46, "Text": " control of filter fragmented packets. There's no reason to allow"}, {"Time_Start": 1235.46, "Time_End": 1237.46, "Text": " a fragmented packet through your network."}, {"Time_Start": 1237.46, "Time_End": 1241.46, "Text": " Well, you want to say why? Well, why should a packet be fragmented?"}, {"Time_Start": 1241.46, "Time_End": 1244.46, "Text": " If you have a healthy network going over a healthy internet"}, {"Time_Start": 1244.46, "Time_End": 1248.46, "Text": " into your healthy network, fragmentation should not happen."}, {"Time_Start": 1248.46, "Time_End": 1251.46, "Text": " Your only time fragmentation can possibly happen if you have a large packet network,"}, {"Time_Start": 1251.46, "Time_End": 1253.46, "Text": " for example, FTDI,"}, {"Time_Start": 1253.46, "Time_End": 1257.46, "Text": " being retransmitted over Ethernet, which has smaller packets,"}, {"Time_Start": 1257.46, "Time_End": 1260.46, "Text": " at which point go fragment. But if you configure your network to do that,"}, {"Time_Start": 1260.46, "Time_End": 1261.46, "Text": " you should see that."}, {"Time_Start": 1261.46, "Time_End": 1263.46, "Text": " suffer."}, {"Time_Start": 1263.46, "Time_End": 1270.46, "Text": " Again, so just filter fragmented packets."}, {"Time_Start": 1270.46, "Time_End": 1275.46, "Text": " I think on the average, if you're on a website, you can lose up the 10% of,"}, {"Time_Start": 1275.46, "Time_End": 1278.46, "Text": " I think it's maximum 10% of people trying to connect to you."}, {"Time_Start": 1278.46, "Time_End": 1280.46, "Text": " Sometimes it's 2%."}, {"Time_Start": 1280.46, "Time_End": 1281.46, "Text": " As far as I'm concerned, tough."}, {"Time_Start": 1281.46, "Time_End": 1283.46, "Text": " They have a broken network."}, {"Time_Start": 1283.46, "Time_End": 1286.46, "Text": " Now, permutations of this."}, {"Time_Start": 1286.46, "Time_End": 1288.46, "Text": " Teardrop attack."}, {"Time_Start": 1288.46, "Time_End": 1290.46, "Text": " And so we have IP fragment flooding."}, {"Time_Start": 1290.46, "Time_End": 1294.46, "Text": " been flooding, that is micro fragments, overlapping."}, {"Time_Start": 1294.46, "Time_End": 1295.46, "Text": " It's fun stuff."}, {"Time_Start": 1295.46, "Time_End": 1297.46, "Text": " Overlapping fragments are fun."}, {"Time_Start": 1297.46, "Time_End": 1300.46, "Text": " Effectively, Teardrop is a widely available tool."}, {"Time_Start": 1300.46, "Time_End": 1301.46, "Text": " Anybody could download it, Root Shell."}, {"Time_Start": 1301.46, "Time_End": 1306.46, "Text": " I kind of hate Roach Shell for this, because they have umpteen versions of teardrop,"}, {"Time_Start": 1306.46, "Time_End": 1309.46, "Text": " yet they don't say what the Teardrop attack is."}, {"Time_Start": 1309.46, "Time_End": 1314.46, "Text": " Would it be nice for those hacker websites out there actually bothered to write even a paragraph"}, {"Time_Start": 1314.46, "Time_End": 1317.46, "Text": " to say what it is, why don't have to come up here, explain them to you?"}, {"Time_Start": 1317.46, "Time_End": 1319.46, "Text": " No, that might take effort."}, {"Time_Start": 1319.46, "Time_End": 1323.46, "Text": " Oh, that might take effort."}, {"Time_Start": 1323.46, "Time_End": 1329.46, "Text": " This is mostly Linux, NNT, basically Linux and Windows are mostly vulnerable to this."}, {"Time_Start": 1329.46, "Time_End": 1333.46, "Text": " Linux should be upgraded, perhaps FreeBST."}, {"Time_Start": 1333.46, "Time_End": 1339.46, "Text": " And if you want FreeBST, we have free CDs in the conference area."}, {"Time_Start": 1339.46, "Time_End": 1343.46, "Text": " Unlike Linux, FreeBST is free."}, {"Time_Start": 1343.46, "Time_End": 1346.46, "Text": " How much is Red Hat?"}, {"Time_Start": 1346.46, "Time_End": 1348.46, "Text": " They jack up the prices, actually."}, {"Time_Start": 1348.46, "Time_End": 1352.46, "Text": " And by right, they wouldn't make any available for free at DefCon."}, {"Time_Start": 1352.46, "Time_End": 1357.46, "Text": " And I'm not going to rank on them too much."}, {"Time_Start": 1357.46, "Time_End": 1360.46, "Text": " I'll do that in a bar later."}, {"Time_Start": 1360.46, "Time_End": 1364.46, "Text": " Okay, again, IP filtering helps."}, {"Time_Start": 1364.46, "Time_End": 1367.46, "Text": " Generally what happens is you have a badly formed fragment,"}, {"Time_Start": 1367.46, "Time_End": 1369.46, "Text": " so you have one fragment comes in,"}, {"Time_Start": 1369.46, "Time_End": 1371.46, "Text": " you have a bodily formed packet that comes in"}, {"Time_Start": 1371.46, "Time_End": 1373.46, "Text": " that tries to process a packet,"}, {"Time_Start": 1373.46, "Time_End": 1374.46, "Text": " machine burps."}, {"Time_Start": 1374.46, "Time_End": 1377.46, "Text": " In other words, it wasn't analyzing the fragments"}, {"Time_Start": 1377.46, "Time_End": 1378.46, "Text": " as it came in."}, {"Time_Start": 1378.46, "Time_End": 1381.46, "Text": " and made the assumption that the offset in the packet was correct."}, {"Time_Start": 1381.46, "Time_End": 1384.46, "Text": " It would, well, inside the packet in a fragment,"}, {"Time_Start": 1384.46, "Time_End": 1387.46, "Text": " you effectively, I didn't kind of skip that in Punks"}, {"Time_Start": 1387.46, "Time_End": 1391.46, "Text": " talking about after breakfast, so in case he explains to you, I'm sorry."}, {"Time_Start": 1391.46, "Time_End": 1393.46, "Text": " But effectively, in a packet, if you're fragmented,"}, {"Time_Start": 1393.46, "Time_End": 1395.46, "Text": " it was an offset reference."}, {"Time_Start": 1395.46, "Time_End": 1398.46, "Text": " Well, if that offset reference doesn't match the content of the packet,"}, {"Time_Start": 1398.46, "Time_End": 1402.46, "Text": " your program might be tricky to doing something wrong and blowing up."}, {"Time_Start": 1402.46, "Time_End": 1404.46, "Text": " Another fun thing, this is not in my slides,"}, {"Time_Start": 1404.46, "Time_End": 1407.46, "Text": " but one great way, you used to be able to take out Cisco routers about eight years ago."}, {"Time_Start": 1407.46, "Time_End": 1411.46, "Text": " eight years ago, is an IP of lots of variable options."}, {"Time_Start": 1411.46, "Time_End": 1416.46, "Text": " And the way the header assembles is there's a byte offset to next option."}, {"Time_Start": 1416.46, "Time_End": 1421.46, "Text": " And the way the computer works is, you know, take current address, add option,"}, {"Time_Start": 1421.46, "Time_End": 1423.46, "Text": " you know, add offset, and process current option."}, {"Time_Start": 1423.46, "Time_End": 1426.46, "Text": " If you set that byte to zero, what does the machine do?"}, {"Time_Start": 1426.46, "Time_End": 1430.46, "Text": " Reprocess that option until the power goes out."}, {"Time_Start": 1430.46, "Time_End": 1434.46, "Text": " On a single-threaded TIP stack like Linux,"}, {"Time_Start": 1434.46, "Time_End": 1436.46, "Text": " you could really..."}, {"Time_Start": 1436.46, "Time_End": 1440.46, "Text": " Your machine really just comes to all, literally, it just stops."}, {"Time_Start": 1440.46, "Time_End": 1445.46, "Text": " If you're multi-threaded, you know, multi-threaded like any Solaris or BSD machine,"}, {"Time_Start": 1445.46, "Time_End": 1446.46, "Text": " it's not a problem."}, {"Time_Start": 1446.46, "Time_End": 1449.46, "Text": " It'll just eat up a thread which eventually die."}, {"Time_Start": 1449.46, "Time_End": 1453.46, "Text": " Again, fragment flooding, there's another fun one."}, {"Time_Start": 1453.46, "Time_End": 1456.46, "Text": " When fragments come in, as you realize, you need to do with these things."}, {"Time_Start": 1456.46, "Time_End": 1459.46, "Text": " Sometimes fragments will show up in order."}, {"Time_Start": 1459.46, "Time_End": 1462.46, "Text": " So you're getting snippets of articles coming in, snippets of packets,"}, {"Time_Start": 1462.46, "Time_End": 1465.46, "Text": " so you've got to store them in memory somewhere until the other part comes up,"}, {"Time_Start": 1465.46, "Time_End": 1469.46, "Text": " other part comes up, you connect them together and then pass it on to the upper layer,"}, {"Time_Start": 1469.46, "Time_End": 1470.46, "Text": " you know, to the application layer."}, {"Time_Start": 1470.46, "Time_End": 1474.46, "Text": " What if I send lots and lots of random fragments to your machine?"}, {"Time_Start": 1474.46, "Time_End": 1476.46, "Text": " What happens to your RAM space?"}, {"Time_Start": 1476.46, "Time_End": 1480.46, "Text": " It fills up with useless garbage."}, {"Time_Start": 1480.46, "Time_End": 1483.46, "Text": " NT, you're really vulnerable to this."}, {"Time_Start": 1483.46, "Time_End": 1487.46, "Text": " Linux and the BSDs are actually pretty good about this."}, {"Time_Start": 1487.46, "Time_End": 1490.46, "Text": " When they begin to run out of memory, you start just dumping the packets."}, {"Time_Start": 1490.46, "Time_End": 1494.46, "Text": " You know, because what happens is if the packet wasn't properly acknowledged,"}, {"Time_Start": 1494.46, "Time_End": 1495.46, "Text": " it would be retransmigmsmit."}, {"Time_Start": 1495.46, "Time_End": 1497.46, "Text": " recent, it's not a problem."}, {"Time_Start": 1497.46, "Time_End": 1504.46, "Text": " But there's a good way of eating up lots of CPU resources and run out of RAM real fast."}, {"Time_Start": 1504.46, "Time_End": 1508.46, "Text": " In other words, micro fragments."}, {"Time_Start": 1508.46, "Time_End": 1513.46, "Text": " Let's make fragments so small, you don't recognize what they are."}, {"Time_Start": 1513.46, "Time_End": 1520.46, "Text": " So if I fragment, now mind you, we had the TC, we had, you know, Ethernet, IP, TCP."}, {"Time_Start": 1520.46, "Time_End": 1524.46, "Text": " If you filter it at the TCP layer, it's assumed you could read the entire TCP practice."}, {"Time_Start": 1524.46, "Time_End": 1528.46, "Text": " entire TCP packet, at least a header part."}, {"Time_Start": 1528.46, "Time_End": 1534.46, "Text": " Or what if I fragment my packet so small, you can't read the header as a full part?"}, {"Time_Start": 1534.46, "Time_End": 1536.46, "Text": " Do you still filter?"}, {"Time_Start": 1536.46, "Time_End": 1537.46, "Text": " No, what do you do?"}, {"Time_Start": 1537.46, "Time_End": 1539.46, "Text": " Well, we'll probably pass it through."}, {"Time_Start": 1539.46, "Time_End": 1544.46, "Text": " So what you do is you're fragment your packets so small, each one is not identified as a problem."}, {"Time_Start": 1544.46, "Time_End": 1548.46, "Text": " Simple."}, {"Time_Start": 1548.46, "Time_End": 1550.46, "Text": " Yes?"}, {"Time_Start": 1550.46, "Time_End": 1553.46, "Text": " But the viable base here, and I'm always in,"}, {"Time_Start": 1553.46, "Time_End": 1557.46, "Text": " A firewall policy of dropping all fragments would help a lot."}, {"Time_Start": 1557.46, "Time_End": 1560.46, "Text": " Certain firewalls actually do reassembly."}, {"Time_Start": 1560.46, "Time_End": 1564.46, "Text": " I believe the Cisco had a firewall that's just discontinued."}, {"Time_Start": 1564.46, "Time_End": 1566.46, "Text": " The NT-based one."}, {"Time_Start": 1566.46, "Time_End": 1571.46, "Text": " Yeah, Century was pretty good because the Century actually had a packet"}, {"Time_Start": 1571.46, "Time_End": 1576.46, "Text": " policy that would reassemble fragments for passing them on."}, {"Time_Start": 1576.46, "Time_End": 1577.46, "Text": " It's actually pretty good."}, {"Time_Start": 1577.46, "Time_End": 1579.46, "Text": " It's a bit memory intensive, but it worked."}, {"Time_Start": 1579.46, "Time_End": 1582.46, "Text": " Most of the firewalls were simply forward the fragments."}, {"Time_Start": 1582.46, "Time_End": 1588.46, "Text": " fragments. The PICS firewalls option is only pass fragments when they come in order."}, {"Time_Start": 1588.46, "Time_End": 1594.46, "Text": " So the, obviously, the micro fragments may or may at work, actually, I think it just drops those."}, {"Time_Start": 1594.46, "Time_End": 1600.46, "Text": " The overlapping fragments and the fragment flooding would not work because it only allows fragments in order."}, {"Time_Start": 1600.46, "Time_End": 1605.46, "Text": " Mind you, this breaks Linux because when Linux fragments, it breaks a packet maybe three parts."}, {"Time_Start": 1605.46, "Time_End": 1608.46, "Text": " It says the last part first, and the first part last."}, {"Time_Start": 1608.46, "Time_End": 1611.46, "Text": " So the PICS firewall simply drops the packet because this gets, you know, it gets fragments."}, {"Time_Start": 1611.46, "Time_End": 1615.46, "Text": " this gets fragments, you know, four, then three, then two, than one."}, {"Time_Start": 1615.46, "Time_End": 1619.46, "Text": " When it gets packet four, it goes, where's three, two, one, ditch it, because this is a random fragment."}, {"Time_Start": 1619.46, "Time_End": 1624.46, "Text": " I don't know if that's a bugging Linux or a bugging pics, but, oh well."}, {"Time_Start": 1624.46, "Time_End": 1627.46, "Text": " Questions?"}, {"Time_Start": 1627.46, "Time_End": 1629.46, "Text": " Okay, other fun things."}, {"Time_Start": 1629.46, "Time_End": 1631.46, "Text": " Do you all worry about sniffing?"}, {"Time_Start": 1631.46, "Time_End": 1632.46, "Text": " Yeah."}, {"Time_Start": 1632.46, "Time_End": 1634.46, "Text": " Okay, you get your password stolen?"}, {"Time_Start": 1634.46, "Time_End": 1635.46, "Text": " Uh-huh."}, {"Time_Start": 1635.46, "Time_End": 1636.46, "Text": " Upcash poison is a fun one."}, {"Time_Start": 1636.46, "Time_End": 1640.46, "Text": " Now, mind you, so far, if you know, if you don't have to work my way down that protocol stack."}, {"Time_Start": 1640.46, "Time_End": 1646.46, "Text": " Every time I explain a fix, I'm going to break it again in about five minutes."}, {"Time_Start": 1646.46, "Time_End": 1648.46, "Text": " Now, Sniffy's a fun one."}, {"Time_Start": 1648.46, "Time_End": 1651.46, "Text": " Don't you look at a little number on the bottom?"}, {"Time_Start": 1651.46, "Time_End": 1653.46, "Text": " 85% of attacks?"}, {"Time_Start": 1653.46, "Time_End": 1656.46, "Text": " I love these kids that call themselves hackers because they get,"}, {"Time_Start": 1656.46, "Time_End": 1658.46, "Text": " they're break into one ISPs, two passwords,"}, {"Time_Start": 1658.46, "Time_End": 1660.46, "Text": " breaking another ISP to passwords,"}, {"Time_Start": 1660.46, "Time_End": 1662.46, "Text": " when are you actually showing technique?"}, {"Time_Start": 1662.46, "Time_End": 1667.46, "Text": " Now, sniffing is easy for the person who hasn't figured it out yet."}, {"Time_Start": 1667.46, "Time_End": 1669.46, "Text": " It's simply an intersection of data."}, {"Time_Start": 1669.46, "Time_End": 1670.46, "Text": " As clients says,"}, {"Time_Start": 1670.46, "Time_End": 1675.46, "Text": " the server, my notebook sitting on your machine, has your password."}, {"Time_Start": 1675.46, "Time_End": 1679.46, "Text": " Anybody use any of these applications or protocols?"}, {"Time_Start": 1679.46, "Time_End": 1680.46, "Text": " Hands?"}, {"Time_Start": 1680.46, "Time_End": 1682.46, "Text": " Come on."}, {"Time_Start": 1682.46, "Time_End": 1685.46, "Text": " Your password has been stolen."}, {"Time_Start": 1685.46, "Time_End": 1689.46, "Text": " Telnet, clear text, unencrypted."}, {"Time_Start": 1689.46, "Time_End": 1692.46, "Text": " Our login, clear text, unencrypted."}, {"Time_Start": 1692.46, "Time_End": 1694.46, "Text": " Well, pop, IMap, clear text."}, {"Time_Start": 1694.46, "Time_End": 1697.46, "Text": " A-pop is kind of, if you're a pop, okay, then you're a little bit safer."}, {"Time_Start": 1697.46, "Time_End": 1698.46, "Text": " I can't read your mail."}, {"Time_Start": 1698.46, "Time_End": 1699.46, "Text": " I can't read your password."}, {"Time_Start": 1699.46, "Time_End": 1708.46, "Text": " HTTP, when your little dialog box pops up, you type your name and password, clear text."}, {"Time_Start": 1708.46, "Time_End": 1712.46, "Text": " FTP, clear text."}, {"Time_Start": 1712.46, "Time_End": 1714.46, "Text": " Simple mail transfer, clear text."}, {"Time_Start": 1714.46, "Time_End": 1717.46, "Text": " Simple network management, clear text."}, {"Time_Start": 1717.46, "Time_End": 1720.46, "Text": " RPC, NFS, clear text."}, {"Time_Start": 1720.46, "Time_End": 1725.46, "Text": " All of which are available to be listened to over your network."}, {"Time_Start": 1725.46, "Time_End": 1727.46, "Text": " Do you all secure?"}, {"Time_Start": 1727.46, "Time_End": 1728.46, "Text": " No."}, {"Time_Start": 1728.46, "Time_End": 1730.46, "Text": " Have you used SSH?"}, {"Time_Start": 1730.46, "Time_End": 1739.46, "Text": " SSL will provide encryption."}, {"Time_Start": 1739.46, "Time_End": 1742.46, "Text": " Although one minor plug again or four against a cell."}, {"Time_Start": 1742.46, "Time_End": 1746.46, "Text": " SSL simply means the person cannot listen to your packets between you and the server."}, {"Time_Start": 1746.46, "Time_End": 1749.46, "Text": " It does not mean the server is secure."}, {"Time_Start": 1749.46, "Time_End": 1751.46, "Text": " Well, my pet peeves, like, we're secure, we use SSL."}, {"Time_Start": 1751.46, "Time_End": 1754.46, "Text": " That doesn't mean they're secure."}, {"Time_Start": 1754.46, "Time_End": 1756.46, "Text": " It means that the data getting to them is encrypted."}, {"Time_Start": 1756.46, "Time_End": 1757.46, "Text": " The second is headed off to their applications."}, {"Time_Start": 1757.46, "Time_End": 1759.46, "Text": " off to their applications is clear text."}, {"Time_Start": 1759.46, "Time_End": 1764.46, "Text": " This second, just name a few, be aware."}, {"Time_Start": 1764.46, "Time_End": 1767.46, "Text": " Download SSH, download Secure CRT, use it."}, {"Time_Start": 1767.46, "Time_End": 1770.46, "Text": " If your ICP isn't supported, tell them to."}, {"Time_Start": 1770.46, "Time_End": 1773.46, "Text": " If they don't, get a new ISP."}, {"Time_Start": 1773.46, "Time_End": 1777.46, "Text": " Best protection, buy a smart hub."}, {"Time_Start": 1777.46, "Time_End": 1780.46, "Text": " I know, it's kind of expensive, but you got to do it if you're going to be serious."}, {"Time_Start": 1780.46, "Time_End": 1783.46, "Text": " Use SSH, use Kerbrose, that's kind of nice."}, {"Time_Start": 1783.46, "Time_End": 1786.46, "Text": " Those DES channel up is not really widely distributed as it should be."}, {"Time_Start": 1786.46, "Time_End": 1792.46, "Text": " be whenever possible remove miscus mode on my home site you can't sniff"}, {"Time_Start": 1792.46, "Time_End": 1796.46, "Text": " I've rebuilt all my kernels and I remove the capability from sniffing from my kernels"}, {"Time_Start": 1796.46, "Time_End": 1802.46, "Text": " go ahead root my system people do all the time you can't sniff"}, {"Time_Start": 1802.46, "Time_End": 1806.46, "Text": " makes your network a little more secure"}, {"Time_Start": 1806.46, "Time_End": 1812.46, "Text": " well to rebuild the kernel be kind of nice but you got to replace the kernel but"}, {"Time_Start": 1812.46, "Time_End": 1816.44, "Text": " because it's in usable file you need to reboot the machine from console and"}, {"Time_Start": 1816.46, "Time_End": 1818.46, "Text": " install it."}, {"Time_Start": 1818.46, "Time_End": 1820.46, "Text": " Which is kind of a pain in the ass because I have to be there,"}, {"Time_Start": 1820.46, "Time_End": 1822.46, "Text": " a console, to install it."}, {"Time_Start": 1822.46, "Time_End": 1828.46, "Text": " Maybe by Cal, lots of beer, I'll stick in the war room and do it for me, but I don't know."}, {"Time_Start": 1828.46, "Time_End": 1831.46, "Text": " Let's see, about a local ethernet, this is common macadress poisoning."}, {"Time_Start": 1831.46, "Time_End": 1832.46, "Text": " I love this."}, {"Time_Start": 1832.46, "Time_End": 1836.46, "Text": " But I told you about all the different ways about TCIP and how you can fool things and redirect things."}, {"Time_Start": 1836.46, "Time_End": 1839.46, "Text": " Well, let's go one layer, let's go like layer two."}, {"Time_Start": 1839.46, "Time_End": 1844.46, "Text": " Ethernet level. Press anybody to impersonate anybody on your local land."}, {"Time_Start": 1844.46, "Time_End": 1845.46, "Text": " Hmm."}, {"Time_Start": 1845.46, "Time_End": 1846.46, "Text": " Hmm."}, {"Time_Start": 1846.46, "Time_End": 1847.46, "Text": " Yeah, I love these."}, {"Time_Start": 1847.46, "Time_End": 1848.46, "Text": " We have a secure IP coming out."}, {"Time_Start": 1848.46, "Time_End": 1850.46, "Text": " We're doing all the secure stuff with IP."}, {"Time_Start": 1850.46, "Time_End": 1853.46, "Text": " We're encrypting our packets and everything else."}, {"Time_Start": 1853.46, "Time_End": 1854.46, "Text": " Well, it's too bad."}, {"Time_Start": 1854.46, "Time_End": 1856.46, "Text": " I just blew your foundation away."}, {"Time_Start": 1856.46, "Time_End": 1859.46, "Text": " By the denial of service, a lot of redirects."}, {"Time_Start": 1859.46, "Time_End": 1861.46, "Text": " Now, how does our cache work?"}, {"Time_Start": 1861.46, "Time_End": 1865.46, "Text": " Well, you run a network, every network, every Ether card has, in theory,"}, {"Time_Start": 1865.46, "Time_End": 1868.46, "Text": " a unique Mac address."}, {"Time_Start": 1868.46, "Time_End": 1872.46, "Text": " And also a lot of unique IP addresses, hopefully it's a unique IP address."}, {"Time_Start": 1872.46, "Time_End": 1874.46, "Text": " How do the machines figure out who is who?"}, {"Time_Start": 1874.46, "Time_End": 1875.46, "Text": " Well, something called AR."}, {"Time_Start": 1875.46, "Time_End": 1880.46, "Text": " So, host, 3.4 does it transmit?"}, {"Time_Start": 1880.46, "Time_End": 1882.46, "Text": " Hey, who's 3.8?"}, {"Time_Start": 1882.46, "Time_End": 1885.46, "Text": " That's a broadcast over the local Ethernet."}, {"Time_Start": 1885.46, "Time_End": 1888.46, "Text": " That machine applies, hey, that's me."}, {"Time_Start": 1888.46, "Time_End": 1893.46, "Text": " Oh, fee notification. That's a Mac address number."}, {"Time_Start": 1893.46, "Time_End": 1897.46, "Text": " The first several bytes are, you can pretty much tell what kind of host I'm working with here"}, {"Time_Start": 1897.46, "Time_End": 1899.46, "Text": " by looking at first several bytes."}, {"Time_Start": 1899.46, "Time_End": 1902.46, "Text": " I'll leave that to your own figuring out, what kind of machine I have at home."}, {"Time_Start": 1902.46, "Time_End": 1904.46, "Text": " And the second set of bytes are the host type."}, {"Time_Start": 1904.46, "Time_End": 1905.46, "Text": " type."}, {"Time_Start": 1905.46, "Time_End": 1909.46, "Text": " But by just looking at the Mac address, you can tell the hardware type."}, {"Time_Start": 1909.46, "Time_End": 1912.46, "Text": " So, in the case of a break-in, what happens?"}, {"Time_Start": 1912.46, "Time_End": 1914.46, "Text": " Here we are with that little transmission."}, {"Time_Start": 1914.46, "Time_End": 1916.46, "Text": " Hey, who is this person?"}, {"Time_Start": 1916.46, "Time_End": 1918.46, "Text": " I lie."}, {"Time_Start": 1922.46, "Time_End": 1924.46, "Text": " Where would the IP packets go?"}, {"Time_Start": 1924.46, "Time_End": 1926.46, "Text": " Straight down."}, {"Time_Start": 1926.46, "Time_End": 1930.46, "Text": " By the way, Loft will be announcing a product this weekend."}, {"Time_Start": 1930.46, "Time_End": 1933.46, "Text": " If you're interested in this stuff, look for the announcement."}, {"Time_Start": 1934.46, "Time_End": 1939.46, "Text": " So, up cash blazing by a smart switch, by smart hub."}, {"Time_Start": 1939.46, "Time_End": 1941.46, "Text": " Oh, one more quick thing about this."}, {"Time_Start": 1941.46, "Time_End": 1944.46, "Text": " You don't have to wait for the request."}, {"Time_Start": 1944.46, "Time_End": 1947.46, "Text": " A lot of applications will just accept a packet."}, {"Time_Start": 1947.46, "Time_End": 1949.46, "Text": " Just get on a network saying,"}, {"Time_Start": 1949.46, "Time_End": 1951.46, "Text": " Hi, I'm the new router here."}, {"Time_Start": 1951.46, "Time_End": 1953.46, "Text": " I'm this manager running address."}, {"Time_Start": 1953.46, "Time_End": 1955.46, "Text": " A lot of machines are like, oh, okay, update the cache,"}, {"Time_Start": 1955.46, "Time_End": 1957.46, "Text": " and start sending information to you."}, {"Time_Start": 1957.46, "Time_End": 1963.46, "Text": " And of course, I don't believe in, hand out things that hand out fix."}, {"Time_Start": 1963.46, "Time_End": 1965.46, "Text": " things that hand out fixes."}, {"Time_Start": 1965.46, "Time_End": 1968.46, "Text": " Again, mortgage the house by a smart hub or switch."}, {"Time_Start": 1968.46, "Time_End": 1972.46, "Text": " Whatever possible, remove some riskless mode from your kernel."}, {"Time_Start": 1972.46, "Time_End": 1974.46, "Text": " That's like a broken record."}, {"Time_Start": 1974.46, "Time_End": 1976.46, "Text": " When network, ARP watch is really good."}, {"Time_Start": 1976.46, "Time_End": 1979.46, "Text": " Arpwatch is a program that a friend of mine wrote."}, {"Time_Start": 1979.46, "Time_End": 1986.46, "Text": " It basically listens to your network and keeps a table of IP addresses to Ethernet addresses."}, {"Time_Start": 1986.46, "Time_End": 1989.46, "Text": " If someone gets, if a new one shows up, it says a notification,"}, {"Time_Start": 1989.46, "Time_End": 1992.46, "Text": " hey, new IP address, or, hey, new Mac address."}, {"Time_Start": 1992.46, "Time_End": 1993.46, "Text": " If somebody, you know, you can't address."}, {"Time_Start": 1993.46, "Time_End": 1997.46, "Text": " uses somebody else's IP address, it goes, hey, that changed."}, {"Time_Start": 1997.46, "Time_End": 2000.46, "Text": " So if I plug this my notebook into your network"}, {"Time_Start": 2000.46, "Time_End": 2003.46, "Text": " and start trying to take over your identity,"}, {"Time_Start": 2003.46, "Time_End": 2005.46, "Text": " what happens?"}, {"Time_Start": 2005.46, "Time_End": 2006.46, "Text": " At least I don't know about it."}, {"Time_Start": 2006.46, "Time_End": 2008.46, "Text": " It's really good for people running large sites."}, {"Time_Start": 2008.46, "Time_End": 2010.46, "Text": " When people that you have employees,"}, {"Time_Start": 2010.46, "Time_End": 2013.46, "Text": " bringing new computers in or moving computers run a network,"}, {"Time_Start": 2013.46, "Time_End": 2015.46, "Text": " catches them real fast."}, {"Time_Start": 2015.46, "Time_End": 2019.46, "Text": " On stable networks, other words, places aren't being re-IP addressed all the time."}, {"Time_Start": 2019.46, "Time_End": 2022.46, "Text": " Go to your servers, preferably Unix,"}, {"Time_Start": 2022.46, "Time_End": 2023.46, "Text": " you can also do this on end up."}, {"Time_Start": 2023.46, "Time_End": 2025.46, "Text": " or you figure out where that menu is by yourself."}, {"Time_Start": 2025.46, "Time_End": 2028.46, "Text": " And you can permanently insert into an ARP table."}, {"Time_Start": 2028.46, "Time_End": 2031.46, "Text": " And that's the command ARP-S, IP address,"}, {"Time_Start": 2031.46, "Time_End": 2033.46, "Text": " MAC address, and Pub."}, {"Time_Start": 2033.46, "Time_End": 2037.46, "Text": " That will permanently insert that MAC address into your kernel table."}, {"Time_Start": 2037.46, "Time_End": 2040.46, "Text": " Which means they ignore the broadcasts."}, {"Time_Start": 2040.46, "Time_End": 2044.46, "Text": " If you have your mail server, your DNS server, all your different servers,"}, {"Time_Start": 2044.46, "Time_End": 2045.46, "Text": " I hope you're not run on the same machine."}, {"Time_Start": 2045.46, "Time_End": 2048.46, "Text": " That's another foolish thing you do, but that's different talk."}, {"Time_Start": 2048.46, "Time_End": 2052.46, "Text": " I hope each of your major network services runs on dedicated individual hardware."}, {"Time_Start": 2052.46, "Time_End": 2053.46, "Text": " And I hope you're not on the same machine."}, {"Time_Start": 2053.46, "Time_End": 2058.36, "Text": " I hope when you get home that you go and you hardcode your Mac addresses between servers."}, {"Time_Start": 2058.36, "Time_End": 2060.46, "Text": " This way no one can spoof."}, {"Time_Start": 2060.46, "Time_End": 2064.46, "Text": " Mind you, when a machine crashes and you replace the Ethernet card,"}, {"Time_Start": 2064.46, "Time_End": 2067.46, "Text": " life will be bad."}, {"Time_Start": 2067.46, "Time_End": 2073.46, "Text": " You have to go to every fucking machine and re-program and redo your uptable."}, {"Time_Start": 2073.46, "Time_End": 2075.46, "Text": " But, good luck."}, {"Time_Start": 2075.46, "Time_End": 2081.46, "Text": " And this doesn't quite work with transit networks, DHCP-based stuff."}, {"Time_Start": 2081.46, "Time_End": 2082.46, "Text": " Pardon me, right, unique."}, {"Time_Start": 2083.46, "Time_End": 2089.46, "Text": " Mac addresses found in the same name?"}, {"Time_Start": 2089.46, "Time_End": 2090.46, "Text": " Yes and no."}, {"Time_Start": 2090.46, "Time_End": 2094.46, "Text": " Most cards, most new cards you actually have, the Mac addresses change,"}, {"Time_Start": 2094.46, "Time_End": 2095.46, "Text": " usually programming."}, {"Time_Start": 2095.46, "Time_End": 2098.46, "Text": " By default, the Mac address is assigned to the card"}, {"Time_Start": 2098.46, "Time_End": 2101.46, "Text": " unless you use Spark, which is bound to the CPU."}, {"Time_Start": 2101.46, "Time_End": 2103.46, "Text": " So it's kind of a pain, yeah."}, {"Time_Start": 2103.46, "Time_End": 2106.46, "Text": " So if you put two Ethernet cards into the same Spark Station,"}, {"Time_Start": 2106.46, "Time_End": 2108.46, "Text": " they both have the same Mac address,"}, {"Time_Start": 2108.46, "Time_End": 2110.46, "Text": " and if they connect them both of the same Ether"}, {"Time_Start": 2110.46, "Time_End": 2112.46, "Text": " for some various reason, things will get broken real fast."}, {"Time_Start": 2112.46, "Time_End": 2117.46, "Text": " but real thumb, it has, you know, it's bound directly to the card."}, {"Time_Start": 2117.46, "Time_End": 2120.46, "Text": " In fact, um, see,"}, {"Time_Start": 2120.46, "Time_End": 2124.46, "Text": " yeah, the video set, but that's rule of thumb."}, {"Time_Start": 2124.46, "Time_End": 2128.46, "Text": " I mean, you look at your Ether card, and on the back,"}, {"Time_Start": 2128.46, "Time_End": 2131.46, "Text": " yeah, on the back it says EA and then my Ethernet address,"}, {"Time_Start": 2131.46, "Time_End": 2133.46, "Text": " happens to be the same one in the slide."}, {"Time_Start": 2133.46, "Time_End": 2135.46, "Text": " But it is bound into your card."}, {"Time_Start": 2135.46, "Time_End": 2140.46, "Text": " Now, sequence prediction."}, {"Time_Start": 2140.46, "Time_End": 2141.46, "Text": " You know, you know, you know, you know,"}, {"Time_Start": 2141.46, "Time_End": 2144.46, "Text": " You know, you thought you had SSH?"}, {"Time_Start": 2144.46, "Time_End": 2147.46, "Text": " Well, it's actually, this won't break SSH."}, {"Time_Start": 2147.46, "Time_End": 2149.46, "Text": " It'll just make your life a little bit more annoying."}, {"Time_Start": 2149.46, "Time_End": 2152.46, "Text": " But this is a good way of trash near-talent connections."}, {"Time_Start": 2152.46, "Time_End": 2154.46, "Text": " Talk to the Route."}, {"Time_Start": 2154.46, "Time_End": 2158.46, "Text": " Route will be happy to point you to the Frack article that gave you the program to do this, no problem."}, {"Time_Start": 2158.46, "Time_End": 2160.46, "Text": " Now, again, we have a bunch of hosts."}, {"Time_Start": 2160.46, "Time_End": 2162.46, "Text": " Let's say I take out trusted hosts."}, {"Time_Start": 2162.46, "Time_End": 2164.46, "Text": " So, sin flood."}, {"Time_Start": 2164.46, "Time_End": 2166.46, "Text": " Bye-bye."}, {"Time_Start": 2166.46, "Time_End": 2170.46, "Text": " You know, it could be ping of death, you know, it can be the latest application."}, {"Time_Start": 2170.46, "Time_End": 2171.46, "Text": " Don't worry about that."}, {"Time_Start": 2171.46, "Time_End": 2174.46, "Text": " that, but okay, that machine is out."}, {"Time_Start": 2174.46, "Time_End": 2178.46, "Text": " Next, I go, hi Target."}, {"Time_Start": 2178.46, "Time_End": 2180.46, "Text": " Hi, Pete."}, {"Time_Start": 2180.46, "Time_End": 2182.46, "Text": " Now, so let's go that sequence one."}, {"Time_Start": 2182.46, "Time_End": 2185.46, "Text": " The sequence number I let's say be 10."}, {"Time_Start": 2185.46, "Time_End": 2187.46, "Text": " Next one, that's 12."}, {"Time_Start": 2187.46, "Time_End": 2188.46, "Text": " 14."}, {"Time_Start": 2188.46, "Time_End": 2191.46, "Text": " What's next one going to be 16?"}, {"Time_Start": 2191.46, "Time_End": 2193.46, "Text": " So what do I do?"}, {"Time_Start": 2193.46, "Time_End": 2195.46, "Text": " I send a spoofed packet."}, {"Time_Start": 2195.46, "Time_End": 2200.46, "Text": " It replies to me as the 16."}, {"Time_Start": 2200.46, "Time_End": 2201.46, "Text": " As the 16."}, {"Time_Start": 2201.46, "Time_End": 2209.46, "Text": " Using that number, I can reply, even though I ever saw the acknowledged sequence number."}, {"Time_Start": 2209.46, "Time_End": 2215.46, "Text": " Again, we go, we connect up."}, {"Time_Start": 2215.46, "Time_End": 2218.46, "Text": " We send a few packets."}, {"Time_Start": 2218.46, "Time_End": 2222.46, "Text": " Eventually we get, we actually figure out what the sequence is."}, {"Time_Start": 2222.46, "Time_End": 2223.46, "Text": " We find it's very predictable."}, {"Time_Start": 2223.46, "Time_End": 2226.46, "Text": " Most new machines now randomize the starting sequence."}, {"Time_Start": 2226.46, "Time_End": 2228.46, "Text": " But before, I mean, it was that clockwork."}, {"Time_Start": 2228.46, "Time_End": 2230.46, "Text": " You ran R-bone, there's one program."}, {"Time_Start": 2230.46, "Time_End": 2231.46, "Text": " It was great."}, {"Time_Start": 2231.46, "Time_End": 2234.46, "Text": " you're like, current sequence, guest sequence, real sequence."}, {"Time_Start": 2234.46, "Time_End": 2237.46, "Text": " And you just watch the numbers converge."}, {"Time_Start": 2237.46, "Time_End": 2239.46, "Text": " And then once the numbers converge, the program just,"}, {"Time_Start": 2239.46, "Time_End": 2240.46, "Text": " you're root."}, {"Time_Start": 2240.46, "Time_End": 2245.46, "Text": " It's really fun, you do these numbers streaming up your screen,"}, {"Time_Start": 2245.46, "Time_End": 2246.46, "Text": " you know, converging."}, {"Time_Start": 2246.46, "Time_End": 2248.46, "Text": " And when the delta hits zero, boom, you're in."}, {"Time_Start": 2248.46, "Time_End": 2250.46, "Text": " It's like kind of movies."}, {"Time_Start": 2250.46, "Time_End": 2255.46, "Text": " I love all the watching the hacker movies,"}, {"Time_Start": 2255.46, "Time_End": 2257.46, "Text": " because, you know, these hackers put more time into the"}, {"Time_Start": 2257.46, "Time_End": 2259.46, "Text": " guis of the applications."}, {"Time_Start": 2259.46, "Time_End": 2262.46, "Text": " I wish it would be, yeah, I wish I could do that"}, {"Time_Start": 2262.46, "Time_End": 2264.46, "Text": " from other people, I mean."}, {"Time_Start": 2264.46, "Time_End": 2268.46, "Text": " But okay, but back here we send the spoofs in."}, {"Time_Start": 2268.46, "Time_End": 2270.46, "Text": " It sends it to the, you know, since I spoofed it,"}, {"Time_Start": 2270.46, "Time_End": 2271.46, "Text": " sends it to the trusted host."}, {"Time_Start": 2271.46, "Time_End": 2275.46, "Text": " By the way, by default, you'd think the trusted host would have sent a reset."}, {"Time_Start": 2275.46, "Time_End": 2277.46, "Text": " But it's down."}, {"Time_Start": 2277.46, "Time_End": 2279.46, "Text": " Can't send a reset."}, {"Time_Start": 2279.46, "Time_End": 2281.46, "Text": " Which allows me to do it."}, {"Time_Start": 2281.46, "Time_End": 2283.46, "Text": " Mind you, you only get one packet."}, {"Time_Start": 2283.46, "Time_End": 2286.46, "Text": " That's one of the problems."}, {"Time_Start": 2286.46, "Time_End": 2288.46, "Text": " But that packet can be reboot."}, {"Time_Start": 2288.46, "Time_End": 2289.46, "Text": " R&B."}, {"Time_Start": 2289.46, "Time_End": 2290.46, "Text": " I'm a star."}, {"Time_Start": 2290.46, "Time_End": 2292.46, "Text": " Send me a next term."}, {"Time_Start": 2292.46, "Time_End": 2295.46, "Text": " Our host, you know, DevCon.org."}, {"Time_Start": 2295.46, "Time_End": 2296.46, "Text": " Whatever you want to be."}, {"Time_Start": 2296.46, "Time_End": 2299.46, "Text": " All you need is one command."}, {"Time_Start": 2299.46, "Time_End": 2300.46, "Text": " Follow?"}, {"Time_Start": 2300.46, "Time_End": 2301.46, "Text": " Questions?"}, {"Time_Start": 2305.46, "Time_End": 2308.46, "Text": " Now, see, again, this is just an explanation."}, {"Time_Start": 2308.46, "Time_End": 2310.46, "Text": " I wasn't going to print out the slides, but it's two early in the morning."}, {"Time_Start": 2310.46, "Time_End": 2312.46, "Text": " Go to King goes and print them."}, {"Time_Start": 2312.46, "Time_End": 2315.46, "Text": " This sounds well would be available on a DefCon web page."}, {"Time_Start": 2315.46, "Time_End": 2316.46, "Text": " DTO, he seems to publish these things."}, {"Time_Start": 2316.46, "Time_End": 2318.46, "Text": " But there's this experience of what I just said."}, {"Time_Start": 2318.46, "Time_End": 2319.46, "Text": " said."}, {"Time_Start": 2319.46, "Time_End": 2322.46, "Text": " O.S is now a randomizer numbers, makes it a little bit harder to do."}, {"Time_Start": 2322.46, "Time_End": 2326.46, "Text": " It turns out that some of the randomizations were very weak."}, {"Time_Start": 2326.46, "Time_End": 2329.46, "Text": " So, you know, even though it looked random, it wasn't random."}, {"Time_Start": 2329.46, "Time_End": 2330.46, "Text": " Whoops."}, {"Time_Start": 2330.46, "Time_End": 2333.46, "Text": " Crypto login helps a lot."}, {"Time_Start": 2333.46, "Time_End": 2337.46, "Text": " Because under crypto login, after you establish a three-way handshake,"}, {"Time_Start": 2337.46, "Time_End": 2341.46, "Text": " we still use the encrypted, especially SSH example,"}, {"Time_Start": 2341.46, "Time_End": 2343.46, "Text": " we still need to form the key exchange."}, {"Time_Start": 2343.46, "Time_End": 2345.46, "Text": " So it's more than one packet."}, {"Time_Start": 2345.46, "Time_End": 2346.46, "Text": " Yes."}, {"Time_Start": 2346.46, "Time_End": 2347.46, "Text": " In Slurge 26ters,"}, {"Time_Start": 2347.46, "Time_End": 2351.46, "Text": " there's two or three different options for randomizing your sequence."}, {"Time_Start": 2351.46, "Time_End": 2356.46, "Text": " There's one for standards which doesn't really randomize it."}, {"Time_Start": 2356.46, "Time_End": 2359.46, "Text": " There's one for RFC."}, {"Time_Start": 2359.46, "Time_End": 2365.46, "Text": " Some of the other RFCs are basically in the documents that proposed standards."}, {"Time_Start": 2365.46, "Time_End": 2368.46, "Text": " And there's one for randomizing the sequence."}, {"Time_Start": 2368.46, "Time_End": 2370.46, "Text": " Do you recommend?"}, {"Time_Start": 2370.46, "Time_End": 2371.46, "Text": " Do you know a lot of those?"}, {"Time_Start": 2371.46, "Time_End": 2373.46, "Text": " I'm familiar with the different propositions."}, {"Time_Start": 2373.46, "Time_End": 2376.46, "Text": " I recommend using the RFC of the randomized one, not the non-randomized one."}, {"Time_Start": 2376.46, "Time_End": 2377.46, "Text": " one."}, {"Time_Start": 2377.46, "Time_End": 2378.46, "Text": " It's up to you."}, {"Time_Start": 2378.46, "Time_End": 2382.46, "Text": " I imagine that the RFC is a standard and the other one's a home blue."}, {"Time_Start": 2382.46, "Time_End": 2385.46, "Text": " I mean, if your network works, don't worry about it."}, {"Time_Start": 2385.46, "Time_End": 2389.46, "Text": " And here we are, session hijacking."}, {"Time_Start": 2389.46, "Time_End": 2391.46, "Text": " This is very similar to what I just did."}, {"Time_Start": 2391.46, "Time_End": 2393.46, "Text": " Here's that slide again."}, {"Time_Start": 2393.46, "Time_End": 2398.46, "Text": " Now, I'll save you the effort of seeing the three-year handshake."}, {"Time_Start": 2398.46, "Time_End": 2400.46, "Text": " Let's just say it happened."}, {"Time_Start": 2400.46, "Time_End": 2403.46, "Text": " You are happily logged into your ISP."}, {"Time_Start": 2403.46, "Time_End": 2404.46, "Text": " You're on IRC."}, {"Time_Start": 2404.46, "Time_End": 2405.46, "Text": " I'll knit it in."}, {"Time_Start": 2405.46, "Time_End": 2406.46, "Text": " Whatever."}, {"Time_Start": 2406.46, "Time_End": 2407.46, "Text": " else."}, {"Time_Start": 2407.46, "Time_End": 2408.46, "Text": " And what happens?"}, {"Time_Start": 2408.46, "Time_End": 2413.46, "Text": " I spoof a packet, I hijacked a session."}, {"Time_Start": 2413.46, "Time_End": 2417.46, "Text": " Basically, I send out, basically I know what your sequences are."}, {"Time_Start": 2417.46, "Time_End": 2419.46, "Text": " I jump into the conversation midstream."}, {"Time_Start": 2419.46, "Time_End": 2422.46, "Text": " We exchange a packet or two."}, {"Time_Start": 2422.46, "Time_End": 2426.46, "Text": " All of a sudden, your trusted host is out of sequence, so it's going to be ignored."}, {"Time_Start": 2426.46, "Time_End": 2431.46, "Text": " And I now have your teleconnection."}, {"Time_Start": 2431.46, "Time_End": 2433.46, "Text": " The timing is tricky."}, {"Time_Start": 2433.46, "Time_End": 2435.46, "Text": " That's why you use software."}, {"Time_Start": 2435.46, "Time_End": 2439.46, "Text": " Now, once I send that, I can send that."}, {"Time_Start": 2439.46, "Time_End": 2442.46, "Text": " Now, the problem is you're going to have an axe storm,"}, {"Time_Start": 2442.46, "Time_End": 2444.46, "Text": " because your target host is going to say,"}, {"Time_Start": 2444.46, "Time_End": 2447.46, "Text": " it's not going to get acknowledgement for a packet it's sent."}, {"Time_Start": 2447.46, "Time_End": 2449.46, "Text": " And it's going to start streaming acts at each other,"}, {"Time_Start": 2449.46, "Time_End": 2451.46, "Text": " the same thing for the trusted host."}, {"Time_Start": 2451.46, "Time_End": 2453.46, "Text": " And eventually your connection will drop,"}, {"Time_Start": 2453.46, "Time_End": 2455.46, "Text": " because it's going to discover the axe or associate with that TCP"}, {"Time_Start": 2455.46, "Time_End": 2458.46, "Text": " and you're going to know, something screwy here, color connection."}, {"Time_Start": 2458.46, "Time_End": 2463.46, "Text": " A partial hack might be to send it ARP to the target host"}, {"Time_Start": 2463.46, "Time_End": 2464.46, "Text": " and make it send its axe to Never Neverland."}, {"Time_Start": 2464.46, "Time_End": 2468.46, "Text": " never, never land. That would be a pretty good one. That helps a little bit."}, {"Time_Start": 2468.46, "Time_End": 2474.46, "Text": " So, quick, quick explanation, I desynchronize a connection, then I jump into the sequence"}, {"Time_Start": 2474.46, "Time_End": 2479.46, "Text": " that I established. And you're typing along, notice on your screen doesn't respond"}, {"Time_Start": 2479.46, "Time_End": 2482.46, "Text": " anymore, and I've got the session on my notebook."}, {"Time_Start": 2482.46, "Time_End": 2484.46, "Text": " The software's published for Frack."}, {"Time_Start": 2484.46, "Time_End": 2490.46, "Text": " Anybody feel, everybody going to use Telnet again?"}, {"Time_Start": 2490.46, "Time_End": 2493.46, "Text": " Anybody who used Telnet before?"}, {"Time_Start": 2493.46, "Time_End": 2497.46, "Text": " Anybody who used to tell it before and not again?"}, {"Time_Start": 2497.46, "Time_End": 2502.46, "Text": " And again, workers to house, buy a decent network equipment."}, {"Time_Start": 2505.46, "Time_End": 2508.46, "Text": " Port scans, we're all about them yet?"}, {"Time_Start": 2508.46, "Time_End": 2512.46, "Text": " I'm going to go with them quickly because that's actually what the next talks about."}, {"Time_Start": 2512.46, "Time_End": 2514.46, "Text": " DNS Cash Poison is a fun one."}, {"Time_Start": 2514.46, "Time_End": 2519.46, "Text": " Did you notice that DefCon webpage was down a few weeks ago?"}, {"Time_Start": 2519.46, "Time_End": 2522.46, "Text": " Hmm, DNS Cash Poising."}, {"Time_Start": 2522.46, "Time_End": 2523.46, "Text": " So, uh..."}, {"Time_Start": 2523.46, "Time_End": 2525.46, "Text": " Port scanning is kind of easy."}, {"Time_Start": 2525.46, "Time_End": 2529.46, "Text": " I'll kind of skip through this quickly because it's actually what the next talks about."}, {"Time_Start": 2529.46, "Time_End": 2531.46, "Text": " Basically, I sent a port to correction one."}, {"Time_Start": 2531.46, "Time_End": 2533.46, "Text": " I get a reset. It's closed."}, {"Time_Start": 2533.46, "Time_End": 2535.46, "Text": " Two, reset."}, {"Time_Start": 2535.46, "Time_End": 2537.46, "Text": " Port three, reset."}, {"Time_Start": 2537.46, "Time_End": 2538.46, "Text": " It's skip to seven."}, {"Time_Start": 2538.46, "Time_End": 2539.46, "Text": " Open."}, {"Time_Start": 2539.46, "Time_End": 2541.46, "Text": " I got ports open. Port seven."}, {"Time_Start": 2541.46, "Time_End": 2544.46, "Text": " Discard was open."}, {"Time_Start": 2544.46, "Time_End": 2545.46, "Text": " 11 was closed."}, {"Time_Start": 2545.46, "Time_End": 2547.46, "Text": " 20. FTP was open."}, {"Time_Start": 2547.46, "Time_End": 2550.46, "Text": " This basically what happens when strobe or NMap."}, {"Time_Start": 2553.46, "Time_End": 2554.46, "Text": " What?"}, {"Time_Start": 2554.46, "Time_End": 2556.46, "Text": " You're in storeber and NAP."}, {"Time_Start": 2556.46, "Time_End": 2559.46, "Text": " That's the next talk."}, {"Time_Start": 2559.46, "Time_End": 2560.46, "Text": " And I'll skip through this."}, {"Time_Start": 2560.46, "Time_End": 2562.46, "Text": " You don't want to read over modify."}, {"Time_Start": 2562.46, "Time_End": 2565.46, "Text": " And there's different types of options."}, {"Time_Start": 2565.46, "Time_End": 2567.46, "Text": " I'm going to skip through this."}, {"Time_Start": 2567.46, "Time_End": 2569.46, "Text": " And there's different types of options."}, {"Time_Start": 2569.46, "Time_End": 2574.46, "Text": " I'm going to skip through this because, again, I don't want to take the window somebody's sales."}, {"Time_Start": 2574.46, "Time_End": 2576.46, "Text": " See what we're doing?"}, {"Time_Start": 2576.46, "Time_End": 2578.46, "Text": " We're doing fine on time."}, {"Time_Start": 2578.46, "Time_End": 2580.46, "Text": " Basically, by the way, you don't want to do resets."}, {"Time_Start": 2580.46, "Time_End": 2582.46, "Text": " Now, skip through this again, I don't want to take the window."}, {"Time_Start": 2582.46, "Time_End": 2583.46, "Text": " went out."}, {"Time_Start": 2583.46, "Time_End": 2584.46, "Text": " You can spot this stuff."}, {"Time_Start": 2584.46, "Time_End": 2585.46, "Text": " There's a few applications."}, {"Time_Start": 2585.46, "Time_End": 2587.46, "Text": " GCP log, NSTAD, Habikis."}, {"Time_Start": 2587.46, "Time_End": 2590.46, "Text": " There's a little application you can run on your server."}, {"Time_Start": 2590.46, "Time_End": 2592.46, "Text": " Again, I'm skipping these slides."}, {"Time_Start": 2592.46, "Time_End": 2594.46, "Text": " It's all next hour."}, {"Time_Start": 2594.46, "Time_End": 2596.46, "Text": " That's a fun stuff."}, {"Time_Start": 2596.46, "Time_End": 2597.46, "Text": " DNS cache poisoning."}, {"Time_Start": 2597.46, "Time_End": 2600.46, "Text": " Everybody know about DNS or how it works?"}, {"Time_Start": 2600.46, "Time_End": 2602.46, "Text": " I'll tell you."}, {"Time_Start": 2602.46, "Time_End": 2605.46, "Text": " Okay, here at the dot server, the com server,"}, {"Time_Start": 2605.46, "Time_End": 2607.46, "Text": " and the Acme.com server."}, {"Time_Start": 2607.46, "Time_End": 2611.46, "Text": " And of course, legitimate client and DNS server."}, {"Time_Start": 2611.46, "Time_End": 2612.46, "Text": " Now this is a normal home server."}, {"Time_Start": 2612.46, "Time_End": 2618.46, "Text": " healthy situation. Your client goes, your local DNS server goes, hey, where's Acme.com?"}, {"Time_Start": 2618.46, "Time_End": 2622.46, "Text": " We send a packet off to the root of all internet called Dot."}, {"Time_Start": 2622.46, "Time_End": 2624.46, "Text": " He goes, hey, who's Acme.com?"}, {"Time_Start": 2624.46, "Time_End": 2626.46, "Text": " I don't know, wanted you ask.com."}, {"Time_Start": 2626.46, "Time_End": 2628.46, "Text": " Hey, who's Acme.com?"}, {"Time_Start": 2628.46, "Time_End": 2631.46, "Text": " I don't know, why don't you ask Acme?"}, {"Time_Start": 2631.46, "Time_End": 2634.46, "Text": " Hey, who is this person?"}, {"Time_Start": 2634.46, "Time_End": 2639.46, "Text": " Oh, the answer is, and it gets sent up with the proper IP address."}, {"Time_Start": 2639.46, "Time_End": 2641.46, "Text": " Simple, huh?"}, {"Time_Start": 2641.46, "Time_End": 2642.46, "Text": " Now it might seem to me."}, {"Time_Start": 2642.46, "Time_End": 2648.46, "Text": " efficient, but actually what happens is your DNS server down here caches that information."}, {"Time_Start": 2648.46, "Time_End": 2652.46, "Text": " So next time somebody asks already in the cache, a little bit more efficient that way."}, {"Time_Start": 2652.46, "Time_End": 2656.46, "Text": " Also, causes some minor security problems."}, {"Time_Start": 2656.46, "Time_End": 2661.46, "Text": " Vulnerability is the cache, you always insert erroneous information."}, {"Time_Start": 2661.46, "Time_End": 2664.46, "Text": " Like, where did that reply actually come from?"}, {"Time_Start": 2664.46, "Time_End": 2668.46, "Text": " Here we are again."}, {"Time_Start": 2668.46, "Time_End": 2672.46, "Text": " As an outside person, I go, hey, you know,"}, {"Time_Start": 2672.46, "Time_End": 2679.46, "Text": " who's acme.com? It goes, where is that? I reply. It seems to the answer. That's obviously"}, {"Time_Start": 2679.46, "Time_End": 2683.66, "Text": " the wrong address. Gee, could that be a save IP address that"}, {"Time_Start": 2683.66, "Time_End": 2687.46, "Text": " DEFCON, www.org had maybe three weeks ago?"}, {"Time_Start": 2687.46, "Time_End": 2691.46, "Text": " I had nothing to do with that."}, {"Time_Start": 2691.46, "Time_End": 2698.46, "Text": " So what happens later on? Somebody else asked for it? You get that reply."}, {"Time_Start": 2698.46, "Time_End": 2701.46, "Text": " Okay. What if we're talking well?"}, {"Time_Start": 2701.46, "Time_End": 2704.46, "Text": " What if we're talking to Wells Fargo, Bank?"}, {"Time_Start": 2704.46, "Time_End": 2708.46, "Text": " And that IP address is my home web server."}, {"Time_Start": 2708.46, "Time_End": 2713.46, "Text": " What would happen when I ask for your password?"}, {"Time_Start": 2713.46, "Time_End": 2716.46, "Text": " You type it in."}, {"Time_Start": 2716.46, "Time_End": 2719.46, "Text": " And what happens when I ask you about your account number?"}, {"Time_Start": 2719.46, "Time_End": 2721.46, "Text": " You type it in."}, {"Time_Start": 2721.46, "Time_End": 2722.46, "Text": " Then what happens?"}, {"Time_Start": 2722.46, "Time_End": 2724.46, "Text": " I go to jail."}, {"Time_Start": 2724.46, "Time_End": 2725.46, "Text": " Yeah."}, {"Time_Start": 2731.46, "Time_End": 2733.46, "Text": " for my deaf contract."}, {"Time_Start": 2733.46, "Time_End": 2742.46, "Text": " But again, if you update the current versions, 8. something by Paul Vixie, I recommend that."}, {"Time_Start": 2742.46, "Time_End": 2746.46, "Text": " For a person who knows what I was talking about, yes, I know there's several permutations to this."}, {"Time_Start": 2746.46, "Time_End": 2749.46, "Text": " It used to be, we're just having a mess."}, {"Time_Start": 2749.46, "Time_End": 2756.46, "Text": " It used to be that DNS servers would only accept, you know, would only accept responses."}, {"Time_Start": 2756.46, "Time_End": 2760.46, "Text": " Well, actually, we wouldn't even care if it asked the question or just accept it."}, {"Time_Start": 2760.46, "Time_End": 2762.46, "Text": " Oh, well, it's fixed that."}, {"Time_Start": 2762.46, "Time_End": 2766.46, "Text": " So now it only accepted responses for questions asked."}, {"Time_Start": 2766.46, "Time_End": 2770.46, "Text": " Well, eventually you realize we'll just ask the question first."}, {"Time_Start": 2770.46, "Time_End": 2775.46, "Text": " So the answer goes, fine, we'll start sequencing our requests"}, {"Time_Start": 2775.46, "Time_End": 2777.46, "Text": " and making sure the answer is the same sequence."}, {"Time_Start": 2777.46, "Time_End": 2779.46, "Text": " That didn't work."}, {"Time_Start": 2779.46, "Time_End": 2781.46, "Text": " The sequences were A, very predictable."}, {"Time_Start": 2781.46, "Time_End": 2787.46, "Text": " B, you're able to send all the possible sequences within a minute anyway, so"}, {"Time_Start": 2787.46, "Time_End": 2789.46, "Text": " I mean, you know, the sequence is only 50,"}, {"Time_Start": 2789.46, "Time_End": 2793.46, "Text": " If the sequences are, how long does it take, say, like, 65,000 packets?"}, {"Time_Start": 2793.46, "Time_End": 2795.46, "Text": " Not long."}, {"Time_Start": 2795.46, "Time_End": 2797.46, "Text": " And so they took care of that."}, {"Time_Start": 2797.46, "Time_End": 2799.46, "Text": " So not any theory that really randomized the sequence,"}, {"Time_Start": 2799.46, "Time_End": 2802.46, "Text": " but turns out the sequence randomization is not that random."}, {"Time_Start": 2802.46, "Time_End": 2805.46, "Text": " Yeah, so it's a little thing going here, but run the latest version."}, {"Time_Start": 2805.46, "Time_End": 2806.46, "Text": " It's a lot better."}, {"Time_Start": 2806.46, "Time_End": 2808.46, "Text": " And next version we're actually going to have encryption."}, {"Time_Start": 2808.46, "Time_End": 2810.46, "Text": " That'll help a lot."}, {"Time_Start": 2810.46, "Time_End": 2811.46, "Text": " Yes."}, {"Time_Start": 2811.46, "Time_End": 2812.46, "Text": " Yes."}, {"Time_Start": 2812.46, "Time_End": 2818.46, "Text": " In earlier, right, you know,"}, {"Time_Start": 2818.46, "Time_End": 2820.46, "Text": " Yes and no."}, {"Time_Start": 2820.46, "Time_End": 2822.46, "Text": " In this case, we're assuming you're actually going to ask it."}, {"Time_Start": 2822.46, "Time_End": 2826.46, "Text": " Yes, it will ask it, but a lot of times we'll send a packet out asking"}, {"Time_Start": 2826.46, "Time_End": 2830.46, "Text": " for what's the current version of IP address, called the SLA record,"}, {"Time_Start": 2830.46, "Time_End": 2832.46, "Text": " which is a serial number."}, {"Time_Start": 2832.46, "Time_End": 2835.46, "Text": " And if I reply with a higher serial number, I could override it."}, {"Time_Start": 2835.46, "Time_End": 2838.46, "Text": " So when I say that little fake packet, it's going to have a serial number"}, {"Time_Start": 2838.46, "Time_End": 2842.46, "Text": " of 9 million, 99 million to steal, astronomical number"}, {"Time_Start": 2842.46, "Time_End": 2845.46, "Text": " with expiration date, we'll never time out."}, {"Time_Start": 2845.46, "Time_End": 2847.46, "Text": " So that's going to be in your cache, they're powered on your server."}, {"Time_Start": 2847.46, "Time_End": 2856.46, "Text": " And eventually, yes, if it's already in your cache, I might not get it in, but then all I've got to do is ask for another record that's not in your cache, and I could probably slip it in."}, {"Time_Start": 2856.46, "Time_End": 2859.46, "Text": " One of the other exploits, of course, was piggybacking."}, {"Time_Start": 2859.46, "Time_End": 2866.46, "Text": " You know, I run disorg, that's my home domain, and I would, for example, get you to do a disorg lookup,"}, {"Time_Start": 2866.46, "Time_End": 2870.46, "Text": " and then my disorder reply would piggyback a Wells Fargo reply."}, {"Time_Start": 2870.46, "Time_End": 2873.46, "Text": " That's another way of slipping past the gates."}, {"Time_Start": 2873.46, "Time_End": 2876.46, "Text": " Again, I can quite literally go on for an hour of just permutations of it."}, {"Time_Start": 2876.46, "Time_End": 2878.46, "Text": " of just permutations of this one."}, {"Time_Start": 2878.46, "Time_End": 2883.46, "Text": " So, you know, in closing for this particular topic, we'll just say upgrade."}, {"Time_Start": 2883.46, "Time_End": 2886.46, "Text": " Even you just install scenario seven, upgrade."}, {"Time_Start": 2886.46, "Time_End": 2891.46, "Text": " Whenever you buy a commercial product, download, install."}, {"Time_Start": 2891.46, "Time_End": 2894.46, "Text": " Same thing with Sendmail."}, {"Time_Start": 2894.46, "Time_End": 2899.46, "Text": " So, let's say, so effectively, upgrade, fixed, you know, modern version, tracks,"}, {"Time_Start": 2899.46, "Time_End": 2901.46, "Text": " queries, etc."}, {"Time_Start": 2901.46, "Time_End": 2903.46, "Text": " BTP, anybody know what that is?"}, {"Time_Start": 2903.46, "Time_End": 2904.46, "Text": " Yes."}, {"Time_Start": 2904.46, "Time_End": 2905.46, "Text": " This is a fun one."}, {"Time_Start": 2905.46, "Time_End": 2906.46, "Text": " This is a fun one."}, {"Time_Start": 2906.46, "Time_End": 2910.46, "Text": " We all heard about, he was it taking, killing the internet in 20 minutes?"}, {"Time_Start": 2910.46, "Time_End": 2912.46, "Text": " Want to know how to do it?"}, {"Time_Start": 2912.46, "Time_End": 2913.46, "Text": " Yeah."}, {"Time_Start": 2913.46, "Time_End": 2916.46, "Text": " Actually, this road is actually released some automated scripts for this one."}, {"Time_Start": 2916.46, "Time_End": 2917.46, "Text": " Okay, here's a little network."}, {"Time_Start": 2917.46, "Time_End": 2919.46, "Text": " We have an internal router, we have a couple peers."}, {"Time_Start": 2919.46, "Time_End": 2924.46, "Text": " Obviously, these people have got money since they have multiple connections to the internet."}, {"Time_Start": 2924.46, "Time_End": 2930.46, "Text": " Internal router establishes a BGP connection to the peer routers, or bluewowers."}, {"Time_Start": 2930.46, "Time_End": 2932.46, "Text": " I'm on the outside world."}, {"Time_Start": 2932.46, "Time_End": 2936.46, "Text": " B, being a nasty sob, forges reset and fin packets."}, {"Time_Start": 2936.46, "Time_End": 2940.46, "Text": " Mind you, the TCP connections, I don't know what the sequence is."}, {"Time_Start": 2940.46, "Time_End": 2942.46, "Text": " But there's only 65,000 of them."}, {"Time_Start": 2942.46, "Time_End": 2944.46, "Text": " How long is it going to take me?"}, {"Time_Start": 2944.46, "Time_End": 2948.46, "Text": " Now, eventually, that network goes out."}, {"Time_Start": 2948.46, "Time_End": 2952.46, "Text": " When internal router and router"}, {"Time_Start": 2952.46, "Time_End": 2955.46, "Text": " A, the scalar drop a TCP connection,"}, {"Time_Start": 2955.46, "Time_End": 2958.46, "Text": " internal and A assume the other guy crashed,"}, {"Time_Start": 2958.46, "Time_End": 2961.46, "Text": " automatically rebalance their internal hash,"}, {"Time_Start": 2961.46, "Time_End": 2963.46, "Text": " the internal balance tree of routes."}, {"Time_Start": 2963.46, "Time_End": 2965.46, "Text": " And if you're anywhere near a large,"}, {"Time_Start": 2965.46, "Time_End": 2971.46, "Text": " a large hub or large center of the universe, that can take a long time, a lot of memory."}, {"Time_Start": 2971.46, "Time_End": 2975.46, "Text": " And after it balances this, it reestablishes a connection,"}, {"Time_Start": 2975.46, "Time_End": 2979.46, "Text": " and then rebalances the tree after the tree is balanced, then your connectivity."}, {"Time_Start": 2979.46, "Time_End": 2982.46, "Text": " So your network can be down for up to 20 minutes."}, {"Time_Start": 2982.46, "Time_End": 2985.46, "Text": " This is an extreme case, but it takes a while."}, {"Time_Start": 2985.46, "Time_End": 2988.46, "Text": " So a peer uses BGP connection, you're screwed."}, {"Time_Start": 2988.46, "Time_End": 2991.46, "Text": " You no longer have connectivity to you at one peer."}, {"Time_Start": 2991.46, "Time_End": 2994.46, "Text": " There's a blind attack."}, {"Time_Start": 2994.46, "Time_End": 2995.46, "Text": " There's a blind attack."}, {"Time_Start": 2995.46, "Time_End": 2999.46, "Text": " I have a 1 in 65,000 chance."}, {"Time_Start": 2999.46, "Time_End": 3000.46, "Text": " Not a problem."}, {"Time_Start": 3000.46, "Time_End": 3003.46, "Text": " No in the lottery, better than the slot machine."}, {"Time_Start": 3003.46, "Time_End": 3008.46, "Text": " The attacker may be able to keep the connection down infinitely by continuously resetting,"}, {"Time_Start": 3008.46, "Time_End": 3009.46, "Text": " resets at zero."}, {"Time_Start": 3009.46, "Time_End": 3011.46, "Text": " Again, what's the first sequence number?"}, {"Time_Start": 3011.46, "Time_End": 3012.46, "Text": " Zero."}, {"Time_Start": 3012.46, "Time_End": 3015.46, "Text": " Until we establish a sequence, it's assumed to be zero."}, {"Time_Start": 3015.46, "Time_End": 3021.46, "Text": " So when you send out this in, the reset is sequence zero, since we ever will establish a full sequence."}, {"Time_Start": 3021.46, "Time_End": 3024.46, "Text": " The attacker may keep things down."}, {"Time_Start": 3024.46, "Time_End": 3027.46, "Text": " Actually, the routing table is large enough."}, {"Time_Start": 3027.46, "Time_End": 3029.46, "Text": " It can take a second time to come back up."}, {"Time_Start": 3029.46, "Time_End": 3032.46, "Text": " So your network is up, what, three minutes every ten minutes?"}, {"Time_Start": 3032.46, "Time_End": 3034.46, "Text": " Or worse?"}, {"Time_Start": 3034.46, "Time_End": 3037.46, "Text": " Your site's out of luck."}, {"Time_Start": 3037.46, "Time_End": 3041.46, "Text": " You can really embargo a corporation this way."}, {"Time_Start": 3041.46, "Time_End": 3045.46, "Text": " And the network admins will go nuts because the routers are up."}, {"Time_Start": 3045.46, "Time_End": 3047.46, "Text": " The routers are pinging each other."}, {"Time_Start": 3047.46, "Time_End": 3051.46, "Text": " Your Cisco discovery protocol says, yep, I see a router right next to me,"}, {"Time_Start": 3051.46, "Time_End": 3053.46, "Text": " and you get the connection and it goes right back down."}, {"Time_Start": 3053.46, "Time_End": 3055.46, "Text": " and put the power all day."}, {"Time_Start": 3055.46, "Time_End": 3059.46, "Text": " So we'll hook up a proper network monitor."}, {"Time_Start": 3059.46, "Time_End": 3064.46, "Text": " And again, this attack is best fixed by filters."}, {"Time_Start": 3064.46, "Time_End": 3068.46, "Text": " Unfortunately, if I get to pick on Cisco, it's more, actually, most networks."}, {"Time_Start": 3068.46, "Time_End": 3073.46, "Text": " You can use about 40% of the banner through your turn on IP filtering."}, {"Time_Start": 3073.46, "Time_End": 3078.46, "Text": " So since people only buy a big enough router that they need, nothing more,"}, {"Time_Start": 3078.46, "Time_End": 3081.46, "Text": " they discover they turn on IP filtering, the router isn't big enough,"}, {"Time_Start": 3081.46, "Time_End": 3082.46, "Text": " but they just pay, they spend how much money?"}, {"Time_Start": 3082.46, "Time_End": 3083.46, "Text": " money."}, {"Time_Start": 3083.46, "Time_End": 3084.46, "Text": " So there's a problem."}, {"Time_Start": 3084.46, "Time_End": 3085.46, "Text": " Question?"}, {"Time_Start": 3085.46, "Time_End": 3086.46, "Text": " Yeah."}, {"Time_Start": 3086.46, "Time_End": 3087.46, "Text": " How's principal back to you?"}, {"Time_Start": 3087.46, "Time_End": 3092.46, "Text": " It takes, well, since I'm probably spoofing, it's going to take a while."}, {"Time_Start": 3092.46, "Time_End": 3095.46, "Text": " You probably have to manually do it."}, {"Time_Start": 3095.46, "Time_End": 3099.46, "Text": " You really just can say where this packet came from because the source address has wrong stamp"}, {"Time_Start": 3099.46, "Time_End": 3100.46, "Text": " on it."}, {"Time_Start": 3100.46, "Time_End": 3107.46, "Text": " You probably have to call up each person in their chain of connections, hopefully in a 255 hops,"}, {"Time_Start": 3107.46, "Time_End": 3111.46, "Text": " usually about 30, and get them to run a monitor and tell you where the packet's coming from."}, {"Time_Start": 3111.46, "Time_End": 3113.46, "Text": " from?"}, {"Time_Start": 3113.46, "Time_End": 3115.46, "Text": " How often do they get into that?"}, {"Time_Start": 3115.46, "Time_End": 3117.46, "Text": " I don't know. I don't work there."}, {"Time_Start": 3117.46, "Time_End": 3121.46, "Text": " It really depends."}, {"Time_Start": 3121.46, "Time_End": 3123.46, "Text": " I want a subpoena first."}, {"Time_Start": 3123.46, "Time_End": 3127.46, "Text": " It's all privacy versus workability issue."}, {"Time_Start": 3127.46, "Time_End": 3129.46, "Text": " That falls into Jennifer's, I guess, I can call them."}, {"Time_Start": 3129.46, "Time_End": 3131.46, "Text": " But this is a fun one."}, {"Time_Start": 3131.46, "Time_End": 3133.46, "Text": " This was really was way too much fun."}, {"Time_Start": 3133.46, "Time_End": 3137.46, "Text": " We have IP filters, so, bam."}, {"Time_Start": 3137.46, "Time_End": 3139.46, "Text": " Again, you know, it's, you know,"}, {"Time_Start": 3139.46, "Time_End": 3141.46, "Text": " The internet is getting overloaded."}, {"Time_Start": 3141.46, "Time_End": 3145.46, "Text": " The centralized hubs just don't have enough bandwidth to support filtering."}, {"Time_Start": 3145.46, "Time_End": 3150.46, "Text": " Most companies, the best thing you can do is if you run a company, you run an ISP,"}, {"Time_Start": 3150.46, "Time_End": 3152.46, "Text": " filter your outbound."}, {"Time_Start": 3152.46, "Time_End": 3158.46, "Text": " There's no reason a packet should leave your network if it's not from your network."}, {"Time_Start": 3158.46, "Time_End": 3162.46, "Text": " That being, have an outbound filter means that all packets leaving your net"}, {"Time_Start": 3162.46, "Time_End": 3164.46, "Text": " have a source address of your network."}]}