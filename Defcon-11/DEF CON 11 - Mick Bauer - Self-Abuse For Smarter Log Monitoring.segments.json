{"segments": [{"Time_Start": 0.0, "Time_End": 6.0, "Text": " Hi."}, {"Time_Start": 6.0, "Time_End": 9.0, "Text": " Good afternoon."}, {"Time_Start": 9.0, "Time_End": 10.0, "Text": " It's noon, right?"}, {"Time_Start": 10.0, "Time_End": 12.0, "Text": " No, afternoon."}, {"Time_Start": 12.0, "Time_End": 20.0, "Text": " My name is Mick Bauer, and before anybody asks, I am not on my way to a Scottish funeral, thank you."}, {"Time_Start": 20.0, "Time_End": 24.0, "Text": " I'm here to talk about self-abuse for smarter log monitoring."}, {"Time_Start": 24.0, "Time_End": 29.98, "Text": " And it's a really, a fairly simple"}, {"Time_Start": 30.0, "Time_End": 35.5, "Text": " technique, but I thought it would be a fun context in which to talk about log monitoring"}, {"Time_Start": 35.5, "Time_End": 42.0, "Text": " and to talk about self-scanning and about self-abuse if you want later on."}, {"Time_Start": 42.0, "Time_End": 47.5, "Text": " The talk that I'm about to give is reasonably well structured and I just wanted to show you"}, {"Time_Start": 47.5, "Time_End": 52.400000000000006, "Text": " that I am working off of an outline despite what it might appear later on because I do want"}, {"Time_Start": 52.400000000000006, "Time_End": 54.0, "Text": " to keep things fairly loose."}, {"Time_Start": 54.0, "Time_End": 59.0, "Text": " I want you guys to have as much impact on the flow of this as you want to have."}, {"Time_Start": 59.0, "Time_End": 63.46, "Text": " So, comments, questions, observations are welcome at all times."}, {"Time_Start": 63.46, "Time_End": 70.64, "Text": " Later on, I'm even going to open up the floor for people to beat up on my victim system here,"}, {"Time_Start": 70.64, "Time_End": 75.5, "Text": " and I'll give the IP address of that when the time comes, although some of you may have"}, {"Time_Start": 75.5, "Time_End": 78.72, "Text": " may deduce it way before then."}, {"Time_Start": 78.72, "Time_End": 83.44, "Text": " And whoever causes interesting log messages to show up there will get a price."}, {"Time_Start": 83.44, "Time_End": 86.8, "Text": " Okay, so let's just dive into it here."}, {"Time_Start": 86.8, "Time_End": 88.88, "Text": " What is the point of scanning yourself?"}, {"Time_Start": 89.0, "Time_End": 90.46, "Text": " you might ask."}, {"Time_Start": 92.12, "Time_End": 95.92, "Text": " Well, security people like me tell you, monitor your logs."}, {"Time_Start": 96.26, "Time_End": 102.1, "Text": " When you harden your web server and you configure everything into a production state and it's working,"}, {"Time_Start": 102.56, "Time_End": 103.82, "Text": " you should not abandon it, right?"}, {"Time_Start": 103.88, "Time_End": 105.7, "Text": " You shouldn't just leave it chugging off in the corner."}, {"Time_Start": 105.84, "Time_End": 109.06, "Text": " Among other things, you should be monitoring its logs regularly."}, {"Time_Start": 109.8, "Time_End": 114.3, "Text": " Maybe you even want an IDS system running on it, a host-based IDS system."}, {"Time_Start": 114.82, "Time_End": 118.64, "Text": " Maybe you want a simple log watcher like swatch,"}, {"Time_Start": 118.64, "Time_End": 126.4, "Text": " or log watcher or log digest, but in all of these cases, you as a sysadmin need to know"}, {"Time_Start": 126.4, "Time_End": 129.68, "Text": " something about what constitutes evil activity."}, {"Time_Start": 129.68, "Time_End": 134.88, "Text": " Would you know an attack-induced log message if you saw one?"}, {"Time_Start": 134.88, "Time_End": 137.22, "Text": " Maybe you would, maybe you want."}, {"Time_Start": 137.22, "Time_End": 141.34, "Text": " This technique can help."}, {"Time_Start": 141.34, "Time_End": 148.62, "Text": " So if I'm talking about running, let's say, Nassus or NICTO against a system."}, {"Time_Start": 148.64000000000001, "Time_End": 152.74, "Text": " And you're going to be logged onto that system and tailing the logs."}, {"Time_Start": 154.04000000000002, "Time_End": 158.18, "Text": " There's a couple of assumptions at play here that I wanted to spell out."}, {"Time_Start": 158.24, "Time_End": 168.32000000000002, "Text": " The first is that one of these scanners, the scanner that you're using, whether it's NICTO, whether it's NECTO, whether it's Nessus, or whether it's just Telmet, you know, Telmet, 80, et cetera."}, {"Time_Start": 168.94000000000003, "Time_End": 177.5, "Text": " The assumption is that that's going to look in the logs pretty much the same as live exploits that kitties in the field would be running on you."}, {"Time_Start": 177.86, "Time_End": 178.62, "Text": " I think this is a fair."}, {"Time_Start": 178.64000000000001, "Time_End": 183.88000000000002, "Text": " fairly reasonable assumption. What a security scanner like Ness does is it actually"}, {"Time_Start": 183.88000000000002, "Time_End": 189.46, "Text": " does the early stages of actual exploits. That is to say, it does the sort of very targeted"}, {"Time_Start": 189.46, "Time_End": 196.08, "Text": " reconnaissance and initiates the types of packet sequences that a full-blown actually trying"}, {"Time_Start": 196.08, "Time_End": 203.76000000000002, "Text": " to root your box attack would do. But that may or may not be a leap for you. When in doubt, there's"}, {"Time_Start": 203.76000000000002, "Time_End": 208.62, "Text": " no substitute for running actual exploit code against yourself. If that, if you want a"}, {"Time_Start": 208.64000000000001, "Time_End": 217.76000000000002, "Text": " realism in this. In my opinion, you know, using a general, a generalized scanner"}, {"Time_Start": 217.76000000000002, "Time_End": 226.5, "Text": " like NETO is perfectly okay. And then, so there's value, there's value in that in seeing"}, {"Time_Start": 226.5, "Time_End": 231.16000000000003, "Text": " what kiddie behavior looks like. Another thing that's probably equally, maybe even more important"}, {"Time_Start": 231.16000000000003, "Time_End": 237.0, "Text": " is what if you run your all-the-stops-pulled Ness-scan against your host and it logs like nothing?"}, {"Time_Start": 237.0, "Time_End": 242.56, "Text": " That's telling you something really important, isn't it? It's telling you, okay, time to go in"}, {"Time_Start": 242.56, "Time_End": 249.16, "Text": " and fine-tune syslog-D, time to go in and maybe tweak the logging settings on Apache or whatever"}, {"Time_Start": 249.16, "Time_End": 255.98, "Text": " so that I'm seeing the information that I expect or want to be seeing when the bad guys come knocking."}, {"Time_Start": 257.12, "Time_End": 264.62, "Text": " And then finally, it's just good, clean fun to scan yourself. Okay. Now, there are a few limitations."}, {"Time_Start": 264.62, "Time_End": 272.32, "Text": " not only with, you know, this little technique, but also with log monitoring in general."}, {"Time_Start": 272.4, "Time_End": 281.76, "Text": " And even, I would extend that to IDS. And that is, I'm not proposing that if only you stay logged in long enough and frequently enough"}, {"Time_Start": 281.76, "Time_End": 287.48, "Text": " and watch the logs obsessively, you're going to catch bad guys in the act and lock them out of your systems."}, {"Time_Start": 288.26, "Time_End": 293.68, "Text": " I mean, that's obviously not realistic. I think that it's not realistic a lot of the time with IDS as well."}, {"Time_Start": 294.62, "Time_End": 300.12, "Text": " Logs are first and foremost a forensics tool. They let you know what happened."}, {"Time_Start": 301.12, "Time_End": 305.42, "Text": " By definition, nothing is logged until after it occurs, right?"}, {"Time_Start": 307.22, "Time_End": 315.7, "Text": " So if you really want, if you're really worried about proactive security, the plain old unglamorous techniques of staying patched,"}, {"Time_Start": 316.16, "Time_End": 323.6, "Text": " disabling and uninstalling unnecessary stuff, being aware of current trends in Infosec, you know, what is the latest"}, {"Time_Start": 323.6, "Time_End": 327.68, "Text": " worm making the rounds and that sort of thing. And finally, knowing and understanding"}, {"Time_Start": 327.68, "Time_End": 332.46000000000004, "Text": " the security features in your software and in your operating system, these are the ways that"}, {"Time_Start": 332.46000000000004, "Time_End": 341.26000000000005, "Text": " you keep attackers out. This is a log monitoring, IDS, the rest of it. These are tools for"}, {"Time_Start": 341.26000000000005, "Time_End": 346.76000000000005, "Text": " knowing how good of a job you're doing with that other stuff, in my opinion. Now, there are things"}, {"Time_Start": 346.76000000000005, "Time_End": 352.6, "Text": " that you can do. Snort, for example, has got an add-on called hogwash that can be used to"}, {"Time_Start": 352.6, "Time_End": 358.04, "Text": " dynamically reconfigure your firewall rules. Now it says right in the snort FAQ, and I agree"}, {"Time_Start": 358.04, "Time_End": 366.18, "Text": " wholeheartedly with it, that this is a beautiful opportunity for denial of service attacks."}, {"Time_Start": 366.18, "Time_End": 373.40000000000003, "Text": " If you know that somebody is using something like this, if you send a bunch of spoofed packets"}, {"Time_Start": 373.40000000000003, "Time_End": 380.98, "Text": " from victim A, that it look like an attack, in other words, spoof an attack from victim A against"}, {"Time_Start": 380.98, "Time_End": 382.58000000000004, "Text": " the hogwash or other"}, {"Time_Start": 382.6, "Time_End": 390.28000000000003, "Text": " otherwise dynamic firewall modified type host over here, you can effectively prevent this"}, {"Time_Start": 390.28000000000003, "Time_End": 399.02000000000004, "Text": " host from receiving legitimate traffic from the victim host. This is really the fly in the so-called"}, {"Time_Start": 399.02000000000004, "Time_End": 403.88, "Text": " intrusion prevention ointment. And there's various ways around that, and I'm really not prepared"}, {"Time_Start": 403.88, "Time_End": 410.96000000000004, "Text": " to get in big debate about it or anything. But other than tools like hogwash, IDS is"}, {"Time_Start": 410.96000000000004, "Time_End": 412.44, "Text": " are mostly for forensics, I think."}, {"Time_Start": 412.6, "Time_End": 413.6, "Text": " Okay."}, {"Time_Start": 413.6, "Time_End": 420.6, "Text": " Does anyone want to pick that particular religious fight with me now, or should I move on?"}, {"Time_Start": 420.6, "Time_End": 424.6, "Text": " I don't think it's really that controversial anymore."}, {"Time_Start": 424.6, "Time_End": 425.6, "Text": " Okay."}, {"Time_Start": 425.6, "Time_End": 428.6, "Text": " Well, then let's dive right into a demonstration."}, {"Time_Start": 428.6, "Time_End": 433.6, "Text": " I'm going to run a Nicto scan against this box, which is running Apache."}, {"Time_Start": 433.6, "Time_End": 439.6, "Text": " And give me a second here while I turn on a log tail."}, {"Time_Start": 442.6, "Time_End": 459.6, "Text": " Okay. What I'm going to do on my main laptop over here, I've got a Nikito scan all fired up and ready to go."}, {"Time_Start": 459.6, "Time_End": 466.6, "Text": " And Nikito, if you're unfamiliar with it, is the successor to whisker."}, {"Time_Start": 466.6, "Time_End": 472.0, "Text": " Rainforce puppy stopped active development on whisker. He's still maintaining lib whiskers. He's still maintaining"}, {"Time_Start": 472.0, "Time_End": 478.12, "Text": " Lib Whisker. And he is, if you're interested in what Whisker used to do, you're redirected"}, {"Time_Start": 478.12, "Time_End": 483.86, "Text": " to, not redirected, but encouraged to go to cert.net and get your hands on Nikhto, which in fact uses"}, {"Time_Start": 483.86, "Time_End": 492.22, "Text": " Lib Whisker. It is a web server scanner. And what it does, among other things, is it checks for"}, {"Time_Start": 492.22, "Time_End": 501.94, "Text": " known bad CGI scripts, known bad sample scripts of various kinds, and a whole lot more. And if you're"}, {"Time_Start": 502.0, "Time_End": 507.5, "Text": " interested in command line flags. I'm starting it with a general scan. That's what the dash G is for."}, {"Time_Start": 507.5, "Time_End": 515.0, "Text": " Dash N means no DNS resolution. And then dash H tells it the target host to scan."}, {"Time_Start": 515.0, "Time_End": 529.0, "Text": " So I fire that up. And at this point, I can skip to my victim. And let me see if I can expand that a little bit."}, {"Time_Start": 532.0, "Time_End": 543.94, "Text": " Okay. And ta-da, that's what, that's what log output looks like on a machine that's being"}, {"Time_Start": 543.94, "Time_End": 549.4, "Text": " Niktoscan. Fascinating, isn't it? I could watch this for hours."}, {"Time_Start": 551.9, "Time_End": 556.62, "Text": " Actually, you know, well, that isn't the point. Notice, though, what I'm seeing is a lot of"}, {"Time_Start": 556.62, "Time_End": 561.98, "Text": " repetitions of really similar messages, or messages. If I'm setting up something like,"}, {"Time_Start": 562.0, "Time_End": 567.24, "Text": " like Swatch, if I'm setting up something like Log Digest, I'm going to make sure that this"}, {"Time_Start": 567.24, "Time_End": 572.1, "Text": " string, file does not exist is one of the things that I'm checking for, right? If I'm concerned"}, {"Time_Start": 572.1, "Time_End": 577.68, "Text": " about being Nicto scan, if I'm concerned about people probing this web server for stuff."}, {"Time_Start": 578.72, "Time_End": 586.26, "Text": " Now, if I'm only interested in a specific type of scan, I can say, you know, grep for more than"}, {"Time_Start": 586.26, "Time_End": 591.5, "Text": " file does not exist. But you get the idea. Any questions?"}, {"Time_Start": 592.0, "Time_End": 593.36, "Text": " I know that's really deep and all."}, {"Time_Start": 595.92, "Time_End": 596.32, "Text": " Okay."}, {"Time_Start": 599.12, "Time_End": 599.84, "Text": " Wait, oops."}, {"Time_Start": 600.32, "Time_End": 601.12, "Text": " Okay, there we go."}, {"Time_Start": 601.84, "Time_End": 603.76, "Text": " Now, as you can see, this is back too."}, {"Time_Start": 603.82, "Time_End": 604.34, "Text": " Oh, nuts."}, {"Time_Start": 604.58, "Time_End": 605.22, "Text": " Look over here."}, {"Time_Start": 606.84, "Time_End": 608.52, "Text": " Oh, I wonder if the problem is the switch."}, {"Time_Start": 611.64, "Time_End": 612.24, "Text": " Ah, well."}, {"Time_Start": 615.68, "Time_End": 617.12, "Text": " Oh, yeah, it must be the switch."}, {"Time_Start": 617.76, "Time_End": 618.08, "Text": " Okay."}, {"Time_Start": 620.8, "Time_End": 621.68, "Text": " So as we can see,"}, {"Time_Start": 621.6800000000001, "Time_End": 623.2800000000001, "Text": " Nickto is finding some things wrong."}, {"Time_Start": 624.48, "Time_End": 631.6400000000001, "Text": " And, oh, one of the things that it is found is that there is the Apache manual installed on here,"}, {"Time_Start": 631.7, "Time_End": 633.3000000000001, "Text": " which is default for Sousal Linux."}, {"Time_Start": 633.4000000000001, "Time_End": 638.1600000000001, "Text": " When you install Apache on Sousal Linux, it very conveniently gives you the Apache manual."}, {"Time_Start": 638.46, "Time_End": 639.72, "Text": " Now, that's probably harmless."}, {"Time_Start": 640.6600000000001, "Time_End": 642.34, "Text": " I mean, it's just a manual, right?"}, {"Time_Start": 642.4000000000001, "Time_End": 644.0200000000001, "Text": " But it has a little search engine in there."}, {"Time_Start": 644.5600000000001, "Time_End": 650.7600000000001, "Text": " And the fact is that as a matter of practice, you don't want anything unnecessary installed on a production web server, right?"}, {"Time_Start": 650.76, "Time_End": 655.98, "Text": " So even something as innocuous as the Apache manual being there is still a significant finding."}, {"Time_Start": 656.06, "Time_End": 665.98, "Text": " And this, of course, is the other benefit of this technique is when you scan yourself, you will find out if there's more hardening that you still got to do on the hosting question."}, {"Time_Start": 667.48, "Time_End": 676.7, "Text": " I would like, if I could, to insert another demo here that I hadn't really included on the slides."}, {"Time_Start": 677.36, "Time_End": 680.66, "Text": " But before I do that, are there any questions?"}, {"Time_Start": 680.76, "Time_End": 685.4399999999999, "Text": " up to this point? Any at all? Okay."}, {"Time_Start": 691.54, "Time_End": 707.6, "Text": " What I'm going to do is I'm going to do is I'm going to to pull up that manual. Here, bear with me with me with me."}, {"Time_Start": 710.76, "Time_End": 720.26, "Text": " And what do we got here?"}, {"Time_Start": 722.88, "Time_End": 725.52, "Text": " Yep, sure enough, Nikhto was not delusional."}, {"Time_Start": 726.52, "Time_End": 729.26, "Text": " The Apache manual is running on this host."}, {"Time_Start": 730.74, "Time_End": 736.9, "Text": " Now, there is a thing called Peros."}, {"Time_Start": 737.64, "Time_End": 740.64, "Text": " The Loft has an equivalent of this product."}, {"Time_Start": 740.76, "Time_End": 743.92, "Text": " I think it's called, or excuse me, at stake, my bad."}, {"Time_Start": 744.56, "Time_End": 746.8199999999999, "Text": " The at stake web security proxy."}, {"Time_Start": 747.58, "Time_End": 753.56, "Text": " And what a web security proxy is for, is for testing various types of web vulnerabilities"}, {"Time_Start": 753.56, "Time_End": 757.06, "Text": " at the application layer."}, {"Time_Start": 757.06, "Time_End": 765.56, "Text": " And in other words, I can trap requests from my outbound requests from my attacking machine,"}, {"Time_Start": 766.34, "Time_End": 770.74, "Text": " monkey with them, and then send them back on their way towards the victim machine."}, {"Time_Start": 770.76, "Time_End": 775.42, "Text": " So let's say I click trap request on here."}, {"Time_Start": 775.98, "Time_End": 778.46, "Text": " And incidentally, Peros is available."}, {"Time_Start": 779.22, "Time_End": 779.74, "Text": " Oh, brother."}, {"Time_Start": 780.16, "Time_End": 781.56, "Text": " I forgot to include a URL on this."}, {"Time_Start": 781.86, "Time_End": 788.24, "Text": " If you do a Google search for Peros web proxy, you'll find it really easily."}, {"Time_Start": 788.9, "Time_End": 789.8199999999999, "Text": " Oh, wait, I know what I can do."}, {"Time_Start": 793.56, "Time_End": 794.64, "Text": " Proofsecure.com."}, {"Time_Start": 794.76, "Time_End": 797.74, "Text": " That's where you get Peros, or Paros, if you're European."}, {"Time_Start": 799.64, "Time_End": 800.74, "Text": " Proofsecure.com."}, {"Time_Start": 800.76, "Time_End": 805.16, "Text": " Okay, I have told Peros to trap the next request that passes through it."}, {"Time_Start": 805.26, "Time_End": 815.16, "Text": " Oh, and incidentally, behind the scenes in my hotel room, I set up my web browser so that it's using local host, colon 8080 as its web proxy."}, {"Time_Start": 815.46, "Time_End": 817.24, "Text": " And that's what Perilus is listening on."}, {"Time_Start": 817.88, "Time_End": 819.5, "Text": " I go back to my web page here."}, {"Time_Start": 821.06, "Time_End": 824.5, "Text": " I type in some kind of, wait, let's do something that I'll see."}, {"Time_Start": 826.64, "Time_End": 830.1, "Text": " I type in a search string, click the button."}, {"Time_Start": 830.76, "Time_End": 834.88, "Text": " Now, the Netscape icon, oh, I'm pointing at my screen, that does you no good at all."}, {"Time_Start": 835.4, "Time_End": 839.58, "Text": " In the upper right-hand corner, that Netscape icon is spinning and spinning."}, {"Time_Start": 839.74, "Time_End": 849.12, "Text": " That's because, that's because Peros has grabbed that outbound HTTP request so that I can monkey with it."}, {"Time_Start": 849.64, "Time_End": 854.7, "Text": " And we see down here in the bottom, in the body, I mean, here's my search string."}, {"Time_Start": 855.8, "Time_End": 860.34, "Text": " Now, this is sort of a lame example, but what I could do here is."}, {"Time_Start": 860.76, "Time_End": 867.66, "Text": " type perhaps a much, much longer string than the web page itself will let me type in in that field."}, {"Time_Start": 868.98, "Time_End": 876.26, "Text": " So I lay in a whole bunch of Fs, and then I hit continue."}, {"Time_Start": 877.12, "Time_End": 882.14, "Text": " Now if I flip back to my web server, okay, I got an error message. That's good."}, {"Time_Start": 882.9399999999999, "Time_End": 885.66, "Text": " That little search engine apparently has some kind of error handling."}, {"Time_Start": 885.66, "Time_End": 890.74, "Text": " But if it didn't, let's, if the web server, if the web server froze up,"}, {"Time_Start": 890.76, "Time_End": 895.02, "Text": " up or something, that would tell me something about the security involved in that little"}, {"Time_Start": 895.02, "Time_End": 900.3, "Text": " search thing. So anyhow, that's Peros. If you're interested in web security and if you're"}, {"Time_Start": 900.3, "Time_End": 905.54, "Text": " running a web server, you really ought to be. I highly recommend this tool for testing"}, {"Time_Start": 905.54, "Time_End": 913.42, "Text": " web forms and web applications, anything that could be vulnerable to fuzzing, which is what we"}, {"Time_Start": 913.42, "Time_End": 920.04, "Text": " just did, by the way, fusing, cross-scripting type attacks, you name it. Okay, back to the"}, {"Time_Start": 920.04, "Time_End": 921.28, "Text": " regularly scheduled program."}, {"Time_Start": 925.8, "Time_End": 929.12, "Text": " Okay. So we saw Nikto versus Apache."}, {"Time_Start": 930.56, "Time_End": 936.1999999999999, "Text": " Let's dive right into a third demonstration. Can you believe it? So many demonstrations in such"}, {"Time_Start": 936.1999999999999, "Time_End": 944.9, "Text": " a short period of time. Oh, no, why is this still logging? Oh, is Nikto still running?"}, {"Time_Start": 945.0, "Time_End": 948.12, "Text": " Must be. Oh, yeah, it is. Okay, I'm going to kill Nicto."}, {"Time_Start": 950.04, "Time_End": 957.98, "Text": " And the site for NICTO, by the way, it's in the slides in your program, but"}, {"Time_Start": 957.98, "Time_End": 964.4399999999999, "Text": " it's cert.net, that's C-I-R-T dot net, you know, www.sert.net."}, {"Time_Start": 964.4399999999999, "Time_End": 966.5799999999999, "Text": " Um, okay, good."}, {"Time_Start": 969.9599999999999, "Time_End": 979.0799999999999, "Text": " Now, am I, okay. Now, Nessus. Now, Nessus, available at www. Nessus.org."}, {"Time_Start": 980.04, "Time_End": 987.28, "Text": " Standing General Network Security Scanner from Raynaud Der Eisen. He gave a presentation at I think Black Hat a couple years ago."}, {"Time_Start": 987.8, "Time_End": 994.0, "Text": " Heck of a guy. And Nessus is, if you are a security auditor or, well, anybody, it is just the coolest thing."}, {"Time_Start": 994.0, "Time_End": 1003.5799999999999, "Text": " Because it does what commercial, expensive commercial security scanners do, but for free and 100% user customizable."}, {"Time_Start": 1004.0999999999999, "Time_End": 1010.02, "Text": " So, in other words, you know of or have written some zero-day exploit, right? You're not behold"}, {"Time_Start": 1010.0400000000001, "Time_End": 1015.9200000000001, "Text": " into some vendor to provide you with a plug-in script. You can write your own if you need"}, {"Time_Start": 1015.9200000000001, "Time_End": 1021.72, "Text": " or want to. It's got super easy to use language for that, its own scripting language."}, {"Time_Start": 1022.96, "Time_End": 1028.96, "Text": " Now, before I started this presentation, I logged in and everything, and I'm not, this is not"}, {"Time_Start": 1028.96, "Time_End": 1034.8400000000001, "Text": " going to be a tutorial on using Nessus. I've written articles about it. Actually, my book, I haven't"}, {"Time_Start": 1034.8400000000001, "Time_End": 1039.28, "Text": " plugged my book yet. Many of you are probably disappointed because I've not yet plugged the book."}, {"Time_Start": 1040.04, "Time_End": 1041.36, "Text": " Building Secure Servers with Linux."}, {"Time_Start": 1041.84, "Time_End": 1048.34, "Text": " You've got Chapter 10 from this book on your CD, which might have been really dumb of me because maybe you feel no need to buy it."}, {"Time_Start": 1048.3799999999999, "Time_End": 1050.08, "Text": " Now that you've got juicy Chapter 10."}, {"Time_Start": 1050.1599999999999, "Time_End": 1051.34, "Text": " But there's much, much more."}, {"Time_Start": 1052.8999999999999, "Time_End": 1059.6399999999999, "Text": " Anyhow, in Chapter 3, I think, I talk about using Nessus as a sanity check after you harden the system."}, {"Time_Start": 1059.94, "Time_End": 1062.0, "Text": " So you want to detailed information on Nessus?"}, {"Time_Start": 1062.48, "Time_End": 1064.34, "Text": " Buy the book. Flip to Chapter 3."}, {"Time_Start": 1064.6399999999999, "Time_End": 1064.86, "Text": " Okay."}, {"Time_Start": 1065.78, "Time_End": 1067.02, "Text": " So what have I got here?"}, {"Time_Start": 1067.02, "Time_End": 1070.02, "Text": " I set up a scan that's pretty simple."}, {"Time_Start": 1070.04, "Time_End": 1077.72, "Text": " Selective, I disabled a bunch of the plugins that I know are completely irrelevant to this system, strictly for the sake of expediency here."}, {"Time_Start": 1078.72, "Time_End": 1087.32, "Text": " Another thing that's cool about Nessus is step one in the Nessus scan is a big old hairy port scan. Usually, I mean, by default, it uses NMAP."}, {"Time_Start": 1088.36, "Time_End": 1099.94, "Text": " But that's really pretty time consuming. And you can, there's nothing to stop you from running your own NMAP scan, saving the output to a file, and then telling it, telling"}, {"Time_Start": 1100.04, "Time_End": 1107.54, "Text": " says, hey, I've already got scan output, use that. And what else have I got here?"}, {"Time_Start": 1107.54, "Time_End": 1127.04, "Text": " Okay, target selection. My target host is 10.25.25.2. And, oh, in the interest of"}, {"Time_Start": 1127.04, "Time_End": 1130.84, "Text": " full disclosure. You know what? I misinterpreted that error message I got from my"}, {"Time_Start": 1130.84, "Time_End": 1138.0, "Text": " web server before. According to my log dump, the reason I got an empty page was because I've got a"}, {"Time_Start": 1138.0, "Time_End": 1144.32, "Text": " broken manual installed here. File does not exist. Serve.HD.c.C.I. Local guestbook."}, {"Time_Start": 1144.32, "Time_End": 1151.82, "Text": " that's pretty cool. If there are any invulnerabilities in that guestbook, they don't apply. It's not"}, {"Time_Start": 1151.82, "Time_End": 1155.82, "Text": " there. I'm sorry. That just kind of caught me eye there."}, {"Time_Start": 1157.04, "Time_End": 1160.3799999999999, "Text": " Oh, good. The screen back came up. The screen came back up."}, {"Time_Start": 1160.82, "Time_End": 1173.12, "Text": " Nessus is really good about tracking sessions. So if you've already scanned a host and you had clicked, save this session, then later on, you can click on that session."}, {"Time_Start": 1173.28, "Time_End": 1182.92, "Text": " You know, it's got a date and a timestamp and an IP address. And WAML, it will pick up where that scan left off if you interrupted it or rerun it, whatever you want to do."}, {"Time_Start": 1182.92, "Time_End": 1187.02, "Text": " I'm putting it in manually because I want to pretend that I haven't already scanned this box sideway."}, {"Time_Start": 1187.04, "Time_End": 1193.08, "Text": " And, oh wait, let me show you the knowledge-based page, too. That's actually pretty cool."}, {"Time_Start": 1194.3999999999999, "Time_End": 1202.02, "Text": " NES can keep track of everything that it scans in a database. It's called the knowledge base."}, {"Time_Start": 1202.72, "Time_End": 1216.5, "Text": " And so when you do subsequent tests, I mean, say you've got this, you know, web server farm, and you're going to scan it periodically to make sure that as you add web applications, as you add software, as you apply system patches or what have you,"}, {"Time_Start": 1216.5, "Time_End": 1222.14, "Text": " that, you know, that you're still not exposing yourself to anything obvious."}, {"Time_Start": 1222.58, "Time_End": 1228.9, "Text": " You can maintain a knowledge base on that host so that basically what you do is a full scan and then incremental scans."}, {"Time_Start": 1230.24, "Time_End": 1236.48, "Text": " That saves you the time and tedium of running the same scripts over and over and getting the same results over and over."}, {"Time_Start": 1237.26, "Time_End": 1240.54, "Text": " Okay. I'm just going to fire up the scan here now, though."}, {"Time_Start": 1243.06, "Time_End": 1246.48, "Text": " And now at this point, I'll flip back to our little web server."}, {"Time_Start": 1246.5, "Time_End": 1252.9, "Text": " and since where I'm now doing a general scan, I'm going to tail varlog messages."}, {"Time_Start": 1253.8, "Time_End": 1259.8, "Text": " And if you see some really wacky animation, it's because I've got a bad, bad checkpoint driver on this system."}, {"Time_Start": 1260.1, "Time_End": 1260.82, "Text": " Hold on a sec."}, {"Time_Start": 1276.5, "Time_End": 1282.0, "Text": " Okay. And now we start to see some nasty grams."}, {"Time_Start": 1285.6, "Time_End": 1289.06, "Text": " Oh, and some of them are even coming for me. Better still."}, {"Time_Start": 1293.38, "Time_End": 1296.24, "Text": " Oh, it looks like it's doing a port scan. Well, I'll be darned."}, {"Time_Start": 1297.94, "Time_End": 1299.9, "Text": " Well, isn't that annoying? Well, that's going to take all day."}, {"Time_Start": 1301.34, "Time_End": 1303.44, "Text": " Nassus is not without its quirks."}, {"Time_Start": 1306.5, "Time_End": 1312.14, "Text": " Well, not so funny. I said, do not execute scanners that have already been executed."}, {"Time_Start": 1313.04, "Time_End": 1313.9, "Text": " What the heck?"}, {"Time_Start": 1316.98, "Time_End": 1317.74, "Text": " Oh, well."}, {"Time_Start": 1327.66, "Time_End": 1329.0, "Text": " Maybe it'll go real fast."}, {"Time_Start": 1332.78, "Time_End": 1334.3, "Text": " Now, it's worth mentioning that."}, {"Time_Start": 1334.3, "Time_End": 1336.48, "Text": " That's worth mentioning that on my victim,"}, {"Time_Start": 1336.5, "Time_End": 1341.78, "Text": " here. These messages that you're seeing, the drop by default, that's not stock"}, {"Time_Start": 1341.78, "Time_End": 1349.3, "Text": " sous a 8.1 behavior. I'm running a custom IP table script on here, and at the bottom of"}, {"Time_Start": 1349.3, "Time_End": 1354.06, "Text": " the script, I've got default drop rules, and preceding each default drop rule, you know,"}, {"Time_Start": 1354.06, "Time_End": 1360.52, "Text": " for each of the three chains, input, forward, and output, I've got a log rule that says, log"}, {"Time_Start": 1360.52, "Time_End": 1365.46, "Text": " everything that's made it this far and then drop it. So,"}, {"Time_Start": 1366.5, "Time_End": 1371.0, "Text": " You're not going to see these messages, the packet level, dropped by default messages,"}, {"Time_Start": 1371.28, "Time_End": 1373.2, "Text": " unless you have done the same on your system."}, {"Time_Start": 1374.48, "Time_End": 1376.12, "Text": " A note about IP tables."}, {"Time_Start": 1376.52, "Time_End": 1380.92, "Text": " Most of the major distros now have their own scripts for generating firewall rules."}, {"Time_Start": 1381.74, "Time_End": 1384.04, "Text": " I've really got a love-hate relationship with those."}, {"Time_Start": 1384.36, "Time_End": 1391.08, "Text": " Sometimes they can be helpful if your needs match those that the distro developer had in mind."}, {"Time_Start": 1391.96, "Time_End": 1395.68, "Text": " I tend to do pretty zany stuff with my machines, and so that's seldom the case."}, {"Time_Start": 1395.68, "Time_End": 1397.74, "Text": " I tend to prefer to roll my own."}, {"Time_Start": 1398.5, "Time_End": 1401.5600000000002, "Text": " Chapter 10 of my book, which, again, is on your DefCon CD-ROM,"}, {"Time_Start": 1401.8, "Time_End": 1406.9, "Text": " so that statement is not in itself a pitch, has, oh, wait a minute, no, it doesn't."}, {"Time_Start": 1407.04, "Time_End": 1408.22, "Text": " Chapter 2 does."}, {"Time_Start": 1408.44, "Time_End": 1409.5600000000002, "Text": " Okay, I am pitching my book."}, {"Time_Start": 1410.2, "Time_End": 1414.98, "Text": " Chapter 2 of my book describes how to write IP table scripts for the specific purpose of"}, {"Time_Start": 1414.98, "Time_End": 1416.64, "Text": " protecting a Bastion host."}, {"Time_Start": 1416.96, "Time_End": 1420.98, "Text": " I think that running firewall rules on a non-firewall machine is a really groovy thing to do."}, {"Time_Start": 1421.18, "Time_End": 1421.88, "Text": " I mean, why not?"}, {"Time_Start": 1422.3, "Time_End": 1425.66, "Text": " Maybe you as a web administrator are more cluelful than your local"}, {"Time_Start": 1425.68, "Time_End": 1430.54, "Text": " firewall admins. I've seen it happen. It's not quite as common as the reverse, but hey,"}, {"Time_Start": 1431.24, "Time_End": 1437.5800000000002, "Text": " the point is that any system that is Internet accessible should have some ability to defend itself,"}, {"Time_Start": 1437.88, "Time_End": 1443.02, "Text": " regardless of what the firewall that it's on the inside of, you know, does or does not do for it."}, {"Time_Start": 1443.8, "Time_End": 1448.18, "Text": " So I've got some really simple rules that all inbound HTTP, inbound secure shell,"}, {"Time_Start": 1448.64, "Time_End": 1454.76, "Text": " inbound SMTP, just so that people would see something, something if they scanned it, and nothing else."}, {"Time_Start": 1455.68, "Time_End": 1464.92, "Text": " Another thing that's worth noting is, naturally, I have set my default IP tables policies on input, forward, and output to drop, right?"}, {"Time_Start": 1465.1000000000001, "Time_End": 1470.22, "Text": " So I don't really need my drop rules at the bottom, but they're there anyhow so that I can have the logging."}, {"Time_Start": 1471.3600000000001, "Time_End": 1476.8400000000001, "Text": " Because your default policy that you assign to an IP tables chain doesn't log."}, {"Time_Start": 1477.24, "Time_End": 1477.72, "Text": " Go figure."}, {"Time_Start": 1478.5600000000002, "Time_End": 1478.8, "Text": " Okay."}, {"Time_Start": 1480.72, "Time_End": 1483.3, "Text": " So my necessary, okay, it's beginning actual attacks."}, {"Time_Start": 1483.3, "Time_End": 1485.66, "Text": " I wound up with them, I did wind up with a much, much short."}, {"Time_Start": 1485.68, "Time_End": 1490.5600000000002, "Text": " short report scanned. So the knowledge base did kick in there. Okay, cool. I was beginning"}, {"Time_Start": 1490.5600000000002, "Time_End": 1499.1200000000001, "Text": " to question my grip on reality. I never do that. All right. And now at this point, at this point,"}, {"Time_Start": 1499.1200000000001, "Time_End": 1506.46, "Text": " the web log starts to get interesting, and we start to see Ness's specific Apache errors."}, {"Time_Start": 1507.3600000000001, "Time_End": 1511.42, "Text": " We're seeing a lot of the same stuff that we saw from NICTO, aren't we? We're seeing file does not"}, {"Time_Start": 1511.42, "Time_End": 1515.42, "Text": " exist. But then we're also seeing some somewhat more exotic stuff."}, {"Time_Start": 1515.68, "Time_End": 1524.68, "Text": " to invoke directory something. It zipped by a little too fast. But there you have it."}, {"Time_Start": 1525.02, "Time_End": 1534.42, "Text": " Nessuscan, tailed logs. I now have some idea of what script kitty behavior should look like."}, {"Time_Start": 1535.3400000000001, "Time_End": 1540.76, "Text": " And it's been on my terms, on my own spare time, at my own pace, instead of when the fur is flying."}, {"Time_Start": 1541.3, "Time_End": 1544.44, "Text": " A lot harder to get up to speed on this stuff when the fur is flying."}, {"Time_Start": 1544.44, "Time_End": 1546.22, "Text": " Any questions up to this point?"}, {"Time_Start": 1548.98, "Time_End": 1555.2, "Text": " Comments, jokes, coughs? No one's even coughing. It's creeping me out."}, {"Time_Start": 1556.66, "Time_End": 1559.3600000000001, "Text": " Oh, God, they're alive. Good. All right. Thank you."}, {"Time_Start": 1560.74, "Time_End": 1562.14, "Text": " Oh, and by the way, can everyone here okay?"}, {"Time_Start": 1565.44, "Time_End": 1567.02, "Text": " Some question. Never mind."}, {"Time_Start": 1570.5, "Time_End": 1574.3400000000001, "Text": " Okay. I killed the scan because I'm sure that you get the idea."}, {"Time_Start": 1574.44, "Time_End": 1581.4, "Text": " Oh, I guess here. In case you've never seen Nessus output before, here's some Nessus output for us."}, {"Time_Start": 1581.48, "Time_End": 1585.94, "Text": " Now, I didn't even finish the scam, but I already found some stuff. What did it find? Oh, this is entertaining."}, {"Time_Start": 1586.1000000000001, "Time_End": 1590.94, "Text": " I've seen this one before. Oh, sorry, sorry. Thank you."}, {"Time_Start": 1593.44, "Time_End": 1599.2, "Text": " And I think I doubted that you guys were awake. Okay, remote OS guests."}, {"Time_Start": 1600.06, "Time_End": 1603.76, "Text": " This is a Panasonic IP technology broadband networking gateway."}, {"Time_Start": 1604.44, "Time_End": 1608.6200000000001, "Text": " I had no idea. When I bought this thing, I thought I was getting a plain, ordinary think pad."}, {"Time_Start": 1612.04, "Time_End": 1620.06, "Text": " Actual voams, though. It did correctly identify an HEDP problem, and that is that it supports the trace method."}, {"Time_Start": 1620.42, "Time_End": 1631.3200000000002, "Text": " Now, if I go back here, and I'm not going to do it right now, but if I go back in the logs, the log messages that correspond to that attack, I will see that this is, in fact, sort of a false positive."}, {"Time_Start": 1631.32, "Time_End": 1634.82, "Text": " but there it is."}, {"Time_Start": 1635.5, "Time_End": 1643.3799999999999, "Text": " Something that's worth pointing out is that if I let the NESA scan go to its logical conclusion,"}, {"Time_Start": 1644.4399999999998, "Time_End": 1648.04, "Text": " I will see some different stuff than I saw on the Nekhto scan."}, {"Time_Start": 1648.72, "Time_End": 1657.1599999999999, "Text": " So, while it might be tempting to assume that there is a really well-known finite list of attacks"}, {"Time_Start": 1657.1599999999999, "Time_End": 1661.3, "Text": " that people think are noteworthy against Apache, there are, in fact, differences of opinion."}, {"Time_Start": 1661.32, "Time_End": 1670.72, "Text": " between the guys who do NICTO and the guys who do NECDES. It truly is worthwhile doing more than one type of scan against a production host."}, {"Time_Start": 1670.72, "Time_End": 1679.12, "Text": " If you're serious about, you know, about checking your hardening work, knowing what types of attacks to look for, and that sort of thing."}, {"Time_Start": 1679.22, "Time_End": 1683.3999999999999, "Text": " So I found that interesting that I got different results each way."}, {"Time_Start": 1683.9399999999998, "Time_End": 1686.1399999999999, "Text": " Okay, I'm going to close the report."}, {"Time_Start": 1687.98, "Time_End": 1689.72, "Text": " Oops. Not cancel."}, {"Time_Start": 1691.32, "Time_End": 1698.1399999999999, "Text": " save that. Back to the slides. Now I've got screenshots in the slideshow on your CD-ROM."}, {"Time_Start": 1699.22, "Time_End": 1704.6, "Text": " It would be a lot more fun for you to reproduce these on your own, but if you're not inclined to,"}, {"Time_Start": 1705.1399999999999, "Time_End": 1715.12, "Text": " I've got, I show Nessus in action and I show the log output. So now let's talk about loggers."}, {"Time_Start": 1717.56, "Time_End": 1721.1599999999999, "Text": " I've done these scans. I've gotten a feel for what"}, {"Time_Start": 1721.32, "Time_End": 1727.6799999999998, "Text": " scan activity looks like for some pretty granular, some pretty deep security probing,"}, {"Time_Start": 1727.9199999999998, "Time_End": 1730.78, "Text": " you know, way beyond just simple port scanning, actually."}, {"Time_Start": 1732.86, "Time_End": 1738.1599999999999, "Text": " And suppose that I have not seen as much as I expected or wanted to see. What do I do about that?"}, {"Time_Start": 1738.58, "Time_End": 1745.22, "Text": " Well, on most systems, you edit Etsycislog.com, on most Unix systems. What I've got here"}, {"Time_Start": 1745.22, "Time_End": 1751.1399999999999, "Text": " are the relevant lines, that is to say, I've stripped away most of the commentary, from"}, {"Time_Start": 1751.32, "Time_End": 1754.48, "Text": " a red hat 7.3 syslog.com file."}, {"Time_Start": 1755.0, "Time_End": 1760.5, "Text": " And as with Nessus, I'm not going to deliver a dissertation on configuring syslog."}, {"Time_Start": 1760.6599999999999, "Time_End": 1764.1799999999998, "Text": " It's all in the syslog.comf man page."}, {"Time_Start": 1765.1, "Time_End": 1772.04, "Text": " But just at a high level, what you've got on the left-hand side of the screen are log facility"}, {"Time_Start": 1772.04, "Time_End": 1775.08, "Text": " and log severity pairs."}, {"Time_Start": 1775.32, "Time_End": 1778.22, "Text": " So you've got facility dot severity, right?"}, {"Time_Start": 1778.22, "Time_End": 1780.08, "Text": " And you can use the star wild card."}, {"Time_Start": 1780.58, "Time_End": 1781.3, "Text": " That's,"}, {"Time_Start": 1781.32, "Time_End": 1787.5, "Text": " tells syslog d in any given case what sort of message is to look for. And then on the"}, {"Time_Start": 1787.5, "Time_End": 1793.32, "Text": " right hand side, it tells syslog d what to do with them. I can write them to a file. So"}, {"Time_Start": 1793.32, "Time_End": 1800.86, "Text": " var log messages, I'm going to write a lot of stuff too. I can, if I put a star on the right"}, {"Time_Start": 1800.86, "Time_End": 1810.54, "Text": " hand side, I keep pointing to the screen. You can't see this. Oh, use the mouse. Good idea. If I put"}, {"Time_Start": 1810.54, "Time_End": 1819.32, "Text": " a star over here. That says write the log message to all consoles. Now that's only"}, {"Time_Start": 1819.32, "Time_End": 1825.12, "Text": " useful, of course, if some cis adminly type, some cis administrative type person is actually"}, {"Time_Start": 1825.12, "Time_End": 1831.86, "Text": " logged on. So that's one that you generally don't want to do. That's not the only destination that"}, {"Time_Start": 1831.86, "Time_End": 1837.1399999999999, "Text": " you want to use for any given class of log messages. You want to make sure that that that entry is redundant"}, {"Time_Start": 1837.1399999999999, "Time_End": 1840.42, "Text": " with other entries that write to files. And indeed, by default,"}, {"Time_Start": 1840.54, "Time_End": 1847.58, "Text": " you know, the redhead 73 syslog.com file is. But you can also send messages to a remote"}, {"Time_Start": 1847.58, "Time_End": 1854.36, "Text": " host. And the way that you do that is by doing at sign and then host name or IP. And that'll send it to"}, {"Time_Start": 1854.36, "Time_End": 1862.6, "Text": " UDP 514 on your central log server. My talk at DefCon last year was about setting up a centralized"}, {"Time_Start": 1862.6, "Time_End": 1870.52, "Text": " stealth logger and using it in just that fashion. It's real important that you have good logger."}, {"Time_Start": 1870.54, "Time_End": 1873.54, "Text": " and you have logs that you can trust."}, {"Time_Start": 1873.54, "Time_End": 1878.54, "Text": " Which is to say if you get owned, you want to make sure that later on when you go to analyze"}, {"Time_Start": 1878.54, "Time_End": 1882.54, "Text": " the logs from that, that you don't have to worry about them having been altered."}, {"Time_Start": 1882.54, "Time_End": 1889.54, "Text": " Well, the logs, you know, the local logs on the machine, you have to assume that they've been tampered with."}, {"Time_Start": 1889.54, "Time_End": 1899.54, "Text": " Your best hope at log integrity is having a copy of those log messages having been sent to some centralized logger."}, {"Time_Start": 1899.54, "Time_End": 1900.52, "Text": " So that you can use those."}, {"Time_Start": 1900.54, "Time_End": 1902.7, "Text": " for the serious forensic analysis later on."}, {"Time_Start": 1905.6, "Time_End": 1906.04, "Text": " Okay."}, {"Time_Start": 1907.04, "Time_End": 1909.3999999999999, "Text": " So, here's a bonus."}, {"Time_Start": 1910.8999999999999, "Time_End": 1913.94, "Text": " This is a chart that was not included in my book."}, {"Time_Start": 1914.08, "Time_End": 1916.3, "Text": " My editor felt that it was kind of confusing."}, {"Time_Start": 1917.1399999999999, "Time_End": 1920.58, "Text": " But the thing is, it won't be confusing to you"}, {"Time_Start": 1920.58, "Time_End": 1922.3799999999999, "Text": " because I'll explain it right here in real time."}, {"Time_Start": 1922.62, "Time_End": 1925.72, "Text": " This is actually like three or four charts glommed into one."}, {"Time_Start": 1926.08, "Time_End": 1928.44, "Text": " The double lines, you know, separate the different parts."}, {"Time_Start": 1928.44, "Time_End": 1930.2, "Text": " But I've got a list of"}, {"Time_Start": 1930.2, "Time_End": 1936.28, "Text": " the facilities that SISLog uses with their corresponding numeric equivalents."}, {"Time_Start": 1937.88, "Time_End": 1944.06, "Text": " I've got a list of priorities, you know, log levels, and their corresponding numeric values."}, {"Time_Start": 1944.6000000000001, "Time_End": 1948.9, "Text": " If you've ever tried to dig up this information in other places, it can be a little tricky."}, {"Time_Start": 1949.06, "Time_End": 1952.48, "Text": " I don't think that the numeric codes are in the man page, at least on Linux."}, {"Time_Start": 1953.72, "Time_End": 1957.2, "Text": " And then I've got a synopsis of the different actions that you can use."}, {"Time_Start": 1957.98, "Time_End": 1960.18, "Text": " And the usage of different operators."}, {"Time_Start": 1960.2, "Time_End": 1961.56, "Text": " like bang and equal sign."}, {"Time_Start": 1962.02, "Time_End": 1969.38, "Text": " So I encourage you, if you've got SISLog Damans to configure, to print this out and tack it up on your cube,"}, {"Time_Start": 1969.66, "Time_End": 1972.66, "Text": " it'll save you a bunch of man page and info page lookups."}, {"Time_Start": 1973.06, "Time_End": 1974.22, "Text": " At least that's what I hope."}, {"Time_Start": 1975.72, "Time_End": 1980.18, "Text": " But I won't read every line on it to you right now if that's okay."}, {"Time_Start": 1982.06, "Time_End": 1982.54, "Text": " Okay."}, {"Time_Start": 1982.72, "Time_End": 1987.3600000000001, "Text": " Now for you Debian fans out there, here's Syslog NG configuration."}, {"Time_Start": 1987.3600000000001, "Time_End": 1993.5600000000002, "Text": " If you run Debian, I believe SISLogNG is the default loger, isn't it?"}, {"Time_Start": 1995.3400000000001, "Time_End": 1996.38, "Text": " Or is it optional?"}, {"Time_Start": 1997.72, "Time_End": 1999.66, "Text": " Oh, it is optional. Oh, my mistake."}, {"Time_Start": 1999.8200000000002, "Time_End": 2000.38, "Text": " But it's there."}, {"Time_Start": 2000.66, "Time_End": 2005.18, "Text": " I recommend that you use it because it's a lot more powerful than regular old SISLog."}, {"Time_Start": 2005.8000000000002, "Time_End": 2009.2800000000002, "Text": " Syslog NG is also available on Sousa Linux as an optional package,"}, {"Time_Start": 2009.6000000000001, "Time_End": 2011.8000000000002, "Text": " probably on other Linux distros too by now."}, {"Time_Start": 2012.0000000000002, "Time_End": 2012.9, "Text": " It'll run on anything."}, {"Time_Start": 2012.9, "Time_End": 2017.3200000000002, "Text": " I mean, you can get the source code from,"}, {"Time_Start": 2017.3600000000001, "Time_End": 2023.46, "Text": " let's see, www. balabit, B-A-L-A-B-I-T-D-I-T-U."}, {"Time_Start": 2024.3400000000001, "Time_End": 2028.3400000000001, "Text": " And the home page is in Hungarian, but there's a little button that says English."}, {"Time_Start": 2028.8000000000002, "Time_End": 2032.0600000000002, "Text": " You probably want to click that and then follow the links to Syslog N-G."}, {"Time_Start": 2033.3000000000002, "Time_End": 2038.6000000000001, "Text": " Syslog N-G is covered in depth in the sample chapter for my book that's on your CD-ROM."}, {"Time_Start": 2039.22, "Time_End": 2042.72, "Text": " And so I will let that do the talking about Syslog-N-G."}, {"Time_Start": 2046.14, "Time_End": 2047.3400000000001, "Text": " Pardon via JetP."}, {"Time_Start": 2047.3600000000001, "Time_End": 2051.76, "Text": " Oh, yeah."}, {"Time_Start": 2056.6600000000003, "Time_End": 2059.28, "Text": " I just said that in a really Minnesotan way, didn't I?"}, {"Time_Start": 2061.58, "Time_End": 2062.4, "Text": " Yeah, sure."}, {"Time_Start": 2067.76, "Time_End": 2070.2400000000002, "Text": " You can gaze upon that a little longer if you like."}, {"Time_Start": 2072.84, "Time_End": 2073.32, "Text": " Yes."}, {"Time_Start": 2077.36, "Time_End": 2082.52, "Text": " Well, does a kilt facilitate self-abuse?"}, {"Time_Start": 2083.02, "Time_End": 2088.7200000000003, "Text": " I'm not going to answer that question directly, but what I will say is that the sporren, which is the pouch in front,"}, {"Time_Start": 2089.08, "Time_End": 2095.26, "Text": " is the most practical accessory that a man can have, because it not only gets all of your important stuff right there in front of you,"}, {"Time_Start": 2095.7200000000003, "Time_End": 2097.9, "Text": " but if you need to scratch, no one's the wiser."}, {"Time_Start": 2107.36, "Time_End": 2111.08, "Text": " I believe Jeth Rotele may have said happiness is a warm sporn."}, {"Time_Start": 2111.52, "Time_End": 2112.54, "Text": " If he didn't, he should have."}, {"Time_Start": 2113.52, "Time_End": 2116.54, "Text": " Yeah, I wanted to get the furry one, but that would be just too distracting."}, {"Time_Start": 2121.42, "Time_End": 2121.82, "Text": " Okay."}, {"Time_Start": 2123.04, "Time_End": 2125.8, "Text": " Are we done transcribing my SISLog conf chart?"}, {"Time_Start": 2127.02, "Time_End": 2128.04, "Text": " I'm glad to like it."}, {"Time_Start": 2129.7200000000003, "Time_End": 2132.28, "Text": " I worked so hard on that, and then they didn't include it in the book."}, {"Time_Start": 2132.34, "Time_End": 2132.96, "Text": " I was miffed."}, {"Time_Start": 2133.38, "Time_End": 2134.04, "Text": " I'm still bitter."}, {"Time_Start": 2135.88, "Time_End": 2136.2400000000002, "Text": " Okay."}, {"Time_Start": 2136.54, "Time_End": 2137.34, "Text": " So Syslogen G."}, {"Time_Start": 2137.36, "Time_End": 2143.36, "Text": " What I will say about Syslog NG, about how it works is, you may look at this and say,"}, {"Time_Start": 2143.48, "Time_End": 2146.2000000000003, "Text": " God, that's a lot more confusing than syslog.com."}, {"Time_Start": 2146.6200000000003, "Time_End": 2148.7400000000002, "Text": " And it is more verbiage."}, {"Time_Start": 2149.04, "Time_End": 2151.42, "Text": " But it's highly module."}, {"Time_Start": 2151.6800000000003, "Time_End": 2155.34, "Text": " You've got your option statements that are global options for the Damon's behavior."}, {"Time_Start": 2156.0, "Time_End": 2162.3, "Text": " You've got source statements that tell Syslog NG where to get its log information from."}, {"Time_Start": 2162.3, "Time_End": 2166.1400000000003, "Text": " This one on my site is actually kind of,"}, {"Time_Start": 2167.36, "Time_End": 2172.84, "Text": " fancy because I'm piping off a proc K message. What I'm doing is I'm doing"}, {"Time_Start": 2172.84, "Time_End": 2178.6400000000003, "Text": " an end run around K-log-D, which you really don't have to do. I mean, cis-log-n-G and K-log-D"}, {"Time_Start": 2178.6400000000003, "Time_End": 2182.9, "Text": " work just fine together. But if you want to kill K-log-D because it's an extra process"}, {"Time_Start": 2182.9, "Time_End": 2188.58, "Text": " and it offends you, you can do so with a statement just like that. You set up your sources,"}, {"Time_Start": 2188.58, "Time_End": 2194.6400000000003, "Text": " you set up filters, and that's where you specify your log facility and severity pairs"}, {"Time_Start": 2194.64, "Time_End": 2201.18, "Text": " and attach arbitrary text labels to them, F- underscore weirdness, F- underscore messages, whatever."}, {"Time_Start": 2202.74, "Time_End": 2208.0, "Text": " Destinations, places to write the logs, terminal consoles, files, programs."}, {"Time_Start": 2209.46, "Time_End": 2216.18, "Text": " I really should have put a UDP statement in there because you can set up a remote host as a log destination."}, {"Time_Start": 2216.7799999999997, "Time_End": 2221.3399999999997, "Text": " And then the payoff, the log statements, that's where you combine the other elements."}, {"Time_Start": 2221.3399999999997, "Time_End": 2224.62, "Text": " And so you can reference sources."}, {"Time_Start": 2224.64, "Time_End": 2228.22, "Text": " that you've set up above, filters that you've set up above, and destinations"}, {"Time_Start": 2228.22, "Time_End": 2234.04, "Text": " in whatever combinations trip your trigger. So that's Syslog NG, flexible, marvelous."}, {"Time_Start": 2234.8199999999997, "Time_End": 2243.7, "Text": " Another cool thing about Syslog NG, by the way, Syslog N.G supports logging over TCP 514. By default,"}, {"Time_Start": 2243.7, "Time_End": 2254.2, "Text": " cislog, plain old BSD syslog only uses UDP 514. That means that it's not as reliable, and it"}, {"Time_Start": 2254.2000000000003, "Time_End": 2261.4, "Text": " means that it's not so easy to tunnel. So that's a feature worth mentioning. What's the other"}, {"Time_Start": 2261.4, "Time_End": 2266.76, "Text": " thing I was going to say about it? Oh, I believe there's also a, Nicholas, what was that thing you"}, {"Time_Start": 2266.76, "Time_End": 2274.9600000000005, "Text": " were telling me before? A friend of mine was telling me about some kind of throttling. Is there"}, {"Time_Start": 2274.9600000000005, "Time_End": 2277.0400000000004, "Text": " some kind of throttling in Syslog Engino?"}, {"Time_Start": 2284.2000000000003, "Time_End": 2291.2000000000003, "Text": " I was too lazy to write this down, so..."}, {"Time_Start": 2291.2000000000003, "Time_End": 2299.2000000000003, "Text": " Yeah, you can have target every X minutes to tell you how many packets it lost and to"}, {"Time_Start": 2299.2000000000003, "Time_End": 2302.2000000000003, "Text": " I feel that it's still alive."}, {"Time_Start": 2302.2000000000003, "Time_End": 2312.2000000000003, "Text": " Thanks a lot. Okay, not actually throttling, but you can have it tell you statistics about how many packets it drops if, in fact, it does wind up having to drop packets."}, {"Time_Start": 2312.2000000000003, "Time_End": 2314.2000000000003, "Text": " That's something that SISLog won't do."}, {"Time_Start": 2314.2000000000003, "Time_End": 2319.1400000000003, "Text": " Syslog drops packets, you know, remote log packets, you never even know about it."}, {"Time_Start": 2320.76, "Time_End": 2321.1600000000003, "Text": " Okay."}, {"Time_Start": 2321.8, "Time_End": 2323.82, "Text": " I could go on and on about Syslog NG."}, {"Time_Start": 2324.6200000000003, "Time_End": 2327.5000000000005, "Text": " It's really groovy, and Bashi is such a sweet guy."}, {"Time_Start": 2327.86, "Time_End": 2332.0800000000004, "Text": " But I'm going to go on and talk about automated log watchers."}, {"Time_Start": 2333.6600000000003, "Time_End": 2335.7200000000003, "Text": " The payoff, as it were, of the technique."}, {"Time_Start": 2335.82, "Time_End": 2341.4, "Text": " Once you've figured out what to look for, you can configure some other application to look for it for you."}, {"Time_Start": 2342.5200000000004, "Time_End": 2344.1800000000003, "Text": " The one that I cover in..."}, {"Time_Start": 2344.2000000000003, "Time_End": 2350.6400000000003, "Text": " the log chapter in my book is S-Watch or S-Watch, the simple watcher. I don't know if I like"}, {"Time_Start": 2350.6400000000003, "Time_End": 2356.4800000000005, "Text": " swatch as much as I used to. For one thing, it hasn't been updated since like 2000. For another,"}, {"Time_Start": 2357.4, "Time_End": 2362.0000000000005, "Text": " being a Perl script, it's got a certain amount of overhead associated with it. Thank you."}, {"Time_Start": 2363.5800000000004, "Time_End": 2370.86, "Text": " And I was running it on this machine this morning. This thing is, I think, a Pentium-266. And I was really"}, {"Time_Start": 2370.86, "Time_End": 2374.1800000000003, "Text": " shocked by the CPU hit that I took from running..."}, {"Time_Start": 2374.2000000000003, "Time_End": 2382.5600000000004, "Text": " running SWatch. I'm not trying to dissuade anyone from examining Swatch because it's one of a fairly"}, {"Time_Start": 2382.5600000000004, "Time_End": 2389.2000000000003, "Text": " small number of tools that will watch a log file in real time, you know, that will basically"}, {"Time_Start": 2389.2000000000003, "Time_End": 2396.6000000000004, "Text": " tail a log file and watch it for specific strings. But what I do want you to do, what I do want"}, {"Time_Start": 2396.6000000000004, "Time_End": 2401.8, "Text": " you to know is that your mileage may vary. Don't go, don't throw swatch on a production system,"}, {"Time_Start": 2401.9600000000005, "Time_End": 2404.1800000000003, "Text": " configure it, and leave it running overnight."}, {"Time_Start": 2404.2000000000003, "Time_End": 2409.92, "Text": " hope for the best. Bench test it first and make sure that it doesn't have any deleterious"}, {"Time_Start": 2409.92, "Time_End": 2414.36, "Text": " effects on your system. I mean, you want to do that anyhow because it's got a really fussy"}, {"Time_Start": 2414.36, "Time_End": 2420.4, "Text": " configuration syntax. And I mean, if you just type some stuff and fire it up, it may or may not"}, {"Time_Start": 2420.4, "Time_End": 2429.5000000000005, "Text": " work the way you intended to. The good news is that the Linux distros each come with their"}, {"Time_Start": 2429.5000000000005, "Time_End": 2434.1800000000003, "Text": " own log watchers of various types. Red Hat now has got one called log watch. I'm totally"}, {"Time_Start": 2434.2000000000003, "Time_End": 2440.9600000000005, "Text": " that there's a different tool by the same name that's older. That one I don't know."}, {"Time_Start": 2441.5400000000004, "Time_End": 2447.36, "Text": " I have some familiarity with Red Hat's Logwatch. Logwatch is cool because unlike"}, {"Time_Start": 2447.36, "Time_End": 2455.0800000000004, "Text": " Swatch, it has its own brains. It has its own rules for things that constitute log weirdness."}, {"Time_Start": 2455.4800000000005, "Time_End": 2462.86, "Text": " And it's customizable, of course, as well. Log Digest is Sous's equivalent of that."}, {"Time_Start": 2464.2000000000003, "Time_End": 2468.5200000000004, "Text": " And it does not tail an active log file. It runs as a cron job."}, {"Time_Start": 2468.6600000000003, "Time_End": 2472.88, "Text": " In other words, it's a script that you run once in a while to parse your logs and report on any"}, {"Time_Start": 2472.88, "Time_End": 2479.4, "Text": " weirdness that it finds. It's not very well documented, but it's a really easy script to reverse"}, {"Time_Start": 2479.4, "Time_End": 2484.0800000000004, "Text": " engineer, even if you don't know Pearl. Or, I mean, even if, well, it's not in Pearl. Never"}, {"Time_Start": 2484.0800000000004, "Time_End": 2489.2400000000002, "Text": " mind. It's easy to reverse engineer. All of the configuration information is kept in"}, {"Time_Start": 2489.2400000000002, "Time_End": 2494.1800000000003, "Text": " an Etsy Log Digest. The interesting files there are ignored."}, {"Time_Start": 2494.2000000000003, "Time_End": 2498.2000000000003, "Text": " which is where you can specify strings that it should ignore if it sees."}, {"Time_Start": 2498.2000000000003, "Time_End": 2502.2000000000003, "Text": " And then the other one is, oh, let's see."}, {"Time_Start": 2502.2000000000003, "Time_End": 2504.2000000000003, "Text": " I'm spacing out what it's called."}, {"Time_Start": 2504.2000000000003, "Time_End": 2507.2000000000003, "Text": " Oh, wait, I wrote it down."}, {"Time_Start": 2507.2000000000003, "Time_End": 2511.2000000000003, "Text": " And I misplaced the notepad."}, {"Time_Start": 2511.2000000000003, "Time_End": 2513.2000000000003, "Text": " Alarming."}, {"Time_Start": 2513.2000000000003, "Time_End": 2527.8, "Text": " alarming. That's the name of the file. That's where you look for stuff that is alarming."}, {"Time_Start": 2527.8, "Time_End": 2530.6400000000003, "Text": " So if I cat that file."}, {"Time_Start": 2543.2000000000003, "Time_End": 2554.9600000000005, "Text": " Okay. This is where you can specify strings that you want Log Digest to look for."}, {"Time_Start": 2554.9600000000005, "Time_End": 2571.6400000000003, "Text": " Oh, cool. Okay, thanks. Yes, we'll haul out this way. Okay. So, now it's time to open the floor. So, now it's time to open the floor to beating up on this box."}, {"Time_Start": 2571.64, "Time_End": 2577.4, "Text": " I've got, oh, wow, there's some strange stuff in my log right now."}, {"Time_Start": 2579.64, "Time_End": 2587.8399999999997, "Text": " Holy cow. That's the most juicy invalid method request I've ever, ever seen. Can you see that on the bottom?"}, {"Time_Start": 2588.6, "Time_End": 2593.3599999999997, "Text": " Did anybody here perpetrate that? Because if they did, that's worth a prize."}, {"Time_Start": 2598.48, "Time_End": 2599.24, "Text": " Thank you, pardon."}, {"Time_Start": 2601.64, "Time_End": 2613.64, "Text": " Oh, really?"}, {"Time_Start": 2613.64, "Time_End": 2615.64, "Text": " I'm not entirely parsing you."}, {"Time_Start": 2615.64, "Time_End": 2617.64, "Text": " Something about the second layer."}, {"Time_Start": 2617.64, "Time_End": 2618.64, "Text": " Are you getting me?"}, {"Time_Start": 2618.64, "Time_End": 2619.64, "Text": " Are you doing it?"}, {"Time_Start": 2619.64, "Time_End": 2625.64, "Text": " I'm basically trying to flood you with misconfigure,"}, {"Time_Start": 2625.64, "Time_End": 2630.64, "Text": " with my formed layer 2 frames, in this case, using Fatajack Airjack."}, {"Time_Start": 2630.64, "Time_End": 2631.64, "Text": " Oh."}, {"Time_Start": 2631.64, "Time_End": 2638.9, "Text": " So I wonder if that can produce anything, and I also wondered if I can sneak under the login, in your case."}, {"Time_Start": 2639.02, "Time_End": 2642.5, "Text": " So I don't know, maybe just noise, maybe it's a rough noise which does it."}, {"Time_Start": 2643.4, "Time_End": 2645.1, "Text": " Yes, yes, layer two attacks."}, {"Time_Start": 2645.3399999999997, "Time_End": 2650.22, "Text": " Well, the gentleman said that what he's doing is he's sending me malformed packets."}, {"Time_Start": 2651.2999999999997, "Time_End": 2657.3399999999997, "Text": " And so he's wondering if it's maybe if it caused that message, maybe if it's sneaking under my radar."}, {"Time_Start": 2657.3399999999997, "Time_End": 2661.42, "Text": " And the answer to that is malformed packets and layer two attacks,"}, {"Time_Start": 2661.64, "Time_End": 2665.42, "Text": " constitute denial of service and I'm not going to give any prizes for that."}, {"Time_Start": 2671.18, "Time_End": 2678.98, "Text": " Well, okay, consolation prize, fine. The consolation prize is an S-Buzz, scuzzy interface"}, {"Time_Start": 2678.98, "Time_End": 2688.22, "Text": " with a black and, oh, no, a GX frame buffer. Hot damn. There. Are you happy now? Are you happy, kids?"}, {"Time_Start": 2689.9, "Time_End": 2691.62, "Text": " That's the only DOS attempt."}, {"Time_Start": 2691.64, "Time_End": 2694.64, "Text": " I'm going to give prizes for, though. I've got my morals."}, {"Time_Start": 2694.64, "Time_End": 2697.64, "Text": " Huh?"}, {"Time_Start": 2697.64, "Time_End": 2699.64, "Text": " Hmm?"}, {"Time_Start": 2699.64, "Time_End": 2704.64, "Text": " Oh, yeah, you could give them out. Sure, sure."}, {"Time_Start": 2704.64, "Time_End": 2706.64, "Text": " What else we got here?"}, {"Time_Start": 2709.64, "Time_End": 2713.64, "Text": " I've got some undersized frames received. I think that was the same thing."}, {"Time_Start": 2713.64, "Time_End": 2720.64, "Text": " 192-168 774. Oh, that's a broadcast. Okay, never mind that."}, {"Time_Start": 2721.64, "Time_End": 2742.94, "Text": " And in case you missed it, my victim host is located at 10.25.25.2 with a Class C subnet mask and an E-S-S-S-I-D of W-A-Z-A-Z-A-A-L-A."}, {"Time_Start": 2751.64, "Time_End": 2763.3399999999997, "Text": " Oh, oh, I see."}, {"Time_Start": 2767.3399999999997, "Time_End": 2771.2799999999997, "Text": " You're right. You're right. My terminal got corrupted somehow somehow."}, {"Time_Start": 2781.64, "Time_End": 2795.64, "Text": " Oh, okay, there we go. Thank you."}, {"Time_Start": 2795.64, "Time_End": 2800.04, "Text": " That hasn't happened to me, like, in three years. I totally missed that."}, {"Time_Start": 2802.94, "Time_End": 2803.44, "Text": " Okay."}, {"Time_Start": 2808.14, "Time_End": 2809.8799999999997, "Text": " Ooh. Okay. Oh, thank you. Thank you. Okay. Okay. Thank you."}, {"Time_Start": 2809.88, "Time_End": 2813.12, "Text": " Okay, who said that? Who's 25.69?"}, {"Time_Start": 2814.6400000000003, "Time_End": 2816.82, "Text": " Someone gets a prize for complimenting the kilt."}, {"Time_Start": 2817.82, "Time_End": 2824.3, "Text": " All right. Oh, yes. I know him. A prize over there. Raise your hand again, please, so the goon can spot you."}, {"Time_Start": 2826.8, "Time_End": 2828.3, "Text": " Right over here? Yeah, yeah."}, {"Time_Start": 2839.88, "Time_End": 2846.3, "Text": " How could you tell? How could you tell if it were broken? I'm not even sure what that is."}, {"Time_Start": 2847.12, "Time_End": 2848.6600000000003, "Text": " Is that a repeater of some kind?"}, {"Time_Start": 2851.84, "Time_End": 2857.9, "Text": " Ooh, cool. Prizes, by the way, we're donated by Uncle Iraa from Miko."}, {"Time_Start": 2858.7000000000003, "Time_End": 2866.32, "Text": " So buy stuff from Uncle Ira, a very cool guy. Okay, so what else here? These are all from 25 to 69. Is that all you, Tony?"}, {"Time_Start": 2869.88, "Time_End": 2876.04, "Text": " Oh, wait, there was something fairly involved."}, {"Time_Start": 2876.1600000000003, "Time_End": 2877.1400000000003, "Text": " Oh, yeah, that was Tony also."}, {"Time_Start": 2877.48, "Time_End": 2879.08, "Text": " Man, you were really going to town, man."}, {"Time_Start": 2879.62, "Time_End": 2880.42, "Text": " Did you root me?"}, {"Time_Start": 2883.62, "Time_End": 2884.62, "Text": " I've only got two minutes."}, {"Time_Start": 2884.6600000000003, "Time_End": 2886.46, "Text": " You've got two minutes left to gain a prize."}, {"Time_Start": 2886.62, "Time_End": 2887.26, "Text": " Come on, have added."}, {"Time_Start": 2887.34, "Time_End": 2888.36, "Text": " I got junk to give away here."}, {"Time_Start": 2891.62, "Time_End": 2892.02, "Text": " Okay."}, {"Time_Start": 2892.92, "Time_End": 2893.6800000000003, "Text": " Be that way."}, {"Time_Start": 2897.76, "Time_End": 2899.86, "Text": " So then, maybe I'll ask a"}, {"Time_Start": 2899.88, "Time_End": 2907.88, "Text": " trivia question. Okay. What is the list price of my book? No, that's lame. Never mind. I retract it."}, {"Time_Start": 2907.88, "Time_End": 2921.88, "Text": " Oh, wait. Yes, sir. 4495. Yes. Jay Beale gets a prize for answering the lamest trivia question at DefCon ever."}, {"Time_Start": 2929.88, "Time_End": 2940.1, "Text": " Jay, it does whatever you're elite enough to figure out it does. That's what it does."}, {"Time_Start": 2940.1, "Time_End": 2957.52, "Text": " Okay, who's got 25. Who's got 25. 79?"}, {"Time_Start": 2959.88, "Time_End": 2971.5, "Text": " Yes, we've got a lucky winner. All right. And I'm quite delighted to end my talk on that note. Thank you very much."}]}