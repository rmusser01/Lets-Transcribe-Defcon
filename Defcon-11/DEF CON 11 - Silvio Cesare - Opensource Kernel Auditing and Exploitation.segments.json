{"segments": [{"Time_Start": 0.0, "Time_End": 8.32, "Text": " Hello, I'm just going to test the mic and make sure that I have the right distance to the microphone here."}, {"Time_Start": 9.040000000000001, "Time_End": 17.64, "Text": " So a couple of days ago I presented at Black Hat this same presentation, so I'm going to give it to everyone here today at DefCon."}, {"Time_Start": 19.2, "Time_End": 22.82, "Text": " The first thing I said at Black Hat, I suppose, was I wanted to achieve two things,"}, {"Time_Start": 23.34, "Time_End": 28.5, "Text": " and one of those things was not freaking out on stage, and I hope I don't freak out on stage today."}, {"Time_Start": 28.5, "Time_End": 35.38, "Text": " And the second thing was to give people insight into where Colonel Security stands today"}, {"Time_Start": 35.38, "Time_End": 40.84, "Text": " and what sort of bugs are present, how many bugs are present, what forms of exploitation are available."}, {"Time_Start": 41.22, "Time_End": 45.18, "Text": " And that is what my presentation is on, Colonel Auditing and Exploitation."}, {"Time_Start": 46.82, "Time_End": 50.06, "Text": " So there are three parts in today's presentation."}, {"Time_Start": 51.879999999999995, "Time_End": 58.480000000000004, "Text": " At the end of each part, we'll stop for questions, but feel free to jump in with any."}, {"Time_Start": 58.5, "Time_End": 63.6, "Text": " questions if you want to. So the three parts are the auditing research that I"}, {"Time_Start": 63.6, "Time_End": 69.12, "Text": " performed, a sample of exploitable bugs, and exploitation on some of those bugs."}, {"Time_Start": 69.12, "Time_End": 76.92, "Text": " So part one is kernel auditing research. So last year for about three"}, {"Time_Start": 76.92, "Time_End": 83.7, "Text": " months between July and September 2002, I performed a manual audit of the"}, {"Time_Start": 83.7, "Time_End": 88.48, "Text": " various open source kernels and the OSs here were FreeBSD,"}, {"Time_Start": 88.5, "Time_End": 97.66, "Text": " NetBSD, OpenBSD analytics. This was a part-time audit, so I wasn't, you know, spending 24-7 or even, you know, eight hours a day or anything."}, {"Time_Start": 97.8, "Time_End": 104.14, "Text": " It's just spare time that I had available. I just audit some, audit various bits of kernel source."}, {"Time_Start": 105.98, "Time_End": 110.24000000000001, "Text": " So just to give a time frame of how much auditing was done on each kernel,"}, {"Time_Start": 110.78, "Time_End": 118.3, "Text": " NetBSD was about a little less than a week. Free BSD, a little less than a week also. Open BSD was a couple of days."}, {"Time_Start": 118.5, "Time_End": 120.66, "Text": " And Linux was the rest of my free time."}, {"Time_Start": 121.26, "Time_End": 124.32, "Text": " Why did I, you know, audit Linux so much?"}, {"Time_Start": 126.12, "Time_End": 128.62, "Text": " Probably just because, you know, I use Linux a lot."}, {"Time_Start": 129.26, "Time_End": 133.0, "Text": " I run it on this computer and, you know, most of my PCs."}, {"Time_Start": 133.3, "Time_End": 140.12, "Text": " So unfortunately, Linux was a little heavy-handed in my auditing because I do enjoy Linux."}, {"Time_Start": 141.56, "Time_End": 146.12, "Text": " So what prior work has been done on Colonel Auditing and so forth?"}, {"Time_Start": 146.58, "Time_End": 148.16, "Text": " There has been some prior work here."}, {"Time_Start": 148.5, "Time_End": 153.64, "Text": " Probably the best that I think that I've seen is Dawson Engler's research."}, {"Time_Start": 154.0, "Time_End": 158.84, "Text": " In the past couple of years, he has released a number of papers, some really great papers actually,"}, {"Time_Start": 159.38, "Time_End": 166.18, "Text": " where basically he wrote an automated bug discovery tool using a language called Metal,"}, {"Time_Start": 166.5, "Time_End": 167.64, "Text": " and he released some papers on this."}, {"Time_Start": 167.74, "Time_End": 174.2, "Text": " And to do this research, he applied this automated bug discovery on large sources,"}, {"Time_Start": 174.2, "Time_End": 177.6, "Text": " namely being the operating systems, kernels."}, {"Time_Start": 178.5, "Time_End": 185.62, "Text": " So NetBSD, actually OpenBSD, Linux and FreeBSD, he certainly performed automated bug discovery on."}, {"Time_Start": 186.88, "Time_End": 192.34, "Text": " And actually, he sent most of those bugs, I think, to the Linux kernel mailing list,"}, {"Time_Start": 193.24, "Time_End": 198.78, "Text": " and found a lot of concurrency and synchronization issues, such as double locks, double unlocks."}, {"Time_Start": 200.04, "Time_End": 204.36, "Text": " That seems to be, he also found a number of buffer overflows, and this was all automated."}, {"Time_Start": 205.02, "Time_End": 208.48, "Text": " But most of the bugs that were reported were concurrency."}, {"Time_Start": 208.5, "Time_End": 212.6, "Text": " in synchronization. The Linux kernel auditing project is an interesting one here."}, {"Time_Start": 213.1, "Time_End": 218.18, "Text": " There's a bit of a question mark at the end of, at the end of this line. And the reason for that"}, {"Time_Start": 218.18, "Time_End": 222.24, "Text": " is, I've never actually seen the Linux kernel auditing project do anything."}, {"Time_Start": 224.18, "Time_End": 229.72, "Text": " They've got a mailing list, but there's very few posts to it. I think they released about"}, {"Time_Start": 229.72, "Time_End": 234.88, "Text": " two advisories for some issues that were already known, and they never really, like in my"}, {"Time_Start": 234.88, "Time_End": 237.48, "Text": " opinion, they really didn't audit the Linux kernel."}, {"Time_Start": 238.5, "Time_End": 242.88, "Text": " about, you know, possibly, you know, let's order the Linux kernel, but I don't think they"}, {"Time_Start": 242.88, "Time_End": 246.74, "Text": " actually did because there are places in the kernel source where you just, you know, they have"}, {"Time_Start": 246.74, "Time_End": 251.46, "Text": " comments saying it's totally broken, please don't use. And these bits of code are"}, {"Time_Start": 251.46, "Time_End": 259.22, "Text": " totally exploitable. So just some notes for the rest of the presentation. When I'm talking about"}, {"Time_Start": 259.22, "Time_End": 264.74, "Text": " bugs, I'm always going to be talking about vulnerabilities. I just, vulnerabilities is a really"}, {"Time_Start": 264.74, "Time_End": 268.48, "Text": " long word. So, I, you know, I, you know, I, you know, I, you know, I, you know, I'm always going to be talking about vulnerabilities."}, {"Time_Start": 268.5, "Time_End": 272.5, "Text": " I'll just say bug, unless I stayed otherwise."}, {"Time_Start": 272.5, "Time_End": 278.5, "Text": " And just to sort of summarize what happened after the end of these three months of auditing,"}, {"Time_Start": 278.5, "Time_End": 288.5, "Text": " think in conjunction with the kernel developers and whatnot, at least 100, 150 bugs were patched,"}, {"Time_Start": 288.5, "Time_End": 290.5, "Text": " and pretty much all of these were exploitable."}, {"Time_Start": 290.5, "Time_End": 298.48, "Text": " So I'm just going to like, it might be there seems to be, you know, there seem to be a lot of bugs"}, {"Time_Start": 298.5, "Time_End": 303.66, "Text": " in the kernels from what I've seen. But not many people seem to be auditing them, or if they're"}, {"Time_Start": 303.66, "Time_End": 309.22, "Text": " auditing them, you know, mate, I don't know. So I believe that there are certain myths or, you know,"}, {"Time_Start": 309.26, "Time_End": 314.3, "Text": " a bit of mythology around kernel source. And one of the myths I'm talking about here is that,"}, {"Time_Start": 314.66, "Time_End": 318.28, "Text": " you know, maybe it's assumed by people that kernels are written by security experts and programming"}, {"Time_Start": 318.28, "Time_End": 324.48, "Text": " guides. And certainly, kernel developers, you know, some kernel developers are exceptionally talented"}, {"Time_Start": 324.48, "Time_End": 328.48, "Text": " and incredible, you know, incredible programmers. But, you know,"}, {"Time_Start": 328.5, "Time_End": 334.54, "Text": " like, there's a lot of kernel source here, a lot of developers get involved, yeah."}, {"Time_Start": 335.3, "Time_End": 341.62, "Text": " And so the follow-up to this myth is, you know, if the kernels are written by security experts and programming"}, {"Time_Start": 341.62, "Time_End": 344.82, "Text": " guides, you know, they really mustn't have, you know, any security bugs."}, {"Time_Start": 344.88, "Time_End": 347.84, "Text": " And if they have security bugs, they're not really simplistic."}, {"Time_Start": 349.12, "Time_End": 353.66, "Text": " And I suppose that leads on to the next myth is that, you know, it's just a rewriter the first one,"}, {"Time_Start": 353.66, "Time_End": 358.36, "Text": " is that, you know, kernels never have simplistic, you know, security bugs."}, {"Time_Start": 358.5, "Time_End": 361.88, "Text": " You know, therefore only security experts or programming gods can find them."}, {"Time_Start": 362.54, "Time_End": 370.46, "Text": " And I would disagree with this considerably, and I show evidence to, in contradiction to this,"}, {"Time_Start": 370.46, "Time_End": 374.92, "Text": " by showing, you know, simple bugs that are exploitable, and so forth."}, {"Time_Start": 376.0, "Time_End": 381.14, "Text": " I've got one more final myth that, again, a follow-up of the second one and the first one,"}, {"Time_Start": 381.38, "Time_End": 385.5, "Text": " that if Colonel Zarbuggy, you know, incredibly difficult to exploit, you know,"}, {"Time_Start": 385.5, "Time_End": 388.38, "Text": " and therefore, you know, probably exploitation."}, {"Time_Start": 388.5, "Time_End": 389.56, "Text": " is just theoretical."}, {"Time_Start": 391.32, "Time_End": 396.88, "Text": " You know, maybe you've heard that there are bugs, but they require, you know, something to be happening"}, {"Time_Start": 396.88, "Time_End": 401.72, "Text": " while something else is going on, and maybe, you know, the disc light is flashing a bit,"}, {"Time_Start": 401.72, "Time_End": 409.42, "Text": " or, you know, these types of, these are the myths that, you know, I hear and I see, and I try"}, {"Time_Start": 409.42, "Time_End": 412.46, "Text": " to show evidence to contradict this, because there are simple bugs, and they're colonel,"}, {"Time_Start": 412.58, "Time_End": 416.9, "Text": " simple bugs to exploit, there are simple mistakes that are obviously spotable."}, {"Time_Start": 418.5, "Time_End": 424.28, "Text": " So I make some conjectures for the auditing, that kernel code isn't special."}, {"Time_Start": 424.42, "Time_End": 425.58, "Text": " It's just another program."}, {"Time_Start": 425.7, "Time_End": 426.68, "Text": " It's a big program."}, {"Time_Start": 427.1, "Time_End": 430.68, "Text": " It's, you know, it's a big, big program, but it's just another program."}, {"Time_Start": 431.38, "Time_End": 436.36, "Text": " There's certainly a lot of bugs in New Zealand, so, you know, why not the kernel as well?"}, {"Time_Start": 438.26, "Time_End": 445.44, "Text": " And one of the reasons for this is that, I believe this, is that, you know, these kernels"}, {"Time_Start": 445.44, "Time_End": 448.48, "Text": " are written in the same language that, the language of sense."}, {"Time_Start": 448.5, "Time_End": 451.4, "Text": " that has had so many problems in the past with user land programs."}, {"Time_Start": 452.12, "Time_End": 455.94, "Text": " UserLand, you know, programs generally written in C, lots of bugs."}, {"Time_Start": 456.36, "Time_End": 458.48, "Text": " You know, why do people not think the kernel is the same?"}, {"Time_Start": 459.38, "Time_End": 464.76, "Text": " And certainly, you know, my conjection is that kernel programmers do make mistakes"}, {"Time_Start": 464.76, "Time_End": 466.3, "Text": " just like everyone else."}, {"Time_Start": 468.16, "Time_End": 472.5, "Text": " You know, if someone's, an average colonel, say, a couple million lines of code,"}, {"Time_Start": 472.92, "Time_End": 478.0, "Text": " you know, are we expecting that 1 million or 10 million lines of code is 100% bug-free,"}, {"Time_Start": 478.0, "Time_End": 480.6, "Text": " that a simple mistake hasn't occurred somewhere in this."}, {"Time_Start": 481.14, "Time_End": 483.94, "Text": " You know, it takes a long time just to look at, you know,"}, {"Time_Start": 484.02, "Time_End": 488.84, "Text": " five million lines of code, let alone, you know, audit, you know, every single line there."}, {"Time_Start": 490.88, "Time_End": 494.52, "Text": " So I started with a bit of a methodology for the auditing here."}, {"Time_Start": 494.8, "Time_End": 497.94, "Text": " I was only going to audit simple classes of bugs."}, {"Time_Start": 499.0, "Time_End": 502.84, "Text": " Not going to look, though, really complicated, you know, ways of attacking the kernel."}, {"Time_Start": 503.34, "Time_End": 507.76, "Text": " You know, if your disc light is flashing and, you know, maybe something is going on in the background."}, {"Time_Start": 508.0, "Time_End": 509.28, "Text": " and you're paging something."}, {"Time_Start": 509.4, "Time_End": 511.72, "Text": " Not going to go for any bugs like that."}, {"Time_Start": 511.98, "Time_End": 514.72, "Text": " Not going to go for any attacks on algorithms or so forth."}, {"Time_Start": 516.16, "Time_End": 518.56, "Text": " Just target really simple classes of bugs."}, {"Time_Start": 519.18, "Time_End": 524.98, "Text": " And one of the ways to do this was to audit using bottom-up techniques."}, {"Time_Start": 524.98, "Time_End": 533.44, "Text": " So basically, find places in the code that, if were buggy, could probably be exploitable."}, {"Time_Start": 534.0, "Time_End": 537.98, "Text": " And the way that I'd do this would be basically to grip for good."}, {"Time_Start": 538.0, "Time_End": 543.5, "Text": " places and from that look at the code around it and if that code is buggy it's"}, {"Time_Start": 543.5, "Time_End": 549.4, "Text": " probably exploitable. So looking for good entry points into the kernel. Now"}, {"Time_Start": 549.4, "Time_End": 555.4, "Text": " kernel to user space copies and user space to kernel copies, buffer copies, a very"}, {"Time_Start": 555.4, "Time_End": 563.18, "Text": " good place to look. If these bits are code of buggy, then certainly, you know, buffer"}, {"Time_Start": 563.18, "Time_End": 567.98, "Text": " overflows and other problems are likely, you know, to be exploitable here."}, {"Time_Start": 568.0, "Time_End": 573.74, "Text": " As the auditing continued over the period of months,"}, {"Time_Start": 574.48, "Time_End": 578.84, "Text": " certainly I got more experience in what sort of things I should be looking for"}, {"Time_Start": 578.84, "Time_End": 583.98, "Text": " and the number of classes of bugs and exploit classes certainly increased."}, {"Time_Start": 585.3, "Time_End": 588.5, "Text": " So, for example, here, system calls the simple entry points."}, {"Time_Start": 590.2, "Time_End": 594.02, "Text": " If you look, you know, from going to use the land to kernel land"}, {"Time_Start": 594.02, "Time_End": 596.0, "Text": " and exploiting the kernel,"}, {"Time_Start": 596.0, "Time_End": 601.0, "Text": " system calls under the control of use of land, maybe they're exploitable."}, {"Time_Start": 602.12, "Time_End": 606.72, "Text": " I think, though, that a lot of people, from what I've heard, if they've gone to order the kernel,"}, {"Time_Start": 606.8, "Time_End": 610.18, "Text": " they look at system calls and they think, okay, let's go for the core system calls."}, {"Time_Start": 610.28, "Time_End": 611.12, "Text": " Maybe there's a buck there."}, {"Time_Start": 611.56, "Time_End": 617.8, "Text": " But there's in fact, you know, a lot of other places also that you can audit, such as the device drivers."}, {"Time_Start": 617.96, "Time_End": 623.36, "Text": " These, again, have simple entry points, primarily for the fact that in Unix, everything,"}, {"Time_Start": 623.36, "Time_End": 625.98, "Text": " you know, really the idea was that everything is that everything is."}, {"Time_Start": 626.0, "Time_End": 630.86, "Text": " should be considered a file. So you can access a lot of code, a lot of kernel code,"}, {"Time_Start": 631.12, "Time_End": 639.74, "Text": " through these device drivers. IOCTLs seem to do everything. They're so generic. They basically"}, {"Time_Start": 639.74, "Time_End": 646.4, "Text": " can do anything and everything that you want and probably more. They increase the attack vector space"}, {"Time_Start": 646.4, "Time_End": 653.42, "Text": " massively. And it's argued that, you know, that for Unix, everything is a file. What's the point of"}, {"Time_Start": 653.42, "Time_End": 658.5799999999999, "Text": " IACTLs for this. IACTLs break the design of Unix to say that everything is a file"}, {"Time_Start": 658.5799999999999, "Time_End": 664.9799999999999, "Text": " by introducing a system call that does everything at this point. So some of the Unix designers"}, {"Time_Start": 664.9799999999999, "Time_End": 670.5999999999999, "Text": " argue that that was a bit of the downfall of Unix at that point. I don't think so, but it's certainly"}, {"Time_Start": 670.5999999999999, "Time_End": 675.78, "Text": " interesting. So there were some immediate results in the auditing here. The first bug was found within"}, {"Time_Start": 675.78, "Time_End": 683.4, "Text": " hours, and this was true for all systems audited. And it's arguable that the first bug in a non-familiar"}, {"Time_Start": 683.42, "Time_End": 688.78, "Text": " software is, you know, it's arguably the hardest to find. Once you start to have, you know,"}, {"Time_Start": 689.26, "Time_End": 693.8199999999999, "Text": " places to look for and ideas of what types of bugs are present, it's typically considered"}, {"Time_Start": 693.8199999999999, "Time_End": 701.3399999999999, "Text": " easier to find more bugs. So a couple of observations here. There does seem to be evidence"}, {"Time_Start": 701.3399999999999, "Time_End": 707.14, "Text": " of varying degrees of code quality and hence security bugs. The core kernel code in all the systems"}, {"Time_Start": 707.14, "Time_End": 713.14, "Text": " audited was pretty good. Not so many problems there. There were a couple, but, you know,"}, {"Time_Start": 713.14, "Time_End": 719.38, "Text": " ultimately it seemed to be a lot more bug-free than, say, for example, device drivers,"}, {"Time_Start": 719.48, "Time_End": 726.18, "Text": " which pretty much anyone can write, make a submission for all the OSs here. So they did, in my"}, {"Time_Start": 726.18, "Time_End": 731.34, "Text": " opinion, seem to contain a large number of bugs. And I also make the comment that bug tends to"}, {"Time_Start": 731.34, "Time_End": 736.46, "Text": " exhibit sides of propagation and clustering. So what I mean by this is that, say, for example,"}, {"Time_Start": 736.62, "Time_End": 742.02, "Text": " you have a device driver, and this device driver, this code for this device driver, becomes the"}, {"Time_Start": 742.02, "Time_End": 747.5, "Text": " reference implementation. And this reference implementation has a bug in it. And now"}, {"Time_Start": 747.5, "Time_End": 754.04, "Text": " everyone, when they go to write their device driver, copies the buggy reference implementation and thus"}, {"Time_Start": 754.04, "Time_End": 760.1, "Text": " the bug propagates with the security problems associated with it. The clustering observation"}, {"Time_Start": 760.1, "Time_End": 767.16, "Text": " is also that of once you find a bug in a particular bit of source, you're probably more likely"}, {"Time_Start": 767.16, "Time_End": 771.66, "Text": " to find bugs nearby as well. So if you start to find bugs in, you know, uh, you start to find bugs in"}, {"Time_Start": 771.66, "Time_End": 777.5799999999999, "Text": " say the video for Linux drivers, maybe there are more bugs in other video for Linux drivers,"}, {"Time_Start": 777.6999999999999, "Time_End": 782.56, "Text": " maybe in the file system code, look around, probably more bugs around that area as well."}, {"Time_Start": 783.16, "Time_End": 788.4399999999999, "Text": " And there are identical bugs across all platforms. And I'll show some examples of this. I've got"}, {"Time_Start": 788.4399999999999, "Time_End": 794.7199999999999, "Text": " like the asterix and the bracketed two stuff, just in reference to some slides coming up."}, {"Time_Start": 795.9399999999999, "Time_End": 801.64, "Text": " But just before I get into that, just a bit of research bias. Manual auditing is, you"}, {"Time_Start": 801.66, "Time_End": 803.02, "Text": " you know, it's inherently biased."}, {"Time_Start": 804.2199999999999, "Time_End": 810.4, "Text": " Certainly, I can't argue, you know, definitively that, you know, these observations are, you know,"}, {"Time_Start": 810.42, "Time_End": 814.98, "Text": " scientifically correct because my auditing, you know, is inherently biased."}, {"Time_Start": 815.52, "Time_End": 820.56, "Text": " Maybe I believe that core kernel code is more secure, hence I'm not finding bugs in that."}, {"Time_Start": 820.92, "Time_End": 824.5799999999999, "Text": " It's hard to, it's hard to argue through scientific means."}, {"Time_Start": 824.88, "Time_End": 831.56, "Text": " However, Dawson Engler's work with the automated bug discovery is less biased, since it is not done by"}, {"Time_Start": 831.66, "Time_End": 837.9599999999999, "Text": " and it is done by an automated process which can be, you know, repeated time and time again and so forth."}, {"Time_Start": 839.86, "Time_End": 846.06, "Text": " So just some code in reference to having the same bugs across a number of platforms."}, {"Time_Start": 846.52, "Time_End": 848.48, "Text": " We have here NetBSD and OpenBSD."}, {"Time_Start": 849.3199999999999, "Time_End": 851.5799999999999, "Text": " This was a couple of old versions ago."}, {"Time_Start": 852.38, "Time_End": 857.72, "Text": " And it's a bad example to show to start off, and I should have changed this slide, but"}, {"Time_Start": 857.72, "Time_End": 861.64, "Text": " because you can't see the exact part."}, {"Time_Start": 861.66, "Time_End": 864.76, "Text": " where it's exploitable, you can just see part of the bug here."}, {"Time_Start": 865.26, "Time_End": 870.0799999999999, "Text": " So I've highlighted, I don't think anyone can see this because I can't even see this from here."}, {"Time_Start": 871.8, "Time_End": 877.24, "Text": " So basically, it's in the I386 set LDT code."}, {"Time_Start": 877.4599999999999, "Time_End": 882.28, "Text": " We're adding two numbers together, start plus numb and checking if it's greater than another."}, {"Time_Start": 882.68, "Time_End": 885.1999999999999, "Text": " And this is input validation checks."}, {"Time_Start": 885.6999999999999, "Time_End": 890.5, "Text": " However, the problem is that when we add these two numbers together, we can get a sign wraparound,"}, {"Time_Start": 890.5, "Time_End": 896.18, "Text": " end with a negative number, pass this input validation check, and then a couple of lines afterwards"}, {"Time_Start": 896.18, "Time_End": 902.72, "Text": " we have a buffer copy which now uses the failed input validation check."}, {"Time_Start": 904.42, "Time_End": 910.84, "Text": " These have been fixed since, so they shouldn't be current in any systems."}, {"Time_Start": 912.36, "Time_End": 918.22, "Text": " So just to show some evidence in contradiction to the myths that I presented earlier is that, you know,"}, {"Time_Start": 918.3, "Time_End": 919.9, "Text": " kernels aren't written by guides."}, {"Time_Start": 920.5, "Time_End": 926.46, "Text": " you know, very talented, but not in the godly, you know, manner that the myth holds them to."}, {"Time_Start": 927.78, "Time_End": 932.06, "Text": " So the initial bugs were found in all hours, and bugs were found in large quantities."}, {"Time_Start": 932.48, "Time_End": 934.58, "Text": " 10 to 30 per day wasn't really uncommon."}, {"Time_Start": 935.98, "Time_End": 938.6, "Text": " You know, in various places of the source, lots of bugs are present."}, {"Time_Start": 939.9, "Time_End": 943.58, "Text": " And it was assumed and SATA that code was secure when, in fact, it wasn't."}, {"Time_Start": 943.66, "Time_End": 946.54, "Text": " This is actually pretty funny, to be honest."}, {"Time_Start": 947.22, "Time_End": 949.02, "Text": " So this is in Linux 21418."}, {"Time_Start": 950.5, "Time_End": 955.1, "Text": " And this is in the video for Linux code, I think, one of the drivers for that."}, {"Time_Start": 955.46, "Time_End": 961.1, "Text": " So the comment is that, okay, first things first, make sure we don't copy more than we have,"}, {"Time_Start": 961.4, "Time_End": 963.0, "Text": " even if the application wants more."}, {"Time_Start": 963.56, "Time_End": 967.08, "Text": " That would be a big security embarrassment with an exclamation mark at the end."}, {"Time_Start": 967.28, "Time_End": 972.38, "Text": " The very next line, the exact next line of this comment, is an integer overflow."}, {"Time_Start": 974.2, "Time_End": 980.44, "Text": " Okay, so about two lines below that is a buffer overflow as a result."}, {"Time_Start": 980.5, "Time_End": 985.34, "Text": " the integer overflow. So it's a very interesting comment, certainly."}, {"Time_Start": 986.46, "Time_End": 990.2, "Text": " There is another interesting comment, and there's a few interesting comments in the code,"}, {"Time_Start": 990.58, "Time_End": 996.9, "Text": " and I'll show some more and a bit later on. But for this comment, it has, this routine does error"}, {"Time_Start": 996.9, "Time_End": 1002.96, "Text": " checking to make sure that all memory accesses are within bounds. And then what we have,"}, {"Time_Start": 1003.02, "Time_End": 1009.9, "Text": " we have multiple problems in this code. We have an sign problem. We pass in a sign problem. We pass in a"}, {"Time_Start": 1009.9, "Time_End": 1014.34, "Text": " sign integer and do a comparison, but we don't check for the case when it's less than zero."}, {"Time_Start": 1014.64, "Time_End": 1021.3, "Text": " We also have an integer overflow, even if we got this sign problem fix, we would have an integer overflow"}, {"Time_Start": 1021.3, "Time_End": 1028.62, "Text": " in the lines below. And then we have a buffer overflow after all of that. So, you know, they're"}, {"Time_Start": 1028.62, "Time_End": 1034.0, "Text": " pretty funny comments. I don't know. Maybe it's just my bad sense of humor. So some more"}, {"Time_Start": 1034.0, "Time_End": 1038.3, "Text": " evidence in contradiction to kernel mythology. Colons really do have simplistic bugs."}, {"Time_Start": 1039.9, "Time_End": 1044.3000000000002, "Text": " You know, I really didn't do any intensive code tracking for this audit."}, {"Time_Start": 1044.5, "Time_End": 1047.6000000000001, "Text": " I really, you know, scrapping for simple places,"}, {"Time_Start": 1049.16, "Time_End": 1053.52, "Text": " gripping for good places to look, and then from there looking at code immediately above it."}, {"Time_Start": 1053.88, "Time_End": 1056.48, "Text": " I didn't really, you know, I wasn't starting at the, you know,"}, {"Time_Start": 1056.7800000000002, "Time_End": 1059.96, "Text": " init.c or, you know, wherever here."}, {"Time_Start": 1060.0600000000002, "Time_End": 1063.66, "Text": " I didn't start at the boot sector and follow it all the way to what happens when you,"}, {"Time_Start": 1064.5800000000002, "Time_End": 1069.7800000000002, "Text": " you know, for, just find simple places to audit and look at the immediate"}, {"Time_Start": 1069.78, "Time_End": 1076.5, "Text": " a code around it. And certainly, in some cases, there was simply just no input validation"}, {"Time_Start": 1076.5, "Time_End": 1083.52, "Text": " at all. Also, inline documentation shows that, you know, code is not working. I should have"}, {"Time_Start": 1083.52, "Time_End": 1092.86, "Text": " some examples here. So we have this bit of code, IBCS2 underscore stat.c. And this is in all systems,"}, {"Time_Start": 1092.86, "Time_End": 1099.08, "Text": " actually, OpenBSD, NetBSD, FreeBSD, and Linux. The bug was shared across all platforms."}, {"Time_Start": 1099.78, "Time_End": 1103.3999999999999, "Text": " FreeBSD have not fixed this. I don't know why."}, {"Time_Start": 1104.8999999999999, "Time_End": 1109.28, "Text": " So basically, we pass in a length to a CISCore."}, {"Time_Start": 1110.1399999999999, "Time_End": 1111.72, "Text": " The length is just never validated."}, {"Time_Start": 1112.2, "Time_End": 1117.74, "Text": " We do a, we copy a buffer using this length, and there's no, you can put a length of anything."}, {"Time_Start": 1117.8999999999999, "Time_End": 1120.08, "Text": " You can, any length you want, and it will copy that."}, {"Time_Start": 1120.66, "Time_End": 1122.94, "Text": " So, you know, no input validation at all."}, {"Time_Start": 1124.52, "Time_End": 1128.48, "Text": " Here is another another no input validation bug."}, {"Time_Start": 1128.48, "Time_End": 1132.48, "Text": " This one is copying from kernel space to user space."}, {"Time_Start": 1133.2, "Time_End": 1136.26, "Text": " So this will give us kernel memory disclosure."}, {"Time_Start": 1136.94, "Time_End": 1140.14, "Text": " And again, it's from a VGA driver here."}, {"Time_Start": 1140.92, "Time_End": 1145.68, "Text": " So a video driver of some kind, it looks like to be NetBSC, I think."}, {"Time_Start": 1146.32, "Time_End": 1148.46, "Text": " So we're going to call an IACTL."}, {"Time_Start": 1149.54, "Time_End": 1152.24, "Text": " And then we can pass in account of whatever we want."}, {"Time_Start": 1152.34, "Time_End": 1156.4, "Text": " We just pass in a length, and we'll just copy this back to user space."}, {"Time_Start": 1158.48, "Time_End": 1160.7, "Text": " Okay, here's another bit of code."}, {"Time_Start": 1161.2, "Time_End": 1164.98, "Text": " This one is in Linux, and this one is still present in Linux."}, {"Time_Start": 1165.5, "Time_End": 1169.58, "Text": " I released this and an exploit for it a couple of months ago, at RuxCon."}, {"Time_Start": 1170.6, "Time_End": 1175.6200000000001, "Text": " And it doesn't seem that it hasn't been fixed, so I'm not quite sure what the story is there."}, {"Time_Start": 1176.02, "Time_End": 1181.9, "Text": " So we have a comment, and this is in the Coff binary loader, has a comment saying,"}, {"Time_Start": 1181.98, "Time_End": 1183.84, "Text": " XX, X, X, X, untested."}, {"Time_Start": 1184.44, "Time_End": 1188.46, "Text": " And, like, I can really guarantee that it's never been tested, because if any way,"}, {"Time_Start": 1188.48, "Time_End": 1190.52, "Text": " one used this, it would kernel panic immediately."}, {"Time_Start": 1191.96, "Time_End": 1194.96, "Text": " It's, it has, it's using the wrong arguments completely."}, {"Time_Start": 1195.2, "Time_End": 1197.04, "Text": " It's, there's no possible way it can work."}, {"Time_Start": 1197.9, "Time_End": 1201.64, "Text": " But in this case, it turns out to be, you know, it's exploitable, and we can"}, {"Time_Start": 1201.64, "Time_End": 1207.16, "Text": " escalate privileges and get a root shell by running a custom cough binary."}, {"Time_Start": 1208.88, "Time_End": 1214.0, "Text": " So some more evidence in contradiction to Colonel mythology."}, {"Time_Start": 1215.04, "Time_End": 1218.46, "Text": " Colonel, if they're buggy, are not always difficult to exploit."}, {"Time_Start": 1218.48, "Time_End": 1221.32, "Text": " To exploit 100% reliably,"}, {"Time_Start": 1223.24, "Time_End": 1229.18, "Text": " PROCFS in Linux to perform memory disclosure is 38 lines."}, {"Time_Start": 1229.78, "Time_End": 1235.3600000000001, "Text": " For FreeBSC, the Accept System Call advisory that was released last year,"}, {"Time_Start": 1235.8, "Time_End": 1237.42, "Text": " 37 lines of C."}, {"Time_Start": 1239.3600000000001, "Time_End": 1243.66, "Text": " FreeBSE and Linux, the developers of respective developers,"}, {"Time_Start": 1244.66, "Time_End": 1247.88, "Text": " both have exploits for these, by the way."}, {"Time_Start": 1248.48, "Time_End": 1251.98, "Text": " I did send the exploits that were written to them."}, {"Time_Start": 1253.76, "Time_End": 1258.14, "Text": " Also, an interesting thing, a stack overflow in Linux requires no offsets."}, {"Time_Start": 1259.94, "Time_End": 1261.6, "Text": " It's very, very reliable."}, {"Time_Start": 1261.76, "Time_End": 1267.14, "Text": " It assumes correctly that addresses, that return addresses on the stack and word align."}, {"Time_Start": 1267.14, "Time_End": 1271.44, "Text": " That's the only assumption it really makes to perform stack overflow in Linux."}, {"Time_Start": 1272.0, "Time_End": 1276.4, "Text": " And in GCC, it will always align return addresses."}, {"Time_Start": 1276.94, "Time_End": 1278.46, "Text": " Actually, when I presented this at Blackhouse,"}, {"Time_Start": 1278.48, "Time_End": 1279.94, "Text": " a couple days ago."}, {"Time_Start": 1281.06, "Time_End": 1283.64, "Text": " I was saying that, I said exactly the same thing,"}, {"Time_Start": 1283.7, "Time_End": 1285.1200000000001, "Text": " but I didn't want to make, you know,"}, {"Time_Start": 1285.16, "Time_End": 1288.8, "Text": " I didn't want to say 100% certain always will be aligned."}, {"Time_Start": 1289.1200000000001, "Time_End": 1291.74, "Text": " So I said, you know, GCC should, you know,"}, {"Time_Start": 1291.76, "Time_End": 1294.8, "Text": " I'm pretty sure of that, but some guy did come up to me"}, {"Time_Start": 1294.8, "Time_End": 1297.28, "Text": " after the presentation and said, yes, I can, you know,"}, {"Time_Start": 1297.32, "Time_End": 1302.24, "Text": " it's definitely 100% true that GCC will never have anything"}, {"Time_Start": 1302.24, "Time_End": 1303.22, "Text": " that isn't word aligned."}, {"Time_Start": 1304.14, "Time_End": 1306.78, "Text": " So it's just a bit of a bit of a note there."}, {"Time_Start": 1306.78, "Time_End": 1309.98, "Text": " So, you know, what attack vectors are present."}, {"Time_Start": 1311.1, "Time_End": 1313.82, "Text": " You know, at the result of, you know, auditing all this code"}, {"Time_Start": 1313.82, "Time_End": 1315.8999999999999, "Text": " and finding, you know, bugs and exploits,"}, {"Time_Start": 1315.96, "Time_End": 1319.92, "Text": " it does seem clear that the more code there is"}, {"Time_Start": 1319.92, "Time_End": 1322.98, "Text": " that's running, the more vulnerability is likely to be present,"}, {"Time_Start": 1323.36, "Time_End": 1326.6399999999999, "Text": " which is pretty, which is a pretty casual observation there."}, {"Time_Start": 1327.82, "Time_End": 1330.28, "Text": " But the follow-up to that is don't run these kernels"}, {"Time_Start": 1330.28, "Time_End": 1332.58, "Text": " that have everything compiled into them under the sun."}, {"Time_Start": 1333.0, "Time_End": 1335.66, "Text": " You know, don't have support for hardware that you don't use."}, {"Time_Start": 1335.66, "Time_End": 1339.02, "Text": " don't have a million device drivers just running"}, {"Time_Start": 1339.02, "Time_End": 1344.4, "Text": " because all of these increase the attack space that you leave open."}, {"Time_Start": 1345.24, "Time_End": 1348.92, "Text": " So, you know, definitely you can mitigate some risks there"}, {"Time_Start": 1348.92, "Time_End": 1351.7, "Text": " if you just compile smaller kernels"}, {"Time_Start": 1351.7, "Time_End": 1356.38, "Text": " and, you know, don't have so much support there for things that you don't use."}, {"Time_Start": 1357.0400000000002, "Time_End": 1360.8200000000002, "Text": " So entry points into the kernel that use"}, {"Time_Start": 1360.8200000000002, "Time_End": 1363.96, "Text": " are certainly the vectors of exploitation here"}, {"Time_Start": 1363.96, "Time_End": 1367.24, "Text": " and device driver's system calls, file systems."}, {"Time_Start": 1367.3400000000001, "Time_End": 1368.28, "Text": " File systems are interesting."}, {"Time_Start": 1369.58, "Time_End": 1377.26, "Text": " Low code in Linux, ProcFS, in most of all of 2.2 and most of 2.4."}, {"Time_Start": 1377.76, "Time_End": 1380.6200000000001, "Text": " I think there's some in the 2.6 tests at the moment,"}, {"Time_Start": 1381.68, "Time_End": 1384.64, "Text": " and certainly in most of the 2.5s as well."}, {"Time_Start": 1385.42, "Time_End": 1389.1000000000001, "Text": " You can do things like LSEC, if you can open a file in the ProcFS,"}, {"Time_Start": 1389.82, "Time_End": 1393.3600000000001, "Text": " and it's readable by world, you know, readable by everyone."}, {"Time_Start": 1393.96, "Time_End": 1400.2, "Text": " open it, you seek to around 4 gig, on 32-bit platforms, seek to around 4 gig, and then"}, {"Time_Start": 1400.2, "Time_End": 1405.3, "Text": " if you read something that you might be able to cause an integer overflow for around 4 gig plus"}, {"Time_Start": 1405.3, "Time_End": 1410.02, "Text": " what you read, get an integer overflow, and then you can have things like memory disclosure."}, {"Time_Start": 1413.58, "Time_End": 1418.22, "Text": " Also, just to make one more comment on that last slide, is that the core kernel code again is"}, {"Time_Start": 1418.22, "Time_End": 1419.8600000000001, "Text": " pretty good, like in most kernels."}, {"Time_Start": 1420.42, "Time_End": 1423.46, "Text": " Not, you know, a couple of bugs there, but you're nothing, nothing."}, {"Time_Start": 1423.96, "Time_End": 1425.4, "Text": " Nothing major there."}, {"Time_Start": 1426.24, "Time_End": 1430.08, "Text": " So I think someone read the slide there with Theodore Ratt"}, {"Time_Start": 1430.08, "Time_End": 1431.08, "Text": " response in three minutes."}, {"Time_Start": 1432.2, "Time_End": 1433.4, "Text": " He just heard a bit of laughter."}, {"Time_Start": 1434.2, "Time_End": 1438.1000000000001, "Text": " So the vendor response actually was really strong."}, {"Time_Start": 1438.82, "Time_End": 1444.0, "Text": " Contacted everyone, and everyone responded, you know, extremely well."}, {"Time_Start": 1444.16, "Time_End": 1447.72, "Text": " Theodot, sent an email, turned around,"}, {"Time_Start": 1447.96, "Time_End": 1450.0, "Text": " having a conversation with someone, turned back,"}, {"Time_Start": 1450.26, "Time_End": 1453.1200000000001, "Text": " under three minutes got a response about, you know,"}, {"Time_Start": 1453.2, "Time_End": 1453.94, "Text": " sent a list of 10."}, {"Time_Start": 1453.96, "Time_End": 1457.56, "Text": " to 15 bugs and in three minutes got a response on these."}, {"Time_Start": 1458.24, "Time_End": 1460.5, "Text": " So I think that's, I think that's not bad."}, {"Time_Start": 1462.1000000000001, "Time_End": 1464.16, "Text": " Alan Cox was pretty good."}, {"Time_Start": 1465.04, "Time_End": 1468.1200000000001, "Text": " This was, he was the first person that I sent"}, {"Time_Start": 1468.1200000000001, "Time_End": 1471.1200000000001, "Text": " bug reports and vulnerabilities to."}, {"Time_Start": 1472.72, "Time_End": 1476.38, "Text": " Sent him a list of bugs for, I think, 2.2.16 at the time."}, {"Time_Start": 1476.8, "Time_End": 1479.04, "Text": " And this was like 2.4."}, {"Time_Start": 1479.04, "Time_End": 1482.7, "Text": " Something was current at the, you know, it wasn't even the latest 2.2 version."}, {"Time_Start": 1482.7, "Time_End": 1486.78, "Text": " some old, you know, Linux kernel that, you know, no one was really using."}, {"Time_Start": 1487.42, "Time_End": 1490.5800000000002, "Text": " And in about three hours, you know, three hours, a couple hours,"}, {"Time_Start": 1491.0, "Time_End": 1495.6000000000001, "Text": " he sent back a list, he sent back information on all of the bugs that I had reported."}, {"Time_Start": 1496.14, "Time_End": 1500.88, "Text": " Some of the bugs he said, oh, yeah, we fixed that in later 2.2 or, you know, or in 2.4."}, {"Time_Start": 1500.88, "Time_End": 1505.76, "Text": " For some, he could, he could actually, like, name the people that had fixed bugs from, you know,"}, {"Time_Start": 1505.8, "Time_End": 1511.8, "Text": " one to two years earlier, saying that Solid Designer had fixed various bugs,"}, {"Time_Start": 1512.7, "Time_End": 1519.6000000000001, "Text": " Things, for example, such as the get SOCOP, set SOCOP, sign problems from most of 2.2."}, {"Time_Start": 1521.04, "Time_End": 1522.92, "Text": " So that was pretty impressive, I thought."}, {"Time_Start": 1525.6000000000001, "Time_End": 1531.16, "Text": " So, you know, just before I get, you know, too much, you know, into this, I am a little biased myself."}, {"Time_Start": 1532.46, "Time_End": 1534.52, "Text": " I still believe in open source software."}, {"Time_Start": 1535.32, "Time_End": 1542.26, "Text": " So, you know, even though I think the responses that I received were exceptional,"}, {"Time_Start": 1542.7, "Time_End": 1544.56, "Text": " you know, it's a little bias there."}, {"Time_Start": 1544.92, "Time_End": 1549.3400000000001, "Text": " But, you know, maybe that's, maybe the reason why open source response was so good"}, {"Time_Start": 1549.3400000000001, "Time_End": 1551.72, "Text": " was that they didn't have a marketing department."}, {"Time_Start": 1552.1000000000001, "Time_End": 1556.0800000000002, "Text": " I emailed developers directly, people that actually code on these kernels."}, {"Time_Start": 1556.64, "Time_End": 1560.64, "Text": " So maybe the only thing that could argue was source at that point."}, {"Time_Start": 1561.1000000000001, "Time_End": 1561.8400000000001, "Text": " You know, I don't know."}, {"Time_Start": 1563.1200000000001, "Time_End": 1564.16, "Text": " So a bit more bias."}, {"Time_Start": 1564.16, "Time_End": 1568.52, "Text": " I don't think, I don't know if anyone can see this, but, so a bit of a grip for the,"}, {"Time_Start": 1570.1200000000001, "Time_End": 1572.68, "Text": " bit of grep for hack, the number of, the number of"}, {"Time_Start": 1572.7, "Time_End": 1578.38, "Text": " references of the word hack in the 2.419 Linux kernel credits, 106 times."}, {"Time_Start": 1578.54, "Time_End": 1579.5, "Text": " So, I don't know."}, {"Time_Start": 1580.06, "Time_End": 1582.0800000000002, "Text": " You know, I have a really bad joke."}, {"Time_Start": 1582.6000000000001, "Time_End": 1583.64, "Text": " Okay, it's a bad joke."}, {"Time_Start": 1583.74, "Time_End": 1584.74, "Text": " I gave it a blackout."}, {"Time_Start": 1584.76, "Time_End": 1585.28, "Text": " No one laughed."}, {"Time_Start": 1585.8, "Time_End": 1588.02, "Text": " It's like, you know, a lot of hacks in the Linux kernel."}, {"Time_Start": 1588.28, "Time_End": 1588.72, "Text": " I don't know."}, {"Time_Start": 1589.8, "Time_End": 1590.82, "Text": " No one laughed here again."}, {"Time_Start": 1594.3400000000001, "Time_End": 1596.78, "Text": " I know, comedy, not my strong thing here."}, {"Time_Start": 1598.38, "Time_End": 1601.9, "Text": " So just to talk about Linux here, a bit more about,"}, {"Time_Start": 1602.7, "Time_End": 1603.8400000000001, "Text": " each vendor's response."}, {"Time_Start": 1604.8600000000001, "Time_End": 1606.98, "Text": " Alan Cox, the first person I contacted,"}, {"Time_Start": 1607.18, "Time_End": 1608.8400000000001, "Text": " he remained personally involved and responsible"}, {"Time_Start": 1608.8400000000001, "Time_End": 1609.8600000000001, "Text": " for the entire duration."}, {"Time_Start": 1611.0800000000002, "Time_End": 1612.72, "Text": " Sent tons and tons of bugs."}, {"Time_Start": 1612.92, "Time_End": 1616.1000000000001, "Text": " And he fixed the majority of software,"}, {"Time_Start": 1616.52, "Time_End": 1617.7, "Text": " patched a lot of things."}, {"Time_Start": 1619.04, "Time_End": 1621.56, "Text": " Often attributed me in the credits,"}, {"Time_Start": 1622.6200000000001, "Time_End": 1624.24, "Text": " with small patches and whatnot,"}, {"Time_Start": 1624.68, "Time_End": 1625.52, "Text": " in change logs."}, {"Time_Start": 1626.02, "Time_End": 1628.5800000000002, "Text": " And even though these were one to two lines of code"}, {"Time_Start": 1628.5800000000002, "Time_End": 1629.82, "Text": " and were quite sort of obvious"}, {"Time_Start": 1629.82, "Time_End": 1632.1200000000001, "Text": " of what needed to be fixed."}, {"Time_Start": 1632.1200000000001, "Time_End": 1634.94, "Text": " It was unusual that he attributed me for those."}, {"Time_Start": 1635.7800000000002, "Time_End": 1638.48, "Text": " Solid designer was responsible for the 2.2 Linux kernels."}, {"Time_Start": 1638.96, "Time_End": 1643.74, "Text": " He was pretty, he was the person that was, I think, if you look back last year,"}, {"Time_Start": 1643.8200000000002, "Time_End": 1649.2, "Text": " the 2.2 kernel was released after some long period of time of not releasing another 2.2 kernel."}, {"Time_Start": 1649.5800000000002, "Time_End": 1655.5800000000002, "Text": " And that was really solid designer doing all of that work and backporting a lot of bugs from 2.4 as well."}, {"Time_Start": 1656.5800000000002, "Time_End": 1661.3000000000002, "Text": " Dave Miller initially started on the spark patches and whatnot."}, {"Time_Start": 1662.1200000000001, "Time_End": 1664.8600000000001, "Text": " And then started to help in sort of generic stuff as well."}, {"Time_Start": 1667.0000000000002, "Time_End": 1671.9, "Text": " So, in my opinion, Linux was probably the biggest success here."}, {"Time_Start": 1674.0000000000002, "Time_End": 1676.5600000000002, "Text": " Certainly, Red Howe released an advisory last year"}, {"Time_Start": 1676.5600000000002, "Time_End": 1683.7600000000002, "Text": " about the 2.4 kernels, 2.4, I think 2.4 or 19 or 18."}, {"Time_Start": 1685.2600000000002, "Time_End": 1688.0800000000002, "Text": " And they were pretty political in their advisory,"}, {"Time_Start": 1688.24, "Time_End": 1690.46, "Text": " referencing the DMCA and saying stuff like,"}, {"Time_Start": 1690.46, "Time_End": 1695.44, "Text": " we'd like to give you information on these vulnerabilities, but we can't because maybe"}, {"Time_Start": 1695.44, "Time_End": 1700.72, "Text": " the DMCA affects this. So if you go to another website that's outside the US, you'll be able"}, {"Time_Start": 1700.72, "Time_End": 1704.8400000000001, "Text": " to see specific information on each of these, each of the bugs that were fixed."}, {"Time_Start": 1705.9, "Time_End": 1714.94, "Text": " That was interesting, I thought. But now it seems, excuse me, now it seems that Red Hat, along with"}, {"Time_Start": 1714.94, "Time_End": 1719.14, "Text": " most of the other Linux vendors, do release kernel advisories, which seems to be fantastic."}, {"Time_Start": 1719.14, "Time_End": 1721.42, "Text": " they do release regular kernel advisories now."}, {"Time_Start": 1723.14, "Time_End": 1726.8200000000002, "Text": " So, you know, it seems probable that this was, you know,"}, {"Time_Start": 1726.88, "Time_End": 1730.0, "Text": " this is probably attributed to the auditing work that was done last year."}, {"Time_Start": 1731.42, "Time_End": 1734.5, "Text": " So in my opinion, that was probably the biggest success story there."}, {"Time_Start": 1735.46, "Time_End": 1738.9, "Text": " The audit, like, it's, the irony is that, you know,"}, {"Time_Start": 1739.1200000000001, "Time_End": 1740.7800000000002, "Text": " there was the Linux kernel auditing project,"}, {"Time_Start": 1740.7800000000002, "Time_End": 1744.2800000000002, "Text": " but it seems that the, you know, the audit performed last year was probably,"}, {"Time_Start": 1744.7800000000002, "Time_End": 1747.7, "Text": " probably the most complete for Linux at that time."}, {"Time_Start": 1749.14, "Time_End": 1751.6200000000001, "Text": " What about FreeBSD?"}, {"Time_Start": 1752.94, "Time_End": 1760.8400000000001, "Text": " FreeBSC certainly has a more formalised process with vulnerability disclosure and bug patching and whatnot."}, {"Time_Start": 1761.0600000000002, "Time_End": 1762.8400000000001, "Text": " They've got a security officer contact point."}, {"Time_Start": 1763.6000000000001, "Time_End": 1768.26, "Text": " It took me a bit longer to get, like, you know, reasonable dialogue with them."}, {"Time_Start": 1768.46, "Time_End": 1774.18, "Text": " You know, I'm not talking weeks here, but, you know, I think it was like a bit less than a week, I think."}, {"Time_Start": 1774.18, "Time_End": 1777.7800000000002, "Text": " It took me to establish, you know, really good, you know,"}, {"Time_Start": 1779.14, "Time_End": 1780.76, "Text": " really good dialogue there."}, {"Time_Start": 1781.44, "Time_End": 1784.3400000000001, "Text": " But they're pretty effective once dialogue was established."}, {"Time_Start": 1785.26, "Time_End": 1792.1000000000001, "Text": " They addressed a standardization issue, which I haven't really described in my slides,"}, {"Time_Start": 1792.26, "Time_End": 1799.26, "Text": " but for one particular point, if we look at Linux 2.2, and if we look at Linux 2.2,"}, {"Time_Start": 1799.3400000000001, "Time_End": 1801.5200000000002, "Text": " there's the get-sock-hop, set-sock-op code."}, {"Time_Start": 1801.8600000000001, "Time_End": 1806.94, "Text": " The problem for that was that the socket option length could be a negative,"}, {"Time_Start": 1807.5400000000002, "Time_End": 1809.1200000000001, "Text": " and when it was a negative, and when it was a net,"}, {"Time_Start": 1809.14, "Time_End": 1810.9, "Text": " negative, it would cause memory disclosure."}, {"Time_Start": 1812.3200000000002, "Time_End": 1816.6200000000001, "Text": " A very similar problem with FreeBSD, with the accept system call."}, {"Time_Start": 1816.96, "Time_End": 1821.0600000000002, "Text": " The length of the socket address structure could be a negative."}, {"Time_Start": 1822.98, "Time_End": 1825.5400000000002, "Text": " And when it was, it would cause memory disclosure again."}, {"Time_Start": 1826.5, "Time_End": 1830.48, "Text": " The good thing that FreeBSD did was that they said,"}, {"Time_Start": 1830.6000000000001, "Time_End": 1835.9, "Text": " okay, let's change this type death for the sock address length to be unsigned,"}, {"Time_Start": 1835.9, "Time_End": 1838.2800000000002, "Text": " which essentially, you know, in my opinion,"}, {"Time_Start": 1839.14, "Time_End": 1842.2800000000002, "Text": " will solve problems that they haven't foreseen in the future."}, {"Time_Start": 1843.38, "Time_End": 1845.88, "Text": " Unfortunately, the way that Linux went about fixing that,"}, {"Time_Start": 1846.4, "Time_End": 1848.2800000000002, "Text": " and it was unfortunate, like, in some respects,"}, {"Time_Start": 1848.48, "Time_End": 1855.1200000000001, "Text": " because there was so many, there was so many specific bugs in the Get Sockop code"}, {"Time_Start": 1855.1200000000001, "Time_End": 1858.5200000000002, "Text": " for various, you know, various protocols and whatnot,"}, {"Time_Start": 1859.0400000000002, "Time_End": 1862.3200000000002, "Text": " what was done was that a check very early on,"}, {"Time_Start": 1862.6000000000001, "Time_End": 1865.64, "Text": " early on in the code was performed to check for the negative case."}, {"Time_Start": 1866.16, "Time_End": 1869.1200000000001, "Text": " It solved lots and lots of points."}, {"Time_Start": 1869.14, "Time_End": 1874.6000000000001, "Text": " problems from hidden subsections of code that had the same sign bug, but I would have,"}, {"Time_Start": 1874.88, "Time_End": 1877.0200000000002, "Text": " my opinion was I would have liked that to be unsigned."}, {"Time_Start": 1879.18, "Time_End": 1881.1000000000001, "Text": " So was FreeBSE a success?"}, {"Time_Start": 1882.2, "Time_End": 1888.8000000000002, "Text": " They released an advisory last year with the accept system call again, and this was a bit of a surprise."}, {"Time_Start": 1890.0800000000002, "Time_End": 1894.46, "Text": " I'm working at a vulnerability company at the time, and a co-worker,"}, {"Time_Start": 1895.0600000000002, "Time_End": 1896.66, "Text": " happens to be that guy sitting right there,"}, {"Time_Start": 1896.66, "Time_End": 1902.48, "Text": " comes up to me and says that he's going to implement my vulnerability."}, {"Time_Start": 1903.2, "Time_End": 1906.94, "Text": " And I'm like, what vulnerability are you, you know, what are you talking about?"}, {"Time_Start": 1907.0400000000002, "Time_End": 1912.1000000000001, "Text": " And he's like, FreeBSD have released an advisory on the accept system call."}, {"Time_Start": 1912.76, "Time_End": 1915.3400000000001, "Text": " So, yeah, I don't know, thanks FreeBSD."}, {"Time_Start": 1915.8000000000002, "Time_End": 1917.44, "Text": " I really did not know about that."}, {"Time_Start": 1917.98, "Time_End": 1922.72, "Text": " And I saw the advisory, I think on BugTrack, like everyone else."}, {"Time_Start": 1924.0600000000002, "Time_End": 1925.42, "Text": " So NetBSD."}, {"Time_Start": 1926.66, "Time_End": 1932.1000000000001, "Text": " I didn't speak to NFSC for too long, but they did resolve all issues."}, {"Time_Start": 1932.9, "Time_End": 1943.92, "Text": " I think what happened with that, it took me about a week before, like, I could really, like, talk to, you know, have a good dialogue with someone."}, {"Time_Start": 1944.0, "Time_End": 1951.0, "Text": " And then it was about a week before they actually pushed patches into the main tree, you know, the main development tree at this point."}, {"Time_Start": 1951.0, "Time_End": 1956.64, "Text": " I think what was happening in the second week was that some,"}, {"Time_Start": 1956.66, "Time_End": 1961.46, "Text": " guy had done the changes, they're very simple changes, done the changes on his own box"}, {"Time_Start": 1961.46, "Time_End": 1966.44, "Text": " and was doing a bit of personal QA and then pushed it for the other, you know, developers to look"}, {"Time_Start": 1966.44, "Time_End": 1974.26, "Text": " at as well, back in the main unstable development tree, which is very typical in a development process."}, {"Time_Start": 1975.7, "Time_End": 1980.92, "Text": " So if we look at OpenBST now, Theodore Rat, you know, is probably the quickest response"}, {"Time_Start": 1980.92, "Time_End": 1986.64, "Text": " in documented history. Three minutes is, you know, that's pretty fast. I can't get my mum to email me."}, {"Time_Start": 1986.66, "Time_End": 1992.3400000000001, "Text": " you know, in three minutes, you know, that's, it's insane, it's three minutes."}, {"Time_Start": 1993.38, "Time_End": 2000.5800000000002, "Text": " So, interesting thing with OpenBSD though, was that they released an advisory for the select system"}, {"Time_Start": 2000.5800000000002, "Time_End": 2007.14, "Text": " call Stack Overflow there, and this was shortly after I sent them about 10 to, you know, this,"}, {"Time_Start": 2007.14, "Time_End": 2015.0400000000002, "Text": " I sent them 10 to 15 bugs, and some of these bugs, sent about 10 to 15 bugs, a bit after that"}, {"Time_Start": 2015.0400000000002, "Time_End": 2016.5400000000002, "Text": " they released a select advisory."}, {"Time_Start": 2016.66, "Time_End": 2022.48, "Text": " what I think happened in that period of time was that Niels Provost and probably other people"}, {"Time_Start": 2022.48, "Time_End": 2028.3200000000002, "Text": " in the OpenBSD started, you know, at least a more concerted effort, if not the initial"}, {"Time_Start": 2028.3200000000002, "Time_End": 2032.1000000000001, "Text": " effort, I'm not quite sure, to, you know, do kernel audits here."}, {"Time_Start": 2033.4, "Time_End": 2038.3400000000001, "Text": " So I think that was, I think that was reasonably successful that, you know, certainly they"}, {"Time_Start": 2038.3400000000001, "Time_End": 2040.5600000000002, "Text": " started to look at other issues then as well."}, {"Time_Start": 2042.1000000000001, "Time_End": 2046.64, "Text": " Interesting thing also with NetBSD, which I probably should have."}, {"Time_Start": 2046.66, "Time_End": 2051.9, "Text": " mentioned a bit before. When I sent NetBST a list of problems, some of the, some of the"}, {"Time_Start": 2051.9, "Time_End": 2057.3, "Text": " bugs were actually shared with OpenBST as well, which isn't, you know, too surprising."}, {"Time_Start": 2058.1800000000003, "Time_End": 2063.2000000000003, "Text": " The bugs that were shared were primarily just driver code. And that's, again, it's not surprising"}, {"Time_Start": 2063.2000000000003, "Time_End": 2068.4, "Text": " since OpenBSD, you know, can be considered, you know, thought from NEPSD, you know,"}, {"Time_Start": 2068.44, "Time_End": 2075.4, "Text": " some, some time ago now. But some of the drivers are shared, and, you know, some of the bugs, you know, were"}, {"Time_Start": 2075.4, "Time_End": 2076.1, "Text": " present in both."}, {"Time_Start": 2076.66, "Time_End": 2082.42, "Text": " OpenBSC did take the patches for these things, anyway,"}, {"Time_Start": 2082.54, "Time_End": 2089.02, "Text": " for NetBSC propagated to OpenBSD pretty quickly, but it was surprising to see the change"}, {"Time_Start": 2089.02, "Time_End": 2091.7599999999998, "Text": " logs in OpenBSD because it's, you know, it's like from NetBSD."}, {"Time_Start": 2092.2, "Time_End": 2096.08, "Text": " It's like, oh, yeah, those are the integer overflows and the driver problems there and whatnot."}, {"Time_Start": 2097.24, "Time_End": 2102.66, "Text": " So I've got, I've got a couple of, okay, I've got one change log here from the OpenBSD,"}, {"Time_Start": 2102.66, "Time_End": 2104.8399999999997, "Text": " from OpenBSD."}, {"Time_Start": 2105.18, "Time_End": 2106.64, "Text": " There's another, there's another good change."}, {"Time_Start": 2106.66, "Time_End": 2110.3799999999997, "Text": " change log entry, which I probably should have included, but I'll just talk about this one for a sec."}, {"Time_Start": 2110.8399999999997, "Time_End": 2116.56, "Text": " So this is the IBCS2 code that I showed earlier, which had no input validation checking at all."}, {"Time_Start": 2116.92, "Time_End": 2123.3999999999996, "Text": " And the comment in the change log is that more possible integer overflows are found."}, {"Time_Start": 2124.0, "Time_End": 2130.46, "Text": " So, you know, there were no integer overflows. It was just a no input validation check."}, {"Time_Start": 2131.48, "Time_End": 2136.64, "Text": " Another another interesting change log entry, and this was for a couple of things."}, {"Time_Start": 2136.66, "Time_End": 2144.46, "Text": " of them were, it was, like, I'm just trying to think back to the exact wording here."}, {"Time_Start": 2145.06, "Time_End": 2152.7, "Text": " It was more possible integer overflows found by yada, yada, yada. Some of these are okay,"}, {"Time_Start": 2152.8599999999997, "Time_End": 2157.44, "Text": " but have been changed for consistency. And in fact, you know, all of these were exploitable."}, {"Time_Start": 2157.74, "Time_End": 2161.5, "Text": " It wasn't, you know, some of these are okay, not, you know, those patches, you know, they were all"}, {"Time_Start": 2161.5, "Time_End": 2166.64, "Text": " exploitable. So, you know, it's not, you know, I think OpenVSD, you know, certainly, certainly,"}, {"Time_Start": 2166.66, "Time_End": 2170.7599999999998, "Text": " very good, but it's certainly interesting change logs as well."}, {"Time_Start": 2172.6, "Time_End": 2175.8199999999997, "Text": " So the IBCS2 stat.c code."}, {"Time_Start": 2177.46, "Time_End": 2182.56, "Text": " Linux fixed it, open BSD, fixed it, net BSD fixed it, free BSD. I don't know why they've"}, {"Time_Start": 2182.56, "Time_End": 2187.18, "Text": " never fixed it. I've sent them, I've sent them this and they've just not fixed it. I don't know why."}, {"Time_Start": 2188.3799999999997, "Time_End": 2195.14, "Text": " I'm really, you know, at a loss to say. And I also explain this at black and I'll explain it here."}, {"Time_Start": 2195.22, "Time_End": 2196.64, "Text": " The reason why there is a score."}, {"Time_Start": 2196.66, "Time_End": 2205.04, "Text": " next to the free BSD line is that this actually was a PowerPoint import into open office"}, {"Time_Start": 2205.04, "Time_End": 2207.54, "Text": " and it didn't have the font for the smiley face."}, {"Time_Start": 2207.54, "Time_End": 2211.66, "Text": " Well, that, you know, so that's the reason for the square up there."}, {"Time_Start": 2211.66, "Time_End": 2216.66, "Text": " There should have been, you know, a smiley face, a frown or a frown, but oh well."}, {"Time_Start": 2216.66, "Time_End": 2219.66, "Text": " So where are we today in Colonel Security?"}, {"Time_Start": 2219.66, "Time_End": 2225.66, "Text": " Auditing today, you know, always results in vulnerabilities being found."}, {"Time_Start": 2225.66, "Time_End": 2228.72, "Text": " You know, there are bugs still present in all the kernels."}, {"Time_Start": 2229.18, "Time_End": 2236.74, "Text": " And this isn't surprising because, you know, auditing and security, you know, really, you know, is or should be an ongoing process."}, {"Time_Start": 2237.2599999999998, "Time_End": 2242.74, "Text": " You can't just audit something at some point in time and say it's going to be secure for that, you know, indefinitely."}, {"Time_Start": 2243.96, "Time_End": 2250.8599999999997, "Text": " And certainly, you know, even though I'll, I will present, you know, a number of bugs and a number of bug classes,"}, {"Time_Start": 2250.8599999999997, "Time_End": 2255.64, "Text": " there's certainly more things that are exploitable and certainly a lot more classes of bugs in the code as well."}, {"Time_Start": 2255.66, "Time_End": 2258.2599999999998, "Text": " well, then we'll just be described today."}, {"Time_Start": 2259.7599999999998, "Time_End": 2267.16, "Text": " So, a couple of months ago presented most of, most of the bugs, a very technical presentation."}, {"Time_Start": 2268.92, "Time_End": 2272.22, "Text": " Like, basically I was going through list and lists of bugs and saying energy overflow,"}, {"Time_Start": 2272.3199999999997, "Time_End": 2278.44, "Text": " energy overflow, about four months ago at RuxCon, and released some zero day,"}, {"Time_Start": 2278.8399999999997, "Time_End": 2281.12, "Text": " release some zero day at the time."}, {"Time_Start": 2281.6, "Time_End": 2283.08, "Text": " And some of those bugs are still present."}, {"Time_Start": 2283.7, "Time_End": 2284.68, "Text": " I don't know why."}, {"Time_Start": 2285.66, "Time_End": 2292.3999999999996, "Text": " So the cough loader for Linux and exploit is available for that on the Ruxcom website."}, {"Time_Start": 2292.8599999999997, "Time_End": 2301.06, "Text": " But I've never actually posted an advisory or posted anything to full disclosure or bug track or, you know, or whatever."}, {"Time_Start": 2302.2599999999998, "Time_End": 2304.2599999999998, "Text": " And, yeah, it's never been fixed."}, {"Time_Start": 2304.2599999999998, "Time_End": 2313.7999999999997, "Text": " So, you know, an obvious question, does, you know, does anyone, does anyone read, you know, the conference materials, you know, and does anything about it?"}, {"Time_Start": 2313.8, "Time_End": 2316.82, "Text": " You know, are we just presenting things for ourselves or what?"}, {"Time_Start": 2319.32, "Time_End": 2323.04, "Text": " So at this point, I'm going to pause for audience participation and ask if there any questions."}, {"Time_Start": 2337.54, "Time_End": 2340.26, "Text": " Okay, I've got to, I've actually got a pretty interesting question here."}, {"Time_Start": 2340.26, "Time_End": 2343.78, "Text": " The question was that basically, when I talked about, basically, when I talked about,"}, {"Time_Start": 2343.8, "Time_End": 2350.38, "Text": " bugs being clustered, he was asking me if that was the, because of the way I was auditing."}, {"Time_Start": 2351.1000000000004, "Time_End": 2355.6000000000004, "Text": " And I suppose, you know, my response to that is, you know, I can't really present, you know,"}, {"Time_Start": 2355.6000000000004, "Time_End": 2361.0, "Text": " scientifically that, you know, bug clustering exists. All I can say is that I observed, you know,"}, {"Time_Start": 2361.04, "Time_End": 2365.8, "Text": " in my opinion, bug clustering and, you know, it's possibly supporting evidence. And Dawson Engler's work"}, {"Time_Start": 2365.8, "Time_End": 2371.5800000000004, "Text": " certainly talks about bug clustering and bug propagation. And that's probably, certainly more scientific"}, {"Time_Start": 2371.5800000000004, "Time_End": 2373.78, "Text": " than the methods that I use, which, you know,"}, {"Time_Start": 2373.8, "Time_End": 2379.8, "Text": " you know, manual auditing, you know, I must admit, I did, you know, look at certain bits of source"}, {"Time_Start": 2379.8, "Time_End": 2387.5, "Text": " and the sources around it, you know, in reasonable, you know, in a reasonably close timeframe,"}, {"Time_Start": 2387.7000000000003, "Time_End": 2390.5800000000004, "Text": " so maybe that was the reason why I saw bug clustering."}, {"Time_Start": 2391.6200000000003, "Time_End": 2393.44, "Text": " Yeah, but it's a good question, but, you know."}, {"Time_Start": 2397.02, "Time_End": 2403.1000000000004, "Text": " Okay, I'll go to the next part of the presentation, which is a sample of exploitable bugs, and I'm actually"}, {"Time_Start": 2403.1, "Time_End": 2409.42, "Text": " going to, it looks like I'm running really long here, so I'm going to actually skip a few of"}, {"Time_Start": 2409.42, "Time_End": 2416.46, "Text": " the slides here. Okay, I've got a 10-minute sign-up there, which is pretty good. I'm going to go through"}, {"Time_Start": 2416.46, "Time_End": 2420.86, "Text": " a couple of bugs and go through a couple of classes of ways, a couple ways to exploit them as"}, {"Time_Start": 2420.86, "Time_End": 2428.44, "Text": " well. A sample of exploitable bugs? This was, okay, I'll just skip to something that's more"}, {"Time_Start": 2428.44, "Time_End": 2433.08, "Text": " interesting. If you want to, you know, if anyone wants to talk to me about this,"}, {"Time_Start": 2433.1, "Time_End": 2435.1, "Text": " after the presentation, that's fine."}, {"Time_Start": 2437.1, "Time_End": 2442.1, "Text": " So I'll go to something that's, okay, this one is interesting."}, {"Time_Start": 2443.24, "Time_End": 2449.38, "Text": " What we have here is that we have, and I know that no one can read this, so I'll try to explain it."}, {"Time_Start": 2450.2999999999997, "Time_End": 2458.12, "Text": " We have a memory allocation, and we have memory allocation of something like a size of, a long times,"}, {"Time_Start": 2458.88, "Time_End": 2463.08, "Text": " you know, something plus a one, and then down below, we have,"}, {"Time_Start": 2463.1, "Time_End": 2470.22, "Text": " a copy-out call, which is a kernel buffer copy from kernel space to user space."}, {"Time_Start": 2471.1, "Time_End": 2475.58, "Text": " And the copy-out call does something like a size of, a long time, you know, this size thing."}, {"Time_Start": 2476.5, "Time_End": 2483.2999999999997, "Text": " And so basically one of the problems that I've seen a lot in programming is that when people"}, {"Time_Start": 2483.2999999999997, "Time_End": 2488.2599999999998, "Text": " are doing things like memory allocations and using one expression to calculate these lengths,"}, {"Time_Start": 2488.2599999999998, "Time_End": 2492.54, "Text": " and then they're doing buffer copies using these, you know, these other expressions,"}, {"Time_Start": 2493.1, "Time_End": 2495.66, "Text": " or they're doing input validation checks using one expression"}, {"Time_Start": 2495.66, "Time_End": 2497.66, "Text": " and then buffer copies using another expression."}, {"Time_Start": 2498.02, "Time_End": 2501.44, "Text": " Typically always, they lead themselves into problems because you can,"}, {"Time_Start": 2502.16, "Time_End": 2504.92, "Text": " many times you can get, you know, the first expression to do, you know,"}, {"Time_Start": 2504.96, "Time_End": 2508.68, "Text": " come out with one answer and the second one to come out with something else,"}, {"Time_Start": 2508.8399999999997, "Time_End": 2510.54, "Text": " using integer overflows and whatnot."}, {"Time_Start": 2510.72, "Time_End": 2513.74, "Text": " So that seems to be a problem that exists."}, {"Time_Start": 2514.38, "Time_End": 2517.66, "Text": " When you see code like that and they say, okay, they're using one expression here"}, {"Time_Start": 2517.66, "Time_End": 2521.98, "Text": " and another expression down below, it's very, very often that it's exploitable in some way."}, {"Time_Start": 2523.1, "Time_End": 2531.66, "Text": " This one, another interesting case, we take a minimum here, a minimum of two values."}, {"Time_Start": 2532.42, "Time_End": 2535.52, "Text": " One of those values we control from a Cisco argument."}, {"Time_Start": 2537.72, "Time_End": 2542.8399999999997, "Text": " But the point here is that we control the fiscal argument and we can make it a negative."}, {"Time_Start": 2543.24, "Time_End": 2548.74, "Text": " So when we take the minimum of these two values here, you know, we're going to come up with a negative."}, {"Time_Start": 2548.74, "Time_End": 2552.74, "Text": " So then we do a copy out later on using this length, which is,"}, {"Time_Start": 2553.1, "Time_End": 2555.1, "Text": " was a negative, now becomes a positive."}, {"Time_Start": 2555.1, "Time_End": 2558.02, "Text": " I got a sign that I have five minutes ago,"}, {"Time_Start": 2558.02, "Time_End": 2561.94, "Text": " so I'll skip most of these, actually."}, {"Time_Start": 2561.94, "Time_End": 2564.7799999999997, "Text": " And I'll go to some ways to exploit."}, {"Time_Start": 2568.7799999999997, "Time_End": 2571.98, "Text": " Okay."}, {"Time_Start": 2571.98, "Time_End": 2577.18, "Text": " Here's an example of what I was just talking about a second ago."}, {"Time_Start": 2577.18, "Time_End": 2580.72, "Text": " We have a validation check on this count value here."}, {"Time_Start": 2580.72, "Time_End": 2582.62, "Text": " This is in the PCI hot plug, core."}, {"Time_Start": 2582.62, "Time_End": 2592.7599999999998, "Text": " which is Linux code and we seem to have lost one of the, I'll look at this one now."}, {"Time_Start": 2593.48, "Time_End": 2600.2799999999997, "Text": " We seem to have, so we do a validation check on this count, okay, and we check if count is less"}, {"Time_Start": 2600.2799999999997, "Time_End": 2604.58, "Text": " than equal to zero, but then we do a memory allocation using count plus one."}, {"Time_Start": 2605.92, "Time_End": 2611.56, "Text": " So now we have integer overflow when we make count the size of uint max."}, {"Time_Start": 2612.62, "Time_End": 2618.46, "Text": " an unsigned integer maximum, we can get count plus one to wrap around back to zero, and"}, {"Time_Start": 2618.46, "Time_End": 2625.08, "Text": " came allocing zero bytes will return successful, providing we can perform a memory allocation"}, {"Time_Start": 2625.08, "Time_End": 2628.2799999999997, "Text": " to begin with."}, {"Time_Start": 2628.2799999999997, "Time_End": 2632.68, "Text": " Interesting bug that I really do want to talk about."}, {"Time_Start": 2632.68, "Time_End": 2640.12, "Text": " This is very prevalent in a lot of the 2.2 Linux code and most of the 2.4. This is what I was"}, {"Time_Start": 2640.12, "Time_End": 2642.3599999999997, "Text": " talking about before when you LSEC."}, {"Time_Start": 2642.62, "Time_End": 2651.38, "Text": " to around 4 gig. We take the file pointer, which typically is 64 bits, but in some cases"}, {"Time_Start": 2651.38, "Time_End": 2658.12, "Text": " people screw up the prototypes and that causes problems. And they've cast it to an int, and"}, {"Time_Start": 2658.12, "Time_End": 2664.3199999999997, "Text": " then they've had the file pointer, which is cast now as 32-bit sign value, plus the count which we're"}, {"Time_Start": 2664.3199999999997, "Time_End": 2671.7999999999997, "Text": " reading, and that itself is an integer overflow and causes memory disclosure later on. Okay, I'm going"}, {"Time_Start": 2671.8, "Time_End": 2681.94, "Text": " let's skip at this point to some, okay, I won't pause for audience participation"}, {"Time_Start": 2681.94, "Time_End": 2690.1800000000003, "Text": " and kernel exploitation. So there are two things that are two classes of exploits that we"}, {"Time_Start": 2690.1800000000003, "Time_End": 2695.6000000000004, "Text": " should look at here, arbitrary code execution and information disclosure. So for arbitrary code"}, {"Time_Start": 2695.6000000000004, "Time_End": 2701.02, "Text": " execution, obviously the best, the best form of exploitation that we have can give us a reach shell."}, {"Time_Start": 2701.02, "Time_End": 2708.42, "Text": " a privilege escalation, escape kernel sandboxing, security enhanced Linux, for example,"}, {"Time_Start": 2708.54, "Time_End": 2715.36, "Text": " user mode Linux. If we look at digital rights management, say, for example, we have a certain kernel"}, {"Time_Start": 2715.36, "Time_End": 2720.3, "Text": " version or a certain distro that is signed and it says that, okay, you know, when you view this"}, {"Time_Start": 2720.3, "Time_End": 2725.54, "Text": " website, you can't actually save any streaming content or so forth. However, if we have, you know,"}, {"Time_Start": 2725.6, "Time_End": 2730.96, "Text": " vulnerabilities in this software, in this software, you know, we can control it at that point and we can make"}, {"Time_Start": 2731.02, "Time_End": 2737.72, "Text": " software do something else than what the DRM people say it should do. You know, ultimately,"}, {"Time_Start": 2738.58, "Time_End": 2744.04, "Text": " you know, in the, you know, trusted computing doesn't actually provide any software assurance."}, {"Time_Start": 2744.7, "Time_End": 2750.54, "Text": " Trusted computing is basically just breaking policy, you know, at well-defined,"}, {"Time_Start": 2750.54, "Time_End": 2756.2, "Text": " at well-defined sequence points and having trust relationships. But if you're trusted, you know,"}, {"Time_Start": 2756.2, "Time_End": 2761.0, "Text": " a computing base or so forth, you know, is vulnerable or does, or does, or does, you know, you know,"}, {"Time_Start": 2761.02, "Time_End": 2766.92, "Text": " has hidden features, then, you know, certainly, you know, other things are possible there."}, {"Time_Start": 2767.82, "Time_End": 2771.48, "Text": " So, and I, you know, it seems to be the case. If your trusted computing base is flawed,"}, {"Time_Start": 2771.94, "Time_End": 2777.58, "Text": " and certainly in, you know, in all of these things, the kernel is seen as the trusted entity,"}, {"Time_Start": 2778.04, "Time_End": 2782.7599999999998, "Text": " then ultimately system security is compromised. We have information disclosure as well,"}, {"Time_Start": 2783.6, "Time_End": 2791.0, "Text": " such as, thank you, such as, such as, such as,"}, {"Time_Start": 2791.02, "Time_End": 2801.3, "Text": " SSH private keys. If we can read arbitrary kernel memory, we might be able to sneak out an SSH private key. I will just pause for one second."}, {"Time_Start": 2821.02, "Time_End": 2823.84, "Text": " So I'll try to get in as much as possible here."}, {"Time_Start": 2825.34, "Time_End": 2827.62, "Text": " It has been prior work to kernel exploitation."}, {"Time_Start": 2828.58, "Time_End": 2834.32, "Text": " Noir in Fract 60, wrote a great article, great paper,"}, {"Time_Start": 2834.84, "Time_End": 2836.86, "Text": " on smashing the kernel stack for fun and profit."}, {"Time_Start": 2838.18, "Time_End": 2840.3, "Text": " And this was an implementation of exploiter,"}, {"Time_Start": 2841.22, "Time_End": 2844.72, "Text": " of exploiting the OpenBSD select kernel stack overflow."}, {"Time_Start": 2844.72, "Time_End": 2851.0, "Text": " There have been other exploits in the past from Solaris and"}, {"Time_Start": 2851.02, "Time_End": 2859.48, "Text": " free BSC and whatnot. But in the general case, it's seen that there aren't generic"}, {"Time_Start": 2859.48, "Time_End": 2864.1, "Text": " ways of attacking the kernel, which was probably a good thing advised because he showed a class"}, {"Time_Start": 2864.1, "Time_End": 2871.4, "Text": " of bugs there. Colonel implementation, all the kernels are written in C. C has known bugs,"}, {"Time_Start": 2871.4, "Time_End": 2878.5, "Text": " known problems, known pitfalls, attack the language, attack the implementation, don't attack the"}, {"Time_Start": 2878.5, "Time_End": 2881.0, "Text": " algorithms. A very simple, you know,"}, {"Time_Start": 2881.02, "Time_End": 2883.84, "Text": " method of attack, but a very effective one too."}, {"Time_Start": 2885.56, "Time_End": 2889.18, "Text": " C has some pitfalls. I won't talk about these, but"}, {"Time_Start": 2889.18, "Time_End": 2894.3, "Text": " yeah, C has lots of problems. And they've seen, you know, they've been seen"}, {"Time_Start": 2894.3, "Time_End": 2899.74, "Text": " time and time again for, you know, for many, many years now since the 1970s"}, {"Time_Start": 2899.74, "Time_End": 2907.04, "Text": " at least. So, you know, there are problems in pretty much"}, {"Time_Start": 2907.04, "Time_End": 2910.7599999999998, "Text": " all code, not just use the land or kernel code. All code really has"}, {"Time_Start": 2911.02, "Time_End": 2918.88, "Text": " the same classes of bugs that people are looking for, and all code, you know, we can find"}, {"Time_Start": 2918.88, "Time_End": 2926.86, "Text": " bugs in lots and lots of code. I will skip this because I've talked about it earlier"}, {"Time_Start": 2926.86, "Time_End": 2940.42, "Text": " on. Okay, so when we, what we, what we, okay, if we, okay, if we look at Colonel Buffer"}, {"Time_Start": 2940.42, "Time_End": 2947.42, "Text": " copies okay. We can think of kernel and user space divided into segments. Kernel space, you"}, {"Time_Start": 2947.42, "Time_End": 2952.08, "Text": " know, is a segment, user space is a segment. And when we do a kernel buffer copy, we need"}, {"Time_Start": 2952.08, "Time_End": 2958.7200000000003, "Text": " to validate the source and destination that they reside in the right segments so that when we're"}, {"Time_Start": 2958.7200000000003, "Time_End": 2964.38, "Text": " copying something from kernel space to user space, we are in fact copying it from kernel space to"}, {"Time_Start": 2964.38, "Time_End": 2970.26, "Text": " user space. We're not putting in values such as zero X, something, something, something, which represents"}, {"Time_Start": 2970.26, "Time_End": 2977.26, "Text": " kernel space to a read or a write system call or so forth. For example here, if we were able"}, {"Time_Start": 2977.26, "Time_End": 2986.26, "Text": " to read something from the network and it was possible to put in an address such as 0XC,"}, {"Time_Start": 2986.26, "Time_End": 2992.2000000000003, "Text": " 104, you know, whatever, we'd actually, if there was no validation done, we'd actually read this"}, {"Time_Start": 2992.2000000000003, "Time_End": 2998.2400000000002, "Text": " data into the kernel segment and, you know, overwrite kernel structures or executable code."}, {"Time_Start": 2998.2400000000002, "Time_End": 3005.36, "Text": " and if that was the case that we could read into kernel space, then we could certainly exploit"}, {"Time_Start": 3005.36, "Time_End": 3017.44, "Text": " the kernel here. Okay, we have a FreeBSD SIS except exploit here and I just wanted to show"}, {"Time_Start": 3017.44, "Time_End": 3023.84, "Text": " this code. It's about 30, 37 or 38 lines, what I said before. And the way to exploit this"}, {"Time_Start": 3023.84, "Time_End": 3028.2200000000003, "Text": " is pretty straightforward. The accept system call takes three arguments."}, {"Time_Start": 3028.2400000000002, "Time_End": 3056.5200000000004, "Text": " The first argument is a socket. The second argument is a socket address and the third argument is the socket address link. We simply point the socket address address to a user space buffer. And then in our, it then in our socket address link, we pass to it a negative value. And I'm just about to get thrown off stage, so I'm going to wrap up right now."}, {"Time_Start": 3056.52, "Time_End": 3061.96, "Text": " Okay, thank you very much, everyone. I hope you enjoy my presentation."}, {"Time_Start": 3086.52, "Time_End": 3087.8, "Text": " anyway. But thank you."}]}