{
  "segments": [
    {
      "Time_Start": 0.0,
      "Time_End": 17.92,
      "Text": "This text was transcribed using whisper model: large-v2\n\n Thanks for joining me today at SOCON 2020."
    },
    {
      "Time_Start": 17.92,
      "Time_End": 23.76,
      "Text": " Hopefully you have been enjoying the workshops and talks from the rest of the team today."
    },
    {
      "Time_Start": 23.76,
      "Time_End": 27.76,
      "Text": " During the next 20 or so minutes, we're going to talk through some of the things that I"
    },
    {
      "Time_Start": 27.76,
      "Time_End": 34.32,
      "Text": " have found out when digging a little bit deeper into PsExec and how it can be used"
    },
    {
      "Time_Start": 34.32,
      "Time_End": 38.68,
      "Text": " for lateral movement."
    },
    {
      "Time_Start": 38.68,
      "Time_End": 40.0,
      "Text": " My name is Brandon Scullion."
    },
    {
      "Time_Start": 40.0,
      "Time_End": 43.160000000000004,
      "Text": " You can find me on Twitter at Inceptor."
    },
    {
      "Time_Start": 43.160000000000004,
      "Time_End": 47.040000000000006,
      "Text": " I'm a senior detection consultant at Spector Ops."
    },
    {
      "Time_Start": 47.040000000000006,
      "Time_End": 52.24,
      "Text": " You may have gone through some training with me as the defender for our red team operations"
    },
    {
      "Time_Start": 52.24,
      "Time_End": 57.480000000000004,
      "Text": " course or with our detection course."
    },
    {
      "Time_Start": 57.480000000000004,
      "Time_End": 62.68000000000001,
      "Text": " Formerly I worked for a Fortune 500 insurance company, wearing many different hats within"
    },
    {
      "Time_Start": 62.68000000000001,
      "Time_End": 69.68,
      "Text": " the security department, from security architecture to security engineering and access management."
    },
    {
      "Time_Start": 69.68,
      "Time_End": 73.80000000000001,
      "Text": " But I spent most of my time with our internal threat hunt team."
    },
    {
      "Time_Start": 73.80000000000001,
      "Time_End": 77.64,
      "Text": " When I started, we were still pretty new."
    },
    {
      "Time_Start": 77.64,
      "Time_End": 83.64,
      "Text": " So I had assisted in standing up an internal SOC with that team."
    },
    {
      "Time_Start": 83.96,
      "Time_End": 91.68,
      "Text": " Along with working out some of the procedures and the interdepartment communication procedures,"
    },
    {
      "Time_Start": 91.68,
      "Time_End": 96.44,
      "Text": " I wore a couple different hats on that team as well, from threat analyst to detection"
    },
    {
      "Time_Start": 96.44,
      "Time_End": 103.24000000000001,
      "Text": " engineering, and my favorite was adversarial simulation to validate detections."
    },
    {
      "Time_Start": 103.24000000000001,
      "Time_End": 105.44,
      "Text": " Some of my loves, my wife and family."
    },
    {
      "Time_Start": 105.44,
      "Time_End": 111.16,
      "Text": " I have four kids, and we recently took on some miniature homesteading."
    },
    {
      "Time_Start": 111.16,
      "Time_End": 116.39999999999999,
      "Text": " We just got six chickens to add to that, plus our dog this year, but we've been really"
    },
    {
      "Time_Start": 116.39999999999999,
      "Time_End": 121.24,
      "Text": " enjoying having fresh eggs every day, and that's been a lot of fun, seeing the kids"
    },
    {
      "Time_Start": 121.24,
      "Time_End": 128.32,
      "Text": " learn to take care of the animals and some of the chores around what it's like to take"
    },
    {
      "Time_Start": 128.32,
      "Time_End": 130.64,
      "Text": " care of chickens."
    },
    {
      "Time_Start": 130.64,
      "Time_End": 133.35999999999999,
      "Text": " Some of my other loves, I like to automate and script."
    },
    {
      "Time_Start": 133.35999999999999,
      "Time_End": 136.96,
      "Text": " I also like building things, woodworking especially."
    },
    {
      "Time_Start": 136.96,
      "Time_End": 143.36,
      "Text": " We built a kitchen table as well as a patio table to somewhat match farmhouse style, and"
    },
    {
      "Time_Start": 143.36,
      "Time_End": 144.84,
      "Text": " who doesn't love new gadgets?"
    },
    {
      "Time_Start": 144.84,
      "Time_End": 151.56,
      "Text": " So if you ever want to chat about any of those things, feel free to hit me up."
    },
    {
      "Time_Start": 151.56,
      "Time_End": 155.60000000000002,
      "Text": " So this talk is going to follow some of our methodology at SpectreOps that we use when"
    },
    {
      "Time_Start": 155.60000000000002,
      "Time_End": 159.36,
      "Text": " building out alerting and detection strategies."
    },
    {
      "Time_Start": 159.36,
      "Time_End": 165.48000000000002,
      "Text": " We also refer to those as ADSs, but having some form of documented detection strategy"
    },
    {
      "Time_Start": 165.64,
      "Time_End": 170.84,
      "Text": " will help create a tangible document of the work and the effort you have put into building"
    },
    {
      "Time_Start": 170.84,
      "Time_End": 172.79999999999998,
      "Text": " these detections."
    },
    {
      "Time_Start": 172.79999999999998,
      "Time_End": 176.72,
      "Text": " Another thing that the ADS does, too, is it contributes to sharing your research with"
    },
    {
      "Time_Start": 176.72,
      "Time_End": 182.88,
      "Text": " the team or with other functions within the department, and it also can be used as a form"
    },
    {
      "Time_Start": 182.88,
      "Time_End": 189.16,
      "Text": " of an alerting playbook, and so you can actually use that as part of your detection strategy"
    },
    {
      "Time_Start": 189.16,
      "Time_End": 194.79999999999998,
      "Text": " to hand down to the SOC or to whoever's responding to the alerts that you have just built, and"
    },
    {
      "Time_Start": 194.8,
      "Time_End": 200.20000000000002,
      "Text": " they can gain a better understanding of the research that you've done and the reason why"
    },
    {
      "Time_Start": 200.20000000000002,
      "Time_End": 202.84,
      "Text": " they're responding to these alerts."
    },
    {
      "Time_Start": 202.84,
      "Time_End": 207.16000000000003,
      "Text": " If you haven't seen an ADS before, the link on the bottom of the slide is a good reference."
    },
    {
      "Time_Start": 207.16000000000003,
      "Time_End": 214.72000000000003,
      "Text": " Feel free to check out the blog post from Palantir, who kind of formulated this framework,"
    },
    {
      "Time_Start": 214.72000000000003,
      "Time_End": 219.4,
      "Text": " and definitely get some ideas on how you can help your detection engineering process and"
    },
    {
      "Time_Start": 219.4,
      "Time_End": 222.20000000000002,
      "Text": " provide an alerting playbook."
    },
    {
      "Time_Start": 222.20000000000002,
      "Time_End": 225.36,
      "Text": " From the scenario that we're going to walk through today, though, we're going to mostly"
    },
    {
      "Time_Start": 225.36,
      "Time_End": 231.48000000000002,
      "Text": " focus on understanding the underlying technology of PS-EXEC lateral movement."
    },
    {
      "Time_Start": 231.48000000000002,
      "Time_End": 237.16000000000003,
      "Text": " We will touch on some defender blind spots and what our strategy would look like for"
    },
    {
      "Time_Start": 237.16000000000003,
      "Time_End": 240.84000000000003,
      "Text": " detection, and then also some prevention considerations."
    },
    {
      "Time_Start": 240.84000000000003,
      "Time_End": 251.8,
      "Text": " If we can provide some mitigation of risk, it's always a good avenue to go down."
    },
    {
      "Time_Start": 251.8,
      "Time_End": 256.2,
      "Text": " I really enjoy the hands-on testing aspect when learning about underlying technology,"
    },
    {
      "Time_Start": 256.2,
      "Time_End": 264.52000000000004,
      "Text": " but before we get testing in our labs, we want to formulate some goals around this,"
    },
    {
      "Time_Start": 264.52000000000004,
      "Time_End": 268.04,
      "Text": " and we write them down to help guide our research."
    },
    {
      "Time_Start": 268.04,
      "Time_End": 272.96000000000004,
      "Text": " These can typically be in the form of questions or ideas, but we want to stay on track with"
    },
    {
      "Time_Start": 272.96000000000004,
      "Time_End": 276.08000000000004,
      "Text": " our objective as much as possible."
    },
    {
      "Time_Start": 276.08000000000004,
      "Time_End": 281.66,
      "Text": " Simply put here, we really just want to know what PS-EXEC is really doing behind the scenes,"
    },
    {
      "Time_Start": 282.52000000000004,
      "Time_End": 287.06,
      "Text": " what are the available data sources to us that we could use for a potential detection,"
    },
    {
      "Time_Start": 287.06,
      "Time_End": 292.38000000000005,
      "Text": " and what I really want to know is, is there any behavior within this technique that the"
    },
    {
      "Time_Start": 292.38000000000005,
      "Time_End": 299.02000000000004,
      "Text": " adversary is unable to change?"
    },
    {
      "Time_Start": 299.02000000000004,
      "Time_End": 304.06,
      "Text": " Here we can see that PS-EXEC lateral movement is still very much a real threat in our environments"
    },
    {
      "Time_Start": 304.06,
      "Time_End": 305.06,
      "Text": " today."
    },
    {
      "Time_Start": 305.06,
      "Time_End": 311.58000000000004,
      "Text": " I just came across this November 4th on Twitter, and here, what it's showing is that PS-EXEC"
    },
    {
      "Time_Start": 311.58,
      "Time_End": 318.46,
      "Text": " svc.exe is the PS-EXEC service that is launched on the server-side host, which we'll get"
    },
    {
      "Time_Start": 318.46,
      "Time_End": 325.38,
      "Text": " into later, but here, this service has launched an interactive command shell, and from that"
    },
    {
      "Time_Start": 325.38,
      "Time_End": 330.62,
      "Text": " interactive command shell, it had attempted to run PROC DUMP in order to dump credentials"
    },
    {
      "Time_Start": 330.62,
      "Time_End": 332.7,
      "Text": " from LSAS."
    },
    {
      "Time_Start": 332.7,
      "Time_End": 336.9,
      "Text": " Using MITRE ATT&CK is a good place to start when trying to find a path forward for your"
    },
    {
      "Time_Start": 336.9,
      "Time_End": 338.34,
      "Text": " next detection."
    },
    {
      "Time_Start": 338.34000000000003,
      "Time_End": 343.86,
      "Text": " Here I went to MITRE ATT&CK, and I just used their search field to search for PS-EXEC,"
    },
    {
      "Time_Start": 343.86,
      "Time_End": 346.62,
      "Text": " and it yielded these top three categories."
    },
    {
      "Time_Start": 346.62,
      "Time_End": 351.02000000000004,
      "Text": " So let's take a closer look at each one of these and find out what we'll need in order"
    },
    {
      "Time_Start": 351.02000000000004,
      "Time_End": 352.66,
      "Text": " to begin testing."
    },
    {
      "Time_Start": 352.66,
      "Time_End": 356.02000000000004,
      "Text": " There are a few things I like to key on when I'm starting my research for any particular"
    },
    {
      "Time_Start": 356.02000000000004,
      "Time_End": 357.66,
      "Text": " technique or procedure."
    },
    {
      "Time_Start": 357.66,
      "Time_End": 363.06000000000006,
      "Text": " I take a look at system requirements, the permissions required, and the data sources."
    },
    {
      "Time_Start": 363.06000000000006,
      "Time_End": 366.54,
      "Text": " These are the things that help me prepare my lab environment and ensure that I'll have"
    },
    {
      "Time_Start": 366.54,
      "Time_End": 370.78000000000003,
      "Text": " the visibility and the permissions I need for a good validation test."
    },
    {
      "Time_Start": 370.78000000000003,
      "Time_End": 376.3,
      "Text": " Here with remote services SMB Windows admin shares, you can see that SMB is required to"
    },
    {
      "Time_Start": 376.3,
      "Time_End": 381.62,
      "Text": " be enabled and that host and network firewalls are not blocking SMB ports."
    },
    {
      "Time_Start": 381.62,
      "Time_End": 384.74,
      "Text": " The permissions required are administrator or user."
    },
    {
      "Time_Start": 384.74,
      "Time_End": 390.98,
      "Text": " The user context I'm guessing is based on user privilege or access to certain directories"
    },
    {
      "Time_Start": 390.98,
      "Time_End": 393.46000000000004,
      "Text": " or folder shares."
    },
    {
      "Time_Start": 393.46000000000004,
      "Time_End": 398.82000000000005,
      "Text": " And then here under data sources we see authentication logs, process command line parameters."
    },
    {
      "Time_Start": 398.82000000000005,
      "Time_End": 403.98,
      "Text": " So here with system services, service execution, we start to see some overlapping data sources,"
    },
    {
      "Time_Start": 403.98,
      "Time_End": 406.3,
      "Text": " which is good to see."
    },
    {
      "Time_Start": 406.3,
      "Time_End": 411.62000000000006,
      "Text": " We notice that there's process monitoring here as well and process command line parameters."
    },
    {
      "Time_Start": 411.62000000000006,
      "Time_End": 415.78000000000003,
      "Text": " Also noticing permissions required is administrator or system."
    },
    {
      "Time_Start": 415.78000000000003,
      "Time_End": 420.12000000000006,
      "Text": " With signed binary proxy execution, we see some additional data sources."
    },
    {
      "Time_Start": 420.12,
      "Time_End": 423.98,
      "Text": " This is good to know so that we can enable as much as possible in our lab."
    },
    {
      "Time_Start": 423.98,
      "Time_End": 428.72,
      "Text": " So specifically talking about API monitoring and DLL monitoring here, this could be noisy"
    },
    {
      "Time_Start": 428.72,
      "Time_End": 434.0,
      "Text": " but will be great for additional context in our research."
    },
    {
      "Time_Start": 434.0,
      "Time_End": 437.8,
      "Text": " Depending on our available lab environments, we want to enable as much logging as we can"
    },
    {
      "Time_Start": 437.8,
      "Time_End": 440.56,
      "Text": " for this test."
    },
    {
      "Time_Start": 440.56,
      "Time_End": 445.92,
      "Text": " For this particular scenario, I collected events from ProcMon."
    },
    {
      "Time_Start": 445.92,
      "Time_End": 451.96000000000004,
      "Text": " I deployed the SysMon agent using the SysMon configuration file with very few exclusions."
    },
    {
      "Time_Start": 451.96000000000004,
      "Time_End": 459.16,
      "Text": " I also did a PCAP capture file to verify additional network connections with the SysMon network"
    },
    {
      "Time_Start": 459.16,
      "Time_End": 461.0,
      "Text": " connection event ID."
    },
    {
      "Time_Start": 461.0,
      "Time_End": 467.28000000000003,
      "Text": " The localized data stored from Windows and SysMon was then shipped using WinLogBeat to"
    },
    {
      "Time_Start": 467.28000000000003,
      "Time_End": 474.36,
      "Text": " a local instance of Helk, which is an open source hunting ELK stack or elastic stack."
    },
    {
      "Time_Start": 474.6,
      "Time_End": 482.72,
      "Text": " For the testing, the scenario I used was PsExec being initiated to remote connect to a remote"
    },
    {
      "Time_Start": 482.72,
      "Time_End": 490.36,
      "Text": " system running as system and launching an interactive command shell on the remote host."
    },
    {
      "Time_Start": 490.36,
      "Time_End": 495.28000000000003,
      "Text": " Here's a graphical image I came up with for the test scenario that I did in the lab environment"
    },
    {
      "Time_Start": 495.28000000000003,
      "Time_End": 498.48,
      "Text": " in order to learn more about how PsExec is working."
    },
    {
      "Time_Start": 498.48,
      "Time_End": 506.48,
      "Text": " This particular dataset was collected by the technique using PsExec on a client system"
    },
    {
      "Time_Start": 506.48,
      "Time_End": 512.28,
      "Text": " initiating a remote connection running as system with the goal to launch an interactive"
    },
    {
      "Time_Start": 512.28,
      "Time_End": 515.0,
      "Text": " command shell on the remote host."
    },
    {
      "Time_Start": 515.0,
      "Time_End": 519.28,
      "Text": " This was my best effort in kind of documenting that workflow to visualize the timeline of"
    },
    {
      "Time_Start": 519.28,
      "Time_End": 521.32,
      "Text": " events between the two hosts."
    },
    {
      "Time_Start": 521.32,
      "Time_End": 527.0,
      "Text": " And so we're going to walk through these events in the next few slides."
    },
    {
      "Time_Start": 527.0,
      "Time_End": 532.08,
      "Text": " So let's take a look at client side or computer A from that graphic, and let's walk through"
    },
    {
      "Time_Start": 532.08,
      "Time_End": 535.36,
      "Text": " what the flowchart would look like from each event."
    },
    {
      "Time_Start": 535.36,
      "Time_End": 540.12,
      "Text": " So PsExec requires some form of parent process before it can be executed."
    },
    {
      "Time_Start": 540.12,
      "Time_End": 543.16,
      "Text": " This is typically seen via command shell."
    },
    {
      "Time_Start": 543.16,
      "Time_End": 548.76,
      "Text": " But if the adversary was injected into a different process, you may see something else as the"
    },
    {
      "Time_Start": 548.76,
      "Time_End": 551.5,
      "Text": " parent process."
    },
    {
      "Time_Start": 551.5,
      "Time_End": 554.02,
      "Text": " The bottom of these slides, though, keep an eye on these."
    },
    {
      "Time_Start": 554.02,
      "Time_End": 558.14,
      "Text": " These will track a few of the event IDs from different data sources that I was able to"
    },
    {
      "Time_Start": 558.14,
      "Time_End": 560.6999999999999,
      "Text": " identify along the way."
    },
    {
      "Time_Start": 560.6999999999999,
      "Time_End": 565.5799999999999,
      "Text": " So here process creation occurs from PsExec.exe."
    },
    {
      "Time_Start": 565.5799999999999,
      "Time_End": 569.96,
      "Text": " This could be any name here, though, so keep that in mind as we keep going."
    },
    {
      "Time_Start": 569.96,
      "Time_End": 575.6999999999999,
      "Text": " So here I document an interesting event that Sysmon was able to capture using image load"
    },
    {
      "Time_Start": 575.6999999999999,
      "Time_End": 576.92,
      "Text": " events."
    },
    {
      "Time_Start": 576.92,
      "Time_End": 582.1,
      "Text": " This event occurred specific for PsExec and is most likely attacker controlled."
    },
    {
      "Time_Start": 582.1,
      "Time_End": 589.94,
      "Text": " But we identify here that PsExec.exe loads itself, PsExec.exe, into memory."
    },
    {
      "Time_Start": 589.94,
      "Time_End": 596.78,
      "Text": " This seems to be required for PsExec to be able to execute a remote process."
    },
    {
      "Time_Start": 596.78,
      "Time_End": 604.0600000000001,
      "Text": " Also, if a user has not previously used PsExec, they're prompted for the end user license"
    },
    {
      "Time_Start": 604.0600000000001,
      "Time_End": 610.0400000000001,
      "Text": " agreement or the EULA, and a registry key is created to track this acceptance."
    },
    {
      "Time_Start": 610.04,
      "Time_End": 615.9399999999999,
      "Text": " This is attacker controlled, but very interesting event to monitor for sysinternals activity."
    },
    {
      "Time_Start": 615.9399999999999,
      "Time_End": 620.7199999999999,
      "Text": " You may have run into this when testing sysinternals or running sysinternals, but this will happen"
    },
    {
      "Time_Start": 620.7199999999999,
      "Time_End": 628.0,
      "Text": " with any sysinternals binary, and they all create a registry key to track that user acceptance."
    },
    {
      "Time_Start": 628.0,
      "Time_End": 633.3199999999999,
      "Text": " Next, we finally get LSAS access, which is required for a few different things."
    },
    {
      "Time_Start": 633.3199999999999,
      "Time_End": 638.0799999999999,
      "Text": " We saw in our MITRE attack pages that elevated access was required for this technique."
    },
    {
      "Time_Start": 638.08,
      "Time_End": 641.12,
      "Text": " So the process here is checking for that permission."
    },
    {
      "Time_Start": 641.12,
      "Time_End": 644.8000000000001,
      "Text": " PsExec can be used for local elevation as well."
    },
    {
      "Time_Start": 644.8000000000001,
      "Time_End": 651.44,
      "Text": " So LSAS could also be interacted with here, even if a user was just trying to elevate"
    },
    {
      "Time_Start": 651.44,
      "Time_End": 658.84,
      "Text": " as a system on the local host and not just related to a remote connection."
    },
    {
      "Time_Start": 658.84,
      "Time_End": 663.88,
      "Text": " Once authorized, we see a DNS query from the binary checking to make sure the remote host"
    },
    {
      "Time_Start": 663.88,
      "Time_End": 666.96,
      "Text": " is in fact the remote host."
    },
    {
      "Time_Start": 666.96,
      "Time_End": 669.24,
      "Text": " Then we see network connection attempt."
    },
    {
      "Time_Start": 669.24,
      "Time_End": 673.48,
      "Text": " Here PsExec connects to the remote host over port 135."
    },
    {
      "Time_Start": 673.48,
      "Time_End": 677.72,
      "Text": " A little Googling reveals that this port is specific to RPC."
    },
    {
      "Time_Start": 677.72,
      "Time_End": 682.0400000000001,
      "Text": " We have also seen port 445 for SMB and similar techniques."
    },
    {
      "Time_Start": 682.0400000000001,
      "Time_End": 686.1,
      "Text": " Not sure if that will be prevalent for this scenario, but we'll keep that in mind."
    },
    {
      "Time_Start": 686.1,
      "Time_End": 690.0400000000001,
      "Text": " Now we see the connection to a network share on the remote host."
    },
    {
      "Time_Start": 690.0400000000001,
      "Time_End": 696.1600000000001,
      "Text": " Here it's dropping a binary in the admin share in preparation to create the service for RPC"
    },
    {
      "Time_Start": 696.1999999999999,
      "Time_End": 698.16,
      "Text": " communication."
    },
    {
      "Time_Start": 698.16,
      "Time_End": 703.1999999999999,
      "Text": " Another interesting event here shown in ProcMon was that the service binary was created locally"
    },
    {
      "Time_Start": 703.1999999999999,
      "Time_End": 707.48,
      "Text": " first before copying it over to the remote host."
    },
    {
      "Time_Start": 707.48,
      "Time_End": 712.16,
      "Text": " So essentially we may be able to see file creates here as well, but SysMon was unable"
    },
    {
      "Time_Start": 712.16,
      "Time_End": 717.7199999999999,
      "Text": " to capture that or I was unable to verify that within SysMon during this test, but ProcMon"
    },
    {
      "Time_Start": 717.7199999999999,
      "Time_End": 725.56,
      "Text": " was able to reveal this local service creation before it copied it over."
    },
    {
      "Time_Start": 725.5600000000001,
      "Time_End": 731.6800000000001,
      "Text": " This one is probably not usable in a broad detection here, but we do see prefetch files"
    },
    {
      "Time_Start": 731.6800000000001,
      "Time_End": 732.6800000000001,
      "Text": " created."
    },
    {
      "Time_Start": 732.6800000000001,
      "Time_End": 737.0400000000001,
      "Text": " A little digging about prefetch files and we learned that prefetch files are used by"
    },
    {
      "Time_Start": 737.0400000000001,
      "Time_End": 742.24,
      "Text": " the application and they contain information about the application itself."
    },
    {
      "Time_Start": 742.24,
      "Time_End": 746.8800000000001,
      "Text": " So we have walked through some of the interesting findings on the client side host when PsExec"
    },
    {
      "Time_Start": 746.8800000000001,
      "Time_End": 748.4000000000001,
      "Text": " is executed."
    },
    {
      "Time_Start": 748.4000000000001,
      "Time_End": 753.2800000000001,
      "Text": " Let's take a look at the server side host."
    },
    {
      "Time_Start": 753.28,
      "Time_End": 757.3199999999999,
      "Text": " From earlier, we identified that the service binary was copied over to the server side"
    },
    {
      "Time_Start": 757.3199999999999,
      "Time_End": 761.8,
      "Text": " host to the admin share over port 135."
    },
    {
      "Time_Start": 761.8,
      "Time_End": 767.0799999999999,
      "Text": " We can confirm that with the file create events looking at the admin share on the server side"
    },
    {
      "Time_Start": 767.0799999999999,
      "Time_End": 768.36,
      "Text": " host."
    },
    {
      "Time_Start": 768.36,
      "Time_End": 773.52,
      "Text": " So these events may show up as a path with admin dollar sign or potentially even the"
    },
    {
      "Time_Start": 773.52,
      "Time_End": 779.24,
      "Text": " fully resolved path, which in this case was C windows and then PsExec service.exe was"
    },
    {
      "Time_Start": 779.24,
      "Time_End": 781.64,
      "Text": " created there."
    },
    {
      "Time_Start": 781.64,
      "Time_End": 785.72,
      "Text": " Once the service binary is created, we see a registry creation event."
    },
    {
      "Time_Start": 785.72,
      "Time_End": 790.24,
      "Text": " This appears to be created prior to the service creation itself, but it's possible that it"
    },
    {
      "Time_Start": 790.24,
      "Time_End": 797.72,
      "Text": " happens as services.exe is creating the PsExec service and was logged a fraction of some"
    },
    {
      "Time_Start": 797.72,
      "Time_End": 801.4399999999999,
      "Text": " time before service events actually were generated."
    },
    {
      "Time_Start": 801.4399999999999,
      "Time_End": 805.02,
      "Text": " This is interesting, though, because we may be able to monitor for service creation using"
    },
    {
      "Time_Start": 805.02,
      "Time_End": 809.0,
      "Text": " secureable objects and system access control lists when we enable them."
    },
    {
      "Time_Start": 809.0,
      "Time_End": 814.48,
      "Text": " So now we see the process create event where services.exe is started and it creates the"
    },
    {
      "Time_Start": 814.48,
      "Time_End": 816.6,
      "Text": " PsExec service."
    },
    {
      "Time_Start": 816.6,
      "Time_End": 822.68,
      "Text": " We can see this with Sysmon process create events, or we could use Windows event ID 4697"
    },
    {
      "Time_Start": 822.68,
      "Time_End": 824.76,
      "Text": " for services installed."
    },
    {
      "Time_Start": 824.76,
      "Time_End": 829.68,
      "Text": " Here we see that services.exe does access the newly created service here."
    },
    {
      "Time_Start": 829.68,
      "Time_End": 834.12,
      "Text": " This is probably a rabbit hole to go down to continue identifying what services.exe"
    },
    {
      "Time_Start": 834.12,
      "Time_End": 835.32,
      "Text": " is doing here."
    },
    {
      "Time_Start": 835.32,
      "Time_End": 838.72,
      "Text": " It could be just checking to make sure that the service was created properly and it is"
    },
    {
      "Time_Start": 838.72,
      "Time_End": 841.52,
      "Text": " running, but I'm not really sure."
    },
    {
      "Time_Start": 841.52,
      "Time_End": 847.08,
      "Text": " And so I take a note here for future research where we could maybe do some binary triage"
    },
    {
      "Time_Start": 847.08,
      "Time_End": 852.2,
      "Text": " to learn more about what services.exe is doing when it creates a new process, but we want"
    },
    {
      "Time_Start": 852.2,
      "Time_End": 857.9200000000001,
      "Text": " to continue our focus with the main goal of identifying what PsExec is doing and the data"
    },
    {
      "Time_Start": 857.9200000000001,
      "Time_End": 859.6,
      "Text": " sources we can use."
    },
    {
      "Time_Start": 859.6,
      "Time_End": 865.32,
      "Text": " Then we have another interesting self image load tracked by Sysmon ID 7."
    },
    {
      "Time_Start": 865.32,
      "Time_End": 868.88,
      "Text": " So here services is loading its own image binary again."
    },
    {
      "Time_Start": 868.88,
      "Time_End": 874.08,
      "Text": " So PsExec service.exe is loading PsExec service.exe."
    },
    {
      "Time_Start": 874.08,
      "Time_End": 876.0,
      "Text": " Now we're getting somewhere."
    },
    {
      "Time_Start": 876.0,
      "Time_End": 878.5200000000001,
      "Text": " The remote host now has named pipes created."
    },
    {
      "Time_Start": 878.5200000000001,
      "Time_End": 882.5600000000001,
      "Text": " A little Googling about named pipes and we find that they are used for interprocess communication"
    },
    {
      "Time_Start": 882.5600000000001,
      "Time_End": 884.44,
      "Text": " or IPC."
    },
    {
      "Time_Start": 884.44,
      "Time_End": 887.96,
      "Text": " This will be the way that the two processes will talk to each other between the client"
    },
    {
      "Time_Start": 887.96,
      "Time_End": 890.6,
      "Text": " side and the server side host."
    },
    {
      "Time_Start": 890.6,
      "Time_End": 895.4,
      "Text": " Sysmon captures pipe events on event ID 17 and 18, but if you don't have that logging"
    },
    {
      "Time_Start": 895.4,
      "Time_End": 901.4,
      "Text": " available, you can also identify named pipes by using a PowerShell remoting command."
    },
    {
      "Time_Start": 901.4,
      "Time_End": 908.12,
      "Text": " And you can just pull the named pipe files from any remote host across your environment."
    },
    {
      "Time_Start": 908.12,
      "Time_End": 913.44,
      "Text": " Some agents also might be able to identify named pipes using file creates."
    },
    {
      "Time_Start": 913.44,
      "Time_End": 918.0400000000001,
      "Text": " The PsExec service requires permissions to spawn additional commands and will access"
    },
    {
      "Time_Start": 918.0400000000001,
      "Time_End": 920.0400000000001,
      "Text": " LSAS here."
    },
    {
      "Time_Start": 920.04,
      "Time_End": 926.68,
      "Text": " This would normally be needed, especially when elevation is required."
    },
    {
      "Time_Start": 926.68,
      "Time_End": 931.16,
      "Text": " Another interesting but attacker controlled event was that PsExec creates pipe events"
    },
    {
      "Time_Start": 931.16,
      "Time_End": 936.16,
      "Text": " to monitor for standard in, standard out, and standard error for the process."
    },
    {
      "Time_Start": 936.16,
      "Time_End": 941.06,
      "Text": " These pipe events wouldn't necessarily need to be added into the binary."
    },
    {
      "Time_Start": 941.06,
      "Time_End": 946.48,
      "Text": " So if an attacker was to compile them themselves, they wouldn't have to add these."
    },
    {
      "Time_Start": 946.48,
      "Time_End": 950.64,
      "Text": " So I don't think these will be good detection avenues, but it was just an interesting event"
    },
    {
      "Time_Start": 950.64,
      "Time_End": 953.24,
      "Text": " for this particular behavior."
    },
    {
      "Time_Start": 953.24,
      "Time_End": 957.64,
      "Text": " We finally see a process create indicating the ultimate goal of the initial command run"
    },
    {
      "Time_Start": 957.64,
      "Time_End": 960.04,
      "Text": " on the client side host."
    },
    {
      "Time_Start": 960.04,
      "Time_End": 963.76,
      "Text": " Remember when I had said that we were trying to do a remote connection to a host to launch"
    },
    {
      "Time_Start": 963.76,
      "Time_End": 965.5600000000001,
      "Text": " an interactive command shell?"
    },
    {
      "Time_Start": 965.5600000000001,
      "Time_End": 971.52,
      "Text": " So in this case, we see command EXE that was launched on the server side host as an interactive"
    },
    {
      "Time_Start": 971.52,
      "Time_End": 973.2,
      "Text": " shell."
    },
    {
      "Time_Start": 973.2,
      "Time_End": 977.2,
      "Text": " Remember though, in my test, I did an interactive shell, but this could also be single commands"
    },
    {
      "Time_Start": 977.2,
      "Time_End": 983.96,
      "Text": " used for enumeration or additional C2 agents to be dropped and launched to establish access"
    },
    {
      "Time_Start": 983.96,
      "Time_End": 985.0,
      "Text": " on another host."
    },
    {
      "Time_Start": 985.0,
      "Time_End": 989.9200000000001,
      "Text": " So you may see different results here, but in our test, it was still launching a new"
    },
    {
      "Time_Start": 989.9200000000001,
      "Time_End": 991.32,
      "Text": " process."
    },
    {
      "Time_Start": 991.32,
      "Time_End": 996.72,
      "Text": " So after the majority of the commands have been executed, if it's an interactive shell,"
    },
    {
      "Time_Start": 996.72,
      "Time_End": 1002.0,
      "Text": " the user may have to terminate their interactive shell and some cleanup procedures occur here."
    },
    {
      "Time_Start": 1002.0,
      "Time_End": 1005.88,
      "Text": " We do see that in the form of delete service and registry keys, and then we see a process"
    },
    {
      "Time_Start": 1005.88,
      "Time_End": 1009.12,
      "Text": " termination event as well."
    },
    {
      "Time_Start": 1009.12,
      "Time_End": 1012.66,
      "Text": " So now we have walked through the interesting findings for our server side host."
    },
    {
      "Time_Start": 1012.66,
      "Time_End": 1016.28,
      "Text": " Remember the unique events for both client side and server side."
    },
    {
      "Time_Start": 1016.28,
      "Time_End": 1018.72,
      "Text": " Let's take a look at the entire image again."
    },
    {
      "Time_Start": 1018.72,
      "Time_End": 1023.44,
      "Text": " So walking through the flow chart, we took note of a few process creation events."
    },
    {
      "Time_Start": 1023.44,
      "Time_End": 1028.84,
      "Text": " We identified that there was a unique network connection for RPC, and we identified that"
    },
    {
      "Time_Start": 1028.84,
      "Time_End": 1033.0,
      "Text": " file creation is occurring in the admin share of the remote host."
    },
    {
      "Time_Start": 1033.0,
      "Time_End": 1037.12,
      "Text": " Pipe events here could also be unique enough if we're able to correlate them."
    },
    {
      "Time_Start": 1037.12,
      "Time_End": 1042.48,
      "Text": " However, named pipes, the actual names of the named pipes may vary and could be attacker"
    },
    {
      "Time_Start": 1042.48,
      "Time_End": 1043.6,
      "Text": " controlled."
    },
    {
      "Time_Start": 1043.6,
      "Time_End": 1047.6,
      "Text": " So it could be a little bit more difficult to correlate if we do not have a globally"
    },
    {
      "Time_Start": 1047.6,
      "Time_End": 1050.28,
      "Text": " unique identifier."
    },
    {
      "Time_Start": 1050.28,
      "Time_End": 1056.0,
      "Text": " Sometimes we refer to this as a primary key that helps us chain all of these events together."
    },
    {
      "Time_Start": 1056.0,
      "Time_End": 1060.96,
      "Text": " There are also some additional notes we take regarding image loads, reg keys, and process"
    },
    {
      "Time_Start": 1060.96,
      "Time_End": 1062.84,
      "Text": " access that occurs here."
    },
    {
      "Time_Start": 1062.84,
      "Time_End": 1067.52,
      "Text": " But I think we have enough to keep going based on process creation events, the network connections,"
    },
    {
      "Time_Start": 1067.52,
      "Time_End": 1069.2,
      "Text": " and the file creation of admin share."
    },
    {
      "Time_Start": 1069.2,
      "Time_End": 1071.24,
      "Text": " So let's keep going."
    },
    {
      "Time_Start": 1071.24,
      "Time_End": 1075.76,
      "Text": " So I think we have answered most of our questions from our goals, but we have also identified"
    },
    {
      "Time_Start": 1075.76,
      "Time_End": 1077.68,
      "Text": " some problems along the way."
    },
    {
      "Time_Start": 1077.68,
      "Time_End": 1082.72,
      "Text": " There are a lot of moving parts here that can be distracting to our main objectives."
    },
    {
      "Time_Start": 1082.72,
      "Time_End": 1089.28,
      "Text": " It's easy to get hung up on processes and service names, and name pipes are really interesting."
    },
    {
      "Time_Start": 1089.28,
      "Time_End": 1094.48,
      "Text": " The EULA behavior was also interesting, but probably just for PS exec or sys internals"
    },
    {
      "Time_Start": 1094.48,
      "Time_End": 1098.44,
      "Text": " in general being used in the attack."
    },
    {
      "Time_Start": 1098.44,
      "Time_End": 1103.48,
      "Text": " The admin dollar sign share was used in our sample, but we have also seen IPC dollar sign"
    },
    {
      "Time_Start": 1103.48,
      "Time_End": 1107.04,
      "Text": " and C dollar sign used in the wild as well."
    },
    {
      "Time_Start": 1107.04,
      "Time_End": 1110.16,
      "Text": " So once we have a good hold of the testing, we can do some more Googling or we can phone"
    },
    {
      "Time_Start": 1110.16,
      "Time_End": 1116.1200000000001,
      "Text": " some friends and see if we can find more answers or identify new questions."
    },
    {
      "Time_Start": 1116.1200000000001,
      "Time_End": 1120.52,
      "Text": " So a little Googling about the technique, and we can find that the Empire project included"
    },
    {
      "Time_Start": 1120.52,
      "Time_End": 1125.0400000000002,
      "Text": " a port of Metasploit's PS exec functionality into PowerShell."
    },
    {
      "Time_Start": 1125.0400000000002,
      "Time_End": 1130.0,
      "Text": " This tool uses Windows API calls to open up service manager on the remote machine and"
    },
    {
      "Time_Start": 1130.0,
      "Time_End": 1135.24,
      "Text": " then creates the service with a new binary path or command, and then it cleans everything up."
    },
    {
      "Time_Start": 1135.24,
      "Time_End": 1138.44,
      "Text": " This is very similar behavior to what we found in our testing."
    },
    {
      "Time_Start": 1138.48,
      "Time_End": 1140.28,
      "Text": " So let's look into this more."
    },
    {
      "Time_Start": 1140.28,
      "Time_End": 1145.0,
      "Text": " A little more Googling and asking some teammates, Luke, Jared, and Johnny, we get sent down"
    },
    {
      "Time_Start": 1145.0,
      "Time_End": 1150.4,
      "Text": " the path of RPC and how services can be interacted with using Windows API calls."
    },
    {
      "Time_Start": 1150.4,
      "Time_End": 1155.6000000000001,
      "Text": " We want to document this background for understanding the underlying technology of our ADS and also"
    },
    {
      "Time_Start": 1155.6000000000001,
      "Time_End": 1160.92,
      "Text": " highlight that both of these procedures still use port 135 and communicate using remote"
    },
    {
      "Time_Start": 1160.92,
      "Time_End": 1162.48,
      "Text": " procedure calls."
    },
    {
      "Time_Start": 1162.48,
      "Time_End": 1164.48,
      "Text": " That's good news."
    },
    {
      "Time_Start": 1164.48,
      "Time_End": 1168.2,
      "Text": " What does Windows say about RPC and the service control manager?"
    },
    {
      "Time_Start": 1168.2,
      "Time_End": 1172.28,
      "Text": " Well, summarizing their documentation, we can understand that the SCM, the service control"
    },
    {
      "Time_Start": 1172.28,
      "Time_End": 1176.8,
      "Text": " manager, uses RPC over TCP on port 135."
    },
    {
      "Time_Start": 1176.8,
      "Time_End": 1179.32,
      "Text": " But there's some interesting caveats here."
    },
    {
      "Time_Start": 1179.32,
      "Time_End": 1186.52,
      "Text": " If the host supports RPC, TCP, and allows this traffic and it's enabled, the sc.exe"
    },
    {
      "Time_Start": 1186.52,
      "Time_End": 1192.64,
      "Text": " can communicate or access the specified service and does not carry user credentials with the"
    },
    {
      "Time_Start": 1192.64,
      "Time_End": 1194.4,
      "Text": " net use command."
    },
    {
      "Time_Start": 1194.4,
      "Time_End": 1200.16,
      "Text": " But if RPC and TCP is disabled, then it fails over to use name pipes for that communication,"
    },
    {
      "Time_Start": 1200.16,
      "Time_End": 1203.24,
      "Text": " which does carry user credentials."
    },
    {
      "Time_Start": 1203.24,
      "Time_End": 1206.96,
      "Text": " It's time to start taking all of our notes and experience from running the tests in our"
    },
    {
      "Time_Start": 1206.96,
      "Time_End": 1210.6000000000001,
      "Text": " lab and push towards how we will detect this behavior."
    },
    {
      "Time_Start": 1210.6000000000001,
      "Time_End": 1214.48,
      "Text": " I think we have some opportunities here to detect file creations on a remote host where"
    },
    {
      "Time_Start": 1214.48,
      "Time_End": 1219.8400000000001,
      "Text": " the client side and server side connection are over port 135 and pivot on some primary"
    },
    {
      "Time_Start": 1219.8400000000001,
      "Time_End": 1224.2800000000002,
      "Text": " key to identify the process events that started this whole thing."
    },
    {
      "Time_Start": 1224.28,
      "Time_End": 1228.84,
      "Text": " We want to broaden our detection analytic and we identified a few areas that can be"
    },
    {
      "Time_Start": 1228.84,
      "Time_End": 1231.96,
      "Text": " considered blind spots if we use them in our correlation."
    },
    {
      "Time_Start": 1231.96,
      "Time_End": 1235.72,
      "Text": " PsExec is a Microsoft Sysinternals utility."
    },
    {
      "Time_Start": 1235.72,
      "Time_End": 1239.96,
      "Text": " Adversaries can use it, but they can also write their own and bring it along with them."
    },
    {
      "Time_Start": 1239.96,
      "Time_End": 1244.92,
      "Text": " Let's not focus on PsExec specific behaviors that we identified in testing like the EULA"
    },
    {
      "Time_Start": 1244.92,
      "Time_End": 1249.2,
      "Text": " or the registry keys and the process and service names."
    },
    {
      "Time_Start": 1249.2,
      "Time_End": 1253.36,
      "Text": " Depending on the environment, there may be an authorized activity that we would want"
    },
    {
      "Time_Start": 1253.3600000000001,
      "Time_End": 1258.2800000000002,
      "Text": " to tune or baseline out of our analytic, so make sure you track these as blind spots"
    },
    {
      "Time_Start": 1258.2800000000002,
      "Time_End": 1263.8000000000002,
      "Text": " on your ADS or your documentation, but that way we can circle back later to cover them"
    },
    {
      "Time_Start": 1263.8000000000002,
      "Time_End": 1267.3200000000002,
      "Text": " with another analytic if we need to."
    },
    {
      "Time_Start": 1267.3200000000002,
      "Time_End": 1270.44,
      "Text": " Sometimes different hosts will collect different logs."
    },
    {
      "Time_Start": 1270.44,
      "Time_End": 1274.72,
      "Text": " It could be based on department or certain machine images."
    },
    {
      "Time_Start": 1274.72,
      "Time_End": 1277.8000000000002,
      "Text": " Identify these up front so we understand some of those gaps."
    },
    {
      "Time_Start": 1277.8,
      "Time_End": 1283.96,
      "Text": " These gaps can become projects of improvement later on as we're able to prioritize them."
    },
    {
      "Time_Start": 1283.96,
      "Time_End": 1289.44,
      "Text": " Sometimes the risk of not detecting creates urgency for new log sources, but these are"
    },
    {
      "Time_Start": 1289.44,
      "Time_End": 1291.96,
      "Text": " not blockers for our scenario, so we're going to push ahead."
    },
    {
      "Time_Start": 1291.96,
      "Time_End": 1292.96,
      "Text": " All right."
    },
    {
      "Time_Start": 1292.96,
      "Time_End": 1296.9199999999998,
      "Text": " So let's try and talk out our logic for our detection analytic."
    },
    {
      "Time_Start": 1296.9199999999998,
      "Time_End": 1301.1599999999999,
      "Text": " We will start with file creation events that occur on admin shares."
    },
    {
      "Time_Start": 1301.1599999999999,
      "Time_End": 1306.28,
      "Text": " These results will include the service binary that gets dropped on the server side and the"
    },
    {
      "Time_Start": 1306.28,
      "Time_End": 1312.52,
      "Text": " events that generate will show client side and server side host names and potentially"
    },
    {
      "Time_Start": 1312.52,
      "Time_End": 1316.32,
      "Text": " the interesting process name that the file dropped from."
    },
    {
      "Time_Start": 1316.32,
      "Time_End": 1322.56,
      "Text": " If we don't have a primary key with an agent like sysmon, then we can create one by pulling"
    },
    {
      "Time_Start": 1322.56,
      "Time_End": 1327.8799999999999,
      "Text": " the server side host from the folder path and join that with the process create events"
    },
    {
      "Time_Start": 1327.8799999999999,
      "Time_End": 1330.6399999999999,
      "Text": " on the server side host."
    },
    {
      "Time_Start": 1330.6399999999999,
      "Time_End": 1335.3999999999999,
      "Text": " We can now correlate this with network events over port 135."
    },
    {
      "Time_Start": 1335.4,
      "Time_End": 1339.88,
      "Text": " Then we can pull client side process events to join with the server side events we gathered"
    },
    {
      "Time_Start": 1339.88,
      "Time_End": 1340.88,
      "Text": " above."
    },
    {
      "Time_Start": 1340.88,
      "Time_End": 1345.0400000000002,
      "Text": " We only want to pull process events within a short time span of the server side file"
    },
    {
      "Time_Start": 1345.0400000000002,
      "Time_End": 1346.8000000000002,
      "Text": " create event."
    },
    {
      "Time_Start": 1346.8000000000002,
      "Time_End": 1351.42,
      "Text": " This is because the process copies the service over relatively quick, and once it's executed"
    },
    {
      "Time_Start": 1351.42,
      "Time_End": 1356.2,
      "Text": " from the client, the file create happens shortly after."
    },
    {
      "Time_Start": 1356.2,
      "Time_End": 1360.1200000000001,
      "Text": " So here we summarize our strategy and begin testing the detection logic."
    },
    {
      "Time_Start": 1360.1200000000001,
      "Time_End": 1364.8000000000002,
      "Text": " There are some other things that were identified throughout the research regarding opportunities"
    },
    {
      "Time_Start": 1364.8,
      "Time_End": 1366.48,
      "Text": " for prevention."
    },
    {
      "Time_Start": 1366.48,
      "Time_End": 1367.9199999999998,
      "Text": " Let's take a look at that."
    },
    {
      "Time_Start": 1367.9199999999998,
      "Time_End": 1372.72,
      "Text": " I like to take a look at prevention considerations when I'm detection engineering."
    },
    {
      "Time_Start": 1372.72,
      "Time_End": 1376.44,
      "Text": " Sometimes I get a little distracted with a detection and get so focused on the detection"
    },
    {
      "Time_Start": 1376.44,
      "Time_End": 1382.52,
      "Text": " aspect and how I can get the most optimal or most robust alert in place for our SOC"
    },
    {
      "Time_Start": 1382.52,
      "Time_End": 1384.56,
      "Text": " to start responding to."
    },
    {
      "Time_Start": 1384.56,
      "Time_End": 1389.48,
      "Text": " So I do like to take a step back in building a detection strategy or an alerting and detection"
    },
    {
      "Time_Start": 1389.48,
      "Time_End": 1393.8799999999999,
      "Text": " strategy and document the prevention considerations."
    },
    {
      "Time_Start": 1393.96,
      "Time_End": 1398.7600000000002,
      "Text": " Within the research, we can identify certain things about a technology that will help us"
    },
    {
      "Time_Start": 1398.7600000000002,
      "Time_End": 1403.24,
      "Text": " mitigate any risk associated or at least some of the risks, right?"
    },
    {
      "Time_Start": 1403.24,
      "Time_End": 1409.4,
      "Text": " And so what we can do here in this case when we identify scenarios is build our detections,"
    },
    {
      "Time_Start": 1409.4,
      "Time_End": 1415.64,
      "Text": " but also add the control recommendations to a backlog so we don't lose sight of a prevention"
    },
    {
      "Time_Start": 1415.64,
      "Time_End": 1418.1200000000001,
      "Text": " implementation."
    },
    {
      "Time_Start": 1418.1200000000001,
      "Time_End": 1422.72,
      "Text": " And then we can document the prevention recommendations in our research."
    },
    {
      "Time_Start": 1422.72,
      "Time_End": 1427.64,
      "Text": " And that way, when we circle back on why or what we're trying to mitigate, we don't"
    },
    {
      "Time_Start": 1427.64,
      "Time_End": 1433.32,
      "Text": " have to redo the research or have another person spend more time on things we've already"
    },
    {
      "Time_Start": 1433.32,
      "Time_End": 1438.3600000000001,
      "Text": " learned and can recommend from the technology information."
    },
    {
      "Time_Start": 1438.3600000000001,
      "Time_End": 1442.16,
      "Text": " So while we were doing our research, we identified from MITRE and other sources like the RPC"
    },
    {
      "Time_Start": 1442.16,
      "Time_End": 1448.68,
      "Text": " documentation and researchers that RPC is endpoint to endpoint and is not required for"
    },
    {
      "Time_Start": 1448.68,
      "Time_End": 1450.96,
      "Text": " Windows to function."
    },
    {
      "Time_Start": 1451.0,
      "Time_End": 1454.52,
      "Text": " So we can say this is a great prevention mechanism against PS exec or other similar lateral"
    },
    {
      "Time_Start": 1454.52,
      "Time_End": 1456.52,
      "Text": " movement."
    },
    {
      "Time_Start": 1456.52,
      "Time_End": 1460.28,
      "Text": " If we can implement firewall controls or disable the functionality of the communication"
    },
    {
      "Time_Start": 1460.28,
      "Time_End": 1465.44,
      "Text": " between workstations over port 135, we jump way ahead on this technique."
    },
    {
      "Time_Start": 1465.44,
      "Time_End": 1468.96,
      "Text": " We also noted that SMB was required for this to occur."
    },
    {
      "Time_Start": 1468.96,
      "Time_End": 1474.3600000000001,
      "Text": " And so port 445 is also not required for Windows to function between endpoints."
    },
    {
      "Time_Start": 1474.3600000000001,
      "Time_End": 1477.76,
      "Text": " So we could also implement that as part of our firewall controls."
    },
    {
      "Time_Start": 1477.84,
      "Time_End": 1483.36,
      "Text": " If system administration is a pushback for controls or prevention considerations, we"
    },
    {
      "Time_Start": 1483.36,
      "Time_End": 1490.12,
      "Text": " can recommend to use WinRM here, WMI, or PS remoting for system administration."
    },
    {
      "Time_Start": 1490.12,
      "Time_End": 1494.64,
      "Text": " This provides a much more secure method for remote connections and doesn't pass user credentials"
    },
    {
      "Time_Start": 1494.64,
      "Time_End": 1496.2,
      "Text": " over the environment."
    },
    {
      "Time_Start": 1496.2,
      "Time_End": 1499.64,
      "Text": " We can also audit our admin share policies."
    },
    {
      "Time_Start": 1499.64,
      "Time_End": 1503.16,
      "Text": " Do these shares really need to be enabled on all hosts?"
    },
    {
      "Time_Start": 1503.16,
      "Time_End": 1504.96,
      "Text": " Who has access to these shares?"
    },
    {
      "Time_Start": 1504.96,
      "Time_End": 1507.2,
      "Text": " Is it just the local admin?"
    },
    {
      "Time_Start": 1507.2,
      "Time_End": 1509.0,
      "Text": " Is it a specified domain user?"
    },
    {
      "Time_Start": 1509.0,
      "Time_End": 1511.16,
      "Text": " Is it an authorized domain user?"
    },
    {
      "Time_Start": 1511.16,
      "Time_End": 1512.76,
      "Text": " Is it everyone?"
    },
    {
      "Time_Start": 1512.76,
      "Time_End": 1517.0,
      "Text": " So these are some things that we ask when we go through and see who has access to these"
    },
    {
      "Time_Start": 1517.0,
      "Time_End": 1519.0,
      "Text": " admin shares."
    },
    {
      "Time_Start": 1519.0,
      "Time_End": 1522.96,
      "Text": " We want to ensure that we are implementing least privilege across the environment for"
    },
    {
      "Time_Start": 1522.96,
      "Time_End": 1525.56,
      "Text": " admin shares, especially on workstations."
    },
    {
      "Time_Start": 1525.56,
      "Time_End": 1526.56,
      "Text": " Okay."
    },
    {
      "Time_Start": 1526.56,
      "Time_End": 1530.0,
      "Text": " So we have filled out the rest of our strategy and we have walked through defining our goals"
    },
    {
      "Time_Start": 1530.0,
      "Time_End": 1534.76,
      "Text": " and exploring the underlying technology to developing strategy for detection, as well"
    },
    {
      "Time_Start": 1534.76,
      "Time_End": 1537.96,
      "Text": " as some prevention recommendations."
    },
    {
      "Time_Start": 1537.96,
      "Time_End": 1541.4,
      "Text": " I really hope this has helped you get started on the next hunt, but more specifically helped"
    },
    {
      "Time_Start": 1541.4,
      "Time_End": 1545.92,
      "Text": " you see some of the importance of researching the underlying technology."
    },
    {
      "Time_Start": 1545.92,
      "Time_End": 1550.0,
      "Text": " I think there's a lot more research left on the table for PS exec as well, like digging"
    },
    {
      "Time_Start": 1550.0,
      "Time_End": 1555.52,
      "Text": " into Windows API and RPC will probably open up an opportunity for more detections and"
    },
    {
      "Time_Start": 1555.52,
      "Time_End": 1561.44,
      "Text": " maybe a new log source identified in ETW, but that's maybe for another talk."
    },
    {
      "Time_Start": 1561.44,
      "Time_End": 1566.6000000000001,
      "Text": " I document here some resources and references that I use throughout this talk."
    },
    {
      "Time_Start": 1566.6000000000001,
      "Time_End": 1571.2,
      "Text": " I also provide some tools and projects that I used in my lab environment to help get started"
    },
    {
      "Time_Start": 1571.2,
      "Time_End": 1575.3600000000001,
      "Text": " on your own lab environment to do these validation tests."
    },
    {
      "Time_Start": 1575.3600000000001,
      "Time_End": 1578.48,
      "Text": " I really appreciate you taking the time to listen to me talk."
    },
    {
      "Time_Start": 1578.48,
      "Time_End": 1583.52,
      "Text": " I really hope you got something out of this talk from the methodology that I followed"
    },
    {
      "Time_Start": 1583.52,
      "Time_End": 1589.8400000000001,
      "Text": " when trying to research and investigate PS exec and the lateral movement behavior."
    },
    {
      "Time_Start": 1589.8400000000001,
      "Time_End": 1596.0400000000002,
      "Text": " Hopefully this helps you get started on your next hunt and what you can do to help understand"
    },
    {
      "Time_Start": 1596.0400000000002,
      "Time_End": 1599.3200000000002,
      "Text": " the underlying technology that you are about to build detections for."
    }
  ]
}