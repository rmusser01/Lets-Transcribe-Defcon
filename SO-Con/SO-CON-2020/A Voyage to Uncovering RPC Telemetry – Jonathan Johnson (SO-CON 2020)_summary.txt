- **Introduction**: Jonathan Johnson, an associate consultant at Specter Ops, presents his year-long research project on Remote Procedure Calls (RPC) and its significance in Windows Operating Systems. He acknowledges the contributions of his colleagues and other researchers in the field.
- **Understanding RPC**: RPC enables distributed client-server communication and is prevalent in Windows environments for tasks like authentication, directory replication, and service creation. It involves RPC protocols/services, interfaces, clients, and servers.
- **RPC Components**: RPC protocols act as services, with code stored in EXE, SYS, and DLL binaries. RPC interfaces serve as bridges, defined by Microsoft Interface Definition Language (MIDL) files with unique identifiers. RPC clients interact with interfaces via Win32 APIs, baked-in IDL code, or direct communication. RPC methods are functions with operation numbers, invoked by clients passing serialized parameters.
- **RPC Process**: Client stub serializes method parameters, and NDR engine transports data via RPC runtime. Endpoint mapper directs client-server communication, and server stub deserializes parameters before invoking methods.
- **RPC Telemetry**: Johnson identifies attacker interaction methods with RPC interfaces and focuses on server code as a pivot point. He uses DC Sync, a technique to capture credentials by impersonating a domain controller, as a use case.
- **Research Process**: Johnson identifies the UUID, server code, endpoint, and methods for DC Sync's DRSU API interface. He employs tools like NT Object Manager, ProcMon, ETW, and Wireshark to gather information.
- **Scaling Research Telemetry**: Johnson converts research data into scalable telemetry, leveraging Zeek and Windows Filtering Platform events. He creates analytics using Sysmon events and network data to identify RPC client and server applications.
- **Final Thoughts**: Johnson emphasizes the importance of his research methodology for uncovering insights and data leverage points for detection engineers. He encourages a thoughtful approach to data scaling, focusing on targeted collection rather than amassing all logs.