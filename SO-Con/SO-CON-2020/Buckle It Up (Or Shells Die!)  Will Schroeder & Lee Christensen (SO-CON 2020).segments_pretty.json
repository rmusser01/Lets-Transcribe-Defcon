{
  "segments": [
    {
      "Time_Start": 0.0,
      "Time_End": 19.72,
      "Text": "This text was transcribed using whisper model: large-v2\n\n Hi, this is Buckle It Up or Shells Die."
    },
    {
      "Time_Start": 19.72,
      "Time_End": 20.96,
      "Text": " My name is Will Schroeder."
    },
    {
      "Time_Start": 20.96,
      "Time_End": 23.900000000000002,
      "Text": " My handle is Harmjoy on Twitter and GitHub."
    },
    {
      "Time_Start": 23.900000000000002,
      "Time_End": 28.080000000000002,
      "Text": " I'm a technical architect here at SpectreOps along with my co-worker Lee here."
    },
    {
      "Time_Start": 28.560000000000002,
      "Time_End": 31.32,
      "Text": " I've written a lot of code over the years, mostly offensive stuff."
    },
    {
      "Time_Start": 31.32,
      "Time_End": 34.64,
      "Text": " So I was one of the founding members of the Vail framework,"
    },
    {
      "Time_Start": 34.64,
      "Time_End": 38.040000000000006,
      "Text": " the Empire project, rest in peace, PowerView and PowerUp,"
    },
    {
      "Time_Start": 38.040000000000006,
      "Time_End": 41.96,
      "Text": " also rest in peace, I guess, the Bloodhound graph analysis project,"
    },
    {
      "Time_Start": 41.96,
      "Time_End": 45.760000000000005,
      "Text": " and more recently over the past few years, Ghostpack, which includes Seatbelt,"
    },
    {
      "Time_Start": 45.760000000000005,
      "Time_End": 48.040000000000006,
      "Text": " which will be the highlight of this presentation."
    },
    {
      "Time_Start": 48.040000000000006,
      "Time_End": 52.040000000000006,
      "Text": " I've talked to a lot of conferences, DerbyCon, which used to be my favorite"
    },
    {
      "Time_Start": 52.040000000000006,
      "Time_End": 55.6,
      "Text": " until it stopped going last year, Black Hat, DEFCON, Troopers,"
    },
    {
      "Time_Start": 55.6,
      "Time_End": 57.400000000000006,
      "Text": " a whole bunch of others."
    },
    {
      "Time_Start": 57.4,
      "Time_End": 59.48,
      "Text": " I'm also a veteran trainer."
    },
    {
      "Time_Start": 59.48,
      "Time_End": 62.16,
      "Text": " So I teach the Adversary Tactics Red Team Operations course."
    },
    {
      "Time_Start": 62.16,
      "Time_End": 65.28,
      "Text": " I helped write our PowerShell course that was retired last year."
    },
    {
      "Time_Start": 65.28,
      "Time_End": 70.92,
      "Text": " And I sometimes blog at blog.harmjoy.net."
    },
    {
      "Time_Start": 70.92,
      "Time_End": 72.92,
      "Text": " Hi, my name is Lee Christensen."
    },
    {
      "Time_Start": 72.92,
      "Time_End": 75.96,
      "Text": " I'm also a technical architect here at SpectreOps."
    },
    {
      "Time_Start": 75.96,
      "Time_End": 80.92,
      "Text": " In terms of codes and my interests, I wrote Seatbelt, which this talk is about."
    },
    {
      "Time_Start": 80.92,
      "Time_End": 84.92,
      "Text": " Some other tools that have been incorporated into other tools and"
    },
    {
      "Time_Start": 84.96000000000001,
      "Time_End": 88.28,
      "Text": " frameworks are SpoolSample and Unmanaged PowerShell."
    },
    {
      "Time_Start": 88.28,
      "Time_End": 92.28,
      "Text": " In general, I just love Windows and Windows internals, Active Directory,"
    },
    {
      "Time_Start": 92.28,
      "Time_End": 97.24000000000001,
      "Text": " PowerShell, and just attacking new enterprise tech that we see as we do"
    },
    {
      "Time_Start": 97.24000000000001,
      "Time_End": 97.96000000000001,
      "Text": " engagements."
    },
    {
      "Time_Start": 97.96000000000001,
      "Time_End": 102.4,
      "Text": " I just enjoy discovering new ways to attack organizations."
    },
    {
      "Time_Start": 102.4,
      "Time_End": 107.08,
      "Text": " I've also spoken at a lot of cons, DerbyCon, Black Hat, et cetera."
    },
    {
      "Time_Start": 107.08,
      "Time_End": 108.44,
      "Text": " I've also done a bunch of training."
    },
    {
      "Time_Start": 108.44,
      "Time_End": 112.48,
      "Text": " I help out with our Adversary Tactics Red Team Operations class,"
    },
    {
      "Time_Start": 112.48,
      "Time_End": 115.96000000000001,
      "Text": " as well as our new course, the Adversary Tactics Vulnerability"
    },
    {
      "Time_Start": 115.96000000000001,
      "Time_End": 117.76,
      "Text": " Research for Operators."
    },
    {
      "Time_Start": 117.76,
      "Time_End": 122.2,
      "Text": " I rarely blog at that medium link right there."
    },
    {
      "Time_Start": 122.2,
      "Time_End": 126.08,
      "Text": " This presentation is all about host-based situational awareness."
    },
    {
      "Time_Start": 126.08,
      "Time_End": 129.08,
      "Text": " We're going to go over what it is, why we believe it matters,"
    },
    {
      "Time_Start": 129.08,
      "Time_End": 130.96,
      "Text": " and how you can use it."
    },
    {
      "Time_Start": 130.96,
      "Time_End": 133.12,
      "Text": " We're going to cover data collection with Seatbelt,"
    },
    {
      "Time_Start": 133.12,
      "Time_End": 136.52,
      "Text": " which is the C-sharp tool, part of the Ghostpack project"
    },
    {
      "Time_Start": 136.52,
      "Time_End": 139.76,
      "Text": " that I mentioned previously."
    },
    {
      "Time_Start": 139.76,
      "Time_End": 142.95999999999998,
      "Text": " We're going to also see how host-based situational awareness ties"
    },
    {
      "Time_Start": 142.95999999999998,
      "Time_End": 145.0,
      "Text": " into different parts of the attack cycle,"
    },
    {
      "Time_Start": 145.0,
      "Time_End": 147.79999999999998,
      "Text": " from initial access, lateral movement, strategic hunting,"
    },
    {
      "Time_Start": 147.79999999999998,
      "Time_End": 149.79999999999998,
      "Text": " things like that."
    },
    {
      "Time_Start": 149.79999999999998,
      "Time_End": 152.64,
      "Text": " Within this, we're going to cover a few different topic areas."
    },
    {
      "Time_Start": 152.64,
      "Time_End": 155.44,
      "Text": " First and foremost is going to be defensive enumeration,"
    },
    {
      "Time_Start": 155.44,
      "Time_End": 158.16,
      "Text": " what defenses are there, where are the configurations."
    },
    {
      "Time_Start": 158.16,
      "Time_End": 161.2,
      "Text": " We're also going to cover exploitation and vulnerability research target"
    },
    {
      "Time_Start": 161.2,
      "Time_End": 165.12,
      "Text": " selection, which we'll go into more detail here in a bit."
    },
    {
      "Time_Start": 165.12,
      "Time_End": 168.04,
      "Text": " Some stuff on credential theft, which is always fun."
    },
    {
      "Time_Start": 168.04,
      "Time_End": 171.2,
      "Text": " User and system behavioral baselining."
    },
    {
      "Time_Start": 171.2,
      "Time_End": 174.35999999999999,
      "Text": " And finally, we're going to wrap everything up with technique selection."
    },
    {
      "Time_Start": 174.35999999999999,
      "Time_End": 178.07999999999998,
      "Text": " So given a particular phase of the attack cycle or something you want to do,"
    },
    {
      "Time_Start": 178.07999999999998,
      "Time_End": 182.35999999999999,
      "Text": " how does this situational awareness data affect your decision tree"
    },
    {
      "Time_Start": 182.35999999999999,
      "Time_End": 185.16,
      "Text": " and what you're actually going to do on post?"
    },
    {
      "Time_Start": 185.16,
      "Time_End": 190.44,
      "Text": " And we'll have a nice little kind of final walkthrough for that as well."
    },
    {
      "Time_Start": 190.44,
      "Time_End": 192.95999999999998,
      "Text": " Cool. So host-based situational awareness."
    },
    {
      "Time_Start": 192.95999999999998,
      "Time_End": 194.0,
      "Text": " Why does it matter?"
    },
    {
      "Time_Start": 194.0,
      "Time_End": 195.2,
      "Text": " What is it?"
    },
    {
      "Time_Start": 195.2,
      "Time_End": 196.68,
      "Text": " We're going to dive into this."
    },
    {
      "Time_Start": 196.68,
      "Time_End": 200.0,
      "Text": " So host-based situational awareness, what is it?"
    },
    {
      "Time_Start": 200.0,
      "Time_End": 203.96,
      "Text": " Well, host-based situational awareness is trying to perceive and gain"
    },
    {
      "Time_Start": 203.96,
      "Time_End": 208.76000000000002,
      "Text": " an understanding of everything that's going on around you in the environment."
    },
    {
      "Time_Start": 208.76000000000002,
      "Time_End": 212.16,
      "Text": " And in the case of host-based situational awareness,"
    },
    {
      "Time_Start": 212.16,
      "Time_End": 215.4,
      "Text": " we're only going to be using artifacts that we're collecting"
    },
    {
      "Time_Start": 215.4,
      "Time_End": 217.28,
      "Text": " from the host that we're on."
    },
    {
      "Time_Start": 217.28,
      "Time_End": 219.88,
      "Text": " So there's different ways that you can do situational awareness."
    },
    {
      "Time_Start": 219.88,
      "Time_End": 221.48000000000002,
      "Text": " There's network situational awareness."
    },
    {
      "Time_Start": 221.48000000000002,
      "Time_End": 223.08,
      "Text": " There's things like OSINT."
    },
    {
      "Time_Start": 223.08,
      "Time_End": 225.72,
      "Text": " In this case, we're specifically using data"
    },
    {
      "Time_Start": 225.72,
      "Time_End": 229.96,
      "Text": " that we're obtaining from the host machine that we've compromised."
    },
    {
      "Time_Start": 229.96,
      "Time_End": 235.6,
      "Text": " Why this is so important is because as we collect data during an op,"
    },
    {
      "Time_Start": 235.6,
      "Time_End": 238.04,
      "Text": " this should be influencing the TTPs,"
    },
    {
      "Time_Start": 238.04,
      "Time_End": 241.52,
      "Text": " the different techniques that we're using throughout the engagement."
    },
    {
      "Time_Start": 241.52,
      "Time_End": 245.68,
      "Text": " So as we enumerate data, we learn more about the environment,"
    },
    {
      "Time_Start": 245.68,
      "Time_End": 248.28,
      "Text": " what's there, what we can interact with,"
    },
    {
      "Time_Start": 248.28,
      "Time_End": 251.0,
      "Text": " and this should be guiding us as operators"
    },
    {
      "Time_Start": 251.0,
      "Time_End": 254.48,
      "Text": " into how we're acting inside of the environment."
    },
    {
      "Time_Start": 254.48000000000002,
      "Time_End": 258.12,
      "Text": " And for us, doing this host-based situational awareness"
    },
    {
      "Time_Start": 258.12,
      "Time_End": 261.64000000000004,
      "Text": " is one of, I'd say, one of our greatest sources of data"
    },
    {
      "Time_Start": 261.64000000000004,
      "Time_End": 266.44,
      "Text": " that influences the techniques that we use and select"
    },
    {
      "Time_Start": 266.44,
      "Time_End": 270.76,
      "Text": " on our operations during assessments."
    },
    {
      "Time_Start": 270.76,
      "Time_End": 273.92,
      "Text": " What kind of things does situational awareness let us know about?"
    },
    {
      "Time_Start": 273.92,
      "Time_End": 277.28000000000003,
      "Text": " Well, for one, it lets us know about capabilities."
    },
    {
      "Time_Start": 277.28000000000003,
      "Time_End": 280.8,
      "Text": " So what can we even do in the environment that we're in?"
    },
    {
      "Time_Start": 280.8,
      "Time_End": 282.6,
      "Text": " Like, what is possible?"
    },
    {
      "Time_Start": 282.6,
      "Time_End": 284.96000000000004,
      "Text": " So this is just giving us an understanding of, like,"
    },
    {
      "Time_Start": 284.96000000000004,
      "Time_End": 287.48,
      "Text": " this is what's in the environment,"
    },
    {
      "Time_Start": 287.48,
      "Time_End": 292.08000000000004,
      "Text": " and it's at our hands, and we could use it if we wanted to."
    },
    {
      "Time_Start": 292.08000000000004,
      "Time_End": 294.04,
      "Text": " And then it also informs us strategically."
    },
    {
      "Time_Start": 294.04,
      "Time_End": 296.8,
      "Text": " So now that we know what's possible,"
    },
    {
      "Time_Start": 296.8,
      "Time_End": 298.76000000000005,
      "Text": " because we know what's in the environment,"
    },
    {
      "Time_Start": 298.76000000000005,
      "Time_End": 304.12,
      "Text": " this is going to help inform us the next step that we want to take,"
    },
    {
      "Time_Start": 304.12,
      "Time_End": 306.96000000000004,
      "Text": " and also how we're going to perform that step."
    },
    {
      "Time_Start": 306.96000000000004,
      "Time_End": 309.32000000000005,
      "Text": " Part of this is doing target selection."
    },
    {
      "Time_Start": 309.32000000000005,
      "Time_End": 312.24,
      "Text": " So maybe what's the next machine that we want to target?"
    },
    {
      "Time_Start": 312.24,
      "Time_End": 314.04,
      "Text": " And then once we target that machine,"
    },
    {
      "Time_Start": 314.04,
      "Time_End": 316.48,
      "Text": " how are we going to actually gain access to it?"
    },
    {
      "Time_Start": 316.48,
      "Time_End": 318.84000000000003,
      "Text": " What lateral movement technique do we want to use?"
    },
    {
      "Time_Start": 318.84000000000003,
      "Time_End": 322.52,
      "Text": " How do we want to, or do we just want to compromise that machine instead?"
    },
    {
      "Time_Start": 322.52,
      "Time_End": 326.92,
      "Text": " So host-based situational awareness is going to influence"
    },
    {
      "Time_Start": 326.92,
      "Time_End": 332.40000000000003,
      "Text": " what strategy we're going to take as we move throughout an organization as well."
    },
    {
      "Time_Start": 332.40000000000003,
      "Time_End": 336.40000000000003,
      "Text": " We're big proponents of using data to guide our ops."
    },
    {
      "Time_Start": 336.40000000000003,
      "Time_End": 339.48,
      "Text": " One of my favorite sayings is just any action you,"
    },
    {
      "Time_Start": 339.52000000000004,
      "Time_End": 343.8,
      "Text": " any action that we perform in an environment is a detectable risk."
    },
    {
      "Time_Start": 343.8,
      "Time_End": 348.0,
      "Text": " So that means, you know, we're a foreign entity in this environment."
    },
    {
      "Time_Start": 348.0,
      "Time_End": 352.6,
      "Text": " We are abnormal, and so therefore there is a risk that we're going to be detected."
    },
    {
      "Time_Start": 352.6,
      "Time_End": 357.28000000000003,
      "Text": " And one of my favorite sayings is everything is stealthy until someone is looking for it."
    },
    {
      "Time_Start": 357.28000000000003,
      "Time_End": 361.76,
      "Text": " If we can kind of gain an understanding of what people are looking for"
    },
    {
      "Time_Start": 361.76,
      "Time_End": 365.76,
      "Text": " and aren't looking for, this will help us remain evasive."
    },
    {
      "Time_Start": 365.76,
      "Time_End": 369.64,
      "Text": " And part of this too is understanding what they can even see."
    },
    {
      "Time_Start": 369.64,
      "Time_End": 372.52,
      "Text": " So if they can't see us, if they don't have telemetry"
    },
    {
      "Time_Start": 372.52,
      "Time_End": 374.8,
      "Text": " or if they don't have certain audit settings enabled,"
    },
    {
      "Time_Start": 374.8,
      "Time_End": 379.44,
      "Text": " we can remain outside of the defender's visibility and remain stealthy."
    },
    {
      "Time_Start": 379.44,
      "Time_End": 383.92,
      "Text": " A big part of this too is understanding your risk tolerance for detection."
    },
    {
      "Time_Start": 383.92,
      "Time_End": 386.8,
      "Text": " What this comes down to really is, you know, how,"
    },
    {
      "Time_Start": 386.8,
      "Time_End": 390.36,
      "Text": " what is our tolerance in terms of getting detected by the defenders?"
    },
    {
      "Time_Start": 390.36,
      "Time_End": 393.64,
      "Text": " And this is ultimately going to be determined by a few factors."
    },
    {
      "Time_Start": 393.64,
      "Time_End": 396.08,
      "Text": " One of them is the assessment training objective."
    },
    {
      "Time_Start": 396.08,
      "Time_End": 401.47999999999996,
      "Text": " So maybe part of our training objectives during a red team is to get caught."
    },
    {
      "Time_Start": 401.47999999999996,
      "Time_End": 405.44,
      "Text": " Or maybe we want to emulate a specific threat actor"
    },
    {
      "Time_Start": 405.44,
      "Time_End": 409.4,
      "Text": " and we don't really care about trying to evade."
    },
    {
      "Time_Start": 409.4,
      "Time_End": 413.24,
      "Text": " We want to select those specific TTPs that that actor is using."
    },
    {
      "Time_Start": 413.24,
      "Time_End": 418.64,
      "Text": " Another thing that will influence our risk tolerance for detection is our attack strategy."
    },
    {
      "Time_Start": 418.64,
      "Time_End": 421.84,
      "Text": " Probably the most common attack strategy is low and slow."
    },
    {
      "Time_Start": 421.88000000000005,
      "Time_End": 425.04,
      "Text": " So you're trying to remain evasive, trying, you know,"
    },
    {
      "Time_Start": 425.04,
      "Time_End": 428.76000000000005,
      "Text": " not going interactive or making a lot of noise on the network."
    },
    {
      "Time_Start": 428.76000000000005,
      "Time_End": 433.36,
      "Text": " Well, that is completely valid, but smash and grab is just as equally valid."
    },
    {
      "Time_Start": 433.36,
      "Time_End": 438.48,
      "Text": " You could compromise a machine and immediately start siphoning off data,"
    },
    {
      "Time_Start": 438.48,
      "Time_End": 442.52000000000004,
      "Text": " or you could be like ransomware and just start encrypting everything inside of the environment"
    },
    {
      "Time_Start": 442.52000000000004,
      "Time_End": 444.76000000000005,
      "Text": " and trying to spread as fast as you can."
    },
    {
      "Time_Start": 444.76000000000005,
      "Time_End": 447.92,
      "Text": " And that's just as equally as effective attack strategy,"
    },
    {
      "Time_Start": 447.92,
      "Time_End": 452.24,
      "Text": " depending on ultimately on what your goal is when you compromise a machine."
    },
    {
      "Time_Start": 452.24,
      "Time_End": 456.72,
      "Text": " Why we like to point this out is because what we like to term enlightened actors,"
    },
    {
      "Time_Start": 456.72,
      "Time_End": 459.32,
      "Text": " this kind of fictitious being out there,"
    },
    {
      "Time_Start": 459.32,
      "Time_End": 464.48,
      "Text": " they understand the impact of their actions that they're performing."
    },
    {
      "Time_Start": 464.48,
      "Time_End": 468.0,
      "Text": " And when they perform these actions, they're making a decision,"
    },
    {
      "Time_Start": 468.0,
      "Time_End": 472.08000000000004,
      "Text": " a risk-based decision before they make it perform an action."
    },
    {
      "Time_Start": 472.08000000000004,
      "Time_End": 475.12,
      "Text": " And this is largely to prevent detection."
    },
    {
      "Time_Start": 475.16,
      "Time_End": 479.04,
      "Text": " Why use a certain technique at all if it's going to get you detected?"
    },
    {
      "Time_Start": 479.04,
      "Time_End": 480.6,
      "Text": " A good example is like MimiCats."
    },
    {
      "Time_Start": 480.6,
      "Time_End": 486.68,
      "Text": " Why use MimiCats if there's a risk of just running the tool that's going to get you detected?"
    },
    {
      "Time_Start": 486.68,
      "Time_End": 491.6,
      "Text": " So understanding like these enlightened actors are, before they use a technique,"
    },
    {
      "Time_Start": 491.6,
      "Time_End": 495.24,
      "Text": " they're going to calculate a risk associated with it."
    },
    {
      "Time_Start": 495.24,
      "Time_End": 498.88,
      "Text": " In order to calculate this risk, you need to first collect some data"
    },
    {
      "Time_Start": 498.88,
      "Time_End": 501.6,
      "Text": " so that you can make decisions based off of that data."
    },
    {
      "Time_Start": 501.6,
      "Time_End": 505.8,
      "Text": " Then you're going to calculate that risk and then finally act accordingly."
    },
    {
      "Time_Start": 508.8,
      "Time_End": 514.44,
      "Text": " So a good example of this, like I mentioned, MimiCats is a very prime example."
    },
    {
      "Time_Start": 514.44,
      "Time_End": 518.5600000000001,
      "Text": " One of the first things that we often see, so in our Red Team training class,"
    },
    {
      "Time_Start": 518.5600000000001,
      "Time_End": 523.12,
      "Text": " is people, when they compromise a host and escalate to system privileges,"
    },
    {
      "Time_Start": 523.12,
      "Time_End": 527.2,
      "Text": " one of the first things that they'll do is try and run secure LSA logon passwords,"
    },
    {
      "Time_Start": 527.2,
      "Time_End": 529.9200000000001,
      "Text": " the most infamous command of MimiCats."
    },
    {
      "Time_Start": 529.92,
      "Time_End": 532.92,
      "Text": " And this is to try and obtain the credentials on the machine."
    },
    {
      "Time_Start": 532.92,
      "Time_End": 535.76,
      "Text": " So why do people do that?"
    },
    {
      "Time_Start": 535.76,
      "Time_End": 537.68,
      "Text": " Oftentimes, it's just instinct."
    },
    {
      "Time_Start": 537.68,
      "Time_End": 543.28,
      "Text": " And so something that we try and emphasize is don't perform actions without thinking."
    },
    {
      "Time_Start": 543.28,
      "Time_End": 548.8399999999999,
      "Text": " Something to keep in mind is, you know, is it even worth it to perform that credential extraction?"
    },
    {
      "Time_Start": 548.8399999999999,
      "Time_End": 551.16,
      "Text": " First of all, are we elevated on a machine?"
    },
    {
      "Time_Start": 551.16,
      "Time_End": 554.52,
      "Text": " Are we even going to be able to read like LSAS's memory?"
    },
    {
      "Time_Start": 554.52,
      "Time_End": 556.7199999999999,
      "Text": " Are there other users on the machine?"
    },
    {
      "Time_Start": 556.7199999999999,
      "Time_End": 559.8,
      "Text": " If we run that, we're not going to obtain other credentials."
    },
    {
      "Time_Start": 559.8000000000001,
      "Time_End": 562.6400000000001,
      "Text": " So if there's nobody else logged in, why even run this?"
    },
    {
      "Time_Start": 562.6400000000001,
      "Time_End": 567.4000000000001,
      "Text": " Alternatively, like is WDigest, if we're targeting plain text passwords,"
    },
    {
      "Time_Start": 567.4000000000001,
      "Time_End": 573.36,
      "Text": " if WDigest isn't enabled, then we won't be able to obtain the plain text passwords."
    },
    {
      "Time_Start": 573.36,
      "Time_End": 578.5600000000001,
      "Text": " Similarly, what other defenses are going to affect our extraction of credentials?"
    },
    {
      "Time_Start": 578.5600000000001,
      "Time_End": 584.6,
      "Text": " There may be EDR products on the machine that are going to prevent us from using MimiCats command here."
    },
    {
      "Time_Start": 584.6,
      "Time_End": 589.4000000000001,
      "Text": " Similarly, maybe there's a blind spot or there's a way that we can evade a certain defense"
    },
    {
      "Time_Start": 589.4,
      "Time_End": 591.68,
      "Text": " due to how the host is configured."
    },
    {
      "Time_Start": 591.68,
      "Time_End": 598.16,
      "Text": " A good example of this is like maybe run as PPL is enabled or CredGuard on the machine is enabled."
    },
    {
      "Time_Start": 598.16,
      "Time_End": 605.76,
      "Text": " These will prevent a user mode attacker from being able to dump LSAS's memory and obtain password."
    },
    {
      "Time_Start": 605.76,
      "Time_End": 608.92,
      "Text": " So like why even run MimiCats if those are enabled?"
    },
    {
      "Time_Start": 608.92,
      "Time_End": 615.48,
      "Text": " Similarly, this is going to influence how we run any code that we want to load onto this machine."
    },
    {
      "Time_Start": 615.52,
      "Time_End": 620.08,
      "Text": " So for example, there's a lot of tooling now written in C Sharp or even C."
    },
    {
      "Time_Start": 620.08,
      "Time_End": 627.6,
      "Text": " When we do our host situational awareness, that's going to influence maybe some of the evasive measures"
    },
    {
      "Time_Start": 627.6,
      "Time_End": 630.36,
      "Text": " that we need to put in place before we run those tools."
    },
    {
      "Time_Start": 630.36,
      "Time_End": 635.5600000000001,
      "Text": " So for example, with like PowerShell or C Sharp, maybe there's AMSI inspection"
    },
    {
      "Time_Start": 635.5600000000001,
      "Time_End": 639.6800000000001,
      "Text": " due to the certain version of PowerShell or C Sharp."
    },
    {
      "Time_Start": 640.6800000000001,
      "Time_End": 648.96,
      "Text": " Something else that host situational awareness influences is it's somewhat dependent on the attack phase that we're in."
    },
    {
      "Time_Start": 648.96,
      "Time_End": 654.8000000000001,
      "Text": " So for example, in our experience during initial access, this is one of our most fragile parts of an engagement."
    },
    {
      "Time_Start": 654.8000000000001,
      "Time_End": 660.96,
      "Text": " We first gain access to a network and we don't know how the computer is configured."
    },
    {
      "Time_Start": 660.96,
      "Time_End": 665.1200000000001,
      "Text": " We don't know if they've been tipped off that we've compromised a machine."
    },
    {
      "Time_Start": 665.12,
      "Time_End": 671.36,
      "Text": " And so our strategy tends to be is trying to collect as much data as we can from the host,"
    },
    {
      "Time_Start": 671.36,
      "Time_End": 676.8,
      "Text": " especially about the defensive tooling and the defensive configuration of the machine"
    },
    {
      "Time_Start": 676.8,
      "Time_End": 682.64,
      "Text": " so that even if we do get kicked out, a better roadmap of how we can re-compromise the network."
    },
    {
      "Time_Start": 682.64,
      "Time_End": 687.28,
      "Text": " Similarly, when you're doing things like lateral movement, a different phase of attack,"
    },
    {
      "Time_Start": 687.28,
      "Time_End": 691.28,
      "Text": " this same kind of data can be remotely enumerated."
    },
    {
      "Time_Start": 692.24,
      "Time_End": 699.12,
      "Text": " So maybe before we, I'd say we oftentimes in environments, we notice that hosts are configured differently."
    },
    {
      "Time_Start": 699.12,
      "Time_End": 708.72,
      "Text": " So the most simple example is workstations are often, often have different logging and tooling installed than server machines."
    },
    {
      "Time_Start": 708.72,
      "Time_End": 714.3199999999999,
      "Text": " And so before, maybe before we pivot to a server machine or any machine in the network,"
    },
    {
      "Time_Start": 714.4000000000001,
      "Time_End": 719.84,
      "Text": " we would want to remotely enumerate the tooling and the processes"
    },
    {
      "Time_Start": 719.84,
      "Time_End": 725.2800000000001,
      "Text": " and the defensive configuration of that remote machine before we load an agent there."
    },
    {
      "Time_Start": 725.2800000000001,
      "Time_End": 729.12,
      "Text": " Or maybe based off of that data, we don't want to go there anymore"
    },
    {
      "Time_Start": 729.12,
      "Time_End": 733.2,
      "Text": " because they have certain settings enabled or maybe certain EBR products."
    },
    {
      "Time_Start": 733.2,
      "Time_End": 739.44,
      "Text": " Another phase that we kind of get into during our assessments is what we like to call strategic hunting."
    },
    {
      "Time_Start": 739.44,
      "Time_End": 748.0,
      "Text": " It's a type of collection, and this is looking for specific data or objectives that will help us further our access in the network."
    },
    {
      "Time_Start": 748.0,
      "Time_End": 752.24,
      "Text": " So a good example of this is maybe looking for cookies for CloudPop,"
    },
    {
      "Time_Start": 752.24,
      "Time_End": 754.8000000000001,
      "Text": " maybe single sign-on cookies that we could steal,"
    },
    {
      "Time_Start": 754.8000000000001,
      "Time_End": 761.36,
      "Text": " and then we'd be able to log into websites as whatever IT administrator those cookies belong to."
    },
    {
      "Time_Start": 762.8800000000001,
      "Time_End": 768.0,
      "Text": " Cool. Now a little bit of weaponization with seatbelts."
    },
    {
      "Time_Start": 768.0,
      "Time_End": 774.16,
      "Text": " So the original goal for seatbelt, it really just started as a handful of these safety checks"
    },
    {
      "Time_Start": 774.16,
      "Time_End": 779.76,
      "Text": " that were built into a PowerShell script that Lee and also one of our co-workers Andrew Childs"
    },
    {
      "Time_Start": 779.76,
      "Time_End": 782.8,
      "Text": " worked on in the past. We kind of smashed all this stuff together."
    },
    {
      "Time_Start": 782.8,
      "Time_End": 786.24,
      "Text": " It was just bits and pieces that we would collect whenever we land on a host."
    },
    {
      "Time_Start": 786.8,
      "Time_End": 790.64,
      "Text": " So a few years ago, we started rewriting this to be C-sharp compatible."
    },
    {
      "Time_Start": 790.64,
      "Time_End": 794.64,
      "Text": " Since then, it is heavily expanded. We're at over 100 different commands,"
    },
    {
      "Time_Start": 794.64,
      "Time_End": 798.16,
      "Text": " and we really kind of want it to be a clearinghouse for any host-based artifacts"
    },
    {
      "Time_Start": 798.16,
      "Time_End": 802.56,
      "Text": " that might be interesting from a security perspective, so offensive or defensive."
    },
    {
      "Time_Start": 802.56,
      "Time_End": 806.16,
      "Text": " One thing to note is that it might seem like there's a lot of weird,"
    },
    {
      "Time_Start": 806.16,
      "Time_End": 810.88,
      "Text": " maybe sometimes esoteric modules, but all of these have been something we've used."
    },
    {
      "Time_Start": 810.88,
      "Time_End": 815.6,
      "Text": " Every single bit of data collected here has value to us, at least in some engagement."
    },
    {
      "Time_Start": 816.24,
      "Time_End": 817.84,
      "Text": " But we didn't just make these up to be cool."
    },
    {
      "Time_Start": 818.96,
      "Time_End": 824.3199999999999,
      "Text": " So the current goals of seatbelts. We want to identify data sources that are useful for an attacker,"
    },
    {
      "Time_Start": 824.96,
      "Time_End": 828.8000000000001,
      "Text": " identify these little pieces that maybe people weren't necessarily aware of or that you could"
    },
    {
      "Time_Start": 828.8000000000001,
      "Time_End": 833.2,
      "Text": " even collect. We also want to point out what's possible to collect and provide source code"
    },
    {
      "Time_Start": 833.2,
      "Time_End": 837.9200000000001,
      "Text": " examples in a centralized place. A lot of these things were scraped from different bits of stack"
    },
    {
      "Time_Start": 837.9200000000001,
      "Time_End": 841.7600000000001,
      "Text": " overflow and other projects and figuring things out from weird old forums. We want to have"
    },
    {
      "Time_Start": 841.7600000000001,
      "Time_End": 846.08,
      "Text": " everything centralized in one place, like how to get the DNS cache, how do I get these particular"
    },
    {
      "Time_Start": 846.08,
      "Time_End": 851.12,
      "Text": " event logs or whatever. We've also started doing data interpretation callouts."
    },
    {
      "Time_Start": 851.6,
      "Time_End": 857.04,
      "Text": " So there's a lot of data here, we know that, and we've started trying to build in processes that"
    },
    {
      "Time_Start": 857.04,
      "Time_End": 862.32,
      "Text": " will notify an operator of interesting artifacts, like is WDigest enabled, is PPL enabled,"
    },
    {
      "Time_Start": 862.32,
      "Time_End": 868.32,
      "Text": " or is UAC set in a particular setting in a way that prevents or allows a lot of movement with"
    },
    {
      "Time_Start": 868.32,
      "Time_End": 872.5600000000001,
      "Text": " local administrative accounts. Because again, this data is great, but it doesn't mean anything if we"
    },
    {
      "Time_Start": 872.5600000000001,
      "Time_End": 876.72,
      "Text": " don't know how to interpret or understand it. But admittedly, we have a huge amount of room"
    },
    {
      "Time_Start": 876.72,
      "Time_End": 880.88,
      "Text": " for improvement here. We're going to go into kind of maybe what we hope to do in the future"
    },
    {
      "Time_Start": 880.88,
      "Time_End": 885.12,
      "Text": " at the end if we have time. This is mostly just kind of for a reference because we're going to"
    },
    {
      "Time_Start": 885.12,
      "Time_End": 888.64,
      "Text": " publish this slide deck after the talk, but seatbelt has a lot of different collection"
    },
    {
      "Time_Start": 888.64,
      "Time_End": 894.24,
      "Text": " primitives because beyond what you're trying to collect and what it means, you also care about"
    },
    {
      "Time_Start": 894.24,
      "Time_End": 899.6,
      "Text": " how you're collecting it. So a lot of stuff, file reads and .NET event log stuff and all that,"
    },
    {
      "Time_Start": 899.6,
      "Time_End": 903.6,
      "Text": " isn't too crazy. The one thing that's kind of interesting is for remote registry reads,"
    },
    {
      "Time_Start": 903.6,
      "Time_End": 909.6800000000001,
      "Text": " we use the standard regprov provider over WMI. So we can actually read remote registry entries"
    },
    {
      "Time_Start": 909.6800000000001,
      "Time_End": 914.0,
      "Text": " without having the remote registry service enabled, which often isn't on desktops."
    },
    {
      "Time_Start": 914.72,
      "Time_End": 917.76,
      "Text": " And we're going to go over the local versus remote collection here in a sec."
    },
    {
      "Time_Start": 920.08,
      "Time_End": 926.32,
      "Text": " So modularity. So seatbelt was also built with modularity in mind, so making sure that we can"
    },
    {
      "Time_Start": 926.32,
      "Time_End": 932.24,
      "Text": " basically on the fly add new modules and do so without having to refactor or add a bunch of new"
    },
    {
      "Time_Start": 932.24,
      "Time_End": 938.32,
      "Text": " code. Similarly, because it is pretty modular, you can also remove functionality quite easily as"
    },
    {
      "Time_Start": 938.32,
      "Time_End": 943.76,
      "Text": " well. And why would you want to do this? Well, to reduce your footprint on the host, basically"
    },
    {
      "Time_Start": 943.76,
      "Time_End": 950.0,
      "Text": " making it less easy to detect you. You can remove modules or components of seatbelt to remain"
    },
    {
      "Time_Start": 950.0,
      "Time_End": 955.92,
      "Text": " evasive. Every command follows a basic template you can find in the repo at that template.cs."
    },
    {
      "Time_Start": 956.8000000000001,
      "Time_End": 961.9200000000001,
      "Text": " Just an example of what that looks like. You give a command name there. You can provide a"
    },
    {
      "Time_Start": 961.9200000000001,
      "Time_End": 967.2,
      "Text": " description. Seatbelt also has groups of commands, so we'll dive into that in just a little bit too."
    },
    {
      "Time_Start": 967.7600000000001,
      "Time_End": 972.72,
      "Text": " You specify whether or not it supports remote capabilities. So can I run this against a remote"
    },
    {
      "Time_Start": 972.72,
      "Time_End": 978.32,
      "Text": " machine? And then you fill out the actual implementation of the command. So they're"
    },
    {
      "Time_Start": 978.32,
      "Time_End": 983.5200000000001,
      "Text": " actually quite easy to implement. Several times on assessments, I've created new modules"
    },
    {
      "Time_Start": 984.0799999999999,
      "Time_End": 990.48,
      "Text": " on the fly to build out new capabilities. Like I mentioned, commands can be put into groups,"
    },
    {
      "Time_Start": 990.48,
      "Time_End": 996.8,
      "Text": " into one or more groups. So you can execute that with the dash group parameter, and then you just"
    },
    {
      "Time_Start": 996.8,
      "Time_End": 1002.64,
      "Text": " specify the group name. So for example, group equals all is going to execute everything. But"
    },
    {
      "Time_Start": 1002.64,
      "Time_End": 1007.4399999999999,
      "Text": " maybe if you just wanted to do some enumeration around like the Chromium-based products, so is"
    },
    {
      "Time_Start": 1007.44,
      "Time_End": 1013.44,
      "Text": " Chrome installed on the machine, or Brave, or then you can run the Chromium group, and it's"
    },
    {
      "Time_Start": 1013.44,
      "Time_End": 1018.5600000000001,
      "Text": " going to enumerate a bunch of information about Chrome-based applications. Similarly, if you want"
    },
    {
      "Time_Start": 1018.5600000000001,
      "Time_End": 1026.0800000000002,
      "Text": " to run all of the commands that can be ran remotely against a machine, then you do the remote group."
    },
    {
      "Time_Start": 1026.0800000000002,
      "Time_End": 1032.0,
      "Text": " So there's a bunch of different groups. They're all very useful. In addition to, like I mentioned,"
    },
    {
      "Time_Start": 1032.0,
      "Time_End": 1037.68,
      "Text": " you can run commands remotely. If you want to run an individual command or a group of commands"
    },
    {
      "Time_Start": 1037.68,
      "Time_End": 1042.72,
      "Text": " remotely, you specify the dash computer name parameter, and that's just going to give you"
    },
    {
      "Time_Start": 1042.72,
      "Time_End": 1048.24,
      "Text": " your target computer. When you run seatbelt without any arguments, it's going to display its help."
    },
    {
      "Time_Start": 1048.24,
      "Time_End": 1055.04,
      "Text": " And in that help, you can see what commands support remote collection by the plus sign next to"
    },
    {
      "Time_Start": 1055.04,
      "Time_End": 1060.56,
      "Text": " them. So the first entry there, you see Amzie providers. It has a plus off to the left of it,"
    },
    {
      "Time_Start": 1060.56,
      "Time_End": 1065.84,
      "Text": " and that's just indicating that you can perform remote enumeration with this command."
    },
    {
      "Time_Start": 1067.28,
      "Time_End": 1072.8799999999999,
      "Text": " Seatbelt commands also can have arguments. Most of them are in the source code and are not fully"
    },
    {
      "Time_Start": 1072.8799999999999,
      "Time_End": 1079.84,
      "Text": " documented. There's a global argument called dash fold. By default, we try and filter down"
    },
    {
      "Time_Start": 1080.3999999999999,
      "Time_End": 1088.48,
      "Text": " the output of modules to be the most useful and not print out superfluous or unnecessary data."
    },
    {
      "Time_Start": 1088.48,
      "Time_End": 1094.24,
      "Text": " And so the output is filtered by default. So if you want all of the output, the raw, but"
    },
    {
      "Time_Start": 1094.24,
      "Time_End": 1100.56,
      "Text": " use the dash full global argument. Example of this is with the logon events command. It takes"
    },
    {
      "Time_Start": 1100.56,
      "Time_End": 1107.52,
      "Text": " an argument that is saying we do logon events 60. That will return the login events for the past 60"
    },
    {
      "Time_Start": 1107.52,
      "Time_End": 1113.1200000000001,
      "Text": " days instead of its default of 10. Similarly, if you want to search the Windows search indexer,"
    },
    {
      "Time_Start": 1113.1200000000001,
      "Time_End": 1118.88,
      "Text": " you can specify a path as an argument. Likewise, you can output data to in different formats,"
    },
    {
      "Time_Start": 1118.88,
      "Time_End": 1124.0000000000002,
      "Text": " and this is also modular. So you can swap this out with your own custom serializer if you'd like."
    },
    {
      "Time_Start": 1124.0000000000002,
      "Time_End": 1128.88,
      "Text": " The default is just text. So if you wanted to output to a text file, you could specify the"
    },
    {
      "Time_Start": 1128.88,
      "Time_End": 1134.24,
      "Text": " text file. Similarly, you can do like JSON output, which is nice if you're trying to digest this by"
    },
    {
      "Time_Start": 1134.24,
      "Time_End": 1138.8000000000002,
      "Text": " backend systems. It's structured, which makes it really nice. And that's just an example of like"
    },
    {
      "Time_Start": 1138.8,
      "Time_End": 1144.48,
      "Text": " what the JSON data looks like in the output. All right. So that's kind of the overview of"
    },
    {
      "Time_Start": 1144.48,
      "Time_End": 1149.04,
      "Text": " situational awareness, the weaponization with Seapelt. Now we're going to go into a few different"
    },
    {
      "Time_Start": 1149.04,
      "Time_End": 1154.32,
      "Text": " specific areas and give some examples of what Seapelt collects and why we think it's useful."
    },
    {
      "Time_Start": 1155.36,
      "Time_End": 1159.84,
      "Text": " The first part, the safety checks, defensive enumeration. What we really care about is what"
    },
    {
      "Time_Start": 1159.84,
      "Time_End": 1162.96,
      "Text": " defensive tooling is there and how it's configured or misconfigured."
    },
    {
      "Time_Start": 1163.1200000000001,
      "Time_End": 1168.24,
      "Text": " What detective and preventative operating system settings are enabled, specifically like audit logs,"
    },
    {
      "Time_Start": 1168.24,
      "Time_End": 1172.48,
      "Text": " host-based firewall type stuff, you know, obviously things like EMZ and whatever else,"
    },
    {
      "Time_Start": 1172.48,
      "Time_End": 1179.04,
      "Text": " or credential guard, PPL, these types of things that are meant to make our lives harder as attackers."
    },
    {
      "Time_Start": 1179.76,
      "Time_End": 1185.04,
      "Text": " So these settings and these defensive toolings and these things that are there are going to affect"
    },
    {
      "Time_Start": 1185.04,
      "Time_End": 1189.68,
      "Text": " both tools and technique selection. So maybe it affects how we dump credentials from the host,"
    },
    {
      "Time_Start": 1189.68,
      "Time_End": 1194.16,
      "Text": " because maybe a particular EDR we know always flags our method for dumping LSAS,"
    },
    {
      "Time_Start": 1194.16,
      "Time_End": 1198.5600000000002,
      "Text": " but maybe another one doesn't, but maybe we can extract tickets if we can't actually touch LSAS."
    },
    {
      "Time_Start": 1198.5600000000002,
      "Time_End": 1202.48,
      "Text": " Maybe Empire is good to go, or you can use Beacon or you need a custom agent because"
    },
    {
      "Time_Start": 1202.48,
      "Time_End": 1207.28,
      "Text": " the custom configurations in this particular EDR solution. We also care about things like how does,"
    },
    {
      "Time_Start": 1207.28,
      "Time_End": 1212.72,
      "Text": " you know, IT legitimately administer machines, which that might affect the tools and techniques"
    },
    {
      "Time_Start": 1212.72,
      "Time_End": 1218.0,
      "Text": " that we're choosing, because maybe PS exec is off the table, except maybe they use PS exec,"
    },
    {
      "Time_Start": 1218.48,
      "Time_End": 1222.56,
      "Text": " except maybe they use PS exec all the time, you know, and you see system tunnels installed"
    },
    {
      "Time_Start": 1222.56,
      "Time_End": 1228.4,
      "Text": " everywhere. So maybe that brings that particular technique and tool back into the fold. This"
    },
    {
      "Time_Start": 1228.4,
      "Time_End": 1233.6,
      "Text": " enumeration can let us know like what is possible and also what might get you caught. Obviously,"
    },
    {
      "Time_Start": 1233.6,
      "Time_End": 1237.84,
      "Text": " this is a little easier said than done, depending on the EDR, but we'll go into a few examples here"
    },
    {
      "Time_Start": 1237.84,
      "Time_End": 1241.6,
      "Text": " in a second. And in most of these sections, I'm also going to give a reference, or we're going"
    },
    {
      "Time_Start": 1241.6,
      "Time_End": 1246.0,
      "Text": " to give a reference for the relevant modules that we believe apply to this particular subject area."
    },
    {
      "Time_Start": 1246.0,
      "Time_End": 1249.76,
      "Text": " We're not going to go over all of these. This is just a reference if you view the deck after."
    },
    {
      "Time_Start": 1250.96,
      "Time_End": 1257.44,
      "Text": " Here's the first example, ones we use all the time, .NET and PowerShell. We've talked a lot"
    },
    {
      "Time_Start": 1257.44,
      "Time_End": 1263.6,
      "Text": " in our trainings and publicly in different talks and things like that about .NET version 3.5 versus"
    },
    {
      "Time_Start": 1263.6,
      "Time_End": 1269.84,
      "Text": " like, you know, 4.0, those types of things for .NET stuff. Specifically, AMZ can be enrolled for"
    },
    {
      "Time_Start": 1270.56,
      "Time_End": 1276.48,
      "Text": " .NET 4.8, but if the 2.0 of the CLR and 3.5 of .NET itself is still present, you can actually"
    },
    {
      "Time_Start": 1276.48,
      "Time_End": 1281.84,
      "Text": " invoke that version of the .NET framework and you won't be subject to any of these security"
    },
    {
      "Time_Start": 1281.84,
      "Time_End": 1286.6399999999999,
      "Text": " protections. And the same thing with PowerShell, the infamous version 2 downgrade type thing."
    },
    {
      "Time_Start": 1286.6399999999999,
      "Time_End": 1291.6,
      "Text": " So these, at the top, we will see the data that's collected. At the bottom, we see some of those"
    },
    {
      "Time_Start": 1291.6,
      "Time_End": 1295.28,
      "Text": " operator callouts that we were talking about, where it actually checks the settings and will"
    },
    {
      "Time_Start": 1295.28,
      "Time_End": 1300.32,
      "Text": " display messages based on the combinations of these different things that result. Like,"
    },
    {
      "Time_Start": 1300.32,
      "Time_End": 1305.2,
      "Text": " you can do a downgrade, bypass AMZ. There's also obviously things with the defensive EAR"
    },
    {
      "Time_Start": 1305.2,
      "Time_End": 1310.24,
      "Text": " solutions themselves. We have an interesting processes type module that rolls up defensive"
    },
    {
      "Time_Start": 1310.24,
      "Time_End": 1314.8,
      "Text": " stuff, administrative tools, things like that, and calls them out. Obviously here,"
    },
    {
      "Time_Start": 1314.8,
      "Time_End": 1319.12,
      "Text": " we have Windows Defender. So what if we run the Windows Defender module itself, which is more"
    },
    {
      "Time_Start": 1319.1200000000001,
      "Time_End": 1325.44,
      "Text": " specific, and that'll give us path exclusions, processes exclusions, where locally or before"
    },
    {
      "Time_Start": 1325.44,
      "Time_End": 1330.88,
      "Text": " we laterally move, maybe we can just use these particular folders to shuttle all our malicious"
    },
    {
      "Time_Start": 1330.88,
      "Time_End": 1334.8000000000002,
      "Text": " code around and not have to worry about dropping our kind of Gucci evasive type stuff."
    },
    {
      "Time_Start": 1337.2,
      "Time_End": 1342.5600000000002,
      "Text": " And here's another one that we use very frequently, LSA settings. One of the things that"
    },
    {
      "Time_Start": 1342.56,
      "Time_End": 1349.6799999999998,
      "Text": " it'll display is if PPL is enabled or not. So LSAS protected process light or protected mode."
    },
    {
      "Time_Start": 1349.6799999999998,
      "Time_End": 1355.2,
      "Text": " So this is a way, it's a window setting that actually prevents any project or any process"
    },
    {
      "Time_Start": 1355.2,
      "Time_End": 1359.6,
      "Text": " from getting a handle to LSAS easily. So this is something definitely to be aware of."
    },
    {
      "Time_Start": 1359.6,
      "Time_End": 1364.56,
      "Text": " Also, LSA settings will also pop up if WDigest is enabled or not with an operator callout as well."
    },
    {
      "Time_Start": 1365.36,
      "Time_End": 1370.32,
      "Text": " The next thing that seatbelt helps us with is exploitation and vulnerability research and"
    },
    {
      "Time_Start": 1370.32,
      "Time_End": 1377.2,
      "Text": " target selection. So like identifying an attack surface and trying to exploit it. When it comes"
    },
    {
      "Time_Start": 1377.2,
      "Time_End": 1381.84,
      "Text": " to exploitation and vulnerability research, basically what this is, this is helping us"
    },
    {
      "Time_Start": 1381.84,
      "Time_End": 1388.32,
      "Text": " identify anything that's on a system that we may want to attack. Common scenarios for this are"
    },
    {
      "Time_Start": 1388.72,
      "Time_End": 1394.6399999999999,
      "Text": " privilege escalation and then lateral movement and domain escalation. So for privilege escalation,"
    },
    {
      "Time_Start": 1394.6399999999999,
      "Time_End": 1400.96,
      "Text": " maybe we're looking for the applications that have insecure configurations. So, you know,"
    },
    {
      "Time_Start": 1400.96,
      "Time_End": 1406.8799999999999,
      "Text": " like misconfigured services or misconfigured file permissions, you know, powerup is a good example"
    },
    {
      "Time_Start": 1406.8799999999999,
      "Time_End": 1413.76,
      "Text": " of what some of those misconfigurations are. It helps us also identify maybe custom binaries that"
    },
    {
      "Time_Start": 1414.32,
      "Time_End": 1419.76,
      "Text": " are on the machine that, in our experience, custom binaries aren't as secure as like, say,"
    },
    {
      "Time_Start": 1419.76,
      "Time_End": 1429.12,
      "Text": " Microsoft-built binaries. So the people developing them aren't as security conscious. So we may want"
    },
    {
      "Time_Start": 1429.12,
      "Time_End": 1434.32,
      "Text": " to analyze those and identify vulnerabilities in them. The same goes for lateral movement and"
    },
    {
      "Time_Start": 1434.32,
      "Time_End": 1441.76,
      "Text": " domain escalation. We may identify misconfigurations on a host that would allow us to move laterally"
    },
    {
      "Time_Start": 1442.0,
      "Time_End": 1450.72,
      "Text": " to another machine. Or maybe we identify a third-party piece of software that looks interesting."
    },
    {
      "Time_Start": 1450.72,
      "Time_End": 1455.52,
      "Text": " It has a large attack surface and then we do a little bit of quick vulnerability research"
    },
    {
      "Time_Start": 1455.52,
      "Time_End": 1461.28,
      "Text": " and we identify a vulnerability that we can exploit in this software and we can use that"
    },
    {
      "Time_Start": 1461.28,
      "Time_End": 1467.84,
      "Text": " to move to other systems. In general, I'd say the big questions here are what we're looking for"
    },
    {
      "Time_Start": 1468.24,
      "Time_End": 1473.6799999999998,
      "Text": " as the attacker is what things are running maybe as a high-privileged users or running as like"
    },
    {
      "Time_Start": 1473.6799999999998,
      "Time_End": 1480.56,
      "Text": " system. And then how fast can we analyze these things? So we are limited on our time during"
    },
    {
      "Time_Start": 1480.56,
      "Time_End": 1485.4399999999998,
      "Text": " assessments, so we need to be able to triage them quickly. And then, you know, anything that we"
    },
    {
      "Time_Start": 1485.4399999999998,
      "Time_End": 1493.12,
      "Text": " identify, is it remotely accessible or can we, is it accessible from a high-privileged, from a low-privileged"
    },
    {
      "Time_Start": 1493.8400000000001,
      "Time_End": 1498.4,
      "Text": " context? So those are some of the things that we're looking for. These are some of the modules that"
    },
    {
      "Time_Start": 1498.4,
      "Time_End": 1504.0000000000002,
      "Text": " may help us, again, just for reference. And we'll just highlight a few of these in this section,"
    },
    {
      "Time_Start": 1504.0000000000002,
      "Time_End": 1512.5600000000002,
      "Text": " but all of these I've used to analyze the attack surface of a host. So probably the easiest one to"
    },
    {
      "Time_Start": 1512.5600000000002,
      "Time_End": 1518.5600000000002,
      "Text": " understand is like services, the processes, and the scheduled tasks on the machine. So from an attacker"
    },
    {
      "Time_Start": 1519.12,
      "Time_End": 1525.6799999999998,
      "Text": " perspective, what we're interested, you know, what processes and services are running as system,"
    },
    {
      "Time_Start": 1526.48,
      "Time_End": 1532.32,
      "Text": " what's even there in the first place. Also, something that we look for is, is a program.net."
    },
    {
      "Time_Start": 1533.2,
      "Time_End": 1538.6399999999999,
      "Text": " Why this is interesting to us is just because I'm not a great reverse engineer, but if it's a .NET"
    },
    {
      "Time_Start": 1538.6399999999999,
      "Time_End": 1543.6,
      "Text": " application, I can quickly analyze it. I can basically throw it into dnspy and get the source"
    },
    {
      "Time_Start": 1543.6000000000001,
      "Time_End": 1549.7600000000002,
      "Text": " code really easily. As a result of doing this and looking for these things, we identify targets that"
    },
    {
      "Time_Start": 1549.7600000000002,
      "Time_End": 1554.72,
      "Text": " we can quickly look at and find vulnerabilities in. And we do, we've done this repeatedly on"
    },
    {
      "Time_Start": 1554.72,
      "Time_End": 1560.16,
      "Text": " assessments of identifying third-party software or custom software that a company has built,"
    },
    {
      "Time_Start": 1560.16,
      "Time_End": 1567.44,
      "Text": " and then we attack them. It is a very common thing that we abuse in environments. And I'd say"
    },
    {
      "Time_Start": 1567.44,
      "Time_End": 1573.1200000000001,
      "Text": " it's probably one of the most common ways that we escalate privileges, especially on hardened hosts,"
    },
    {
      "Time_Start": 1573.2,
      "Time_End": 1579.1200000000001,
      "Text": " and we escalate privileges in a domain now. So identifying these vulnerabilities in software"
    },
    {
      "Time_Start": 1579.1200000000001,
      "Time_End": 1585.68,
      "Text": " that are deployed everywhere in environments. This is showing the processes command and the services"
    },
    {
      "Time_Start": 1585.68,
      "Time_End": 1591.68,
      "Text": " command. Part of the output of this is the is.net field, letting us know if something is .NET, and"
    },
    {
      "Time_Start": 1591.68,
      "Time_End": 1597.8400000000001,
      "Text": " we can quickly triage it. Similarly, it's giving us insights into what user services are running"
    },
    {
      "Time_Start": 1597.8400000000001,
      "Time_End": 1602.64,
      "Text": " now. So in this case, it's running a system. So that might be a target for privilege escalation."
    },
    {
      "Time_Start": 1603.92,
      "Time_End": 1609.44,
      "Text": " Similarly, it'll give us version information as well as, you know, is it .NET. An assessment"
    },
    {
      "Time_Start": 1609.44,
      "Time_End": 1614.8000000000002,
      "Text": " actually, as I was doing this, I identified this exact service, the Intel audio service,"
    },
    {
      "Time_Start": 1614.8000000000002,
      "Time_End": 1619.6000000000001,
      "Text": " saw it was running a system. I thought, huh, and it's .NET. So I was like, huh, I'll quickly look"
    },
    {
      "Time_Start": 1619.6000000000001,
      "Time_End": 1624.8000000000002,
      "Text": " at that. And I identified a vulnerability in it that allowed us to escalate our privileges."
    },
    {
      "Time_Start": 1624.8,
      "Time_End": 1631.76,
      "Text": " And that's that CVE right there. Another one that's very useful for attack surface analysis"
    },
    {
      "Time_Start": 1631.76,
      "Time_End": 1638.0,
      "Text": " is the TCP and UDP connections on a host. This is going to let us know, you know, what processes"
    },
    {
      "Time_Start": 1638.0,
      "Time_End": 1644.56,
      "Text": " open a port, and, you know, how accessible is that port? Is it bound locally only, or is it"
    },
    {
      "Time_Start": 1644.56,
      "Time_End": 1650.24,
      "Text": " bound on all interfaces? If it's bound on all interfaces, if we find a vulnerability, we could"
    },
    {
      "Time_Start": 1650.24,
      "Time_End": 1654.96,
      "Text": " use this for lateral movement through remote code execution vulnerabilities. If it's only"
    },
    {
      "Time_Start": 1654.96,
      "Time_End": 1661.84,
      "Text": " bound locally, then maybe we can use it for local privilege escalation. Just a simple example of"
    },
    {
      "Time_Start": 1661.84,
      "Time_End": 1667.36,
      "Text": " this showing the TCP connections running on a host. And something here that I didn't know that"
    },
    {
      "Time_Start": 1667.36,
      "Time_End": 1672.32,
      "Text": " you could actually do before I implemented this was you can pull the service name out,"
    },
    {
      "Time_Start": 1672.32,
      "Time_End": 1677.2,
      "Text": " which I thought was pretty cool. And you can see that these are all bound on all interfaces."
    },
    {
      "Time_Start": 1677.2,
      "Time_End": 1683.1200000000001,
      "Text": " So maybe they're ripe targets for exploitation. So that IGC service, for example, is a .NET"
    },
    {
      "Time_Start": 1683.1200000000001,
      "Time_End": 1687.92,
      "Text": " application. And, you know, maybe I'd want to go and attack or take a look at it, at least,"
    },
    {
      "Time_Start": 1687.92,
      "Time_End": 1694.0800000000002,
      "Text": " to see if there's any vulnerabilities. Another very useful one for us is the OS info, which is"
    },
    {
      "Time_Start": 1694.0800000000002,
      "Time_End": 1701.1200000000001,
      "Text": " just basic information about the OS. Here, very simple one, the version of the OS. You know,"
    },
    {
      "Time_Start": 1701.1200000000001,
      "Time_End": 1707.04,
      "Text": " this lets us know if patches have not been installed yet. Similarly, giving us an idea"
    },
    {
      "Time_Start": 1707.04,
      "Time_End": 1712.48,
      "Text": " of our current privileges. Is it high integrity or are we local admin on the machine? Here you"
    },
    {
      "Time_Start": 1712.48,
      "Time_End": 1717.28,
      "Text": " can see we aren't local admin, but there's a callout letting us know even though we aren't"
    },
    {
      "Time_Start": 1717.28,
      "Time_End": 1724.56,
      "Text": " admin, we can bypass UAC in order to get admin privileges. All right. So credential theft."
    },
    {
      "Time_Start": 1725.36,
      "Time_End": 1730.6399999999999,
      "Text": " The really fun stuff. This is what you're all here for, right? So getting all that awesome juicy"
    },
    {
      "Time_Start": 1730.6399999999999,
      "Time_End": 1735.44,
      "Text": " crits. This is obviously an essential part of the attack cycle, but it's very, very often"
    },
    {
      "Time_Start": 1735.44,
      "Time_End": 1740.64,
      "Text": " oversimplified. Like Lian mentioned, we often have a lot of people, students or newer operators,"
    },
    {
      "Time_Start": 1740.64,
      "Time_End": 1745.52,
      "Text": " who are just used to running Sucrosa logon passwords as their first reactive action."
    },
    {
      "Time_Start": 1745.52,
      "Time_End": 1751.6000000000001,
      "Text": " But credentials are more than just secure LSA, and there's a lot more ways to retrieve these"
    },
    {
      "Time_Start": 1751.6000000000001,
      "Time_End": 1755.68,
      "Text": " credentials outside of just running it through this particular Mimikatz command. As far as"
    },
    {
      "Time_Start": 1755.68,
      "Time_End": 1760.8,
      "Text": " credential theft goes for CFELT, all these collection of modules that we kind of include"
    },
    {
      "Time_Start": 1760.8,
      "Time_End": 1765.12,
      "Text": " under the credential theft banner will either somehow directly allow for the recovery of"
    },
    {
      "Time_Start": 1765.12,
      "Time_End": 1770.3999999999999,
      "Text": " credentials or somehow affect the recovery of credential material. We'll go into some examples."
    },
    {
      "Time_Start": 1771.2,
      "Time_End": 1774.8,
      "Text": " Again, here's a reference and all the different things that apply."
    },
    {
      "Time_Start": 1776.6399999999999,
      "Time_End": 1780.56,
      "Text": " And we're going to start diving into a few examples. So one of them we use a lot is logon"
    },
    {
      "Time_Start": 1780.56,
      "Time_End": 1787.44,
      "Text": " events. So these correlate data from security event ID 4624s in the event log. So these will"
    },
    {
      "Time_Start": 1787.44,
      "Time_End": 1793.2,
      "Text": " indicate what accounts perform inbound authentication attempts successful. 4625s"
    },
    {
      "Time_Start": 1793.2,
      "Time_End": 1798.16,
      "Text": " are unsuccessful. Like when do these inbound attempts happen? When do they happen? And exactly"
    },
    {
      "Time_Start": 1798.16,
      "Time_End": 1802.56,
      "Text": " how do they happen? So some examples of things will happen on a regular basis would be like"
    },
    {
      "Time_Start": 1802.56,
      "Time_End": 1808.0800000000002,
      "Text": " necessary vulnerability scanners, random IT scanning accounts, SCCM pushes, things like that,"
    },
    {
      "Time_Start": 1808.0800000000002,
      "Time_End": 1813.92,
      "Text": " or just normal manual administrative actions. We also care about what protocols these accounts use"
    },
    {
      "Time_Start": 1813.92,
      "Time_End": 1819.28,
      "Text": " when logging in. Specifically, NTLM versus Kerberos. Because if it's NTLM, we could sniff"
    },
    {
      "Time_Start": 1819.28,
      "Time_End": 1825.44,
      "Text": " the net NTLM v2 or potentially v1 if we can do a downgrade. We can sniff the hashes or we can"
    },
    {
      "Time_Start": 1825.44,
      "Time_End": 1831.6000000000001,
      "Text": " potentially do a relay. We also care about where this account logs in from. This might give us"
    },
    {
      "Time_Start": 1831.6000000000001,
      "Time_End": 1836.24,
      "Text": " information about like the network or these, you know, like authentication patterns. Or is it a"
    },
    {
      "Time_Start": 1836.24,
      "Time_End": 1840.72,
      "Text": " jump box? Is it, you know, a workstation where a sensitive administrator does a lot of their"
    },
    {
      "Time_Start": 1840.72,
      "Time_End": 1845.28,
      "Text": " actions from? This will give us an idea of where to go next, all based on this host-based data."
    },
    {
      "Time_Start": 1845.92,
      "Time_End": 1851.28,
      "Text": " One thing to note though is that in order to retrieve all these events, you do need administrative"
    },
    {
      "Time_Start": 1851.28,
      "Time_End": 1855.76,
      "Text": " writes. These do read the security event log. But once you get to that point, there's a huge amount"
    },
    {
      "Time_Start": 1855.76,
      "Time_End": 1861.52,
      "Text": " of cool information you can do with event log mining. So this is just an example of the output."
    },
    {
      "Time_Start": 1861.52,
      "Time_End": 1866.32,
      "Text": " As you can see up here at the top, we're running the log on events command. Dash q is just quiet"
    },
    {
      "Time_Start": 1866.32,
      "Time_End": 1870.72,
      "Text": " mode. So just press the banner. And then we're saying give us the event logs for the last"
    },
    {
      "Time_Start": 1870.72,
      "Time_End": 1876.0,
      "Text": " one day. And here you can see some of the interesting things that we learned from this"
    },
    {
      "Time_Start": 1876.0,
      "Time_End": 1881.84,
      "Text": " host-based data is, well for one, the log on type. Here we can see it's a log on type of new credential"
    },
    {
      "Time_Start": 1881.84,
      "Time_End": 1888.0,
      "Text": " which is that's similar to like when you run run as slash net only. Those credentials are only going"
    },
    {
      "Time_Start": 1888.0,
      "Time_End": 1893.9199999999998,
      "Text": " to be used when authenticating outbound. Why this is interesting is because somebody performed this"
    },
    {
      "Time_Start": 1893.92,
      "Time_End": 1899.76,
      "Text": " new credential log on. So they've specified a brand new set of credentials. What that indicates"
    },
    {
      "Time_Start": 1899.76,
      "Time_End": 1905.2,
      "Text": " to me as the attacker is I can steal those outbound credentials. So or these domain admin"
    },
    {
      "Time_Start": 1905.2,
      "Time_End": 1911.28,
      "Text": " credentials in this case. So that's one useful piece of information from event logs. Another one"
    },
    {
      "Time_Start": 1911.28,
      "Time_End": 1917.8400000000001,
      "Text": " is the authentication packages that are used during authentication. So here you can see that"
    },
    {
      "Time_Start": 1917.92,
      "Time_End": 1923.6000000000001,
      "Text": " we're using NTLM. And there's this nice little call out here saying, you know, because it is"
    },
    {
      "Time_Start": 1923.6000000000001,
      "Time_End": 1931.6000000000001,
      "Text": " NTLM, we see that this IT services account is has been called out specifically because it's using"
    },
    {
      "Time_Start": 1931.6000000000001,
      "Time_End": 1938.4800000000002,
      "Text": " net NTLM v2. So we could sniff that account to steal its password. So that's obviously one form"
    },
    {
      "Time_Start": 1938.4800000000002,
      "Time_End": 1945.1200000000001,
      "Text": " of credential theft that we could do. In addition, using because it's NTLM, we could potentially do"
    },
    {
      "Time_Start": 1945.1200000000001,
      "Time_End": 1951.8400000000001,
      "Text": " an NTLM relay. There's a separate command called NTLM settings and seatbelt that will let us know"
    },
    {
      "Time_Start": 1951.8400000000001,
      "Time_End": 1957.7600000000002,
      "Text": " some other information like about signing or SMB signing and LDAP signing in the environment."
    },
    {
      "Time_Start": 1958.5600000000002,
      "Time_End": 1964.0800000000002,
      "Text": " This is also very useful because it helps us when it comes to targeting or building out our attack"
    },
    {
      "Time_Start": 1964.0800000000002,
      "Time_End": 1969.2800000000002,
      "Text": " path that we want to take. In the event log, it gives us an IP address of where that authentication"
    },
    {
      "Time_Start": 1969.28,
      "Time_End": 1976.3999999999999,
      "Text": " where that account authenticated from. So in this case, that 230.1 address, we know that the"
    },
    {
      "Time_Start": 1976.3999999999999,
      "Time_End": 1982.24,
      "Text": " IT services account is logged on on that machine with a plain text password. So if we want to"
    },
    {
      "Time_Start": 1982.24,
      "Time_End": 1986.8,
      "Text": " compromise that account, we know we can try and maybe pivot to there and steal the account."
    },
    {
      "Time_Start": 1988.08,
      "Time_End": 1992.56,
      "Text": " Another thing that it lets us know, it's if it's using something like Kerberos,"
    },
    {
      "Time_Start": 1992.56,
      "Time_End": 1996.72,
      "Text": " you know, it still gives us some ideas of techniques that we could potentially use."
    },
    {
      "Time_Start": 1996.72,
      "Time_End": 2001.3600000000001,
      "Text": " We see this privileged account trying to log in. So how could we potentially obtain it? Well,"
    },
    {
      "Time_Start": 2001.3600000000001,
      "Time_End": 2009.04,
      "Text": " maybe we could do a Kerberos to NTLM downgrade, or maybe we could that that host that dot 200"
    },
    {
      "Time_Start": 2009.04,
      "Time_End": 2014.48,
      "Text": " host is a target now. So we know the IT admins plain text creds are there. So we could potentially"
    },
    {
      "Time_Start": 2014.48,
      "Time_End": 2021.84,
      "Text": " pivot to that machine and steal those creds. Another type of event that we really like to"
    },
    {
      "Time_Start": 2021.8400000000001,
      "Time_End": 2028.2400000000002,
      "Text": " target our security event 4648, which is an explicit log on occurred on the machine."
    },
    {
      "Time_Start": 2028.2400000000002,
      "Time_End": 2034.4800000000002,
      "Text": " Why this is interesting is because if a program uses a plain text credential to log on as another"
    },
    {
      "Time_Start": 2034.4800000000002,
      "Time_End": 2041.0400000000002,
      "Text": " user, this event log will be generated. And what that indicates to me as the attacker is after"
    },
    {
      "Time_Start": 2041.0400000000002,
      "Time_End": 2047.5200000000002,
      "Text": " looking at this event log, I now know that there is a plain text credential that has been used on"
    },
    {
      "Time_Start": 2047.52,
      "Time_End": 2053.44,
      "Text": " this machine, and I can steal it. And it's always going to be recoverable. So like I know there's a"
    },
    {
      "Time_Start": 2053.44,
      "Time_End": 2058.64,
      "Text": " plain text password here, I just need to figure out how the application stores it or obtains it,"
    },
    {
      "Time_Start": 2058.64,
      "Time_End": 2063.7599999999998,
      "Text": " and then I can steal it. Some useful bits of information that this lets us know is like the"
    },
    {
      "Time_Start": 2063.7599999999998,
      "Time_End": 2069.12,
      "Text": " timestamp of when this occurred, we often see that maybe that it recurs on a regular interval,"
    },
    {
      "Time_Start": 2069.12,
      "Time_End": 2074.4,
      "Text": " indicating that maybe there's a background job that's part of the application. Or maybe there's"
    },
    {
      "Time_Start": 2074.4,
      "Time_End": 2080.56,
      "Text": " a scheduled task or a service that starts stops and starts that is performing this task for us."
    },
    {
      "Time_Start": 2082.08,
      "Time_End": 2087.28,
      "Text": " This is an example of what the output looks like. And so we're looking for the explicit"
    },
    {
      "Time_Start": 2087.28,
      "Time_End": 2092.8,
      "Text": " event logs in the last one day. Here we can see that there's three accounts that performed explicit"
    },
    {
      "Time_Start": 2092.8,
      "Time_End": 2098.4,
      "Text": " log on explicit log on. So these three accounts, plain text credentials have occurred on this"
    },
    {
      "Time_Start": 2098.4,
      "Time_End": 2104.88,
      "Text": " machine. It also lets us know the processes. So in this case, there's PowerShell, IFC used this,"
    },
    {
      "Time_Start": 2104.88,
      "Time_End": 2110.8,
      "Text": " so maybe they there's a PowerShell script that had an embedded credential. And then also the"
    },
    {
      "Time_Start": 2110.8,
      "Time_End": 2117.2000000000003,
      "Text": " target address of where that account was used to authenticate to. So giving us some context around"
    },
    {
      "Time_Start": 2117.2000000000003,
      "Time_End": 2122.96,
      "Text": " how this cred was used or what it might typically be used for, and where it may have access to."
    },
    {
      "Time_Start": 2122.96,
      "Time_End": 2128.4,
      "Text": " So here we can see that IT services account probably has some sort of access to that .200"
    },
    {
      "Time_Start": 2128.4,
      "Time_End": 2135.44,
      "Text": " host highlighted in yellow. Right, scraping sensitive event logs, this is definitely up on one."
    },
    {
      "Time_Start": 2136.32,
      "Time_End": 2140.7200000000003,
      "Text": " There's three different modules that will do this, PowerShell events, SysMod events, and process"
    },
    {
      "Time_Start": 2140.7200000000003,
      "Time_End": 2147.2,
      "Text": " creation events. So all of these modules will essentially collect data from local event logs"
    },
    {
      "Time_Start": 2148.0,
      "Time_End": 2152.8,
      "Text": " that collect information, these specific event logs will contain and collect information about"
    },
    {
      "Time_Start": 2152.8,
      "Time_End": 2158.6400000000003,
      "Text": " processes that are started or PowerShell script blocks that are run. So with this, sometimes you"
    },
    {
      "Time_Start": 2158.6400000000003,
      "Time_End": 2163.36,
      "Text": " can get leakage of sensitive credentials or pass in the command line. The most common example would"
    },
    {
      "Time_Start": 2163.36,
      "Time_End": 2168.7200000000003,
      "Text": " be PS exec with the plain text cred, right, so that's your sensitive credential exposure if"
    },
    {
      "Time_Start": 2168.7200000000003,
      "Time_End": 2173.6800000000003,
      "Text": " there's command line logging on that host. So SysMod events and process creation events require"
    },
    {
      "Time_Start": 2173.6800000000003,
      "Time_End": 2178.88,
      "Text": " admin rights, the PowerShell events does not, which is pretty cool. So we actually run all the data"
    },
    {
      "Time_Start": 2178.88,
      "Time_End": 2184.0,
      "Text": " through these through a common set of regexes, this is an example that will pop out of converting"
    },
    {
      "Time_Start": 2184.0,
      "Time_End": 2189.76,
      "Text": " a plain text password to a secure string. We have definitely found a lot of these different things"
    },
    {
      "Time_Start": 2189.76,
      "Time_End": 2196.48,
      "Text": " through different event logs and hosts. Log on sessions, this will let us know who's logged on"
    },
    {
      "Time_Start": 2196.48,
      "Time_End": 2203.36,
      "Text": " to the machine, when they logged on, and what type, what their log on session type is."
    },
    {
      "Time_Start": 2203.36,
      "Time_End": 2208.32,
      "Text": " And why this matters is that network log on session types, for these types, credentials will usually"
    },
    {
      "Time_Start": 2208.32,
      "Time_End": 2213.44,
      "Text": " not be in memory. But non-network log on sessions, like interactive, remote interactive, and network"
    },
    {
      "Time_Start": 2213.44,
      "Time_End": 2218.48,
      "Text": " plain text, credentials will very often, though not always, be in memory. So again, this will let us"
    },
    {
      "Time_Start": 2218.48,
      "Time_End": 2223.2000000000003,
      "Text": " know, like say we're checking this remotely against another host, is it worth even trying to move to"
    },
    {
      "Time_Start": 2223.2000000000003,
      "Time_End": 2227.36,
      "Text": " that host and dumping credentials from LSAS, like are those creds even there, before we go through"
    },
    {
      "Time_Start": 2227.36,
      "Time_End": 2232.4,
      "Text": " all that effort. Because again, a lot of these modules can be run on remote systems, so this"
    },
    {
      "Time_Start": 2232.4,
      "Time_End": 2236.88,
      "Text": " definitely helps in that credential shuffle, credential focus, lateral movement to see if"
    },
    {
      "Time_Start": 2236.88,
      "Time_End": 2243.36,
      "Text": " it's worth it or not. So this is just an example of the output of that command, and here you can see"
    },
    {
      "Time_Start": 2244.08,
      "Time_End": 2249.6800000000003,
      "Text": " multiple log on sessions. So we know that two accounts have logged on to this machine in some"
    },
    {
      "Time_Start": 2249.6800000000003,
      "Time_End": 2255.6800000000003,
      "Text": " way, and it also highlights the authentication package and the log on type that was used. So"
    },
    {
      "Time_Start": 2255.6800000000003,
      "Time_End": 2260.88,
      "Text": " here we can see that IT admin user at the top logged on with Kerberos, and it was a network"
    },
    {
      "Time_Start": 2260.96,
      "Time_End": 2267.28,
      "Text": " authentication. And so that user's credentials probably aren't on the machine. Maybe that IT"
    },
    {
      "Time_Start": 2267.28,
      "Time_End": 2272.7200000000003,
      "Text": " admin logged onto the machine using WMI to execute a command, and when that occurs, because it's a"
    },
    {
      "Time_Start": 2272.7200000000003,
      "Time_End": 2279.28,
      "Text": " network log on, those credentials aren't there. So we can't actually steal those creds. So maybe"
    },
    {
      "Time_Start": 2279.28,
      "Time_End": 2285.6800000000003,
      "Text": " it's not worth us to run Mimikatz on this machine to steal that IT admin's creds. Whereas if you"
    },
    {
      "Time_Start": 2285.6800000000003,
      "Time_End": 2289.76,
      "Text": " look at the local admin creds there down at the bottom, you can see that the authentication"
    },
    {
      "Time_Start": 2289.76,
      "Time_End": 2296.5600000000004,
      "Text": " package was NTLM, and it was a remote interactive. So maybe they were using RDP to access this"
    },
    {
      "Time_Start": 2296.5600000000004,
      "Time_End": 2302.8,
      "Text": " machine. So because it's remote interactive, we know we can steal this. We can very likely,"
    },
    {
      "Time_Start": 2302.8,
      "Time_End": 2306.7200000000003,
      "Text": " there are very likely credentials on the host that we can steal."
    },
    {
      "Time_Start": 2308.96,
      "Time_End": 2315.28,
      "Text": " Another module is the sec package creds module, and what this does is it obtains credentials"
    },
    {
      "Time_Start": 2315.28,
      "Time_End": 2321.36,
      "Text": " from security packages on the machine. Currently it's limited to just the NTLM security package."
    },
    {
      "Time_Start": 2322.32,
      "Time_End": 2327.36,
      "Text": " This is similar to what internal monologue has done. There's a couple other tools that"
    },
    {
      "Time_Start": 2327.36,
      "Time_End": 2332.8,
      "Text": " do a similar thing as well. This is just an example of us running it. So the current user"
    },
    {
      "Time_Start": 2332.8,
      "Time_End": 2339.28,
      "Text": " in this case is Harmjoy, and you can see that when we run this, we get the current user's net"
    },
    {
      "Time_Start": 2339.28,
      "Time_End": 2346.96,
      "Text": " NTLM v2 hash. And if this was, if net of NTLM v1 was enabled on the machine, we could also steal"
    },
    {
      "Time_Start": 2346.96,
      "Time_End": 2352.96,
      "Text": " the v1 hash. So you can do this as low privileged user too. So this can be beneficial in obtaining"
    },
    {
      "Time_Start": 2353.76,
      "Time_End": 2358.4,
      "Text": " user's plaintext passwords. You obtain the hash and then crack it, and then you have the plaintext."
    },
    {
      "Time_Start": 2360.0,
      "Time_End": 2365.36,
      "Text": " Cool. Last main section, we're going to hit some user and system behavioral baselining. Again,"
    },
    {
      "Time_Start": 2365.36,
      "Time_End": 2370.48,
      "Text": " our standard relevant modules. But for behavioral baselining, we want to get a sense of what users"
    },
    {
      "Time_Start": 2370.48,
      "Time_End": 2376.0,
      "Text": " actually use the system for. Very obvious one is web browsers. What browsers are installed? What"
    },
    {
      "Time_Start": 2376.0,
      "Time_End": 2381.04,
      "Text": " are the versions? Where do they navigate to with these browsers? Like bookmarks, tabs, history,"
    },
    {
      "Time_Start": 2381.04,
      "Time_End": 2385.52,
      "Text": " there's modules to recover all these for different browsers. Are there credentials stored, passwords"
    },
    {
      "Time_Start": 2385.52,
      "Time_End": 2391.76,
      "Text": " or cookies? Are there any remote administration tools that are used regularly like SSH, FTP, RDP?"
    },
    {
      "Time_Start": 2392.32,
      "Time_End": 2397.28,
      "Text": " Then also some like standard usability things like office or explore most recently used locations,"
    },
    {
      "Time_Start": 2397.28,
      "Time_End": 2404.6400000000003,
      "Text": " recent documents, recycle bin, things like that. We also care a lot about Chromium. So"
    },
    {
      "Time_Start": 2405.44,
      "Time_End": 2409.6000000000004,
      "Text": " Chromium-based browsers include Chrome, Edge, Brave, and Opera. These are the main ones. All"
    },
    {
      "Time_Start": 2409.6000000000004,
      "Time_End": 2414.6400000000003,
      "Text": " these collections work locally and remotely. Here's an example of running the Chrome present"
    },
    {
      "Time_Start": 2414.6400000000003,
      "Time_End": 2419.44,
      "Text": " module, which will find those history, cookies, and login data type stuff. It'll also detect if"
    },
    {
      "Time_Start": 2419.6,
      "Time_End": 2425.36,
      "Text": " Chrome is using version 80 plus, which affects deep API and credential recovery."
    },
    {
      "Time_Start": 2426.7200000000003,
      "Time_End": 2432.88,
      "Text": " We're increasingly looking at using this on assessments because we find so many saved passwords"
    },
    {
      "Time_Start": 2432.88,
      "Time_End": 2439.52,
      "Text": " as well as cookies that we can use to access other and impersonate other users on the network."
    },
    {
      "Time_Start": 2440.7200000000003,
      "Time_End": 2447.04,
      "Text": " Also Slack. So if you have access to someone's Slack instance, or you're executing their user"
    },
    {
      "Time_Start": 2447.04,
      "Time_End": 2451.52,
      "Text": " contacts and access to their Slack files and cookies, you can actually clone someone else's"
    },
    {
      "Time_Start": 2451.52,
      "Time_End": 2455.84,
      "Text": " Slack access, which we've done plenty of times. We have a post on it from one of our operators,"
    },
    {
      "Time_Start": 2455.84,
      "Time_End": 2459.92,
      "Text": " actually. This is just an example of picking out some of that data with Slack presence,"
    },
    {
      "Time_Start": 2459.92,
      "Time_End": 2466.72,
      "Text": " workspaces, downloads, things like that. Last section, we're going to touch through a couple"
    },
    {
      "Time_Start": 2466.72,
      "Time_End": 2472.32,
      "Text": " of kind of walkthroughs and explain our thought process. Host-based situational awareness data"
    },
    {
      "Time_Start": 2472.32,
      "Time_End": 2478.1600000000003,
      "Text": " influences the techniques that we use. For example, with persistence, seatbelts last"
    },
    {
      "Time_Start": 2478.1600000000003,
      "Time_End": 2483.44,
      "Text": " shut down and powered on events are giving us an idea of how often this machine is rebooting or"
    },
    {
      "Time_Start": 2483.44,
      "Time_End": 2488.8,
      "Text": " going offline. And so if it doesn't go offline, then we probably don't even need a drop persistence."
    },
    {
      "Time_Start": 2488.8,
      "Time_End": 2494.56,
      "Text": " We can just stay running in memory for a long time. Similarly, it may let us know what technique"
    },
    {
      "Time_Start": 2494.56,
      "Time_End": 2500.0,
      "Text": " we're going to use for persistence. So we could look at the WMI event subscriptions, and rather"
    },
    {
      "Time_Start": 2500.0,
      "Time_End": 2505.04,
      "Text": " than creating a new one, let's just replace an existing one. Or we may look and see that"
    },
    {
      "Time_Start": 2505.04,
      "Time_End": 2509.76,
      "Text": " there's several scheduled tasks or custom scheduled tasks registered in the environment."
    },
    {
      "Time_Start": 2509.76,
      "Time_End": 2515.36,
      "Text": " Let's just DLL hijack one of the scheduled tasks and get execution through that way."
    },
    {
      "Time_Start": 2516.64,
      "Time_End": 2521.76,
      "Text": " Similarly, it applies to like lateral movement. Using the Windows firewall command, we can see"
    },
    {
      "Time_Start": 2521.76,
      "Time_End": 2528.0,
      "Text": " what restrictions are there. You know, 445 might be blocked in the network. So that's going to"
    },
    {
      "Time_Start": 2528.56,
      "Time_End": 2533.52,
      "Text": " restrict what lateral movement techniques we can use. There's a lot of modules that help us"
    },
    {
      "Time_Start": 2533.52,
      "Time_End": 2537.92,
      "Text": " understand attack surface that we've attacked, we've already talked about, but they can also be"
    },
    {
      "Time_Start": 2538.48,
      "Time_End": 2544.56,
      "Text": " ran remotely against a machine as well. We can also identify things that are running that we can"
    },
    {
      "Time_Start": 2544.56,
      "Time_End": 2551.36,
      "Text": " potentially, you know, hijack or hijack execution through. So for example, through DLL hijacking,"
    },
    {
      "Time_Start": 2551.36,
      "Time_End": 2558.1600000000003,
      "Text": " or we could backdoor one of the executables and get execution through there. So the same"
    },
    {
      "Time_Start": 2558.1600000000003,
      "Time_End": 2562.4,
      "Text": " things are going to apply. Scheduled tasks, WMI event subscriptions, services, etc."
    },
    {
      "Time_Start": 2563.52,
      "Time_End": 2570.4,
      "Text": " Another very useful thing is understanding the EDR products. So we've used EDR products for remote"
    },
    {
      "Time_Start": 2570.4,
      "Time_End": 2577.52,
      "Text": " code execution on hosts on several occasions. So most EDR products have like a remote interaction"
    },
    {
      "Time_Start": 2577.52,
      "Time_End": 2582.8,
      "Text": " component that allow you to temporarily like execute shell commands on a host. So that's what"
    },
    {
      "Time_Start": 2582.8,
      "Time_End": 2590.56,
      "Text": " we've used for lateral movement through, I'd say, several EDR products. In addition, there's a UAC"
    },
    {
      "Time_Start": 2590.56,
      "Time_End": 2598.24,
      "Text": " module. And the UAC settings affect how local accounts authenticate and whether or not you can"
    },
    {
      "Time_Start": 2598.24,
      "Time_End": 2603.84,
      "Text": " actually use them for lateral movement. And so that module gives us a nice summary of whether"
    },
    {
      "Time_Start": 2603.84,
      "Time_End": 2608.96,
      "Text": " or not we're going to be able to use local accounts for lateral movement. All right, and our last"
    },
    {
      "Time_Start": 2608.96,
      "Time_End": 2613.84,
      "Text": " little walkthrough. The next following few slides, we'll talk through escalating on a system and"
    },
    {
      "Time_Start": 2613.84,
      "Time_End": 2619.28,
      "Text": " moving laterally to a second system. We're going to talk through some example individual data source"
    },
    {
      "Time_Start": 2619.28,
      "Time_End": 2624.56,
      "Text": " results and how they affect the steps, the next steps of the attack process. The big point here"
    },
    {
      "Time_Start": 2624.56,
      "Time_End": 2628.7200000000003,
      "Text": " is we're hoping to talk through parts of the thought process for the attack and how these"
    },
    {
      "Time_Start": 2628.7200000000003,
      "Time_End": 2633.2000000000003,
      "Text": " new data sources affect the decisions we're making as we're moving to these next steps."
    },
    {
      "Time_Start": 2634.2400000000002,
      "Time_End": 2639.6800000000003,
      "Text": " The first example, we land on the host, we run our standard, you know, situational awareness stuff we"
    },
    {
      "Time_Start": 2639.6800000000003,
      "Time_End": 2645.76,
      "Text": " always do. We see that PowerShell is installed, 5.1 is installed, but also version 2 is still"
    },
    {
      "Time_Start": 2645.76,
      "Time_End": 2652.0000000000005,
      "Text": " installed. We see, okay, we can do a PowerShell downgrade to avoid AMSI, script block logging,"
    },
    {
      "Time_Start": 2652.0000000000005,
      "Time_End": 2657.84,
      "Text": " all these security settings that are specified for v5. So this affects the weaponization of what"
    },
    {
      "Time_Start": 2657.84,
      "Time_End": 2663.92,
      "Text": " we're trying to run and how we're trying to run it. We also see with logon events that there is a"
    },
    {
      "Time_Start": 2663.92,
      "Time_End": 2671.6000000000004,
      "Text": " vuln scanner account that is authenticating to the system using net ntlm v2. So while we can't,"
    },
    {
      "Time_Start": 2671.6000000000004,
      "Time_End": 2679.28,
      "Text": " maybe we could do a net ntlm v1 downgrade, we can at least sniff this net ntlm v2 challenge response"
    },
    {
      "Time_Start": 2679.28,
      "Time_End": 2683.36,
      "Text": " and try to crack the password. And how are we going to do this? So this is what we're trying"
    },
    {
      "Time_Start": 2683.36,
      "Time_End": 2689.04,
      "Text": " to go after. And how we're going to do it, weaponization style, is through PowerShell."
    },
    {
      "Time_Start": 2689.04,
      "Time_End": 2693.76,
      "Text": " Because we know that v2 is now currently on the host, so we can safely run our offensive code."
    },
    {
      "Time_Start": 2693.76,
      "Time_End": 2699.6,
      "Text": " And we can verify this showing PowerShell version 2, VS version table shows 2. So because of this,"
    },
    {
      "Time_Start": 2699.6,
      "Time_End": 2706.4,
      "Text": " we decide that we can run invay securely without tripping any defenses. So we run invay, we see"
    },
    {
      "Time_Start": 2706.4,
      "Time_End": 2713.1200000000003,
      "Text": " that the vuln scanner inbound net ntlm v2 challenge response comes in. So this is crackable,"
    },
    {
      "Time_Start": 2713.12,
      "Time_End": 2719.68,
      "Text": " in our example scenario here. Then next steps, we're still on that same host. One of the other"
    },
    {
      "Time_Start": 2719.68,
      "Time_End": 2725.3599999999997,
      "Text": " examples we saw was this WSUS for the patching server. So we're making this logical assumption"
    },
    {
      "Time_Start": 2725.3599999999997,
      "Time_End": 2729.3599999999997,
      "Text": " like, okay, you know, based on this host-based data, maybe we have some Bloodhound data or"
    },
    {
      "Time_Start": 2729.3599999999997,
      "Time_End": 2733.44,
      "Text": " something else. But this vuln scanner account we're assuming has access to a lot of different"
    },
    {
      "Time_Start": 2733.44,
      "Time_End": 2738.08,
      "Text": " systems. So we're going to try it on that WSUS server, because we're assuming that the WSUS"
    },
    {
      "Time_Start": 2738.08,
      "Time_End": 2743.44,
      "Text": " server probably has all the accounts on. We'll verify that assumption here in a bit. So we see"
    },
    {
      "Time_Start": 2743.44,
      "Time_End": 2747.2,
      "Text": " we're running a vuln scanner with that crack credential, and we have access to the WSUS server."
    },
    {
      "Time_Start": 2748.64,
      "Time_End": 2754.16,
      "Text": " Now, we can then run a bunch of our situation awareness remotely, because we have administrative"
    },
    {
      "Time_Start": 2754.16,
      "Time_End": 2760.0,
      "Text": " access to that WSUS server. We're going to run this with our remote grouping. We see an example"
    },
    {
      "Time_Start": 2760.0,
      "Time_End": 2764.56,
      "Text": " here with logon sessions. We have an administrator with an interactive logon session, so we can still"
    },
    {
      "Time_Start": 2764.72,
      "Time_End": 2771.36,
      "Text": " credential. And just as another example, we see that there are no firewall restrictions for domains."
    },
    {
      "Time_Start": 2771.36,
      "Time_End": 2778.0,
      "Text": " So good to go. And the last bit is we're also going to see results for schedule tasks. We see"
    },
    {
      "Time_Start": 2778.0,
      "Time_End": 2784.08,
      "Text": " that the schedule task is running the system. It's going to kick off a VBS script, and it runs"
    },
    {
      "Time_Start": 2784.08,
      "Time_End": 2789.6,
      "Text": " every day, once a day. So because of this, we decide in our scenario here that we are just going"
    },
    {
      "Time_Start": 2789.6,
      "Time_End": 2794.88,
      "Text": " to backdoor or append onto the existing VBS, using like a .NET to JScript style payload,"
    },
    {
      "Time_Start": 2795.6,
      "Time_End": 2799.8399999999997,
      "Text": " based on other settings of the host that we find. And then our lower movement is just making one"
    },
    {
      "Time_Start": 2799.8399999999997,
      "Time_End": 2805.52,
      "Text": " file modification, not starting services, not modifying anything else. That's just kind of an"
    },
    {
      "Time_Start": 2805.52,
      "Time_End": 2810.24,
      "Text": " example of like a walkthrough for this type of stuff. And for some final wrap-up thoughts."
    },
    {
      "Time_Start": 2810.24,
      "Time_End": 2818.0,
      "Text": " Yeah, this CPL is here to collect host-based data. And anytime we find something interesting that we"
    },
    {
      "Time_Start": 2818.0,
      "Time_End": 2824.0,
      "Text": " can collect that through host-based artifacts, we're trying to add it into CPL."
    },
    {
      "Time_Start": 2824.0,
      "Time_End": 2829.12,
      "Text": " This is useful for the current host we're on, as well as any machine that we may be pivoting to,"
    },
    {
      "Time_Start": 2829.12,
      "Time_End": 2834.64,
      "Text": " because we can run these commands remotely. And ultimately, as like that example showed, the more"
    },
    {
      "Time_Start": 2834.64,
      "Time_End": 2840.16,
      "Text": " data you collect, the better decisions you can make on your engagement. So as you're collecting"
    },
    {
      "Time_Start": 2840.16,
      "Time_End": 2845.2,
      "Text": " this data, you're gaining a better understanding of the network. As an offensive person, it's going"
    },
    {
      "Time_Start": 2845.2000000000003,
      "Time_End": 2849.92,
      "Text": " to help you make better decisions to remain evasive, and also have a better understanding"
    },
    {
      "Time_Start": 2849.92,
      "Time_End": 2855.28,
      "Text": " of how the network is configured and what hosts there are. And this will influence the next steps"
    },
    {
      "Time_Start": 2855.28,
      "Time_End": 2869.6800000000003,
      "Text": " for our attack path. All right, so thank you very much. And if anyone has any questions, please ask."
    }
  ]
}