{
  "segments": [
    {
      "Time_Start": 0.0,
      "Time_End": 16.96,
      "Text": "This text was transcribed using whisper model: large-v2\n\n All right, good afternoon and happy Friday."
    },
    {
      "Time_Start": 16.96,
      "Time_End": 24.2,
      "Text": " This is Phishing in a Macroless World, exploring alternative methods for office document exploitation,"
    },
    {
      "Time_Start": 24.2,
      "Time_End": 30.32,
      "Text": " which is a lot of words to say macroless document exploitation."
    },
    {
      "Time_Start": 30.32,
      "Time_End": 31.32,
      "Text": " My name is Daniel."
    },
    {
      "Time_Start": 31.32,
      "Time_End": 35.72,
      "Text": " I go by the handle of HottnOps on Medium or Twitter or GitHub."
    },
    {
      "Time_Start": 35.72,
      "Time_End": 38.6,
      "Text": " I'm new-ish to SpectreOps."
    },
    {
      "Time_Start": 38.6,
      "Time_End": 43.44,
      "Text": " I've been around for about seven to eight months, and before that, I've been doing software"
    },
    {
      "Time_Start": 43.44,
      "Time_End": 45.92,
      "Text": " engineering for about 10 years."
    },
    {
      "Time_Start": 45.92,
      "Time_End": 51.519999999999996,
      "Text": " I'm traditionally a coder, and then I kind of gradually moved into the field of security"
    },
    {
      "Time_Start": 51.52,
      "Time_End": 54.7,
      "Text": " research and Windows research."
    },
    {
      "Time_Start": 54.7,
      "Time_End": 59.36,
      "Text": " I like to think of myself as a jack-of-all-trades in that I get really excited into projects"
    },
    {
      "Time_Start": 59.36,
      "Time_End": 63.0,
      "Text": " and I'll dive deep into them for a couple months, and then something new and more exciting"
    },
    {
      "Time_Start": 63.0,
      "Time_End": 70.76,
      "Text": " comes along and I go follow that, and so consequently, I'm a master of none."
    },
    {
      "Time_Start": 70.76,
      "Time_End": 72.24000000000001,
      "Text": " So why am I doing this?"
    },
    {
      "Time_Start": 72.24000000000001,
      "Time_End": 73.54,
      "Text": " Why am I giving this talk?"
    },
    {
      "Time_Start": 73.54,
      "Time_End": 78.68,
      "Text": " So I was going through the office document specification for Ghostwriter when I kept"
    },
    {
      "Time_Start": 78.68,
      "Time_End": 83.64,
      "Text": " reading about built-in document functionality that I found could be useful from an attacker's"
    },
    {
      "Time_Start": 83.64,
      "Time_End": 85.2,
      "Text": " perspective."
    },
    {
      "Time_Start": 85.2,
      "Time_End": 89.72000000000001,
      "Text": " For those of you not familiar with Ghostwriter, it's a red team management platform that can"
    },
    {
      "Time_Start": 89.72000000000001,
      "Time_End": 94.92000000000002,
      "Text": " auto-generate reports into a Word document, which is why I was researching the office"
    },
    {
      "Time_Start": 94.92000000000002,
      "Time_End": 96.60000000000001,
      "Text": " document spec."
    },
    {
      "Time_Start": 96.60000000000001,
      "Time_End": 100.12,
      "Text": " Chris Maddalena runs that project, and he gave a talk on it earlier today."
    },
    {
      "Time_Start": 100.12,
      "Time_End": 101.80000000000001,
      "Text": " It's a really cool project."
    },
    {
      "Time_Start": 101.80000000000001,
      "Time_End": 106.80000000000001,
      "Text": " I recommend you check it out if you run a red team or participate in one."
    },
    {
      "Time_Start": 106.8,
      "Time_End": 112.0,
      "Text": " So as I was researching some of this functionality that I found interesting, I also discovered"
    },
    {
      "Time_Start": 112.0,
      "Time_End": 116.28,
      "Text": " that there has already been a lot of blog posts and research in this field by other"
    },
    {
      "Time_Start": 116.28,
      "Time_End": 118.08,
      "Text": " security researchers."
    },
    {
      "Time_Start": 118.08,
      "Time_End": 122.36,
      "Text": " So the point of this talk is to not only present you with a collection of public techniques"
    },
    {
      "Time_Start": 122.36,
      "Time_End": 127.64,
      "Text": " that can help you in your phishing campaign, but also expand on these techniques and highlight"
    },
    {
      "Time_Start": 127.64,
      "Time_End": 132.84,
      "Text": " some areas that I find worthy of research, and in doing so, maybe get you excited enough"
    },
    {
      "Time_Start": 132.84,
      "Time_End": 135.16,
      "Text": " to spend some time and do some research on your own."
    },
    {
      "Time_Start": 135.16,
      "Time_End": 139.56,
      "Text": " Since office document specs, and we're going to be talking about a lot of OLA, it's some"
    },
    {
      "Time_Start": 139.56,
      "Time_End": 140.96,
      "Text": " pretty dry, boring stuff."
    },
    {
      "Time_Start": 140.96,
      "Time_End": 146.2,
      "Text": " But I do think it's worth it if you take the time to research it."
    },
    {
      "Time_Start": 146.2,
      "Time_End": 147.2,
      "Text": " So what's in this talk?"
    },
    {
      "Time_Start": 147.2,
      "Time_End": 153.28,
      "Text": " So we're going to be talking about four different technologies, field codes, ActiveX, OLA-embedded"
    },
    {
      "Time_Start": 153.28,
      "Time_End": 155.8,
      "Text": " objects, smart documents."
    },
    {
      "Time_Start": 155.8,
      "Time_End": 162.68,
      "Text": " Each one, I'm going to go into the common usage, like why does it exist?"
    },
    {
      "Time_Start": 162.68,
      "Time_End": 165.32,
      "Text": " How is it intended to be used?"
    },
    {
      "Time_Start": 165.32,
      "Time_End": 172.28,
      "Text": " Then how it's been used maliciously, followed by some detection, defense, and a field where"
    },
    {
      "Time_Start": 172.28,
      "Time_End": 178.24,
      "Text": " I label it as expand, but really kind of pose some questions and highlight some research"
    },
    {
      "Time_Start": 178.24,
      "Time_End": 186.92000000000002,
      "Text": " areas that I think could be fruitful for office document exploitation in the future."
    },
    {
      "Time_Start": 186.92000000000002,
      "Time_End": 189.8,
      "Text": " So when I talk about office document exploitation, what do I mean?"
    },
    {
      "Time_Start": 189.92000000000002,
      "Time_End": 195.48000000000002,
      "Text": " So I'm sure this is not an all-inclusive list, but there are a big three that I think of"
    },
    {
      "Time_Start": 195.48000000000002,
      "Time_End": 199.48000000000002,
      "Text": " when I think of office documentation, and I have them here ranked from least powerful"
    },
    {
      "Time_Start": 199.48000000000002,
      "Time_End": 201.24,
      "Text": " to most powerful."
    },
    {
      "Time_Start": 201.24,
      "Time_End": 205.0,
      "Text": " So the least powerful of which is a net NTLM v2 hash leak."
    },
    {
      "Time_Start": 205.0,
      "Time_End": 210.96,
      "Text": " So that's anytime you can get the document to connect out to a malicious SMB server where"
    },
    {
      "Time_Start": 210.96,
      "Time_End": 215.76000000000002,
      "Text": " an attacker can get your net NTLM v2 hash for whatever red team purpose, whether it's"
    },
    {
      "Time_Start": 215.76000000000002,
      "Time_End": 218.88000000000002,
      "Text": " to relay or crack or whatever."
    },
    {
      "Time_Start": 218.88,
      "Time_End": 222.48,
      "Text": " Microsoft doesn't really consider this to be worth fixing, frankly, because it's not"
    },
    {
      "Time_Start": 222.48,
      "Time_End": 223.48,
      "Text": " actually a bug."
    },
    {
      "Time_Start": 223.48,
      "Time_End": 229.56,
      "Text": " It's, I mean, it's intended functionality, but they are, these primitives are easy to"
    },
    {
      "Time_Start": 229.56,
      "Time_End": 233.28,
      "Text": " find and they are good to have in your back pocket as a red teamer."
    },
    {
      "Time_Start": 233.28,
      "Time_End": 238.24,
      "Text": " So you always, you always want to be aware of what your options are for that."
    },
    {
      "Time_Start": 238.24,
      "Time_End": 243.32,
      "Text": " Secondly, we have data leakage and that's anytime you can leak the contents of file"
    },
    {
      "Time_Start": 243.32,
      "Time_End": 248.0,
      "Text": " or registry somewhere on the operating system back to an attacker box, you know, they could"
    },
    {
      "Time_Start": 248.12,
      "Time_End": 250.4,
      "Text": " be secrets or whatever."
    },
    {
      "Time_Start": 250.4,
      "Time_End": 256.72,
      "Text": " And then lastly is code execution, of course, and that would be like your VBA macros, like"
    },
    {
      "Time_Start": 256.72,
      "Time_End": 262.6,
      "Text": " DDE auto or ActiveX has some code execution that we'll talk about in a sec."
    },
    {
      "Time_Start": 264.32,
      "Time_End": 269.12,
      "Text": " All right, so before we jump into everything, I want to dedicate one slide to just go over"
    },
    {
      "Time_Start": 269.12,
      "Time_End": 277.72,
      "Text": " what a .docx file is, so anytime you see a file that ends in like .docx or .pptx or .slsx,"
    },
    {
      "Time_Start": 277.72,
      "Time_End": 282.72,
      "Text": " the X at the end indicates that it's an Office Open XML file format."
    },
    {
      "Time_Start": 282.72,
      "Time_End": 284.72,
      "Text": " And what that really means is it's a zip file."
    },
    {
      "Time_Start": 284.72,
      "Time_End": 290.12,
      "Text": " So you can change the extension of any of these to .zip and extract it."
    },
    {
      "Time_Start": 290.12,
      "Time_End": 296.36,
      "Text": " And you can, you can look at each individual spec at the link in this slide, but for the"
    },
    {
      "Time_Start": 296.36,
      "Time_End": 299.0,
      "Text": " purpose of this talk, we're just going to be focusing on Word."
    },
    {
      "Time_Start": 299.0,
      "Time_End": 304.04,
      "Text": " So that's the mstech.x spec."
    },
    {
      "Time_Start": 304.04,
      "Time_End": 308.64000000000004,
      "Text": " So if you were to unzip a .docx file, this is what it would look like."
    },
    {
      "Time_Start": 308.64000000000004,
      "Time_End": 309.76000000000005,
      "Text": " This is the tree structure."
    },
    {
      "Time_Start": 309.76000000000005,
      "Time_End": 317.04,
      "Text": " So you have one file called content types.xml, and then several directories, .props, Word, Rails."
    },
    {
      "Time_Start": 317.04,
      "Time_End": 319.8,
      "Text": " We're not going to be going into all of these files."
    },
    {
      "Time_Start": 319.8,
      "Time_End": 324.40000000000003,
      "Text": " One thing I do want to note, though, is that this document.xml, that's where like the meat"
    },
    {
      "Time_Start": 324.40000000000003,
      "Time_End": 325.28000000000003,
      "Text": " of the document is."
    },
    {
      "Time_Start": 325.28000000000003,
      "Time_End": 330.52000000000004,
      "Text": " So like your raw text, if you were to type into Word, that's where the contents of what"
    },
    {
      "Time_Start": 330.52000000000004,
      "Time_End": 333.36,
      "Text": " you type goes."
    },
    {
      "Time_Start": 333.36,
      "Time_End": 335.64,
      "Text": " So let's jump right into field codes."
    },
    {
      "Time_Start": 335.64,
      "Time_End": 340.72,
      "Text": " Field codes are a way to add some templatization or automation to your documents."
    },
    {
      "Time_Start": 340.72,
      "Time_End": 346.32,
      "Text": " For example, the page field code listed here in the slide can be used to automatically"
    },
    {
      "Time_Start": 346.32,
      "Time_End": 347.68,
      "Text": " number pages."
    },
    {
      "Time_Start": 347.68,
      "Time_End": 352.56,
      "Text": " So the document creator isn't responsible for manually numbering each page or renumbering"
    },
    {
      "Time_Start": 352.56,
      "Time_End": 357.12,
      "Text": " an entire document if they decide to insert a page in the middle somewhere."
    },
    {
      "Time_Start": 357.12,
      "Time_End": 362.8,
      "Text": " Field codes have been around before the Office OpenSpec and are still used routinely today."
    },
    {
      "Time_Start": 362.8,
      "Time_End": 367.44,
      "Text": " And while most of their functionality is mundane, it has been used to perform malicious"
    },
    {
      "Time_Start": 367.44,
      "Time_End": 367.92,
      "Text": " behavior."
    },
    {
      "Time_Start": 367.92,
      "Time_End": 371.76,
      "Text": " So we need to dig into how they work so we know how to abuse them."
    },
    {
      "Time_Start": 375.04,
      "Time_End": 381.6,
      "Text": " So here's just here's a video of me inserting a field code into a blank Word document."
    },
    {
      "Time_Start": 387.8,
      "Time_End": 391.36,
      "Text": " And you'll see here, this is a list of all the field codes, so you should already be"
    },
    {
      "Time_Start": 391.36,
      "Time_End": 394.0,
      "Text": " thinking, like, this is a lot of attack surface."
    },
    {
      "Time_Start": 394.0,
      "Time_End": 395.6,
      "Text": " There's a lot of things I can mess with."
    },
    {
      "Time_Start": 397.24,
      "Time_End": 401.36,
      "Text": " But for the sake of this demo, we're just going to throw in an author field code."
    },
    {
      "Time_Start": 401.68,
      "Time_End": 403.32,
      "Text": " I'm going to put my handle in here."
    },
    {
      "Time_Start": 406.92,
      "Time_End": 407.44,
      "Text": " OK."
    },
    {
      "Time_Start": 408.8,
      "Time_End": 413.64,
      "Text": " So you should see that the text here looks like normal text, you would never notice that"
    },
    {
      "Time_Start": 413.64,
      "Time_End": 418.6,
      "Text": " it's not just standard typed out text."
    },
    {
      "Time_Start": 419.0,
      "Time_End": 423.48,
      "Text": " But if you were to right click on it and toggle field codes, you can see that it's actually"
    },
    {
      "Time_Start": 423.48,
      "Time_End": 425.96000000000004,
      "Text": " being treated differently by the word processor."
    },
    {
      "Time_Start": 427.96000000000004,
      "Time_End": 429.84000000000003,
      "Text": " Let's take a look at what that looks like under the hood."
    },
    {
      "Time_Start": 429.84000000000003,
      "Time_End": 436.20000000000005,
      "Text": " So if we take that document from the previous slide, save it and extract it, we can open up"
    },
    {
      "Time_Start": 436.20000000000005,
      "Time_End": 443.44,
      "Text": " document.xml and you'll see that there's an XML field here called FLDSimple with a W"
    },
    {
      "Time_Start": 443.44,
      "Time_End": 445.20000000000005,
      "Text": " colon and INSTR."
    },
    {
      "Time_Start": 446.08,
      "Time_End": 452.2,
      "Text": " And so I look at that and I immediately think that's something we can mess around with."
    },
    {
      "Time_Start": 452.92,
      "Time_End": 456.8,
      "Text": " For example, you know, Word presents us with all these field codes."
    },
    {
      "Time_Start": 457.0,
      "Time_End": 461.2,
      "Text": " Are there any field codes that Word doesn't present us that we can put in here or what kind"
    },
    {
      "Time_Start": 461.2,
      "Time_End": 465.56,
      "Text": " of things can we mess with by extracting this and changing it?"
    },
    {
      "Time_Start": 465.88,
      "Time_End": 470.96,
      "Text": " We'll see that there actually has been malicious usage of field codes in this manner."
    },
    {
      "Time_Start": 470.96,
      "Time_End": 473.36,
      "Text": " So the first one is include picture."
    },
    {
      "Time_Start": 474.08,
      "Time_End": 478.8,
      "Text": " And so if you were to extract that file and replace it with include picture, include"
    },
    {
      "Time_Start": 478.8,
      "Time_End": 483.08,
      "Text": " pictures of field code that surprisingly includes pictures in your office document."
    },
    {
      "Time_Start": 483.72,
      "Time_End": 490.84000000000003,
      "Text": " But if you provide it an SMB or a UNC pass to an SMB server, that will leak out your net"
    },
    {
      "Time_Start": 490.96000000000004,
      "Time_End": 493.08000000000004,
      "Text": " NTLMv2 hash to an attacker."
    },
    {
      "Time_Start": 493.08000000000004,
      "Time_End": 498.08000000000004,
      "Text": " And so that's a popular usage of field codes for malicious purposes."
    },
    {
      "Time_Start": 498.08000000000004,
      "Time_End": 504.36,
      "Text": " And then secondly, a couple of years ago, a few years ago, there was DDE, DDE auto"
    },
    {
      "Time_Start": 504.36,
      "Time_End": 511.20000000000005,
      "Text": " exploits. And by including that DDE field code, you can actually do arbitrary code"
    },
    {
      "Time_Start": 511.20000000000005,
      "Time_End": 513.1600000000001,
      "Text": " execution just by starting up programs."
    },
    {
      "Time_Start": 513.72,
      "Time_End": 516.5600000000001,
      "Text": " And so I actually wasn't able to find a way to do that."
    },
    {
      "Time_Start": 517.08,
      "Time_End": 523.36,
      "Text": " And so I actually wasn't able to find a consensus on if that has been fully fixed or not."
    },
    {
      "Time_Start": 523.36,
      "Time_End": 527.8000000000001,
      "Text": " I've tried it in my word processor and couldn't get it to work."
    },
    {
      "Time_Start": 527.8000000000001,
      "Time_End": 532.12,
      "Text": " I've been able to get some warning messages, but I definitely try for yourself."
    },
    {
      "Time_Start": 532.12,
      "Time_End": 534.12,
      "Text": " I suspect that it's been fixed, though."
    },
    {
      "Time_Start": 534.96,
      "Time_End": 539.5200000000001,
      "Text": " And then lastly, there's a really cool blog post by Peter Seelan."
    },
    {
      "Time_Start": 539.5200000000001,
      "Time_End": 544.7600000000001,
      "Text": " I'm hoping I'm pronouncing that right, where they chain a handful of field codes"
    },
    {
      "Time_Start": 544.76,
      "Time_End": 547.56,
      "Text": " together to leak out file contents."
    },
    {
      "Time_Start": 547.96,
      "Time_End": 551.88,
      "Text": " So one of the cool things about field codes is that you can embed them such that they get"
    },
    {
      "Time_Start": 551.88,
      "Time_End": 553.08,
      "Text": " processed inside out."
    },
    {
      "Time_Start": 553.6,
      "Time_End": 556.76,
      "Text": " So in this example, you can see that we're including text."
    },
    {
      "Time_Start": 556.76,
      "Time_End": 558.68,
      "Text": " So that's like get the contents of a file."
    },
    {
      "Time_Start": 559.08,
      "Time_End": 565.4399999999999,
      "Text": " So we're getting the contents of a file at ca.txt, appending it to a URL and then calling"
    },
    {
      "Time_Start": 565.4399999999999,
      "Time_End": 570.36,
      "Text": " include picture on that URL, which is going to leak the file contents in the form of a get"
    },
    {
      "Time_Start": 570.36,
      "Time_End": 572.6,
      "Text": " request to a malicious web server."
    },
    {
      "Time_Start": 573.32,
      "Time_End": 576.9200000000001,
      "Text": " All right, so let's see what that attack looks like from the previous slide."
    },
    {
      "Time_Start": 577.72,
      "Time_End": 581.32,
      "Text": " So I took the field code from the previous slide and put it in this document."
    },
    {
      "Time_Start": 581.32,
      "Time_End": 584.28,
      "Text": " I changed it a little bit to point to a different file."
    },
    {
      "Time_Start": 584.28,
      "Time_End": 588.52,
      "Text": " As you can see here, we're going to get the contents of ctemp secret.txt."
    },
    {
      "Time_Start": 589.4,
      "Time_End": 595.16,
      "Text": " And then we're going to leak that to a URL on a local server of port 8000."
    },
    {
      "Time_Start": 595.64,
      "Time_End": 600.28,
      "Text": " And so as you see, if a user were to open this, they would actually get this error message"
    },
    {
      "Time_Start": 600.28,
      "Time_End": 603.9599999999999,
      "Text": " here called this document contains fields that can share data with external files."
    },
    {
      "Time_Start": 605.0799999999999,
      "Time_End": 609.64,
      "Text": " So it's not a perfect attack, but most users are not familiar with this message."
    },
    {
      "Time_Start": 609.64,
      "Time_End": 613.9599999999999,
      "Text": " And I would suspect that some would click yes on this."
    },
    {
      "Time_Start": 614.68,
      "Time_End": 620.36,
      "Text": " So you could see if they click yes, you can see we got some get requests here and the"
    },
    {
      "Time_Start": 620.36,
      "Time_End": 623.16,
      "Text": " contents of the file is super secret text OMG."
    },
    {
      "Time_Start": 623.72,
      "Time_End": 628.76,
      "Text": " And so that is just kind of a toy example of the power of field codes and how you can"
    },
    {
      "Time_Start": 628.76,
      "Time_End": 630.04,
      "Text": " leak out file contents."
    },
    {
      "Time_Start": 630.6,
      "Time_End": 635.64,
      "Text": " So a realistic example would be if there was some configuration file or XML file that you"
    },
    {
      "Time_Start": 635.64,
      "Time_End": 639.72,
      "Text": " knew existed on the target box and that's all you needed, then this would be perfect"
    },
    {
      "Time_Start": 639.72,
      "Time_End": 640.84,
      "Text": " for you for your red team."
    },
    {
      "Time_Start": 643.96,
      "Time_End": 648.4399999999999,
      "Text": " So what have people done to defend and protect themselves against these field code attacks?"
    },
    {
      "Time_Start": 648.4399999999999,
      "Time_End": 653.3199999999999,
      "Text": " So first and foremost, Microsoft added the warning message that you saw on the previous"
    },
    {
      "Time_Start": 653.88,
      "Time_End": 654.44,
      "Text": " slide."
    },
    {
      "Time_Start": 656.36,
      "Time_End": 659.4000000000001,
      "Text": " And then DDE, DDE auto is most likely neutered."
    },
    {
      "Time_Start": 660.44,
      "Time_End": 667.24,
      "Text": " But if I were to scan office documents that were coming into my enterprise, I would actually"
    },
    {
      "Time_Start": 667.24,
      "Time_End": 671.96,
      "Text": " either whitelist field codes that I knew we used, which I would assume is pretty, pretty"
    },
    {
      "Time_Start": 671.96,
      "Time_End": 677.0,
      "Text": " small, or at least blacklist some of the more popular ones like include text or include"
    },
    {
      "Time_Start": 677.0,
      "Time_End": 679.1600000000001,
      "Text": " picture, import those things."
    },
    {
      "Time_Start": 679.16,
      "Time_End": 683.88,
      "Text": " Since it's a part of an XML structure, I imagine it'd be pretty easy to parse out and"
    },
    {
      "Time_Start": 683.88,
      "Time_End": 684.4399999999999,
      "Text": " check for."
    },
    {
      "Time_Start": 688.28,
      "Time_End": 693.0799999999999,
      "Text": " So let's look at what we can do with field codes going forward."
    },
    {
      "Time_Start": 694.04,
      "Time_End": 699.0799999999999,
      "Text": " So the fact that field codes can be nested is really, really interesting to me."
    },
    {
      "Time_Start": 699.0799999999999,
      "Time_End": 703.48,
      "Text": " And if you saw some of the field codes that were listed out before, we have things like"
    },
    {
      "Time_Start": 703.48,
      "Time_End": 707.48,
      "Text": " if compare next that we could set variables."
    },
    {
      "Time_Start": 707.48,
      "Time_End": 710.12,
      "Text": " So this is starting to look like a full-blown programming language."
    },
    {
      "Time_Start": 710.76,
      "Time_End": 717.08,
      "Text": " And so one thing I'd really like to look into is if we can get around that error message"
    },
    {
      "Time_Start": 717.08,
      "Time_End": 723.08,
      "Text": " that says you're leaking out file contents by obscuring where the source of that data"
    },
    {
      "Time_Start": 723.08,
      "Time_End": 723.8000000000001,
      "Text": " came from."
    },
    {
      "Time_Start": 723.8000000000001,
      "Time_End": 728.2,
      "Text": " Because you can call include picture on static text, and you won't get that message."
    },
    {
      "Time_Start": 728.36,
      "Time_End": 735.5600000000001,
      "Text": " So if you can somehow loop through or set cells or do something to bypass that message,"
    },
    {
      "Time_Start": 735.5600000000001,
      "Time_End": 737.1600000000001,
      "Text": " that would be super cool."
    },
    {
      "Time_Start": 737.1600000000001,
      "Time_End": 740.76,
      "Text": " But I spent most of my time looking at the link field code."
    },
    {
      "Time_Start": 743.24,
      "Time_End": 746.76,
      "Text": " And so link was a recommended replacement for DDE."
    },
    {
      "Time_Start": 748.44,
      "Time_End": 754.2,
      "Text": " What this means is link is intended to be used to create Olay links."
    },
    {
      "Time_Start": 754.2,
      "Time_End": 755.72,
      "Text": " And we're going to cover Olay in a sec."
    },
    {
      "Time_Start": 755.72,
      "Time_End": 757.64,
      "Text": " But it's been used to create Olay links."
    },
    {
      "Time_Start": 757.64,
      "Time_End": 761.8000000000001,
      "Text": " And so if you go into Word, it's going to look like this."
    },
    {
      "Time_Start": 762.76,
      "Time_End": 769.08,
      "Text": " You're going to have the option to select a program like Excel.chart.8 or package or"
    },
    {
      "Time_Start": 769.08,
      "Time_End": 772.0400000000001,
      "Text": " paint.picture and then provide a file."
    },
    {
      "Time_Start": 772.0400000000001,
      "Time_End": 773.8000000000001,
      "Text": " So let's see what that looks like."
    },
    {
      "Time_Start": 774.6,
      "Time_End": 781.1600000000001,
      "Text": " So here I have, I unzipped a Office document, a Word document, and replaced it with that"
    },
    {
      "Time_Start": 781.1600000000001,
      "Time_End": 787.4000000000001,
      "Text": " field code that you saw on the previous slide where we have link, Excel, and then a file"
    },
    {
      "Time_Start": 787.4000000000001,
      "Time_End": 787.96,
      "Text": " name."
    },
    {
      "Time_Start": 788.7600000000001,
      "Time_End": 792.6,
      "Text": " And so you open it, and it will warn you that the link refers to other files."
    },
    {
      "Time_Start": 792.6,
      "Time_End": 794.6,
      "Text": " So let's click yes."
    },
    {
      "Time_Start": 794.6,
      "Time_End": 797.6400000000001,
      "Text": " And then on the left, I have ProcMon filtering for Excel."
    },
    {
      "Time_Start": 797.6400000000001,
      "Time_End": 800.84,
      "Text": " And then on the right, I have ProcMod filtering for Excel."
    },
    {
      "Time_Start": 800.9200000000001,
      "Time_End": 803.72,
      "Text": " And then on the left, I have ProcMon filtering for Excel."
    },
    {
      "Time_Start": 808.9200000000001,
      "Time_End": 812.0400000000001,
      "Text": " So you see that the Excel process was actually created."
    },
    {
      "Time_Start": 812.0400000000001,
      "Time_End": 815.32,
      "Text": " And then we got part of a spreadsheet inside our Word document."
    },
    {
      "Time_Start": 816.2,
      "Time_End": 823.24,
      "Text": " So what I was expecting was process creation of Excel with the file path as a part of the"
    },
    {
      "Time_Start": 823.24,
      "Time_End": 824.2800000000001,
      "Text": " parameter."
    },
    {
      "Time_Start": 824.2800000000001,
      "Time_End": 829.48,
      "Text": " But if we look at this, we'll see that the process was only created with this tack embedding"
    },
    {
      "Time_Start": 829.48,
      "Time_End": 829.8000000000001,
      "Text": " flag."
    },
    {
      "Time_Start": 835.96,
      "Time_End": 842.04,
      "Text": " You may be wondering, if I can unzip a file and manually replace the ProcID, what other"
    },
    {
      "Time_Start": 842.04,
      "Time_End": 847.4,
      "Text": " programs can I get to run besides Excel or the programs provided to me in the Word link"
    },
    {
      "Time_Start": 847.4,
      "Time_End": 847.8000000000001,
      "Text": " prompt?"
    },
    {
      "Time_Start": 848.6,
      "Time_End": 854.6800000000001,
      "Text": " So to test this, I unzipped the Office document and replaced Excel.sheet with a ProcID of"
    },
    {
      "Time_Start": 854.6800000000001,
      "Time_End": 855.5600000000001,
      "Text": " HTA file."
    },
    {
      "Time_Start": 856.1200000000001,
      "Time_End": 859.24,
      "Text": " I then pointed the file path to an HTML application file."
    },
    {
      "Time_Start": 860.1200000000001,
      "Time_End": 864.2,
      "Text": " HTML applications are interesting from an attacker perspective because they contain"
    },
    {
      "Time_Start": 864.2,
      "Time_End": 869.8000000000001,
      "Text": " embedded JScript or VBScript that will bootstrap code execution when opened by Internet Explorer"
    },
    {
      "Time_Start": 869.8000000000001,
      "Time_End": 871.72,
      "Text": " or its native handler, Mishta."
    },
    {
      "Time_Start": 872.6800000000001,
      "Time_End": 877.96,
      "Text": " So I then re-zipped the file and tried to open it in Word while ProcMon was running"
    },
    {
      "Time_Start": 877.96,
      "Time_End": 881.32,
      "Text": " to see if Mishta was created like Excel in our previous example."
    },
    {
      "Time_Start": 881.96,
      "Time_End": 887.8000000000001,
      "Text": " So ProcMon shows that the process was created and proving that we can replace the contents"
    },
    {
      "Time_Start": 887.8000000000001,
      "Time_End": 892.6,
      "Text": " of a ProcID and file path and create processes that were never intended to be created."
    },
    {
      "Time_Start": 893.4000000000001,
      "Time_End": 897.48,
      "Text": " But the question is, will this actually run the HTA file that was passed to it?"
    },
    {
      "Time_Start": 899.5600000000001,
      "Time_End": 900.2800000000001,
      "Text": " And the answer is no."
    },
    {
      "Time_Start": 901.1600000000001,
      "Time_End": 906.6,
      "Text": " So just like the Excel example, the Mishta server was started with this embedding flag"
    },
    {
      "Time_Start": 906.6,
      "Time_End": 912.12,
      "Text": " and the Mishta.exe was started and initialized as a COM server, but the link object, which"
    },
    {
      "Time_Start": 912.12,
      "Time_End": 915.16,
      "Text": " is the HTA file, was never activated."
    },
    {
      "Time_Start": 917.48,
      "Time_End": 923.4,
      "Text": " So if you ever see a process with tech embedding as an argument, that means the executable"
    },
    {
      "Time_Start": 923.4,
      "Time_End": 929.32,
      "Text": " was started as a COM server on behalf of another process who initialized the COM component"
    },
    {
      "Time_Start": 929.32,
      "Time_End": 931.1600000000001,
      "Text": " implemented by the executable."
    },
    {
      "Time_Start": 931.16,
      "Time_End": 936.68,
      "Text": " So the process is not meant to be interacted with as a user or via a user interface."
    },
    {
      "Time_Start": 937.24,
      "Time_End": 941.56,
      "Text": " And in our case of Olay, it's considered an object container application."
    },
    {
      "Time_Start": 942.68,
      "Time_End": 945.0799999999999,
      "Text": " So if this doesn't make any sense, you're in luck."
    },
    {
      "Time_Start": 945.0799999999999,
      "Time_End": 946.36,
      "Text": " It's about to make less sense."
    },
    {
      "Time_Start": 947.0799999999999,
      "Time_End": 952.12,
      "Text": " I'm going to talk at you for about five to 10 minutes on a topic that I thought was dead"
    },
    {
      "Time_Start": 952.12,
      "Time_End": 956.04,
      "Text": " around 2005, which is the wonderful world of Olay."
    },
    {
      "Time_Start": 956.6,
      "Time_End": 959.56,
      "Text": " And then we're going to come back to field codes and apply what we've learned."
    },
    {
      "Time_Start": 962.12,
      "Time_End": 965.48,
      "Text": " Now, you can't really talk about Olay without talking about COM."
    },
    {
      "Time_Start": 967.64,
      "Time_End": 976.04,
      "Text": " So the hardest part of getting this talk together was figuring out how to give a concise talk"
    },
    {
      "Time_Start": 976.04,
      "Time_End": 981.0,
      "Text": " about Olay and COM, because they're really complex and very old."
    },
    {
      "Time_Start": 981.88,
      "Time_End": 983.0,
      "Text": " But I'm going to do my best."
    },
    {
      "Time_Start": 984.1999999999999,
      "Time_End": 988.12,
      "Text": " And definitely, I'm going to put some links at the end, too, so you can research Olay."
    },
    {
      "Time_Start": 989.08,
      "Time_End": 994.12,
      "Text": " But this is my best effort to try to condense this down to hopefully about 10 minutes."
    },
    {
      "Time_Start": 995.0,
      "Time_End": 1000.12,
      "Text": " So if you're not familiar with COM, COM is basically just a fancy binary interface standard."
    },
    {
      "Time_Start": 1000.68,
      "Time_End": 1004.52,
      "Text": " It was so that Windows can you can create components in different languages, and they"
    },
    {
      "Time_Start": 1004.52,
      "Time_End": 1005.96,
      "Text": " can talk with each other."
    },
    {
      "Time_Start": 1005.96,
      "Time_End": 1009.5600000000001,
      "Text": " So that's not really a new concept in software engineering."
    },
    {
      "Time_Start": 1009.5600000000001,
      "Time_End": 1012.36,
      "Text": " It probably was at the time, because it's like 30 years old."
    },
    {
      "Time_Start": 1013.8,
      "Time_End": 1017.08,
      "Text": " But things you need to know are each COM component gets a class ID."
    },
    {
      "Time_Start": 1018.12,
      "Time_End": 1020.68,
      "Text": " Which you'll see here on the right, these long UUIDs."
    },
    {
      "Time_Start": 1020.68,
      "Time_End": 1021.72,
      "Text": " Those are class IDs."
    },
    {
      "Time_Start": 1022.44,
      "Time_End": 1027.08,
      "Text": " And then they typically get a prog ID if they're a part of Olay."
    },
    {
      "Time_Start": 1028.36,
      "Time_End": 1031.96,
      "Text": " So all COM components export interfaces."
    },
    {
      "Time_Start": 1032.68,
      "Time_End": 1036.12,
      "Text": " Every COM component exports at least one, which is IUnknown."
    },
    {
      "Time_Start": 1036.76,
      "Time_End": 1041.08,
      "Text": " And that allows others to ask, what other interfaces do you support?"
    },
    {
      "Time_Start": 1041.08,
      "Time_End": 1044.52,
      "Text": " So it's kind of an interface to tell you what other interfaces it supports."
    },
    {
      "Time_Start": 1045.4,
      "Time_End": 1050.12,
      "Text": " And so you can dynamically look up a COM class that implements an interface."
    },
    {
      "Time_Start": 1050.12,
      "Time_End": 1054.92,
      "Text": " So any COM class I can initialize and say, hey, do you support this interface?"
    },
    {
      "Time_Start": 1054.92,
      "Time_End": 1055.8799999999999,
      "Text": " And it'll say yes or no."
    },
    {
      "Time_Start": 1055.8799999999999,
      "Time_End": 1058.52,
      "Text": " And if it does, it'll give you a pointer to that interface."
    },
    {
      "Time_Start": 1058.52,
      "Time_End": 1060.12,
      "Text": " So you can call functions on it."
    },
    {
      "Time_Start": 1061.96,
      "Time_End": 1064.2,
      "Text": " So hopefully that clears mud."
    },
    {
      "Time_Start": 1066.2,
      "Time_End": 1067.32,
      "Text": " So talking about Olay."
    },
    {
      "Time_Start": 1067.32,
      "Time_End": 1069.96,
      "Text": " So Olay is just really an implementation of COM."
    },
    {
      "Time_Start": 1071.08,
      "Time_End": 1073.4,
      "Text": " So Olay stands for object linking and embedding."
    },
    {
      "Time_Start": 1074.0400000000002,
      "Time_End": 1077.72,
      "Text": " So it was a technology that was built on COM, also around 1990."
    },
    {
      "Time_Start": 1079.0800000000002,
      "Time_End": 1083.8000000000002,
      "Text": " So any COM class that implements IOlay object is technically Olay aware."
    },
    {
      "Time_Start": 1084.8400000000001,
      "Time_End": 1091.64,
      "Text": " So the textbook use case for this is, you know, like if you have an Excel spreadsheet"
    },
    {
      "Time_Start": 1091.64,
      "Time_End": 1093.88,
      "Text": " and you copy and paste it into a Word document,"
    },
    {
      "Time_Start": 1093.88,
      "Time_End": 1097.16,
      "Text": " you can edit the spreadsheet in the Word document."
    },
    {
      "Time_Start": 1097.16,
      "Time_End": 1101.3200000000002,
      "Text": " Or you can drag and drop, let's say, a sound file into a Word document"
    },
    {
      "Time_Start": 1101.32,
      "Time_End": 1105.08,
      "Text": " and play it without having to open up a secondary, you know,"
    },
    {
      "Time_Start": 1105.08,
      "Time_End": 1106.9199999999998,
      "Text": " Windows Media Player or something like that."
    },
    {
      "Time_Start": 1107.72,
      "Time_End": 1112.12,
      "Text": " So there's a bunch of Olay interfaces and how they're used"
    },
    {
      "Time_Start": 1112.12,
      "Time_End": 1114.04,
      "Text": " depends on which interfaces are exported."
    },
    {
      "Time_Start": 1115.6399999999999,
      "Time_End": 1120.36,
      "Text": " And for an example, all the black bullet points in this spreadsheet"
    },
    {
      "Time_Start": 1120.36,
      "Time_End": 1121.6399999999999,
      "Text": " is actually a Word document."
    },
    {
      "Time_Start": 1122.36,
      "Time_End": 1125.1599999999999,
      "Text": " And if you were editing this and you were to double click it,"
    },
    {
      "Time_Start": 1125.1599999999999,
      "Time_End": 1126.28,
      "Text": " it would open it in Word."
    },
    {
      "Time_Start": 1126.28,
      "Time_End": 1130.28,
      "Text": " So just to give you an idea of like, what was the intended purpose of this?"
    },
    {
      "Time_Start": 1131.56,
      "Time_End": 1133.32,
      "Text": " So we're going to have to go over some terminology."
    },
    {
      "Time_Start": 1134.6,
      "Time_End": 1139.32,
      "Text": " Olay has container applications, compound documents, objects, and object applications."
    },
    {
      "Time_Start": 1140.36,
      "Time_End": 1144.6799999999998,
      "Text": " So WordPad, in this example on the right, I took this from MSDN documentation."
    },
    {
      "Time_Start": 1145.3999999999999,
      "Time_End": 1149.6399999999999,
      "Text": " So you have kind of this scenario I was talking about in the previous slide,"
    },
    {
      "Time_Start": 1149.6399999999999,
      "Time_End": 1155.08,
      "Text": " which is you have an embedded object, which is editable by another object,"
    },
    {
      "Time_Start": 1155.08,
      "Time_End": 1157.3999999999999,
      "Text": " but it can be displayed in WordPad."
    },
    {
      "Time_Start": 1158.04,
      "Time_End": 1160.9199999999998,
      "Text": " So in this example, WordPad is the container application."
    },
    {
      "Time_Start": 1161.72,
      "Time_End": 1164.84,
      "Text": " And then the WordPad document is called a compound document."
    },
    {
      "Time_Start": 1165.56,
      "Time_End": 1167.96,
      "Text": " And then the drawing itself is the object."
    },
    {
      "Time_Start": 1167.96,
      "Time_End": 1169.56,
      "Text": " And those can be linked or embedded."
    },
    {
      "Time_Start": 1170.28,
      "Time_End": 1172.4399999999998,
      "Text": " And then Scribble is the object application."
    },
    {
      "Time_Start": 1172.4399999999998,
      "Time_End": 1177.56,
      "Text": " So the naming conventions did not help with the clarity of Olay."
    },
    {
      "Time_Start": 1181.08,
      "Time_End": 1183.32,
      "Text": " And then another big component of Olay,"
    },
    {
      "Time_Start": 1183.32,
      "Time_End": 1185.96,
      "Text": " especially in the context of compound documents,"
    },
    {
      "Time_Start": 1187.0,
      "Time_End": 1189.1599999999999,
      "Text": " is this compound file binary format."
    },
    {
      "Time_Start": 1189.8000000000002,
      "Time_End": 1193.0800000000002,
      "Text": " And this is how a lot of Olay components are saved."
    },
    {
      "Time_Start": 1193.0800000000002,
      "Time_End": 1195.72,
      "Text": " They're reference all column compound files."
    },
    {
      "Time_Start": 1195.72,
      "Time_End": 1197.3200000000002,
      "Text": " I've heard them referenced as compound files."
    },
    {
      "Time_Start": 1197.3200000000002,
      "Time_End": 1198.3600000000001,
      "Text": " So I'm going to stick with that."
    },
    {
      "Time_Start": 1198.92,
      "Time_End": 1202.2,
      "Text": " But in essence, it's like a file system in its own file."
    },
    {
      "Time_Start": 1203.0800000000002,
      "Time_End": 1207.5600000000002,
      "Text": " So you have this notion of storage containers, like this activex1.bin."
    },
    {
      "Time_Start": 1208.28,
      "Time_End": 1210.44,
      "Text": " And in each stream is a file."
    },
    {
      "Time_Start": 1210.44,
      "Time_End": 1214.92,
      "Text": " So like contents is a file, and it has an actual byte stream associated with it."
    },
    {
      "Time_Start": 1215.64,
      "Time_End": 1218.68,
      "Text": " And so each compound file at the beginning,"
    },
    {
      "Time_Start": 1218.68,
      "Time_End": 1221.8000000000002,
      "Text": " you'll see here on the right, has a class ID associated with it."
    },
    {
      "Time_Start": 1221.8000000000002,
      "Time_End": 1225.24,
      "Text": " And so when Olay initializes it, it's going to look up that class ID"
    },
    {
      "Time_Start": 1226.68,
      "Time_End": 1229.16,
      "Text": " so it knows which program is meant to handle it."
    },
    {
      "Time_Start": 1231.64,
      "Time_End": 1234.1200000000001,
      "Text": " I mentioned a couple of slides ago, linking embedding."
    },
    {
      "Time_Start": 1234.1200000000001,
      "Time_End": 1236.04,
      "Text": " So this is pretty straightforward."
    },
    {
      "Time_Start": 1236.04,
      "Time_End": 1240.04,
      "Text": " If you link an object, it just means exactly what it sounds like."
    },
    {
      "Time_Start": 1240.04,
      "Time_End": 1242.04,
      "Text": " It's a link to an existing object."
    },
    {
      "Time_Start": 1243.0,
      "Time_End": 1246.2,
      "Text": " If you embed an object, it actually gets saved with the document."
    },
    {
      "Time_Start": 1246.2,
      "Time_End": 1251.1599999999999,
      "Text": " So if I were to embed a like a wave file or an mp3 of video,"
    },
    {
      "Time_Start": 1251.1599999999999,
      "Time_End": 1253.24,
      "Text": " that gets saved inside the document,"
    },
    {
      "Time_Start": 1253.24,
      "Time_End": 1256.28,
      "Text": " as opposed to link where it's just typically a file path,"
    },
    {
      "Time_Start": 1256.28,
      "Time_End": 1258.44,
      "Text": " but could be any kind of moniker."
    },
    {
      "Time_Start": 1263.48,
      "Time_End": 1268.2,
      "Text": " And so we have to go over mproc server, mproc handler, and local server."
    },
    {
      "Time_Start": 1268.2,
      "Time_End": 1271.72,
      "Text": " So when you initialize an embedded object,"
    },
    {
      "Time_Start": 1271.96,
      "Time_End": 1274.84,
      "Text": " you'll attempt to initialize components in this order."
    },
    {
      "Time_Start": 1274.84,
      "Time_End": 1277.0,
      "Text": " So it's going to go in the registry"
    },
    {
      "Time_Start": 1277.0,
      "Time_End": 1279.56,
      "Text": " and look for something registered under mproc server."
    },
    {
      "Time_Start": 1280.2,
      "Time_End": 1282.6000000000001,
      "Text": " And so when there's an mproc server, that's essentially saying,"
    },
    {
      "Time_Start": 1282.6000000000001,
      "Time_End": 1286.68,
      "Text": " I have a DLL that's going to implement all the functionality"
    },
    {
      "Time_Start": 1286.68,
      "Time_End": 1289.56,
      "Text": " for this com object, and you're going to load it into your own process."
    },
    {
      "Time_Start": 1291.0,
      "Time_End": 1295.32,
      "Text": " If it's an mproc handler, that means that there is a custom handler"
    },
    {
      "Time_Start": 1296.3600000000001,
      "Time_End": 1298.76,
      "Text": " that will handle some of the Olay functionality,"
    },
    {
      "Time_Start": 1298.76,
      "Time_End": 1301.32,
      "Text": " but it's still going to rely on an external server."
    },
    {
      "Time_Start": 1301.8,
      "Time_End": 1304.2,
      "Text": " So if you go through the registry and look at mproc handler,"
    },
    {
      "Time_Start": 1304.2,
      "Time_End": 1307.32,
      "Text": " it's almost always going to say olay32.dll."
    },
    {
      "Time_Start": 1307.32,
      "Time_End": 1309.24,
      "Text": " And that's just the default handler."
    },
    {
      "Time_Start": 1309.88,
      "Time_End": 1312.28,
      "Text": " And even if you don't specify mproc handler,"
    },
    {
      "Time_Start": 1312.28,
      "Time_End": 1313.8,
      "Text": " it's going to load olay32."
    },
    {
      "Time_Start": 1314.6000000000001,
      "Time_End": 1317.64,
      "Text": " And the handler is essentially responsible"
    },
    {
      "Time_Start": 1317.64,
      "Time_End": 1322.76,
      "Text": " for inter-process communication with the Olay server"
    },
    {
      "Time_Start": 1322.76,
      "Time_End": 1324.6000000000001,
      "Text": " that actually runs in a separate process."
    },
    {
      "Time_Start": 1325.56,
      "Time_End": 1331.32,
      "Text": " So if mproc server isn't specified, a local server has to be specified."
    },
    {
      "Time_Start": 1331.96,
      "Time_End": 1337.72,
      "Text": " And that will be the exe that is the object application"
    },
    {
      "Time_Start": 1337.72,
      "Time_End": 1339.96,
      "Text": " that is responsible for creating those objects."
    },
    {
      "Time_Start": 1342.6000000000001,
      "Time_End": 1347.48,
      "Text": " So this is a page that I found on Microsoft documentation"
    },
    {
      "Time_Start": 1347.48,
      "Time_End": 1348.44,
      "Text": " that was super helpful."
    },
    {
      "Time_Start": 1349.16,
      "Time_End": 1352.1200000000001,
      "Text": " This lays out the different interfaces"
    },
    {
      "Time_Start": 1352.1200000000001,
      "Time_End": 1356.44,
      "Text": " that are required in different Olay components."
    },
    {
      "Time_Start": 1356.44,
      "Time_End": 1360.76,
      "Text": " So if you are an out-of-process Olay object,"
    },
    {
      "Time_Start": 1360.76,
      "Time_End": 1364.92,
      "Text": " you have to implement IOlay object, IData object, IPersist storage."
    },
    {
      "Time_Start": 1364.92,
      "Time_End": 1369.8,
      "Text": " If you're mproc, that is, if you specified your own in-process server,"
    },
    {
      "Time_Start": 1370.44,
      "Time_End": 1374.52,
      "Text": " then your object needs to implement all the three previously,"
    },
    {
      "Time_Start": 1374.52,
      "Time_End": 1377.4,
      "Text": " plus IViewObject2 and IOlayCache2."
    },
    {
      "Time_Start": 1381.4,
      "Time_End": 1382.52,
      "Text": " And so you might be wondering,"
    },
    {
      "Time_Start": 1382.52,
      "Time_End": 1386.2,
      "Text": " okay, so there's all these class IDs in the registry."
    },
    {
      "Time_Start": 1386.2,
      "Time_End": 1390.76,
      "Text": " How do I know which classes implement which interfaces?"
    },
    {
      "Time_Start": 1391.72,
      "Time_End": 1393.64,
      "Text": " And you can do that with OlayView."
    },
    {
      "Time_Start": 1393.64,
      "Time_End": 1396.04,
      "Text": " So with OlayView, there's two pictures here."
    },
    {
      "Time_Start": 1396.68,
      "Time_End": 1401.32,
      "Text": " You can browse all the con classes, all the registered Olay classes,"
    },
    {
      "Time_Start": 1401.32,
      "Time_End": 1403.48,
      "Text": " and see which interfaces that they support."
    },
    {
      "Time_Start": 1407.0800000000002,
      "Time_End": 1409.8,
      "Text": " But I want to query all the classes that support things"
    },
    {
      "Time_Start": 1409.8,
      "Time_End": 1412.68,
      "Text": " like IOlay object, IData object, and IPersist file."
    },
    {
      "Time_Start": 1412.68,
      "Time_End": 1414.8400000000001,
      "Text": " So if you were to do that with OlayView,"
    },
    {
      "Time_Start": 1414.84,
      "Time_End": 1416.28,
      "Text": " you just have to go through each one"
    },
    {
      "Time_Start": 1416.28,
      "Time_End": 1419.8799999999999,
      "Text": " and make a note of which con classes had all three,"
    },
    {
      "Time_Start": 1419.8799999999999,
      "Time_End": 1421.0,
      "Text": " which would take a long time."
    },
    {
      "Time_Start": 1421.6399999999999,
      "Time_End": 1424.76,
      "Text": " So I wrote a tool to help with that called ComMapper."
    },
    {
      "Time_Start": 1425.3999999999999,
      "Time_End": 1428.04,
      "Text": " And ComMapper attempts to initialize every class"
    },
    {
      "Time_Start": 1429.0,
      "Time_End": 1432.6799999999998,
      "Text": " under a class ID and then call query interface"
    },
    {
      "Time_Start": 1432.6799999999998,
      "Time_End": 1437.32,
      "Text": " for each interface registered in the interface registry."
    },
    {
      "Time_Start": 1438.04,
      "Time_End": 1442.28,
      "Text": " And I think what I found could be a separate talk in itself."
    },
    {
      "Time_Start": 1442.68,
      "Time_End": 1445.24,
      "Text": " If you've never done it, a fun exercise is to go through"
    },
    {
      "Time_Start": 1446.12,
      "Time_End": 1450.6,
      "Text": " every con class in the registry and initialize it and see what happens."
    },
    {
      "Time_Start": 1451.48,
      "Time_End": 1454.76,
      "Text": " You get all sorts of weird pop-ups and functionality."
    },
    {
      "Time_Start": 1454.76,
      "Time_End": 1457.8,
      "Text": " I got a message that said my hard drive was full, even though it's not."
    },
    {
      "Time_Start": 1458.84,
      "Time_End": 1464.12,
      "Text": " So that's already telling that just by initializing a con class,"
    },
    {
      "Time_Start": 1464.12,
      "Time_End": 1468.68,
      "Text": " you can cause some really interesting, unexpected behavior."
    },
    {
      "Time_Start": 1469.64,
      "Time_End": 1473.16,
      "Text": " And so this ComMapper, it'll take all these relationships"
    },
    {
      "Time_Start": 1473.16,
      "Time_End": 1477.48,
      "Text": " and put them in a Neo4j graph so that we can query"
    },
    {
      "Time_Start": 1479.0,
      "Time_End": 1479.8,
      "Text": " all sorts of things."
    },
    {
      "Time_Start": 1479.8,
      "Time_End": 1484.28,
      "Text": " Like I want to see all the interfaces that class X implements,"
    },
    {
      "Time_Start": 1484.28,
      "Time_End": 1488.44,
      "Text": " or I want to see all classes that implement the interface X, Y, and Z,"
    },
    {
      "Time_Start": 1488.44,
      "Time_End": 1491.72,
      "Text": " or give me all the classes that have form in the prog ID."
    },
    {
      "Time_Start": 1491.72,
      "Time_End": 1493.72,
      "Text": " So we can do all sorts of really cool things."
    },
    {
      "Time_Start": 1494.52,
      "Time_End": 1495.64,
      "Text": " So here's what that looks like."
    },
    {
      "Time_Start": 1496.28,
      "Time_End": 1497.96,
      "Text": " This is in a Neo4j browser."
    },
    {
      "Time_Start": 1498.52,
      "Time_End": 1501.72,
      "Text": " And this is a query for three different interfaces."
    },
    {
      "Time_Start": 1501.72,
      "Time_End": 1503.16,
      "Text": " So it's essentially saying,"
    },
    {
      "Time_Start": 1503.16,
      "Time_End": 1505.8,
      "Text": " give me all the classes that implement interface."
    },
    {
      "Time_Start": 1506.6000000000001,
      "Time_End": 1511.32,
      "Text": " I think this is IPersistStorage, IDataObject, and IOlayObject."
    },
    {
      "Time_Start": 1511.88,
      "Time_End": 1516.52,
      "Text": " And then you get this really big, hard to read graph on the left"
    },
    {
      "Time_Start": 1517.64,
      "Time_End": 1518.92,
      "Text": " that shows all the relationships,"
    },
    {
      "Time_Start": 1518.92,
      "Time_End": 1522.68,
      "Text": " or you can get a text view that's a lot more helpful on the right here."
    },
    {
      "Time_Start": 1522.68,
      "Time_End": 1525.4,
      "Text": " And so this is a list of all the con classes that enter,"
    },
    {
      "Time_Start": 1526.3600000000001,
      "Time_End": 1528.6000000000001,
      "Text": " that implement those interfaces."
    },
    {
      "Time_Start": 1530.0400000000002,
      "Time_End": 1530.6000000000001,
      "Text": " All right."
    },
    {
      "Time_Start": 1530.6000000000001,
      "Time_End": 1532.6000000000001,
      "Text": " So that's, hopefully that wasn't too painful."
    },
    {
      "Time_Start": 1532.6000000000001,
      "Time_End": 1533.8000000000002,
      "Text": " That's Olay in a nutshell."
    },
    {
      "Time_Start": 1534.6000000000001,
      "Time_End": 1536.0400000000002,
      "Text": " So let's go back to field codes."
    },
    {
      "Time_Start": 1537.3200000000002,
      "Time_End": 1539.24,
      "Text": " So we tried the HTA thing."
    },
    {
      "Time_Start": 1539.24,
      "Time_End": 1540.1200000000001,
      "Text": " Why didn't that work?"
    },
    {
      "Time_Start": 1540.1200000000001,
      "Time_End": 1543.0800000000002,
      "Text": " So it actually, it didn't work for a lot of reasons."
    },
    {
      "Time_Start": 1545.0,
      "Time_End": 1548.3600000000001,
      "Text": " First, I think the reason why it didn't work"
    },
    {
      "Time_Start": 1548.3600000000001,
      "Time_End": 1550.68,
      "Text": " is because it didn't implement IPersist file."
    },
    {
      "Time_Start": 1550.68,
      "Time_End": 1552.2800000000002,
      "Text": " So that would have been the first barrier to entry."
    },
    {
      "Time_Start": 1552.2800000000002,
      "Time_End": 1555.16,
      "Text": " But Word actually has, or I'm sorry,"
    },
    {
      "Time_Start": 1555.16,
      "Time_End": 1558.28,
      "Text": " Office actually has a blacklist of con classes"
    },
    {
      "Time_Start": 1558.28,
      "Time_End": 1559.64,
      "Text": " that can't be initialized."
    },
    {
      "Time_Start": 1559.64,
      "Time_End": 1561.64,
      "Text": " And HTA file is on that."
    },
    {
      "Time_Start": 1562.8400000000001,
      "Time_End": 1565.5600000000002,
      "Text": " And then there obviously could be implementation specifics"
    },
    {
      "Time_Start": 1565.5600000000002,
      "Time_End": 1566.3600000000001,
      "Text": " on why it didn't work."
    },
    {
      "Time_Start": 1567.3200000000002,
      "Time_End": 1568.1200000000001,
      "Text": " So that's okay."
    },
    {
      "Time_Start": 1568.8400000000001,
      "Time_End": 1570.3600000000001,
      "Text": " That's okay that HTA file didn't work."
    },
    {
      "Time_Start": 1570.3600000000001,
      "Time_End": 1572.3600000000001,
      "Text": " But then the question is, what will work?"
    },
    {
      "Time_Start": 1573.0800000000002,
      "Time_End": 1575.72,
      "Text": " And so we have to go find,"
    },
    {
      "Time_Start": 1576.44,
      "Time_End": 1578.28,
      "Text": " for the sake of this linking example,"
    },
    {
      "Time_Start": 1578.28,
      "Time_End": 1579.8000000000002,
      "Text": " we have to go find a link source."
    },
    {
      "Time_Start": 1580.6000000000001,
      "Time_End": 1583.0800000000002,
      "Text": " And we learned that a link source is"
    },
    {
      "Time_Start": 1583.6399999999999,
      "Time_End": 1587.0,
      "Text": " anything that exposes IOlay object, IData object,"
    },
    {
      "Time_Start": 1587.0,
      "Time_End": 1588.9199999999998,
      "Text": " IPersist storage, and IPersist file."
    },
    {
      "Time_Start": 1588.9199999999998,
      "Time_End": 1592.84,
      "Text": " So with ConMapper, we can go find all the con classes"
    },
    {
      "Time_Start": 1592.84,
      "Time_End": 1594.6,
      "Text": " that implement those interfaces."
    },
    {
      "Time_Start": 1595.48,
      "Time_End": 1600.36,
      "Text": " And then what's gonna happen is create file to,"
    },
    {
      "Time_Start": 1600.36,
      "Time_End": 1602.9199999999998,
      "Text": " or create link to file that's gonna be called."
    },
    {
      "Time_Start": 1603.8,
      "Time_End": 1609.08,
      "Text": " And then a co-create instance with CLSTTX local server"
    },
    {
      "Time_Start": 1609.08,
      "Time_End": 1610.6799999999998,
      "Text": " is gonna be called, which essentially means"
    },
    {
      "Time_Start": 1611.4,
      "Time_End": 1613.5600000000002,
      "Text": " it has to be a local server."
    },
    {
      "Time_Start": 1613.5600000000002,
      "Time_End": 1615.0,
      "Text": " It can't be an improx server."
    },
    {
      "Time_Start": 1616.6000000000001,
      "Time_End": 1618.1200000000001,
      "Text": " So the order of operations is,"
    },
    {
      "Time_Start": 1619.3200000000002,
      "Time_End": 1620.68,
      "Text": " we call create link to file,"
    },
    {
      "Time_Start": 1621.96,
      "Time_End": 1623.48,
      "Text": " bind to object is gonna be called,"
    },
    {
      "Time_Start": 1624.3600000000001,
      "Time_End": 1626.76,
      "Text": " which is then gonna call get class file."
    },
    {
      "Time_Start": 1626.76,
      "Time_End": 1628.3600000000001,
      "Text": " And so the really interesting part here"
    },
    {
      "Time_Start": 1628.3600000000001,
      "Time_End": 1630.2,
      "Text": " is that the file that we provided,"
    },
    {
      "Time_Start": 1630.2,
      "Time_End": 1631.64,
      "Text": " which was like test.hta,"
    },
    {
      "Time_Start": 1632.2,
      "Time_End": 1633.8,
      "Text": " if that's a compound file,"
    },
    {
      "Time_Start": 1633.8,
      "Time_End": 1635.48,
      "Text": " if we talked about in the Olay section,"
    },
    {
      "Time_Start": 1636.44,
      "Time_End": 1639.4,
      "Text": " it's going to initialize whatever con class"
    },
    {
      "Time_Start": 1639.88,
      "Time_End": 1643.16,
      "Text": " is labeled at the front of that container."
    },
    {
      "Time_Start": 1643.8000000000002,
      "Time_End": 1648.44,
      "Text": " So we can already control what con classes get initialized."
    },
    {
      "Time_Start": 1649.0800000000002,
      "Time_End": 1653.0800000000002,
      "Text": " And if it isn't a compound file,"
    },
    {
      "Time_Start": 1653.0800000000002,
      "Time_End": 1655.8000000000002,
      "Text": " then it's gonna look up which program to handle with it"
    },
    {
      "Time_Start": 1655.8000000000002,
      "Time_End": 1657.24,
      "Text": " based on the file extension."
    },
    {
      "Time_Start": 1658.2800000000002,
      "Time_End": 1659.64,
      "Text": " So based on the file extension,"
    },
    {
      "Time_Start": 1659.64,
      "Time_End": 1660.68,
      "Text": " it's gonna go through the registry."
    },
    {
      "Time_Start": 1660.68,
      "Time_End": 1663.5600000000002,
      "Text": " It's gonna say, oh, that file ends in not HTA."
    },
    {
      "Time_Start": 1663.5600000000002,
      "Time_End": 1665.0800000000002,
      "Text": " So that points to HTA file,"
    },
    {
      "Time_Start": 1665.08,
      "Time_End": 1667.0,
      "Text": " HTA file points to the class ID"
    },
    {
      "Time_Start": 1667.0,
      "Time_End": 1670.6799999999998,
      "Text": " of the HTML application handler."
    },
    {
      "Time_Start": 1671.6399999999999,
      "Time_End": 1673.08,
      "Text": " It's then, if that succeeds,"
    },
    {
      "Time_Start": 1673.72,
      "Time_End": 1675.6399999999999,
      "Text": " it's gonna call I persist file load."
    },
    {
      "Time_Start": 1677.32,
      "Time_End": 1679.56,
      "Text": " And then if that succeeds,"
    },
    {
      "Time_Start": 1679.56,
      "Time_End": 1682.1999999999998,
      "Text": " it's going to query for IOlay object."
    },
    {
      "Time_Start": 1682.1999999999998,
      "Time_End": 1683.96,
      "Text": " And then it's finally gonna call do verbs."
    },
    {
      "Time_Start": 1683.96,
      "Time_End": 1685.8,
      "Text": " So if you double clicked,"
    },
    {
      "Time_Start": 1685.8,
      "Time_End": 1688.04,
      "Text": " the do verb would most likely be like open"
    },
    {
      "Time_Start": 1688.04,
      "Time_End": 1688.9199999999998,
      "Text": " or something like that."
    },
    {
      "Time_Start": 1690.12,
      "Time_End": 1693.48,
      "Text": " So the important part here is,"
    },
    {
      "Time_Start": 1694.3600000000001,
      "Time_End": 1695.88,
      "Text": " there's only a specific,"
    },
    {
      "Time_Start": 1695.88,
      "Time_End": 1698.68,
      "Text": " a very small list of con classes"
    },
    {
      "Time_Start": 1698.68,
      "Time_End": 1700.44,
      "Text": " that support all of these things."
    },
    {
      "Time_Start": 1700.44,
      "Time_End": 1701.96,
      "Text": " And those are typically the ones"
    },
    {
      "Time_Start": 1701.96,
      "Time_End": 1703.32,
      "Text": " that are presented to you in Word."
    },
    {
      "Time_Start": 1703.88,
      "Time_End": 1706.6,
      "Text": " However, all you need"
    },
    {
      "Time_Start": 1706.6,
      "Time_End": 1708.28,
      "Text": " to get something interesting going here"
    },
    {
      "Time_Start": 1708.28,
      "Time_End": 1712.6,
      "Text": " is a con class that has a local server"
    },
    {
      "Time_Start": 1712.6,
      "Time_End": 1714.68,
      "Text": " and exports I persist file."
    },
    {
      "Time_Start": 1714.68,
      "Time_End": 1718.28,
      "Text": " So even if it fails on IOlay object or do verb,"
    },
    {
      "Time_Start": 1718.28,
      "Time_End": 1721.4,
      "Text": " you already got something to initialize"
    },
    {
      "Time_Start": 1721.4,
      "Time_End": 1722.44,
      "Text": " and load your data,"
    },
    {
      "Time_Start": 1722.44,
      "Time_End": 1723.72,
      "Text": " which is super powerful."
    },
    {
      "Time_Start": 1726.52,
      "Time_End": 1728.76,
      "Text": " So just to kind of sum up field codes,"
    },
    {
      "Time_Start": 1730.8400000000001,
      "Time_End": 1732.68,
      "Text": " some areas of research that I wanna pursue"
    },
    {
      "Time_Start": 1733.48,
      "Time_End": 1735.24,
      "Text": " are looking into ways to leak contents"
    },
    {
      "Time_Start": 1735.24,
      "Time_End": 1736.2800000000002,
      "Text": " without a warning message."
    },
    {
      "Time_Start": 1737.48,
      "Time_End": 1739.4,
      "Text": " We can create IOlay linked objects"
    },
    {
      "Time_Start": 1739.4,
      "Time_End": 1740.52,
      "Text": " when a user opens it."
    },
    {
      "Time_Start": 1740.52,
      "Time_End": 1743.5600000000002,
      "Text": " So that was the previous slide"
    },
    {
      "Time_Start": 1743.5600000000002,
      "Time_End": 1746.8400000000001,
      "Text": " is the ability to arbitrarily create con classes."
    },
    {
      "Time_Start": 1747.48,
      "Time_End": 1749.48,
      "Text": " And then even if it's not fully supported,"
    },
    {
      "Time_Start": 1749.48,
      "Time_End": 1751.64,
      "Text": " even if it doesn't end in success,"
    },
    {
      "Time_Start": 1751.64,
      "Time_End": 1753.24,
      "Text": " we can do some really interesting things."
    },
    {
      "Time_Start": 1755.4,
      "Time_End": 1758.04,
      "Text": " All right, moving on to ActiveX controls."
    },
    {
      "Time_Start": 1761.48,
      "Time_End": 1762.6,
      "Text": " All right, so what is ActiveX?"
    },
    {
      "Time_Start": 1762.6,
      "Time_End": 1764.3600000000001,
      "Text": " So we talked a lot about IOlay."
    },
    {
      "Time_Start": 1765.0,
      "Time_End": 1767.8,
      "Text": " ActiveX is really kind of just a rebrand of IOlay."
    },
    {
      "Time_Start": 1768.44,
      "Time_End": 1773.96,
      "Text": " And it's anything that has technically,"
    },
    {
      "Time_Start": 1773.96,
      "Time_End": 1775.32,
      "Text": " anything that has a control key"
    },
    {
      "Time_Start": 1775.32,
      "Time_End": 1776.84,
      "Text": " in the class ID registry."
    },
    {
      "Time_Start": 1776.84,
      "Time_End": 1778.6,
      "Text": " So if you were to go into Word and say,"
    },
    {
      "Time_Start": 1778.6000000000001,
      "Time_End": 1780.3600000000001,
      "Text": " I wanna add ActiveX controls,"
    },
    {
      "Time_Start": 1780.3600000000001,
      "Time_End": 1782.1200000000001,
      "Text": " like the list here on the right,"
    },
    {
      "Time_Start": 1782.7600000000002,
      "Time_End": 1784.1200000000001,
      "Text": " that's gonna go through the registry"
    },
    {
      "Time_Start": 1784.1200000000001,
      "Time_End": 1786.0400000000002,
      "Text": " and anything with a control sub key in it,"
    },
    {
      "Time_Start": 1786.0400000000002,
      "Time_End": 1787.72,
      "Text": " it's gonna be included in this list."
    },
    {
      "Time_Start": 1789.0000000000002,
      "Time_End": 1790.92,
      "Text": " And so ActiveX in English,"
    },
    {
      "Time_Start": 1791.4800000000002,
      "Time_End": 1792.6000000000001,
      "Text": " so really what it is,"
    },
    {
      "Time_Start": 1792.6000000000001,
      "Time_End": 1794.44,
      "Text": " is your forms, buttons, charts."
    },
    {
      "Time_Start": 1795.3200000000002,
      "Time_End": 1796.92,
      "Text": " If you wanna insert like a text field"
    },
    {
      "Time_Start": 1796.92,
      "Time_End": 1798.44,
      "Text": " or a password field,"
    },
    {
      "Time_Start": 1798.44,
      "Time_End": 1799.96,
      "Text": " those are implemented in ActiveX."
    },
    {
      "Time_Start": 1799.96,
      "Time_End": 1802.7600000000002,
      "Text": " So you don't have to write all these things yourself"
    },
    {
      "Time_Start": 1802.7600000000002,
      "Time_End": 1803.5600000000002,
      "Text": " over and over again."
    },
    {
      "Time_Start": 1805.5600000000002,
      "Time_End": 1807.0800000000002,
      "Text": " Let's take a look at what that looks like."
    },
    {
      "Time_Start": 1807.08,
      "Time_End": 1809.32,
      "Text": " So on the left is an ActiveX label."
    },
    {
      "Time_Start": 1809.32,
      "Time_End": 1810.76,
      "Text": " So I just inserted,"
    },
    {
      "Time_Start": 1810.76,
      "Time_End": 1812.28,
      "Text": " I saved it and extracted it."
    },
    {
      "Time_Start": 1813.56,
      "Time_End": 1815.1599999999999,
      "Text": " And you'll see here that we have"
    },
    {
      "Time_Start": 1815.1599999999999,
      "Time_End": 1816.9199999999998,
      "Text": " a couple of new entries"
    },
    {
      "Time_Start": 1816.9199999999998,
      "Time_End": 1818.76,
      "Text": " that weren't in the blank Word document."
    },
    {
      "Time_Start": 1819.8,
      "Time_End": 1821.3999999999999,
      "Text": " So actually in the next slide,"
    },
    {
      "Time_Start": 1821.3999999999999,
      "Time_End": 1822.4399999999998,
      "Text": " you could see a comparison."
    },
    {
      "Time_Start": 1822.4399999999998,
      "Time_End": 1825.1599999999999,
      "Text": " So the left is a blank Word document"
    },
    {
      "Time_Start": 1825.1599999999999,
      "Time_End": 1826.6799999999998,
      "Text": " and the right is a Word document"
    },
    {
      "Time_Start": 1826.6799999999998,
      "Time_End": 1827.96,
      "Text": " with ActiveX included."
    },
    {
      "Time_Start": 1828.6,
      "Time_End": 1830.28,
      "Text": " So we have a whole new directory here"
    },
    {
      "Time_Start": 1830.28,
      "Time_End": 1832.04,
      "Text": " with ActiveX 1.bin,"
    },
    {
      "Time_Start": 1832.04,
      "Time_End": 1834.76,
      "Text": " ActiveX 1.xml and a rels directory."
    },
    {
      "Time_Start": 1835.4,
      "Time_End": 1837.4,
      "Text": " Let's take a look at these two new files,"
    },
    {
      "Time_Start": 1837.4,
      "Time_End": 1839.72,
      "Text": " the ActiveX 1 files that are interesting."
    },
    {
      "Time_Start": 1841.64,
      "Time_End": 1843.0,
      "Text": " So as expected,"
    },
    {
      "Time_Start": 1843.0,
      "Time_End": 1845.48,
      "Text": " ActiveX 1.bin is a compound file"
    },
    {
      "Time_Start": 1846.6,
      "Time_End": 1849.24,
      "Text": " and it has two streams in it."
    },
    {
      "Time_Start": 1850.36,
      "Time_End": 1852.04,
      "Text": " The first one is CompObj"
    },
    {
      "Time_Start": 1852.04,
      "Time_End": 1855.96,
      "Text": " that essentially lists out how"
    },
    {
      "Time_Start": 1855.96,
      "Time_End": 1858.84,
      "Text": " or describes what the object is."
    },
    {
      "Time_Start": 1858.84,
      "Time_End": 1861.0,
      "Text": " And then the contents is the contents"
    },
    {
      "Time_Start": 1861.0,
      "Time_End": 1862.84,
      "Text": " of the object."
    },
    {
      "Time_Start": 1863.64,
      "Time_End": 1865.88,
      "Text": " And then the XML is interesting"
    },
    {
      "Time_Start": 1865.88,
      "Time_End": 1867.88,
      "Text": " because it lists the class ID"
    },
    {
      "Time_Start": 1867.88,
      "Time_End": 1870.2,
      "Text": " and also take note that the persistence"
    },
    {
      "Time_Start": 1870.2,
      "Time_End": 1871.5600000000002,
      "Text": " is persist storage."
    },
    {
      "Time_Start": 1871.5600000000002,
      "Time_End": 1873.88,
      "Text": " That tells Word that the bin file"
    },
    {
      "Time_Start": 1873.88,
      "Time_End": 1874.92,
      "Text": " is a compound file."
    },
    {
      "Time_Start": 1879.3200000000002,
      "Time_End": 1881.0000000000002,
      "Text": " All right, so how has ActiveX"
    },
    {
      "Time_Start": 1881.0000000000002,
      "Time_End": 1882.6000000000001,
      "Text": " been traditionally maliciously used?"
    },
    {
      "Time_Start": 1883.3200000000002,
      "Time_End": 1884.92,
      "Text": " So in most cases,"
    },
    {
      "Time_Start": 1884.92,
      "Time_End": 1887.8000000000002,
      "Text": " ActiveX is just a way to get VBA initialized."
    },
    {
      "Time_Start": 1888.6000000000001,
      "Time_End": 1890.8400000000001,
      "Text": " And since we're not really going into VBA,"
    },
    {
      "Time_Start": 1890.8400000000001,
      "Time_End": 1892.2,
      "Text": " we won't really be going into this."
    },
    {
      "Time_Start": 1892.8400000000001,
      "Time_End": 1894.1200000000001,
      "Text": " But you may be wondering,"
    },
    {
      "Time_Start": 1894.1200000000001,
      "Time_End": 1895.8000000000002,
      "Text": " well, if you're already using VBA,"
    },
    {
      "Time_Start": 1895.8000000000002,
      "Time_End": 1897.0800000000002,
      "Text": " why would you need ActiveX?"
    },
    {
      "Time_Start": 1897.8000000000002,
      "Time_End": 1899.4800000000002,
      "Text": " And ActiveX is usually used"
    },
    {
      "Time_Start": 1899.4800000000002,
      "Time_End": 1902.3600000000001,
      "Text": " so that the VBA scripts don't have to rely"
    },
    {
      "Time_Start": 1902.3600000000001,
      "Time_End": 1905.0000000000002,
      "Text": " on the auto events like auto open"
    },
    {
      "Time_Start": 1905.0000000000002,
      "Time_End": 1906.2800000000002,
      "Text": " or document open,"
    },
    {
      "Time_Start": 1906.2800000000002,
      "Time_End": 1910.3600000000001,
      "Text": " which antivirus or EDR solutions"
    },
    {
      "Time_Start": 1910.3600000000001,
      "Time_End": 1911.4800000000002,
      "Text": " know how to look for."
    },
    {
      "Time_Start": 1913.0800000000002,
      "Time_End": 1915.3200000000002,
      "Text": " And so instead of relying on auto open"
    },
    {
      "Time_Start": 1915.3200000000002,
      "Time_End": 1916.2800000000002,
      "Text": " or document open,"
    },
    {
      "Time_Start": 1916.2800000000002,
      "Time_End": 1919.16,
      "Text": " you can link a button click event"
    },
    {
      "Time_Start": 1919.16,
      "Time_End": 1921.4,
      "Text": " to the malicious function that you wrote."
    },
    {
      "Time_Start": 1922.0400000000002,
      "Time_End": 1923.0,
      "Text": " But on top of that,"
    },
    {
      "Time_Start": 1923.8000000000002,
      "Time_End": 1925.48,
      "Text": " there's a really cool blog post"
    },
    {
      "Time_Start": 1925.48,
      "Time_End": 1927.88,
      "Text": " called Click Me If You Can by Yorick Koster."
    },
    {
      "Time_Start": 1928.68,
      "Time_End": 1931.88,
      "Text": " And this is an example of abusing"
    },
    {
      "Time_Start": 1933.0,
      "Time_End": 1937.0800000000002,
      "Text": " kind of unpredicted embedded OLA behavior"
    },
    {
      "Time_Start": 1937.96,
      "Time_End": 1938.92,
      "Text": " with an office document."
    },
    {
      "Time_Start": 1938.92,
      "Time_End": 1940.44,
      "Text": " So let's take a look at what that looks like."
    },
    {
      "Time_Start": 1943.16,
      "Time_End": 1944.52,
      "Text": " So this is an example"
    },
    {
      "Time_Start": 1944.52,
      "Time_End": 1948.1200000000001,
      "Text": " of an embedded Microsoft form control"
    },
    {
      "Time_Start": 1948.1200000000001,
      "Time_End": 1949.72,
      "Text": " that was described in the blog post."
    },
    {
      "Time_Start": 1950.44,
      "Time_End": 1951.64,
      "Text": " So let's just look at"
    },
    {
      "Time_Start": 1951.64,
      "Time_End": 1952.76,
      "Text": " what happens when you run it."
    },
    {
      "Time_Start": 1952.76,
      "Time_End": 1955.16,
      "Text": " So this, I just left the picture blank."
    },
    {
      "Time_Start": 1955.16,
      "Time_End": 1956.04,
      "Text": " This could be a picture."
    },
    {
      "Time_Start": 1956.04,
      "Time_End": 1957.64,
      "Text": " It could say something like click me"
    },
    {
      "Time_Start": 1957.64,
      "Time_End": 1960.68,
      "Text": " or anything you can get an enticed user to click."
    },
    {
      "Time_Start": 1961.56,
      "Time_End": 1962.52,
      "Text": " And so you'll see here"
    },
    {
      "Time_Start": 1962.52,
      "Time_End": 1965.0,
      "Text": " that the user is still warned"
    },
    {
      "Time_Start": 1966.04,
      "Time_End": 1967.64,
      "Text": " that you're opening a file"
    },
    {
      "Time_Start": 1967.64,
      "Time_End": 1968.76,
      "Text": " that doesn't really know what it is."
    },
    {
      "Time_Start": 1969.64,
      "Time_End": 1971.0,
      "Text": " In this example, it's calc."
    },
    {
      "Time_Start": 1971.64,
      "Time_End": 1973.0,
      "Text": " And so you're just expecting"
    },
    {
      "Time_Start": 1973.0,
      "Time_End": 1974.44,
      "Text": " that the user is gonna click okay."
    },
    {
      "Time_Start": 1976.3600000000001,
      "Time_End": 1978.3600000000001,
      "Text": " And they click okay and you get calc."
    },
    {
      "Time_Start": 1980.68,
      "Time_End": 1981.8,
      "Text": " And so let's take a look"
    },
    {
      "Time_Start": 1981.8,
      "Time_End": 1982.92,
      "Text": " at what that looks like under the hood."
    },
    {
      "Time_Start": 1985.24,
      "Time_End": 1987.88,
      "Text": " So once again, we have two files as expected."
    },
    {
      "Time_Start": 1987.88,
      "Time_End": 1989.72,
      "Text": " What was interesting to me"
    },
    {
      "Time_Start": 1989.72,
      "Time_End": 1991.72,
      "Text": " and why I find this blog post really interesting"
    },
    {
      "Time_Start": 1992.52,
      "Time_End": 1994.84,
      "Text": " is that you'll see"
    },
    {
      "Time_Start": 1994.84,
      "Time_End": 1996.28,
      "Text": " that the persistence mechanism"
    },
    {
      "Time_Start": 1996.28,
      "Time_End": 1997.72,
      "Text": " has changed to persist stream."
    },
    {
      "Time_Start": 1998.52,
      "Time_End": 2000.52,
      "Text": " And instead of having a compound file,"
    },
    {
      "Time_Start": 2000.52,
      "Time_End": 2004.76,
      "Text": " it's just a normal file with 160 bytes in it."
    },
    {
      "Time_Start": 2005.8,
      "Time_End": 2007.24,
      "Text": " And that's just a file stream."
    },
    {
      "Time_Start": 2007.24,
      "Time_End": 2008.84,
      "Text": " And really the key here,"
    },
    {
      "Time_Start": 2008.8400000000001,
      "Time_End": 2011.2400000000002,
      "Text": " the exploit portion of it"
    },
    {
      "Time_Start": 2011.88,
      "Time_End": 2014.0400000000002,
      "Text": " is that you can add this action field"
    },
    {
      "Time_Start": 2014.0400000000002,
      "Time_End": 2015.2400000000002,
      "Text": " that points to a file."
    },
    {
      "Time_Start": 2015.96,
      "Time_End": 2020.1200000000001,
      "Text": " And so there's a couple Microsoft form controls"
    },
    {
      "Time_Start": 2020.8400000000001,
      "Time_End": 2023.0000000000002,
      "Text": " that will execute"
    },
    {
      "Time_Start": 2023.5600000000002,
      "Time_End": 2025.4800000000002,
      "Text": " or that will honor this action field."
    },
    {
      "Time_Start": 2027.96,
      "Time_End": 2030.3600000000001,
      "Text": " So how are we defending against this?"
    },
    {
      "Time_Start": 2032.0400000000002,
      "Time_End": 2035.3200000000002,
      "Text": " The VBA protections are a whole field"
    },
    {
      "Time_Start": 2035.3200000000002,
      "Time_End": 2036.3600000000001,
      "Text": " in and of itself."
    },
    {
      "Time_Start": 2036.3600000000001,
      "Time_End": 2037.88,
      "Text": " So I'm not gonna go into that."
    },
    {
      "Time_Start": 2039.4800000000002,
      "Time_End": 2041.2400000000002,
      "Text": " As far as the form abuse goes,"
    },
    {
      "Time_Start": 2042.7600000000002,
      "Time_End": 2044.6000000000001,
      "Text": " the recommendation, at least in the blog post,"
    },
    {
      "Time_Start": 2044.6000000000001,
      "Time_End": 2046.7600000000002,
      "Text": " was to just ensure these class IDs are blocked."
    },
    {
      "Time_Start": 2047.3200000000002,
      "Time_End": 2049.7200000000003,
      "Text": " I don't know if it's just my box"
    },
    {
      "Time_Start": 2049.7200000000003,
      "Time_End": 2051.8,
      "Text": " or if it's common,"
    },
    {
      "Time_Start": 2051.8,
      "Time_End": 2054.28,
      "Text": " but actually the HTML form controls"
    },
    {
      "Time_Start": 2054.28,
      "Time_End": 2057.32,
      "Text": " had more than one UUID in my registry."
    },
    {
      "Time_Start": 2057.32,
      "Time_End": 2059.32,
      "Text": " So blocking one is not gonna block the other."
    },
    {
      "Time_Start": 2060.28,
      "Time_End": 2063.1600000000003,
      "Text": " And it wasn't like treated as or anything like that."
    },
    {
      "Time_Start": 2063.1600000000003,
      "Time_End": 2065.4,
      "Text": " They were standalone instances of each other."
    },
    {
      "Time_Start": 2066.36,
      "Time_End": 2068.28,
      "Text": " And then secondly, if it were me,"
    },
    {
      "Time_Start": 2068.28,
      "Time_End": 2072.28,
      "Text": " I would be scanning ActiveX spin files"
    },
    {
      "Time_Start": 2072.28,
      "Time_End": 2075.2400000000002,
      "Text": " and looking for known keys like action"
    },
    {
      "Time_Start": 2076.52,
      "Time_End": 2078.1200000000003,
      "Text": " or URL or things like that."
    },
    {
      "Time_Start": 2079.32,
      "Time_End": 2082.0400000000004,
      "Text": " And Microsoft actually has an ActiveX control"
    },
    {
      "Time_Start": 2082.0400000000004,
      "Time_End": 2082.92,
      "Text": " whitelist as well."
    },
    {
      "Time_Start": 2086.6000000000004,
      "Time_End": 2089.1600000000003,
      "Text": " So the interesting part about ActiveX"
    },
    {
      "Time_Start": 2089.1600000000003,
      "Time_End": 2091.5600000000004,
      "Text": " is especially if you're looking at"
    },
    {
      "Time_Start": 2092.28,
      "Time_End": 2094.44,
      "Text": " the ActiveX one to XML files,"
    },
    {
      "Time_Start": 2095.0800000000004,
      "Time_End": 2096.6000000000004,
      "Text": " once again, you have that class ID"
    },
    {
      "Time_Start": 2097.56,
      "Time_End": 2098.6,
      "Text": " that you can mess with."
    },
    {
      "Time_Start": 2099.64,
      "Time_End": 2100.7599999999998,
      "Text": " And curiously enough,"
    },
    {
      "Time_Start": 2102.92,
      "Time_End": 2104.6,
      "Text": " through the Word document,"
    },
    {
      "Time_Start": 2104.6,
      "Time_End": 2106.12,
      "Text": " through the Word user interface,"
    },
    {
      "Time_Start": 2106.12,
      "Time_End": 2109.08,
      "Text": " if you import a Microsoft form,"
    },
    {
      "Time_Start": 2109.96,
      "Time_End": 2112.44,
      "Text": " it's actually going to write it as a compound file,"
    },
    {
      "Time_Start": 2112.44,
      "Time_End": 2115.96,
      "Text": " not as a stream like we saw in this example here."
    },
    {
      "Time_Start": 2117.24,
      "Time_End": 2121.64,
      "Text": " And so that kind of highlights the difference"
    },
    {
      "Time_Start": 2122.7599999999998,
      "Time_End": 2124.44,
      "Text": " that is possible between some of these."
    },
    {
      "Time_Start": 2124.44,
      "Time_End": 2127.48,
      "Text": " So I would have never known this"
    },
    {
      "Time_Start": 2127.48,
      "Time_End": 2131.32,
      "Text": " had I not read that blog post or played around with it."
    },
    {
      "Time_Start": 2131.32,
      "Time_End": 2137.32,
      "Text": " I did find that if you add an ActiveX control"
    },
    {
      "Time_Start": 2137.88,
      "Time_End": 2140.04,
      "Text": " via PowerShell through like only automation,"
    },
    {
      "Time_Start": 2140.04,
      "Time_End": 2141.4,
      "Text": " it will write this as a stream."
    },
    {
      "Time_Start": 2142.52,
      "Time_End": 2143.96,
      "Text": " So that's just an example of,"
    },
    {
      "Time_Start": 2144.68,
      "Time_End": 2147.88,
      "Text": " there's so much functionality that you can abuse."
    },
    {
      "Time_Start": 2149.16,
      "Time_End": 2152.36,
      "Text": " I'm curious to see what other ActiveX controls"
    },
    {
      "Time_Start": 2152.36,
      "Time_End": 2154.04,
      "Text": " will ingest streams like this."
    },
    {
      "Time_Start": 2154.6,
      "Time_End": 2158.52,
      "Text": " And if there's any other interesting methods"
    },
    {
      "Time_Start": 2158.52,
      "Time_End": 2160.36,
      "Text": " that we can use besides action"
    },
    {
      "Time_Start": 2160.36,
      "Time_End": 2163.4,
      "Text": " that we could use for ActiveX field control"
    },
    {
      "Time_Start": 2163.4,
      "Time_End": 2164.84,
      "Text": " or ActiveX control abuse."
    },
    {
      "Time_Start": 2166.68,
      "Time_End": 2168.2000000000003,
      "Text": " We're gonna move on to embedded objects."
    },
    {
      "Time_Start": 2168.2000000000003,
      "Time_End": 2170.12,
      "Text": " So this is really similar to ActiveX."
    },
    {
      "Time_Start": 2171.0,
      "Time_End": 2173.8,
      "Text": " They're gonna be compound files as well."
    },
    {
      "Time_Start": 2174.52,
      "Time_End": 2178.36,
      "Text": " And so when you read about embedded objects online"
    },
    {
      "Time_Start": 2178.36,
      "Time_End": 2180.2000000000003,
      "Text": " through like on blog posts and stuff,"
    },
    {
      "Time_Start": 2180.2000000000003,
      "Time_End": 2182.92,
      "Text": " usually what they mean are embedded packager objects."
    },
    {
      "Time_Start": 2182.92,
      "Time_End": 2184.84,
      "Text": " And packager is just a con class."
    },
    {
      "Time_Start": 2185.96,
      "Time_End": 2188.6,
      "Text": " And what packager allows you to do"
    },
    {
      "Time_Start": 2189.48,
      "Time_End": 2191.16,
      "Text": " is to take any arbitrary file"
    },
    {
      "Time_Start": 2191.88,
      "Time_End": 2194.04,
      "Text": " and embed it into a Word document,"
    },
    {
      "Time_Start": 2194.04,
      "Time_End": 2196.44,
      "Text": " whether that be an executable"
    },
    {
      "Time_Start": 2196.44,
      "Time_End": 2197.88,
      "Text": " or a script or a text or whatever."
    },
    {
      "Time_Start": 2200.6800000000003,
      "Time_End": 2201.88,
      "Text": " So let's take a quick look"
    },
    {
      "Time_Start": 2201.88,
      "Time_End": 2203.96,
      "Text": " at what an embedded file looks like."
    },
    {
      "Time_Start": 2203.96,
      "Time_End": 2205.88,
      "Text": " So I took a text file and embedded it"
    },
    {
      "Time_Start": 2206.44,
      "Time_End": 2207.8,
      "Text": " as a packager object."
    },
    {
      "Time_Start": 2208.44,
      "Time_End": 2209.7200000000003,
      "Text": " And you'll see that if we unzip it,"
    },
    {
      "Time_Start": 2209.7200000000003,
      "Time_End": 2211.32,
      "Text": " instead of ActiveX one directory,"
    },
    {
      "Time_Start": 2211.32,
      "Time_End": 2213.32,
      "Text": " we have an embeddings directory now."
    },
    {
      "Time_Start": 2213.32,
      "Time_End": 2215.2400000000002,
      "Text": " And there's this olayobject1.bin."
    },
    {
      "Time_Start": 2215.2400000000002,
      "Time_End": 2216.28,
      "Text": " So let's take a look at that."
    },
    {
      "Time_Start": 2219.0800000000004,
      "Time_End": 2219.96,
      "Text": " So here on the left,"
    },
    {
      "Time_Start": 2219.96,
      "Time_End": 2223.88,
      "Text": " you'll see that we have the olayobject1.bin storage."
    },
    {
      "Time_Start": 2224.76,
      "Time_End": 2228.04,
      "Text": " And then we have three files or three streams."
    },
    {
      "Time_Start": 2228.6800000000003,
      "Time_End": 2231.48,
      "Text": " One is the compobj, which we've seen before."
    },
    {
      "Time_Start": 2232.2000000000003,
      "Time_End": 2233.4,
      "Text": " One is objectinfo."
    },
    {
      "Time_Start": 2233.4,
      "Time_End": 2235.56,
      "Text": " And then there's this olay10native."
    },
    {
      "Time_Start": 2235.56,
      "Time_End": 2236.84,
      "Text": " And that's where the actual text,"
    },
    {
      "Time_Start": 2237.4,
      "Time_End": 2239.0800000000004,
      "Text": " the actual file contents go."
    },
    {
      "Time_Start": 2239.0800000000004,
      "Time_End": 2240.76,
      "Text": " But it's not just the file contents."
    },
    {
      "Time_Start": 2241.5600000000004,
      "Time_End": 2243.88,
      "Text": " It's packager file content."
    },
    {
      "Time_Start": 2243.88,
      "Time_End": 2246.84,
      "Text": " So there's things like file size at the top"
    },
    {
      "Time_Start": 2246.84,
      "Time_End": 2250.6800000000003,
      "Text": " and source and destination file paths."
    },
    {
      "Time_Start": 2254.0400000000004,
      "Time_End": 2256.76,
      "Text": " Embedded objects have been a popular methodology"
    },
    {
      "Time_Start": 2256.76,
      "Time_End": 2258.6000000000004,
      "Text": " for sending malware to a user"
    },
    {
      "Time_Start": 2258.6000000000004,
      "Time_End": 2261.4,
      "Text": " by embedding files into Office documents"
    },
    {
      "Time_Start": 2261.4,
      "Time_End": 2262.84,
      "Text": " using the packager class."
    },
    {
      "Time_Start": 2263.4,
      "Time_End": 2266.44,
      "Text": " The compackager allows you to embed any file"
    },
    {
      "Time_Start": 2266.44,
      "Time_End": 2267.48,
      "Text": " in an Office document."
    },
    {
      "Time_Start": 2267.48,
      "Time_End": 2268.6800000000003,
      "Text": " However, there is a catch."
    },
    {
      "Time_Start": 2269.3199999999997,
      "Time_End": 2272.8399999999997,
      "Text": " So while you can embed any object you want,"
    },
    {
      "Time_Start": 2272.8399999999997,
      "Time_End": 2275.24,
      "Text": " the packager implements an extension blacklist"
    },
    {
      "Time_Start": 2275.24,
      "Time_End": 2277.08,
      "Text": " that will check the extension of the file"
    },
    {
      "Time_Start": 2277.08,
      "Time_End": 2279.3199999999997,
      "Text": " for dangerous components when you try to open it."
    },
    {
      "Time_Start": 2279.8799999999997,
      "Time_End": 2282.8399999999997,
      "Text": " So naturally files that have an executable component"
    },
    {
      "Time_Start": 2282.8399999999997,
      "Time_End": 2287.16,
      "Text": " such as exe, bbs, ps1, et cetera."
    },
    {
      "Time_Start": 2287.16,
      "Time_End": 2288.44,
      "Text": " So those are blocked."
    },
    {
      "Time_Start": 2288.44,
      "Time_End": 2290.2,
      "Text": " So when you open the Office document,"
    },
    {
      "Time_Start": 2290.2,
      "Time_End": 2292.3599999999997,
      "Text": " you'll see the embedded object."
    },
    {
      "Time_Start": 2292.3599999999997,
      "Time_End": 2293.3999999999996,
      "Text": " You'll double click on it."
    },
    {
      "Time_Start": 2294.04,
      "Time_End": 2296.2,
      "Text": " And then you'll get an alert saying"
    },
    {
      "Time_Start": 2296.2,
      "Time_End": 2297.96,
      "Text": " that it refuses to open it."
    },
    {
      "Time_Start": 2297.96,
      "Time_End": 2299.48,
      "Text": " And you don't get like a,"
    },
    {
      "Time_Start": 2299.48,
      "Time_End": 2301.32,
      "Text": " I understand open it anyways."
    },
    {
      "Time_Start": 2301.32,
      "Time_End": 2303.7200000000003,
      "Text": " It's just Office says, no, you can't open this."
    },
    {
      "Time_Start": 2304.76,
      "Time_End": 2305.48,
      "Text": " So the article,"
    },
    {
      "Time_Start": 2306.76,
      "Time_End": 2308.52,
      "Text": " and click me if you can by York Kosser,"
    },
    {
      "Time_Start": 2308.52,
      "Time_End": 2309.8,
      "Text": " it's the second time I've mentioned it."
    },
    {
      "Time_Start": 2310.68,
      "Time_End": 2311.96,
      "Text": " It describes how you can embed"
    },
    {
      "Time_Start": 2311.96,
      "Time_End": 2315.16,
      "Text": " a shell.explorer.one.olay object"
    },
    {
      "Time_Start": 2315.16,
      "Time_End": 2317.8,
      "Text": " and get an actual like explorer window"
    },
    {
      "Time_Start": 2317.8,
      "Time_End": 2319.48,
      "Text": " inside a Word document."
    },
    {
      "Time_Start": 2319.48,
      "Time_End": 2321.7200000000003,
      "Text": " And then you can instruct the user"
    },
    {
      "Time_Start": 2321.7200000000003,
      "Time_End": 2323.8,
      "Text": " to maybe open an executable or something."
    },
    {
      "Time_Start": 2323.8,
      "Time_End": 2325.64,
      "Text": " So that's a really interesting"
    },
    {
      "Time_Start": 2325.64,
      "Time_End": 2329.96,
      "Text": " and novel bypass for that blacklisting issue."
    },
    {
      "Time_Start": 2330.68,
      "Time_End": 2331.64,
      "Text": " And then additionally,"
    },
    {
      "Time_Start": 2331.64,
      "Time_End": 2333.48,
      "Text": " Chintan Shah from McAfee Labs"
    },
    {
      "Time_Start": 2333.48,
      "Time_End": 2335.96,
      "Text": " released a blog post earlier this year"
    },
    {
      "Time_Start": 2335.96,
      "Time_End": 2338.2,
      "Text": " on embedding Olay objects into RTF."
    },
    {
      "Time_Start": 2338.2,
      "Time_End": 2340.92,
      "Text": " So the blog post has some really cool insights"
    },
    {
      "Time_Start": 2340.92,
      "Time_End": 2343.56,
      "Text": " on like how including Olay controls"
    },
    {
      "Time_Start": 2343.56,
      "Time_End": 2347.48,
      "Text": " can provide the necessary code for exploit bypasses"
    },
    {
      "Time_Start": 2347.48,
      "Time_End": 2350.3599999999997,
      "Text": " or embedding malicious Office documents with RTF files."
    },
    {
      "Time_Start": 2350.3599999999997,
      "Time_End": 2353.0,
      "Text": " So while the blog post focuses"
    },
    {
      "Time_Start": 2353.0,
      "Time_End": 2354.92,
      "Text": " on the rich text file format,"
    },
    {
      "Time_Start": 2354.92,
      "Time_End": 2357.08,
      "Text": " the principles carry over to Office documents."
    },
    {
      "Time_Start": 2357.08,
      "Time_End": 2359.16,
      "Text": " So if you're interested in this,"
    },
    {
      "Time_Start": 2359.16,
      "Time_End": 2361.7200000000003,
      "Text": " I highly recommend you check out both of these articles."
    },
    {
      "Time_Start": 2361.7200000000003,
      "Time_End": 2362.84,
      "Text": " They are very, very cool."
    },
    {
      "Time_Start": 2365.88,
      "Time_End": 2367.32,
      "Text": " And so like we talked about,"
    },
    {
      "Time_Start": 2367.32,
      "Time_End": 2370.04,
      "Text": " there is a blacklist for embedding files."
    },
    {
      "Time_Start": 2370.6800000000003,
      "Time_End": 2373.48,
      "Text": " And also note that if you were to try"
    },
    {
      "Time_Start": 2373.48,
      "Time_End": 2377.0,
      "Text": " to include malicious files in the Word document,"
    },
    {
      "Time_Start": 2377.0,
      "Time_End": 2379.64,
      "Text": " they do get extracted and written to disk."
    },
    {
      "Time_Start": 2379.64,
      "Time_End": 2382.2000000000003,
      "Text": " And so it's highly likely that anything you include"
    },
    {
      "Time_Start": 2382.2000000000003,
      "Time_End": 2383.88,
      "Text": " is going to be scanned"
    },
    {
      "Time_Start": 2383.88,
      "Time_End": 2386.6,
      "Text": " and probably uploaded by any antivirus on target."
    },
    {
      "Time_Start": 2388.76,
      "Time_End": 2390.6800000000003,
      "Text": " So why even look into this?"
    },
    {
      "Time_Start": 2390.6800000000003,
      "Time_End": 2392.28,
      "Text": " So I think there's a lot"
    },
    {
      "Time_Start": 2392.28,
      "Time_End": 2394.76,
      "Text": " that we can expand on with embedded objects."
    },
    {
      "Time_Start": 2394.76,
      "Time_End": 2396.6,
      "Text": " I think this is the biggest attack surface"
    },
    {
      "Time_Start": 2398.28,
      "Time_End": 2399.96,
      "Text": " of the three that we've talked about so far."
    },
    {
      "Time_Start": 2400.92,
      "Time_End": 2401.88,
      "Text": " So for example,"
    },
    {
      "Time_Start": 2403.48,
      "Time_End": 2405.2400000000002,
      "Text": " because the files are blacklisted,"
    },
    {
      "Time_Start": 2405.8,
      "Time_End": 2408.6,
      "Text": " that means any third-party software"
    },
    {
      "Time_Start": 2409.6400000000003,
      "Time_End": 2410.52,
      "Text": " that you could think of,"
    },
    {
      "Time_Start": 2410.52,
      "Time_End": 2411.7200000000003,
      "Text": " we can probably include."
    },
    {
      "Time_Start": 2412.0400000000004,
      "Time_End": 2413.96,
      "Text": " You can get creative with which files are allowed."
    },
    {
      "Time_Start": 2413.96,
      "Time_End": 2417.2400000000002,
      "Text": " So, you know, like we can include an MHTML file,"
    },
    {
      "Time_Start": 2417.2400000000002,
      "Time_End": 2419.2400000000002,
      "Text": " which is just an HTML archive"
    },
    {
      "Time_Start": 2419.2400000000002,
      "Time_End": 2421.7200000000003,
      "Text": " that then links to an HTA file."
    },
    {
      "Time_Start": 2421.7200000000003,
      "Time_End": 2423.4800000000005,
      "Text": " And it's like, yeah, it's one more click for the user,"
    },
    {
      "Time_Start": 2423.4800000000005,
      "Time_End": 2425.96,
      "Text": " but it's still only a handful of clicks."
    },
    {
      "Time_Start": 2425.96,
      "Time_End": 2428.5200000000004,
      "Text": " And if users are impatient, they'll probably click it."
    },
    {
      "Time_Start": 2429.6400000000003,
      "Time_End": 2432.5200000000004,
      "Text": " More interestingly, interesting to me though,"
    },
    {
      "Time_Start": 2432.5200000000004,
      "Time_End": 2434.92,
      "Text": " is the fact that we can control the con class ID,"
    },
    {
      "Time_Start": 2434.92,
      "Time_End": 2438.0400000000004,
      "Text": " like we talked about with field codes and ActiveX."
    },
    {
      "Time_Start": 2438.12,
      "Time_End": 2439.72,
      "Text": " And so we need to find out"
    },
    {
      "Time_Start": 2439.72,
      "Time_End": 2442.52,
      "Text": " which classes write their object representations"
    },
    {
      "Time_Start": 2442.52,
      "Time_End": 2443.96,
      "Text": " to a storage file."
    },
    {
      "Time_Start": 2443.96,
      "Time_End": 2446.44,
      "Text": " And we can maybe get some interesting things happening."
    },
    {
      "Time_Start": 2448.04,
      "Time_End": 2449.32,
      "Text": " So as an example,"
    },
    {
      "Time_Start": 2450.36,
      "Time_End": 2452.44,
      "Text": " I took a Packager compound file."
    },
    {
      "Time_Start": 2453.4,
      "Time_End": 2456.2799999999997,
      "Text": " So this is meant for Packager."
    },
    {
      "Time_Start": 2456.2799999999997,
      "Time_End": 2458.68,
      "Text": " And I'd simply just change the class ID."
    },
    {
      "Time_Start": 2458.68,
      "Time_End": 2461.32,
      "Text": " And this class ID is a Windows Media Player."
    },
    {
      "Time_Start": 2463.48,
      "Time_End": 2465.4,
      "Text": " So let's see what happens when we try to do that."
    },
    {
      "Time_Start": 2466.36,
      "Time_End": 2468.36,
      "Text": " So let's see what happens when we try to open this."
    },
    {
      "Time_Start": 2470.52,
      "Time_End": 2471.48,
      "Text": " So under the hood,"
    },
    {
      "Time_Start": 2474.28,
      "Time_End": 2476.6,
      "Text": " the container application, which is Word,"
    },
    {
      "Time_Start": 2476.6,
      "Time_End": 2478.44,
      "Text": " is gonna call OleCreate."
    },
    {
      "Time_Start": 2478.44,
      "Time_End": 2480.52,
      "Text": " And it's gonna look at that class ID."
    },
    {
      "Time_Start": 2480.52,
      "Time_End": 2482.76,
      "Text": " And it's going to initialize that class,"
    },
    {
      "Time_Start": 2482.76,
      "Time_End": 2484.76,
      "Text": " which is then has the local server"
    },
    {
      "Time_Start": 2484.76,
      "Time_End": 2486.76,
      "Text": " of Windows Media Player."
    },
    {
      "Time_Start": 2486.76,
      "Time_End": 2489.08,
      "Text": " So this is a pretty benign example,"
    },
    {
      "Time_Start": 2489.08,
      "Time_End": 2491.4,
      "Text": " but it is an example of the fact that we,"
    },
    {
      "Time_Start": 2491.4,
      "Time_End": 2492.84,
      "Text": " just by clicking on something,"
    },
    {
      "Time_Start": 2493.08,
      "Time_End": 2496.04,
      "Text": " we created a new process that was unexpected to the user."
    },
    {
      "Time_Start": 2499.1600000000003,
      "Time_End": 2502.36,
      "Text": " And secondly, we have the Packager format itself."
    },
    {
      "Time_Start": 2503.2400000000002,
      "Time_End": 2505.32,
      "Text": " And that's worth looking at and playing with as well."
    },
    {
      "Time_Start": 2505.96,
      "Time_End": 2508.52,
      "Text": " Remember that all of this is stuff you control."
    },
    {
      "Time_Start": 2508.52,
      "Time_End": 2512.84,
      "Text": " So for example, .exe is blocked."
    },
    {
      "Time_Start": 2512.84,
      "Time_End": 2514.92,
      "Text": " And I played around with this this summer."
    },
    {
      "Time_Start": 2515.8,
      "Time_End": 2518.04,
      "Text": " If you change the file extension to like,"
    },
    {
      "Time_Start": 2518.04,
      "Time_End": 2521.6400000000003,
      "Text": " for example, .EXE, that actually worked."
    },
    {
      "Time_Start": 2521.64,
      "Time_End": 2525.24,
      "Text": " And I was able to bypass the execution controls"
    },
    {
      "Time_Start": 2525.24,
      "Time_End": 2528.52,
      "Text": " or the extension blacklist"
    },
    {
      "Time_Start": 2529.24,
      "Time_End": 2531.8799999999997,
      "Text": " and report it to Microsoft and they fixed it."
    },
    {
      "Time_Start": 2532.44,
      "Time_End": 2535.8799999999997,
      "Text": " But that's an example of just playing around"
    },
    {
      "Time_Start": 2535.8799999999997,
      "Time_End": 2537.8799999999997,
      "Text": " with what's available to you."
    },
    {
      "Time_Start": 2538.44,
      "Time_End": 2542.12,
      "Text": " And you can usually find some interesting functionality."
    },
    {
      "Time_Start": 2544.52,
      "Time_End": 2547.56,
      "Text": " And lastly, this is an example of creating a link."
    },
    {
      "Time_Start": 2548.12,
      "Time_End": 2550.12,
      "Text": " So you have the ability,"
    },
    {
      "Time_Start": 2550.12,
      "Time_End": 2553.56,
      "Text": " when you create an embedded object to a file,"
    },
    {
      "Time_Start": 2554.44,
      "Time_End": 2556.92,
      "Text": " you'll have this checkbox right here, link to file."
    },
    {
      "Time_Start": 2559.32,
      "Time_End": 2562.2799999999997,
      "Text": " And you would assume that it creates a normal link"
    },
    {
      "Time_Start": 2562.2799999999997,
      "Time_End": 2565.32,
      "Text": " where it gets linked in the XML, but it doesn't."
    },
    {
      "Time_Start": 2566.6,
      "Time_End": 2569.88,
      "Text": " It, I'm gonna move on to the next slide here,"
    },
    {
      "Time_Start": 2570.44,
      "Time_End": 2574.2799999999997,
      "Text": " which is, it actually creates an embedded object,"
    },
    {
      "Time_Start": 2574.2799999999997,
      "Time_End": 2576.12,
      "Text": " an embedded Packager object"
    },
    {
      "Time_Start": 2576.2,
      "Time_End": 2578.2,
      "Text": " that then links to a file."
    },
    {
      "Time_Start": 2578.2,
      "Time_End": 2580.04,
      "Text": " And so I actually haven't played around with this,"
    },
    {
      "Time_Start": 2580.04,
      "Time_End": 2581.96,
      "Text": " but I imagine that there's some interesting things"
    },
    {
      "Time_Start": 2581.96,
      "Time_End": 2583.3199999999997,
      "Text": " that can be done with this as well."
    },
    {
      "Time_Start": 2585.96,
      "Time_End": 2589.16,
      "Text": " So in some embedded objects or a vast attack surface,"
    },
    {
      "Time_Start": 2590.7599999999998,
      "Time_End": 2593.16,
      "Text": " it's gonna be a game of reverse engineering"
    },
    {
      "Time_Start": 2593.16,
      "Time_End": 2597.0,
      "Text": " to see which class IDs can ingest compound files"
    },
    {
      "Time_Start": 2597.0,
      "Time_End": 2599.48,
      "Text": " enough to do something interesting."
    },
    {
      "Time_Start": 2600.2799999999997,
      "Time_End": 2604.44,
      "Text": " So what I started doing was creating OLE objects"
    },
    {
      "Time_Start": 2605.4,
      "Time_End": 2607.88,
      "Text": " by calling like OLE create on class IDs"
    },
    {
      "Time_Start": 2607.88,
      "Time_End": 2611.64,
      "Text": " and then saving their state to a persistent storage"
    },
    {
      "Time_Start": 2611.64,
      "Time_End": 2614.04,
      "Text": " just to see what they look like."
    },
    {
      "Time_Start": 2614.04,
      "Time_End": 2616.6,
      "Text": " And I haven't been able to find anything interesting yet,"
    },
    {
      "Time_Start": 2616.6,
      "Time_End": 2618.2000000000003,
      "Text": " although I haven't gone through a lot of them,"
    },
    {
      "Time_Start": 2618.2000000000003,
      "Time_End": 2619.88,
      "Text": " just for examples."
    },
    {
      "Time_Start": 2619.88,
      "Time_End": 2621.2400000000002,
      "Text": " But I imagine that there's a bunch"
    },
    {
      "Time_Start": 2621.2400000000002,
      "Time_End": 2623.32,
      "Text": " where you can probably get"
    },
    {
      "Time_Start": 2623.32,
      "Time_End": 2625.4,
      "Text": " some interesting code execution scenarios."
    },
    {
      "Time_Start": 2628.52,
      "Time_End": 2630.52,
      "Text": " So lastly, this one is not OLE related."
    },
    {
      "Time_Start": 2631.8,
      "Time_End": 2633.4,
      "Text": " So we're gonna talk about smart documents"
    },
    {
      "Time_Start": 2634.04,
      "Time_End": 2638.28,
      "Text": " and smart documents are super old, poorly documented."
    },
    {
      "Time_Start": 2639.0,
      "Time_End": 2642.04,
      "Text": " And if you Google XML expansion packs,"
    },
    {
      "Time_Start": 2642.04,
      "Time_End": 2643.88,
      "Text": " you'll probably get better documentation on this"
    },
    {
      "Time_Start": 2643.88,
      "Time_End": 2645.2400000000002,
      "Text": " because that's essentially what they are."
    },
    {
      "Time_Start": 2648.76,
      "Time_End": 2650.28,
      "Text": " Yeah, this content's outdated."
    },
    {
      "Time_Start": 2650.28,
      "Time_End": 2652.12,
      "Text": " None of the documentation links still work."
    },
    {
      "Time_Start": 2653.0,
      "Time_End": 2655.08,
      "Text": " This is the warning that Microsoft put"
    },
    {
      "Time_Start": 2655.08,
      "Time_End": 2656.36,
      "Text": " on most of their pages."
    },
    {
      "Time_Start": 2657.2400000000002,
      "Time_End": 2658.76,
      "Text": " So what are smart documents?"
    },
    {
      "Time_Start": 2658.76,
      "Time_End": 2659.7200000000003,
      "Text": " Why did they get made?"
    },
    {
      "Time_Start": 2660.28,
      "Time_End": 2664.6800000000003,
      "Text": " The idea at the time was to be able to add custom XML"
    },
    {
      "Time_Start": 2664.6800000000003,
      "Time_End": 2666.5200000000004,
      "Text": " to the word ML schema"
    },
    {
      "Time_Start": 2666.5200000000004,
      "Time_End": 2669.7200000000003,
      "Text": " and then be able to write programmatic elements"
    },
    {
      "Time_Start": 2669.7200000000003,
      "Time_End": 2671.88,
      "Text": " for those XML fields."
    },
    {
      "Time_Start": 2671.88,
      "Time_End": 2675.4800000000005,
      "Text": " So they wanted things like automated timesheets"
    },
    {
      "Time_Start": 2675.4800000000005,
      "Time_End": 2677.32,
      "Text": " or financial reports, legal documents,"
    },
    {
      "Time_Start": 2677.32,
      "Time_End": 2680.44,
      "Text": " things that where, let's say you had a button"
    },
    {
      "Time_Start": 2680.44,
      "Time_End": 2682.92,
      "Text": " that did some custom code or something like that."
    },
    {
      "Time_Start": 2684.2000000000003,
      "Time_End": 2686.0400000000004,
      "Text": " So smart documents have three parts."
    },
    {
      "Time_Start": 2686.2799999999997,
      "Time_End": 2689.56,
      "Text": " They have a manifest and the manifest is similar"
    },
    {
      "Time_Start": 2689.56,
      "Time_End": 2691.56,
      "Text": " to like most manifests where it just kind of lists"
    },
    {
      "Time_Start": 2691.56,
      "Time_End": 2695.96,
      "Text": " out like the schema and the DLL that's attached to it"
    },
    {
      "Time_Start": 2695.96,
      "Time_End": 2697.24,
      "Text": " and what their names are"
    },
    {
      "Time_Start": 2697.24,
      "Time_End": 2699.64,
      "Text": " and what the class's ID are, what to expect."
    },
    {
      "Time_Start": 2702.04,
      "Time_End": 2705.16,
      "Text": " And then we have the schema itself."
    },
    {
      "Time_Start": 2705.96,
      "Time_End": 2709.64,
      "Text": " I got this from the Microsoft documentation page."
    },
    {
      "Time_Start": 2710.2,
      "Time_End": 2711.64,
      "Text": " And this is just an example"
    },
    {
      "Time_Start": 2711.64,
      "Time_End": 2714.2799999999997,
      "Text": " where they create a textbook or a text box"
    },
    {
      "Time_Start": 2714.28,
      "Time_End": 2715.0800000000004,
      "Text": " and a command button"
    },
    {
      "Time_Start": 2715.0800000000004,
      "Time_End": 2717.5600000000004,
      "Text": " and all these different types of elements."
    },
    {
      "Time_Start": 2718.36,
      "Time_End": 2722.28,
      "Text": " And then lastly, there's the actual code portion"
    },
    {
      "Time_Start": 2722.28,
      "Time_End": 2724.84,
      "Text": " which gets implemented as a DLL."
    },
    {
      "Time_Start": 2725.4,
      "Time_End": 2728.6800000000003,
      "Text": " So this is an example of a code segment"
    },
    {
      "Time_Start": 2728.6800000000003,
      "Time_End": 2730.0400000000004,
      "Text": " that's implementing functions"
    },
    {
      "Time_Start": 2730.0400000000004,
      "Time_End": 2732.1200000000003,
      "Text": " from the iSmart document interface."
    },
    {
      "Time_Start": 2732.1200000000003,
      "Time_End": 2734.44,
      "Text": " I also got this from the Microsoft documentation."
    },
    {
      "Time_Start": 2735.88,
      "Time_End": 2737.7200000000003,
      "Text": " And so at the end, you're gonna have a DLL"
    },
    {
      "Time_Start": 2737.7200000000003,
      "Time_End": 2739.88,
      "Text": " that gets loaded into Word"
    },
    {
      "Time_Start": 2739.88,
      "Time_End": 2742.6800000000003,
      "Text": " whenever this XML expansion pack is open."
    },
    {
      "Time_Start": 2745.2400000000002,
      "Time_End": 2747.48,
      "Text": " So typically this would be installed locally"
    },
    {
      "Time_Start": 2748.44,
      "Time_End": 2752.28,
      "Text": " but you can actually change the custom XML here on the left."
    },
    {
      "Time_Start": 2752.28,
      "Time_End": 2754.28,
      "Text": " So you'll see that we have a few new items"
    },
    {
      "Time_Start": 2754.28,
      "Time_End": 2756.0400000000004,
      "Text": " when we add an expansion pack."
    },
    {
      "Time_Start": 2756.76,
      "Time_End": 2758.52,
      "Text": " And we could actually include a property"
    },
    {
      "Time_Start": 2758.52,
      "Time_End": 2762.6000000000004,
      "Text": " called solution URL with a remote IP"
    },
    {
      "Time_Start": 2763.32,
      "Time_End": 2766.36,
      "Text": " as an SMB server with our manifest."
    },
    {
      "Time_Start": 2767.0,
      "Time_End": 2770.52,
      "Text": " And I blurred out the IP because it's my Amazon instance"
    },
    {
      "Time_Start": 2770.52,
      "Time_End": 2772.28,
      "Text": " but you're gonna see it in the video anyways."
    },
    {
      "Time_Start": 2772.28,
      "Time_End": 2773.96,
      "Text": " So I tried but fail."
    },
    {
      "Time_Start": 2776.52,
      "Time_End": 2778.6000000000004,
      "Text": " But there are quite a few defenses"
    },
    {
      "Time_Start": 2778.6000000000004,
      "Time_End": 2779.88,
      "Text": " to loading smart documents."
    },
    {
      "Time_Start": 2779.88,
      "Time_End": 2783.6400000000003,
      "Text": " So the manifest has to be signed"
    },
    {
      "Time_Start": 2784.36,
      "Time_End": 2787.48,
      "Text": " and the tool that they released to sign it,"
    },
    {
      "Time_Start": 2787.48,
      "Time_End": 2790.28,
      "Text": " I have not been able to find anywhere."
    },
    {
      "Time_Start": 2790.84,
      "Time_End": 2793.48,
      "Text": " And I really haven't had the time to reverse engineer"
    },
    {
      "Time_Start": 2794.28,
      "Time_End": 2796.44,
      "Text": " the XML library that parses that."
    },
    {
      "Time_Start": 2798.36,
      "Time_End": 2800.36,
      "Text": " But you can disable the signing requirement"
    },
    {
      "Time_Start": 2800.44,
      "Time_End": 2802.6,
      "Text": " and you will be prompted every time you load the document."
    },
    {
      "Time_Start": 2802.6,
      "Time_End": 2804.04,
      "Text": " So you're gonna get this warning message"
    },
    {
      "Time_Start": 2804.04,
      "Time_End": 2805.96,
      "Text": " at the bottom here that says,"
    },
    {
      "Time_Start": 2805.96,
      "Time_End": 2808.04,
      "Text": " XML expansion pack has been disabled."
    },
    {
      "Time_Start": 2808.84,
      "Time_End": 2810.84,
      "Text": " Do you wanna turn it back on?"
    },
    {
      "Time_Start": 2810.84,
      "Time_End": 2811.88,
      "Text": " And then you have to say,"
    },
    {
      "Time_Start": 2811.88,
      "Time_End": 2813.6400000000003,
      "Text": " no, I don't wanna turn it back on."
    },
    {
      "Time_Start": 2814.52,
      "Time_End": 2818.52,
      "Text": " But if you get it working, here's what that looks like."
    },
    {
      "Time_Start": 2819.96,
      "Time_End": 2822.1200000000003,
      "Text": " We have a file here called file antics."
    },
    {
      "Time_Start": 2825.08,
      "Time_End": 2827.32,
      "Text": " And you're gonna get a security warning"
    },
    {
      "Time_Start": 2828.04,
      "Time_End": 2829.6400000000003,
      "Text": " to an external XML extension."
    },
    {
      "Time_Start": 2830.84,
      "Time_End": 2833.08,
      "Text": " And then you're gonna get this one about"
    },
    {
      "Time_Start": 2835.2400000000002,
      "Time_End": 2837.56,
      "Text": " enabling the signature check."
    },
    {
      "Time_Start": 2837.56,
      "Time_End": 2839.7200000000003,
      "Text": " So if you can bypass that signature check,"
    },
    {
      "Time_Start": 2839.7200000000003,
      "Time_End": 2840.76,
      "Text": " you won't get this warning."
    },
    {
      "Time_Start": 2842.6,
      "Time_End": 2844.6800000000003,
      "Text": " You can see we're downloading a DLL"
    },
    {
      "Time_Start": 2844.6800000000003,
      "Time_End": 2845.8,
      "Text": " and we get calc to run."
    },
    {
      "Time_Start": 2846.84,
      "Time_End": 2848.44,
      "Text": " And then I just didn't finish coding up"
    },
    {
      "Time_Start": 2848.44,
      "Time_End": 2850.92,
      "Text": " the rest of the expansion pack."
    },
    {
      "Time_Start": 2850.92,
      "Time_End": 2853.32,
      "Text": " So you get an error message saying it wasn't valid."
    },
    {
      "Time_Start": 2853.32,
      "Time_End": 2855.0,
      "Text": " But if you take the time"
    },
    {
      "Time_Start": 2855.0,
      "Time_End": 2856.44,
      "Text": " and actually implement it all the way,"
    },
    {
      "Time_Start": 2856.44,
      "Time_End": 2857.8,
      "Text": " then you won't get that error message."
    },
    {
      "Time_Start": 2857.8,
      "Time_End": 2859.0,
      "Text": " I just kind of wanted to demonstrate"
    },
    {
      "Time_Start": 2859.0,
      "Time_End": 2863.0,
      "Text": " that you get native Win32 code execution"
    },
    {
      "Time_Start": 2863.0,
      "Time_End": 2864.52,
      "Text": " just by opening the document"
    },
    {
      "Time_Start": 2864.52,
      "Time_End": 2867.08,
      "Text": " and allowing the XML schema to run."
    },
    {
      "Time_Start": 2869.64,
      "Time_End": 2874.04,
      "Text": " So some of the things I wanna look at are,"
    },
    {
      "Time_Start": 2874.04,
      "Time_End": 2875.88,
      "Text": " for example, how is the manifest signed?"
    },
    {
      "Time_Start": 2875.88,
      "Time_End": 2878.36,
      "Text": " So this is so old that I wouldn't be surprised"
    },
    {
      "Time_Start": 2878.36,
      "Time_End": 2882.2,
      "Text": " if it was like using SHA-1 as a signature check."
    },
    {
      "Time_Start": 2882.2,
      "Time_End": 2884.28,
      "Text": " And in which case, can we do a collision"
    },
    {
      "Time_Start": 2884.28,
      "Time_End": 2885.08,
      "Text": " or something like that?"
    },
    {
      "Time_Start": 2886.44,
      "Time_End": 2888.12,
      "Text": " Another really interesting field"
    },
    {
      "Time_Start": 2888.12,
      "Time_End": 2889.88,
      "Text": " is this update frequency field,"
    },
    {
      "Time_Start": 2891.3199999999997,
      "Time_End": 2896.52,
      "Text": " which basically says every specified period,"
    },
    {
      "Time_Start": 2897.24,
      "Time_End": 2900.2,
      "Text": " go reach out to my remote server"
    },
    {
      "Time_Start": 2900.2,
      "Time_End": 2902.12,
      "Text": " and check if there's a version update."
    },
    {
      "Time_Start": 2902.12,
      "Time_End": 2903.64,
      "Text": " So if you do get this to work,"
    },
    {
      "Time_Start": 2903.64,
      "Time_End": 2906.8399999999997,
      "Text": " you can actually get a persistent implant"
    },
    {
      "Time_Start": 2906.8399999999997,
      "Time_End": 2909.3199999999997,
      "Text": " that checks every so often for updates"
    },
    {
      "Time_Start": 2909.3199999999997,
      "Time_End": 2912.2799999999997,
      "Text": " and you can install new functionality and whatnot."
    },
    {
      "Time_Start": 2914.2,
      "Time_End": 2915.72,
      "Text": " So if you're just tuning in now"
    },
    {
      "Time_Start": 2915.7200000000003,
      "Time_End": 2918.44,
      "Text": " or have been put to sleep by the last 45 minutes,"
    },
    {
      "Time_Start": 2918.44,
      "Time_End": 2920.5200000000004,
      "Text": " here are the main points I want you to walk away with."
    },
    {
      "Time_Start": 2921.6400000000003,
      "Time_End": 2923.0800000000004,
      "Text": " You can create only links"
    },
    {
      "Time_Start": 2923.0800000000004,
      "Time_End": 2925.32,
      "Text": " as soon as a user opens up an Office document"
    },
    {
      "Time_Start": 2925.32,
      "Time_End": 2927.5600000000004,
      "Text": " by using the link field code."
    },
    {
      "Time_Start": 2928.5200000000004,
      "Time_End": 2931.8,
      "Text": " And if you see a class ID in an Office document anywhere,"
    },
    {
      "Time_Start": 2932.6800000000003,
      "Time_End": 2934.84,
      "Text": " that's a huge attack surface that you can play with."
    },
    {
      "Time_Start": 2934.84,
      "Time_End": 2936.44,
      "Text": " So if you see one, swap it out,"
    },
    {
      "Time_Start": 2937.2400000000002,
      "Time_End": 2938.76,
      "Text": " start messing with it, see what happens."
    },
    {
      "Time_Start": 2939.6400000000003,
      "Time_End": 2942.36,
      "Text": " This is true for ActiveX controls and embedded objects."
    },
    {
      "Time_Start": 2943.1600000000003,
      "Time_End": 2945.1600000000003,
      "Text": " And any file can be embedded."
    },
    {
      "Time_Start": 2945.16,
      "Time_End": 2948.3599999999997,
      "Text": " And the question is, can you bypass that extension filter"
    },
    {
      "Time_Start": 2948.3599999999997,
      "Time_End": 2951.8799999999997,
      "Text": " by messing around with maybe the packager format?"
    },
    {
      "Time_Start": 2951.8799999999997,
      "Time_End": 2955.3999999999996,
      "Text": " Or can you include traditionally benign files"
    },
    {
      "Time_Start": 2955.3999999999996,
      "Time_End": 2956.8399999999997,
      "Text": " that can then do malicious things?"
    },
    {
      "Time_Start": 2958.04,
      "Time_End": 2960.7599999999998,
      "Text": " And then lastly, smart documents provide an attacker"
    },
    {
      "Time_Start": 2960.7599999999998,
      "Time_End": 2964.3599999999997,
      "Text": " with native Win32 code execution on document open."
    },
    {
      "Time_Start": 2965.0,
      "Time_End": 2967.16,
      "Text": " This means if you put in the time and resources"
    },
    {
      "Time_Start": 2967.16,
      "Time_End": 2968.8399999999997,
      "Text": " to bypass the signature check,"
    },
    {
      "Time_Start": 2970.04,
      "Time_End": 2972.52,
      "Text": " you will be rewarded with code execution mechanism"
    },
    {
      "Time_Start": 2972.52,
      "Time_End": 2975.24,
      "Text": " that's far more powerful than a VBA macro."
    },
    {
      "Time_Start": 2976.04,
      "Time_End": 2977.72,
      "Text": " And if you do find any bugs,"
    },
    {
      "Time_Start": 2977.72,
      "Time_End": 2981.48,
      "Text": " please report them to secure at Microsoft.com."
    },
    {
      "Time_Start": 2981.48,
      "Time_End": 2983.4,
      "Text": " So we are red teamers, we're attackers,"
    },
    {
      "Time_Start": 2984.2,
      "Time_End": 2985.08,
      "Text": " but at the end of the day,"
    },
    {
      "Time_Start": 2985.08,
      "Time_End": 2988.44,
      "Text": " we do actually want to make the internet a safer place."
    },
    {
      "Time_Start": 2990.04,
      "Time_End": 2993.88,
      "Text": " And this is hands down the most useful slide of this talk."
    },
    {
      "Time_Start": 2994.7599999999998,
      "Time_End": 2996.68,
      "Text": " These are some of the links that I jotted down"
    },
    {
      "Time_Start": 2996.68,
      "Time_End": 2999.8,
      "Text": " when I was doing research that were helpful"
    },
    {
      "Time_Start": 2999.8,
      "Time_End": 3001.48,
      "Text": " for the four topics that I presented."
    },
    {
      "Time_Start": 3002.52,
      "Time_End": 3005.72,
      "Text": " So most of the functionality discussed is very old"
    },
    {
      "Time_Start": 3005.72,
      "Time_End": 3008.2,
      "Text": " and documentations is sometimes scarce."
    },
    {
      "Time_Start": 3008.2,
      "Time_End": 3010.52,
      "Text": " So finding a collection of good articles and blogs"
    },
    {
      "Time_Start": 3010.52,
      "Time_End": 3013.0,
      "Text": " took up a lot of my time when I was researching this."
    },
    {
      "Time_Start": 3013.0,
      "Time_End": 3014.6,
      "Text": " So if you are interested,"
    },
    {
      "Time_Start": 3014.6,
      "Time_End": 3017.4,
      "Text": " if you want to pursue one of these avenues of research,"
    },
    {
      "Time_Start": 3018.28,
      "Time_End": 3019.72,
      "Text": " try to use this as a starting point"
    },
    {
      "Time_Start": 3019.72,
      "Time_End": 3021.64,
      "Text": " or feel free to use this as a starting point."
    },
    {
      "Time_Start": 3022.7599999999998,
      "Time_End": 3024.2,
      "Text": " And I would also like to mention that"
    },
    {
      "Time_Start": 3024.2,
      "Time_End": 3026.84,
      "Text": " InsideOle2.0 by Craig Brockschmidt"
    },
    {
      "Time_Start": 3027.56,
      "Time_End": 3029.88,
      "Text": " was an invaluable resource when studying Ole."
    },
    {
      "Time_Start": 3030.7599999999998,
      "Time_End": 3032.36,
      "Text": " And I highly recommend checking it out."
    },
    {
      "Time_Start": 3033.0,
      "Time_End": 3034.36,
      "Text": " It was so old that I had to get it"
    },
    {
      "Time_Start": 3034.36,
      "Time_End": 3036.1200000000003,
      "Text": " from an antique bookstore on Amazon"
    },
    {
      "Time_Start": 3036.1200000000003,
      "Time_End": 3037.96,
      "Text": " and it came with two floppy disks"
    },
    {
      "Time_Start": 3037.96,
      "Time_End": 3039.1600000000003,
      "Text": " because it couldn't fit on one."
    },
    {
      "Time_Start": 3040.44,
      "Time_End": 3043.2400000000002,
      "Text": " But Craig Brockschmidt makes a really good effort"
    },
    {
      "Time_Start": 3043.2400000000002,
      "Time_End": 3045.0,
      "Text": " at explaining Ole in plain English."
    },
    {
      "Time_Start": 3045.8,
      "Time_End": 3046.76,
      "Text": " And at the end of the day,"
    },
    {
      "Time_Start": 3046.76,
      "Time_End": 3049.88,
      "Text": " if you do want to get into office document exploitation,"
    },
    {
      "Time_Start": 3051.1600000000003,
      "Time_End": 3053.7200000000003,
      "Text": " I don't see any better path"
    },
    {
      "Time_Start": 3053.7200000000003,
      "Time_End": 3056.28,
      "Text": " than just becoming intimately familiar with Ole."
    },
    {
      "Time_Start": 3057.1600000000003,
      "Time_End": 3059.4,
      "Text": " So I think that is an unavoidable topic"
    },
    {
      "Time_Start": 3059.4,
      "Time_End": 3061.08,
      "Text": " if you really want to dig into this stuff."
    },
    {
      "Time_Start": 3062.92,
      "Time_End": 3064.36,
      "Text": " So that's all for my talk."
    },
    {
      "Time_Start": 3064.36,
      "Time_End": 3066.6,
      "Text": " I'm going to be hanging out in chat to answer questions."
    },
    {
      "Time_Start": 3067.48,
      "Time_End": 3069.6400000000003,
      "Text": " And if you have any questions at any point,"
    },
    {
      "Time_Start": 3069.6400000000003,
      "Time_End": 3070.84,
      "Text": " even after today,"
    },
    {
      "Time_Start": 3070.84,
      "Time_End": 3073.0,
      "Text": " please feel free to reach out on Twitter."
    },
    {
      "Time_Start": 3074.2000000000003,
      "Time_End": 3076.36,
      "Text": " I'm sure I left a lot of gaps in the talk."
    },
    {
      "Time_Start": 3076.36,
      "Time_End": 3079.0,
      "Text": " So if there's anything you'd also like to add or correct,"
    },
    {
      "Time_Start": 3079.0,
      "Time_End": 3080.6800000000003,
      "Text": " please also hit me up on Twitter."
    },
    {
      "Time_Start": 3081.56,
      "Time_End": 3084.6,
      "Text": " And lastly, I mentioned a couple of software projects"
    },
    {
      "Time_Start": 3084.6,
      "Time_End": 3087.56,
      "Text": " that I started in the talk or just one, Commapper."
    },
    {
      "Time_Start": 3088.1200000000003,
      "Time_End": 3090.84,
      "Text": " Then I have another one, Ole32debug.dll."
    },
    {
      "Time_Start": 3091.48,
      "Time_End": 3093.88,
      "Text": " They're not up on GitHub at the time of this recording,"
    },
    {
      "Time_Start": 3093.88,
      "Time_End": 3096.04,
      "Text": " but they should be up by the time this airs."
    },
    {
      "Time_Start": 3096.76,
      "Time_End": 3098.92,
      "Text": " So I'll drop those in chat so you can check them out."
    },
    {
      "Time_Start": 3098.92,
      "Time_End": 3100.52,
      "Text": " And then you could use those"
    },
    {
      "Time_Start": 3100.52,
      "Time_End": 3102.52,
      "Text": " as a part of your office document research."
    },
    {
      "Time_Start": 3102.52,
      "Time_End": 3105.56,
      "Text": " So thanks and enjoy the rest of the con."
    }
  ]
}