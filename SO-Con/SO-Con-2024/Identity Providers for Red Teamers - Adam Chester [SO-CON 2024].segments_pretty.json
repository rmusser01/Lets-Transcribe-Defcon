{
  "segments": [
    {
      "Time_Start": 0.0,
      "Time_End": 9.76,
      "Text": "This text was transcribed using whisper model: large-v2\n\n Hi, yeah, so thanks for coming to the talk. Quite a few people here. This is my first"
    },
    {
      "Time_Start": 9.76,
      "Time_End": 15.52,
      "Text": " talk that I've ever given, so a little bit nervous. Yes, thank you. So we're going to"
    },
    {
      "Time_Start": 15.52,
      "Time_End": 20.88,
      "Text": " be talking today about identity providers for Red Teamers. This is a continuation of"
    },
    {
      "Time_Start": 20.88,
      "Time_End": 27.400000000000002,
      "Text": " a previous blog post that I published focused around Okta. So just as a quick introduction"
    },
    {
      "Time_Start": 27.400000000000002,
      "Time_End": 35.24,
      "Text": " to myself, so my name's Adam Chester. I sometimes go by the alias XPN on social media, normally"
    },
    {
      "Time_Start": 35.24,
      "Time_End": 41.0,
      "Text": " posting things about how I dislike the way that Americans make tea, usually. I'm a principal"
    },
    {
      "Time_Start": 41.0,
      "Time_End": 46.040000000000006,
      "Text": " security consultant for TrustedSec. I have a blog that I run as well, which I generally"
    },
    {
      "Time_Start": 46.040000000000006,
      "Time_End": 51.84,
      "Text": " post my ramblings on, and different areas. So yeah, if you've not seen it, please check"
    },
    {
      "Time_Start": 51.84,
      "Time_End": 58.400000000000006,
      "Text": " that out. And in terms of what we're going to get through today, so the talk today that"
    },
    {
      "Time_Start": 58.400000000000006,
      "Time_End": 63.120000000000005,
      "Text": " we're going to be looking at are cloud-based identity providers, things that I've typically"
    },
    {
      "Time_Start": 63.120000000000005,
      "Time_End": 69.24000000000001,
      "Text": " encountered during Red Team engagements at my time with TrustedSec. We want to look at"
    },
    {
      "Time_Start": 69.24000000000001,
      "Time_End": 74.12,
      "Text": " how cloud-based identity providers are typically deployed within organizations. And again,"
    },
    {
      "Time_Start": 74.12,
      "Time_End": 78.28,
      "Text": " this is all based on experience of things that I've kind of seen over the last couple"
    },
    {
      "Time_Start": 78.28,
      "Time_End": 83.16,
      "Text": " of years. We're going to be looking at common attacks that have worked, so very hopefully"
    },
    {
      "Time_Start": 83.16,
      "Time_End": 89.6,
      "Text": " hands-on, just the right level of technical. We're not going to be, obviously, disclosing"
    },
    {
      "Time_Start": 89.6,
      "Time_End": 95.12,
      "Text": " any zero-data as part of this talk, but there's going to be a lot of demos. The demos are"
    },
    {
      "Time_Start": 95.12,
      "Time_End": 105.04,
      "Text": " pre-recorded, because I'm not confident enough to do this live yet. But yeah. So the providers"
    },
    {
      "Time_Start": 105.04,
      "Time_End": 110.28,
      "Text": " that I've kind of selected for this talk, so previously I've looked at Okta, and I've"
    },
    {
      "Time_Start": 110.28,
      "Time_End": 114.96000000000001,
      "Text": " kind of singled out Okta a little bit. Okta is probably one of the more popular cloud-based"
    },
    {
      "Time_Start": 114.96000000000001,
      "Time_End": 120.2,
      "Text": " identity providers that I've come across kind of doing Red Team operations. There are some"
    },
    {
      "Time_Start": 120.2,
      "Time_End": 123.04,
      "Text": " others as well that we have come across. So what I wanted to do during this talk was to"
    },
    {
      "Time_Start": 123.04,
      "Time_End": 127.92,
      "Text": " show that some of the attacks that I've pointed out in the past related to, say, Okta, don't"
    },
    {
      "Time_Start": 127.92,
      "Time_End": 132.24,
      "Text": " just apply to Okta. They also apply across the spectrum to other providers as well. So"
    },
    {
      "Time_Start": 132.24,
      "Time_End": 137.20000000000002,
      "Text": " we've got Ping Identity that I wanted to take a look at. One login that we see as well."
    },
    {
      "Time_Start": 137.20000000000002,
      "Time_End": 143.0,
      "Text": " Microsoft Entry ID is another provider, obviously probably one of the more popular providers."
    },
    {
      "Time_Start": 143.0,
      "Time_End": 148.28,
      "Text": " In terms of kind of the fair share of research that's been done already, so Microsoft Entry"
    },
    {
      "Time_Start": 148.28,
      "Time_End": 155.16000000000003,
      "Text": " ID has been scrutinized quite a bit due to its popularity. Okta, probably get in there"
    },
    {
      "Time_Start": 155.16000000000003,
      "Time_End": 160.0,
      "Text": " more so. So there's been a talk this morning, I think from Luke, who pointed out, say, Okta"
    },
    {
      "Time_Start": 160.0,
      "Time_End": 165.08,
      "Text": " in certain cases. Ping Identity on one login, you don't really see all that much research"
    },
    {
      "Time_Start": 165.08,
      "Time_End": 170.88,
      "Text": " about. I'm not too sure why that is. Maybe the popularity is not quite there yet for"
    },
    {
      "Time_Start": 170.88,
      "Time_End": 174.28,
      "Text": " attackers actually focusing on it. But I thought it'd be only fair to kind of look across the"
    },
    {
      "Time_Start": 174.28,
      "Time_End": 177.16,
      "Text": " spectrum of the different providers and see whether some of the attacks that we found"
    },
    {
      "Time_Start": 177.16,
      "Time_End": 184.24,
      "Text": " in the past actually work against these providers as well. So one thing I would say is if you"
    },
    {
      "Time_Start": 184.24,
      "Time_End": 189.48,
      "Text": " don't kind of see your identity provider of choice up here on the slide, kind of as I"
    },
    {
      "Time_Start": 189.48,
      "Time_End": 194.39999999999998,
      "Text": " work through this, most of the attacks that we're going to work through, and I use attacks"
    },
    {
      "Time_Start": 194.39999999999998,
      "Time_End": 199.88,
      "Text": " in air quotes, are actually by design. So there's nothing in here where an attacker"
    },
    {
      "Time_Start": 199.88,
      "Time_End": 206.51999999999998,
      "Text": " is going to be able to run amok on your environment without having privileges. But I would say"
    },
    {
      "Time_Start": 206.51999999999998,
      "Time_End": 209.92,
      "Text": " if you don't see your provider, maybe just take some of the techniques I'm going to show"
    },
    {
      "Time_Start": 209.92,
      "Time_End": 215.28,
      "Text": " and just try it. You'll often find that, as I say, a lot of this is by design. A lot of"
    },
    {
      "Time_Start": 215.28,
      "Time_End": 219.56,
      "Text": " other providers have similar based options and configuration options. So some of this"
    },
    {
      "Time_Start": 219.56,
      "Time_End": 224.88,
      "Text": " should just slot straight in. If you do find that any other providers are susceptible to"
    },
    {
      "Time_Start": 224.88,
      "Time_End": 230.72,
      "Text": " any of these attacks, I would ask that you please share that information where you can."
    },
    {
      "Time_Start": 230.72,
      "Time_End": 235.36,
      "Text": " I will talk about a little bit why I think that's a good idea in a moment. But yeah,"
    },
    {
      "Time_Start": 235.36,
      "Time_End": 238.36,
      "Text": " basically the idea is just give it a go and see. If you don't see your provider, just"
    },
    {
      "Time_Start": 238.36,
      "Time_End": 243.16,
      "Text": " take some of the techniques and try it for yourself."
    },
    {
      "Time_Start": 243.16,
      "Time_End": 247.2,
      "Text": " So let's kick off with deployment. So what I wanted to do is to call out a couple of"
    },
    {
      "Time_Start": 247.2,
      "Time_End": 256.08,
      "Text": " different deployment topologies that we've experienced during assessments. The common"
    },
    {
      "Time_Start": 256.08,
      "Time_End": 260.52,
      "Text": " kind of deployment scenario that we kind of see is something that would look like this,"
    },
    {
      "Time_Start": 260.52,
      "Time_End": 265.68,
      "Text": " where you've got users who will authenticate to, say, an Okta portal. And they would receive"
    },
    {
      "Time_Start": 265.68,
      "Time_End": 269.92,
      "Text": " a dashboard, and they go through, they would click on the application that they kind of"
    },
    {
      "Time_Start": 269.92,
      "Time_End": 274.2,
      "Text": " want to access. And there's some kind of like authentication bind in there to, say,"
    },
    {
      "Time_Start": 274.2,
      "Time_End": 279.24,
      "Text": " an external service provider. So in this case, we've got CrowdStrike, Databricks, AWS connected"
    },
    {
      "Time_Start": 279.24,
      "Time_End": 284.28000000000003,
      "Text": " by SAML into Okta. And your user experience here is normally that they would be on a laptop,"
    },
    {
      "Time_Start": 284.28000000000003,
      "Time_End": 288.72,
      "Text": " they would log into Okta, they would click on the icon and receive access to whatever"
    },
    {
      "Time_Start": 288.72,
      "Time_End": 296.52000000000004,
      "Text": " service provider it is that they're looking to access. In terms of kind of how you migrate"
    },
    {
      "Time_Start": 296.52,
      "Time_End": 300.28,
      "Text": " identities into these providers, so another scenario that we'll sometimes see is rather"
    },
    {
      "Time_Start": 300.28,
      "Time_End": 305.35999999999996,
      "Text": " than users being provisioned specifically against, say, Okta in this particular scenario,"
    },
    {
      "Time_Start": 305.35999999999996,
      "Time_End": 311.12,
      "Text": " what you might see is that there is actually a connector that has been deployed on a server."
    },
    {
      "Time_Start": 311.12,
      "Time_End": 315.15999999999997,
      "Text": " And that server connector may talk to Active Directory, and there's some kind of a sync"
    },
    {
      "Time_Start": 315.15999999999997,
      "Time_End": 319.71999999999997,
      "Text": " that's going on there. And ultimately, those identities are taken from, say, Active Directory"
    },
    {
      "Time_Start": 319.71999999999997,
      "Time_End": 324.71999999999997,
      "Text": " and synced straight into the identity provider. Sometimes this can work in a couple of varied"
    },
    {
      "Time_Start": 324.72,
      "Time_End": 331.56,
      "Text": " ways. Sometimes, say, in the case of EnterID, you may have syncing that happens where credentials"
    },
    {
      "Time_Start": 331.56,
      "Time_End": 335.92,
      "Text": " are actually hashed and then forwarded onto the provider. In this case, what we're going"
    },
    {
      "Time_Start": 335.92,
      "Time_End": 342.48,
      "Text": " to be looking at are scenarios where as a user enters credentials into, say, Okta, those"
    },
    {
      "Time_Start": 342.48,
      "Time_End": 347.56,
      "Text": " credentials are forwarded onto the service and then kind of checked against Active Directory"
    },
    {
      "Time_Start": 347.56,
      "Time_End": 353.6,
      "Text": " in real time. And that's a scenario that we'll come to in a moment."
    },
    {
      "Time_Start": 353.6,
      "Time_End": 359.04,
      "Text": " The other scenario that we typically see as well is where you have some kind of Kerberos"
    },
    {
      "Time_Start": 359.04,
      "Time_End": 363.8,
      "Text": " tie-in for the identity provider. So you will have, say, Okta, and you'll be able to authenticate"
    },
    {
      "Time_Start": 363.8,
      "Time_End": 369.8,
      "Text": " as an end user to Okta using a TGS, so a Kerberos ticket, which is granted from Active Directory."
    },
    {
      "Time_Start": 369.8,
      "Time_End": 375.6,
      "Text": " And there's this trust set up essentially between Active Directory and the identity"
    },
    {
      "Time_Start": 375.6,
      "Time_End": 380.88,
      "Text": " provider. And the idea here is that this happens transparently as far as the user's concerned."
    },
    {
      "Time_Start": 380.88,
      "Time_End": 385.52,
      "Text": " They will navigate to the Okta portal, some magic will happen, and eventually they will"
    },
    {
      "Time_Start": 385.52,
      "Time_End": 392.56,
      "Text": " end up signed into Okta. So those are the typical kind of topology that we will see."
    },
    {
      "Time_Start": 392.56,
      "Time_End": 397.71999999999997,
      "Text": " In terms of where we may land during an assessment, so one thing to call out here is more and"
    },
    {
      "Time_Start": 397.71999999999997,
      "Time_End": 404.44,
      "Text": " more often we're receiving, we're being asked essentially during a red team to target, you"
    },
    {
      "Time_Start": 404.44,
      "Time_End": 410.76,
      "Text": " know, service providers. So what we're trying to do is as part of a compromise of an organization"
    },
    {
      "Time_Start": 410.8,
      "Time_End": 415.24,
      "Text": " we're trying to position ourselves to be able to, you know, access these service providers."
    },
    {
      "Time_Start": 415.24,
      "Time_End": 419.15999999999997,
      "Text": " And one way that we've kind of come across that in the past is by compromising the identity"
    },
    {
      "Time_Start": 419.15999999999997,
      "Time_End": 424.24,
      "Text": " provider itself. So in this particular case, you know, we may have credentials to Okta,"
    },
    {
      "Time_Start": 424.96,
      "Time_End": 429.24,
      "Text": " privileged credentials that we can use then to go further our engagement to access different"
    },
    {
      "Time_Start": 429.24,
      "Time_End": 433.56,
      "Text": " service providers. So in this particular example, let's say the client has asked us to prove"
    },
    {
      "Time_Start": 433.56,
      "Time_End": 437.92,
      "Text": " that we can access Databricks, and we may want to position ourselves into a point where"
    },
    {
      "Time_Start": 437.92,
      "Time_End": 442.8,
      "Text": " we can actually access Okta as a privileged user or a user who has access to Databricks"
    },
    {
      "Time_Start": 442.8,
      "Time_End": 446.88,
      "Text": " and then go through, authenticate as the user, and then go and access the actual service"
    },
    {
      "Time_Start": 446.88,
      "Time_End": 452.56,
      "Text": " itself. In other scenarios, we may find that we've been tasked with accessing, again to"
    },
    {
      "Time_Start": 452.56,
      "Time_End": 456.88,
      "Text": " point out Databricks, we're tasked to access Databricks, but we may find ourselves having"
    },
    {
      "Time_Start": 456.88,
      "Time_End": 461.16,
      "Text": " compromised Active Directory and kind of wondering how it is that we actually then go through"
    },
    {
      "Time_Start": 461.16,
      "Time_End": 467.12,
      "Text": " Okta or any kind of cloud-based identity provider to reach the service provider itself. So this"
    },
    {
      "Time_Start": 467.12,
      "Time_End": 471.44,
      "Text": " is a challenge as well, and these kind of scenarios are more common where we think that"
    },
    {
      "Time_Start": 471.44,
      "Time_End": 475.6,
      "Text": " we've kind of compromised an organization and actually find out that this is just the"
    },
    {
      "Time_Start": 475.6,
      "Time_End": 479.84000000000003,
      "Text": " beginning because we've then got to find a way, say, through Okta or through the cloud-based"
    },
    {
      "Time_Start": 479.84000000000003,
      "Time_End": 486.76,
      "Text": " identity provider onto the actual critical assets that the client has to access. In a"
    },
    {
      "Time_Start": 486.76,
      "Time_End": 490.4,
      "Text": " more complicated scenario, sometimes we may find that we've actually compromised Active"
    },
    {
      "Time_Start": 490.4,
      "Time_End": 495.4,
      "Text": " Directory. We've landed ourselves on a server which has got an agent running. So this agent"
    },
    {
      "Time_Start": 495.44000000000005,
      "Time_End": 499.6,
      "Text": " is responsible for doing the syncing that we talked about earlier on, or it's responsible"
    },
    {
      "Time_Start": 499.6,
      "Time_End": 503.68,
      "Text": " for receiving credentials, which it's going to check against Active Directory. And again,"
    },
    {
      "Time_Start": 503.68,
      "Time_End": 508.72,
      "Text": " we're tasked with accessing the service provider, such as Databricks, moving through Okta, and"
    },
    {
      "Time_Start": 508.72,
      "Time_End": 513.4000000000001,
      "Text": " we kind of have to figure out how to kind of navigate that. And the final scenario that"
    },
    {
      "Time_Start": 513.4000000000001,
      "Time_End": 517.6,
      "Text": " I wanted to call out is the inevitable endpoint compromise. So we've landed on an endpoint"
    },
    {
      "Time_Start": 517.6,
      "Time_End": 523.0,
      "Text": " for a compromised user, and what we want to do is, again, impersonate that user for, say,"
    },
    {
      "Time_Start": 523.0,
      "Time_End": 528.2,
      "Text": " Okta, and kind of access the service provider on behalf of the user. This is quite a common"
    },
    {
      "Time_Start": 528.2,
      "Time_End": 532.64,
      "Text": " scenario that we will encounter. So this is your phishing technique where you've landed"
    },
    {
      "Time_Start": 532.64,
      "Time_End": 537.04,
      "Text": " an implant, and you kind of want to move on then through to the cloud-based identity provider"
    },
    {
      "Time_Start": 537.04,
      "Time_End": 542.0,
      "Text": " to access the services that that user has access to. So before we get on to the actual"
    },
    {
      "Time_Start": 542.0,
      "Time_End": 547.8,
      "Text": " attacks itself, just a little bit of ranting from me. One of the things that inevitably"
    },
    {
      "Time_Start": 547.8,
      "Time_End": 551.64,
      "Text": " comes up when I start to talk about these things and start to blog about them and talk"
    },
    {
      "Time_Start": 551.64,
      "Time_End": 556.52,
      "Text": " about them on social media is, why is it that you're kind of disclosing this information?"
    },
    {
      "Time_Start": 556.52,
      "Time_End": 559.96,
      "Text": " Why is it that you're putting this out into the open? Are you giving the bad guys the"
    },
    {
      "Time_Start": 559.96,
      "Time_End": 565.16,
      "Text": " actual techniques to be able to run away with here and kind of cause more damage? What I"
    },
    {
      "Time_Start": 565.16,
      "Time_End": 570.1999999999999,
      "Text": " wanted to point out as part of this is there's actually no need to do this. The genuine attackers"
    },
    {
      "Time_Start": 570.1999999999999,
      "Time_End": 576.4399999999999,
      "Text": " already know a lot of this anyway. So as we kind of look at some previous breaches that"
    },
    {
      "Time_Start": 576.44,
      "Time_End": 584.2800000000001,
      "Text": " have happened, so I disclosed the blog post, the Otter for Red team's blog post, just after"
    },
    {
      "Time_Start": 584.2800000000001,
      "Time_End": 589.36,
      "Text": " this actually hit the headlines. So we saw that the Alpha group was targeting MGM. And"
    },
    {
      "Time_Start": 589.36,
      "Time_End": 592.4000000000001,
      "Text": " actually one of the techniques that they used to harvest credentials is one of the techniques"
    },
    {
      "Time_Start": 592.4000000000001,
      "Time_End": 596.96,
      "Text": " that I'll talk about in this talk, where they were actually harvesting plain text credentials"
    },
    {
      "Time_Start": 596.96,
      "Time_End": 602.32,
      "Text": " using the Otter Sync agent. This came as a massive surprise to quite a few people who"
    },
    {
      "Time_Start": 602.32,
      "Time_End": 607.88,
      "Text": " didn't realize that you could do this. Myself and my colleagues kind of were a little bit"
    },
    {
      "Time_Start": 607.88,
      "Time_End": 610.96,
      "Text": " surprised by that because we just assumed that this knowledge was already out there"
    },
    {
      "Time_Start": 610.96,
      "Time_End": 615.0400000000001,
      "Text": " and that defenders were all kind of aware of this. But actually that seemed to not be"
    },
    {
      "Time_Start": 615.0400000000001,
      "Time_End": 621.12,
      "Text": " the case. And just another example as well, so you've got AP329, as part of the Sunburst"
    },
    {
      "Time_Start": 621.12,
      "Time_End": 625.6800000000001,
      "Text": " attacks, they were using Golden Samu attacks to be able to transition from on-site to,"
    },
    {
      "Time_Start": 625.6800000000001,
      "Time_End": 631.2,
      "Text": " I believe it was Azure. So again, these techniques that we take for granted in the Red team space,"
    },
    {
      "Time_Start": 631.2,
      "Time_End": 637.44,
      "Text": " I don't think they've been publicized as well in the defender space. So hopefully as"
    },
    {
      "Time_Start": 637.44,
      "Time_End": 642.12,
      "Text": " part of giving this talk, what I can kind of show is, these techniques are known. Hopefully"
    },
    {
      "Time_Start": 642.12,
      "Time_End": 646.84,
      "Text": " you will know about them as well as I've kind of presented the talk. Obviously we're going"
    },
    {
      "Time_Start": 646.84,
      "Time_End": 650.96,
      "Text": " to run through the details. It is going to be quite high level. So I'll show some of"
    },
    {
      "Time_Start": 650.96,
      "Time_End": 654.6800000000001,
      "Text": " the attack techniques and kind of how they work. There will be blog posts that will follow"
    },
    {
      "Time_Start": 654.6800000000001,
      "Time_End": 658.6400000000001,
      "Text": " to provide some of the lower level techniques. But ultimately it's all about leveling the"
    },
    {
      "Time_Start": 658.64,
      "Time_End": 662.88,
      "Text": " playing field now. So what we want to do is obviously give you the knowledge so that"
    },
    {
      "Time_Start": 662.88,
      "Time_End": 667.04,
      "Text": " you can go on to defend yourselves. And also if you're a Red teamer, to take this knowledge"
    },
    {
      "Time_Start": 667.04,
      "Time_End": 671.12,
      "Text": " and actually go and simulate some of these activities during your Red team campaigns,"
    },
    {
      "Time_Start": 671.12,
      "Time_End": 675.4,
      "Text": " if you wasn't already aware of them. And ultimately about getting the knowledge out there to show"
    },
    {
      "Time_Start": 675.4,
      "Time_End": 679.76,
      "Text": " this information is known. We know about it as Red teamers, attackers know about it as"
    },
    {
      "Time_Start": 679.76,
      "Time_End": 684.2,
      "Text": " well. So hopefully as defenders, you can kind of go forward and kind of simulate some of"
    },
    {
      "Time_Start": 684.2,
      "Time_End": 689.88,
      "Text": " these scenarios. Okay, so onto the good stuff, the attacks. The first thing that we're going"
    },
    {
      "Time_Start": 689.88,
      "Time_End": 695.0,
      "Text": " to look at is log on user W. So this is a technique, it's probably one of the first"
    },
    {
      "Time_Start": 695.0,
      "Time_End": 699.9200000000001,
      "Text": " techniques that I became aware of when I started looking at identity providers and actually"
    },
    {
      "Time_Start": 699.9200000000001,
      "Time_End": 705.32,
      "Text": " how to use these for malicious purposes. So for anyone that's not aware, log on user W"
    },
    {
      "Time_Start": 705.32,
      "Time_End": 711.48,
      "Text": " is an API call in Windows. It's a Win32 API call. Essentially for the purposes of this"
    },
    {
      "Time_Start": 711.48,
      "Time_End": 716.88,
      "Text": " talk, what it will do is it will allow you to take a username, password and domain, and"
    },
    {
      "Time_Start": 716.88,
      "Time_End": 722.9200000000001,
      "Text": " it will allow you to check those to see whether the username and password is in fact correct."
    },
    {
      "Time_Start": 722.9200000000001,
      "Time_End": 726.76,
      "Text": " As we kind of show through the next couple of slides, bear in mind that if an attacker"
    },
    {
      "Time_Start": 726.76,
      "Time_End": 731.84,
      "Text": " is able to kind of intercept this API call, it's quite lucrative for the attacker because"
    },
    {
      "Time_Start": 731.84,
      "Time_End": 736.04,
      "Text": " what you're actually getting out of this is a plain text username and password, which"
    },
    {
      "Time_Start": 736.0799999999999,
      "Time_End": 739.5999999999999,
      "Text": " makes it quite lucrative for attackers when they're actually looking to compromise an"
    },
    {
      "Time_Start": 739.5999999999999,
      "Time_End": 746.5999999999999,
      "Text": " environment. So previous works, back in 2019, I published a blog post looking at Azure AD"
    },
    {
      "Time_Start": 746.5999999999999,
      "Time_End": 751.64,
      "Text": " Connect for Red Teamers. This exact technique was called out as part of that blog post."
    },
    {
      "Time_Start": 751.64,
      "Time_End": 756.24,
      "Text": " So one of the things that I wanted to look at was, I don't know if you can see, we'll do"
    },
    {
      "Time_Start": 756.24,
      "Time_End": 761.7199999999999,
      "Text": " magnify. So one of the things that I kind of pointed out was the log on user call was"
    },
    {
      "Time_Start": 761.72,
      "Time_End": 768.48,
      "Text": " being used to check credentials as users were entering them into the Microsoft portal."
    },
    {
      "Time_Start": 768.48,
      "Time_End": 772.6800000000001,
      "Text": " So one of the things, again, that we kind of wanted to look at was could we hook this"
    },
    {
      "Time_Start": 772.6800000000001,
      "Time_End": 776.2,
      "Text": " particular API call and would it provide us plain text credentials?"
    },
    {
      "Time_Start": 776.2,
      "Time_End": 779.6,
      "Text": " And the answer at the time was yes, this was absolutely possible."
    },
    {
      "Time_Start": 779.6,
      "Time_End": 783.84,
      "Text": " This is the technique essentially that I talked about with the Alpha group earlier on."
    },
    {
      "Time_Start": 783.84,
      "Time_End": 789.1600000000001,
      "Text": " This is what they were doing with Okta. So this knowledge has been out there for a while."
    },
    {
      "Time_Start": 789.16,
      "Time_End": 792.28,
      "Text": " So what I decided to do was to look at each of the providers and just understand whether"
    },
    {
      "Time_Start": 792.28,
      "Time_End": 797.52,
      "Text": " they're connectors that do the authentication checking when there's an integration set up"
    },
    {
      "Time_Start": 797.52,
      "Time_End": 803.24,
      "Text": " with Active Directory, whether this actually was the case across the different providers."
    },
    {
      "Time_Start": 803.24,
      "Time_End": 805.48,
      "Text": " The answer is yes, they all do this."
    },
    {
      "Time_Start": 805.48,
      "Time_End": 807.7199999999999,
      "Text": " I should say there's absolutely nothing wrong with doing this."
    },
    {
      "Time_Start": 807.7199999999999,
      "Time_End": 810.76,
      "Text": " Like this is a legitimate API call."
    },
    {
      "Time_Start": 810.76,
      "Time_End": 815.24,
      "Text": " As an attacker to position yourself to be able to intercept these credentials, you need to be in a"
    },
    {
      "Time_Start": 815.24,
      "Time_End": 816.76,
      "Text": " privileged position."
    },
    {
      "Time_Start": 816.76,
      "Time_End": 820.4,
      "Text": " But ultimately, yes, everybody's kind of doing the same thing with one exception that we'll point out"
    },
    {
      "Time_Start": 820.4,
      "Time_End": 820.88,
      "Text": " in a moment."
    },
    {
      "Time_Start": 820.88,
      "Time_End": 826.48,
      "Text": " So this is Okta making a logon user call to check credentials that are entered to make sure that"
    },
    {
      "Time_Start": 826.48,
      "Time_End": 829.4,
      "Text": " they're valid against the domain."
    },
    {
      "Time_Start": 829.4,
      "Time_End": 830.8,
      "Text": " This is EnterID."
    },
    {
      "Time_Start": 830.8,
      "Time_End": 831.72,
      "Text": " This has not changed."
    },
    {
      "Time_Start": 831.72,
      "Time_End": 834.28,
      "Text": " Like this is exactly the same as 2019."
    },
    {
      "Time_Start": 834.28,
      "Time_End": 838.48,
      "Text": " The architecture is exactly the same as it always was."
    },
    {
      "Time_Start": 838.48,
      "Time_End": 845.3199999999999,
      "Text": " And this is one login, exactly the same logon user is called in the DLL there."
    },
    {
      "Time_Start": 845.32,
      "Time_End": 847.2,
      "Text": " The one that stands out a little bit is Ping."
    },
    {
      "Time_Start": 847.2,
      "Time_End": 849.4000000000001,
      "Text": " So Ping do things very differently."
    },
    {
      "Time_Start": 849.4000000000001,
      "Time_End": 854.7600000000001,
      "Text": " He's one of the providers that we kind of set up and try to understand how they were actually doing"
    },
    {
      "Time_Start": 854.7600000000001,
      "Time_End": 856.84,
      "Text": " credential checking against Active Directory."
    },
    {
      "Time_Start": 856.84,
      "Time_End": 858.8000000000001,
      "Text": " I won't go into it too much here."
    },
    {
      "Time_Start": 858.8000000000001,
      "Time_End": 861.2,
      "Text": " Maybe that's for another blog post later on."
    },
    {
      "Time_Start": 861.2,
      "Time_End": 863.24,
      "Text": " But yeah, that's all based on Java."
    },
    {
      "Time_Start": 863.24,
      "Time_End": 865.6800000000001,
      "Text": " It doesn't necessarily have to run on Windows."
    },
    {
      "Time_Start": 865.6800000000001,
      "Time_End": 867.88,
      "Text": " They do something a little bit different."
    },
    {
      "Time_Start": 867.88,
      "Time_End": 872.44,
      "Text": " But essentially, this technique is not going to work against Ping."
    },
    {
      "Time_Start": 872.44,
      "Time_End": 873.96,
      "Text": " Okay, so a quick demo."
    },
    {
      "Time_Start": 873.96,
      "Time_End": 876.84,
      "Text": " Hopefully, that's big enough for everybody to see."
    },
    {
      "Time_Start": 876.84,
      "Time_End": 880.0,
      "Text": " I can zoom into the different areas kind of as they go through."
    },
    {
      "Time_Start": 880.0,
      "Time_End": 884.24,
      "Text": " And what I wanted to show here was kind of how this hooking actually happens."
    },
    {
      "Time_Start": 884.24,
      "Time_End": 886.9200000000001,
      "Text": " So this is a debugger that's been set up."
    },
    {
      "Time_Start": 886.9200000000001,
      "Time_End": 891.1600000000001,
      "Text": " The debugger itself is attached into a service, so the Okta sync service."
    },
    {
      "Time_Start": 891.1600000000001,
      "Time_End": 894.08,
      "Text": " Sorry, it's the Okta AD agent service."
    },
    {
      "Time_Start": 894.08,
      "Time_End": 899.2,
      "Text": " And what I kind of wanted to show was this in kind of, you know, realities to how this works."
    },
    {
      "Time_Start": 899.2,
      "Time_End": 908.44,
      "Text": " So essentially, what we're doing here is we are debugging against the Okta agent service."
    },
    {
      "Time_Start": 908.44,
      "Time_End": 912.4000000000001,
      "Text": " And what we're going to do is we're going to add a breakpoint onto logon user W,"
    },
    {
      "Time_Start": 912.4000000000001,
      "Time_End": 916.0,
      "Text": " which is the API call that is used to actually perform the checking."
    },
    {
      "Time_Start": 916.0,
      "Time_End": 919.88,
      "Text": " And what we want to show here is just, as I say, how this technique actually works"
    },
    {
      "Time_Start": 919.88,
      "Time_End": 921.76,
      "Text": " when somebody goes through and enters credentials."
    },
    {
      "Time_Start": 921.76,
      "Time_End": 925.5600000000001,
      "Text": " So here, we've got somebody entering credentials into an Okta portal."
    },
    {
      "Time_Start": 926.5600000000001,
      "Time_End": 932.5200000000001,
      "Text": " And as the user clicks through and enters in the password,"
    },
    {
      "Time_Start": 932.5200000000001,
      "Time_End": 937.72,
      "Text": " what you will see here is that, obviously, the API call is called."
    },
    {
      "Time_Start": 937.72,
      "Time_End": 943.4000000000001,
      "Text": " And this is where you see the password, can you see me, is actually disclosed in plain text."
    },
    {
      "Time_Start": 943.4000000000001,
      "Time_End": 947.7600000000001,
      "Text": " So again, just to call this out, this is the technique that was actually used by the alpha group"
    },
    {
      "Time_Start": 947.7600000000001,
      "Time_End": 951.48,
      "Text": " to actually extract out credentials."
    },
    {
      "Time_Start": 951.48,
      "Time_End": 954.5200000000001,
      "Text": " Obviously, they didn't use a debugger to do this."
    },
    {
      "Time_Start": 954.76,
      "Time_End": 959.52,
      "Text": " They used a specific tool that they, I would guess, coded up themselves."
    },
    {
      "Time_Start": 959.52,
      "Time_End": 961.56,
      "Text": " And the tool would have looked something like this."
    },
    {
      "Time_Start": 961.56,
      "Time_End": 965.36,
      "Text": " So you have a DLL that you would inject into the sync service."
    },
    {
      "Time_Start": 965.36,
      "Time_End": 968.52,
      "Text": " And that DLL actually performs the hooking itself."
    },
    {
      "Time_Start": 968.52,
      "Time_End": 973.96,
      "Text": " And then when a user attempts to log in, you can then essentially pass out the credentials"
    },
    {
      "Time_Start": 973.96,
      "Time_End": 975.56,
      "Text": " that we've just seen in the debugger."
    },
    {
      "Time_Start": 975.56,
      "Time_End": 979.12,
      "Text": " And in this case, we're just printing them out to screen."
    },
    {
      "Time_Start": 979.12,
      "Time_End": 982.4,
      "Text": " So just wanted to show a very quick demo of kind of how that works as well."
    },
    {
      "Time_Start": 982.4,
      "Time_End": 986.3199999999999,
      "Text": " So again, this is a tool that we'll be getting, it's kind of already out there,"
    },
    {
      "Time_Start": 986.3199999999999,
      "Time_End": 989.6,
      "Text": " but I'll re-release it kind of towards the end of the week."
    },
    {
      "Time_Start": 989.6,
      "Time_End": 995.52,
      "Text": " This injector tool just injects a DLL into what would be the opt-to process here,"
    },
    {
      "Time_Start": 995.52,
      "Time_End": 999.52,
      "Text": " but this also works for one login as well."
    },
    {
      "Time_Start": 999.52,
      "Time_End": 1002.1999999999999,
      "Text": " So similar kind of thing."
    },
    {
      "Time_Start": 1002.1999999999999,
      "Time_End": 1010.48,
      "Text": " And then, yeah, of course, the user goes in, enters in their credentials and password."
    },
    {
      "Time_Start": 1010.48,
      "Time_End": 1013.84,
      "Text": " And yeah, so ultimately what you get out is the plain text credentials as well."
    },
    {
      "Time_Start": 1013.84,
      "Time_End": 1018.08,
      "Text": " So the takeaway from this really is as an attacker, if you've got access to a box"
    },
    {
      "Time_Start": 1018.08,
      "Time_End": 1024.04,
      "Text": " which has kind of the agent deployed, which performs the authentication check"
    },
    {
      "Time_Start": 1024.04,
      "Time_End": 1029.68,
      "Text": " against Active Directory, you are in a position to be able to extract out plain text credentials."
    },
    {
      "Time_Start": 1029.68,
      "Time_End": 1034.1200000000001,
      "Text": " So obviously, use that knowledge kind of as you want to."
    },
    {
      "Time_Start": 1034.1200000000001,
      "Time_End": 1037.44,
      "Text": " We will go on to show some stealthier techniques as to how this can be performed,"
    },
    {
      "Time_Start": 1037.44,
      "Time_End": 1042.4,
      "Text": " because obviously there's some limitations here around evading EDR and having to inject into processes."
    },
    {
      "Time_Start": 1042.4,
      "Time_End": 1048.3200000000002,
      "Text": " But ultimately, yeah, this is an attack that is used in the wild at the moment."
    },
    {
      "Time_Start": 1048.3200000000002,
      "Time_End": 1050.3200000000002,
      "Text": " Okay, so we'll move on to something a little bit different."
    },
    {
      "Time_Start": 1050.3200000000002,
      "Time_End": 1053.76,
      "Text": " So in this case, we're going to talk about agent spoofing."
    },
    {
      "Time_Start": 1053.76,
      "Time_End": 1057.2,
      "Text": " So this is something that I call it, I call it agent spoofing."
    },
    {
      "Time_Start": 1057.2,
      "Time_End": 1061.28,
      "Text": " It's got a couple of different names, but essentially what we're trying to do here is"
    },
    {
      "Time_Start": 1061.28,
      "Time_End": 1065.4,
      "Text": " we're trying to take advantage of the fact that agents can run outside of the client environment."
    },
    {
      "Time_Start": 1065.4,
      "Time_End": 1068.96,
      "Text": " So one of the things that I like to do is to take the agents themselves"
    },
    {
      "Time_Start": 1068.96,
      "Time_End": 1073.76,
      "Text": " and figure out kind of how they interact with the service provider,"
    },
    {
      "Time_Start": 1073.76,
      "Time_End": 1077.68,
      "Text": " how they interact with the identity provider, look at how credentials are passed down."
    },
    {
      "Time_Start": 1077.68,
      "Time_End": 1082.4,
      "Text": " Actually, so to use Okta as an example here, how that sync actually happens"
    },
    {
      "Time_Start": 1082.4,
      "Time_End": 1085.1200000000001,
      "Text": " and how the authentication credentials are actually passed through."
    },
    {
      "Time_Start": 1085.1200000000001,
      "Time_End": 1087.6000000000001,
      "Text": " So there's a couple of advantages to doing it this way."
    },
    {
      "Time_Start": 1087.6000000000001,
      "Time_End": 1094.0800000000002,
      "Text": " One of the advantages is if we understand how the agent communicates up with the identity provider,"
    },
    {
      "Time_Start": 1094.08,
      "Time_End": 1097.4399999999998,
      "Text": " we may be able to find bugs in the protocol."
    },
    {
      "Time_Start": 1097.4399999999998,
      "Time_End": 1100.8,
      "Text": " We may be able to leak out API tokens during an engagement"
    },
    {
      "Time_Start": 1100.8,
      "Time_End": 1104.8,
      "Text": " and actually take these outside of the client environment for assistance purposes."
    },
    {
      "Time_Start": 1104.8,
      "Time_End": 1108.1599999999999,
      "Text": " We may be able to do that and not have to use things like injection,"
    },
    {
      "Time_Start": 1108.1599999999999,
      "Time_End": 1110.0,
      "Text": " which we showed in the previous example,"
    },
    {
      "Time_Start": 1110.0,
      "Time_End": 1115.6799999999998,
      "Text": " which is becoming much more difficult in the phase of the increased focus by EDRs at the moment."
    },
    {
      "Time_Start": 1115.6799999999998,
      "Time_End": 1119.6,
      "Text": " The disadvantages to doing this, so obviously the protocols can change."
    },
    {
      "Time_Start": 1119.6,
      "Time_End": 1123.12,
      "Text": " So the way that these agents actually go and talk to identity providers,"
    },
    {
      "Time_Start": 1123.5200000000002,
      "Time_End": 1125.2800000000002,
      "Text": " they can change as they want to."
    },
    {
      "Time_Start": 1125.2800000000002,
      "Time_End": 1128.88,
      "Text": " This is non-standard and there's a lot of undefined behavior as well."
    },
    {
      "Time_Start": 1128.88,
      "Time_End": 1134.3200000000002,
      "Text": " So kind of the way that this works and using token on two agents"
    },
    {
      "Time_Start": 1134.3200000000002,
      "Time_End": 1137.0400000000002,
      "Text": " and using things essentially as they weren't kind of designed."
    },
    {
      "Time_Start": 1138.0000000000002,
      "Time_End": 1141.1200000000001,
      "Text": " You know, there is some undefined behavior, which I'll try and call out in a moment."
    },
    {
      "Time_Start": 1142.24,
      "Time_End": 1146.24,
      "Text": " But yeah, essentially just test these scenarios before you actually run them"
    },
    {
      "Time_Start": 1146.24,
      "Time_End": 1147.5200000000002,
      "Text": " kind of on a client environment."
    },
    {
      "Time_Start": 1148.16,
      "Time_End": 1149.68,
      "Text": " You don't want to be taking down that kind of"
    },
    {
      "Time_Start": 1150.48,
      "Time_End": 1153.76,
      "Text": " Okta access for employees across the organization."
    },
    {
      "Time_Start": 1154.48,
      "Time_End": 1156.24,
      "Text": " So yeah, I'll show the examples,"
    },
    {
      "Time_Start": 1156.24,
      "Time_End": 1159.36,
      "Text": " but just please make sure that you lab them before you actually use them on an assessment."
    },
    {
      "Time_Start": 1161.28,
      "Time_End": 1163.76,
      "Text": " So the first example that we'll look at is Okta."
    },
    {
      "Time_Start": 1163.76,
      "Time_End": 1167.52,
      "Text": " So again, this is something that I published in the blog post."
    },
    {
      "Time_Start": 1167.52,
      "Time_End": 1170.56,
      "Text": " And what we wanted to see here was if we compromise an endpoint,"
    },
    {
      "Time_Start": 1170.56,
      "Time_End": 1174.0,
      "Text": " sorry, if we compromise a server that has the Okta agent running on there,"
    },
    {
      "Time_Start": 1174.8,
      "Time_End": 1178.32,
      "Text": " can we actually extract out the API token that's used for authentication"
    },
    {
      "Time_Start": 1178.96,
      "Time_End": 1180.56,
      "Text": " up to Okta from the service?"
    },
    {
      "Time_Start": 1181.36,
      "Time_End": 1182.64,
      "Text": " And kind of what does that look like?"
    },
    {
      "Time_Start": 1182.64,
      "Time_End": 1188.0,
      "Text": " So yeah, I mean, the service itself needs to authenticate itself up to Okta."
    },
    {
      "Time_Start": 1188.0,
      "Time_End": 1189.92,
      "Text": " So of course, we can extract out the credentials."
    },
    {
      "Time_Start": 1191.12,
      "Time_End": 1193.2,
      "Text": " The way that you do that is a little convoluted."
    },
    {
      "Time_Start": 1193.2,
      "Time_End": 1198.16,
      "Text": " It is an XML file, which lives in okta-agentservice.exe.config."
    },
    {
      "Time_Start": 1198.8000000000002,
      "Time_End": 1202.88,
      "Text": " And the XML file has an agent token, which is DPAPI encrypted."
    },
    {
      "Time_Start": 1204.64,
      "Time_End": 1207.2,
      "Text": " So we'll have to go through and decrypt that, which I'll show in a moment."
    },
    {
      "Time_Start": 1208.16,
      "Time_End": 1209.8400000000001,
      "Text": " I will say in the case of Okta,"
    },
    {
      "Time_Start": 1209.8400000000001,
      "Time_End": 1214.0,
      "Text": " if we extract this token and we use it in a custom agent outside of the client environment,"
    },
    {
      "Time_Start": 1214.0,
      "Time_End": 1216.88,
      "Text": " what I've observed in the past is that you get a load balancing effect."
    },
    {
      "Time_Start": 1216.88,
      "Time_End": 1221.52,
      "Text": " So a genuine login attempt to Okta will first go to the genuine agent."
    },
    {
      "Time_Start": 1221.52,
      "Time_End": 1224.4,
      "Text": " The second attempt will go to our agent and so forth."
    },
    {
      "Time_Start": 1224.4,
      "Time_End": 1225.92,
      "Text": " It will just rotate between the two of them."
    },
    {
      "Time_Start": 1226.72,
      "Time_End": 1228.3200000000002,
      "Text": " Again, that's not by design."
    },
    {
      "Time_Start": 1228.3200000000002,
      "Time_End": 1229.6000000000001,
      "Text": " You know, that's an Okta decision."
    },
    {
      "Time_Start": 1229.6000000000001,
      "Time_End": 1230.72,
      "Text": " They can change that tomorrow."
    },
    {
      "Time_Start": 1230.72,
      "Time_End": 1232.96,
      "Text": " But that's essentially how we've observed at the moment."
    },
    {
      "Time_Start": 1234.72,
      "Time_End": 1236.96,
      "Text": " In terms of decrypting those credentials, so yeah,"
    },
    {
      "Time_Start": 1236.96,
      "Time_End": 1240.8000000000002,
      "Text": " there's a DPAPI unprotected string call that can be used."
    },
    {
      "Time_Start": 1240.8000000000002,
      "Time_End": 1245.1200000000001,
      "Text": " Again, this is all in the original blog post that I published a couple of months ago."
    },
    {
      "Time_Start": 1245.1200000000001,
      "Time_End": 1248.72,
      "Text": " This static optional entropy that's used to be able to pull out those keys."
    },
    {
      "Time_Start": 1249.6000000000001,
      "Time_End": 1251.44,
      "Text": " And yeah, it's essentially when you decrypt it,"
    },
    {
      "Time_Start": 1251.44,
      "Time_End": 1253.68,
      "Text": " you get a plain text API token that we can use."
    },
    {
      "Time_Start": 1254.4,
      "Time_End": 1260.0800000000002,
      "Text": " And on the bottom right, we can see the actual script that I created,"
    },
    {
      "Time_Start": 1260.0800000000002,
      "Time_End": 1263.92,
      "Text": " which by reverse engineering how the authentication works between"
    },
    {
      "Time_Start": 1263.92,
      "Time_End": 1269.04,
      "Text": " the Okta sync agent and the Okta cloud-based identity provider itself."
    },
    {
      "Time_Start": 1270.0800000000002,
      "Time_End": 1272.48,
      "Text": " What we can find is that actually we can use this API token,"
    },
    {
      "Time_Start": 1272.48,
      "Time_End": 1275.44,
      "Text": " then just to connect up to Okta outside of the environment"
    },
    {
      "Time_Start": 1275.44,
      "Time_End": 1278.88,
      "Text": " and actually just use that to retrieve plain text credentials as they're kind of provided."
    },
    {
      "Time_Start": 1280.0800000000002,
      "Time_End": 1282.16,
      "Text": " This tool itself is already published."
    },
    {
      "Time_Start": 1282.16,
      "Time_End": 1286.0800000000002,
      "Text": " So it's already on GitHub as part of the Okta PostX toolkit,"
    },
    {
      "Time_Start": 1287.0400000000002,
      "Time_End": 1289.44,
      "Text": " blog post and content that I published previously."
    },
    {
      "Time_Start": 1291.1200000000001,
      "Time_End": 1294.0800000000002,
      "Text": " What I didn't want to do is kind of stand here and just talk about something"
    },
    {
      "Time_Start": 1294.0800000000002,
      "Time_End": 1297.3600000000001,
      "Text": " that I've kind of already published in the past."
    },
    {
      "Time_Start": 1298.48,
      "Time_End": 1302.48,
      "Text": " It gets a little bit boring for me to kind of just go over previous content."
    },
    {
      "Time_Start": 1302.48,
      "Time_End": 1304.88,
      "Text": " So I wanted to look at whether we could actually extend this out"
    },
    {
      "Time_Start": 1304.88,
      "Time_End": 1307.68,
      "Text": " and look at other providers and whether we could also"
    },
    {
      "Time_Start": 1307.68,
      "Time_End": 1309.68,
      "Text": " emulate what that communication looks like."
    },
    {
      "Time_Start": 1310.5600000000002,
      "Time_End": 1313.04,
      "Text": " So of course, when I started looking at Entra,"
    },
    {
      "Time_Start": 1313.04,
      "Time_End": 1316.24,
      "Text": " so Dr. Azure AD has already beat me to it by years."
    },
    {
      "Time_Start": 1316.24,
      "Time_End": 1320.72,
      "Text": " Like he's basically on top of everything in terms of Entra ID or Azure AD."
    },
    {
      "Time_Start": 1321.44,
      "Time_End": 1325.04,
      "Text": " So yeah, shout out to Dr. Azure AD who's already done this research."
    },
    {
      "Time_Start": 1325.76,
      "Time_End": 1329.44,
      "Text": " What he's managed to do is to create an augmentation"
    },
    {
      "Time_Start": 1329.44,
      "Time_End": 1331.8400000000001,
      "Text": " of the Azure AD Connect agent itself."
    },
    {
      "Time_Start": 1331.8400000000001,
      "Time_End": 1335.28,
      "Text": " So he injects his own code into there to be able to exactly do"
    },
    {
      "Time_Start": 1335.28,
      "Time_End": 1337.1200000000001,
      "Text": " what I was doing in the Okta case,"
    },
    {
      "Time_Start": 1337.1200000000001,
      "Time_End": 1339.2800000000002,
      "Text": " which is extract out plain text credentials"
    },
    {
      "Time_Start": 1339.2800000000002,
      "Time_End": 1340.8000000000002,
      "Text": " from outside of the client environment."
    },
    {
      "Time_Start": 1341.6000000000001,
      "Time_End": 1344.24,
      "Text": " All this technology is built on top of App Proxy,"
    },
    {
      "Time_Start": 1344.24,
      "Time_End": 1345.92,
      "Text": " which is something that I've looked at in the past."
    },
    {
      "Time_Start": 1345.92,
      "Time_End": 1348.64,
      "Text": " So if you want to understand the technical details"
    },
    {
      "Time_Start": 1348.64,
      "Time_End": 1350.4,
      "Text": " as to how this communication actually happens,"
    },
    {
      "Time_Start": 1350.96,
      "Time_End": 1352.16,
      "Text": " there is a blog post available,"
    },
    {
      "Time_Start": 1353.0400000000002,
      "Time_End": 1355.68,
      "Text": " which will show the actual underlying protocol itself."
    },
    {
      "Time_Start": 1356.3200000000002,
      "Time_End": 1357.92,
      "Text": " But yeah, I didn't want to dig into this too much"
    },
    {
      "Time_Start": 1357.92,
      "Time_End": 1360.0800000000002,
      "Text": " because the work has already kind of been done."
    },
    {
      "Time_Start": 1360.0800000000002,
      "Time_End": 1362.24,
      "Text": " It's all readily available there and ready to go."
    },
    {
      "Time_Start": 1364.4,
      "Time_End": 1366.0800000000002,
      "Text": " In the case of Ping,"
    },
    {
      "Time_Start": 1366.08,
      "Time_End": 1368.1599999999999,
      "Text": " so Ping is something that I didn't notice too much"
    },
    {
      "Time_Start": 1369.52,
      "Time_End": 1371.1999999999998,
      "Text": " kind of published around how to do this."
    },
    {
      "Time_Start": 1371.1999999999998,
      "Time_End": 1373.04,
      "Text": " So that's something that I wanted to take a look at."
    },
    {
      "Time_Start": 1374.3999999999999,
      "Time_End": 1378.96,
      "Text": " So Ping itself, when you create what's called a gateway in Ping,"
    },
    {
      "Time_Start": 1379.9199999999998,
      "Time_End": 1381.6799999999998,
      "Text": " essentially does exactly what we've just shown,"
    },
    {
      "Time_Start": 1381.6799999999998,
      "Time_End": 1384.32,
      "Text": " which will verify credentials that are entered"
    },
    {
      "Time_Start": 1384.32,
      "Time_End": 1386.08,
      "Text": " against, say, Active Directory."
    },
    {
      "Time_Start": 1386.8,
      "Time_End": 1388.72,
      "Text": " They do this in a much more modern way."
    },
    {
      "Time_Start": 1389.4399999999998,
      "Time_End": 1391.4399999999998,
      "Text": " So they'll have a Docker container that runs."
    },
    {
      "Time_Start": 1391.4399999999998,
      "Time_End": 1393.6799999999998,
      "Text": " There's an LDAP client essentially that they've built"
    },
    {
      "Time_Start": 1393.68,
      "Time_End": 1397.28,
      "Text": " that will do the authentication against Active Directory."
    },
    {
      "Time_Start": 1397.28,
      "Time_End": 1399.04,
      "Text": " And as part of that authentication,"
    },
    {
      "Time_Start": 1399.04,
      "Time_End": 1401.2,
      "Text": " it will check essentially whether the credentials are valid."
    },
    {
      "Time_Start": 1402.4,
      "Time_End": 1404.24,
      "Text": " In order to actually emulate"
    },
    {
      "Time_Start": 1404.24,
      "Time_End": 1405.3600000000001,
      "Text": " kind of the way that they're doing this"
    },
    {
      "Time_Start": 1405.3600000000001,
      "Time_End": 1406.8,
      "Text": " and extract out API keys,"
    },
    {
      "Time_Start": 1407.76,
      "Time_End": 1409.2,
      "Text": " there's an environmental variable"
    },
    {
      "Time_Start": 1409.2,
      "Time_End": 1410.96,
      "Text": " that lives in the Docker container,"
    },
    {
      "Time_Start": 1410.96,
      "Time_End": 1413.92,
      "Text": " which is called gateway credential, quite helpfully,"
    },
    {
      "Time_Start": 1414.64,
      "Time_End": 1417.1200000000001,
      "Text": " which we can extract out and kind of use"
    },
    {
      "Time_Start": 1417.1200000000001,
      "Time_End": 1419.44,
      "Text": " as part of our agent that we've managed to reconstruct."
    },
    {
      "Time_Start": 1420.0,
      "Time_End": 1421.2,
      "Text": " Just to do the exact same thing"
    },
    {
      "Time_Start": 1421.2,
      "Time_End": 1423.1200000000001,
      "Text": " that I've just shown there in the Otter scenario,"
    },
    {
      "Time_Start": 1424.5600000000002,
      "Time_End": 1426.88,
      "Text": " and so in terms of the way that this actually works,"
    },
    {
      "Time_Start": 1428.0800000000002,
      "Time_End": 1429.92,
      "Text": " when we use credentials"
    },
    {
      "Time_Start": 1429.92,
      "Time_End": 1431.8400000000001,
      "Text": " that are already existing for another agent,"
    },
    {
      "Time_Start": 1431.8400000000001,
      "Time_End": 1433.92,
      "Text": " again, we get the round robin kind of effect."
    },
    {
      "Time_Start": 1433.92,
      "Time_End": 1435.2,
      "Text": " So you see here,"
    },
    {
      "Time_Start": 1435.2,
      "Time_End": 1437.1200000000001,
      "Text": " there's two agents that are listening for Ping."
    },
    {
      "Time_Start": 1437.8400000000001,
      "Time_End": 1439.3600000000001,
      "Text": " I believe the top one is valid."
    },
    {
      "Time_Start": 1439.3600000000001,
      "Time_End": 1440.5600000000002,
      "Text": " So that's the valid agent."
    },
    {
      "Time_Start": 1440.5600000000002,
      "Time_End": 1443.3600000000001,
      "Text": " The bottom one is my custom agent that I've created."
    },
    {
      "Time_Start": 1443.3600000000001,
      "Time_End": 1445.3600000000001,
      "Text": " And again, the code is going to be released for this as well."
    },
    {
      "Time_Start": 1446.24,
      "Time_End": 1447.92,
      "Text": " So it's called Cloud9 Ping Edition."
    },
    {
      "Time_Start": 1447.92,
      "Time_End": 1450.0800000000002,
      "Text": " Essentially, this does exactly the same thing as Otter"
    },
    {
      "Time_Start": 1450.0800000000002,
      "Time_End": 1452.3200000000002,
      "Text": " where you give it an existing API token"
    },
    {
      "Time_Start": 1452.32,
      "Time_End": 1454.32,
      "Text": " and it will go and do, you know,"
    },
    {
      "Time_Start": 1454.32,
      "Time_End": 1455.6,
      "Text": " kind of the dance that it needs to do"
    },
    {
      "Time_Start": 1455.6,
      "Time_End": 1457.84,
      "Text": " to be able to say to Ping,"
    },
    {
      "Time_Start": 1457.84,
      "Time_End": 1460.1599999999999,
      "Text": " deliver me the credentials kind of to do the checking."
    },
    {
      "Time_Start": 1461.4399999999998,
      "Time_End": 1463.12,
      "Text": " And yeah, it manages to allow us"
    },
    {
      "Time_Start": 1463.12,
      "Time_End": 1464.3999999999999,
      "Text": " outside of the client environment"
    },
    {
      "Time_Start": 1464.3999999999999,
      "Time_End": 1466.8,
      "Text": " to be able to access essentially credentials."
    },
    {
      "Time_Start": 1470.32,
      "Time_End": 1472.6399999999999,
      "Text": " The last one that we're going to talk about is OneLogin."
    },
    {
      "Time_Start": 1472.6399999999999,
      "Time_End": 1476.08,
      "Text": " So OneLogin is a little bit different."
    },
    {
      "Time_Start": 1476.08,
      "Time_End": 1477.76,
      "Text": " So in terms of the way that we go on"
    },
    {
      "Time_Start": 1477.76,
      "Time_End": 1480.1599999999999,
      "Text": " and kind of spoof the agent outside of the environment,"
    },
    {
      "Time_Start": 1480.88,
      "Time_End": 1483.44,
      "Text": " again, we can do this absolutely fine."
    },
    {
      "Time_Start": 1483.44,
      "Time_End": 1485.2,
      "Text": " The API token that we need to extract"
    },
    {
      "Time_Start": 1485.2,
      "Time_End": 1486.72,
      "Text": " is in the registry in plain text."
    },
    {
      "Time_Start": 1486.72,
      "Time_End": 1488.4,
      "Text": " So we don't need to do any kind of decryption"
    },
    {
      "Time_Start": 1488.4,
      "Time_End": 1491.2,
      "Text": " if we're able to kind of compromise a server"
    },
    {
      "Time_Start": 1491.2,
      "Time_End": 1492.5600000000002,
      "Text": " which is running the agent."
    },
    {
      "Time_Start": 1492.5600000000002,
      "Time_End": 1495.1200000000001,
      "Text": " And we want to kind of take that outside of the environment."
    },
    {
      "Time_Start": 1495.8400000000001,
      "Time_End": 1497.76,
      "Text": " One thing to point out is during testing,"
    },
    {
      "Time_Start": 1497.76,
      "Time_End": 1499.6000000000001,
      "Text": " if we use the API key,"
    },
    {
      "Time_Start": 1499.6000000000001,
      "Time_End": 1502.16,
      "Text": " which is valid for another existing agent,"
    },
    {
      "Time_Start": 1502.16,
      "Time_End": 1504.0,
      "Text": " you actually get a denial of service scenario"
    },
    {
      "Time_Start": 1504.0,
      "Time_End": 1506.3200000000002,
      "Text": " where when we suddenly start to use the API key"
    },
    {
      "Time_Start": 1506.32,
      "Time_End": 1510.08,
      "Text": " that's being used by another kind of legitimate service,"
    },
    {
      "Time_Start": 1511.52,
      "Time_End": 1514.6399999999999,
      "Text": " the legitimate service will still continue to run,"
    },
    {
      "Time_Start": 1514.6399999999999,
      "Time_End": 1515.76,
      "Text": " but it will just cease to function."
    },
    {
      "Time_Start": 1515.76,
      "Time_End": 1518.0,
      "Text": " It won't answer any kind of authentication requests."
    },
    {
      "Time_Start": 1518.96,
      "Time_End": 1521.12,
      "Text": " We will receive all of the authentication requests,"
    },
    {
      "Time_Start": 1521.12,
      "Time_End": 1524.1599999999999,
      "Text": " which may be valid for your particular use case."
    },
    {
      "Time_Start": 1525.6,
      "Time_End": 1528.3999999999999,
      "Text": " But ultimately, when you stop the application"
    },
    {
      "Time_Start": 1528.3999999999999,
      "Time_End": 1530.96,
      "Text": " which is receiving those authentication requests,"
    },
    {
      "Time_Start": 1530.96,
      "Time_End": 1532.48,
      "Text": " the service will still stay active,"
    },
    {
      "Time_Start": 1532.48,
      "Time_End": 1533.9199999999998,
      "Text": " but it won't do anything."
    },
    {
      "Time_Start": 1533.92,
      "Time_End": 1536.72,
      "Text": " It will just sit there and essentially idle."
    },
    {
      "Time_Start": 1537.8400000000001,
      "Time_End": 1539.28,
      "Text": " So in that case, somebody will need to go in"
    },
    {
      "Time_Start": 1539.28,
      "Time_End": 1540.96,
      "Text": " and manually reset the service itself."
    },
    {
      "Time_Start": 1540.96,
      "Time_End": 1543.2,
      "Text": " So again, this is all about just testing these scenarios."
    },
    {
      "Time_Start": 1543.2,
      "Time_End": 1545.04,
      "Text": " This is all undefined behavior, essentially,"
    },
    {
      "Time_Start": 1545.6000000000001,
      "Time_End": 1546.5600000000002,
      "Text": " that you'll need to verify"
    },
    {
      "Time_Start": 1546.5600000000002,
      "Time_End": 1548.5600000000002,
      "Text": " before you actually run these on client environments"
    },
    {
      "Time_Start": 1548.5600000000002,
      "Time_End": 1550.3200000000002,
      "Text": " if that's what you've been asked to do."
    },
    {
      "Time_Start": 1550.3200000000002,
      "Time_End": 1551.3600000000001,
      "Text": " But yeah, just to call that out,"
    },
    {
      "Time_Start": 1551.3600000000001,
      "Time_End": 1553.1200000000001,
      "Text": " we did observe a denial of service"
    },
    {
      "Time_Start": 1553.1200000000001,
      "Time_End": 1556.16,
      "Text": " if you use the same API token outside of the environment"
    },
    {
      "Time_Start": 1556.16,
      "Time_End": 1558.3200000000002,
      "Text": " whilst an existing agent is actually running."
    },
    {
      "Time_Start": 1559.3600000000001,
      "Time_End": 1560.8000000000002,
      "Text": " So the better way actually to do this"
    },
    {
      "Time_Start": 1560.8000000000002,
      "Time_End": 1563.04,
      "Text": " is to pivot a little bit and say,"
    },
    {
      "Time_Start": 1563.04,
      "Time_End": 1564.3999999999999,
      "Text": " if you've managed to compromise,"
    },
    {
      "Time_Start": 1564.3999999999999,
      "Time_End": 1567.52,
      "Text": " say, one login as a high-privileged user,"
    },
    {
      "Time_Start": 1568.32,
      "Time_End": 1569.84,
      "Text": " actually, sometimes it makes more sense"
    },
    {
      "Time_Start": 1569.84,
      "Time_End": 1571.44,
      "Text": " just to generate another API key"
    },
    {
      "Time_Start": 1571.44,
      "Time_End": 1574.96,
      "Text": " and use that as a method to actually be able to test this."
    },
    {
      "Time_Start": 1575.76,
      "Time_End": 1577.44,
      "Text": " So in this case, we've just created"
    },
    {
      "Time_Start": 1577.44,
      "Time_End": 1578.96,
      "Text": " another API key in one login."
    },
    {
      "Time_Start": 1579.76,
      "Time_End": 1581.44,
      "Text": " We provide that into the tool itself,"
    },
    {
      "Time_Start": 1581.44,
      "Time_End": 1584.3999999999999,
      "Text": " which will perform the authentication check."
    },
    {
      "Time_Start": 1585.52,
      "Time_End": 1587.76,
      "Text": " And we've got a quick demo of how that looks here."
    },
    {
      "Time_Start": 1587.76,
      "Time_End": 1591.76,
      "Text": " So if we take one login as the example,"
    },
    {
      "Time_Start": 1591.84,
      "Time_End": 1593.12,
      "Text": " so there's a user coming here"
    },
    {
      "Time_Start": 1593.84,
      "Time_End": 1595.44,
      "Text": " and actually entering in the credentials."
    },
    {
      "Time_Start": 1596.16,
      "Time_End": 1598.0,
      "Text": " And what we've got on the right-hand side"
    },
    {
      "Time_Start": 1598.0,
      "Time_End": 1599.2,
      "Text": " is, again, Cloud9,"
    },
    {
      "Time_Start": 1599.2,
      "Time_End": 1601.12,
      "Text": " but we've called this the one login edition."
    },
    {
      "Time_Start": 1601.12,
      "Time_End": 1603.6,
      "Text": " So this is an emulation of that communication protocol"
    },
    {
      "Time_Start": 1603.6,
      "Time_End": 1606.8,
      "Text": " that happens between the service and one login."
    },
    {
      "Time_Start": 1606.8,
      "Time_End": 1608.4,
      "Text": " But again, what it allows us to do is"
    },
    {
      "Time_Start": 1608.96,
      "Time_End": 1612.56,
      "Text": " it allows us to connect up using, say, the API token,"
    },
    {
      "Time_Start": 1612.56,
      "Time_End": 1613.92,
      "Text": " and again, intercept credentials"
    },
    {
      "Time_Start": 1613.92,
      "Time_End": 1617.76,
      "Text": " kind of as they're provided in clear text, hopefully."
    },
    {
      "Time_Start": 1617.76,
      "Time_End": 1618.48,
      "Text": " I don't know what I'm saying."
    },
    {
      "Time_Start": 1618.48,
      "Time_End": 1619.68,
      "Text": " Hopefully, I've recorded the demo,"
    },
    {
      "Time_Start": 1619.68,
      "Time_End": 1620.8,
      "Text": " so I know exactly what it's going to do."
    },
    {
      "Time_Start": 1621.92,
      "Time_End": 1624.0,
      "Text": " But yeah, you get to see the plain text credentials."
    },
    {
      "Time_Start": 1624.0,
      "Time_End": 1625.52,
      "Text": " And this is done outside of the environment."
    },
    {
      "Time_Start": 1625.52,
      "Time_End": 1626.4,
      "Text": " So just to reiterate,"
    },
    {
      "Time_Start": 1626.4,
      "Time_End": 1628.48,
      "Text": " this is where we've taken an application"
    },
    {
      "Time_Start": 1628.48,
      "Time_End": 1629.92,
      "Text": " that we've created,"
    },
    {
      "Time_Start": 1629.92,
      "Time_End": 1631.6,
      "Text": " and we're taking API tokens,"
    },
    {
      "Time_Start": 1631.6,
      "Time_End": 1633.84,
      "Text": " and then outside of the client environment,"
    },
    {
      "Time_Start": 1633.84,
      "Time_End": 1634.8799999999999,
      "Text": " we're connecting this up."
    },
    {
      "Time_Start": 1635.44,
      "Time_End": 1637.36,
      "Text": " And then as legitimate users go through"
    },
    {
      "Time_Start": 1637.36,
      "Time_End": 1639.6,
      "Text": " and start to enter in credentials into the portal,"
    },
    {
      "Time_Start": 1639.6,
      "Time_End": 1640.64,
      "Text": " we're still receiving them"
    },
    {
      "Time_Start": 1640.64,
      "Time_End": 1642.32,
      "Text": " from outside of the environment."
    },
    {
      "Time_Start": 1642.32,
      "Time_End": 1644.48,
      "Text": " So, you know, a nice little persistence technique,"
    },
    {
      "Time_Start": 1644.48,
      "Time_End": 1646.48,
      "Text": " but also a nice technique to be able to"
    },
    {
      "Time_Start": 1646.48,
      "Time_End": 1647.52,
      "Text": " kind of target people"
    },
    {
      "Time_Start": 1647.52,
      "Time_End": 1649.36,
      "Text": " and leak out their credentials as well."
    },
    {
      "Time_Start": 1652.4,
      "Time_End": 1654.08,
      "Text": " Okay, so carrying on with the attacks."
    },
    {
      "Time_Start": 1654.72,
      "Time_End": 1657.76,
      "Text": " Kerberos, this is something which"
    },
    {
      "Time_Start": 1657.76,
      "Time_End": 1659.92,
      "Text": " I've received quite a lot of questions about"
    },
    {
      "Time_Start": 1659.92,
      "Time_End": 1661.28,
      "Text": " after I published the blog post,"
    },
    {
      "Time_Start": 1661.28,
      "Time_End": 1663.52,
      "Text": " because Kerberos is not the nicest thing"
    },
    {
      "Time_Start": 1663.52,
      "Time_End": 1664.96,
      "Text": " to work with at the best of times anyway."
    },
    {
      "Time_Start": 1664.96,
      "Time_End": 1666.16,
      "Text": " So trying to get this to work"
    },
    {
      "Time_Start": 1666.16,
      "Time_End": 1668.96,
      "Text": " with kind of attack scenarios"
    },
    {
      "Time_Start": 1668.96,
      "Time_End": 1670.56,
      "Text": " on identity providers"
    },
    {
      "Time_Start": 1670.56,
      "Time_End": 1672.08,
      "Text": " can sometimes be a little bit challenging."
    },
    {
      "Time_Start": 1674.0,
      "Time_End": 1675.84,
      "Text": " So typically we'll see deployed like this."
    },
    {
      "Time_Start": 1676.56,
      "Time_End": 1679.28,
      "Text": " We'll see, you know, kind of a workstation."
    },
    {
      "Time_Start": 1679.28,
      "Time_End": 1680.56,
      "Text": " And typically what it will do"
    },
    {
      "Time_Start": 1680.56,
      "Time_End": 1682.72,
      "Text": " is it will connect to, say, Okta."
    },
    {
      "Time_Start": 1682.72,
      "Time_End": 1686.1599999999999,
      "Text": " And Okta will send down a HTTP kind of header,"
    },
    {
      "Time_Start": 1686.1599999999999,
      "Time_End": 1687.76,
      "Text": " which will say that we need authentication."
    },
    {
      "Time_Start": 1688.56,
      "Time_End": 1690.32,
      "Text": " The user will then go off to Active Directory"
    },
    {
      "Time_Start": 1690.32,
      "Time_End": 1692.96,
      "Text": " and request a TGS for, say, Okta."
    },
    {
      "Time_Start": 1692.96,
      "Time_End": 1695.04,
      "Text": " And this ticket will then be presented to Okta."
    },
    {
      "Time_Start": 1696.0,
      "Time_End": 1697.6,
      "Text": " And hopefully if everything lines up,"
    },
    {
      "Time_Start": 1697.6,
      "Time_End": 1699.36,
      "Text": " they will gain access to Okta."
    },
    {
      "Time_Start": 1699.36,
      "Time_End": 1700.8,
      "Text": " So this is, again, a common scenario"
    },
    {
      "Time_Start": 1700.8,
      "Time_End": 1702.56,
      "Text": " that we see for organizations"
    },
    {
      "Time_Start": 1702.56,
      "Time_End": 1705.44,
      "Text": " that have been quite heavily AD focused"
    },
    {
      "Time_Start": 1705.44,
      "Time_End": 1706.3999999999999,
      "Text": " and they're transitioning"
    },
    {
      "Time_Start": 1706.3999999999999,
      "Time_End": 1708.72,
      "Text": " to use single sign-on services."
    },
    {
      "Time_Start": 1708.72,
      "Time_End": 1709.6,
      "Text": " And they want to connect that"
    },
    {
      "Time_Start": 1709.6000000000001,
      "Time_End": 1710.88,
      "Text": " into Active Directory."
    },
    {
      "Time_Start": 1713.2,
      "Time_End": 1715.68,
      "Text": " So how do we find whether kind of our target"
    },
    {
      "Time_Start": 1715.68,
      "Time_End": 1718.4,
      "Text": " is using this particular kind of technology?"
    },
    {
      "Time_Start": 1718.4,
      "Time_End": 1720.72,
      "Text": " Well, the obvious answer is you look for SPN."
    },
    {
      "Time_Start": 1720.72,
      "Time_End": 1723.1200000000001,
      "Text": " So in Kerberos, you'll have an SPN."
    },
    {
      "Time_Start": 1723.68,
      "Time_End": 1725.5200000000002,
      "Text": " Here is some of kind of the common things"
    },
    {
      "Time_Start": 1725.5200000000002,
      "Time_End": 1727.1200000000001,
      "Text": " that you will see in Active Directory"
    },
    {
      "Time_Start": 1727.1200000000001,
      "Time_End": 1728.4800000000002,
      "Text": " if the client is using"
    },
    {
      "Time_Start": 1728.4800000000002,
      "Time_End": 1729.8400000000001,
      "Text": " these particular technologies"
    },
    {
      "Time_Start": 1729.8400000000001,
      "Time_End": 1730.88,
      "Text": " to be able to authenticate"
    },
    {
      "Time_Start": 1730.88,
      "Time_End": 1733.6000000000001,
      "Text": " into their single sign-on provider."
    },
    {
      "Time_Start": 1734.4,
      "Time_End": 1735.7600000000002,
      "Text": " This is not a comprehensive list."
    },
    {
      "Time_Start": 1735.7600000000002,
      "Time_End": 1738.16,
      "Text": " There are a couple of different ones as well"
    },
    {
      "Time_Start": 1738.16,
      "Time_End": 1739.2,
      "Text": " that we've kind of observed."
    },
    {
      "Time_Start": 1739.2,
      "Time_End": 1741.0400000000002,
      "Text": " But you won't kind of go wrong"
    },
    {
      "Time_Start": 1741.0400000000002,
      "Time_End": 1742.8000000000002,
      "Text": " if you stick with this list"
    },
    {
      "Time_Start": 1742.8000000000002,
      "Time_End": 1744.72,
      "Text": " and search through Active Directory"
    },
    {
      "Time_Start": 1744.72,
      "Time_End": 1746.96,
      "Text": " and you know that your target organization"
    },
    {
      "Time_Start": 1746.96,
      "Time_End": 1748.8000000000002,
      "Text": " is using Okta and searching for,"
    },
    {
      "Time_Start": 1748.8000000000002,
      "Time_End": 1750.88,
      "Text": " you know, kerberos.okta.com in an SPN."
    },
    {
      "Time_Start": 1751.6000000000001,
      "Time_End": 1753.28,
      "Text": " If that comes back with a service account,"
    },
    {
      "Time_Start": 1753.28,
      "Time_End": 1754.96,
      "Text": " then you know that their likelihood"
    },
    {
      "Time_Start": 1754.96,
      "Time_End": 1756.0800000000002,
      "Text": " is that they're going to be"
    },
    {
      "Time_Start": 1756.0800000000002,
      "Time_End": 1758.4,
      "Text": " connecting into Okta using, say,"
    },
    {
      "Time_Start": 1758.4,
      "Time_End": 1760.3200000000002,
      "Text": " some kind of like Kerberos TGS"
    },
    {
      "Time_Start": 1760.3200000000002,
      "Time_End": 1761.28,
      "Text": " kind of authentication."
    },
    {
      "Time_Start": 1764.0800000000002,
      "Time_End": 1765.6000000000001,
      "Text": " Okay, so let's look at an attack"
    },
    {
      "Time_Start": 1765.6000000000001,
      "Time_End": 1768.2400000000002,
      "Text": " that we might be able to leverage this on."
    },
    {
      "Time_Start": 1768.2400000000002,
      "Time_End": 1769.7600000000002,
      "Text": " And again, attack is using air quotes"
    },
    {
      "Time_Start": 1769.7600000000002,
      "Time_End": 1771.68,
      "Text": " because this is all intended functionality, right?"
    },
    {
      "Time_Start": 1771.68,
      "Time_End": 1773.6000000000001,
      "Text": " So quite typically, we'll go through"
    },
    {
      "Time_Start": 1773.6000000000001,
      "Time_End": 1775.3600000000001,
      "Text": " and we'll compromise an endpoint."
    },
    {
      "Time_Start": 1775.3600000000001,
      "Time_End": 1777.2800000000002,
      "Text": " Let's say it's a phishing scenario."
    },
    {
      "Time_Start": 1777.2800000000002,
      "Time_End": 1778.96,
      "Text": " We've compromised the endpoint."
    },
    {
      "Time_Start": 1778.96,
      "Time_End": 1780.0800000000002,
      "Text": " And then what we want to do is,"
    },
    {
      "Time_Start": 1780.0800000000002,
      "Time_End": 1781.44,
      "Text": " as the existing user,"
    },
    {
      "Time_Start": 1781.44,
      "Time_End": 1782.88,
      "Text": " we want to then go on and access"
    },
    {
      "Time_Start": 1782.88,
      "Time_End": 1784.0000000000002,
      "Text": " the single sign-on provider"
    },
    {
      "Time_Start": 1784.0000000000002,
      "Time_End": 1785.1200000000001,
      "Text": " or the identity provider"
    },
    {
      "Time_Start": 1785.7600000000002,
      "Time_End": 1786.96,
      "Text": " as that particular user."
    },
    {
      "Time_Start": 1788.5600000000002,
      "Time_End": 1789.8400000000001,
      "Text": " Typically, we're authenticating"
    },
    {
      "Time_Start": 1789.8400000000001,
      "Time_End": 1791.3600000000001,
      "Text": " in the context of the user itself."
    },
    {
      "Time_Start": 1791.3600000000001,
      "Time_End": 1793.3600000000001,
      "Text": " So the user may have executed our implants."
    },
    {
      "Time_Start": 1793.3600000000001,
      "Time_End": 1794.96,
      "Text": " We're running in the context of the user."
    },
    {
      "Time_Start": 1795.68,
      "Time_End": 1796.72,
      "Text": " And quite often, what we can do"
    },
    {
      "Time_Start": 1796.72,
      "Time_End": 1798.16,
      "Text": " is we can just request a TGS"
    },
    {
      "Time_Start": 1798.16,
      "Time_End": 1800.72,
      "Text": " as that user from Active Directory"
    },
    {
      "Time_Start": 1800.72,
      "Time_End": 1801.92,
      "Text": " and then forward that through"
    },
    {
      "Time_Start": 1801.92,
      "Time_End": 1803.3600000000001,
      "Text": " to the identity provider"
    },
    {
      "Time_Start": 1803.3600000000001,
      "Time_End": 1805.1200000000001,
      "Text": " and gain access as that particular user."
    },
    {
      "Time_Start": 1805.92,
      "Time_End": 1807.3600000000001,
      "Text": " So we've used this in multiple"
    },
    {
      "Time_Start": 1807.3600000000001,
      "Time_End": 1808.5600000000002,
      "Text": " different engagements in the past,"
    },
    {
      "Time_Start": 1808.5600000000002,
      "Time_End": 1809.5200000000002,
      "Text": " and this works very well"
    },
    {
      "Time_Start": 1809.5200000000002,
      "Time_End": 1810.8000000000002,
      "Text": " as that initial foothold"
    },
    {
      "Time_Start": 1810.8000000000002,
      "Time_End": 1812.2400000000002,
      "Text": " into that cloud-based environment"
    },
    {
      "Time_Start": 1812.2400000000002,
      "Time_End": 1813.6000000000001,
      "Text": " to be able to access it"
    },
    {
      "Time_Start": 1813.6000000000001,
      "Time_End": 1814.8000000000002,
      "Text": " as kind of the user itself."
    },
    {
      "Time_Start": 1815.68,
      "Time_End": 1817.3600000000001,
      "Text": " So a couple of different ways here"
    },
    {
      "Time_Start": 1817.3600000000001,
      "Time_End": 1819.6000000000001,
      "Text": " that we can kind of grab the TGS."
    },
    {
      "Time_Start": 1819.6000000000001,
      "Time_End": 1823.44,
      "Text": " So in the case of an existing user session,"
    },
    {
      "Time_Start": 1823.44,
      "Time_End": 1824.72,
      "Text": " obviously, you're already authenticated"
    },
    {
      "Time_Start": 1824.72,
      "Time_End": 1826.08,
      "Text": " as the user, which means that"
    },
    {
      "Time_Start": 1826.08,
      "Time_End": 1827.2,
      "Text": " if you can pivot on the back of that,"
    },
    {
      "Time_Start": 1827.2,
      "Time_End": 1828.0,
      "Text": " you should be able to talk"
    },
    {
      "Time_Start": 1828.0,
      "Time_End": 1830.0,
      "Text": " to Active Directory as the user itself."
    },
    {
      "Time_Start": 1830.64,
      "Time_End": 1833.2,
      "Text": " The TGT delegation technique"
    },
    {
      "Time_Start": 1833.2,
      "Time_End": 1834.32,
      "Text": " is something that I personally"
    },
    {
      "Time_Start": 1834.32,
      "Time_End": 1835.52,
      "Text": " use quite a lot."
    },
    {
      "Time_Start": 1836.24,
      "Time_End": 1837.44,
      "Text": " So I will compromise, say,"
    },
    {
      "Time_Start": 1837.44,
      "Time_End": 1838.88,
      "Text": " an endpoint using some kind"
    },
    {
      "Time_Start": 1838.88,
      "Time_End": 1839.84,
      "Text": " of like a phishing attack"
    },
    {
      "Time_Start": 1839.84,
      "Time_End": 1841.2,
      "Text": " or whatever it may be."
    },
    {
      "Time_Start": 1841.2,
      "Time_End": 1842.96,
      "Text": " I'll use the TGT delegation technique"
    },
    {
      "Time_Start": 1842.96,
      "Time_End": 1844.88,
      "Text": " to be able to extract out a TGT"
    },
    {
      "Time_Start": 1844.88,
      "Time_End": 1846.64,
      "Text": " for the user, and then actually"
    },
    {
      "Time_Start": 1846.64,
      "Time_End": 1848.08,
      "Text": " what I'll do is I'll use proxy"
    },
    {
      "Time_Start": 1848.08,
      "Time_End": 1850.16,
      "Text": " and then use a SOCKS proxy on the agent"
    },
    {
      "Time_Start": 1850.16,
      "Time_End": 1852.48,
      "Text": " to then use that to request a TGS."
    },
    {
      "Time_Start": 1853.04,
      "Time_End": 1855.44,
      "Text": " It's a way that I've kind of found."
    },
    {
      "Time_Start": 1855.44,
      "Time_End": 1856.72,
      "Text": " It's kind of the sweet spot for me"
    },
    {
      "Time_Start": 1856.72,
      "Time_End": 1858.96,
      "Text": " in terms of interacting with endpoints"
    },
    {
      "Time_Start": 1858.96,
      "Time_End": 1860.08,
      "Text": " to kind of stay under the radar"
    },
    {
      "Time_Start": 1860.08,
      "Time_End": 1861.04,
      "Text": " with EDRs."
    },
    {
      "Time_Start": 1861.04,
      "Time_End": 1862.16,
      "Text": " But yeah, there's multiple ways"
    },
    {
      "Time_Start": 1862.16,
      "Time_End": 1863.84,
      "Text": " to obviously achieve a similar technique."
    },
    {
      "Time_Start": 1865.6,
      "Time_End": 1867.2,
      "Text": " And of course, yeah, obviously to call out"
    },
    {
      "Time_Start": 1867.2,
      "Time_End": 1868.56,
      "Text": " if you've got a known username"
    },
    {
      "Time_Start": 1868.56,
      "Time_End": 1871.44,
      "Text": " or sorry, if you've got a known password"
    },
    {
      "Time_Start": 1871.44,
      "Time_End": 1874.56,
      "Text": " or an NTLM hash or AES key for the user,"
    },
    {
      "Time_Start": 1874.56,
      "Time_End": 1876.08,
      "Text": " you can also go on to just request"
    },
    {
      "Time_Start": 1876.08,
      "Time_End": 1878.0,
      "Text": " a TGT for the user as well"
    },
    {
      "Time_Start": 1878.0,
      "Time_End": 1879.44,
      "Text": " and subsequently a TGS."
    },
    {
      "Time_Start": 1879.76,
      "Time_End": 1881.04,
      "Text": " So let's have a quick look"
    },
    {
      "Time_Start": 1881.04,
      "Time_End": 1882.16,
      "Text": " at kind of how this works."
    },
    {
      "Time_Start": 1882.16,
      "Time_End": 1884.24,
      "Text": " So in this particular scenario,"
    },
    {
      "Time_Start": 1884.24,
      "Time_End": 1885.76,
      "Text": " what we're going to use is InPacket"
    },
    {
      "Time_Start": 1886.64,
      "Time_End": 1888.4,
      "Text": " and InPacket here, we're going to make"
    },
    {
      "Time_Start": 1888.4,
      "Time_End": 1890.48,
      "Text": " a request for a TGS and the TGS"
    },
    {
      "Time_Start": 1890.48,
      "Time_End": 1891.52,
      "Text": " is going to be for Okta."
    },
    {
      "Time_Start": 1892.64,
      "Time_End": 1893.68,
      "Text": " In this case, we're just entering"
    },
    {
      "Time_Start": 1893.68,
      "Time_End": 1894.48,
      "Text": " a known password."
    },
    {
      "Time_Start": 1894.48,
      "Time_End": 1895.68,
      "Text": " But as I say, if you've got a TGT"
    },
    {
      "Time_Start": 1895.68,
      "Time_End": 1897.76,
      "Text": " for the user, you can kind of go on"
    },
    {
      "Time_Start": 1897.76,
      "Time_End": 1898.96,
      "Text": " and use that to exchange it"
    },
    {
      "Time_Start": 1898.96,
      "Time_End": 1899.92,
      "Text": " for a TGS as well."
    },
    {
      "Time_Start": 1900.88,
      "Time_End": 1902.4,
      "Text": " Once the ticket is created,"
    },
    {
      "Time_Start": 1902.4,
      "Time_End": 1903.28,
      "Text": " what we're going to do is we're going"
    },
    {
      "Time_Start": 1903.28,
      "Time_End": 1904.8,
      "Text": " to pass that over to our attacker machine."
    },
    {
      "Time_Start": 1904.8,
      "Time_End": 1905.92,
      "Text": " So on the right here,"
    },
    {
      "Time_Start": 1905.92,
      "Time_End": 1907.44,
      "Text": " this is me as an attacker,"
    },
    {
      "Time_Start": 1907.44,
      "Time_End": 1908.88,
      "Text": " this is me as an attacker,"
    },
    {
      "Time_Start": 1908.88,
      "Time_End": 1910.48,
      "Text": " you know, outside of kind of"
    },
    {
      "Time_Start": 1910.48,
      "Time_End": 1912.3200000000002,
      "Text": " the environment or proxy in my traffic"
    },
    {
      "Time_Start": 1912.3200000000002,
      "Time_End": 1913.44,
      "Text": " through the client environment."
    },
    {
      "Time_Start": 1914.8,
      "Time_End": 1916.0,
      "Text": " And ultimately, what we're going to do"
    },
    {
      "Time_Start": 1916.0,
      "Time_End": 1917.8400000000001,
      "Text": " is we're going to use Mimikatz's"
    },
    {
      "Time_Start": 1917.8400000000001,
      "Time_End": 1920.0800000000002,
      "Text": " pass the cache technique to be able"
    },
    {
      "Time_Start": 1920.0800000000002,
      "Time_End": 1921.04,
      "Text": " to inject this ticket"
    },
    {
      "Time_Start": 1922.4,
      "Time_End": 1923.6000000000001,
      "Text": " and kind of utilize it"
    },
    {
      "Time_Start": 1923.6000000000001,
      "Time_End": 1925.3600000000001,
      "Text": " to authenticate to Okta."
    },
    {
      "Time_Start": 1925.3600000000001,
      "Time_End": 1926.24,
      "Text": " So as this goes through,"
    },
    {
      "Time_Start": 1926.24,
      "Time_End": 1927.92,
      "Text": " we can see the usual kind of"
    },
    {
      "Time_Start": 1927.92,
      "Time_End": 1929.52,
      "Text": " pass the cache stuff that we've"
    },
    {
      "Time_Start": 1929.52,
      "Time_End": 1931.1200000000001,
      "Text": " kind of used to on assessments."
    },
    {
      "Time_Start": 1932.64,
      "Time_End": 1933.76,
      "Text": " And then ultimately, what we can see"
    },
    {
      "Time_Start": 1933.76,
      "Time_End": 1936.48,
      "Text": " is once that has been injected,"
    },
    {
      "Time_Start": 1936.48,
      "Time_End": 1938.64,
      "Text": " we should be able to access Okta"
    },
    {
      "Time_Start": 1939.44,
      "Time_End": 1940.56,
      "Text": " kind of as the user"
    },
    {
      "Time_Start": 1940.56,
      "Time_End": 1941.76,
      "Text": " that we've got the TGS for."
    },
    {
      "Time_Start": 1944.88,
      "Time_End": 1948.16,
      "Text": " And yeah, it signs us in as the user."
    },
    {
      "Time_Start": 1949.04,
      "Time_End": 1951.76,
      "Text": " One of the reasons that I've seen this fail,"
    },
    {
      "Time_Start": 1952.32,
      "Time_End": 1953.44,
      "Text": " kind of people have contacted me"
    },
    {
      "Time_Start": 1953.44,
      "Time_End": 1954.16,
      "Text": " in the past and said,"
    },
    {
      "Time_Start": 1954.16,
      "Time_End": 1955.1200000000001,
      "Text": " we've seen that you've used this"
    },
    {
      "Time_Start": 1955.1200000000001,
      "Time_End": 1958.08,
      "Text": " as an example in your demos,"
    },
    {
      "Time_Start": 1958.08,
      "Time_End": 1959.28,
      "Text": " but we can't really trigger"
    },
    {
      "Time_Start": 1959.28,
      "Time_End": 1961.44,
      "Text": " the authentication request for Kerberos."
    },
    {
      "Time_Start": 1962.08,
      "Time_End": 1962.96,
      "Text": " Quite often what you'll see"
    },
    {
      "Time_Start": 1962.96,
      "Time_End": 1964.4,
      "Text": " is that organizations will lock"
    },
    {
      "Time_Start": 1964.4,
      "Time_End": 1965.52,
      "Text": " down the Kerberos flow"
    },
    {
      "Time_Start": 1965.52,
      "Time_End": 1967.04,
      "Text": " to their IP range."
    },
    {
      "Time_Start": 1967.68,
      "Time_End": 1968.56,
      "Text": " Obviously, it makes sense,"
    },
    {
      "Time_Start": 1968.56,
      "Time_End": 1969.28,
      "Text": " you know, it's going to be"
    },
    {
      "Time_Start": 1970.08,
      "Time_End": 1971.68,
      "Text": " internal users that are going to use this"
    },
    {
      "Time_Start": 1971.68,
      "Time_End": 1972.8799999999999,
      "Text": " because we're going to have to have"
    },
    {
      "Time_Start": 1972.8799999999999,
      "Time_End": 1974.4,
      "Text": " line of sight to Active Directory."
    },
    {
      "Time_Start": 1975.04,
      "Time_End": 1976.08,
      "Text": " So if you ever find yourself"
    },
    {
      "Time_Start": 1976.08,
      "Time_End": 1977.2,
      "Text": " in a scenario where you can"
    },
    {
      "Time_Start": 1977.2,
      "Time_End": 1978.24,
      "Text": " kind of perform this attack,"
    },
    {
      "Time_Start": 1978.24,
      "Time_End": 1980.0,
      "Text": " but you know that the organization"
    },
    {
      "Time_Start": 1980.0,
      "Time_End": 1981.12,
      "Text": " is using Kerberos,"
    },
    {
      "Time_Start": 1982.24,
      "Time_End": 1983.28,
      "Text": " typically that will be because"
    },
    {
      "Time_Start": 1983.28,
      "Time_End": 1984.4,
      "Text": " you need to have an IP address"
    },
    {
      "Time_Start": 1984.4,
      "Time_End": 1985.44,
      "Text": " that belongs to the range"
    },
    {
      "Time_Start": 1985.44,
      "Time_End": 1986.72,
      "Text": " that the users will be using"
    },
    {
      "Time_Start": 1986.72,
      "Time_End": 1988.6399999999999,
      "Text": " to actually reach the portal itself"
    },
    {
      "Time_Start": 1988.6399999999999,
      "Time_End": 1989.92,
      "Text": " to be able to trigger this flow."
    },
    {
      "Time_Start": 1989.92,
      "Time_End": 1991.04,
      "Text": " So something to bear in mind."
    },
    {
      "Time_Start": 1994.08,
      "Time_End": 1995.04,
      "Text": " The other area as well,"
    },
    {
      "Time_Start": 1995.04,
      "Time_End": 1996.0,
      "Text": " I kind of wanted to touch on"
    },
    {
      "Time_Start": 1996.0,
      "Time_End": 1997.2,
      "Text": " very quickly was"
    },
    {
      "Time_Start": 1997.2,
      "Time_End": 1998.3999999999999,
      "Text": " if we managed to compromise"
    },
    {
      "Time_Start": 1998.3999999999999,
      "Time_End": 1999.6,
      "Text": " Active Directory"
    },
    {
      "Time_Start": 1999.6,
      "Time_End": 2000.56,
      "Text": " and we managed to compromise"
    },
    {
      "Time_Start": 2000.56,
      "Time_End": 2001.36,
      "Text": " the service account"
    },
    {
      "Time_Start": 2001.36,
      "Time_End": 2003.12,
      "Text": " that's actually being used"
    },
    {
      "Time_Start": 2003.12,
      "Time_End": 2004.08,
      "Text": " as the service account"
    },
    {
      "Time_Start": 2004.08,
      "Time_End": 2006.32,
      "Text": " to go on and kind of sign these TGSs,"
    },
    {
      "Time_Start": 2007.2,
      "Time_End": 2008.48,
      "Text": " we can just perform a silver ticket"
    },
    {
      "Time_Start": 2008.48,
      "Time_End": 2009.12,
      "Text": " attack as well."
    },
    {
      "Time_Start": 2009.12,
      "Time_End": 2010.56,
      "Text": " So this is an area where,"
    },
    {
      "Time_Start": 2010.56,
      "Time_End": 2011.2,
      "Text": " you know, we've gone on"
    },
    {
      "Time_Start": 2011.2,
      "Time_End": 2012.8799999999999,
      "Text": " and we've compromised Active Directory"
    },
    {
      "Time_Start": 2014.08,
      "Time_End": 2015.12,
      "Text": " and we may want to pivot"
    },
    {
      "Time_Start": 2015.12,
      "Time_End": 2016.3999999999999,
      "Text": " as a privileged user"
    },
    {
      "Time_Start": 2016.3999999999999,
      "Time_End": 2018.8799999999999,
      "Text": " into, say, an identity provider."
    },
    {
      "Time_Start": 2018.8799999999999,
      "Time_End": 2020.56,
      "Text": " Again, so let's say as Okta."
    },
    {
      "Time_Start": 2020.56,
      "Time_End": 2021.28,
      "Text": " So we can just go on"
    },
    {
      "Time_Start": 2021.28,
      "Time_End": 2022.6399999999999,
      "Text": " and use a silver ticket attack"
    },
    {
      "Time_Start": 2022.6399999999999,
      "Time_End": 2024.6399999999999,
      "Text": " to generate Kerberos tickets"
    },
    {
      "Time_Start": 2024.64,
      "Time_End": 2026.4,
      "Text": " as any Active Directory user,"
    },
    {
      "Time_Start": 2026.4,
      "Time_End": 2027.3600000000001,
      "Text": " hopefully the privileged,"
    },
    {
      "Time_Start": 2027.3600000000001,
      "Time_End": 2028.0,
      "Text": " and then we can go on"
    },
    {
      "Time_Start": 2028.0,
      "Time_End": 2029.2,
      "Text": " and move into Okta"
    },
    {
      "Time_Start": 2029.2,
      "Time_End": 2030.64,
      "Text": " as that privileged user."
    },
    {
      "Time_Start": 2030.64,
      "Time_End": 2031.44,
      "Text": " So again, I'll skip through"
    },
    {
      "Time_Start": 2031.44,
      "Time_End": 2032.16,
      "Text": " this very quickly,"
    },
    {
      "Time_Start": 2032.16,
      "Time_End": 2033.2,
      "Text": " but this is just an example"
    },
    {
      "Time_Start": 2033.2,
      "Time_End": 2034.3200000000002,
      "Text": " of a silver ticket attack"
    },
    {
      "Time_Start": 2035.2,
      "Time_End": 2036.8000000000002,
      "Text": " generating a ticket as a,"
    },
    {
      "Time_Start": 2036.8000000000002,
      "Time_End": 2038.48,
      "Text": " say, a potentially privileged user"
    },
    {
      "Time_Start": 2038.48,
      "Time_End": 2039.5200000000002,
      "Text": " because we've already compromised"
    },
    {
      "Time_Start": 2039.5200000000002,
      "Time_End": 2041.76,
      "Text": " the keys for the service account"
    },
    {
      "Time_Start": 2041.76,
      "Time_End": 2043.0400000000002,
      "Text": " that, say, Okta runs as."
    },
    {
      "Time_Start": 2044.0800000000002,
      "Time_End": 2044.96,
      "Text": " And again, performing"
    },
    {
      "Time_Start": 2044.96,
      "Time_End": 2045.92,
      "Text": " the exact same technique,"
    },
    {
      "Time_Start": 2047.2800000000002,
      "Time_End": 2048.2400000000002,
      "Text": " injecting that into"
    },
    {
      "Time_Start": 2049.76,
      "Time_End": 2050.56,
      "Text": " the attacker machine"
    },
    {
      "Time_Start": 2050.56,
      "Time_End": 2051.6,
      "Text": " that we're running as."
    },
    {
      "Time_Start": 2051.6,
      "Time_End": 2052.6400000000003,
      "Text": " Sorry, this is a ping"
    },
    {
      "Time_Start": 2052.6400000000003,
      "Time_End": 2054.32,
      "Text": " that we're using as an example here."
    },
    {
      "Time_Start": 2054.32,
      "Time_End": 2055.04,
      "Text": " It works across"
    },
    {
      "Time_Start": 2055.04,
      "Time_End": 2056.32,
      "Text": " different providers as well."
    },
    {
      "Time_Start": 2056.32,
      "Time_End": 2057.6800000000003,
      "Text": " So if the authentication"
    },
    {
      "Time_Start": 2057.6800000000003,
      "Time_End": 2059.2000000000003,
      "Text": " is using Kerberos in ping,"
    },
    {
      "Time_Start": 2060.48,
      "Time_End": 2061.84,
      "Text": " then hopefully, you know,"
    },
    {
      "Time_Start": 2061.84,
      "Time_End": 2062.56,
      "Text": " things line up."
    },
    {
      "Time_Start": 2062.56,
      "Time_End": 2063.92,
      "Text": " We're able to access ping"
    },
    {
      "Time_Start": 2063.92,
      "Time_End": 2065.6000000000004,
      "Text": " as a privileged user account"
    },
    {
      "Time_Start": 2065.6000000000004,
      "Time_End": 2066.6400000000003,
      "Text": " just by attacking"
    },
    {
      "Time_Start": 2066.6400000000003,
      "Time_End": 2067.36,
      "Text": " the service account"
    },
    {
      "Time_Start": 2067.36,
      "Time_End": 2068.96,
      "Text": " that is used on Active Directory."
    },
    {
      "Time_Start": 2068.96,
      "Time_End": 2070.1600000000003,
      "Text": " And that's how we can kind of pivot"
    },
    {
      "Time_Start": 2070.1600000000003,
      "Time_End": 2071.92,
      "Text": " into privileged users"
    },
    {
      "Time_Start": 2071.92,
      "Time_End": 2073.52,
      "Text": " within the identity provider itself."
    },
    {
      "Time_Start": 2077.28,
      "Time_End": 2080.1600000000003,
      "Text": " OK, so let's take another look at,"
    },
    {
      "Time_Start": 2080.1600000000003,
      "Time_End": 2082.32,
      "Text": " let's take a look at SAML attacks."
    },
    {
      "Time_Start": 2082.32,
      "Time_End": 2084.1600000000003,
      "Text": " So SAML attacks"
    },
    {
      "Time_Start": 2084.1600000000003,
      "Time_End": 2085.36,
      "Text": " are a little bit more complicated."
    },
    {
      "Time_Start": 2086.96,
      "Time_End": 2087.92,
      "Text": " A very quick overview"
    },
    {
      "Time_Start": 2087.92,
      "Time_End": 2088.88,
      "Text": " is kind of how this all"
    },
    {
      "Time_Start": 2088.88,
      "Time_End": 2090.1600000000003,
      "Text": " kind of connects together."
    },
    {
      "Time_Start": 2090.88,
      "Time_End": 2091.92,
      "Text": " So in SAML, what we have"
    },
    {
      "Time_Start": 2091.92,
      "Time_End": 2093.1200000000003,
      "Text": " is the context of a user"
    },
    {
      "Time_Start": 2093.1200000000003,
      "Time_End": 2093.76,
      "Text": " or a principal."
    },
    {
      "Time_Start": 2093.76,
      "Time_End": 2094.88,
      "Text": " So this is a user actually"
    },
    {
      "Time_Start": 2094.88,
      "Time_End": 2096.6400000000003,
      "Text": " looking to log into, say, Okta."
    },
    {
      "Time_Start": 2097.28,
      "Time_End": 2098.1600000000003,
      "Text": " Okta will have some kind"
    },
    {
      "Time_Start": 2098.1600000000003,
      "Time_End": 2098.96,
      "Text": " of a private key"
    },
    {
      "Time_Start": 2098.96,
      "Time_End": 2100.2400000000002,
      "Text": " that will be used to be able"
    },
    {
      "Time_Start": 2100.2400000000002,
      "Time_End": 2102.7200000000003,
      "Text": " to encrypt or sign SAML tokens"
    },
    {
      "Time_Start": 2102.7200000000003,
      "Time_End": 2104.48,
      "Text": " that are ultimately forwarded"
    },
    {
      "Time_Start": 2104.48,
      "Time_End": 2105.6800000000003,
      "Text": " through to the service provider."
    },
    {
      "Time_Start": 2106.32,
      "Time_End": 2107.28,
      "Text": " And the service provider"
    },
    {
      "Time_Start": 2107.28,
      "Time_End": 2108.2400000000002,
      "Text": " will perform a check"
    },
    {
      "Time_Start": 2108.2400000000002,
      "Time_End": 2109.76,
      "Text": " to make sure that, you know,"
    },
    {
      "Time_Start": 2109.76,
      "Time_End": 2111.52,
      "Text": " it's been signed by a legitimate"
    },
    {
      "Time_Start": 2111.52,
      "Time_End": 2112.64,
      "Text": " identity provider."
    },
    {
      "Time_Start": 2112.64,
      "Time_End": 2113.52,
      "Text": " And because that trust"
    },
    {
      "Time_Start": 2113.52,
      "Time_End": 2114.96,
      "Text": " has been set up between the two,"
    },
    {
      "Time_Start": 2114.96,
      "Time_End": 2115.7599999999998,
      "Text": " the service provider"
    },
    {
      "Time_Start": 2115.7599999999998,
      "Time_End": 2116.88,
      "Text": " and the identity provider,"
    },
    {
      "Time_Start": 2117.84,
      "Time_End": 2120.08,
      "Text": " then ultimately the trust"
    },
    {
      "Time_Start": 2120.08,
      "Time_End": 2120.8,
      "Text": " is established"
    },
    {
      "Time_Start": 2120.8,
      "Time_End": 2121.6,
      "Text": " and the user is allowed"
    },
    {
      "Time_Start": 2121.6,
      "Time_End": 2122.32,
      "Text": " to authenticate."
    },
    {
      "Time_Start": 2124.16,
      "Time_End": 2125.04,
      "Text": " So this is kind of"
    },
    {
      "Time_Start": 2125.04,
      "Time_End": 2125.7599999999998,
      "Text": " what you're dealing with"
    },
    {
      "Time_Start": 2125.7599999999998,
      "Time_End": 2126.72,
      "Text": " when you're in the SAML world."
    },
    {
      "Time_Start": 2126.72,
      "Time_End": 2127.84,
      "Text": " So you have like a token"
    },
    {
      "Time_Start": 2127.84,
      "Time_End": 2128.88,
      "Text": " or a ticket,"
    },
    {
      "Time_Start": 2128.88,
      "Time_End": 2130.24,
      "Text": " you're dealing with assertions."
    },
    {
      "Time_Start": 2130.24,
      "Time_End": 2131.28,
      "Text": " Essentially, if you think of this"
    },
    {
      "Time_Start": 2131.28,
      "Time_End": 2132.24,
      "Text": " as an XML blob"
    },
    {
      "Time_Start": 2132.24,
      "Time_End": 2132.96,
      "Text": " that's been signed"
    },
    {
      "Time_Start": 2132.96,
      "Time_End": 2134.32,
      "Text": " by a trusted provider"
    },
    {
      "Time_Start": 2134.32,
      "Time_End": 2135.36,
      "Text": " to say the information"
    },
    {
      "Time_Start": 2135.36,
      "Time_End": 2136.32,
      "Text": " contained in this blob"
    },
    {
      "Time_Start": 2136.32,
      "Time_End": 2138.16,
      "Text": " is valid as far as I'm concerned."
    },
    {
      "Time_Start": 2139.2,
      "Time_End": 2140.48,
      "Text": " There's normally a subject in there,"
    },
    {
      "Time_Start": 2140.48,
      "Time_End": 2141.28,
      "Text": " so the subject can be"
    },
    {
      "Time_Start": 2141.28,
      "Time_End": 2142.96,
      "Text": " an email address, an ID,"
    },
    {
      "Time_Start": 2143.84,
      "Time_End": 2145.28,
      "Text": " it can be a username."
    },
    {
      "Time_Start": 2145.28,
      "Time_End": 2146.2400000000002,
      "Text": " And there's assertions"
    },
    {
      "Time_Start": 2146.2400000000002,
      "Time_End": 2147.04,
      "Text": " that are in there as well."
    },
    {
      "Time_Start": 2147.04,
      "Time_End": 2147.76,
      "Text": " So the assertions"
    },
    {
      "Time_Start": 2147.76,
      "Time_End": 2149.36,
      "Text": " are extra bits of information"
    },
    {
      "Time_Start": 2149.36,
      "Time_End": 2150.72,
      "Text": " to identify the user."
    },
    {
      "Time_Start": 2150.72,
      "Time_End": 2151.92,
      "Text": " So it may be an email address,"
    },
    {
      "Time_Start": 2151.92,
      "Time_End": 2153.04,
      "Text": " it may be a username,"
    },
    {
      "Time_Start": 2153.04,
      "Time_End": 2154.72,
      "Text": " you know, maybe a phone number."
    },
    {
      "Time_Start": 2155.44,
      "Time_End": 2156.64,
      "Text": " And then this ticket is then"
    },
    {
      "Time_Start": 2157.68,
      "Time_End": 2158.88,
      "Text": " cryptographically signed"
    },
    {
      "Time_Start": 2159.68,
      "Time_End": 2161.12,
      "Text": " by, say, the private key"
    },
    {
      "Time_Start": 2161.12,
      "Time_End": 2163.04,
      "Text": " that sits within Okta or Ping"
    },
    {
      "Time_Start": 2163.04,
      "Time_End": 2164.0,
      "Text": " or whoever it may be"
    },
    {
      "Time_Start": 2164.64,
      "Time_End": 2166.16,
      "Text": " and passed on to the service provider."
    },
    {
      "Time_Start": 2168.2400000000002,
      "Time_End": 2170.2400000000002,
      "Text": " So one of the earlier techniques"
    },
    {
      "Time_Start": 2170.96,
      "Time_End": 2172.16,
      "Text": " that I kind of stumbled across,"
    },
    {
      "Time_Start": 2172.96,
      "Time_End": 2174.32,
      "Text": " I think it was a while ago now,"
    },
    {
      "Time_Start": 2174.32,
      "Time_End": 2176.16,
      "Text": " was a technique by Ian Arle,"
    },
    {
      "Time_Start": 2176.16,
      "Time_End": 2177.68,
      "Text": " I believe his surname is,"
    },
    {
      "Time_Start": 2177.68,
      "Time_End": 2178.72,
      "Text": " tech defense on Twitter."
    },
    {
      "Time_Start": 2179.36,
      "Time_End": 2180.64,
      "Text": " And what he actually showed was"
    },
    {
      "Time_Start": 2181.36,
      "Time_End": 2182.96,
      "Text": " that there was a way"
    },
    {
      "Time_Start": 2182.96,
      "Time_End": 2184.96,
      "Text": " to abuse intended functionality"
    },
    {
      "Time_Start": 2184.96,
      "Time_End": 2185.76,
      "Text": " in Okta"
    },
    {
      "Time_Start": 2185.76,
      "Time_End": 2187.2,
      "Text": " to be able to impersonate"
    },
    {
      "Time_Start": 2187.2,
      "Time_End": 2188.2400000000002,
      "Text": " different users"
    },
    {
      "Time_Start": 2188.2400000000002,
      "Time_End": 2189.84,
      "Text": " if you have a privileged account"
    },
    {
      "Time_Start": 2189.84,
      "Time_End": 2191.36,
      "Text": " to be able to make some modifications."
    },
    {
      "Time_Start": 2192.0,
      "Time_End": 2192.96,
      "Text": " I believe Okta at the time"
    },
    {
      "Time_Start": 2192.96,
      "Time_End": 2193.68,
      "Text": " came out and said,"
    },
    {
      "Time_Start": 2193.68,
      "Time_End": 2194.72,
      "Text": " you know, this is not an attack,"
    },
    {
      "Time_Start": 2194.72,
      "Time_End": 2195.92,
      "Text": " this is absolutely"
    },
    {
      "Time_Start": 2195.92,
      "Time_End": 2197.04,
      "Text": " intended functionality."
    },
    {
      "Time_Start": 2197.68,
      "Time_End": 2198.88,
      "Text": " But we have managed to use this"
    },
    {
      "Time_Start": 2198.88,
      "Time_End": 2199.92,
      "Text": " on engagements in the past"
    },
    {
      "Time_Start": 2199.92,
      "Time_End": 2201.6,
      "Text": " where we've had privileged API keys,"
    },
    {
      "Time_Start": 2201.6,
      "Time_End": 2202.4,
      "Text": " say, in Okta."
    },
    {
      "Time_Start": 2203.2000000000003,
      "Time_End": 2204.08,
      "Text": " And we've actually gone on"
    },
    {
      "Time_Start": 2204.08,
      "Time_End": 2205.6,
      "Text": " to use those API keys"
    },
    {
      "Time_Start": 2205.6,
      "Time_End": 2206.88,
      "Text": " to make modifications"
    },
    {
      "Time_Start": 2206.88,
      "Time_End": 2208.56,
      "Text": " to, say, an application"
    },
    {
      "Time_Start": 2208.56,
      "Time_End": 2209.76,
      "Text": " that's been deployed on Okta"
    },
    {
      "Time_Start": 2209.76,
      "Time_End": 2211.04,
      "Text": " just to change out"
    },
    {
      "Time_Start": 2211.04,
      "Time_End": 2212.88,
      "Text": " ultimately who will be identified"
    },
    {
      "Time_Start": 2212.88,
      "Time_End": 2214.32,
      "Text": " to the service provider."
    },
    {
      "Time_Start": 2214.32,
      "Time_End": 2215.36,
      "Text": " So the email address"
    },
    {
      "Time_Start": 2215.36,
      "Time_End": 2216.32,
      "Text": " that will essentially be sent"
    },
    {
      "Time_Start": 2216.32,
      "Time_End": 2217.36,
      "Text": " on to the service provider."
    },
    {
      "Time_Start": 2217.92,
      "Time_End": 2218.7200000000003,
      "Text": " So this is real,"
    },
    {
      "Time_Start": 2218.7200000000003,
      "Time_End": 2220.0,
      "Text": " this is something that I have used"
    },
    {
      "Time_Start": 2220.0,
      "Time_End": 2221.2000000000003,
      "Text": " during an assessment."
    },
    {
      "Time_Start": 2221.2000000000003,
      "Time_End": 2223.04,
      "Text": " It is absolutely intended functionality,"
    },
    {
      "Time_Start": 2223.04,
      "Time_End": 2224.32,
      "Text": " this is all by design."
    },
    {
      "Time_Start": 2225.6,
      "Time_End": 2226.8,
      "Text": " But yeah, I just wanted to call it out,"
    },
    {
      "Time_Start": 2226.8,
      "Time_End": 2228.48,
      "Text": " really, that even though sometimes"
    },
    {
      "Time_Start": 2228.48,
      "Time_End": 2229.92,
      "Text": " things may not appear to be,"
    },
    {
      "Time_Start": 2229.92,
      "Time_End": 2231.36,
      "Text": " you know, valid attack cases,"
    },
    {
      "Time_Start": 2231.36,
      "Time_End": 2232.64,
      "Text": " you know, again, we've kind of"
    },
    {
      "Time_Start": 2232.64,
      "Time_End": 2233.52,
      "Text": " used this in the past."
    },
    {
      "Time_Start": 2234.2400000000002,
      "Time_End": 2235.52,
      "Text": " So I just wanted to kind of show"
    },
    {
      "Time_Start": 2235.52,
      "Time_End": 2236.56,
      "Text": " what this looked like."
    },
    {
      "Time_Start": 2236.56,
      "Time_End": 2240.16,
      "Text": " So in terms of the deployment here,"
    },
    {
      "Time_Start": 2240.16,
      "Time_End": 2241.68,
      "Text": " what we've got is Jira"
    },
    {
      "Time_Start": 2241.68,
      "Time_End": 2242.48,
      "Text": " that's been set up"
    },
    {
      "Time_Start": 2243.12,
      "Time_End": 2244.48,
      "Text": " and Jira is the service provider"
    },
    {
      "Time_Start": 2244.48,
      "Time_End": 2245.76,
      "Text": " that ultimately we want to reach."
    },
    {
      "Time_Start": 2246.32,
      "Time_End": 2249.04,
      "Text": " This has been set up to trust Okta."
    },
    {
      "Time_Start": 2250.56,
      "Time_End": 2254.16,
      "Text": " And here what we've got is API tokens"
    },
    {
      "Time_Start": 2254.16,
      "Time_End": 2254.96,
      "Text": " on the right-hand side"
    },
    {
      "Time_Start": 2254.96,
      "Time_End": 2255.76,
      "Text": " that's sat in Burp."
    },
    {
      "Time_Start": 2256.64,
      "Time_End": 2257.6,
      "Text": " We're going to look at the value"
    },
    {
      "Time_Start": 2257.68,
      "Time_End": 2258.7999999999997,
      "Text": " to users that have been granted"
    },
    {
      "Time_Start": 2258.7999999999997,
      "Time_End": 2262.24,
      "Text": " permission to use the Jira application."
    },
    {
      "Time_Start": 2263.52,
      "Time_End": 2264.64,
      "Text": " And what we're going to do"
    },
    {
      "Time_Start": 2264.64,
      "Time_End": 2266.56,
      "Text": " is before we actually make the change"
    },
    {
      "Time_Start": 2266.56,
      "Time_End": 2268.16,
      "Text": " to the username"
    },
    {
      "Time_Start": 2268.16,
      "Time_End": 2269.7599999999998,
      "Text": " that the user will be identified as,"
    },
    {
      "Time_Start": 2270.4,
      "Time_End": 2271.2799999999997,
      "Text": " we're just going to show"
    },
    {
      "Time_Start": 2271.2799999999997,
      "Time_End": 2273.68,
      "Text": " what Jira looks like as the existing user."
    },
    {
      "Time_Start": 2277.68,
      "Time_End": 2278.88,
      "Text": " So the user itself"
    },
    {
      "Time_Start": 2278.88,
      "Time_End": 2280.7999999999997,
      "Text": " doesn't have any kind of like real privileges"
    },
    {
      "Time_Start": 2280.7999999999997,
      "Time_End": 2281.68,
      "Text": " or anything like that."
    },
    {
      "Time_Start": 2287.92,
      "Time_End": 2289.12,
      "Text": " Okay, so we log out"
    },
    {
      "Time_Start": 2289.12,
      "Time_End": 2290.24,
      "Text": " and then what we're going to do"
    },
    {
      "Time_Start": 2290.24,
      "Time_End": 2292.08,
      "Text": " is we're going to make the API call"
    },
    {
      "Time_Start": 2292.08,
      "Time_End": 2293.04,
      "Text": " and in the API call,"
    },
    {
      "Time_Start": 2293.04,
      "Time_End": 2294.56,
      "Text": " we're going to say to Okta,"
    },
    {
      "Time_Start": 2294.56,
      "Time_End": 2295.8399999999997,
      "Text": " okay, well, this existing user"
    },
    {
      "Time_Start": 2295.8399999999997,
      "Time_End": 2297.8399999999997,
      "Text": " already has access to the Jira application,"
    },
    {
      "Time_Start": 2297.8399999999997,
      "Time_End": 2299.12,
      "Text": " but actually what we're going to do now"
    },
    {
      "Time_Start": 2299.12,
      "Time_End": 2300.3199999999997,
      "Text": " is to update the subjects"
    },
    {
      "Time_Start": 2300.3199999999997,
      "Time_End": 2302.16,
      "Text": " that will be sent through in the SAML ticket"
    },
    {
      "Time_Start": 2302.16,
      "Time_End": 2304.08,
      "Text": " to be this completely arbitrary user."
    },
    {
      "Time_Start": 2304.64,
      "Time_End": 2306.48,
      "Text": " Again, the way that the service providers"
    },
    {
      "Time_Start": 2306.48,
      "Time_End": 2308.88,
      "Text": " react with this can differ."
    },
    {
      "Time_Start": 2308.88,
      "Time_End": 2311.44,
      "Text": " So some of them will use the subject,"
    },
    {
      "Time_Start": 2311.44,
      "Time_End": 2312.7999999999997,
      "Text": " some of them may use assertions."
    },
    {
      "Time_Start": 2312.7999999999997,
      "Time_End": 2313.7599999999998,
      "Text": " So again, you'll have to test"
    },
    {
      "Time_Start": 2313.7599999999998,
      "Time_End": 2315.36,
      "Text": " these specific cases out yourself"
    },
    {
      "Time_Start": 2315.44,
      "Time_End": 2317.6800000000003,
      "Text": " or just by changing the username."
    },
    {
      "Time_Start": 2319.6800000000003,
      "Time_End": 2321.1200000000003,
      "Text": " The ticket itself is granted"
    },
    {
      "Time_Start": 2321.1200000000003,
      "Time_End": 2323.6800000000003,
      "Text": " or the subject is set to a different username."
    },
    {
      "Time_Start": 2323.6800000000003,
      "Time_End": 2324.32,
      "Text": " And in this case,"
    },
    {
      "Time_Start": 2324.32,
      "Time_End": 2325.6,
      "Text": " we've set it to a username"
    },
    {
      "Time_Start": 2325.6,
      "Time_End": 2328.08,
      "Text": " of somebody who has admin access to say Jira."
    },
    {
      "Time_Start": 2329.2000000000003,
      "Time_End": 2329.92,
      "Text": " And you can see here"
    },
    {
      "Time_Start": 2329.92,
      "Time_End": 2331.76,
      "Text": " that we've authenticated as a different user."
    },
    {
      "Time_Start": 2331.76,
      "Time_End": 2332.4,
      "Text": " And in this case,"
    },
    {
      "Time_Start": 2332.4,
      "Time_End": 2333.6800000000003,
      "Text": " we've got privileged access"
    },
    {
      "Time_Start": 2333.6800000000003,
      "Time_End": 2335.44,
      "Text": " as that particular user as well."
    },
    {
      "Time_Start": 2335.44,
      "Time_End": 2337.28,
      "Text": " So again, even though this is not something"
    },
    {
      "Time_Start": 2337.28,
      "Time_End": 2339.44,
      "Text": " that Okta will class as a vulnerability"
    },
    {
      "Time_Start": 2339.44,
      "Time_End": 2340.56,
      "Text": " and I probably wouldn't class it"
    },
    {
      "Time_Start": 2340.56,
      "Time_End": 2341.6800000000003,
      "Text": " as a vulnerability myself,"
    },
    {
      "Time_Start": 2342.48,
      "Time_End": 2343.84,
      "Text": " this is something that I have used"
    },
    {
      "Time_Start": 2343.92,
      "Time_End": 2344.96,
      "Text": " during prior engagements"
    },
    {
      "Time_Start": 2344.96,
      "Time_End": 2346.48,
      "Text": " and it has got me that step further"
    },
    {
      "Time_Start": 2346.48,
      "Time_End": 2348.56,
      "Text": " into different service providers"
    },
    {
      "Time_Start": 2348.56,
      "Time_End": 2350.96,
      "Text": " that we kind of needed to kind of access"
    },
    {
      "Time_Start": 2350.96,
      "Time_End": 2352.0,
      "Text": " as part of the assessment."
    },
    {
      "Time_Start": 2354.48,
      "Time_End": 2355.6800000000003,
      "Text": " So what I wanted to look at here"
    },
    {
      "Time_Start": 2355.6800000000003,
      "Time_End": 2358.88,
      "Text": " was a kind of a second way to abuse this."
    },
    {
      "Time_Start": 2358.88,
      "Time_End": 2362.4,
      "Text": " So there's a context in Okta"
    },
    {
      "Time_Start": 2362.4,
      "Time_End": 2363.28,
      "Text": " and different providers"
    },
    {
      "Time_Start": 2363.28,
      "Time_End": 2365.44,
      "Text": " where you can actually turn"
    },
    {
      "Time_Start": 2365.44,
      "Time_End": 2366.56,
      "Text": " the identity provider"
    },
    {
      "Time_Start": 2366.56,
      "Time_End": 2367.6800000000003,
      "Text": " into a service provider."
    },
    {
      "Time_Start": 2367.6800000000003,
      "Time_End": 2369.76,
      "Text": " So what we'll say is we've got Okta"
    },
    {
      "Time_Start": 2369.76,
      "Time_End": 2373.28,
      "Text": " who may potentially be a service provider"
    },
    {
      "Time_Start": 2373.84,
      "Time_End": 2374.96,
      "Text": " and identity provider."
    },
    {
      "Time_Start": 2374.96,
      "Time_End": 2376.6400000000003,
      "Text": " And actually what they want users to do"
    },
    {
      "Time_Start": 2376.6400000000003,
      "Time_End": 2378.1600000000003,
      "Text": " is to authenticate using,"
    },
    {
      "Time_Start": 2378.1600000000003,
      "Time_End": 2380.1600000000003,
      "Text": " I don't know, VMware's Workspace ONE."
    },
    {
      "Time_Start": 2380.88,
      "Time_End": 2382.0800000000004,
      "Text": " And VMware's Workspace ONE"
    },
    {
      "Time_Start": 2382.0800000000004,
      "Time_End": 2383.52,
      "Text": " will be partially performing"
    },
    {
      "Time_Start": 2383.52,
      "Time_End": 2385.0400000000004,
      "Text": " the authentication check"
    },
    {
      "Time_Start": 2385.0400000000004,
      "Time_End": 2386.5600000000004,
      "Text": " and then just verifying to Okta,"
    },
    {
      "Time_Start": 2386.5600000000004,
      "Time_End": 2388.6400000000003,
      "Text": " yes, this user is actually who they say they are."
    },
    {
      "Time_Start": 2388.6400000000003,
      "Time_End": 2390.0800000000004,
      "Text": " And then the user will actually receive"
    },
    {
      "Time_Start": 2390.0800000000004,
      "Time_End": 2392.2400000000002,
      "Text": " dashboard access for Okta."
    },
    {
      "Time_Start": 2392.96,
      "Time_End": 2394.0,
      "Text": " These are generally called"
    },
    {
      "Time_Start": 2394.0,
      "Time_End": 2395.44,
      "Text": " external identity providers."
    },
    {
      "Time_Start": 2396.6400000000003,
      "Time_End": 2398.5600000000004,
      "Text": " The way that these work cryptographically"
    },
    {
      "Time_Start": 2398.5600000000004,
      "Time_End": 2399.36,
      "Text": " is there's a key,"
    },
    {
      "Time_Start": 2399.36,
      "Time_End": 2401.0400000000004,
      "Text": " a private key that's deployed"
    },
    {
      "Time_Start": 2401.04,
      "Time_End": 2403.44,
      "Text": " on the external identity provider side."
    },
    {
      "Time_Start": 2403.44,
      "Time_End": 2405.04,
      "Text": " And within Okta or Ping"
    },
    {
      "Time_Start": 2405.04,
      "Time_End": 2406.0,
      "Text": " or whoever it may be,"
    },
    {
      "Time_Start": 2406.64,
      "Time_End": 2407.92,
      "Text": " you give them the public key"
    },
    {
      "Time_Start": 2407.92,
      "Time_End": 2409.04,
      "Text": " that'll be used to verify"
    },
    {
      "Time_Start": 2409.04,
      "Time_End": 2411.2,
      "Text": " that this trusted external provider"
    },
    {
      "Time_Start": 2411.2,
      "Time_End": 2413.2,
      "Text": " actually verifies that the user"
    },
    {
      "Time_Start": 2413.2,
      "Time_End": 2414.4,
      "Text": " is the genuine user."
    },
    {
      "Time_Start": 2415.2,
      "Time_End": 2416.4,
      "Text": " And then when the user goes through"
    },
    {
      "Time_Start": 2416.4,
      "Time_End": 2418.32,
      "Text": " and clicks the icon in the dashboard"
    },
    {
      "Time_Start": 2418.32,
      "Time_End": 2420.24,
      "Text": " to gain access to say Databricks,"
    },
    {
      "Time_Start": 2420.96,
      "Time_End": 2423.44,
      "Text": " there's a similar kind of sample token"
    },
    {
      "Time_Start": 2423.44,
      "Time_End": 2425.36,
      "Text": " that's created, signed by Okta"
    },
    {
      "Time_Start": 2425.36,
      "Time_End": 2427.04,
      "Text": " and then forwarded onto the service provider."
    },
    {
      "Time_Start": 2427.92,
      "Time_End": 2429.68,
      "Text": " So again, if we gain privilege access"
    },
    {
      "Time_Start": 2429.68,
      "Time_End": 2432.0,
      "Text": " to a typical identity provider,"
    },
    {
      "Time_Start": 2432.0,
      "Time_End": 2433.7599999999998,
      "Text": " so in this case, again, Okta,"
    },
    {
      "Time_Start": 2433.7599999999998,
      "Time_End": 2435.92,
      "Text": " there's absolutely nothing to stop us here"
    },
    {
      "Time_Start": 2435.92,
      "Time_End": 2438.56,
      "Text": " from just deploying"
    },
    {
      "Time_Start": 2438.56,
      "Time_End": 2439.84,
      "Text": " an external identity provider"
    },
    {
      "Time_Start": 2439.84,
      "Time_End": 2440.64,
      "Text": " that we control."
    },
    {
      "Time_Start": 2441.52,
      "Time_End": 2443.04,
      "Text": " And again, this is stuff that we've done"
    },
    {
      "Time_Start": 2443.04,
      "Time_End": 2445.44,
      "Text": " on prior assessments."
    },
    {
      "Time_Start": 2445.44,
      "Time_End": 2446.56,
      "Text": " So in this case, what we might do"
    },
    {
      "Time_Start": 2446.56,
      "Time_End": 2449.36,
      "Text": " is deploy an external identity provider"
    },
    {
      "Time_Start": 2449.36,
      "Time_End": 2450.72,
      "Text": " with a private key that we know."
    },
    {
      "Time_Start": 2451.6,
      "Time_End": 2452.64,
      "Text": " And ultimately what that does"
    },
    {
      "Time_Start": 2452.64,
      "Time_End": 2454.0,
      "Text": " is that delegates the trust to us"
    },
    {
      "Time_Start": 2454.0,
      "Time_End": 2455.12,
      "Text": " as attackers to say,"
    },
    {
      "Time_Start": 2455.12,
      "Time_End": 2457.12,
      "Text": " yes, we verify that this particular user"
    },
    {
      "Time_Start": 2457.12,
      "Time_End": 2458.4,
      "Text": " is a legitimate user,"
    },
    {
      "Time_Start": 2458.4,
      "Time_End": 2460.7999999999997,
      "Text": " Okta, please allow them to gain access."
    },
    {
      "Time_Start": 2463.2,
      "Time_End": 2464.96,
      "Text": " So yeah, so essentially what I've talked about there,"
    },
    {
      "Time_Start": 2464.96,
      "Time_End": 2467.8399999999997,
      "Text": " the attack path that we've seen in the past"
    },
    {
      "Time_Start": 2467.8399999999997,
      "Time_End": 2468.88,
      "Text": " is you would go on,"
    },
    {
      "Time_Start": 2468.88,
      "Time_End": 2469.7599999999998,
      "Text": " you would register,"
    },
    {
      "Time_Start": 2469.7599999999998,
      "Time_End": 2471.7599999999998,
      "Text": " say an external identity provider,"
    },
    {
      "Time_Start": 2471.7599999999998,
      "Time_End": 2474.3199999999997,
      "Text": " and you would set up kind of say Okta or Ping"
    },
    {
      "Time_Start": 2475.2799999999997,
      "Time_End": 2477.3599999999997,
      "Text": " or OneLogin with the public key"
    },
    {
      "Time_Start": 2477.3599999999997,
      "Time_End": 2479.12,
      "Text": " that we've got the private key for."
    },
    {
      "Time_Start": 2479.12,
      "Time_End": 2480.08,
      "Text": " And essentially that allows us"
    },
    {
      "Time_Start": 2480.08,
      "Time_End": 2482.16,
      "Text": " just to generate those sample tokens."
    },
    {
      "Time_Start": 2482.3999999999996,
      "Time_End": 2483.92,
      "Text": " One interesting thing to point out here"
    },
    {
      "Time_Start": 2483.92,
      "Time_End": 2485.92,
      "Text": " is that you can actually be quite creative"
    },
    {
      "Time_Start": 2485.92,
      "Time_End": 2487.8399999999997,
      "Text": " with the external identity providers"
    },
    {
      "Time_Start": 2487.8399999999997,
      "Time_End": 2488.8799999999997,
      "Text": " and that you register."
    },
    {
      "Time_Start": 2488.8799999999997,
      "Time_End": 2490.48,
      "Text": " So the way that SAML works"
    },
    {
      "Time_Start": 2490.48,
      "Time_End": 2493.04,
      "Text": " is the redirections are actually performed client side."
    },
    {
      "Time_Start": 2493.68,
      "Time_End": 2495.44,
      "Text": " So in some scenarios"
    },
    {
      "Time_Start": 2495.44,
      "Time_End": 2497.3599999999997,
      "Text": " where we wanted to fly under the radar a little bit"
    },
    {
      "Time_Start": 2497.3599999999997,
      "Time_End": 2500.3199999999997,
      "Text": " and we've had privileged access to say Okta,"
    },
    {
      "Time_Start": 2500.3199999999997,
      "Time_End": 2501.8399999999997,
      "Text": " and we don't want defenders going in"
    },
    {
      "Time_Start": 2501.8399999999997,
      "Time_End": 2502.64,
      "Text": " and kind of spotting,"
    },
    {
      "Time_Start": 2502.64,
      "Time_End": 2504.0,
      "Text": " you know, this is going to,"
    },
    {
      "Time_Start": 2504.0,
      "Time_End": 2506.0,
      "Text": " you know, xpn.trustedsec.com"
    },
    {
      "Time_Start": 2506.0,
      "Time_End": 2506.7999999999997,
      "Text": " or wherever it might be,"
    },
    {
      "Time_Start": 2506.7999999999997,
      "Time_End": 2508.08,
      "Text": " because obviously that's a private key"
    },
    {
      "Time_Start": 2508.08,
      "Time_End": 2508.8799999999997,
      "Text": " and we don't want that."
    },
    {
      "Time_Start": 2508.8799999999997,
      "Time_End": 2510.0,
      "Text": " So we want to be able to say,"
    },
    {
      "Time_Start": 2510.0,
      "Time_End": 2511.52,
      "Text": " xpn.trustedsec.com or wherever it might be,"
    },
    {
      "Time_Start": 2511.52,
      "Time_End": 2513.12,
      "Text": " because obviously that's going to stand out."
    },
    {
      "Time_Start": 2513.12,
      "Time_End": 2515.04,
      "Text": " And actually you can just enter in anything here."
    },
    {
      "Time_Start": 2515.04,
      "Time_End": 2516.0,
      "Text": " So in this example,"
    },
    {
      "Time_Start": 2516.0,
      "Time_End": 2518.24,
      "Text": " we've got Google that we've entered in"
    },
    {
      "Time_Start": 2518.24,
      "Time_End": 2520.0,
      "Text": " as the redirects that happens"
    },
    {
      "Time_Start": 2520.0,
      "Time_End": 2521.6,
      "Text": " when the user is trying to authenticate"
    },
    {
      "Time_Start": 2521.6,
      "Time_End": 2523.28,
      "Text": " using the external identity provider."
    },
    {
      "Time_Start": 2523.92,
      "Time_End": 2525.92,
      "Text": " And then you can map that out using the host file"
    },
    {
      "Time_Start": 2525.92,
      "Time_End": 2528.56,
      "Text": " actually just to capture that redirection that happens."
    },
    {
      "Time_Start": 2529.44,
      "Time_End": 2530.4,
      "Text": " You know, we're the attacker,"
    },
    {
      "Time_Start": 2530.4,
      "Time_End": 2531.76,
      "Text": " so we don't really care about"
    },
    {
      "Time_Start": 2532.72,
      "Time_End": 2533.92,
      "Text": " kind of the user experience"
    },
    {
      "Time_Start": 2533.92,
      "Time_End": 2535.36,
      "Text": " or the certificates and things like that."
    },
    {
      "Time_Start": 2536.24,
      "Time_End": 2538.56,
      "Text": " But what we care about is flying under the radar"
    },
    {
      "Time_Start": 2538.56,
      "Time_End": 2540.0,
      "Text": " actually when defenders get involved"
    },
    {
      "Time_Start": 2540.0,
      "Time_End": 2542.32,
      "Text": " and start to look through the identity provider's"
    },
    {
      "Time_Start": 2542.32,
      "Time_End": 2543.2799999999997,
      "Text": " configuration itself."
    },
    {
      "Time_Start": 2543.84,
      "Time_End": 2545.04,
      "Text": " So in Okta, we can do this"
    },
    {
      "Time_Start": 2545.04,
      "Time_End": 2547.2799999999997,
      "Text": " and there's no verification as to the URL."
    },
    {
      "Time_Start": 2548.24,
      "Time_End": 2549.36,
      "Text": " In Ping, you can do this."
    },
    {
      "Time_Start": 2549.36,
      "Time_End": 2550.56,
      "Text": " So in Ping, you can go through"
    },
    {
      "Time_Start": 2550.56,
      "Time_End": 2552.88,
      "Text": " and enter in any kind of URL that you want to,"
    },
    {
      "Time_Start": 2552.88,
      "Time_End": 2554.96,
      "Text": " and there's no verification that takes place"
    },
    {
      "Time_Start": 2554.96,
      "Time_End": 2556.32,
      "Text": " that you actually own the URL."
    },
    {
      "Time_Start": 2557.2,
      "Time_End": 2560.4,
      "Text": " Ping's actually a very specific case in this scenario"
    },
    {
      "Time_Start": 2560.4,
      "Time_End": 2562.88,
      "Text": " where they've actually got protection built in"
    },
    {
      "Time_Start": 2562.88,
      "Time_End": 2566.48,
      "Text": " around how an external identity provider"
    },
    {
      "Time_Start": 2566.48,
      "Time_End": 2568.16,
      "Text": " is allowed to link to existing accounts."
    },
    {
      "Time_Start": 2569.04,
      "Time_End": 2571.52,
      "Text": " So Ping have actually done like a fantastic job here"
    },
    {
      "Time_Start": 2571.52,
      "Time_End": 2574.32,
      "Text": " of actually making sure if somebody goes on to deploy,"
    },
    {
      "Time_Start": 2574.32,
      "Time_End": 2576.96,
      "Text": " say a rogue identity provider,"
    },
    {
      "Time_Start": 2576.96,
      "Time_End": 2578.64,
      "Text": " actually you still need to know the credentials"
    },
    {
      "Time_Start": 2578.64,
      "Time_End": 2580.56,
      "Text": " for the user before you can authenticate to the,"
    },
    {
      "Time_Start": 2581.2,
      "Time_End": 2582.88,
      "Text": " before you can authenticate as that user,"
    },
    {
      "Time_Start": 2584.0,
      "Time_End": 2585.2799999999997,
      "Text": " which is quite a nice way"
    },
    {
      "Time_Start": 2585.2799999999997,
      "Time_End": 2587.04,
      "Text": " to kind of protect against this attack."
    },
    {
      "Time_Start": 2587.04,
      "Time_End": 2589.36,
      "Text": " It still becomes useful for persistence,"
    },
    {
      "Time_Start": 2589.36,
      "Time_End": 2591.04,
      "Text": " so there are still ways around this."
    },
    {
      "Time_Start": 2591.04,
      "Time_End": 2593.52,
      "Text": " But just from a scenario that we're kind of showing here"
    },
    {
      "Time_Start": 2593.52,
      "Time_End": 2597.2,
      "Text": " where we may deploy a rogue external identity provider,"
    },
    {
      "Time_Start": 2598.0000000000005,
      "Time_End": 2600.9600000000005,
      "Text": " yeah, kind of thumbs up to Ping for doing a good job here"
    },
    {
      "Time_Start": 2600.9600000000005,
      "Time_End": 2602.88,
      "Text": " and kind of preventing this kind of an attack."
    },
    {
      "Time_Start": 2605.36,
      "Time_End": 2607.92,
      "Text": " OneLogin is exactly the same as Okta, really."
    },
    {
      "Time_Start": 2607.92,
      "Time_End": 2610.88,
      "Text": " You can go through and perform this attack on OneLogin."
    },
    {
      "Time_Start": 2610.88,
      "Time_End": 2613.6800000000003,
      "Text": " You can use any URL that you want to for the redirection."
    },
    {
      "Time_Start": 2613.6800000000003,
      "Time_End": 2616.2400000000002,
      "Text": " Again, you need to be a highly privileged user"
    },
    {
      "Time_Start": 2616.2400000000002,
      "Time_End": 2617.5200000000004,
      "Text": " to be able to deploy this."
    },
    {
      "Time_Start": 2617.5200000000004,
      "Time_End": 2619.84,
      "Text": " So arguably, again, not a vulnerability,"
    },
    {
      "Time_Start": 2619.84,
      "Time_End": 2621.0400000000004,
      "Text": " but certainly something that we've used"
    },
    {
      "Time_Start": 2621.0400000000004,
      "Time_End": 2624.2400000000002,
      "Text": " during assessments to access the identity provider"
    },
    {
      "Time_Start": 2624.2400000000002,
      "Time_End": 2626.1600000000003,
      "Text": " as kind of like an arbitrary user."
    },
    {
      "Time_Start": 2627.36,
      "Time_End": 2631.1200000000003,
      "Text": " And yeah, and then just to touch on EnterID as well."
    },
    {
      "Time_Start": 2631.1200000000003,
      "Time_End": 2635.5200000000004,
      "Text": " So EnterID actually does require verification of the domain."
    },
    {
      "Time_Start": 2635.5200000000004,
      "Time_End": 2637.6000000000004,
      "Text": " So you have to jump through a few hoops"
    },
    {
      "Time_Start": 2637.6000000000004,
      "Time_End": 2640.1600000000003,
      "Text": " to be able to register a domain on EnterID."
    },
    {
      "Time_Start": 2640.1600000000003,
      "Time_End": 2642.9600000000005,
      "Text": " So in this case, we've got azure.xpnsec.com."
    },
    {
      "Time_Start": 2642.9600000000005,
      "Time_End": 2645.1200000000003,
      "Text": " I've had to verify that using DNS records"
    },
    {
      "Time_Start": 2645.1200000000003,
      "Time_End": 2648.1600000000003,
      "Text": " to show that I actually do own the xpnsec.com domain."
    },
    {
      "Time_Start": 2648.7200000000003,
      "Time_End": 2650.32,
      "Text": " There are other attacks that we can do"
    },
    {
      "Time_Start": 2650.88,
      "Time_End": 2652.8,
      "Text": " in relation to EnterID."
    },
    {
      "Time_Start": 2652.8,
      "Time_End": 2654.32,
      "Text": " Again, I'm not going to go into it too much here"
    },
    {
      "Time_Start": 2654.32,
      "Time_End": 2656.0000000000005,
      "Text": " because I think this work on that's already been done"
    },
    {
      "Time_Start": 2656.0,
      "Time_End": 2658.16,
      "Text": " that explains this a lot better kind of than I can."
    },
    {
      "Time_Start": 2659.28,
      "Time_End": 2660.72,
      "Text": " But there are ways to be able to add in"
    },
    {
      "Time_Start": 2660.72,
      "Time_End": 2662.24,
      "Text": " like second signing certificates"
    },
    {
      "Time_Start": 2663.12,
      "Time_End": 2665.6,
      "Text": " into existing kind of like identity providers"
    },
    {
      "Time_Start": 2665.6,
      "Time_End": 2667.04,
      "Text": " and piggyback on the fact that"
    },
    {
      "Time_Start": 2668.16,
      "Time_End": 2670.08,
      "Text": " kind of this federation has already been set up."
    },
    {
      "Time_Start": 2673.36,
      "Time_End": 2676.0,
      "Text": " So yeah, so one of the tools that I released"
    },
    {
      "Time_Start": 2676.0,
      "Time_End": 2677.12,
      "Text": " as part of the Okta talk"
    },
    {
      "Time_Start": 2677.12,
      "Time_End": 2679.44,
      "Text": " was something that I was calling mal-idp."
    },
    {
      "Time_Start": 2679.44,
      "Time_End": 2680.4,
      "Text": " Essentially what this is,"
    },
    {
      "Time_Start": 2680.4,
      "Time_End": 2683.84,
      "Text": " is it's an external identity provider that I coded up"
    },
    {
      "Time_Start": 2684.56,
      "Time_End": 2686.08,
      "Text": " and it just allows us to authenticate"
    },
    {
      "Time_Start": 2686.08,
      "Time_End": 2687.52,
      "Text": " as any arbitrary user"
    },
    {
      "Time_Start": 2687.52,
      "Time_End": 2689.36,
      "Text": " and it just does the dance that needs to be done"
    },
    {
      "Time_Start": 2689.92,
      "Time_End": 2691.1200000000003,
      "Text": " to be able to authenticate"
    },
    {
      "Time_Start": 2691.1200000000003,
      "Time_End": 2692.96,
      "Text": " to different identity providers to show,"
    },
    {
      "Time_Start": 2692.96,
      "Time_End": 2695.2000000000003,
      "Text": " you know, we've signed the SAML ticket,"
    },
    {
      "Time_Start": 2695.2000000000003,
      "Time_End": 2696.6400000000003,
      "Text": " we pass it on to the identity provider"
    },
    {
      "Time_Start": 2696.6400000000003,
      "Time_End": 2698.6400000000003,
      "Text": " and it just allows us to provide any username,"
    },
    {
      "Time_Start": 2699.2000000000003,
      "Time_End": 2700.88,
      "Text": " email address, first name, surname."
    },
    {
      "Time_Start": 2701.52,
      "Time_End": 2702.8,
      "Text": " Ultimately, all that's left for us"
    },
    {
      "Time_Start": 2702.8,
      "Time_End": 2703.84,
      "Text": " as an attacker to do"
    },
    {
      "Time_Start": 2703.84,
      "Time_End": 2706.0,
      "Text": " is to compromise the identity provider"
    },
    {
      "Time_Start": 2706.0,
      "Time_End": 2708.32,
      "Text": " and connect this up to an instance"
    },
    {
      "Time_Start": 2708.32,
      "Time_End": 2710.1600000000003,
      "Text": " that we may have deployed of mal-idp."
    },
    {
      "Time_Start": 2711.04,
      "Time_End": 2712.1600000000003,
      "Text": " And once we've kind of done that,"
    },
    {
      "Time_Start": 2712.16,
      "Time_End": 2715.04,
      "Text": " we can mostly log in as kind of any user"
    },
    {
      "Time_Start": 2715.04,
      "Time_End": 2716.0,
      "Text": " that we want to log in as."
    },
    {
      "Time_Start": 2716.72,
      "Time_End": 2718.3999999999996,
      "Text": " So just to kind of show that as well,"
    },
    {
      "Time_Start": 2718.3999999999996,
      "Time_End": 2720.3999999999996,
      "Text": " so in this case, I wanted to show one login."
    },
    {
      "Time_Start": 2720.3999999999996,
      "Time_End": 2723.8399999999997,
      "Text": " So again, previously I've kind of beat up"
    },
    {
      "Time_Start": 2723.8399999999997,
      "Time_End": 2725.44,
      "Text": " on Okta a little bit,"
    },
    {
      "Time_Start": 2725.44,
      "Time_End": 2726.64,
      "Text": " so I thought it was fair"
    },
    {
      "Time_Start": 2726.64,
      "Time_End": 2728.16,
      "Text": " to kind of show a different provider"
    },
    {
      "Time_Start": 2728.16,
      "Time_End": 2729.12,
      "Text": " and kind of how that works."
    },
    {
      "Time_Start": 2730.56,
      "Time_End": 2732.3999999999996,
      "Text": " So if we're connected to one login,"
    },
    {
      "Time_Start": 2732.3999999999996,
      "Time_End": 2733.12,
      "Text": " what we've done here"
    },
    {
      "Time_Start": 2733.12,
      "Time_End": 2734.24,
      "Text": " is we've actually deployed"
    },
    {
      "Time_Start": 2735.12,
      "Time_End": 2736.96,
      "Text": " the external identity provider itself."
    },
    {
      "Time_Start": 2736.96,
      "Time_End": 2738.3999999999996,
      "Text": " We've already set up the configuration"
    },
    {
      "Time_Start": 2738.3999999999996,
      "Time_End": 2739.8399999999997,
      "Text": " that we've shown in the previous slides"
    },
    {
      "Time_Start": 2740.7200000000003,
      "Time_End": 2741.76,
      "Text": " and as an attacker,"
    },
    {
      "Time_Start": 2741.76,
      "Time_End": 2742.48,
      "Text": " what we find is that"
    },
    {
      "Time_Start": 2742.48,
      "Time_End": 2744.0,
      "Text": " when we want to authenticate"
    },
    {
      "Time_Start": 2744.0,
      "Time_End": 2746.2400000000002,
      "Text": " as any user essentially,"
    },
    {
      "Time_Start": 2746.2400000000002,
      "Time_End": 2747.76,
      "Text": " we can use mal-idp"
    },
    {
      "Time_Start": 2747.76,
      "Time_End": 2751.04,
      "Text": " just to enter in an email address of a user"
    },
    {
      "Time_Start": 2753.2000000000003,
      "Time_End": 2756.32,
      "Text": " and hopefully when we've authenticated,"
    },
    {
      "Time_Start": 2756.32,
      "Time_End": 2758.32,
      "Text": " we gain access as that particular user."
    },
    {
      "Time_Start": 2758.32,
      "Time_End": 2759.44,
      "Text": " Again, the reason that this works"
    },
    {
      "Time_Start": 2759.44,
      "Time_End": 2760.96,
      "Text": " is because we've set up that trust"
    },
    {
      "Time_Start": 2760.96,
      "Time_End": 2763.52,
      "Text": " between us as the external identity provider"
    },
    {
      "Time_Start": 2763.52,
      "Time_End": 2764.48,
      "Text": " and one login."
    },
    {
      "Time_Start": 2765.04,
      "Time_End": 2766.2400000000002,
      "Text": " Again, all by design,"
    },
    {
      "Time_Start": 2766.2400000000002,
      "Time_End": 2767.2000000000003,
      "Text": " you need privilege access"
    },
    {
      "Time_Start": 2767.2000000000003,
      "Time_End": 2768.0,
      "Text": " to be able to do this,"
    },
    {
      "Time_Start": 2768.0,
      "Time_End": 2769.04,
      "Text": " but it's a nice way to be able"
    },
    {
      "Time_Start": 2769.04,
      "Time_End": 2771.2,
      "Text": " to pivot between one account"
    },
    {
      "Time_Start": 2771.2,
      "Time_End": 2771.84,
      "Text": " and another account"
    },
    {
      "Time_Start": 2771.84,
      "Time_End": 2772.64,
      "Text": " without having to go in"
    },
    {
      "Time_Start": 2772.64,
      "Time_End": 2773.6,
      "Text": " and reset passwords"
    },
    {
      "Time_Start": 2773.6,
      "Time_End": 2774.4,
      "Text": " and those kind of things."
    },
    {
      "Time_Start": 2777.44,
      "Time_End": 2778.56,
      "Text": " I'll go a little bit quickly"
    },
    {
      "Time_Start": 2778.56,
      "Time_End": 2779.52,
      "Text": " because I'm running out of time"
    },
    {
      "Time_Start": 2779.52,
      "Time_End": 2779.92,
      "Text": " a little bit."
    },
    {
      "Time_Start": 2780.48,
      "Time_End": 2781.2,
      "Text": " So phishing,"
    },
    {
      "Time_Start": 2782.24,
      "Time_End": 2783.68,
      "Text": " this is another concept"
    },
    {
      "Time_Start": 2783.68,
      "Time_End": 2785.84,
      "Text": " that can be quite useful"
    },
    {
      "Time_Start": 2786.56,
      "Time_End": 2787.68,
      "Text": " when you're on an assessment."
    },
    {
      "Time_Start": 2787.68,
      "Time_End": 2789.44,
      "Text": " So the concept here is that"
    },
    {
      "Time_Start": 2789.44,
      "Time_End": 2791.7599999999998,
      "Text": " we're going to use an identity provider"
    },
    {
      "Time_Start": 2792.8,
      "Time_End": 2794.88,
      "Text": " actually as our phishing law"
    },
    {
      "Time_Start": 2794.88,
      "Time_End": 2796.16,
      "Text": " and we're going to rely on the trust"
    },
    {
      "Time_Start": 2796.16,
      "Time_End": 2798.88,
      "Text": " that users have in the portal itself"
    },
    {
      "Time_Start": 2798.88,
      "Time_End": 2800.1600000000003,
      "Text": " and kind of the URLs"
    },
    {
      "Time_Start": 2800.7200000000003,
      "Time_End": 2801.28,
      "Text": " and we're going to see"
    },
    {
      "Time_Start": 2801.28,
      "Time_End": 2802.7200000000003,
      "Text": " whether we can use an identity provider"
    },
    {
      "Time_Start": 2802.7200000000003,
      "Time_End": 2804.6400000000003,
      "Text": " actually to start gathering credentials for us"
    },
    {
      "Time_Start": 2805.36,
      "Time_End": 2806.56,
      "Text": " during a phishing campaign."
    },
    {
      "Time_Start": 2807.92,
      "Time_End": 2809.76,
      "Text": " There's a couple of pros and cons to this."
    },
    {
      "Time_Start": 2809.76,
      "Time_End": 2812.2400000000002,
      "Text": " So obviously one of the big pros,"
    },
    {
      "Time_Start": 2812.2400000000002,
      "Time_End": 2813.92,
      "Text": " I think Luke talked about it earlier on"
    },
    {
      "Time_Start": 2813.92,
      "Time_End": 2814.56,
      "Text": " in his talk,"
    },
    {
      "Time_Start": 2815.52,
      "Time_End": 2816.6400000000003,
      "Text": " was that there's a lot of trust"
    },
    {
      "Time_Start": 2816.6400000000003,
      "Time_End": 2818.32,
      "Text": " that users have in legitimate,"
    },
    {
      "Time_Start": 2818.32,
      "Time_End": 2820.4,
      "Text": " you know, subdomain.opta.com."
    },
    {
      "Time_Start": 2821.6,
      "Time_End": 2824.7200000000003,
      "Text": " Domains, they've been trained"
    },
    {
      "Time_Start": 2824.7200000000003,
      "Time_End": 2825.84,
      "Text": " to be able to spot"
    },
    {
      "Time_Start": 2825.84,
      "Time_End": 2827.2000000000003,
      "Text": " what look like phishing URLs,"
    },
    {
      "Time_Start": 2827.2000000000003,
      "Time_End": 2828.56,
      "Text": " but actually if we can use"
    },
    {
      "Time_Start": 2828.7999999999997,
      "Time_End": 2830.32,
      "Text": " a valid OctaTenant,"
    },
    {
      "Time_Start": 2830.32,
      "Time_End": 2831.7599999999998,
      "Text": " a valid OneLoginTenant,"
    },
    {
      "Time_Start": 2831.7599999999998,
      "Time_End": 2833.36,
      "Text": " a valid PingTenant,"
    },
    {
      "Time_Start": 2834.32,
      "Time_End": 2835.44,
      "Text": " we're more likely to actually"
    },
    {
      "Time_Start": 2835.44,
      "Time_End": 2837.12,
      "Text": " have a user entering their credentials."
    },
    {
      "Time_Start": 2839.36,
      "Time_End": 2840.4,
      "Text": " Some things to be aware of,"
    },
    {
      "Time_Start": 2840.4,
      "Time_End": 2841.68,
      "Text": " so MFA does get in the way"
    },
    {
      "Time_Start": 2841.68,
      "Time_End": 2842.64,
      "Text": " of this particular attack"
    },
    {
      "Time_Start": 2842.64,
      "Time_End": 2843.6,
      "Text": " that I'll show in a minute."
    },
    {
      "Time_Start": 2843.6,
      "Time_End": 2846.24,
      "Text": " So if the MFA has been kind of deployed,"
    },
    {
      "Time_Start": 2846.24,
      "Time_End": 2847.36,
      "Text": " there are ways around this."
    },
    {
      "Time_Start": 2848.48,
      "Time_End": 2849.2,
      "Text": " This works very well"
    },
    {
      "Time_Start": 2849.2,
      "Time_End": 2850.72,
      "Text": " for gathering usernames and passwords."
    },
    {
      "Time_Start": 2851.68,
      "Time_End": 2853.92,
      "Text": " We can sometimes trigger MFA,"
    },
    {
      "Time_Start": 2853.92,
      "Time_End": 2856.0,
      "Text": " push requests at the same time"
    },
    {
      "Time_Start": 2856.0,
      "Time_End": 2857.2,
      "Text": " when we're gathering credentials"
    },
    {
      "Time_Start": 2857.76,
      "Time_End": 2859.2000000000003,
      "Text": " just to simulate that user flow"
    },
    {
      "Time_Start": 2859.2000000000003,
      "Time_End": 2862.0000000000005,
      "Text": " and actually start to gather valid sessions."
    },
    {
      "Time_Start": 2862.0000000000005,
      "Time_End": 2864.1600000000003,
      "Text": " But yeah, MFA will kind of"
    },
    {
      "Time_Start": 2864.1600000000003,
      "Time_End": 2865.2000000000003,
      "Text": " get in the way of this attack."
    },
    {
      "Time_Start": 2865.84,
      "Time_End": 2867.44,
      "Text": " The provider definitely does not approve"
    },
    {
      "Time_Start": 2867.44,
      "Time_End": 2868.8,
      "Text": " of anybody doing this."
    },
    {
      "Time_Start": 2869.6000000000004,
      "Time_End": 2872.0800000000004,
      "Text": " So just always kind of be wary of that."
    },
    {
      "Time_Start": 2872.0800000000004,
      "Time_End": 2873.1200000000003,
      "Text": " People do do this,"
    },
    {
      "Time_Start": 2874.0000000000005,
      "Time_End": 2876.2400000000002,
      "Text": " but providers probably, yeah,"
    },
    {
      "Time_Start": 2876.2400000000002,
      "Time_End": 2877.5200000000004,
      "Text": " don't want you doing anything like this."
    },
    {
      "Time_Start": 2878.2400000000002,
      "Time_End": 2879.76,
      "Text": " So yeah, shout out to Luke"
    },
    {
      "Time_Start": 2879.76,
      "Time_End": 2881.44,
      "Text": " who gave a talk earlier on today."
    },
    {
      "Time_Start": 2881.44,
      "Time_End": 2885.84,
      "Text": " So Luke actually published a blog post"
    },
    {
      "Time_Start": 2885.84,
      "Time_End": 2886.96,
      "Text": " called OctoJacking,"
    },
    {
      "Time_Start": 2886.96,
      "Time_End": 2888.4,
      "Text": " which is exactly this technique."
    },
    {
      "Time_Start": 2889.1200000000003,
      "Time_End": 2890.32,
      "Text": " He goes into some detail there"
    },
    {
      "Time_Start": 2890.32,
      "Time_End": 2891.6800000000003,
      "Text": " as to actually how you can perform"
    },
    {
      "Time_Start": 2891.6800000000003,
      "Time_End": 2892.96,
      "Text": " this technique as well."
    },
    {
      "Time_Start": 2892.96,
      "Time_End": 2894.08,
      "Text": " But essentially what we're doing"
    },
    {
      "Time_Start": 2894.08,
      "Time_End": 2895.52,
      "Text": " is we're using the agent connector"
    },
    {
      "Time_Start": 2895.52,
      "Time_End": 2896.96,
      "Text": " to be able to gather credentials."
    },
    {
      "Time_Start": 2898.7200000000003,
      "Time_End": 2900.96,
      "Text": " So I will show a quick demo"
    },
    {
      "Time_Start": 2900.96,
      "Time_End": 2902.0,
      "Text": " so you can see what I mean."
    },
    {
      "Time_Start": 2902.0,
      "Time_End": 2903.6000000000004,
      "Text": " So again, similar to"
    },
    {
      "Time_Start": 2904.2400000000002,
      "Time_End": 2905.36,
      "Text": " what we were showing earlier on,"
    },
    {
      "Time_Start": 2905.36,
      "Time_End": 2906.48,
      "Text": " where we've kind of mocked out"
    },
    {
      "Time_Start": 2906.48,
      "Time_End": 2907.6800000000003,
      "Text": " the communication that happens"
    },
    {
      "Time_Start": 2907.6800000000003,
      "Time_End": 2910.7200000000003,
      "Text": " between the agent and the provider,"
    },
    {
      "Time_Start": 2910.7200000000003,
      "Time_End": 2912.1600000000003,
      "Text": " we can actually use that"
    },
    {
      "Time_Start": 2912.1600000000003,
      "Time_End": 2914.0,
      "Text": " to surface up credentials"
    },
    {
      "Time_Start": 2914.0,
      "Time_End": 2915.28,
      "Text": " as we start to phish users."
    },
    {
      "Time_Start": 2916.56,
      "Time_End": 2917.44,
      "Text": " So in this example,"
    },
    {
      "Time_Start": 2917.44,
      "Time_End": 2918.88,
      "Text": " we're using Ping."
    },
    {
      "Time_Start": 2919.52,
      "Time_End": 2921.44,
      "Text": " And in Ping, what we've done"
    },
    {
      "Time_Start": 2921.44,
      "Time_End": 2923.1200000000003,
      "Text": " is we've connected up an agent."
    },
    {
      "Time_Start": 2923.84,
      "Time_End": 2925.36,
      "Text": " We've registered a tenant"
    },
    {
      "Time_Start": 2925.36,
      "Time_End": 2926.1600000000003,
      "Text": " that we control."
    },
    {
      "Time_Start": 2926.7200000000003,
      "Time_End": 2928.0,
      "Text": " And if we send this out"
    },
    {
      "Time_Start": 2928.0,
      "Time_End": 2929.36,
      "Text": " via email to users,"
    },
    {
      "Time_Start": 2929.36,
      "Time_End": 2930.56,
      "Text": " ultimately what we're looking to do"
    },
    {
      "Time_Start": 2930.56,
      "Time_End": 2931.76,
      "Text": " is to have them enter in"
    },
    {
      "Time_Start": 2931.76,
      "Time_End": 2932.88,
      "Text": " usernames and passwords."
    },
    {
      "Time_Start": 2934.0,
      "Time_End": 2935.92,
      "Text": " So if we let this play through."
    },
    {
      "Time_Start": 2940.8,
      "Time_End": 2942.08,
      "Text": " So we see, you know,"
    },
    {
      "Time_Start": 2942.08,
      "Time_End": 2943.36,
      "Text": " on the right, we might have a target"
    },
    {
      "Time_Start": 2943.36,
      "Time_End": 2943.84,
      "Text": " that goes in"
    },
    {
      "Time_Start": 2943.84,
      "Time_End": 2945.28,
      "Text": " and actually enters in credentials."
    },
    {
      "Time_Start": 2946.7200000000003,
      "Time_End": 2947.76,
      "Text": " And on the left,"
    },
    {
      "Time_Start": 2947.76,
      "Time_End": 2949.28,
      "Text": " what we have is gathered credentials"
    },
    {
      "Time_Start": 2949.28,
      "Time_End": 2950.2400000000002,
      "Text": " that we may, you know,"
    },
    {
      "Time_Start": 2950.2400000000002,
      "Time_End": 2952.1600000000003,
      "Text": " retrieve as part of a phishing campaign."
    },
    {
      "Time_Start": 2952.1600000000003,
      "Time_End": 2954.88,
      "Text": " So using identity providers"
    },
    {
      "Time_Start": 2954.88,
      "Time_End": 2956.08,
      "Text": " actually for phishing campaigns"
    },
    {
      "Time_Start": 2956.88,
      "Time_End": 2959.04,
      "Text": " can be quite effective, I believe."
    },
    {
      "Time_Start": 2960.2400000000002,
      "Time_End": 2961.44,
      "Text": " So obviously your mileage may vary,"
    },
    {
      "Time_Start": 2961.44,
      "Time_End": 2963.04,
      "Text": " but ultimately this provides"
    },
    {
      "Time_Start": 2963.04,
      "Time_End": 2964.96,
      "Text": " a valid URL, a valid tenant"
    },
    {
      "Time_Start": 2964.96,
      "Time_End": 2965.84,
      "Text": " that you can then go on"
    },
    {
      "Time_Start": 2965.84,
      "Time_End": 2967.52,
      "Text": " and send to potential targets"
    },
    {
      "Time_Start": 2967.52,
      "Time_End": 2968.56,
      "Text": " and have them authenticate"
    },
    {
      "Time_Start": 2968.56,
      "Time_End": 2969.76,
      "Text": " and ultimately start"
    },
    {
      "Time_Start": 2969.76,
      "Time_End": 2970.7200000000003,
      "Text": " to gather credentials."
    },
    {
      "Time_Start": 2974.0,
      "Time_End": 2974.96,
      "Text": " So the last thing I wanted"
    },
    {
      "Time_Start": 2974.96,
      "Time_End": 2976.08,
      "Text": " to talk about, we're running"
    },
    {
      "Time_Start": 2976.08,
      "Time_End": 2977.2,
      "Text": " a little bit over time,"
    },
    {
      "Time_Start": 2977.2,
      "Time_End": 2978.96,
      "Text": " is Autofastpass."
    },
    {
      "Time_Start": 2978.96,
      "Time_End": 2979.84,
      "Text": " So this is something that I wanted"
    },
    {
      "Time_Start": 2979.84,
      "Time_End": 2980.7200000000003,
      "Text": " to throw in at the end"
    },
    {
      "Time_Start": 2980.7200000000003,
      "Time_End": 2982.08,
      "Text": " because there's a couple of examples"
    },
    {
      "Time_Start": 2982.08,
      "Time_End": 2984.0,
      "Text": " where identity providers"
    },
    {
      "Time_Start": 2984.0,
      "Time_End": 2984.96,
      "Text": " have actually tried to"
    },
    {
      "Time_Start": 2986.96,
      "Time_End": 2988.64,
      "Text": " provide some usability to users"
    },
    {
      "Time_Start": 2988.64,
      "Time_End": 2989.68,
      "Text": " to stop them from having"
    },
    {
      "Time_Start": 2989.68,
      "Time_End": 2991.44,
      "Text": " to do the whole, you know,"
    },
    {
      "Time_Start": 2991.44,
      "Time_End": 2992.7200000000003,
      "Text": " push authentication,"
    },
    {
      "Time_Start": 2992.7200000000003,
      "Time_End": 2994.08,
      "Text": " entering username, password"
    },
    {
      "Time_Start": 2994.08,
      "Time_End": 2994.64,
      "Text": " kind of dance."
    },
    {
      "Time_Start": 2994.64,
      "Time_End": 2995.52,
      "Text": " They want to make life"
    },
    {
      "Time_Start": 2995.52,
      "Time_End": 2997.12,
      "Text": " a little bit easier for users."
    },
    {
      "Time_Start": 2997.12,
      "Time_End": 2998.4,
      "Text": " And so Autofastpass is actually"
    },
    {
      "Time_Start": 2998.4,
      "Time_End": 2999.36,
      "Text": " one of those technologies"
    },
    {
      "Time_Start": 2999.36,
      "Time_End": 3000.2400000000002,
      "Text": " that we've come across."
    },
    {
      "Time_Start": 3001.36,
      "Time_End": 3002.4,
      "Text": " One of the scenarios"
    },
    {
      "Time_Start": 3002.96,
      "Time_End": 3004.56,
      "Text": " which makes this quite interesting"
    },
    {
      "Time_Start": 3004.72,
      "Time_End": 3005.7599999999998,
      "Text": " is on operating systems"
    },
    {
      "Time_Start": 3005.7599999999998,
      "Time_End": 3006.72,
      "Text": " such as macOS,"
    },
    {
      "Time_Start": 3007.68,
      "Time_End": 3008.48,
      "Text": " there are protections"
    },
    {
      "Time_Start": 3008.48,
      "Time_End": 3009.68,
      "Text": " that macOS will give you"
    },
    {
      "Time_Start": 3011.2799999999997,
      "Time_End": 3013.12,
      "Text": " to avoid an attacker"
    },
    {
      "Time_Start": 3013.12,
      "Time_End": 3014.32,
      "Text": " who's compromised an endpoint"
    },
    {
      "Time_Start": 3014.32,
      "Time_End": 3014.96,
      "Text": " from doing things like"
    },
    {
      "Time_Start": 3014.96,
      "Time_End": 3016.16,
      "Text": " dumping out session cookies"
    },
    {
      "Time_Start": 3016.72,
      "Time_End": 3017.6,
      "Text": " that a user may,"
    },
    {
      "Time_Start": 3017.6,
      "Time_End": 3018.4,
      "Text": " you know, that an attacker"
    },
    {
      "Time_Start": 3018.4,
      "Time_End": 3019.2799999999997,
      "Text": " may be using to be able"
    },
    {
      "Time_Start": 3019.2799999999997,
      "Time_End": 3020.48,
      "Text": " to go on and actually"
    },
    {
      "Time_Start": 3020.48,
      "Time_End": 3021.68,
      "Text": " write sessions to access"
    },
    {
      "Time_Start": 3021.68,
      "Time_End": 3022.72,
      "Text": " identity providers."
    },
    {
      "Time_Start": 3023.7599999999998,
      "Time_End": 3025.2799999999997,
      "Text": " In the case of Autofastpass,"
    },
    {
      "Time_Start": 3025.84,
      "Time_End": 3026.72,
      "Text": " what we found is actually"
    },
    {
      "Time_Start": 3026.72,
      "Time_End": 3028.08,
      "Text": " there's an agent that's running"
    },
    {
      "Time_Start": 3028.08,
      "Time_End": 3029.2,
      "Text": " and when this is deployed"
    },
    {
      "Time_Start": 3029.2,
      "Time_End": 3030.88,
      "Text": " and it listens on a HTTP port"
    },
    {
      "Time_Start": 3031.68,
      "Time_End": 3032.72,
      "Text": " and when the user tries"
    },
    {
      "Time_Start": 3032.72,
      "Time_End": 3034.0,
      "Text": " to authenticate to Okta,"
    },
    {
      "Time_Start": 3034.56,
      "Time_End": 3035.68,
      "Text": " there's a local request"
    },
    {
      "Time_Start": 3035.68,
      "Time_End": 3037.2,
      "Text": " that's made to check, first of all,"
    },
    {
      "Time_Start": 3037.2,
      "Time_End": 3037.84,
      "Text": " whether the agent"
    },
    {
      "Time_Start": 3037.84,
      "Time_End": 3038.96,
      "Text": " is actually running."
    },
    {
      "Time_Start": 3038.96,
      "Time_End": 3040.08,
      "Text": " And second of all,"
    },
    {
      "Time_Start": 3040.08,
      "Time_End": 3041.2799999999997,
      "Text": " if the agent is actually running"
    },
    {
      "Time_Start": 3041.2799999999997,
      "Time_End": 3043.7599999999998,
      "Text": " to perform a negotiation"
    },
    {
      "Time_Start": 3043.7599999999998,
      "Time_End": 3044.64,
      "Text": " with the agent,"
    },
    {
      "Time_Start": 3044.64,
      "Time_End": 3046.08,
      "Text": " to actually have it verify"
    },
    {
      "Time_Start": 3046.08,
      "Time_End": 3047.52,
      "Text": " that the user is there and present"
    },
    {
      "Time_Start": 3047.52,
      "Time_End": 3048.96,
      "Text": " and accepts the request"
    },
    {
      "Time_Start": 3048.96,
      "Time_End": 3050.0,
      "Text": " to log into Okta."
    },
    {
      "Time_Start": 3050.96,
      "Time_End": 3051.7599999999998,
      "Text": " And then if the user"
    },
    {
      "Time_Start": 3051.7599999999998,
      "Time_End": 3052.64,
      "Text": " accepts the request,"
    },
    {
      "Time_Start": 3053.36,
      "Time_End": 3054.24,
      "Text": " the browser then,"
    },
    {
      "Time_Start": 3054.24,
      "Time_End": 3056.16,
      "Text": " you know, kind of continues on"
    },
    {
      "Time_Start": 3056.16,
      "Time_End": 3057.04,
      "Text": " and gains access"
    },
    {
      "Time_Start": 3057.04,
      "Time_End": 3058.4,
      "Text": " to the Okta portal itself."
    },
    {
      "Time_Start": 3058.4,
      "Time_End": 3059.68,
      "Text": " So I'll go into this"
    },
    {
      "Time_Start": 3059.68,
      "Time_End": 3060.7999999999997,
      "Text": " in a little bit more detail."
    },
    {
      "Time_Start": 3062.4,
      "Time_End": 3063.92,
      "Text": " So this is kind of the flow"
    },
    {
      "Time_Start": 3063.92,
      "Time_End": 3064.56,
      "Text": " that you would see."
    },
    {
      "Time_Start": 3064.56,
      "Time_End": 3066.7200000000003,
      "Text": " So the user would go into Okta,"
    },
    {
      "Time_Start": 3066.7200000000003,
      "Time_End": 3067.52,
      "Text": " they would click, you know,"
    },
    {
      "Time_Start": 3067.52,
      "Time_End": 3069.2000000000003,
      "Text": " log in as Autofastpass"
    },
    {
      "Time_Start": 3070.4,
      "Time_End": 3071.52,
      "Text": " and they will get a prompt like this"
    },
    {
      "Time_Start": 3071.52,
      "Time_End": 3072.64,
      "Text": " and the prompts will say,"
    },
    {
      "Time_Start": 3072.64,
      "Time_End": 3073.6800000000003,
      "Text": " you know, do you accept"
    },
    {
      "Time_Start": 3073.6800000000003,
      "Time_End": 3075.36,
      "Text": " that you want to log into Okta?"
    },
    {
      "Time_Start": 3075.36,
      "Time_End": 3076.2400000000002,
      "Text": " Yes or no."
    },
    {
      "Time_Start": 3076.2400000000002,
      "Time_End": 3077.36,
      "Text": " And the user either approves"
    },
    {
      "Time_Start": 3077.36,
      "Time_End": 3078.08,
      "Text": " or denies that."
    },
    {
      "Time_Start": 3080.48,
      "Time_End": 3081.44,
      "Text": " From how this works"
    },
    {
      "Time_Start": 3081.44,
      "Time_End": 3082.64,
      "Text": " from a browser perspective,"
    },
    {
      "Time_Start": 3082.64,
      "Time_End": 3085.76,
      "Text": " so yeah, ultimately"
    },
    {
      "Time_Start": 3085.76,
      "Time_End": 3086.4,
      "Text": " what happens is"
    },
    {
      "Time_Start": 3086.4,
      "Time_End": 3088.96,
      "Text": " you will navigate to, say, Okta."
    },
    {
      "Time_Start": 3089.92,
      "Time_End": 3090.88,
      "Text": " The user will make a request"
    },
    {
      "Time_Start": 3090.88,
      "Time_End": 3091.6800000000003,
      "Text": " to Okta to say that"
    },
    {
      "Time_Start": 3091.6800000000003,
      "Time_End": 3093.12,
      "Text": " you want to authenticate as the user."
    },
    {
      "Time_Start": 3094.16,
      "Time_End": 3094.96,
      "Text": " Then what happens is"
    },
    {
      "Time_Start": 3094.96,
      "Time_End": 3095.76,
      "Text": " there's a local request"
    },
    {
      "Time_Start": 3095.76,
      "Time_End": 3096.7200000000003,
      "Text": " made from Okta"
    },
    {
      "Time_Start": 3096.7200000000003,
      "Time_End": 3098.0,
      "Text": " into a local host port,"
    },
    {
      "Time_Start": 3098.0,
      "Time_End": 3098.7200000000003,
      "Text": " which is actually where"
    },
    {
      "Time_Start": 3098.7200000000003,
      "Time_End": 3099.92,
      "Text": " the Autofastpass client"
    },
    {
      "Time_Start": 3099.92,
      "Time_End": 3100.64,
      "Text": " is actually running."
    },
    {
      "Time_Start": 3101.52,
      "Time_End": 3102.56,
      "Text": " The browser then enters"
    },
    {
      "Time_Start": 3102.56,
      "Time_End": 3103.52,
      "Text": " into a polling state"
    },
    {
      "Time_Start": 3103.52,
      "Time_End": 3104.32,
      "Text": " so it will constantly"
    },
    {
      "Time_Start": 3104.32,
      "Time_End": 3105.6800000000003,
      "Text": " poll against Okta to say,"
    },
    {
      "Time_Start": 3105.6800000000003,
      "Time_End": 3106.7200000000003,
      "Text": " you know, has the user"
    },
    {
      "Time_Start": 3106.7200000000003,
      "Time_End": 3107.6800000000003,
      "Text": " accepted this request yet?"
    },
    {
      "Time_Start": 3107.6800000000003,
      "Time_End": 3108.56,
      "Text": " Has the user accepted"
    },
    {
      "Time_Start": 3108.56,
      "Time_End": 3109.28,
      "Text": " this request yet?"
    },
    {
      "Time_Start": 3109.28,
      "Time_End": 3110.96,
      "Text": " And when the user accepts"
    },
    {
      "Time_Start": 3110.96,
      "Time_End": 3112.08,
      "Text": " the request,"
    },
    {
      "Time_Start": 3112.08,
      "Time_End": 3113.92,
      "Text": " there's a JWT that's forwarded on"
    },
    {
      "Time_Start": 3113.92,
      "Time_End": 3115.44,
      "Text": " from the Autofastpass client"
    },
    {
      "Time_Start": 3115.44,
      "Time_End": 3117.04,
      "Text": " using a back channel up to Okta."
    },
    {
      "Time_Start": 3117.76,
      "Time_End": 3118.7200000000003,
      "Text": " And if the user accepts it,"
    },
    {
      "Time_Start": 3118.7200000000003,
      "Time_End": 3120.16,
      "Text": " then ultimately access is granted."
    },
    {
      "Time_Start": 3121.52,
      "Time_End": 3122.2400000000002,
      "Text": " What we actually found"
    },
    {
      "Time_Start": 3122.2400000000002,
      "Time_End": 3123.04,
      "Text": " is that if you compromise"
    },
    {
      "Time_Start": 3123.04,
      "Time_End": 3124.56,
      "Text": " the endpoint itself,"
    },
    {
      "Time_Start": 3124.56,
      "Time_End": 3125.36,
      "Text": " we can actually use this"
    },
    {
      "Time_Start": 3125.36,
      "Time_End": 3126.16,
      "Text": " to our advantage"
    },
    {
      "Time_Start": 3127.84,
      "Time_End": 3128.96,
      "Text": " to actually proxy"
    },
    {
      "Time_Start": 3128.96,
      "Time_End": 3131.2799999999997,
      "Text": " the communication between Okta"
    },
    {
      "Time_Start": 3131.2799999999997,
      "Time_End": 3132.88,
      "Text": " and the Fastpass agent"
    },
    {
      "Time_Start": 3132.88,
      "Time_End": 3134.08,
      "Text": " itself and the browser."
    },
    {
      "Time_Start": 3134.08,
      "Time_End": 3135.36,
      "Text": " So in this particular scenario,"
    },
    {
      "Time_Start": 3135.36,
      "Time_End": 3136.24,
      "Text": " we may have compromised,"
    },
    {
      "Time_Start": 3136.24,
      "Time_End": 3137.12,
      "Text": " say, a MacBook."
    },
    {
      "Time_Start": 3137.12,
      "Time_End": 3138.16,
      "Text": " And what we want to do"
    },
    {
      "Time_Start": 3138.16,
      "Time_End": 3140.96,
      "Text": " is we want to essentially"
    },
    {
      "Time_Start": 3140.96,
      "Time_End": 3142.48,
      "Text": " proxy that communication"
    },
    {
      "Time_Start": 3142.48,
      "Time_End": 3143.52,
      "Text": " through Fastpass,"
    },
    {
      "Time_Start": 3143.52,
      "Time_End": 3144.48,
      "Text": " but we don't want to have"
    },
    {
      "Time_Start": 3144.48,
      "Time_End": 3145.52,
      "Text": " any pop-ups that happen"
    },
    {
      "Time_Start": 3145.52,
      "Time_End": 3146.64,
      "Text": " for the user himself."
    },
    {
      "Time_Start": 3147.68,
      "Time_End": 3148.8,
      "Text": " So again, what we'll do"
    },
    {
      "Time_Start": 3148.8,
      "Time_End": 3149.68,
      "Text": " is we'll trigger"
    },
    {
      "Time_Start": 3149.68,
      "Time_End": 3150.8,
      "Text": " the authentication request"
    },
    {
      "Time_Start": 3150.8,
      "Time_End": 3151.84,
      "Text": " off to Okta,"
    },
    {
      "Time_Start": 3151.84,
      "Time_End": 3152.48,
      "Text": " but we'll do that"
    },
    {
      "Time_Start": 3152.48,
      "Time_End": 3153.28,
      "Text": " as an attacker."
    },
    {
      "Time_Start": 3154.32,
      "Time_End": 3155.36,
      "Text": " The authentication request"
    },
    {
      "Time_Start": 3155.36,
      "Time_End": 3156.16,
      "Text": " will come back"
    },
    {
      "Time_Start": 3156.16,
      "Time_End": 3157.2,
      "Text": " to us as an attacker."
    },
    {
      "Time_Start": 3158.16,
      "Time_End": 3158.8,
      "Text": " And then what we'll do"
    },
    {
      "Time_Start": 3158.8,
      "Time_End": 3159.44,
      "Text": " is we'll have a tool"
    },
    {
      "Time_Start": 3159.44,
      "Time_End": 3159.92,
      "Text": " that's running"
    },
    {
      "Time_Start": 3159.92,
      "Time_End": 3161.28,
      "Text": " on the attacker's machine,"
    },
    {
      "Time_Start": 3161.28,
      "Time_End": 3163.36,
      "Text": " which will ultimately proxy"
    },
    {
      "Time_Start": 3163.36,
      "Time_End": 3164.2400000000002,
      "Text": " the request through"
    },
    {
      "Time_Start": 3164.2400000000002,
      "Time_End": 3165.68,
      "Text": " the user's system."
    },
    {
      "Time_Start": 3166.72,
      "Time_End": 3167.6,
      "Text": " And we can perform"
    },
    {
      "Time_Start": 3167.6,
      "Time_End": 3168.8,
      "Text": " a couple of validation checks"
    },
    {
      "Time_Start": 3168.8,
      "Time_End": 3169.84,
      "Text": " to make sure, you know,"
    },
    {
      "Time_Start": 3169.84,
      "Time_End": 3170.56,
      "Text": " that the user is going"
    },
    {
      "Time_Start": 3170.56,
      "Time_End": 3171.6,
      "Text": " to receive a pop-up prompt"
    },
    {
      "Time_Start": 3171.6,
      "Time_End": 3172.88,
      "Text": " or not receive a pop-up prompt."
    },
    {
      "Time_Start": 3173.44,
      "Time_End": 3174.64,
      "Text": " So it probably makes more sense"
    },
    {
      "Time_Start": 3174.64,
      "Time_End": 3175.52,
      "Text": " for me to actually show this"
    },
    {
      "Time_Start": 3175.52,
      "Time_End": 3177.04,
      "Text": " in action so you can understand"
    },
    {
      "Time_Start": 3177.04,
      "Time_End": 3178.56,
      "Text": " kind of how this would work."
    },
    {
      "Time_Start": 3178.56,
      "Time_End": 3179.44,
      "Text": " So let's take a look"
    },
    {
      "Time_Start": 3179.44,
      "Time_End": 3180.72,
      "Text": " at the first example."
    },
    {
      "Time_Start": 3180.72,
      "Time_End": 3181.92,
      "Text": " So in the first example"
    },
    {
      "Time_Start": 3181.92,
      "Time_End": 3182.8,
      "Text": " of Okta FastPass,"
    },
    {
      "Time_Start": 3183.76,
      "Time_End": 3185.2000000000003,
      "Text": " the configuration can be set up."
    },
    {
      "Time_Start": 3185.2000000000003,
      "Time_End": 3186.32,
      "Text": " So you've actually, you know,"
    },
    {
      "Time_Start": 3186.32,
      "Time_End": 3187.92,
      "Text": " you always want to prompt the user"
    },
    {
      "Time_Start": 3188.64,
      "Time_End": 3189.44,
      "Text": " when they're going through"
    },
    {
      "Time_Start": 3189.44,
      "Time_End": 3190.64,
      "Text": " this particular flow to say,"
    },
    {
      "Time_Start": 3190.64,
      "Time_End": 3191.6,
      "Text": " do you want to, you know,"
    },
    {
      "Time_Start": 3191.6,
      "Time_End": 3193.04,
      "Text": " accept or deny"
    },
    {
      "Time_Start": 3193.04,
      "Time_End": 3194.4,
      "Text": " this particular login request?"
    },
    {
      "Time_Start": 3196.64,
      "Time_End": 3198.16,
      "Text": " So if we assume that that's"
    },
    {
      "Time_Start": 3198.16,
      "Time_End": 3199.2000000000003,
      "Text": " how it's been deployed here,"
    },
    {
      "Time_Start": 3199.2000000000003,
      "Time_End": 3199.92,
      "Text": " what we've got here"
    },
    {
      "Time_Start": 3199.92,
      "Time_End": 3201.84,
      "Text": " in the top left-hand corner"
    },
    {
      "Time_Start": 3201.84,
      "Time_End": 3203.76,
      "Text": " is a compromised workstation"
    },
    {
      "Time_Start": 3203.76,
      "Time_End": 3205.2000000000003,
      "Text": " that's running macOS."
    },
    {
      "Time_Start": 3205.2000000000003,
      "Time_End": 3206.08,
      "Text": " At the bottom here,"
    },
    {
      "Time_Start": 3207.04,
      "Time_End": 3207.6,
      "Text": " what we've got"
    },
    {
      "Time_Start": 3207.6,
      "Time_End": 3208.96,
      "Text": " is the attacker's machine"
    },
    {
      "Time_Start": 3208.96,
      "Time_End": 3211.2000000000003,
      "Text": " who's trying to access Okta."
    },
    {
      "Time_Start": 3211.28,
      "Time_End": 3212.2400000000002,
      "Text": " And on the right here,"
    },
    {
      "Time_Start": 3212.2400000000002,
      "Time_End": 3213.6800000000003,
      "Text": " we've got a script"
    },
    {
      "Time_Start": 3213.6800000000003,
      "Time_End": 3215.2000000000003,
      "Text": " which will also be released as well,"
    },
    {
      "Time_Start": 3216.0000000000005,
      "Time_End": 3217.92,
      "Text": " which will allow us just to proxy"
    },
    {
      "Time_Start": 3217.92,
      "Time_End": 3219.76,
      "Text": " that authentication request"
    },
    {
      "Time_Start": 3219.76,
      "Time_End": 3221.2000000000003,
      "Text": " through a SOCKS proxy"
    },
    {
      "Time_Start": 3221.2000000000003,
      "Time_End": 3222.8,
      "Text": " onto the user's"
    },
    {
      "Time_Start": 3223.5200000000004,
      "Time_End": 3224.6400000000003,
      "Text": " kind of workstation."
    },
    {
      "Time_Start": 3224.6400000000003,
      "Time_End": 3226.0000000000005,
      "Text": " And it will also allow us to see"
    },
    {
      "Time_Start": 3226.0000000000005,
      "Time_End": 3226.8,
      "Text": " what's going to happen"
    },
    {
      "Time_Start": 3226.8,
      "Time_End": 3228.0800000000004,
      "Text": " on the user's workstation"
    },
    {
      "Time_Start": 3228.0800000000004,
      "Time_End": 3229.6000000000004,
      "Text": " and then approve or deny that"
    },
    {
      "Time_Start": 3229.6000000000004,
      "Time_End": 3230.6400000000003,
      "Text": " depending on whether we actually"
    },
    {
      "Time_Start": 3230.6400000000003,
      "Time_End": 3231.84,
      "Text": " want to take that risk or not."
    },
    {
      "Time_Start": 3233.28,
      "Time_End": 3236.4,
      "Text": " So let's kick off the script."
    },
    {
      "Time_Start": 3236.4,
      "Time_End": 3237.84,
      "Text": " What we're going to do is here,"
    },
    {
      "Time_Start": 3237.84,
      "Time_End": 3238.8,
      "Text": " we're going to say"
    },
    {
      "Time_Start": 3238.8,
      "Time_End": 3240.32,
      "Text": " we want to log in with FastPass."
    },
    {
      "Time_Start": 3241.84,
      "Time_End": 3243.28,
      "Text": " And what we'll see here"
    },
    {
      "Time_Start": 3243.28,
      "Time_End": 3244.2400000000002,
      "Text": " is that what's happened,"
    },
    {
      "Time_Start": 3244.8,
      "Time_End": 3245.6000000000004,
      "Text": " the browser itself"
    },
    {
      "Time_Start": 3245.6000000000004,
      "Time_End": 3247.36,
      "Text": " has made a local host request."
    },
    {
      "Time_Start": 3247.36,
      "Time_End": 3248.88,
      "Text": " The local host request"
    },
    {
      "Time_Start": 3248.88,
      "Time_End": 3250.0000000000005,
      "Text": " has come through to the script"
    },
    {
      "Time_Start": 3250.0000000000005,
      "Time_End": 3251.44,
      "Text": " that's running on the attacker's machine."
    },
    {
      "Time_Start": 3252.0000000000005,
      "Time_End": 3252.7200000000003,
      "Text": " And we can see here"
    },
    {
      "Time_Start": 3252.7200000000003,
      "Time_End": 3254.4800000000005,
      "Text": " that this is not going to pop up anything."
    },
    {
      "Time_Start": 3254.4800000000005,
      "Time_End": 3256.1600000000003,
      "Text": " There's no challenges that are present"
    },
    {
      "Time_Start": 3256.1600000000003,
      "Time_End": 3257.28,
      "Text": " and the user's not going to receive"
    },
    {
      "Time_Start": 3257.28,
      "Time_End": 3258.4,
      "Text": " any kind of notification."
    },
    {
      "Time_Start": 3259.36,
      "Time_End": 3260.88,
      "Text": " It gives us the option to continue,"
    },
    {
      "Time_Start": 3260.88,
      "Time_End": 3262.32,
      "Text": " which will hit enter to continue."
    },
    {
      "Time_Start": 3262.9600000000005,
      "Time_End": 3263.92,
      "Text": " And this gets forwarded"
    },
    {
      "Time_Start": 3263.92,
      "Time_End": 3266.2400000000002,
      "Text": " through to the user's workstation."
    },
    {
      "Time_Start": 3268.0000000000005,
      "Time_End": 3269.6800000000003,
      "Text": " We also receive a second request"
    },
    {
      "Time_Start": 3269.6800000000003,
      "Time_End": 3270.5600000000004,
      "Text": " from the browser"
    },
    {
      "Time_Start": 3270.56,
      "Time_End": 3271.84,
      "Text": " and the request from the browser,"
    },
    {
      "Time_Start": 3271.84,
      "Time_End": 3273.44,
      "Text": " again, is making another request"
    },
    {
      "Time_Start": 3273.44,
      "Time_End": 3274.48,
      "Text": " off to FastPass,"
    },
    {
      "Time_Start": 3274.48,
      "Time_End": 3275.52,
      "Text": " which we've intercepted."
    },
    {
      "Time_Start": 3276.32,
      "Time_End": 3276.7999999999997,
      "Text": " At this time,"
    },
    {
      "Time_Start": 3276.7999999999997,
      "Time_End": 3277.52,
      "Text": " what it's going to say"
    },
    {
      "Time_Start": 3277.52,
      "Time_End": 3278.7999999999997,
      "Text": " is that actually a validation"
    },
    {
      "Time_Start": 3279.6,
      "Time_End": 3280.72,
      "Text": " request is present."
    },
    {
      "Time_Start": 3280.72,
      "Time_End": 3282.96,
      "Text": " So the user is going to receive a pop-up."
    },
    {
      "Time_Start": 3282.96,
      "Time_End": 3284.32,
      "Text": " Again, this allows us to prep"
    },
    {
      "Time_Start": 3284.32,
      "Time_End": 3285.44,
      "Text": " kind of as an attacker to say,"
    },
    {
      "Time_Start": 3285.44,
      "Time_End": 3286.96,
      "Text": " do we want to go through with this?"
    },
    {
      "Time_Start": 3286.96,
      "Time_End": 3288.0,
      "Text": " Do we want the user actually"
    },
    {
      "Time_Start": 3288.0,
      "Time_End": 3289.2799999999997,
      "Text": " to see the pop-up or not?"
    },
    {
      "Time_Start": 3289.2799999999997,
      "Time_End": 3290.88,
      "Text": " Or do we want to back out of this now?"
    },
    {
      "Time_Start": 3291.52,
      "Time_End": 3293.44,
      "Text": " So just for the sake of demonstration,"
    },
    {
      "Time_Start": 3293.44,
      "Time_End": 3293.92,
      "Text": " what we'll do is"
    },
    {
      "Time_Start": 3293.92,
      "Time_End": 3295.12,
      "Text": " we'll just allow that through"
    },
    {
      "Time_Start": 3295.12,
      "Time_End": 3296.16,
      "Text": " and we can see that ultimately"
    },
    {
      "Time_Start": 3296.16,
      "Time_End": 3297.7599999999998,
      "Text": " the pop-up is presented to the user."
    },
    {
      "Time_Start": 3298.4,
      "Time_End": 3299.6,
      "Text": " Sometimes you might want to,"
    },
    {
      "Time_Start": 3299.6,
      "Time_End": 3301.2,
      "Text": " you know, kind of pop up a browser"
    },
    {
      "Time_Start": 3301.2,
      "Time_End": 3302.3199999999997,
      "Text": " that's logging into WhatsApp"
    },
    {
      "Time_Start": 3302.3199999999997,
      "Time_End": 3302.96,
      "Text": " at the same time"
    },
    {
      "Time_Start": 3302.96,
      "Time_End": 3304.96,
      "Text": " and kind of use a bit of social engineering"
    },
    {
      "Time_Start": 3304.96,
      "Time_End": 3306.08,
      "Text": " to allow this through."
    },
    {
      "Time_Start": 3306.08,
      "Time_End": 3307.2,
      "Text": " But ultimately, as an attacker,"
    },
    {
      "Time_Start": 3307.2,
      "Time_End": 3308.08,
      "Text": " it allows us to see"
    },
    {
      "Time_Start": 3308.08,
      "Time_End": 3308.72,
      "Text": " what's going to happen"
    },
    {
      "Time_Start": 3308.72,
      "Time_End": 3309.8399999999997,
      "Text": " on the user's workstation"
    },
    {
      "Time_Start": 3310.56,
      "Time_End": 3312.08,
      "Text": " before we allow that pop-up"
    },
    {
      "Time_Start": 3312.08,
      "Time_End": 3313.2799999999997,
      "Text": " to kind of continue."
    },
    {
      "Time_Start": 3315.92,
      "Time_End": 3317.2799999999997,
      "Text": " What's more concerning, however,"
    },
    {
      "Time_Start": 3317.2799999999997,
      "Time_End": 3319.44,
      "Text": " is we've seen organizations"
    },
    {
      "Time_Start": 3319.44,
      "Time_End": 3321.2799999999997,
      "Text": " that don't require user authentication,"
    },
    {
      "Time_Start": 3321.2799999999997,
      "Time_End": 3322.64,
      "Text": " so user interaction"
    },
    {
      "Time_Start": 3322.64,
      "Time_End": 3323.8399999999997,
      "Text": " when this pop-up exists."
    },
    {
      "Time_Start": 3325.2799999999997,
      "Time_End": 3326.72,
      "Text": " So in these particular scenarios,"
    },
    {
      "Time_Start": 3326.72,
      "Time_End": 3327.8399999999997,
      "Text": " you may have developers"
    },
    {
      "Time_Start": 3327.84,
      "Time_End": 3329.84,
      "Text": " who have Okta Fastpass deployed,"
    },
    {
      "Time_Start": 3329.84,
      "Time_End": 3330.8,
      "Text": " but actually what they'll have"
    },
    {
      "Time_Start": 3330.8,
      "Time_End": 3331.92,
      "Text": " is their laptop closed"
    },
    {
      "Time_Start": 3331.92,
      "Time_End": 3332.96,
      "Text": " and kind of tucked away."
    },
    {
      "Time_Start": 3333.84,
      "Time_End": 3335.44,
      "Text": " They don't have access to Touch ID"
    },
    {
      "Time_Start": 3335.44,
      "Time_End": 3336.48,
      "Text": " or whatever it may be."
    },
    {
      "Time_Start": 3337.6800000000003,
      "Time_End": 3339.1200000000003,
      "Text": " So actually, it's enough"
    },
    {
      "Time_Start": 3339.1200000000003,
      "Time_End": 3340.48,
      "Text": " to be running the agent itself."
    },
    {
      "Time_Start": 3340.48,
      "Time_End": 3341.6000000000004,
      "Text": " And we have seen this"
    },
    {
      "Time_Start": 3341.6000000000004,
      "Time_End": 3343.2000000000003,
      "Text": " within client environments as well."
    },
    {
      "Time_Start": 3344.08,
      "Time_End": 3346.08,
      "Text": " So in this particular scenario,"
    },
    {
      "Time_Start": 3346.08,
      "Time_End": 3349.2000000000003,
      "Text": " we'll perform the exact same technique."
    },
    {
      "Time_Start": 3349.92,
      "Time_End": 3351.28,
      "Text": " We're going to go through as an attacker."
    },
    {
      "Time_Start": 3351.28,
      "Time_End": 3353.2000000000003,
      "Text": " We're going to attempt to log into Okta."
    },
    {
      "Time_Start": 3354.1600000000003,
      "Time_End": 3355.52,
      "Text": " We're running the local script,"
    },
    {
      "Time_Start": 3355.52,
      "Time_End": 3356.4,
      "Text": " which is going to emulate"
    },
    {
      "Time_Start": 3356.4,
      "Time_End": 3358.96,
      "Text": " the Okta Fastpass kind of communication"
    },
    {
      "Time_Start": 3358.96,
      "Time_End": 3359.6800000000003,
      "Text": " with the browser."
    },
    {
      "Time_Start": 3361.2000000000003,
      "Time_End": 3362.32,
      "Text": " And just to stop it there,"
    },
    {
      "Time_Start": 3362.32,
      "Time_End": 3363.12,
      "Text": " what we see here"
    },
    {
      "Time_Start": 3363.12,
      "Time_End": 3364.64,
      "Text": " in this particular instance is, again,"
    },
    {
      "Time_Start": 3364.64,
      "Time_End": 3365.28,
      "Text": " we're going to be told"
    },
    {
      "Time_Start": 3365.28,
      "Time_End": 3366.48,
      "Text": " that no challenges are present"
    },
    {
      "Time_Start": 3366.48,
      "Time_End": 3367.44,
      "Text": " if we forward this through"
    },
    {
      "Time_Start": 3367.44,
      "Time_End": 3369.28,
      "Text": " to the actual workstation itself"
    },
    {
      "Time_Start": 3369.28,
      "Time_End": 3370.0,
      "Text": " as the attacker."
    },
    {
      "Time_Start": 3370.56,
      "Time_End": 3372.32,
      "Text": " And it gives us the option to continue."
    },
    {
      "Time_Start": 3372.32,
      "Time_End": 3373.36,
      "Text": " And if we continue on,"
    },
    {
      "Time_Start": 3374.56,
      "Time_End": 3376.64,
      "Text": " what we'll see here at the bottom"
    },
    {
      "Time_Start": 3376.64,
      "Time_End": 3377.76,
      "Text": " is that the user,"
    },
    {
      "Time_Start": 3377.76,
      "Time_End": 3379.84,
      "Text": " so just to back up a little bit there,"
    },
    {
      "Time_Start": 3379.84,
      "Time_End": 3380.8,
      "Text": " we can approve this"
    },
    {
      "Time_Start": 3380.8,
      "Time_End": 3382.64,
      "Text": " and the Okta session can continue."
    },
    {
      "Time_Start": 3382.64,
      "Time_End": 3383.76,
      "Text": " Even though we forwarded this"
    },
    {
      "Time_Start": 3383.76,
      "Time_End": 3385.52,
      "Text": " through to the compromised endpoint,"
    },
    {
      "Time_Start": 3385.52,
      "Time_End": 3387.36,
      "Text": " we know that no pop-up is going to be present"
    },
    {
      "Time_Start": 3387.36,
      "Time_End": 3389.2,
      "Text": " because essentially we've intercepted that"
    },
    {
      "Time_Start": 3389.2,
      "Time_End": 3390.64,
      "Text": " and we can see whether it would have popped up"
    },
    {
      "Time_Start": 3390.64,
      "Time_End": 3391.84,
      "Text": " something for the user or not."
    },
    {
      "Time_Start": 3394.56,
      "Time_End": 3397.92,
      "Text": " OK, so that's the bulk of the talk kind of done."
    },
    {
      "Time_Start": 3397.92,
      "Time_End": 3398.96,
      "Text": " So very quickly,"
    },
    {
      "Time_Start": 3398.96,
      "Time_End": 3401.52,
      "Text": " just to run through some testing challenges"
    },
    {
      "Time_Start": 3401.52,
      "Time_End": 3403.44,
      "Text": " that we've kind of experienced in the past."
    },
    {
      "Time_Start": 3404.16,
      "Time_End": 3405.04,
      "Text": " So just to call out"
    },
    {
      "Time_Start": 3406.0,
      "Time_End": 3406.88,
      "Text": " some of the things that we see"
    },
    {
      "Time_Start": 3406.88,
      "Time_End": 3408.64,
      "Text": " when we go on to do this kind of research."
    },
    {
      "Time_Start": 3409.7599999999998,
      "Time_End": 3412.0,
      "Text": " So quite often, we'll meet scenarios"
    },
    {
      "Time_Start": 3412.0,
      "Time_End": 3414.24,
      "Text": " where we can have a valid tenant"
    },
    {
      "Time_Start": 3414.2400000000002,
      "Time_End": 3416.48,
      "Text": " or we can have access to an identity provider"
    },
    {
      "Time_Start": 3416.48,
      "Time_End": 3417.28,
      "Text": " to do research"
    },
    {
      "Time_Start": 3417.28,
      "Time_End": 3418.8,
      "Text": " because sometimes they'll be hidden behind"
    },
    {
      "Time_Start": 3419.5200000000004,
      "Time_End": 3420.8,
      "Text": " kind of like a sales wall"
    },
    {
      "Time_Start": 3420.8,
      "Time_End": 3423.0400000000004,
      "Text": " or call us to kind of start a trial."
    },
    {
      "Time_Start": 3424.4,
      "Time_End": 3426.6400000000003,
      "Text": " So sometimes gaining access to identity providers"
    },
    {
      "Time_Start": 3426.6400000000003,
      "Time_End": 3429.0400000000004,
      "Text": " to perform this kind of research is kind of tough."
    },
    {
      "Time_Start": 3430.0000000000005,
      "Time_End": 3431.1200000000003,
      "Text": " The other thing to call out as well"
    },
    {
      "Time_Start": 3431.1200000000003,
      "Time_End": 3434.32,
      "Text": " is that there are sometimes bug bounty restrictions."
    },
    {
      "Time_Start": 3434.32,
      "Time_End": 3436.2400000000002,
      "Text": " So if you're doing this as part of a bug bounty,"
    },
    {
      "Time_Start": 3437.28,
      "Time_End": 3438.1600000000003,
      "Text": " sometimes what you'll find"
    },
    {
      "Time_Start": 3438.1600000000003,
      "Time_End": 3440.32,
      "Text": " is that there are restrictions on you going forward"
    },
    {
      "Time_Start": 3440.32,
      "Time_End": 3442.2400000000002,
      "Text": " and actually disclosing any issues that you find."
    },
    {
      "Time_Start": 3443.2000000000003,
      "Time_End": 3444.32,
      "Text": " So in this particular case,"
    },
    {
      "Time_Start": 3444.32,
      "Time_End": 3446.1600000000003,
      "Text": " I've had issues with Okta in the past,"
    },
    {
      "Time_Start": 3446.1600000000003,
      "Time_End": 3447.2000000000003,
      "Text": " which I've raised with them."
    },
    {
      "Time_Start": 3447.84,
      "Time_End": 3449.36,
      "Text": " I should say that in terms of Okta"
    },
    {
      "Time_Start": 3449.36,
      "Time_End": 3450.6400000000003,
      "Text": " and the way that they've responded"
    },
    {
      "Time_Start": 3451.36,
      "Time_End": 3454.0000000000005,
      "Text": " to kind of the bug bounties"
    },
    {
      "Time_Start": 3454.0000000000005,
      "Time_End": 3454.88,
      "Text": " that I've submitted through."
    },
    {
      "Time_Start": 3454.88,
      "Time_End": 3456.5600000000004,
      "Text": " We've had a really good experience with them"
    },
    {
      "Time_Start": 3456.5600000000004,
      "Time_End": 3459.2000000000003,
      "Text": " and they've been really quick at kind of fixing issues."
    },
    {
      "Time_Start": 3459.2000000000003,
      "Time_End": 3460.5600000000004,
      "Text": " But ultimately, what it means is that"
    },
    {
      "Time_Start": 3460.5600000000004,
      "Time_End": 3462.88,
      "Text": " if I go through and correspond with a vendor,"
    },
    {
      "Time_Start": 3463.5200000000004,
      "Time_End": 3464.7200000000003,
      "Text": " sometimes I can't actually go"
    },
    {
      "Time_Start": 3464.7200000000003,
      "Time_End": 3466.7200000000003,
      "Text": " and show you what the techniques were"
    },
    {
      "Time_Start": 3466.7200000000003,
      "Time_End": 3469.28,
      "Text": " as to which allowed us to use a vulnerability"
    },
    {
      "Time_Start": 3469.28,
      "Time_End": 3470.4,
      "Text": " to gain privileged access."
    },
    {
      "Time_Start": 3471.36,
      "Time_End": 3472.56,
      "Text": " So that's one thing to bear in mind."
    },
    {
      "Time_Start": 3472.56,
      "Time_End": 3474.0,
      "Text": " If you are doing this kind of research"
    },
    {
      "Time_Start": 3474.64,
      "Time_End": 3476.56,
      "Text": " for clients or for yourselves,"
    },
    {
      "Time_Start": 3477.36,
      "Time_End": 3479.12,
      "Text": " sometimes there are restrictions on bug bounties"
    },
    {
      "Time_Start": 3479.12,
      "Time_End": 3480.88,
      "Text": " when you choose to disclose this to a vendor."
    },
    {
      "Time_Start": 3480.88,
      "Time_End": 3482.1600000000003,
      "Text": " So obviously, you know,"
    },
    {
      "Time_Start": 3482.1600000000003,
      "Time_End": 3483.2000000000003,
      "Text": " it kind of depends on what it is"
    },
    {
      "Time_Start": 3483.2000000000003,
      "Time_End": 3485.36,
      "Text": " that you're looking to do with that knowledge."
    },
    {
      "Time_Start": 3487.12,
      "Time_End": 3488.32,
      "Text": " In terms of recommendations,"
    },
    {
      "Time_Start": 3488.32,
      "Time_End": 3491.12,
      "Text": " so there's not really a whole lot out there at the moment."
    },
    {
      "Time_Start": 3491.12,
      "Time_End": 3493.36,
      "Text": " So Elastica are doing some fantastic work"
    },
    {
      "Time_Start": 3493.36,
      "Time_End": 3494.7200000000003,
      "Text": " on how to prevent some of these attacks"
    },
    {
      "Time_Start": 3494.7200000000003,
      "Time_End": 3495.76,
      "Text": " that we've talked about today."
    },
    {
      "Time_Start": 3497.2000000000003,
      "Time_End": 3498.8,
      "Text": " It seems to be focused more on Okta."
    },
    {
      "Time_Start": 3498.8,
      "Time_End": 3500.88,
      "Text": " So Okta seems to be gaining the most traction"
    },
    {
      "Time_Start": 3500.88,
      "Time_End": 3501.92,
      "Text": " in the Blue Team space."
    },
    {
      "Time_Start": 3503.2000000000003,
      "Time_End": 3505.6800000000003,
      "Text": " Not a whole lot out there for Ping and OneLogin."
    },
    {
      "Time_Start": 3505.6800000000003,
      "Time_End": 3507.6000000000004,
      "Text": " Obviously, there's more out there for Entry ID as well."
    },
    {
      "Time_Start": 3508.6400000000003,
      "Time_End": 3510.1600000000003,
      "Text": " My advice kind of for Blue Team"
    },
    {
      "Time_Start": 3510.1600000000003,
      "Time_End": 3511.92,
      "Text": " looking at kind of defending against this"
    },
    {
      "Time_Start": 3512.7200000000003,
      "Time_End": 3514.6400000000003,
      "Text": " is to set any red team"
    },
    {
      "Time_Start": 3514.6400000000003,
      "Time_End": 3516.8,
      "Text": " as the target of accessing service providers"
    },
    {
      "Time_Start": 3516.8,
      "Time_End": 3519.6800000000003,
      "Text": " that sit beyond your identity provider,"
    },
    {
      "Time_Start": 3519.6800000000003,
      "Time_End": 3521.04,
      "Text": " kind of force them to go through"
    },
    {
      "Time_Start": 3521.6800000000003,
      "Time_End": 3523.52,
      "Text": " kind of these attack scenarios"
    },
    {
      "Time_Start": 3523.52,
      "Time_End": 3525.28,
      "Text": " and kind of be ready to sit there"
    },
    {
      "Time_Start": 3525.28,
      "Time_End": 3526.8,
      "Text": " and kind of watch as they do that"
    },
    {
      "Time_Start": 3526.8,
      "Time_End": 3529.28,
      "Text": " and figure out how they've navigated these environments"
    },
    {
      "Time_Start": 3529.92,
      "Time_End": 3531.1200000000003,
      "Text": " just so you can kind of understand"
    },
    {
      "Time_Start": 3531.1200000000003,
      "Time_End": 3532.4,
      "Text": " what true attacks look like"
    },
    {
      "Time_Start": 3533.04,
      "Time_End": 3535.84,
      "Text": " and ultimately how it is that you need to kind of prevent them."
    },
    {
      "Time_Start": 3536.8,
      "Time_End": 3539.1200000000003,
      "Text": " The details in this talk were very high level"
    },
    {
      "Time_Start": 3539.1200000000003,
      "Time_End": 3541.92,
      "Text": " in terms of kind of giving you an overview"
    },
    {
      "Time_Start": 3541.92,
      "Time_End": 3544.0800000000004,
      "Text": " as to how some of these attacks actually work."
    },
    {
      "Time_Start": 3544.88,
      "Time_End": 3546.6400000000003,
      "Text": " My intention is to go through some of these"
    },
    {
      "Time_Start": 3546.6400000000003,
      "Time_End": 3548.88,
      "Text": " and provide very low level information"
    },
    {
      "Time_Start": 3548.88,
      "Time_End": 3550.96,
      "Text": " on kind of how all this kind of looks."
    },
    {
      "Time_Start": 3551.52,
      "Time_End": 3554.4,
      "Text": " That's probably a place for blog posts at a later stage."
    },
    {
      "Time_Start": 3554.4,
      "Time_End": 3556.6400000000003,
      "Text": " But yeah, kind of check out the blog"
    },
    {
      "Time_Start": 3556.64,
      "Time_End": 3558.56,
      "Text": " and I'll try and flush out some of the information"
    },
    {
      "Time_Start": 3559.12,
      "Time_End": 3561.44,
      "Text": " kind of that will be useful for Blue Team as well."
    }
  ]
}