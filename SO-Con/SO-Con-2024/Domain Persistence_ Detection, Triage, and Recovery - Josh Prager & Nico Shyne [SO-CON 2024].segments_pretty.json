{
  "segments": [
    {
      "Time_Start": 0.0,
      "Time_End": 13.96,
      "Text": "This text was transcribed using whisper model: large-v2\n\n All right, so my name is Joshua Prager, I'm the Principal Consultant of our Detection"
    },
    {
      "Time_Start": 13.96,
      "Time_End": 16.240000000000002,
      "Text": " and Defensive Services over at Specter Ops."
    },
    {
      "Time_Start": 16.240000000000002,
      "Time_End": 19.98,
      "Text": " I've been with the company for about five years now."
    },
    {
      "Time_Start": 19.98,
      "Time_End": 23.92,
      "Text": " Primarily have a military background, I've done a little work with the U.S. Navy's Red"
    },
    {
      "Time_Start": 23.92,
      "Time_End": 29.04,
      "Text": " Team before becoming a Threat Hunter with Endgame, did a couple of federal contracts"
    },
    {
      "Time_Start": 29.04,
      "Time_End": 32.2,
      "Text": " and then came over here to Specter Ops."
    },
    {
      "Time_Start": 32.2,
      "Time_End": 36.92,
      "Text": " And I'm Niko Schein, originally born and raised in Miami, Florida."
    },
    {
      "Time_Start": 36.92,
      "Time_End": 41.72,
      "Text": " So for all you Wizards fans out there, yesterday's game was brutal."
    },
    {
      "Time_Start": 41.72,
      "Time_End": 45.76,
      "Text": " But I went to the Naval Academy, served in the Navy for five years as an IP Officer at"
    },
    {
      "Time_Start": 45.76,
      "Time_End": 49.92,
      "Text": " a communications station, and then came to Specter Ops about two years ago."
    },
    {
      "Time_Start": 49.92,
      "Time_End": 53.32,
      "Text": " Really excited for this talk, presentation, and hopefully making it a discussion towards"
    },
    {
      "Time_Start": 53.32,
      "Time_End": 54.32,
      "Text": " the end as well."
    },
    {
      "Time_Start": 54.32,
      "Time_End": 58.519999999999996,
      "Text": " Yeah, we didn't put this together with, you know, putting the two Navy guys together,"
    },
    {
      "Time_Start": 58.52,
      "Time_End": 61.0,
      "Text": " but that is kind of how it turned out, so."
    },
    {
      "Time_Start": 61.0,
      "Time_End": 65.48,
      "Text": " All right, so the purpose of this presentation, what I want to talk about, like I said, is"
    },
    {
      "Time_Start": 65.48,
      "Time_End": 70.60000000000001,
      "Text": " the business impact perspective of what pin testers or Red Teamers need to execute in"
    },
    {
      "Time_Start": 70.60000000000001,
      "Time_End": 72.84,
      "Text": " the environment."
    },
    {
      "Time_Start": 72.84,
      "Time_End": 77.52000000000001,
      "Text": " Essentially to demonstrate to our clients, like at a minimum, your defensive scalability,"
    },
    {
      "Time_Start": 77.52000000000001,
      "Time_End": 82.2,
      "Text": " your defensive strategies are failing you, and these are the reasons why, okay?"
    },
    {
      "Time_Start": 82.2,
      "Time_End": 87.24000000000001,
      "Text": " And then from a defensive capacity, these are the techniques that we'll talk about here"
    },
    {
      "Time_Start": 87.24,
      "Time_End": 92.67999999999999,
      "Text": " in a second, that these are your keep calm and rebuild the forest type of scenarios,"
    },
    {
      "Time_Start": 92.67999999999999,
      "Time_End": 93.67999999999999,
      "Text": " okay?"
    },
    {
      "Time_Start": 93.67999999999999,
      "Time_End": 96.75999999999999,
      "Text": " So at a minimum, we need to make sure we have detections for these, okay?"
    },
    {
      "Time_Start": 96.75999999999999,
      "Time_End": 98.36,
      "Text": " So what spurned this?"
    },
    {
      "Time_Start": 98.36,
      "Time_End": 103.6,
      "Text": " We did some compromise assessments for a couple clients, and we did find an actual compromise,"
    },
    {
      "Time_Start": 103.6,
      "Time_End": 107.0,
      "Text": " and it was a really, really bad one, to the point where the client said, I need you to"
    },
    {
      "Time_Start": 107.0,
      "Time_End": 111.8,
      "Text": " write recommendations on how to recover from this really, really terrible situation."
    },
    {
      "Time_Start": 111.8,
      "Time_End": 116.11999999999999,
      "Text": " And the compromise was so deep, and it was spanning so many corp and subdomains, that"
    },
    {
      "Time_Start": 116.2,
      "Time_End": 118.36,
      "Text": " I was like, I honestly don't know how to recover from this."
    },
    {
      "Time_Start": 118.36,
      "Time_End": 119.36,
      "Text": " This is really bad."
    },
    {
      "Time_Start": 119.36,
      "Time_End": 120.36,
      "Text": " So I had to do a whole bunch of research."
    },
    {
      "Time_Start": 120.36,
      "Time_End": 124.88000000000001,
      "Text": " I had to take bits and pieces of response and remediation strategies from across Microsoft"
    },
    {
      "Time_Start": 124.88000000000001,
      "Time_End": 129.72,
      "Text": " and some Paris and a couple other organizations, and to put it together in a way that was coherent."
    },
    {
      "Time_Start": 129.72,
      "Time_End": 132.84,
      "Text": " And so that's essentially what I'm going to show you on the second half of this presentation"
    },
    {
      "Time_Start": 132.84,
      "Time_End": 140.56,
      "Text": " is kind of like a 10,000 foot view, strategic response, kind of wrapped up for electronic"
    },
    {
      "Time_Start": 140.56,
      "Time_End": 141.56,
      "Text": " compromise, okay?"
    },
    {
      "Time_Start": 141.56,
      "Time_End": 144.64000000000001,
      "Text": " All right, so what are we talking about?"
    },
    {
      "Time_Start": 144.64000000000001,
      "Time_End": 146.96,
      "Text": " We're talking about domain persistence."
    },
    {
      "Time_Start": 146.96,
      "Time_End": 149.68,
      "Text": " There's not a MITRE technique ID for domain persistence."
    },
    {
      "Time_Start": 149.68,
      "Time_End": 152.98000000000002,
      "Text": " It incorporates a bunch of different technique IDs, okay?"
    },
    {
      "Time_Start": 152.98000000000002,
      "Time_End": 156.88000000000002,
      "Text": " And I don't want to be so specific that I can't be flexible or elastic with my definition"
    },
    {
      "Time_Start": 156.88000000000002,
      "Time_End": 158.92000000000002,
      "Text": " of this."
    },
    {
      "Time_Start": 158.92000000000002,
      "Time_End": 163.36,
      "Text": " But ideally, domain persistence techniques do have a couple common denominators."
    },
    {
      "Time_Start": 163.36,
      "Time_End": 167.74,
      "Text": " The evidence of these are generally indicative of a larger attack path, okay?"
    },
    {
      "Time_Start": 167.74,
      "Time_End": 172.32000000000002,
      "Text": " If I see the adversary having created and abused the KRBTGT account to generate a golden"
    },
    {
      "Time_Start": 172.32,
      "Time_End": 177.0,
      "Text": " ticket, I can assume that the adversary established a foothold, was able to do local privilege"
    },
    {
      "Time_Start": 177.0,
      "Time_End": 181.95999999999998,
      "Text": " escalation, was able to enumerate a privileged group, was able to in some way abuse a domain"
    },
    {
      "Time_Start": 181.95999999999998,
      "Time_End": 186.64,
      "Text": " admin or some sort of misconfiguration on a service account, and eventually reach the"
    },
    {
      "Time_Start": 186.64,
      "Time_End": 189.0,
      "Text": " KRBTGT to generate a golden ticket."
    },
    {
      "Time_Start": 189.0,
      "Time_End": 192.95999999999998,
      "Text": " I can assume its actions and objectives are going to be pretty powerful as well, right?"
    },
    {
      "Time_Start": 192.95999999999998,
      "Time_End": 195.16,
      "Text": " So that's one common denominator."
    },
    {
      "Time_Start": 195.16,
      "Time_End": 200.2,
      "Text": " The other common denominator is typically these techniques are representative of having"
    },
    {
      "Time_Start": 200.20000000000002,
      "Time_End": 203.16000000000003,
      "Text": " required tier zero access, okay?"
    },
    {
      "Time_Start": 203.16000000000003,
      "Time_End": 204.68,
      "Text": " They have to have access to a domain controller."
    },
    {
      "Time_Start": 204.68,
      "Time_End": 207.88000000000002,
      "Text": " They have to have access to endpoint configuration managers."
    },
    {
      "Time_Start": 207.88000000000002,
      "Time_End": 212.44000000000003,
      "Text": " They have to have access to a privileged account that has access to these tier zero assets"
    },
    {
      "Time_Start": 212.44000000000003,
      "Time_End": 214.3,
      "Text": " as well, okay?"
    },
    {
      "Time_Start": 214.3,
      "Time_End": 219.92000000000002,
      "Text": " And then probably the hardest part about this is from an incident response perspective,"
    },
    {
      "Time_Start": 219.92000000000002,
      "Time_End": 223.20000000000002,
      "Text": " these are very, very difficult to scope if any of these techniques are identified in"
    },
    {
      "Time_Start": 223.20000000000002,
      "Time_End": 225.64000000000001,
      "Text": " your environment."
    },
    {
      "Time_Start": 225.64000000000001,
      "Time_End": 229.92000000000002,
      "Text": " It becomes on the scissor shoulders to essentially have to pick and choose what risk they accept"
    },
    {
      "Time_Start": 230.64000000000001,
      "Time_End": 234.48000000000002,
      "Text": " to put their head to sleep at night, knowing that maybe full access was not evicted for"
    },
    {
      "Time_Start": 234.48000000000002,
      "Time_End": 241.04000000000002,
      "Text": " the adversary, because these techniques do incorporate so much detrimental parts of the"
    },
    {
      "Time_Start": 241.04000000000002,
      "Time_End": 243.32000000000002,
      "Text": " environment, okay?"
    },
    {
      "Time_Start": 243.32000000000002,
      "Time_End": 247.44000000000003,
      "Text": " So we're going to be talking about basically how to identify these techniques."
    },
    {
      "Time_Start": 247.44000000000003,
      "Time_End": 253.08,
      "Text": " We're going to be talking about how to triage and how to kind of look at them from the consideration"
    },
    {
      "Time_Start": 253.08,
      "Time_End": 257.36,
      "Text": " of a pin testing and red teaming perspective as well, because I want this talk to be appealing"
    },
    {
      "Time_Start": 257.36,
      "Time_End": 262.64,
      "Text": " to both offensive and defensive, which is kind of Specter Ops' whole MO, right?"
    },
    {
      "Time_Start": 262.64,
      "Time_End": 264.8,
      "Text": " We're going to talk a little bit about how to triage them, and then we're also going"
    },
    {
      "Time_Start": 264.8,
      "Time_End": 267.8,
      "Text": " to talk about how to recover if any of these techniques are seen."
    },
    {
      "Time_Start": 267.8,
      "Time_End": 273.84000000000003,
      "Text": " Now I'm going to provide you one essential, like, electronic compromise recovery strategy."
    },
    {
      "Time_Start": 273.84000000000003,
      "Time_End": 275.36,
      "Text": " It's going to be very, very high level."
    },
    {
      "Time_Start": 275.36,
      "Time_End": 277.28000000000003,
      "Text": " Your environment is going to be very unique."
    },
    {
      "Time_Start": 277.28000000000003,
      "Time_End": 279.18,
      "Text": " Your clients' environments are going to be very unique."
    },
    {
      "Time_Start": 279.18,
      "Time_End": 281.40000000000003,
      "Text": " It's not a one size fits all, but it's a good starting point."
    },
    {
      "Time_Start": 281.40000000000003,
      "Time_End": 283.40000000000003,
      "Text": " It's a good boilerplate, okay?"
    },
    {
      "Time_Start": 283.40000000000003,
      "Time_End": 288.84000000000003,
      "Text": " The thing to remember is when I was originally giving this talk, I had a couple kind of like"
    },
    {
      "Time_Start": 288.84000000000003,
      "Time_End": 293.08000000000004,
      "Text": " advisors saying, hey, why don't you write remediation strategies for every single technique?"
    },
    {
      "Time_Start": 293.08000000000004,
      "Time_End": 297.44000000000005,
      "Text": " And the point that I wanted to convey was there is not one strategy for every single"
    },
    {
      "Time_Start": 297.44000000000005,
      "Time_End": 298.44000000000005,
      "Text": " technique."
    },
    {
      "Time_Start": 298.44000000000005,
      "Time_End": 302.00000000000006,
      "Text": " If you see any of these techniques, these are the strategies you have to consider across"
    },
    {
      "Time_Start": 302.00000000000006,
      "Time_End": 303.00000000000006,
      "Text": " the board, okay?"
    },
    {
      "Time_Start": 303.00000000000006,
      "Time_End": 304.56000000000006,
      "Text": " And that's really, really important to take away."
    },
    {
      "Time_Start": 304.56000000000006,
      "Time_End": 305.56000000000006,
      "Text": " All right."
    },
    {
      "Time_Start": 305.56000000000006,
      "Time_End": 308.40000000000003,
      "Text": " So what we're going to be talking about is credential theft on the domain controller,"
    },
    {
      "Time_Start": 308.40000000000003,
      "Time_End": 309.40000000000003,
      "Text": " okay?"
    },
    {
      "Time_Start": 309.40000000000003,
      "Time_End": 312.20000000000005,
      "Text": " We're going to be talking about NTDS access DC sync."
    },
    {
      "Time_Start": 312.52,
      "Time_End": 316.96,
      "Text": " We'll be talking about Golden Ticket, Diamond Ticket, some certificate theft, and then finally"
    },
    {
      "Time_Start": 316.96,
      "Time_End": 318.44,
      "Text": " SSCM site takeover."
    },
    {
      "Time_Start": 318.44,
      "Time_End": 324.88,
      "Text": " If you just sat for Dwayne and Chris's talk on misconfiguration manager, it's essentially"
    },
    {
      "Time_Start": 324.88,
      "Time_End": 329.96,
      "Text": " going to be talking about the defensive portions of their project that I developed for their"
    },
    {
      "Time_Start": 329.96,
      "Time_End": 333.56,
      "Text": " like GitHub repo and everything, okay, through testing and validation."
    },
    {
      "Time_Start": 333.56,
      "Time_End": 334.56,
      "Text": " Okay."
    },
    {
      "Time_Start": 334.56,
      "Time_End": 335.84,
      "Text": " So let's get started."
    },
    {
      "Time_Start": 335.84,
      "Time_End": 338.44,
      "Text": " Let's talk about credential theft on the domain controller."
    },
    {
      "Time_Start": 338.44,
      "Time_End": 340.52,
      "Text": " Credential theft's been around for a long time."
    },
    {
      "Time_Start": 340.52,
      "Time_End": 343.91999999999996,
      "Text": " At this point, it's somewhat trivial for defenders to detect it."
    },
    {
      "Time_Start": 343.91999999999996,
      "Time_End": 348.47999999999996,
      "Text": " And then from a preventative control perspective as well, it is also somewhat trivial."
    },
    {
      "Time_Start": 348.47999999999996,
      "Time_End": 351.52,
      "Text": " So I'm not going to like go super, super in-depth with it, okay?"
    },
    {
      "Time_Start": 351.52,
      "Time_End": 355.24,
      "Text": " There are some key differences, though, when we're talking about an attack path perspective"
    },
    {
      "Time_Start": 355.24,
      "Time_End": 359.59999999999997,
      "Text": " between client credential theft and domain controller credential theft."
    },
    {
      "Time_Start": 359.59999999999997,
      "Time_End": 363.71999999999997,
      "Text": " Number one is there is no credit guard on domain controllers most often."
    },
    {
      "Time_Start": 363.71999999999997,
      "Time_End": 368.79999999999995,
      "Text": " In fact, Microsoft actually in their documentation will state do not turn on credential guard"
    },
    {
      "Time_Start": 368.8,
      "Time_End": 374.12,
      "Text": " on the domain controllers because this will completely work LSAS, Kerberos authentication,"
    },
    {
      "Time_Start": 374.12,
      "Time_End": 378.12,
      "Text": " TLM authentication from working successfully, okay?"
    },
    {
      "Time_Start": 378.12,
      "Time_End": 380.2,
      "Text": " So that's something to keep in mind, right?"
    },
    {
      "Time_Start": 380.2,
      "Time_End": 384.8,
      "Text": " Most client workstations will have credit guard or some sort of process injection attempt"
    },
    {
      "Time_Start": 384.8,
      "Time_End": 387.64,
      "Text": " into LSAS preventative control in place, right?"
    },
    {
      "Time_Start": 387.64,
      "Time_End": 392.2,
      "Text": " I've seen some organizations do like SC debug preventative controls as well."
    },
    {
      "Time_Start": 392.2,
      "Time_End": 395.48,
      "Text": " The domain controllers generally don't have that same capability or that same preventative"
    },
    {
      "Time_Start": 395.48,
      "Time_End": 396.48,
      "Text": " control in there."
    },
    {
      "Time_Start": 396.48,
      "Time_End": 398.08000000000004,
      "Text": " So that's something to keep in mind."
    },
    {
      "Time_Start": 398.56,
      "Time_End": 402.96,
      "Text": " Also, if we do see interactive logins, if we're going to see them, they might be on"
    },
    {
      "Time_Start": 402.96,
      "Time_End": 405.56,
      "Text": " a domain controller from a red teaming perspective."
    },
    {
      "Time_Start": 405.56,
      "Time_End": 410.68,
      "Text": " If we were going to try to find a cached interactive login of a highly privileged administrator,"
    },
    {
      "Time_Start": 410.68,
      "Time_End": 412.4,
      "Text": " chances are it's going to be on the domain controller."
    },
    {
      "Time_Start": 412.4,
      "Time_End": 414.12,
      "Text": " So that's another consideration as well."
    },
    {
      "Time_Start": 414.12,
      "Time_End": 417.71999999999997,
      "Text": " Finally, this one's not in the slides, but this is just from my own experience."
    },
    {
      "Time_Start": 417.71999999999997,
      "Time_End": 424.76,
      "Text": " Attack paths are not always the super complicated, super micro granular, I started as a seeded"
    },
    {
      "Time_Start": 424.76,
      "Time_End": 429.64,
      "Text": " access user, I local privilege escalate by abusing a service, I eventually found some"
    },
    {
      "Time_Start": 429.64,
      "Time_End": 432.8,
      "Text": " group that I was able to misconfigure and abuse, and then I was able to get to domain"
    },
    {
      "Time_Start": 432.8,
      "Time_End": 435.36,
      "Text": " admin, which eventually got me the domain controller."
    },
    {
      "Time_Start": 435.36,
      "Time_End": 439.24,
      "Text": " A lot of actual compromises are as quick as possible, right?"
    },
    {
      "Time_Start": 439.24,
      "Time_End": 444.68,
      "Text": " I think it's the Ocum's razor principle, the simplest path is usually the most often chosen,"
    },
    {
      "Time_Start": 444.68,
      "Time_End": 445.68,
      "Text": " right?"
    },
    {
      "Time_Start": 445.68,
      "Time_End": 451.36,
      "Text": " So I've seen where system account is essentially abused on forward facing SharePoint servers"
    },
    {
      "Time_Start": 451.36,
      "Time_End": 453.08,
      "Text": " and web servers, okay?"
    },
    {
      "Time_Start": 453.12,
      "Time_End": 457.96,
      "Text": " The adversary sprays and prays across an entire industry, thousands and thousands of targets,"
    },
    {
      "Time_Start": 457.96,
      "Time_End": 462.52,
      "Text": " and they do a SharePoint vulnerability that gets them system access on a web server."
    },
    {
      "Time_Start": 462.52,
      "Time_End": 466.36,
      "Text": " They dump credentials on that, if they can find any sort of admin that's laterally moving,"
    },
    {
      "Time_Start": 466.36,
      "Time_End": 470.36,
      "Text": " they'll dump credentials on that web server and immediately go to the domain controller"
    },
    {
      "Time_Start": 470.36,
      "Time_End": 476.0,
      "Text": " using PS exec or many other internal tools and just immediately proc dump the domain"
    },
    {
      "Time_Start": 476.0,
      "Time_End": 477.0,
      "Text": " controller, okay?"
    },
    {
      "Time_Start": 477.0,
      "Time_End": 482.96,
      "Text": " I mean, this is like a two-step attack path, very, very trivial, and from a defender perspective,"
    },
    {
      "Time_Start": 482.96000000000004,
      "Time_End": 486.16,
      "Text": " we definitely want to make sure we have some sort of controls and some sort of detections"
    },
    {
      "Time_Start": 486.16,
      "Time_End": 489.28000000000003,
      "Text": " that can detect that, okay?"
    },
    {
      "Time_Start": 489.28000000000003,
      "Time_End": 493.00000000000006,
      "Text": " Like I said, at this point, I mean, credential dumping has been around for quite a while"
    },
    {
      "Time_Start": 493.00000000000006,
      "Time_End": 494.00000000000006,
      "Text": " now."
    },
    {
      "Time_Start": 494.00000000000006,
      "Time_End": 495.00000000000006,
      "Text": " There's a whole bunch of resources and detections on it."
    },
    {
      "Time_Start": 495.00000000000006,
      "Time_End": 499.12000000000006,
      "Text": " I'm not going to get super in-depth with it, but you can do process access attempts."
    },
    {
      "Time_Start": 499.12000000000006,
      "Time_End": 503.84000000000003,
      "Text": " You can use EDRs, which typically have a read process memory API call sort of monitoring"
    },
    {
      "Time_Start": 503.84000000000003,
      "Time_End": 505.68000000000006,
      "Text": " capability."
    },
    {
      "Time_Start": 505.68000000000006,
      "Time_End": 510.12000000000006,
      "Text": " You can also look for any sort of handles on the target LSS process."
    },
    {
      "Time_Start": 510.12000000000006,
      "Time_End": 511.12000000000006,
      "Text": " This horse has been beat enough times."
    },
    {
      "Time_Start": 511.12000000000006,
      "Time_End": 512.12,
      "Text": " We're going to keep it moving."
    },
    {
      "Time_Start": 512.28,
      "Time_End": 513.28,
      "Text": " We've got a lot of content to cover."
    },
    {
      "Time_Start": 513.28,
      "Time_End": 516.16,
      "Text": " All right, so let's talk about NTDS access."
    },
    {
      "Time_Start": 516.16,
      "Time_End": 523.4,
      "Text": " So NTDS, the NTDS.dip file is the Active Directory Users and Computers database file."
    },
    {
      "Time_Start": 523.4,
      "Time_End": 528.24,
      "Text": " Adversaries will typically try to figure out a way to break the deadlocked capability of"
    },
    {
      "Time_Start": 528.24,
      "Time_End": 529.24,
      "Text": " that file."
    },
    {
      "Time_Start": 529.24,
      "Time_End": 532.28,
      "Text": " Essentially, the domain controller is using Active Directory Users and Computers all the"
    },
    {
      "Time_Start": 532.28,
      "Time_End": 538.08,
      "Text": " time, and so adversaries have to figure out a way to bypass hard-locking that file from"
    },
    {
      "Time_Start": 538.08,
      "Time_End": 539.44,
      "Text": " access."
    },
    {
      "Time_Start": 539.5200000000001,
      "Time_End": 540.5200000000001,
      "Text": " There's a ton of different ways."
    },
    {
      "Time_Start": 540.5200000000001,
      "Time_End": 542.6,
      "Text": " Invoke Ninja Copy."
    },
    {
      "Time_Start": 542.6,
      "Time_End": 545.1600000000001,
      "Text": " You can make a snapshot of the file system."
    },
    {
      "Time_Start": 545.1600000000001,
      "Time_End": 548.8000000000001,
      "Text": " There's a bunch of different ways to do it."
    },
    {
      "Time_Start": 548.8000000000001,
      "Time_End": 551.6800000000001,
      "Text": " One of the things that we can do is we can set what's called a system access control"
    },
    {
      "Time_Start": 551.6800000000001,
      "Time_End": 552.6800000000001,
      "Text": " list."
    },
    {
      "Time_Start": 552.6800000000001,
      "Time_End": 557.6,
      "Text": " We'll talk about them here in a couple different slides, but essentially if you're familiar"
    },
    {
      "Time_Start": 557.6,
      "Time_End": 561.9200000000001,
      "Text": " with the term ACLs, access control list, most defenders think of them from the perspective"
    },
    {
      "Time_Start": 561.9200000000001,
      "Time_End": 566.2800000000001,
      "Text": " of I can stop people from getting to an object or I can give people access to an object."
    },
    {
      "Time_Start": 566.64,
      "Time_End": 572.48,
      "Text": " You can also set up custom auditing on an object as well, which isn't as well known."
    },
    {
      "Time_Start": 572.48,
      "Time_End": 577.52,
      "Text": " So you can set a system access control list on the NTDS.dip file."
    },
    {
      "Time_Start": 577.52,
      "Time_End": 581.9599999999999,
      "Text": " Additionally, there's a lot of default system access control lists that have custom auditing"
    },
    {
      "Time_Start": 581.9599999999999,
      "Time_End": 585.0799999999999,
      "Text": " already built out of the box with Windows."
    },
    {
      "Time_Start": 585.0799999999999,
      "Time_End": 590.0,
      "Text": " A lot of times when I talk to defenders they'll say things like we don't ingest any 4662 events"
    },
    {
      "Time_Start": 590.0,
      "Time_End": 594.28,
      "Text": " or any 4663 events because they're too verbose, but that's because they don't understand these"
    },
    {
      "Time_Start": 594.28,
      "Time_End": 597.24,
      "Text": " are all SACLs set on individual objects."
    },
    {
      "Time_Start": 597.24,
      "Time_End": 599.6,
      "Text": " You can filter those individual objects."
    },
    {
      "Time_Start": 599.6,
      "Time_End": 600.9599999999999,
      "Text": " You can be as granular as you want."
    },
    {
      "Time_Start": 600.9599999999999,
      "Time_End": 603.72,
      "Text": " I only care about the DPAPI domain backup key."
    },
    {
      "Time_Start": 603.72,
      "Time_End": 605.6,
      "Text": " I only care about the NTDS.dip file."
    },
    {
      "Time_Start": 605.6,
      "Time_End": 607.72,
      "Text": " I don't care about every SACL, just those two."
    },
    {
      "Time_Start": 607.72,
      "Time_End": 611.12,
      "Text": " You can be as granular as you want from a data shipper level and it's important to remember"
    },
    {
      "Time_Start": 611.12,
      "Time_End": 612.12,
      "Text": " that."
    },
    {
      "Time_Start": 612.12,
      "Time_End": 616.0,
      "Text": " There's a couple different event IDs that we can essentially use."
    },
    {
      "Time_Start": 616.0,
      "Time_End": 620.8199999999999,
      "Text": " Generally they're aiming at the volume shadow copy service either being started, executing"
    },
    {
      "Time_Start": 620.82,
      "Time_End": 627.1400000000001,
      "Text": " a snapshot, or exfiltrating a snapshot or exporting a snapshot."
    },
    {
      "Time_Start": 627.1400000000001,
      "Time_End": 629.58,
      "Text": " We can utilize these event IDs."
    },
    {
      "Time_Start": 629.58,
      "Time_End": 632.58,
      "Text": " These slides will be up afterwards and we're also going to link them on our GitHub to this"
    },
    {
      "Time_Start": 632.58,
      "Time_End": 633.62,
      "Text": " project as well."
    },
    {
      "Time_Start": 633.62,
      "Time_End": 636.1400000000001,
      "Text": " I want these to be kind of a reference point."
    },
    {
      "Time_Start": 636.1400000000001,
      "Time_End": 639.86,
      "Text": " I really like presentations where it's like you can go back later and be like all right,"
    },
    {
      "Time_Start": 639.86,
      "Time_End": 643.0200000000001,
      "Text": " let me generate a detection for this, let me go through their slides and see what they"
    },
    {
      "Time_Start": 643.0200000000001,
      "Time_End": 644.0200000000001,
      "Text": " got."
    },
    {
      "Time_Start": 644.0200000000001,
      "Time_End": 649.22,
      "Text": " I'm not going to go into super in depth for every one of these data models."
    },
    {
      "Time_Start": 649.22,
      "Time_End": 650.22,
      "Text": " Let's talk about DCSync."
    },
    {
      "Time_Start": 650.62,
      "Time_End": 652.0,
      "Text": " DCSync is very, very well known."
    },
    {
      "Time_Start": 652.0,
      "Time_End": 653.94,
      "Text": " Directory service replication."
    },
    {
      "Time_Start": 653.94,
      "Time_End": 657.7,
      "Text": " It's the default way that like primary, or they don't have primary and secondary, but"
    },
    {
      "Time_Start": 657.7,
      "Time_End": 661.1,
      "Text": " domain controller A and domain controller B will talk to each other and if I change"
    },
    {
      "Time_Start": 661.1,
      "Time_End": 663.9,
      "Text": " my password in New York it's replicated over to California."
    },
    {
      "Time_Start": 663.9,
      "Time_End": 666.22,
      "Text": " This is how this is done."
    },
    {
      "Time_Start": 666.22,
      "Time_End": 672.78,
      "Text": " Adversaries will abuse this and they can pick all of the users in the environment or they"
    },
    {
      "Time_Start": 672.78,
      "Time_End": 677.74,
      "Text": " can target a particular user in the environment and they can sync the data, which essentially"
    },
    {
      "Time_Start": 677.74,
      "Time_End": 682.7,
      "Text": " they're looking for the credentials in this case, a copy of the NTLM hash of those users"
    },
    {
      "Time_Start": 682.7,
      "Time_End": 686.86,
      "Text": " that are synced to Active Directory."
    },
    {
      "Time_Start": 686.86,
      "Time_End": 691.74,
      "Text": " There's kind of a couple different ways that defenders can detect this."
    },
    {
      "Time_Start": 691.74,
      "Time_End": 698.58,
      "Text": " Typically I've seen detections based on the host level telemetry, so there has to be an"
    },
    {
      "Time_Start": 698.58,
      "Time_End": 703.02,
      "Text": " audit category turned on for directory service replication on the domain controller."
    },
    {
      "Time_Start": 703.02,
      "Time_End": 708.62,
      "Text": " It's essentially going to tell you any time someone utilized the extended attributes necessary"
    },
    {
      "Time_Start": 708.62,
      "Time_End": 712.06,
      "Text": " to conduct a directory service replication."
    },
    {
      "Time_Start": 712.06,
      "Time_End": 715.38,
      "Text": " Then usually it's upon the defenders to determine was this a machine account doing it, was this"
    },
    {
      "Time_Start": 715.38,
      "Time_End": 718.74,
      "Text": " a user account doing it, things like that."
    },
    {
      "Time_Start": 718.74,
      "Time_End": 720.98,
      "Text": " There's also the DRSU API."
    },
    {
      "Time_Start": 720.98,
      "Time_End": 724.5799999999999,
      "Text": " This is the network protocol layer of directory service replication."
    },
    {
      "Time_Start": 724.5799999999999,
      "Time_End": 726.06,
      "Text": " That can be leveraged as well."
    },
    {
      "Time_Start": 726.06,
      "Time_End": 730.9399999999999,
      "Text": " There is a caveat to that that is a little less well known and that I've done some research"
    },
    {
      "Time_Start": 730.9399999999999,
      "Time_End": 731.9399999999999,
      "Text": " on."
    },
    {
      "Time_Start": 731.94,
      "Time_End": 736.0200000000001,
      "Text": " If you, as an adversary or a pen tester, a red teamer, you have access to the domain"
    },
    {
      "Time_Start": 736.0200000000001,
      "Time_End": 743.46,
      "Text": " controller, if you DC sync on the domain controller that you're already connected to, you're not"
    },
    {
      "Time_Start": 743.46,
      "Time_End": 748.3000000000001,
      "Text": " going to go over an external interface or over an outbound interface, over a typical"
    },
    {
      "Time_Start": 748.3000000000001,
      "Time_End": 750.46,
      "Text": " IPv4 or IPv6."
    },
    {
      "Time_Start": 750.46,
      "Time_End": 753.5,
      "Text": " You're actually going to use the loopback to do DRSU API."
    },
    {
      "Time_Start": 753.5,
      "Time_End": 758.8800000000001,
      "Text": " That's very, very important to know if your organization from a defender perspective only"
    },
    {
      "Time_Start": 758.88,
      "Time_End": 764.4,
      "Text": " has Pal Alto detections or firewall based DC sync detections, you will not pick up local"
    },
    {
      "Time_Start": 764.4,
      "Time_End": 765.84,
      "Text": " loopback stuff."
    },
    {
      "Time_Start": 765.84,
      "Time_End": 770.56,
      "Text": " Most firewalls avoid monitoring any kind of loopback configurations."
    },
    {
      "Time_Start": 770.56,
      "Time_End": 774.24,
      "Text": " If the adversary is able to get access to the domain controller and then conduct a DC"
    },
    {
      "Time_Start": 774.24,
      "Time_End": 779.72,
      "Text": " sync, you'll essentially communicate over the loopback and evade most network based"
    },
    {
      "Time_Start": 779.72,
      "Time_End": 780.72,
      "Text": " detections for DC sync."
    },
    {
      "Time_Start": 780.72,
      "Time_End": 781.72,
      "Text": " All right."
    },
    {
      "Time_Start": 781.72,
      "Time_End": 782.72,
      "Text": " I'm going to pass this to Niko."
    },
    {
      "Time_Start": 782.72,
      "Time_End": 785.72,
      "Text": " He's going to cover Golden Ticket and Diamond Ticket."
    },
    {
      "Time_Start": 785.72,
      "Time_End": 787.4,
      "Text": " Niko Kovacic Good morning, everyone."
    },
    {
      "Time_Start": 787.4,
      "Time_End": 788.4,
      "Text": " Thanks for coming out here."
    },
    {
      "Time_Start": 788.92,
      "Time_End": 789.92,
      "Text": " Quick show of hands."
    },
    {
      "Time_Start": 789.92,
      "Time_End": 790.92,
      "Text": " Who's familiar with Kerberos?"
    },
    {
      "Time_Start": 790.92,
      "Time_End": 791.92,
      "Text": " Okay."
    },
    {
      "Time_Start": 791.92,
      "Time_End": 792.92,
      "Text": " Perfect."
    },
    {
      "Time_Start": 792.92,
      "Time_End": 797.84,
      "Text": " I'm going to skip the overview, if that's okay, just in the interest of time."
    },
    {
      "Time_Start": 797.84,
      "Time_End": 802.92,
      "Text": " The important thing to know with Golden Ticket attacks is the Karibbe TGT account is going"
    },
    {
      "Time_Start": 802.92,
      "Time_End": 806.1,
      "Text": " to generate the key of the password and it's going to use that to encrypt those TGT tickets"
    },
    {
      "Time_Start": 806.1,
      "Time_End": 808.28,
      "Text": " which we care about."
    },
    {
      "Time_Start": 808.28,
      "Time_End": 811.5799999999999,
      "Text": " What a Golden Ticket attack does, that's going to be so difficult."
    },
    {
      "Time_Start": 811.5799999999999,
      "Time_End": 812.92,
      "Text": " You can see here the operational flow."
    },
    {
      "Time_Start": 812.92,
      "Time_End": 816.68,
      "Text": " The adversary is going to need that domain name, the set of the domain, the account impersonate"
    },
    {
      "Time_Start": 816.7600000000001,
      "Time_End": 818.7600000000001,
      "Text": " and that Karibbe TGT password hash."
    },
    {
      "Time_Start": 818.7600000000001,
      "Time_End": 822.7600000000001,
      "Text": " They're going to pass that data to a new ticket and our research we use tools like Mimikatz,"
    },
    {
      "Time_Start": 822.7600000000001,
      "Time_End": 823.7600000000001,
      "Text": " Rubius."
    },
    {
      "Time_Start": 823.7600000000001,
      "Time_End": 826.32,
      "Text": " Adversaries can also do stuff out of the box if necessary."
    },
    {
      "Time_Start": 826.32,
      "Time_End": 830.0000000000001,
      "Text": " That ticket's going to be saved in the current session ticket cache."
    },
    {
      "Time_Start": 830.0000000000001,
      "Time_End": 833.2,
      "Text": " That new ticket's going to give access to whatever that Karibbe TGT account had access"
    },
    {
      "Time_Start": 833.2,
      "Time_End": 836.2,
      "Text": " to within the domain."
    },
    {
      "Time_Start": 836.2,
      "Time_End": 839.0000000000001,
      "Text": " We're going to talk a little bit about some of the data sources that we can use to draw"
    },
    {
      "Time_Start": 839.0000000000001,
      "Time_End": 844.24,
      "Text": " from Golden Ticket attacks because the important thing is once that initial ticket is requested"
    },
    {
      "Time_Start": 844.24,
      "Time_End": 850.32,
      "Text": " from the KDC and it's modified locally by the adversary, when it's used from then on"
    },
    {
      "Time_Start": 850.32,
      "Time_End": 853.28,
      "Text": " for TGS requests, it's really difficult to detect."
    },
    {
      "Time_Start": 853.28,
      "Time_End": 857.3,
      "Text": " What we're trying to get at with the Golden Ticket attack, Diamond Ticket attack and whatever"
    },
    {
      "Time_Start": 857.3,
      "Time_End": 861.84,
      "Text": " Pokemon game they name it after next, I think Sapphire Ticket came out in November."
    },
    {
      "Time_Start": 861.84,
      "Time_End": 867.16,
      "Text": " These ticket attacks first started back in I think 2014 with Benjamin Delpy's research."
    },
    {
      "Time_Start": 867.16,
      "Time_End": 870.32,
      "Text": " Each iteration of these ticket attacks which you'll see as we progress to Diamond Ticket"
    },
    {
      "Time_Start": 870.32,
      "Time_End": 874.96,
      "Text": " requires less and less interaction with the KDC and more and more work that's done locally"
    },
    {
      "Time_Start": 874.96,
      "Time_End": 877.2800000000001,
      "Text": " and modifying the tickets."
    },
    {
      "Time_Start": 877.2800000000001,
      "Time_End": 880.24,
      "Text": " Some of these event IDs that you're going to see and security event IDs that you're"
    },
    {
      "Time_Start": 880.24,
      "Time_End": 884.1600000000001,
      "Text": " going to see are really difficult to depend on as standalone detections."
    },
    {
      "Time_Start": 884.1600000000001,
      "Time_End": 886.6800000000001,
      "Text": " That's what we're ultimately trying to get away from."
    },
    {
      "Time_Start": 886.6800000000001,
      "Time_End": 890.4000000000001,
      "Text": " Some of the data sources we're going to look at, we have event ID 4768 which is going to"
    },
    {
      "Time_Start": 890.4000000000001,
      "Time_End": 892.4000000000001,
      "Text": " be the TGT requested."
    },
    {
      "Time_Start": 892.4000000000001,
      "Time_End": 897.5200000000001,
      "Text": " For Golden Ticket attacks, adversary's going to request that ticket from the KDC, bring"
    },
    {
      "Time_Start": 897.5200000000001,
      "Time_End": 899.6800000000001,
      "Text": " it in locally to modify."
    },
    {
      "Time_Start": 899.9200000000001,
      "Time_End": 907.0400000000001,
      "Text": " From then on, however, you're going to get 4769 events when you're requesting access"
    },
    {
      "Time_Start": 907.0400000000001,
      "Time_End": 912.1200000000001,
      "Text": " that has to be checked and verified within Kerberos as a whole."
    },
    {
      "Time_Start": 912.1200000000001,
      "Time_End": 915.2800000000001,
      "Text": " Something that we came up in our research that we thought was interesting is event ID"
    },
    {
      "Time_Start": 915.2800000000001,
      "Time_End": 916.2800000000001,
      "Text": " 4627."
    },
    {
      "Time_Start": 916.2800000000001,
      "Time_End": 918.5400000000001,
      "Text": " It's the group membership information."
    },
    {
      "Time_Start": 918.5400000000001,
      "Time_End": 923.44,
      "Text": " You can sort people into groups locally within your domain."
    },
    {
      "Time_Start": 923.44,
      "Time_End": 928.44,
      "Text": " When you look into your sim and you're looking at either Cabana, Splunk, whatever you're"
    },
    {
      "Time_Start": 928.44,
      "Time_End": 934.72,
      "Text": " using, you can see all of the SIDs associated with the user generated by this event."
    },
    {
      "Time_Start": 934.72,
      "Time_End": 939.08,
      "Text": " Something we noticed is Golden Ticket attacks usually added a global admin, domain admin"
    },
    {
      "Time_Start": 939.08,
      "Time_End": 942.9200000000001,
      "Text": " SID to that user that should normally be there."
    },
    {
      "Time_Start": 942.9200000000001,
      "Time_End": 947.12,
      "Text": " If you're triggering detections based on group membership information when a user joins a"
    },
    {
      "Time_Start": 947.12,
      "Time_End": 952.44,
      "Text": " group that they're not supposed to, i.e. global domain admins, you can trigger that detection,"
    },
    {
      "Time_Start": 952.44,
      "Time_End": 955.9200000000001,
      "Text": " verify their tickets locally using a tool like Klist."
    },
    {
      "Time_Start": 955.9200000000001,
      "Time_End": 961.32,
      "Text": " The detection strategy we're going to do is generally going to be based on this event"
    },
    {
      "Time_Start": 961.32,
      "Time_End": 965.5600000000001,
      "Text": " ID 4768 and 4769."
    },
    {
      "Time_Start": 965.5600000000001,
      "Time_End": 968.3600000000001,
      "Text": " We're going to have to rely on other stuff in defense in depth, other things we have"
    },
    {
      "Time_Start": 968.3600000000001,
      "Time_End": 973.48,
      "Text": " in our domain to detect, the theft of the Kerabee TGT password hash, and the anomalous"
    },
    {
      "Time_Start": 973.48,
      "Time_End": 975.7600000000001,
      "Text": " use of that account."
    },
    {
      "Time_Start": 975.7600000000001,
      "Time_End": 981.1200000000001,
      "Text": " We don't want to solely base it on these ticker requests, but what we can do and did notice"
    },
    {
      "Time_Start": 981.12,
      "Time_End": 989.04,
      "Text": " is that Golden, you can look for 4769 events that don't have corresponding 4768 events,"
    },
    {
      "Time_Start": 989.04,
      "Time_End": 994.12,
      "Text": " usually a sign that a ticket was modified or created locally, which we'll get to later,"
    },
    {
      "Time_Start": 994.12,
      "Time_End": 996.72,
      "Text": " since it didn't get that initial request from the KDC."
    },
    {
      "Time_Start": 996.72,
      "Time_End": 1001.5600000000001,
      "Text": " Any and all requests you see after that point with the 4769 events without that corresponding"
    },
    {
      "Time_Start": 1001.5600000000001,
      "Time_End": 1005.8,
      "Text": " 4768 event means that you're looking at a modified ticket, and at that point you can"
    },
    {
      "Time_Start": 1005.8,
      "Time_End": 1008.5600000000001,
      "Text": " go further into triage."
    },
    {
      "Time_Start": 1008.5600000000001,
      "Time_End": 1011.12,
      "Text": " You can also use Klist for validation."
    },
    {
      "Time_Start": 1011.12,
      "Time_End": 1018.32,
      "Text": " Again, Microsoft, when a lot of these security issues were brought up, said this is how it's"
    },
    {
      "Time_Start": 1018.32,
      "Time_End": 1022.6800000000001,
      "Text": " built, this is a feature, not a bug, so we kind of have to work around the open door"
    },
    {
      "Time_Start": 1022.6800000000001,
      "Time_End": 1024.72,
      "Text": " that's left there."
    },
    {
      "Time_Start": 1024.72,
      "Time_End": 1029.76,
      "Text": " You can use tools like Klist locally at the triage level, but as of now, and there could"
    },
    {
      "Time_Start": 1029.76,
      "Time_End": 1034.0,
      "Text": " be third party tools I'm not aware of, I didn't see any, at least in the course of our research,"
    },
    {
      "Time_Start": 1034.0,
      "Time_End": 1037.28,
      "Text": " that were in a mature state by any means."
    },
    {
      "Time_Start": 1037.28,
      "Time_End": 1041.04,
      "Text": " It's really hard to look at all the tickets that a user has associated with them and use"
    },
    {
      "Time_Start": 1041.04,
      "Time_End": 1044.72,
      "Text": " that as a detection, unfortunately."
    },
    {
      "Time_Start": 1044.72,
      "Time_End": 1048.0,
      "Text": " Quick show of hands, who's familiar with BPMN diagram notation?"
    },
    {
      "Time_Start": 1048.0,
      "Time_End": 1049.92,
      "Text": " Okay, cool."
    },
    {
      "Time_Start": 1049.92,
      "Time_End": 1055.12,
      "Text": " This is traditionally used in a business setting to go through processes and inefficiencies"
    },
    {
      "Time_Start": 1055.12,
      "Time_End": 1056.96,
      "Text": " within those processes."
    },
    {
      "Time_Start": 1056.96,
      "Time_End": 1061.24,
      "Text": " Like McDonald's, when they first started out, they had BPMN diagrams for if customer orders"
    },
    {
      "Time_Start": 1061.24,
      "Time_End": 1063.04,
      "Text": " this, what next, what next, right?"
    },
    {
      "Time_Start": 1063.04,
      "Time_End": 1066.1,
      "Text": " I'm sure we've seen variations of that throughout."
    },
    {
      "Time_Start": 1066.1,
      "Time_End": 1070.1399999999999,
      "Text": " Because Golden Ticket can be obtained via a variety of different tools, a variety of"
    },
    {
      "Time_Start": 1070.1399999999999,
      "Time_End": 1073.4599999999998,
      "Text": " different methods, we thought this would be a more appropriate way to walk through the"
    },
    {
      "Time_Start": 1073.4599999999998,
      "Time_End": 1078.8999999999999,
      "Text": " attack path than showing those abstraction maps we showed earlier, because every adversary"
    },
    {
      "Time_Start": 1078.8999999999999,
      "Time_End": 1081.82,
      "Text": " could use a different tool, it's going to trigger different events, and you can't necessarily"
    },
    {
      "Time_Start": 1081.82,
      "Time_End": 1085.08,
      "Text": " map those one to one."
    },
    {
      "Time_Start": 1085.08,
      "Time_End": 1088.82,
      "Text": " We have these three swim lanes here that show entities that we care about, the adversary,"
    },
    {
      "Time_Start": 1088.82,
      "Time_End": 1089.82,
      "Text": " domain controller, KDC."
    },
    {
      "Time_Start": 1089.82,
      "Time_End": 1094.82,
      "Text": " The adversary is going to obtain initial access, they're going to get domain admin, DC sync,"
    },
    {
      "Time_Start": 1094.82,
      "Time_End": 1098.82,
      "Text": " or any of the other techniques that we talked about to get that Caribbean TGT hash stolen."
    },
    {
      "Time_Start": 1098.82,
      "Time_End": 1101.54,
      "Text": " It's going to be used to create a Golden Ticket, which is going to be passed through the current"
    },
    {
      "Time_Start": 1101.54,
      "Time_End": 1106.98,
      "Text": " session, and from then on they can request access with the KDC for further resources."
    },
    {
      "Time_Start": 1106.98,
      "Time_End": 1112.1799999999998,
      "Text": " So when we get to Diamond Tickets, which is where the adversary is creating their own"
    },
    {
      "Time_Start": 1112.1799999999998,
      "Time_End": 1116.1799999999998,
      "Text": " ticket, or instead of Golden Tickets, where the adversary is creating their own ticket,"
    },
    {
      "Time_Start": 1116.1799999999998,
      "Time_End": 1120.86,
      "Text": " Diamond Tickets are a lot more difficult because the adversary is modifying an already genuinely"
    },
    {
      "Time_Start": 1120.9,
      "Time_End": 1125.2600000000002,
      "Text": " legitimately issued TGT that was issued by the KDC."
    },
    {
      "Time_Start": 1125.2600000000002,
      "Time_End": 1129.3000000000002,
      "Text": " So you can't even track some of the other events that we mentioned, because they're"
    },
    {
      "Time_Start": 1129.3000000000002,
      "Time_End": 1134.38,
      "Text": " just grabbing a ticket over the wire that's already been created and modifying that."
    },
    {
      "Time_Start": 1134.38,
      "Time_End": 1138.5000000000002,
      "Text": " So what the adversary is going to be doing with the Diamond Ticket attack is there's"
    },
    {
      "Time_Start": 1138.5000000000002,
      "Time_End": 1146.46,
      "Text": " a portion of every TGT called the pack, and that pack is encrypted, signed with a Caribbean"
    },
    {
      "Time_Start": 1146.46,
      "Time_End": 1149.8600000000001,
      "Text": " TGT hash, and in there it's going to show the permissions the user has, the date the"
    },
    {
      "Time_Start": 1149.8600000000001,
      "Time_End": 1154.8600000000001,
      "Text": " ticket expires, lots of other useful information just for the local administration of what"
    },
    {
      "Time_Start": 1154.8600000000001,
      "Time_End": 1156.7400000000002,
      "Text": " that ticket has access to."
    },
    {
      "Time_Start": 1156.7400000000002,
      "Time_End": 1163.66,
      "Text": " So what the adversary is going to do is, once they're able to break the Caribbean TGT hash,"
    },
    {
      "Time_Start": 1163.66,
      "Time_End": 1168.46,
      "Text": " they can use that to decrypt the whole ticket as a whole, and I'll jump here real quick,"
    },
    {
      "Time_Start": 1168.46,
      "Time_End": 1173.3000000000002,
      "Text": " just a little out of order, but you can decrypt that pack, modify it to give you the permissions"
    },
    {
      "Time_Start": 1173.3000000000002,
      "Time_End": 1177.38,
      "Text": " you need, and then use that ticket that was already legitimately issued."
    },
    {
      "Time_Start": 1177.38,
      "Time_End": 1180.6200000000001,
      "Text": " So at no point did the adversary directly ask the KDC for a ticket, they just took something"
    },
    {
      "Time_Start": 1180.6200000000001,
      "Time_End": 1183.14,
      "Text": " over the wire that was already accessed."
    },
    {
      "Time_Start": 1183.14,
      "Time_End": 1189.14,
      "Text": " So again, we can try to lean on these 4768 events without corresponding 4769 events."
    },
    {
      "Time_Start": 1189.14,
      "Time_End": 1193.5,
      "Text": " Of course, that's not going to be foolproof or need other things in defense in depth."
    },
    {
      "Time_Start": 1193.5,
      "Time_End": 1199.3000000000002,
      "Text": " We can look at event ID 4648, which is going to be a logon with explicit credentials, 4672"
    },
    {
      "Time_Start": 1199.3000000000002,
      "Time_End": 1202.7,
      "Text": " special privileges assigned to new logon, and what we're doing here is trying to catch"
    },
    {
      "Time_Start": 1202.7,
      "Time_End": 1206.4,
      "Text": " the behavior around that Diamond Ticket, because like Josh mentioned, this is part of a larger"
    },
    {
      "Time_Start": 1206.4,
      "Time_End": 1207.4,
      "Text": " attack path."
    },
    {
      "Time_Start": 1207.4,
      "Time_End": 1210.16,
      "Text": " They're most likely not going to make a Diamond Ticket and call it a day."
    },
    {
      "Time_Start": 1210.16,
      "Time_End": 1215.0400000000002,
      "Text": " They're going to try to use their new privileges to escalate and move through the environment,"
    },
    {
      "Time_Start": 1215.0400000000002,
      "Time_End": 1218.2,
      "Text": " so the detections we're going to depend on are already existing detections we have to"
    },
    {
      "Time_Start": 1218.2,
      "Time_End": 1220.64,
      "Text": " monitor for those elevated permissions."
    },
    {
      "Time_Start": 1220.64,
      "Time_End": 1222.44,
      "Text": " You can also look for Kerberos Ticket Lifetimes."
    },
    {
      "Time_Start": 1222.44,
      "Time_End": 1228.0400000000002,
      "Text": " If the adversary is bad, they're just going to leave the default Mimikatz 10-year lifespan"
    },
    {
      "Time_Start": 1228.0400000000002,
      "Time_End": 1229.0400000000002,
      "Text": " on the ticket, right?"
    },
    {
      "Time_Start": 1229.0400000000002,
      "Time_End": 1234.3200000000002,
      "Text": " So you can just throw out a detection for 10-year lifespan, since that's not commonly"
    },
    {
      "Time_Start": 1234.3200000000002,
      "Time_End": 1235.92,
      "Text": " seen in the environment."
    },
    {
      "Time_Start": 1235.92,
      "Time_End": 1239.8400000000001,
      "Text": " Again, any adversary is worth their salt, and if they've gotten a Diamond Ticket in"
    },
    {
      "Time_Start": 1239.8400000000001,
      "Time_End": 1244.5600000000002,
      "Text": " your domain, they've invested significant resources, time, and energy into doing so,"
    },
    {
      "Time_Start": 1244.5600000000002,
      "Time_End": 1247.92,
      "Text": " they're probably going to modify it to be more similar to what they've observed in your"
    },
    {
      "Time_Start": 1247.92,
      "Time_End": 1251.3200000000002,
      "Text": " environment in terms of ticket lifespans."
    },
    {
      "Time_Start": 1251.3200000000002,
      "Time_End": 1255.72,
      "Text": " Going quickly here, so we can also track anomalies in these requests, and we have to employ additional"
    },
    {
      "Time_Start": 1255.72,
      "Time_End": 1257.2,
      "Text": " validation techniques."
    },
    {
      "Time_Start": 1257.2,
      "Time_End": 1260.3200000000002,
      "Text": " We can use tools like K-List or the Get Kerberos Ticket Cache."
    },
    {
      "Time_Start": 1260.3200000000002,
      "Time_End": 1265.24,
      "Text": " Again, that's more useful at the triage level to see, okay, I had this event that was triggered."
    },
    {
      "Time_Start": 1265.88,
      "Time_End": 1268.52,
      "Text": " The user has a SID I'm not expecting for their permissions."
    },
    {
      "Time_Start": 1268.52,
      "Time_End": 1269.52,
      "Text": " K-List their tickets."
    },
    {
      "Time_Start": 1269.52,
      "Time_End": 1270.52,
      "Text": " Oh, look at that."
    },
    {
      "Time_Start": 1270.52,
      "Time_End": 1272.52,
      "Text": " There's a Forge Ticket in their current cache."
    },
    {
      "Time_Start": 1272.52,
      "Time_End": 1276.88,
      "Text": " Again, here's just that BPMN diagram for that adversary attack path."
    },
    {
      "Time_Start": 1276.88,
      "Time_End": 1283.96,
      "Text": " All right, so going back to Golden Ticket and Diamond Ticket real quick before we get"
    },
    {
      "Time_Start": 1283.96,
      "Time_End": 1284.96,
      "Text": " into ADCS."
    },
    {
      "Time_Start": 1284.96,
      "Time_End": 1293.1200000000001,
      "Text": " In real life, if we have Defender for Endpoint, a lot of times it will have some sort of ticket-based"
    },
    {
      "Time_Start": 1293.1200000000001,
      "Time_End": 1294.1200000000001,
      "Text": " alert that we get."
    },
    {
      "Time_Start": 1294.2,
      "Time_End": 1297.8000000000002,
      "Text": " I've done augmentation with SOCKS before where we get that Defender for Alert, and it's like"
    },
    {
      "Time_Start": 1297.8000000000002,
      "Time_End": 1301.1200000000001,
      "Text": " anomalous ticket usage for a user, whatever, whatever."
    },
    {
      "Time_Start": 1301.1200000000001,
      "Time_End": 1305.24,
      "Text": " I can't tell you how many times I've seen the SOCK go, this alert is always false positive"
    },
    {
      "Time_Start": 1305.24,
      "Time_End": 1306.24,
      "Text": " prone."
    },
    {
      "Time_Start": 1306.24,
      "Time_End": 1307.24,
      "Text": " Nobody really cares about it."
    },
    {
      "Time_Start": 1307.24,
      "Time_End": 1308.24,
      "Text": " Set it to informational."
    },
    {
      "Time_Start": 1308.24,
      "Time_End": 1309.24,
      "Text": " Move on with life, right?"
    },
    {
      "Time_Start": 1309.24,
      "Time_End": 1311.24,
      "Text": " It's like it could be indicative of a very large attack path."
    },
    {
      "Time_Start": 1311.24,
      "Time_End": 1314.24,
      "Text": " It could also be a false positive, no lie, right?"
    },
    {
      "Time_Start": 1314.24,
      "Time_End": 1316.8000000000002,
      "Text": " But we have tools and capabilities that we can at least triage quickly."
    },
    {
      "Time_Start": 1316.8000000000002,
      "Time_End": 1319.5600000000002,
      "Text": " We can use things like Get Kerberos Ticket Cache."
    },
    {
      "Time_Start": 1319.5600000000002,
      "Time_End": 1321.1200000000001,
      "Text": " We also have K-List commands."
    },
    {
      "Time_Start": 1322.1200000000001,
      "Time_End": 1326.24,
      "Text": " If we're using tools like Defender for Endpoint, they have investigation packages, and they"
    },
    {
      "Time_Start": 1326.24,
      "Time_End": 1331.0000000000002,
      "Text": " can even run PowerShell cmdlets in a live response capability."
    },
    {
      "Time_Start": 1331.0000000000002,
      "Time_End": 1335.3600000000001,
      "Text": " But unfortunately what happens 99.9% of the time is the SOCK sees this alert so often"
    },
    {
      "Time_Start": 1335.3600000000001,
      "Time_End": 1340.5600000000002,
      "Text": " because there is a Kerberos ticket being requested for a service that hasn't been requested in"
    },
    {
      "Time_Start": 1340.5600000000002,
      "Time_End": 1345.0800000000002,
      "Text": " three months, and we see this alert and call it an informational call today."
    },
    {
      "Time_Start": 1345.0800000000002,
      "Time_End": 1349.0000000000002,
      "Text": " I recognize that when it comes to detecting Golden Ticket and Diamond Ticket and Sapphire"
    },
    {
      "Time_Start": 1349.0,
      "Time_End": 1353.44,
      "Text": " Ticket and who knows what Pokemon game they'll come up with next, it does get somewhat difficult"
    },
    {
      "Time_Start": 1353.44,
      "Time_End": 1358.84,
      "Text": " in real life trying to track these 4769s, 4768s when they're happening 21 million times"
    },
    {
      "Time_Start": 1358.84,
      "Time_End": 1360.24,
      "Text": " in our environment every day."
    },
    {
      "Time_Start": 1360.24,
      "Time_End": 1363.86,
      "Text": " All right, so let's talk about ADCS."
    },
    {
      "Time_Start": 1363.86,
      "Time_End": 1371.08,
      "Text": " So Active Directory Certificate Services, basically the typical operational flow for"
    },
    {
      "Time_Start": 1371.08,
      "Time_End": 1376.88,
      "Text": " an adversary getting access to the root CA and then attempting to steal the private certificate"
    },
    {
      "Time_Start": 1376.88,
      "Time_End": 1382.72,
      "Text": " is they would need a local admin or system on the CA, the Certificate Authority."
    },
    {
      "Time_Start": 1382.72,
      "Time_End": 1388.0400000000002,
      "Text": " They're going to try to identify any of the private keys on the Certificate Authority,"
    },
    {
      "Time_Start": 1388.0400000000002,
      "Time_End": 1392.7600000000002,
      "Text": " and then they're essentially going to use the domain, the data protection API or DP"
    },
    {
      "Time_Start": 1392.7600000000002,
      "Time_End": 1399.1200000000001,
      "Text": " API master key, which can be gained through having system on these machines, and decrypt"
    },
    {
      "Time_Start": 1399.1200000000001,
      "Time_End": 1403.24,
      "Text": " that private key or reestablish a new private key."
    },
    {
      "Time_Start": 1403.24,
      "Time_End": 1410.48,
      "Text": " What I've seen is I haven't seen adversaries do ADCS certificate theft beyond the capacity"
    },
    {
      "Time_Start": 1410.48,
      "Time_End": 1414.96,
      "Text": " of actually just trying to steal or copy or exfiltrate the private key, but Specter Ops"
    },
    {
      "Time_Start": 1414.96,
      "Time_End": 1420.48,
      "Text": " has researched ADCS quite a bit, and I think at this point, going a little out of order,"
    },
    {
      "Time_Start": 1420.48,
      "Time_End": 1425.32,
      "Text": " at this point we're on ADCS attack path, is it 14 or 15?"
    },
    {
      "Time_Start": 1425.32,
      "Time_End": 1429.1200000000001,
      "Text": " There it is, 13 was just published."
    },
    {
      "Time_Start": 1429.1200000000001,
      "Time_End": 1435.64,
      "Text": " So there's a whole bunch of Active Directory Certificate Services attack paths that exist."
    },
    {
      "Time_Start": 1435.64,
      "Time_End": 1439.3200000000002,
      "Text": " I haven't researched all of them, just because there are so many of them now at this point."
    },
    {
      "Time_Start": 1439.3200000000002,
      "Time_End": 1443.64,
      "Text": " I've researched basically the adversary was able to get to the root CA and they were able"
    },
    {
      "Time_Start": 1443.64,
      "Time_End": 1445.92,
      "Text": " to steal certificates that way."
    },
    {
      "Time_Start": 1445.92,
      "Time_End": 1450.2800000000002,
      "Text": " In the case that that happens, an adversary can essentially forge a certificate for any"
    },
    {
      "Time_Start": 1450.2800000000002,
      "Time_End": 1456.0400000000002,
      "Text": " user in the environment except for the Kerabit TGT, and then from a domain persistence perspective,"
    },
    {
      "Time_Start": 1456.04,
      "Time_End": 1462.12,
      "Text": " they can use the stolen private key, forge their own certificates, generate a custom"
    },
    {
      "Time_Start": 1462.12,
      "Time_End": 1467.8,
      "Text": " TGT, and then cache that for that session specifically."
    },
    {
      "Time_Start": 1467.8,
      "Time_End": 1472.1599999999999,
      "Text": " Will and Lee have done a lot of research, I think Certified Pre-Owned came out a couple"
    },
    {
      "Time_Start": 1472.1599999999999,
      "Time_End": 1477.1599999999999,
      "Text": " years ago, and in there, if you haven't already read it, I highly recommend it, especially"
    },
    {
      "Time_Start": 1477.1599999999999,
      "Time_End": 1483.24,
      "Text": " if you are a defender, because not only do they have these attack paths, they also have"
    },
    {
      "Time_Start": 1483.24,
      "Time_End": 1491.1200000000001,
      "Text": " detect1, detect2, detect3, and they have really, really, really well-researched..."
    },
    {
      "Time_Start": 1491.1200000000001,
      "Time_End": 1492.1200000000001,
      "Text": " They actually work."
    },
    {
      "Time_Start": 1492.1200000000001,
      "Time_End": 1495.6,
      "Text": " They actually do fire in real life detections."
    },
    {
      "Time_Start": 1495.6,
      "Time_End": 1499.84,
      "Text": " So we have a whole bunch of different custom event IDs in here that aren't typically mentioned"
    },
    {
      "Time_Start": 1499.84,
      "Time_End": 1502.56,
      "Text": " when we're talking about certificate services."
    },
    {
      "Time_Start": 1502.56,
      "Time_End": 1506.84,
      "Text": " So we have event ID 5058, so an operation on a key file was conducted."
    },
    {
      "Time_Start": 1506.84,
      "Time_End": 1510.56,
      "Text": " We also have 5061, an account opened a key file."
    },
    {
      "Time_Start": 1510.56,
      "Time_End": 1514.76,
      "Text": " We also have event IDs related to exporting, to backing up, and to accessing these keys"
    },
    {
      "Time_Start": 1514.76,
      "Time_End": 1515.76,
      "Text": " as well."
    },
    {
      "Time_Start": 1515.76,
      "Time_End": 1519.8,
      "Text": " Like I said, if you haven't read the ADCS attack paths by the Certified Pre-Owned paper"
    },
    {
      "Time_Start": 1519.8,
      "Time_End": 1523.72,
      "Text": " by Will and Lee, again, I highly, highly recommend it, especially if you're a defender."
    },
    {
      "Time_Start": 1523.72,
      "Time_End": 1526.2,
      "Text": " It's not just for offensive teams."
    },
    {
      "Time_Start": 1526.2,
      "Time_End": 1530.86,
      "Text": " All right, so if you were in here a little while ago while Chris and Dwayne gave their"
    },
    {
      "Time_Start": 1530.86,
      "Time_End": 1535.52,
      "Text": " talk on the misconfiguration manager, so I contributed to that project as well."
    },
    {
      "Time_Start": 1535.52,
      "Time_End": 1539.6399999999999,
      "Text": " I did a little bit of the defensive research and the detection research for them, and this"
    },
    {
      "Time_Start": 1539.72,
      "Time_End": 1541.92,
      "Text": " is essentially what I came up with."
    },
    {
      "Time_Start": 1541.92,
      "Time_End": 1546.5600000000002,
      "Text": " So we're talking about, there is quite a few different site takeover SSCM attack paths"
    },
    {
      "Time_Start": 1546.5600000000002,
      "Time_End": 1547.5600000000002,
      "Text": " that exist."
    },
    {
      "Time_Start": 1547.5600000000002,
      "Time_End": 1553.8400000000001,
      "Text": " What I'm going to be talking about is NTLM coercion, NTLM relay, and then eventually"
    },
    {
      "Time_Start": 1553.8400000000001,
      "Time_End": 1560.0400000000002,
      "Text": " interacting with machines in the capacity of the SSCM machine account, which is executing"
    },
    {
      "Time_Start": 1560.0400000000002,
      "Time_End": 1566.24,
      "Text": " as a local admin on whatever endpoints are in that SSCM site."
    },
    {
      "Time_Start": 1566.24,
      "Time_End": 1572.4,
      "Text": " So the simplest way I can explain it, if you're not familiar with it, is an adversary"
    },
    {
      "Time_Start": 1572.4,
      "Time_End": 1579.52,
      "Text": " can tell a, we'll call it target A, and in this case target A is going to be the SSCM"
    },
    {
      "Time_Start": 1579.52,
      "Time_End": 1584.6,
      "Text": " site server, the primary site server, and we're going to say, hey, I want to coerce"
    },
    {
      "Time_Start": 1584.6,
      "Time_End": 1590.6,
      "Text": " your authentication attempt to my attacker workstation or my attacker-controlled compromised"
    },
    {
      "Time_Start": 1590.6,
      "Time_End": 1591.6,
      "Text": " endpoint, right?"
    },
    {
      "Time_Start": 1591.6000000000001,
      "Time_End": 1596.6000000000001,
      "Text": " We're going to coerce that authentication, that SSCM site server is going to attempt"
    },
    {
      "Time_Start": 1596.6000000000001,
      "Time_End": 1600.1200000000001,
      "Text": " to authenticate to us with NTLM, okay?"
    },
    {
      "Time_Start": 1600.1200000000001,
      "Time_End": 1604.64,
      "Text": " When it attempts it, we're actually going to listen and relay it to target B, okay?"
    },
    {
      "Time_Start": 1604.64,
      "Time_End": 1609.2400000000002,
      "Text": " And target B is typically a database server that's also located within this SSCM site"
    },
    {
      "Time_Start": 1609.2400000000002,
      "Time_End": 1610.2400000000002,
      "Text": " as well."
    },
    {
      "Time_Start": 1610.2400000000002,
      "Time_End": 1615.5200000000002,
      "Text": " That SSCM site server's machine account has local admin privileges typically on any of"
    },
    {
      "Time_Start": 1615.5200000000002,
      "Time_End": 1617.6000000000001,
      "Text": " the machines that are within its site."
    },
    {
      "Time_Start": 1617.6000000000001,
      "Time_End": 1621.4800000000002,
      "Text": " So when I coerce that authentication and then I relay that local machine account's"
    },
    {
      "Time_Start": 1621.4800000000002,
      "Time_End": 1627.4800000000002,
      "Text": " authentication to that database server or that target B, right, I'm now interacting"
    },
    {
      "Time_Start": 1627.4800000000002,
      "Time_End": 1632.6000000000001,
      "Text": " with target B in the context of the SSCM machine account and I'm doing so as a local admin"
    },
    {
      "Time_Start": 1632.6000000000001,
      "Time_End": 1633.6000000000001,
      "Text": " essentially."
    },
    {
      "Time_Start": 1633.6000000000001,
      "Time_End": 1637.0800000000002,
      "Text": " And then I can start running like database queries and pull out additional information"
    },
    {
      "Time_Start": 1637.0800000000002,
      "Time_End": 1640.5600000000002,
      "Text": " or further compromise, okay?"
    },
    {
      "Time_Start": 1640.5600000000002,
      "Time_End": 1645.5000000000002,
      "Text": " After that we can start abusing things like RBAC roles, we can start getting into utilizing"
    },
    {
      "Time_Start": 1645.5,
      "Time_End": 1649.26,
      "Text": " the configuration manager API tools."
    },
    {
      "Time_Start": 1649.26,
      "Time_End": 1654.42,
      "Text": " The reason I incorporated this in there, I did a red team assessment recently and we"
    },
    {
      "Time_Start": 1654.42,
      "Time_End": 1658.54,
      "Text": " had already gotten site admin on this client's environment within about five hours."
    },
    {
      "Time_Start": 1658.54,
      "Time_End": 1659.54,
      "Text": " It was very, very quick."
    },
    {
      "Time_Start": 1659.54,
      "Time_End": 1665.06,
      "Text": " It was very, very aggressive and it was very trivial for us to do so from a red team perspective."
    },
    {
      "Time_Start": 1665.06,
      "Time_End": 1668.58,
      "Text": " And we had essentially local admin privileges on any of the endpoints within the site."
    },
    {
      "Time_Start": 1668.58,
      "Time_End": 1673.04,
      "Text": " We were then able to further compromise other SSCM sites and so we had full administrative"
    },
    {
      "Time_Start": 1673.04,
      "Time_End": 1677.5,
      "Text": " privileges over like the entire domain and its corp domain and subdomains, right?"
    },
    {
      "Time_Start": 1677.5,
      "Time_End": 1683.04,
      "Text": " So it was really, really bad and I don't typically see SSCM considered as a domain persistence"
    },
    {
      "Time_Start": 1683.04,
      "Time_End": 1684.04,
      "Text": " attack technique."
    },
    {
      "Time_Start": 1684.04,
      "Time_End": 1689.08,
      "Text": " However, I can literally just use configuration manager's API tool to cut myself beacons left"
    },
    {
      "Time_Start": 1689.08,
      "Time_End": 1695.56,
      "Text": " and right all over this environment as a local admin and that's crazy to me."
    },
    {
      "Time_Start": 1695.56,
      "Time_End": 1697.52,
      "Text": " So we have done a lot of research."
    },
    {
      "Time_Start": 1697.52,
      "Time_End": 1701.68,
      "Text": " I have done a bunch of research into detecting this as well, okay?"
    },
    {
      "Time_Start": 1701.68,
      "Time_End": 1705.6000000000001,
      "Text": " The best detection for this particular attack path is, like I said, we're going to coerce"
    },
    {
      "Time_Start": 1705.6000000000001,
      "Time_End": 1710.14,
      "Text": " that machine account authentication and relay it to another host."
    },
    {
      "Time_Start": 1710.14,
      "Time_End": 1714.88,
      "Text": " So what we can do is we can look for just successful logon events, event ID 4624, and"
    },
    {
      "Time_Start": 1714.88,
      "Time_End": 1719.68,
      "Text": " we can see that the host name here is server two."
    },
    {
      "Time_Start": 1719.68,
      "Time_End": 1725.24,
      "Text": " However, the username that logged in is SSCM$, so that's supposed to represent like the SSCM"
    },
    {
      "Time_Start": 1725.24,
      "Time_End": 1726.24,
      "Text": " site admin, right?"
    },
    {
      "Time_Start": 1726.24,
      "Time_End": 1728.28,
      "Text": " Or the SSCM site server."
    },
    {
      "Time_Start": 1728.28,
      "Time_End": 1734.0,
      "Text": " So we're seeing this SSCM site server machine account logging in to servers and hosts that"
    },
    {
      "Time_Start": 1734.0,
      "Time_End": 1739.12,
      "Text": " are not the SSCM site server and that would stand out as definitely an anomaly."
    },
    {
      "Time_Start": 1739.12,
      "Time_End": 1742.68,
      "Text": " I was able to put this detection together pretty quickly and I highly recommend you"
    },
    {
      "Time_Start": 1742.68,
      "Time_End": 1747.86,
      "Text": " add that to your organizations as well and it was very, very good at immediately picking"
    },
    {
      "Time_Start": 1747.86,
      "Time_End": 1753.0,
      "Text": " out this NTLM coercion and relay, okay?"
    },
    {
      "Time_Start": 1753.0,
      "Time_End": 1758.16,
      "Text": " The only thing to keep in mind here is that the SSCM site server, all endpoints in your"
    },
    {
      "Time_Start": 1759.0400000000002,
      "Time_End": 1762.1200000000001,
      "Text": " environment, all the machine accounts will conduct a successful logon event to your domain"
    },
    {
      "Time_Start": 1762.1200000000001,
      "Time_End": 1763.1200000000001,
      "Text": " controllers."
    },
    {
      "Time_Start": 1763.1200000000001,
      "Time_End": 1767.2,
      "Text": " This is just typical like machine accounts doing their off thing to the domain controllers"
    },
    {
      "Time_Start": 1767.2,
      "Time_End": 1773.1200000000001,
      "Text": " and you can just completely exclude this and you'd be all right, okay?"
    },
    {
      "Time_Start": 1773.1200000000001,
      "Time_End": 1777.2,
      "Text": " Additionally I haven't talked about it but we can also set SACLs on the system access"
    },
    {
      "Time_Start": 1777.2,
      "Time_End": 1779.48,
      "Text": " control list that we can do for additional auditing."
    },
    {
      "Time_Start": 1779.48,
      "Time_End": 1788.68,
      "Text": " We can set system access control list on the system management OU or container within"
    },
    {
      "Time_Start": 1788.68,
      "Time_End": 1790.92,
      "Text": " Active Directory users and computers."
    },
    {
      "Time_Start": 1790.92,
      "Time_End": 1796.84,
      "Text": " So tools like SSCM Hunter or Power SSCM, what they're going to do, or Sharp SSCM, what they're"
    },
    {
      "Time_Start": 1796.84,
      "Time_End": 1801.08,
      "Text": " going to do is for the enumeration piece of it, the find command list and stuff, they're"
    },
    {
      "Time_Start": 1801.08,
      "Time_End": 1806.44,
      "Text": " going to query Active Directory with LDAP requests and they're going to attempt to parse"
    },
    {
      "Time_Start": 1806.44,
      "Time_End": 1810.44,
      "Text": " out the system management container in Active Directory."
    },
    {
      "Time_Start": 1810.44,
      "Time_End": 1815.72,
      "Text": " System management container contains all of your SSCM or configuration manager endpoints"
    },
    {
      "Time_Start": 1815.72,
      "Time_End": 1820.24,
      "Text": " as well as any sort of configuration manager server data in Active Directory users and"
    },
    {
      "Time_Start": 1820.24,
      "Time_End": 1821.24,
      "Text": " computers, okay?"
    },
    {
      "Time_Start": 1821.24,
      "Time_End": 1825.44,
      "Text": " So you can set system access control list on that container and say, hey, fire if there's"
    },
    {
      "Time_Start": 1825.44,
      "Time_End": 1829.24,
      "Text": " an anomaly from my baseline of what normally accesses this data."
    },
    {
      "Time_Start": 1829.24,
      "Time_End": 1833.88,
      "Text": " So if there's any sort of LDAP access request to the system management container, you immediately"
    },
    {
      "Time_Start": 1833.88,
      "Time_End": 1839.1200000000001,
      "Text": " know that, hey, someone's trying to do enumeration commands in SSCM, okay?"
    },
    {
      "Time_Start": 1839.1200000000001,
      "Time_End": 1840.1200000000001,
      "Text": " All right."
    },
    {
      "Time_Start": 1840.1200000000001,
      "Time_End": 1841.1200000000001,
      "Text": " So I'll go ahead and give it to you."
    },
    {
      "Time_Start": 1841.1200000000001,
      "Time_End": 1842.1200000000001,
      "Text": " Yeah."
    },
    {
      "Time_Start": 1842.1200000000001,
      "Time_End": 1846.4,
      "Text": " So we're going to just briefly go over some of the steps that you can look at as you begin"
    },
    {
      "Time_Start": 1846.4,
      "Time_End": 1848.0400000000002,
      "Text": " your domain recovery process."
    },
    {
      "Time_Start": 1848.0400000000002,
      "Time_End": 1851.72,
      "Text": " I feel like a lot of the times when you Google this or if you ask chat GPT or whatever, it"
    },
    {
      "Time_Start": 1851.72,
      "Time_End": 1852.72,
      "Text": " will just be like rotate the KRB TGT twice."
    },
    {
      "Time_Start": 1852.72,
      "Time_End": 1856.92,
      "Text": " There's always someone from the back of the room who's always like, rotate the KRB TGT"
    },
    {
      "Time_Start": 1856.92,
      "Time_End": 1859.5600000000002,
      "Text": " twice, and it's like, hey, it's a bit more in-depth than that."
    },
    {
      "Time_Start": 1859.5600000000002,
      "Time_End": 1860.5600000000002,
      "Text": " Right."
    },
    {
      "Time_Start": 1860.5600000000002,
      "Time_End": 1861.5600000000002,
      "Text": " So it's 2024."
    },
    {
      "Time_Start": 1861.56,
      "Time_End": 1864.36,
      "Text": " So we're going to go over some additional steps that we can use to try to fully ensure"
    },
    {
      "Time_Start": 1864.36,
      "Time_End": 1867.44,
      "Text": " that the adversary has been eradicated from the domain."
    },
    {
      "Time_Start": 1867.44,
      "Time_End": 1868.9199999999998,
      "Text": " All right."
    },
    {
      "Time_Start": 1868.9199999999998,
      "Time_End": 1873.6399999999999,
      "Text": " So a lot of organizations are going to have domain recovery strategies because of compliance,"
    },
    {
      "Time_Start": 1873.6399999999999,
      "Time_End": 1874.6399999999999,
      "Text": " right?"
    },
    {
      "Time_Start": 1874.6399999999999,
      "Time_End": 1878.04,
      "Text": " A lot of organizations we see hire red teams because of compliance."
    },
    {
      "Time_Start": 1878.04,
      "Time_End": 1881.28,
      "Text": " They have certain policies in place because of compliance."
    },
    {
      "Time_Start": 1881.28,
      "Time_End": 1886.24,
      "Text": " From my side, coming from the Navy Comm Center, we had so many compliance regulations, so"
    },
    {
      "Time_Start": 1886.24,
      "Time_End": 1887.24,
      "Text": " many fail-safe documentation."
    },
    {
      "Time_Start": 1887.24,
      "Time_End": 1890.24,
      "Text": " Can I tell you how many times I looked at them?"
    },
    {
      "Time_Start": 1890.24,
      "Time_End": 1891.24,
      "Text": " No."
    },
    {
      "Time_Start": 1891.92,
      "Time_End": 1893.52,
      "Text": " Because a lot of times they're written for compliance, put on a shelf, and they just"
    },
    {
      "Time_Start": 1893.52,
      "Time_End": 1895.88,
      "Text": " collect dust until the next CISO comes in."
    },
    {
      "Time_Start": 1895.88,
      "Time_End": 1899.54,
      "Text": " So what we want to do, right, is help walk through some steps that provide quality and"
    },
    {
      "Time_Start": 1899.54,
      "Time_End": 1901.24,
      "Text": " valid testing."
    },
    {
      "Time_Start": 1901.24,
      "Time_End": 1904.84,
      "Text": " Because without those two things, you can't fully be assured that the adversary has been"
    },
    {
      "Time_Start": 1904.84,
      "Time_End": 1906.16,
      "Text": " eradicated from your domain."
    },
    {
      "Time_Start": 1906.16,
      "Time_End": 1909.52,
      "Text": " We've worked with clients before, thought they eradicated the adversary, found additional"
    },
    {
      "Time_Start": 1909.52,
      "Time_End": 1912.32,
      "Text": " behavior when we came back for a second pen test, right?"
    },
    {
      "Time_Start": 1912.32,
      "Time_End": 1914.16,
      "Text": " Can't potentially be an issue."
    },
    {
      "Time_Start": 1914.16,
      "Time_End": 1916.88,
      "Text": " So some of the things we're going to talk about when we're talking about ensuring these"
    },
    {
      "Time_Start": 1916.88,
      "Time_End": 1921.04,
      "Text": " quality strategies, we're going to talk about the strategy per environment category, right?"
    },
    {
      "Time_Start": 1921.84,
      "Time_End": 1922.84,
      "Text": " We don't want to do a one-size-fits-all."
    },
    {
      "Time_Start": 1922.84,
      "Time_End": 1927.96,
      "Text": " Again, the issue with domain persistence is because everyone's AD environment looks so"
    },
    {
      "Time_Start": 1927.96,
      "Time_End": 1931.8999999999999,
      "Text": " different, you have to tailor it and go through kind of these research and validation steps"
    },
    {
      "Time_Start": 1931.8999999999999,
      "Time_End": 1934.48,
      "Text": " within your environment to see what works for you."
    },
    {
      "Time_Start": 1934.48,
      "Time_End": 1937.52,
      "Text": " We also want to ensure each strategy has a successful exit scenario, right?"
    },
    {
      "Time_Start": 1937.52,
      "Time_End": 1942.04,
      "Text": " We want to make sure we have a point at which we can say, under our policies, we have done"
    },
    {
      "Time_Start": 1942.04,
      "Time_End": 1946.0,
      "Text": " our due diligence and the adversary has been eliminated from our environment to the best"
    },
    {
      "Time_Start": 1946.0,
      "Time_End": 1947.0,
      "Text": " of our knowledge and abilities, right?"
    },
    {
      "Time_Start": 1947.0,
      "Time_End": 1948.0,
      "Text": " And that's all we can do."
    },
    {
      "Time_Start": 1948.2,
      "Time_End": 1953.44,
      "Text": " We're not saying these are going to guarantee 100% ... the adversary's gone 100% completely"
    },
    {
      "Time_Start": 1953.44,
      "Time_End": 1958.12,
      "Text": " eradicated, but you should have some steps, some metrics that you're using to help drive"
    },
    {
      "Time_Start": 1958.12,
      "Time_End": 1963.44,
      "Text": " how you arrive at what you feel safe as with risk in terms of an organization."
    },
    {
      "Time_Start": 1963.44,
      "Time_End": 1966.08,
      "Text": " You also have to consider worst-case scenarios, right?"
    },
    {
      "Time_Start": 1966.08,
      "Time_End": 1969.88,
      "Text": " How are you going to recover a theme if the DC that manages that RDP authentication is"
    },
    {
      "Time_Start": 1969.88,
      "Time_End": 1970.88,
      "Text": " compromised, right?"
    },
    {
      "Time_Start": 1970.88,
      "Time_End": 1975.64,
      "Text": " How are we going to use some of these default tools in a worst-case scenario, right?"
    },
    {
      "Time_Start": 1975.64,
      "Time_End": 1979.0800000000002,
      "Text": " If the adversary has a diamond ticket, a sapphire ticket, a golden ticket, it's been"
    },
    {
      "Time_Start": 1979.0800000000002,
      "Time_End": 1982.3200000000002,
      "Text": " able to elevate and gain global access through the domain."
    },
    {
      "Time_Start": 1982.3200000000002,
      "Time_End": 1988.0800000000002,
      "Text": " I mean, we just saw recently, right, with MGM, what having a global domain admin did"
    },
    {
      "Time_Start": 1988.0800000000002,
      "Time_End": 1990.44,
      "Text": " to that organization, right?"
    },
    {
      "Time_Start": 1990.44,
      "Time_End": 1994.0800000000002,
      "Text": " You don't necessarily have to come up with huge exhaustive lifts for like end-of-the-world"
    },
    {
      "Time_Start": 1994.0800000000002,
      "Time_End": 1997.44,
      "Text": " scenarios, but you do need to consider the worst-case scenario for an organization."
    },
    {
      "Time_Start": 1997.44,
      "Time_End": 2001.2,
      "Text": " And that does require identifying what are our tier zero assets, what are our crown jewels,"
    },
    {
      "Time_Start": 2001.2,
      "Time_End": 2002.2,
      "Text": " what do we care about?"
    },
    {
      "Time_Start": 2003.2,
      "Time_End": 2005.8400000000001,
      "Text": " So some of the guidance we're going to talk about is determining the scope, how you can"
    },
    {
      "Time_Start": 2005.8400000000001,
      "Time_End": 2010.76,
      "Text": " do that, replacing or reprovisioning domain controllers, that will most likely be necessary"
    },
    {
      "Time_Start": 2010.76,
      "Time_End": 2014.8,
      "Text": " if domain controllers have been compromised, rotating accounts and object secrets, rotating"
    },
    {
      "Time_Start": 2014.8,
      "Time_End": 2017.92,
      "Text": " certificates, enable additional auditing, right?"
    },
    {
      "Time_Start": 2017.92,
      "Time_End": 2021.72,
      "Text": " And again, the point being a lot of these security event IDs that we've talked about"
    },
    {
      "Time_Start": 2021.72,
      "Time_End": 2026.16,
      "Text": " from Sysmon and Windows are not enabled by default, especially if it's Sysmon, right,"
    },
    {
      "Time_Start": 2026.16,
      "Time_End": 2028.48,
      "Text": " because you have to put Sysmon on the host."
    },
    {
      "Time_Start": 2028.48,
      "Time_End": 2031.92,
      "Text": " So looking into these sackles and finding the objects you care about and then enabling"
    },
    {
      "Time_Start": 2032.64,
      "Time_End": 2037.04,
      "Text": " those sackles to generate those IDs is important, because the event IDs I was talking about"
    },
    {
      "Time_Start": 2037.04,
      "Time_End": 2039.04,
      "Text": " for going and taking a diamond ticket, right, those are not by default."
    },
    {
      "Time_Start": 2039.04,
      "Time_End": 2043.3600000000001,
      "Text": " You have to set a sackle on Kerberos, which requires a few different, or on the KDC, which"
    },
    {
      "Time_Start": 2043.3600000000001,
      "Time_End": 2045.76,
      "Text": " requires a few different steps in your environment."
    },
    {
      "Time_Start": 2045.76,
      "Time_End": 2050.0,
      "Text": " All right, so for the scope of the investigation and containment, this is going to be focused"
    },
    {
      "Time_Start": 2050.0,
      "Time_End": 2052.4,
      "Text": " on systems or users that were flagged and alert, right?"
    },
    {
      "Time_Start": 2052.4,
      "Time_End": 2057.84,
      "Text": " Your SOC received a detection, either received a list of a potential host or domain that"
    },
    {
      "Time_Start": 2057.84,
      "Time_End": 2059.56,
      "Text": " was compromised."
    },
    {
      "Time_Start": 2059.56,
      "Time_End": 2063.7599999999998,
      "Text": " And then you're also going to talk about the impact of that privileged access, right?"
    },
    {
      "Time_Start": 2063.7599999999998,
      "Time_End": 2068.12,
      "Text": " So you're going to talk about how the severity can be escalated due to the privileged access"
    },
    {
      "Time_Start": 2068.12,
      "Time_End": 2070.0,
      "Text": " required from domain persistence."
    },
    {
      "Time_Start": 2070.0,
      "Time_End": 2074.52,
      "Text": " You don't get seeded access and immediately get domain persistence, you get a domain admin,"
    },
    {
      "Time_Start": 2074.52,
      "Time_End": 2078.04,
      "Text": " which again has additional issues we have to think about in our consideration for detection"
    },
    {
      "Time_Start": 2078.04,
      "Time_End": 2080.24,
      "Text": " and removal of the adversary."
    },
    {
      "Time_Start": 2080.24,
      "Time_End": 2083.36,
      "Text": " And like we talked about at the beginning, it's going to be evidence of that larger attack"
    },
    {
      "Time_Start": 2083.36,
      "Time_End": 2087.32,
      "Text": " path, because it takes time, money, energy, and talented people to successfully carry"
    },
    {
      "Time_Start": 2087.32,
      "Time_End": 2089.2,
      "Text": " out a domain persistence attack."
    },
    {
      "Time_Start": 2089.2,
      "Time_End": 2093.08,
      "Text": " It's most likely not just going to be for fun, although it could be, who knows?"
    },
    {
      "Time_Start": 2093.08,
      "Time_End": 2097.7599999999998,
      "Text": " So identifying the population of affected systems and users, we want to look at our"
    },
    {
      "Time_Start": 2097.7599999999998,
      "Time_End": 2098.7599999999998,
      "Text": " known affected systems."
    },
    {
      "Time_Start": 2098.7599999999998,
      "Time_End": 2101.68,
      "Text": " So there's going to be tier zero systems are going to be where our initial focus is, right?"
    },
    {
      "Time_Start": 2101.68,
      "Time_End": 2102.68,
      "Text": " Makes sense."
    },
    {
      "Time_Start": 2102.68,
      "Time_End": 2106.9199999999996,
      "Text": " We want to drive the adversary from tools and capabilities that allow them to authenticate"
    },
    {
      "Time_Start": 2106.9199999999996,
      "Time_End": 2111.16,
      "Text": " themselves, elevate themselves, move through different portions of the domain laterally."
    },
    {
      "Time_Start": 2111.16,
      "Time_End": 2114.6,
      "Text": " So looking at those access points and choke points first is what we want to do."
    },
    {
      "Time_Start": 2114.6,
      "Time_End": 2117.2,
      "Text": " So domain controllers, the Caribbean TGC service account, right?"
    },
    {
      "Time_Start": 2117.2,
      "Time_End": 2121.2799999999997,
      "Text": " Seeing if that password was leaked potentially over the wire and traffic if the adversary"
    },
    {
      "Time_Start": 2121.2799999999997,
      "Time_End": 2122.2799999999997,
      "Text": " slipped up."
    },
    {
      "Time_Start": 2122.2799999999997,
      "Time_End": 2123.72,
      "Text": " We want to look at those certificates that Josh mentioned."
    },
    {
      "Time_Start": 2123.72,
      "Time_End": 2126.56,
      "Text": " We also want to look at that primary site server that could potentially be used for"
    },
    {
      "Time_Start": 2126.56,
      "Time_End": 2128.52,
      "Text": " the SCCM attacks."
    },
    {
      "Time_Start": 2128.52,
      "Time_End": 2133.12,
      "Text": " And when we're looking at those potentially affected systems, we want to consider what"
    },
    {
      "Time_Start": 2133.12,
      "Time_End": 2135.8399999999997,
      "Text": " that privileged access means, right?"
    },
    {
      "Time_Start": 2135.8399999999997,
      "Time_End": 2139.3199999999997,
      "Text": " If you're a financial institution, that could be a totally different thing than if you're"
    },
    {
      "Time_Start": 2139.3199999999997,
      "Time_End": 2145.72,
      "Text": " a biotechnology company with secrets, patents, whatever that you want to keep on guard, right?"
    },
    {
      "Time_Start": 2145.7200000000003,
      "Time_End": 2149.28,
      "Text": " Two different goals of security, two different tier zero assets that you could potentially"
    },
    {
      "Time_Start": 2149.28,
      "Time_End": 2150.28,
      "Text": " care about."
    },
    {
      "Time_Start": 2150.28,
      "Time_End": 2153.1600000000003,
      "Text": " So you're going to determine those principles locally, determine what your tier zero is"
    },
    {
      "Time_Start": 2153.1600000000003,
      "Time_End": 2157.9,
      "Text": " in your organization, and kind of move from there forward through your recovery steps."
    },
    {
      "Time_Start": 2157.9,
      "Time_End": 2161.6400000000003,
      "Text": " And the goal here is going to be identify that accurate scope so that you can contain"
    },
    {
      "Time_Start": 2161.6400000000003,
      "Time_End": 2162.7200000000003,
      "Text": " quickly, right?"
    },
    {
      "Time_Start": 2162.7200000000003,
      "Time_End": 2165.96,
      "Text": " You want to, as quickly as possible, remove the ability of the adversary to exfiltrate"
    },
    {
      "Time_Start": 2165.96,
      "Time_End": 2168.5600000000004,
      "Text": " data and move laterally within the environment."
    },
    {
      "Time_Start": 2168.56,
      "Time_End": 2177.64,
      "Text": " All right, so let's talk about reprovisioning or replacing the domain controllers, okay?"
    },
    {
      "Time_Start": 2177.64,
      "Time_End": 2182.36,
      "Text": " So like I said, with these tech techniques, the common denominator here is that it's generally"
    },
    {
      "Time_Start": 2182.36,
      "Time_End": 2184.72,
      "Text": " very difficult to scope these, okay?"
    },
    {
      "Time_Start": 2184.72,
      "Time_End": 2188.44,
      "Text": " In the case that I was talking about, the adversary had dumped credentials on the domain"
    },
    {
      "Time_Start": 2188.44,
      "Time_End": 2192.04,
      "Text": " controller for that particular client, and so we had to really consider reprovisioning"
    },
    {
      "Time_Start": 2192.04,
      "Time_End": 2194.12,
      "Text": " the domain controllers."
    },
    {
      "Time_Start": 2194.12,
      "Time_End": 2195.12,
      "Text": " That's not always the case, okay?"
    },
    {
      "Time_Start": 2195.68,
      "Time_End": 2198.68,
      "Text": " And it's not the case for all these attack paths."
    },
    {
      "Time_Start": 2198.68,
      "Time_End": 2202.7999999999997,
      "Text": " However, there are some inherent risks that you're going to have to accept when an adversary"
    },
    {
      "Time_Start": 2202.7999999999997,
      "Time_End": 2206.24,
      "Text": " achieves the level of access that they have, and we see any of these domain persistence"
    },
    {
      "Time_Start": 2206.24,
      "Time_End": 2207.88,
      "Text": " techniques, okay?"
    },
    {
      "Time_Start": 2207.88,
      "Time_End": 2210.7999999999997,
      "Text": " There are some limitations in security rotation."
    },
    {
      "Time_Start": 2210.7999999999997,
      "Time_End": 2217.16,
      "Text": " For example, Microsoft says that you cannot rotate the domain DPAPI backup key, which"
    },
    {
      "Time_Start": 2217.16,
      "Time_End": 2218.2,
      "Text": " is kind of true."
    },
    {
      "Time_Start": 2218.2,
      "Time_End": 2223.12,
      "Text": " We did some side research, and you actually can rotate the domain DPAPI backup key."
    },
    {
      "Time_Start": 2223.12,
      "Time_End": 2228.16,
      "Text": " The problem is most organizations are not going to trust third-party tools to rotate"
    },
    {
      "Time_Start": 2228.16,
      "Time_End": 2233.3599999999997,
      "Text": " something that, if messed up, will just completely encrypt the entire environment."
    },
    {
      "Time_Start": 2233.3599999999997,
      "Time_End": 2234.3599999999997,
      "Text": " Fair enough."
    },
    {
      "Time_Start": 2234.3599999999997,
      "Time_End": 2235.3599999999997,
      "Text": " Fair enough."
    },
    {
      "Time_Start": 2235.3599999999997,
      "Time_End": 2236.3599999999997,
      "Text": " Yeah."
    },
    {
      "Time_Start": 2236.3599999999997,
      "Time_End": 2239.7599999999998,
      "Text": " And then also, it was kind of a 50-50 shot."
    },
    {
      "Time_Start": 2239.7599999999998,
      "Time_End": 2245.2799999999997,
      "Text": " The way that you actually rotate the domain DPAPI backup key is by deleting the reference"
    },
    {
      "Time_Start": 2245.2799999999997,
      "Time_End": 2251.44,
      "Text": " pointer to the domain DPAPI backup key, and if you delete it, it should, Active Directory"
    },
    {
      "Time_Start": 2251.44,
      "Time_End": 2257.04,
      "Text": " should basically recreate a new domain DPAPI backup key, okay?"
    },
    {
      "Time_Start": 2257.04,
      "Time_End": 2259.56,
      "Text": " However, if it doesn't, you have a 50-50 chance here."
    },
    {
      "Time_Start": 2259.56,
      "Time_End": 2264.28,
      "Text": " If it doesn't, you've just encrypted and ransomwared your entire organization, which would be really,"
    },
    {
      "Time_Start": 2264.28,
      "Time_End": 2265.28,
      "Text": " really terrible."
    },
    {
      "Time_Start": 2265.28,
      "Time_End": 2270.16,
      "Text": " So we don't recommend doing that, and neither does Microsoft, and that's fair enough, right?"
    },
    {
      "Time_Start": 2270.16,
      "Time_End": 2272.12,
      "Text": " So let's talk about reprovisioning a domain controller."
    },
    {
      "Time_Start": 2272.12,
      "Time_End": 2273.64,
      "Text": " I'm not going to get into all these steps."
    },
    {
      "Time_Start": 2273.64,
      "Time_End": 2275.6,
      "Text": " Like I said, use the slides as a reference later on."
    },
    {
      "Time_Start": 2275.6,
      "Time_End": 2279.0,
      "Text": " Those are my favorite type of presentations where you can go back and download them and"
    },
    {
      "Time_Start": 2279.0,
      "Time_End": 2281.0,
      "Text": " use them over and over again."
    },
    {
      "Time_Start": 2281.56,
      "Time_End": 2286.92,
      "Text": " So just from a high level, the key to reprovisioning a domain controller is making sure that you're"
    },
    {
      "Time_Start": 2286.92,
      "Time_End": 2292.28,
      "Text": " doing or conducting these health checks throughout the whole process and validating that replication"
    },
    {
      "Time_Start": 2292.28,
      "Time_End": 2296.16,
      "Text": " has occurred successfully, and there's a couple of different ways we can do that."
    },
    {
      "Time_Start": 2296.16,
      "Time_End": 2300.72,
      "Text": " These steps essentially right here, we have repadmin, repsummary, repadmin queue, repadmin"
    },
    {
      "Time_Start": 2300.72,
      "Time_End": 2302.52,
      "Text": " show errors only."
    },
    {
      "Time_Start": 2302.52,
      "Time_End": 2305.44,
      "Text": " These are essentially how we can check the health of the domain controller and make sure"
    },
    {
      "Time_Start": 2305.44,
      "Time_End": 2309.24,
      "Text": " that it is correctly replicating across the domain."
    },
    {
      "Time_Start": 2309.2400000000002,
      "Time_End": 2312.96,
      "Text": " When we are reprovisioning a domain controller or taking an existing server and promoting"
    },
    {
      "Time_Start": 2312.96,
      "Time_End": 2314.0400000000004,
      "Text": " its domain controller."
    },
    {
      "Time_Start": 2314.0400000000004,
      "Time_End": 2317.32,
      "Text": " The reason we have to make sure we get this right is because if we work this process and"
    },
    {
      "Time_Start": 2317.32,
      "Time_End": 2322.5600000000004,
      "Text": " we did not check health, we could end up just ruining DC to DC communication, which can"
    },
    {
      "Time_Start": 2322.5600000000004,
      "Time_End": 2325.1200000000003,
      "Text": " severely hamper your recovery process."
    },
    {
      "Time_Start": 2325.1200000000003,
      "Time_End": 2326.34,
      "Text": " You're increasing dwell time."
    },
    {
      "Time_Start": 2326.34,
      "Time_End": 2330.0400000000004,
      "Text": " You're also costing production a massive amount of money."
    },
    {
      "Time_Start": 2330.0400000000004,
      "Time_End": 2331.8,
      "Text": " So we have to be very, very careful."
    },
    {
      "Time_Start": 2331.8,
      "Time_End": 2334.7200000000003,
      "Text": " These steps have to be very carefully considered for your organization."
    },
    {
      "Time_Start": 2334.7200000000003,
      "Time_End": 2339.28,
      "Text": " I've been querying and polling a whole bunch of companies, and nobody is considering these"
    },
    {
      "Time_Start": 2339.28,
      "Time_End": 2340.28,
      "Text": " steps."
    },
    {
      "Time_Start": 2340.28,
      "Time_End": 2345.4800000000005,
      "Text": " Very few organizations are actually testing and validating their electronic compromise"
    },
    {
      "Time_Start": 2345.4800000000005,
      "Time_End": 2346.4800000000005,
      "Text": " strategies."
    },
    {
      "Time_Start": 2346.4800000000005,
      "Time_End": 2350.32,
      "Text": " Most of them just have it because of SOC 2 compliance, which is great."
    },
    {
      "Time_Start": 2350.32,
      "Time_End": 2351.32,
      "Text": " All right."
    },
    {
      "Time_Start": 2351.32,
      "Time_End": 2353.92,
      "Text": " We've also got to consider rotating user accounts."
    },
    {
      "Time_Start": 2353.92,
      "Time_End": 2355.2000000000003,
      "Text": " Rotating user accounts is trivial."
    },
    {
      "Time_Start": 2355.2000000000003,
      "Time_End": 2359.6800000000003,
      "Text": " Most organizations do it on a periodic basis anyways, and there's a whole bunch of scripts"
    },
    {
      "Time_Start": 2359.6800000000003,
      "Time_End": 2361.5200000000004,
      "Text": " out there that will help you do it."
    },
    {
      "Time_Start": 2361.5200000000004,
      "Time_End": 2363.76,
      "Text": " When it comes to service accounts, service accounts are a little trickier."
    },
    {
      "Time_Start": 2363.8,
      "Time_End": 2368.6800000000003,
      "Text": " 90% of the organizations I work with have some sort of decrepit legacy service account"
    },
    {
      "Time_Start": 2368.6800000000003,
      "Time_End": 2372.6800000000003,
      "Text": " made by some software manufacturer that hasn't existed for the last three decades because"
    },
    {
      "Time_Start": 2372.6800000000003,
      "Time_End": 2377.48,
      "Text": " everyone who made it is either dead or retired, and they cannot change the service account"
    },
    {
      "Time_Start": 2377.48,
      "Time_End": 2381.84,
      "Text": " for any reason because the entire production rides on this one service account shoulder."
    },
    {
      "Time_Start": 2381.84,
      "Time_End": 2382.84,
      "Text": " I get it."
    },
    {
      "Time_Start": 2382.84,
      "Time_End": 2383.84,
      "Text": " All right."
    },
    {
      "Time_Start": 2383.84,
      "Time_End": 2385.0,
      "Text": " Document those things."
    },
    {
      "Time_Start": 2385.0,
      "Time_End": 2388.88,
      "Text": " That way you know when it comes to these sort of scenarios, it's like, hey, we can rotate"
    },
    {
      "Time_Start": 2388.88,
      "Time_End": 2392.6000000000004,
      "Text": " everything except this account right here because we will just completely destroy our"
    },
    {
      "Time_Start": 2392.6,
      "Time_End": 2393.6,
      "Text": " production capability."
    },
    {
      "Time_Start": 2393.6,
      "Time_End": 2394.6,
      "Text": " Okay?"
    },
    {
      "Time_Start": 2394.6,
      "Time_End": 2396.2799999999997,
      "Text": " Same thing kind of goes for Kerberoastable accounts."
    },
    {
      "Time_Start": 2396.2799999999997,
      "Time_End": 2399.7,
      "Text": " If you're an organization that gets frequently pin tested and you're getting Kerberoastable"
    },
    {
      "Time_Start": 2399.7,
      "Time_End": 2404.2599999999998,
      "Text": " pin tests over and over, the one thing that I like to see from clients and organizations,"
    },
    {
      "Time_Start": 2404.2599999999998,
      "Time_End": 2408.96,
      "Text": " if we can Kerberoast a particular legacy service account, I like them to come show me and say,"
    },
    {
      "Time_Start": 2408.96,
      "Time_End": 2409.96,
      "Text": " hey, we know."
    },
    {
      "Time_Start": 2409.96,
      "Time_End": 2410.96,
      "Text": " This is a known finding."
    },
    {
      "Time_Start": 2410.96,
      "Time_End": 2413.0,
      "Text": " We've documented our Kerberoastable accounts."
    },
    {
      "Time_Start": 2413.0,
      "Time_End": 2417.16,
      "Text": " We know which ones we cannot rotate because all the production lies upon their shoulders."
    },
    {
      "Time_Start": 2417.16,
      "Time_End": 2418.16,
      "Text": " We know."
    },
    {
      "Time_Start": 2418.16,
      "Time_End": 2421.72,
      "Text": " But what you can do as a defender is you can set up additional system access control lists,"
    },
    {
      "Time_Start": 2421.84,
      "Time_End": 2427.2400000000002,
      "Text": " you can set up additional auditing on those service accounts so that when maybe you cannot"
    },
    {
      "Time_Start": 2427.2400000000002,
      "Time_End": 2431.2000000000003,
      "Text": " rotate them, you can at least monitor them significantly closer."
    },
    {
      "Time_Start": 2431.2000000000003,
      "Time_End": 2432.2000000000003,
      "Text": " Okay?"
    },
    {
      "Time_Start": 2432.2000000000003,
      "Time_End": 2434.2000000000003,
      "Text": " All right."
    },
    {
      "Time_Start": 2434.2000000000003,
      "Time_End": 2435.7200000000003,
      "Text": " So that's just kind of the same thing."
    },
    {
      "Time_Start": 2435.7200000000003,
      "Time_End": 2438.6000000000004,
      "Text": " Communicate with search security engineering for the purposes of minimal disruption of"
    },
    {
      "Time_Start": 2438.6000000000004,
      "Time_End": 2439.6000000000004,
      "Text": " production."
    },
    {
      "Time_Start": 2439.6000000000004,
      "Time_End": 2442.92,
      "Text": " When we're talking about the KRB-TGT, okay?"
    },
    {
      "Time_Start": 2442.92,
      "Time_End": 2446.88,
      "Text": " So you do rotate it twice, but it's a bit more complicated than that."
    },
    {
      "Time_Start": 2446.88,
      "Time_End": 2449.92,
      "Text": " Microsoft has a script called new KRB-TGT keys."
    },
    {
      "Time_Start": 2449.92,
      "Time_End": 2451.32,
      "Text": " It's a PowerShell script."
    },
    {
      "Time_Start": 2451.92,
      "Time_End": 2455.6800000000003,
      "Text": " What it will do, which is really, really helpful, is it will check the replication health of"
    },
    {
      "Time_Start": 2455.6800000000003,
      "Time_End": 2460.32,
      "Text": " your organization or your domain controllers as you're rotating the KRB-TGT."
    },
    {
      "Time_Start": 2460.32,
      "Time_End": 2461.6400000000003,
      "Text": " You can just simply run it."
    },
    {
      "Time_Start": 2461.6400000000003,
      "Time_End": 2462.84,
      "Text": " It will rotate it once."
    },
    {
      "Time_Start": 2462.84,
      "Time_End": 2464.28,
      "Text": " It'll validate health is good."
    },
    {
      "Time_Start": 2464.28,
      "Time_End": 2466.32,
      "Text": " It'll validate replication is good."
    },
    {
      "Time_Start": 2466.32,
      "Time_End": 2470.2000000000003,
      "Text": " It'll validate that the other domain controllers that were required in the scope have also"
    },
    {
      "Time_Start": 2470.2000000000003,
      "Time_End": 2472.0800000000004,
      "Text": " taken the new KRB-TGT account."
    },
    {
      "Time_Start": 2472.0800000000004,
      "Time_End": 2473.0800000000004,
      "Text": " And then it'll rotate it again."
    },
    {
      "Time_Start": 2473.0800000000004,
      "Time_End": 2474.0800000000004,
      "Text": " Okay?"
    },
    {
      "Time_Start": 2474.0800000000004,
      "Time_End": 2477.48,
      "Text": " And the reason you do that is because the KRB-TGT account will save the previous password."
    },
    {
      "Time_Start": 2477.48,
      "Time_End": 2478.48,
      "Text": " Okay?"
    },
    {
      "Time_Start": 2478.48,
      "Time_End": 2479.48,
      "Text": " We're running close on time, so I'm trying to go quick."
    },
    {
      "Time_Start": 2479.48,
      "Time_End": 2480.48,
      "Text": " Okay?"
    },
    {
      "Time_Start": 2481.2,
      "Time_End": 2484.4,
      "Text": " When it comes to machine accounts, I do have some considerations when it comes to rotating"
    },
    {
      "Time_Start": 2484.4,
      "Time_End": 2485.4,
      "Text": " machine accounts."
    },
    {
      "Time_Start": 2485.4,
      "Time_End": 2489.56,
      "Text": " But the truth is, typically, machine accounts are already every 30 days by default going"
    },
    {
      "Time_Start": 2489.56,
      "Time_End": 2492.2400000000002,
      "Text": " and getting a new machine account password."
    },
    {
      "Time_Start": 2492.2400000000002,
      "Time_End": 2496.48,
      "Text": " If you are a pen tester or a red team or just a hobbyist, if you ever dump credentials,"
    },
    {
      "Time_Start": 2496.48,
      "Time_End": 2498.72,
      "Text": " typically you'll dump the machine account credentials as well."
    },
    {
      "Time_Start": 2498.72,
      "Time_End": 2499.72,
      "Text": " You've seen those passwords."
    },
    {
      "Time_Start": 2499.72,
      "Time_End": 2502.44,
      "Text": " Those things are like 30-something characters long, and they look ugly as hell."
    },
    {
      "Time_Start": 2502.44,
      "Time_End": 2504.3,
      "Text": " Ain't nobody guessing that thing, right?"
    },
    {
      "Time_Start": 2504.3,
      "Time_End": 2508.84,
      "Text": " So when it comes to machine account password rotations, though it is probably a necessary"
    },
    {
      "Time_Start": 2508.84,
      "Time_End": 2513.4,
      "Text": " step from the put your head to sleep at night and feel confident that the adversary's been"
    },
    {
      "Time_Start": 2513.4,
      "Time_End": 2518.32,
      "Text": " eradicated, I wouldn't necessarily say it's absolutely necessary to complete a full domain"
    },
    {
      "Time_Start": 2518.32,
      "Time_End": 2519.32,
      "Text": " recovery."
    },
    {
      "Time_Start": 2519.32,
      "Time_End": 2520.32,
      "Text": " Okay?"
    },
    {
      "Time_Start": 2520.32,
      "Time_End": 2523.08,
      "Text": " I do want to quickly talk about domain forest."
    },
    {
      "Time_Start": 2523.08,
      "Time_End": 2528.92,
      "Text": " So if the adversary is able to abuse trust delegation and trust hops between the forest,"
    },
    {
      "Time_Start": 2528.92,
      "Time_End": 2533.32,
      "Text": " right, we do want to consider that the inner realm trust key could be compromised."
    },
    {
      "Time_Start": 2533.32,
      "Time_End": 2534.7200000000003,
      "Text": " There is a way to rotate that."
    },
    {
      "Time_Start": 2534.7200000000003,
      "Time_End": 2538.7200000000003,
      "Text": " Trust hop does have documentation based on using the net dom binary that will go and"
    },
    {
      "Time_Start": 2538.7200000000003,
      "Time_End": 2540.84,
      "Text": " rotate the inner realm trust key."
    },
    {
      "Time_Start": 2540.84,
      "Time_End": 2543.6400000000003,
      "Text": " This is kind of hard to source out and find."
    },
    {
      "Time_Start": 2543.6400000000003,
      "Time_End": 2548.36,
      "Text": " The trick to this is there is a, like, you have to do a trust side to an untrust side,"
    },
    {
      "Time_Start": 2548.36,
      "Time_End": 2551.0000000000005,
      "Text": " and you have to kind of make sure that you're doing everything correctly."
    },
    {
      "Time_Start": 2551.0000000000005,
      "Time_End": 2552.0000000000005,
      "Text": " It's a bit tricky."
    },
    {
      "Time_Start": 2552.0000000000005,
      "Time_End": 2555.0400000000004,
      "Text": " Nico and I have a blog post where the second half of that blog post does kind of give an"
    },
    {
      "Time_Start": 2555.0400000000004,
      "Time_End": 2558.2400000000002,
      "Text": " example scenario of how to rotate the inner realm trust key."
    },
    {
      "Time_Start": 2558.2400000000002,
      "Time_End": 2562.84,
      "Text": " You mess that process up, you ruin DC to DC and subdomain to subdomain communication."
    },
    {
      "Time_Start": 2562.84,
      "Time_End": 2566.28,
      "Text": " So like I said, make sure we've got these things documented and tested."
    },
    {
      "Time_Start": 2566.28,
      "Time_End": 2568.28,
      "Text": " It's very important we test them."
    },
    {
      "Time_Start": 2568.28,
      "Time_End": 2569.28,
      "Text": " Okay?"
    },
    {
      "Time_Start": 2569.28,
      "Time_End": 2573.1600000000003,
      "Text": " For rotation of the PKI, so in that compromise I told you about for the client, the root"
    },
    {
      "Time_Start": 2573.1600000000003,
      "Time_End": 2576.8,
      "Text": " CA was compromised, so we did have to write recommendations for root CA."
    },
    {
      "Time_Start": 2576.8,
      "Time_End": 2580.08,
      "Text": " Out of all the steps I've showed you so far, this is probably the most painful because"
    },
    {
      "Time_Start": 2580.08,
      "Time_End": 2583.2400000000002,
      "Text": " you have to revoke all certificates throughout the environment, and then you have to go and"
    },
    {
      "Time_Start": 2583.2400000000002,
      "Time_End": 2587.04,
      "Text": " validate that those certificates were in fact revoked, which means you have to tell the"
    },
    {
      "Time_Start": 2587.04,
      "Time_End": 2590.84,
      "Text": " machines to go and refresh their certificate replication list."
    },
    {
      "Time_Start": 2590.84,
      "Time_End": 2595.1200000000003,
      "Text": " It's kind of tricky, but ideally once you do that, you cut yourself some new private"
    },
    {
      "Time_Start": 2595.1200000000003,
      "Time_End": 2599.56,
      "Text": " key and public key, store the private key on the new root CA, offline that thing because"
    },
    {
      "Time_Start": 2599.56,
      "Time_End": 2602.48,
      "Text": " that thing never should have been online to begin with to get compromised."
    },
    {
      "Time_Start": 2602.48,
      "Time_End": 2604.84,
      "Text": " That's important to remember."
    },
    {
      "Time_Start": 2604.84,
      "Time_End": 2608.6000000000004,
      "Text": " But make sure you offline that root CA so you don't get re-compromised."
    },
    {
      "Time_Start": 2608.6000000000004,
      "Time_End": 2611.32,
      "Text": " And then another thing that's really, really important here is an adversary can go and"
    },
    {
      "Time_Start": 2611.32,
      "Time_End": 2616.36,
      "Text": " un-revoke a revoked certificate if they still have access to your environment, so make sure"
    },
    {
      "Time_Start": 2616.36,
      "Time_End": 2621.1600000000003,
      "Text": " you set the labels to all the certificates you revoked to CA compromise."
    },
    {
      "Time_Start": 2621.1600000000003,
      "Time_End": 2623.6,
      "Text": " And then we're coming up to the end."
    },
    {
      "Time_Start": 2623.6,
      "Time_End": 2625.2400000000002,
      "Text": " Good."
    },
    {
      "Time_Start": 2625.2400000000002,
      "Time_End": 2626.2400000000002,
      "Text": " So additional auditing."
    },
    {
      "Time_Start": 2626.2400000000002,
      "Time_End": 2629.2400000000002,
      "Text": " I'm not going to give you a long spreadsheet of all the event IDs your defenders should"
    },
    {
      "Time_Start": 2629.2400000000002,
      "Time_End": 2632.38,
      "Text": " have in their organization because that's ugly and not helpful."
    },
    {
      "Time_Start": 2632.38,
      "Time_End": 2634.78,
      "Text": " How should we add additional auditing to our organization?"
    },
    {
      "Time_Start": 2634.78,
      "Time_End": 2636.32,
      "Text": " We have to come up with use cases."
    },
    {
      "Time_Start": 2636.32,
      "Time_End": 2641.52,
      "Text": " If you don't, as defenders already have, detections for the attack techniques, the domain persistence"
    },
    {
      "Time_Start": 2641.52,
      "Time_End": 2646.1200000000003,
      "Text": " attack techniques that I showed you, I highly recommend that you get those in your organization."
    },
    {
      "Time_Start": 2646.88,
      "Time_End": 2649.16,
      "Text": " And if you are a red team or a pin tester and you're not considering validating those"
    },
    {
      "Time_Start": 2649.16,
      "Time_End": 2651.96,
      "Text": " attack techniques, it can be executed in your environment."
    },
    {
      "Time_Start": 2651.96,
      "Time_End": 2656.56,
      "Text": " Highly recommend, in the most benign and neutered way possible, you do in fact validate these"
    },
    {
      "Time_Start": 2656.56,
      "Time_End": 2659.48,
      "Text": " techniques can be executed because that's your business impact."
    },
    {
      "Time_Start": 2659.48,
      "Time_End": 2661.8399999999997,
      "Text": " That's what's driving your pin testing services."
    },
    {
      "Time_Start": 2661.8399999999997,
      "Time_End": 2662.8399999999997,
      "Text": " Okay?"
    },
    {
      "Time_Start": 2662.8399999999997,
      "Time_End": 2663.8399999999997,
      "Text": " All right."
    },
    {
      "Time_Start": 2663.8399999999997,
      "Time_End": 2666.3199999999997,
      "Text": " So that's just kind of a quick conclusion overview."
    },
    {
      "Time_Start": 2666.3199999999997,
      "Time_End": 2667.3199999999997,
      "Text": " Is there any questions?"
    },
    {
      "Time_Start": 2667.3199999999997,
      "Time_End": 2668.3199999999997,
      "Text": " No?"
    },
    {
      "Time_Start": 2668.3199999999997,
      "Time_End": 2669.3199999999997,
      "Text": " Okay."
    },
    {
      "Time_Start": 2669.3199999999997,
      "Time_End": 2670.3199999999997,
      "Text": " Appreciate it."
    },
    {
      "Time_Start": 2670.3199999999997,
      "Time_End": 2671.3199999999997,
      "Text": " Go for it."
    },
    {
      "Time_Start": 2671.32,
      "Time_End": 2672.32,
      "Text": " All right."
    },
    {
      "Time_Start": 2672.32,
      "Time_End": 2673.32,
      "Text": " We'll be around."
    },
    {
      "Time_Start": 2673.32,
      "Time_End": 2674.32,
      "Text": " If you all have any questions, we'll be around."
    },
    {
      "Time_Start": 2674.32,
      "Time_End": 2675.32,
      "Text": " Feel free to hit us up and ask us anything you want."
    },
    {
      "Time_Start": 2675.32,
      "Time_End": 2676.32,
      "Text": " Yeah."
    },
    {
      "Time_Start": 2676.32,
      "Time_End": 2677.32,
      "Text": " And as some of the resources you'll get after this, you'll have the GitHub where we have"
    },
    {
      "Time_Start": 2677.32,
      "Time_End": 2678.32,
      "Text": " blog posts, detections, the slides, a lot of other stuff we've kind of gathered."
    },
    {
      "Time_Start": 2678.32,
      "Time_End": 2679.32,
      "Text": " Again, we kind of rushed through this because there is so much for each of these components"
    },
    {
      "Time_Start": 2679.32,
      "Time_End": 2680.32,
      "Text": " and we go into a little more detail there."
    },
    {
      "Time_Start": 2680.32,
      "Time_End": 2681.32,
      "Text": " And again, we'll be available if you have in-person questions too."
    },
    {
      "Time_Start": 2681.32,
      "Time_End": 2682.32,
      "Text": " And we'll see you next time."
    },
    {
      "Time_Start": 2682.32,
      "Time_End": 2683.32,
      "Text": " Bye."
    },
    {
      "Time_Start": 2683.32,
      "Time_End": 2684.32,
      "Text": " Bye."
    },
    {
      "Time_Start": 2684.32,
      "Time_End": 2685.32,
      "Text": " Bye."
    },
    {
      "Time_Start": 2685.32,
      "Time_End": 2686.32,
      "Text": " Bye."
    },
    {
      "Time_Start": 2686.32,
      "Time_End": 2687.32,
      "Text": " Bye."
    },
    {
      "Time_Start": 2687.32,
      "Time_End": 2688.32,
      "Text": " Bye."
    },
    {
      "Time_Start": 2688.32,
      "Time_End": 2689.32,
      "Text": " Bye."
    },
    {
      "Time_Start": 2689.32,
      "Time_End": 2690.32,
      "Text": " Bye."
    },
    {
      "Time_Start": 2690.32,
      "Time_End": 2691.32,
      "Text": " Bye."
    },
    {
      "Time_Start": 2691.32,
      "Time_End": 2692.32,
      "Text": " Bye."
    },
    {
      "Time_Start": 2692.32,
      "Time_End": 2693.32,
      "Text": " Bye."
    },
    {
      "Time_Start": 2693.32,
      "Time_End": 2694.32,
      "Text": " Bye."
    },
    {
      "Time_Start": 2694.32,
      "Time_End": 2695.32,
      "Text": " Bye."
    },
    {
      "Time_Start": 2695.32,
      "Time_End": 2696.32,
      "Text": " Bye."
    },
    {
      "Time_Start": 2696.32,
      "Time_End": 2697.32,
      "Text": " Bye."
    },
    {
      "Time_Start": 2697.32,
      "Time_End": 2698.32,
      "Text": " Bye."
    },
    {
      "Time_Start": 2698.32,
      "Time_End": 2699.32,
      "Text": " Bye."
    },
    {
      "Time_Start": 2699.32,
      "Time_End": 2700.32,
      "Text": " Bye."
    },
    {
      "Time_Start": 2700.32,
      "Time_End": 2701.32,
      "Text": " Bye."
    },
    {
      "Time_Start": 2701.32,
      "Time_End": 2702.32,
      "Text": " Bye."
    },
    {
      "Time_Start": 2702.32,
      "Time_End": 2703.32,
      "Text": " Bye."
    },
    {
      "Time_Start": 2703.32,
      "Time_End": 2704.32,
      "Text": " Bye."
    },
    {
      "Time_Start": 2704.32,
      "Time_End": 2705.32,
      "Text": " Bye."
    },
    {
      "Time_Start": 2705.32,
      "Time_End": 2706.32,
      "Text": " Bye."
    },
    {
      "Time_Start": 2706.32,
      "Time_End": 2707.32,
      "Text": " Bye."
    },
    {
      "Time_Start": 2707.32,
      "Time_End": 2708.32,
      "Text": " Bye."
    },
    {
      "Time_Start": 2708.32,
      "Time_End": 2709.32,
      "Text": " Bye."
    },
    {
      "Time_Start": 2709.32,
      "Time_End": 2710.32,
      "Text": " Bye."
    },
    {
      "Time_Start": 2710.32,
      "Time_End": 2711.32,
      "Text": " Bye."
    },
    {
      "Time_Start": 2711.32,
      "Time_End": 2712.32,
      "Text": " Bye."
    },
    {
      "Time_Start": 2712.32,
      "Time_End": 2713.32,
      "Text": " Bye."
    },
    {
      "Time_Start": 2713.32,
      "Time_End": 2714.32,
      "Text": " Bye."
    },
    {
      "Time_Start": 2714.32,
      "Time_End": 2715.32,
      "Text": " Bye."
    },
    {
      "Time_Start": 2715.32,
      "Time_End": 2716.32,
      "Text": " Bye."
    },
    {
      "Time_Start": 2716.32,
      "Time_End": 2717.32,
      "Text": " Bye."
    },
    {
      "Time_Start": 2717.32,
      "Time_End": 2718.32,
      "Text": " Bye."
    },
    {
      "Time_Start": 2718.32,
      "Time_End": 2719.32,
      "Text": " Bye."
    },
    {
      "Time_Start": 2719.32,
      "Time_End": 2720.32,
      "Text": " Bye."
    },
    {
      "Time_Start": 2720.32,
      "Time_End": 2721.32,
      "Text": " Bye."
    },
    {
      "Time_Start": 2721.32,
      "Time_End": 2722.32,
      "Text": " Bye."
    },
    {
      "Time_Start": 2722.32,
      "Time_End": 2723.32,
      "Text": " Bye."
    },
    {
      "Time_Start": 2723.32,
      "Time_End": 2724.32,
      "Text": " Bye."
    },
    {
      "Time_Start": 2724.32,
      "Time_End": 2725.32,
      "Text": " Bye."
    },
    {
      "Time_Start": 2725.32,
      "Time_End": 2726.32,
      "Text": " Bye."
    },
    {
      "Time_Start": 2726.32,
      "Time_End": 2727.32,
      "Text": " Bye."
    },
    {
      "Time_Start": 2727.32,
      "Time_End": 2728.32,
      "Text": " Bye."
    },
    {
      "Time_Start": 2728.32,
      "Time_End": 2729.32,
      "Text": " Bye."
    }
  ]
}