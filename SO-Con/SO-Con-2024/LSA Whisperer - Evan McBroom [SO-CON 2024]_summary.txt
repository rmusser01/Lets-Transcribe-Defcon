In the talk, Evan McBroom from SpectreOps presents "LSA Whisperer," a novel approach to retrieving credentials and performing attacker tradecraft without accessing LSASS memory. He begins by explaining the concept of Security Support Providers (SSPs) and how they extend the Local Security Authority (LSA) to support new authentication schemes. McBroom then provides an overview of the Win32 API "LsaCallAuthenticationPackage," which allows third-party software to make requests to specific authentication packages and receive data in response. He also mentions the existence of an LPC port and an RPC server introduced in Windows 7 for communicating with the LSA's Security Package Manager, offering an alternative to the Win32 API.

The presentation focuses on several authentication packages that ship with Windows and the types of data that can be retrieved from them. McBroom starts with the Kerberos package, highlighting capabilities such as host enumeration, cloud configuration information, ticket recovery, and selective ticket purging. He then introduces the Cloud Authentication Package, which supports cloud-based logins and allows for the recovery of single sign-on cookies. The Microsoft Authentication Package (MSV1.0) is discussed next, showcasing the ability to recover DPAPI keys and generate NTLMv1 responses, even with mitigations enabled.

McBroom provides a detailed explanation of the DPAPI key derivation process and how it relates to the MSV1.0 package. He also mentions the "getCredentialKey" and "getStrongCredentialKey" functions, which provide access to the necessary keys for decrypting DPAPI master key files. The presentation continues with brief overviews of other authentication packages, including PublicKeyUserToUser (PKU2U), Negotiate Extender, Secure Channel Authentication Package, Terminal Service Package, and WDigest, highlighting their potential usefulness for red team operations.

The talk concludes with a discussion of prevention and detection measures for defenders, including ETW telemetry, Credential Guard, and RPC filters. McBroom also suggests monitoring specific Win32 APIs and ALPC ports associated with authentication package interactions. He mentions future work and potential areas of exploration, such as cloud logon credential transfers, Azure AD single sign-on cookies, and NTLM response relaying. Overall, the presentation demonstrates how attackers can bypass traditional memory-based credential retrieval methods and leverage authentication packages to access sensitive information.