{"segments": [{"Time_Start": 0.0, "Time_End": 4.0, "Text": " He's kind of..."}, {"Time_Start": 4.0, "Time_End": 17.0, "Text": " He's kind of..."}, {"Time_Start": 17.0, "Time_End": 19.0, "Text": " So..."}, {"Time_Start": 19.0, "Time_End": 23.0, "Text": " He thinks, what's the mega address?"}, {"Time_Start": 23.0, "Time_End": 25.0, "Text": " Well, what he does?"}, {"Time_Start": 25.0, "Time_End": 29.0, "Text": " He cries out, who is 10.1.1.2?"}, {"Time_Start": 29.0, "Time_End": 34.0, "Text": " under two. And he does that very loud. We call this a broadcast."}, {"Time_Start": 34.0, "Time_End": 42.0, "Text": " So host B is a little bit pissed off about this crying around, but sends back his Mac address so they can communicate,"}, {"Time_Start": 42.0, "Time_End": 46.0, "Text": " which then looks like this."}, {"Time_Start": 46.0, "Time_End": 52.0, "Text": " So what can we do? We can be faster or just more shetty."}, {"Time_Start": 52.0, "Time_End": 56.0, "Text": " We stress the point that really we are host B and the other one is lying."}, {"Time_Start": 59.0, "Time_End": 62.0, "Text": " You would believe me, right?"}, {"Time_Start": 62.0, "Time_End": 63.0, "Text": " So..."}, {"Time_Start": 63.0, "Time_End": 66.0, "Text": " Looks like this, he cries around."}, {"Time_Start": 66.0, "Time_End": 68.0, "Text": " Etacher hears this as well."}, {"Time_Start": 68.0, "Time_End": 70.0, "Text": " So here's the normal answer."}, {"Time_Start": 70.0, "Time_End": 73.0, "Text": " Here the etiquette appears who?"}, {"Time_Start": 73.0, "Time_End": 76.0, "Text": " And he answers, I'm this host."}, {"Time_Start": 76.0, "Time_End": 81.0, "Text": " And, well, why that is, he can lie to both parties as well."}, {"Time_Start": 81.0, "Time_End": 86.0, "Text": " So then it ends up going through his system."}, {"Time_Start": 86.0, "Time_End": 88.0, "Text": " Great."}, {"Time_Start": 88.0, "Time_End": 95.0, "Text": " This is a short list of tools. There are lots of tools to do this stuff."}, {"Time_Start": 95.0, "Time_End": 99.0, "Text": " We did one for Linux and for Windows."}, {"Time_Start": 99.0, "Time_End": 104.0, "Text": " The THC group, another German group, wrote the Parasite."}, {"Time_Start": 104.0, "Time_End": 111.0, "Text": " ITERC is pretty nice because it has a graphical user interface."}, {"Time_Start": 111.0, "Time_End": 117.0, "Text": " So for all the less educated people here, that's pretty easy."}, {"Time_Start": 117.0, "Time_End": 122.0, "Text": " The classic is hunt, which is very good, but sometimes strange to handle."}, {"Time_Start": 122.0, "Time_End": 125.0, "Text": " And yeah, there are scores of others."}, {"Time_Start": 125.0, "Time_End": 130.0, "Text": " Another thing, local redirection."}, {"Time_Start": 130.0, "Time_End": 132.0, "Text": " What do I mean by local redirection?"}, {"Time_Start": 132.0, "Time_End": 135.0, "Text": " Most people just overlook this."}, {"Time_Start": 135.0, "Time_End": 140.0, "Text": " By modifying your own system, you can just modify the way."}, {"Time_Start": 140.0, "Time_End": 146.0, "Text": " Okay, let's assume the administrator discovers attaker and thinks, okay,"}, {"Time_Start": 146.0, "Time_End": 152.0, "Text": " thinks, okay, I'm going to fuck this guy. I'm blocking him here on Router 1."}, {"Time_Start": 152.0, "Time_End": 157.0, "Text": " Well, okay, end of game. No, not really."}, {"Time_Start": 157.0, "Time_End": 164.0, "Text": " Entercured map, let's say Wictim's address here, if this guy's forwarding,"}, {"Time_Start": 164.0, "Time_End": 170.0, "Text": " to the IP address of Router 1, just by setting a fixed up entry."}, {"Time_Start": 170.0, "Time_End": 176.0, "Text": " If Router 1 is somehow using Mac addresses for filtering, like let's say,"}, {"Time_Start": 176.0, "Time_End": 181.0, "Text": " it's a switching router or something, that would pass."}, {"Time_Start": 181.0, "Time_End": 188.0, "Text": " Another way, and that's the recommended way, just modify, yeah, that's the mega-address thing,"}, {"Time_Start": 188.0, "Time_End": 194.0, "Text": " just modify your routing table and use Router 2."}, {"Time_Start": 194.0, "Time_End": 200.0, "Text": " You could even use Router 2 if it had no connection to host B."}, {"Time_Start": 200.0, "Time_End": 201.0, "Text": " Why?"}, {"Time_Start": 201.0, "Time_End": 205.98, "Text": " Because Router 2 would know how to send it to Router 1, and Router 1 would probably"}, {"Time_Start": 206.0, "Time_End": 215.0, "Text": " accepted. So, routers. Okay, we saw we can do nice things with them, but how"}, {"Time_Start": 215.0, "Time_End": 222.0, "Text": " do you find them? They're passive and active ways. Passive ways basically listen for all"}, {"Time_Start": 222.0, "Time_End": 229.0, "Text": " the multicast and broadcast stuff or just discovery protocols like CDP, running around the"}, {"Time_Start": 229.0, "Time_End": 235.98, "Text": " network, you just map the routers. But, well, this is not very effective because,"}, {"Time_Start": 236.0, "Time_End": 242.0, "Text": " most modern routing protocols don't include the actual information in the broadcast packets."}, {"Time_Start": 242.0, "Time_End": 244.0, "Text": " So what can we do?"}, {"Time_Start": 244.0, "Time_End": 247.0, "Text": " We can do active discovery."}, {"Time_Start": 247.0, "Time_End": 250.0, "Text": " We can query routing processes."}, {"Time_Start": 250.0, "Time_End": 256.0, "Text": " We call this AS scanning because it's autonomous system scanning."}, {"Time_Start": 256.0, "Time_End": 262.0, "Text": " We can send out router solicitations, I really hate this word,"}, {"Time_Start": 262.0, "Time_End": 265.0, "Text": " which means we just cry around and look for a router."}, {"Time_Start": 265.0, "Time_End": 272.0, "Text": " router, we do always fingerprinting, or even more interesting, protocol scans."}, {"Time_Start": 272.0, "Time_End": 278.0, "Text": " We just scan the IP protocols, and if it's, let's say, supports IGRP, that's a good hint."}, {"Time_Start": 278.0, "Time_End": 280.0, "Text": " It might be a router."}, {"Time_Start": 280.0, "Time_End": 281.0, "Text": " Or we just do port scans."}, {"Time_Start": 281.0, "Time_End": 287.0, "Text": " If it is an older model or just a strange model and it has, let's say, the rip port open,"}, {"Time_Start": 287.0, "Time_End": 290.0, "Text": " well, we find it this way."}, {"Time_Start": 290.0, "Time_End": 295.0, "Text": " This is an example from our ASS, our autonomous system system system."}, {"Time_Start": 295.0, "Time_End": 302.0, "Text": " scanner. The upper four lines, that's passive stuff. It sees IRDP broadcasting,"}, {"Time_Start": 302.0, "Time_End": 309.0, "Text": " router information, and it sees IGRP, two different autonomous systems. Notice that it includes"}, {"Time_Start": 309.0, "Time_End": 318.0, "Text": " the iOS version, very interesting. The rest of it is by active scanning the IGRP"}, {"Time_Start": 318.0, "Time_End": 324.0, "Text": " in this case, you see how much information you get out there. It's internal routes or external routes,"}, {"Time_Start": 324.0, "Time_End": 331.0, "Text": " you see the net itself, the net mask, the next hop, various information,"}, {"Time_Start": 331.0, "Time_End": 338.0, "Text": " even what kind of link it was, and all the information for the routing protocol,"}, {"Time_Start": 338.0, "Time_End": 343.0, "Text": " like delay, hop count, reliability, and yeah, all that stuff."}, {"Time_Start": 343.0, "Time_End": 345.0, "Text": " So which tools do we have?"}, {"Time_Start": 345.0, "Time_End": 348.0, "Text": " As already mentioned, we wrote an autonomous system scanner."}, {"Time_Start": 348.0, "Time_End": 353.98, "Text": " Etherl is very good in decoding routing protocols, if you prefer to do the"}, {"Time_Start": 354.0, "Time_End": 357.0, "Text": " stuff by hand, just take this too."}, {"Time_Start": 357.0, "Time_End": 362.0, "Text": " Enthop can be used to discover central points in the network."}, {"Time_Start": 362.0, "Time_End": 366.0, "Text": " That would be a good hint for a router or a server."}, {"Time_Start": 366.0, "Time_End": 368.0, "Text": " You will find out."}, {"Time_Start": 368.0, "Time_End": 371.0, "Text": " TCPDOM's option to show data link addresses is very good,"}, {"Time_Start": 371.0, "Time_End": 376.0, "Text": " because if you see a packet going from A to B on the IP layer"}, {"Time_Start": 376.0, "Time_End": 381.0, "Text": " and the destination address on the MAC layer doesn't match to the IP,"}, {"Time_Start": 381.0, "Time_End": 383.0, "Text": " well, that's the next hop router."}, {"Time_Start": 383.0, "Time_End": 387.0, "Text": " NMAP is pretty good."}, {"Time_Start": 387.0, "Time_End": 393.0, "Text": " For protocol scan, we wrote our own tool before we discovered that NMAP supports this."}, {"Time_Start": 393.0, "Time_End": 402.0, "Text": " You basically go down all the IP protocols and that's a negative scan,"}, {"Time_Start": 402.0, "Time_End": 407.0, "Text": " so you wait for ICMP protocol unreachable messages, and if they don't appear,"}, {"Time_Start": 407.0, "Time_End": 410.0, "Text": " this thing is probably running this protocol."}, {"Time_Start": 410.0, "Time_End": 412.0, "Text": " And if you get a router by DHCP query,"}, {"Time_Start": 412.0, "Time_End": 416.0, "Text": " query, well, why not using it?"}, {"Time_Start": 416.0, "Time_End": 419.0, "Text": " ICMP router protocol discovery."}, {"Time_Start": 419.0, "Time_End": 421.0, "Text": " Okay, I mixed that up."}, {"Time_Start": 421.0, "Time_End": 428.0, "Text": " I already P is, mostly when you enable this on routers,"}, {"Time_Start": 428.0, "Time_End": 432.0, "Text": " they broadcast periodic updates"}, {"Time_Start": 432.0, "Time_End": 436.0, "Text": " and just tell everyone, I'm a router, and I know"}, {"Time_Start": 436.0, "Time_End": 441.0, "Text": " these interfaces, and you can talk to me."}, {"Time_Start": 441.0, "Time_End": 442.0, "Text": " IRP."}, {"Time_Start": 442.0, "Time_End": 446.0, "Text": " can be requested. That's this router solicitation stuff."}, {"Time_Start": 446.0, "Time_End": 451.0, "Text": " And he will answer mostly."}, {"Time_Start": 451.0, "Time_End": 456.0, "Text": " The announcing router, let's say you are the announcing router,"}, {"Time_Start": 456.0, "Time_End": 460.0, "Text": " is inserted in the host routing table"}, {"Time_Start": 460.0, "Time_End": 467.0, "Text": " with less priority means with a higher matrix than the default router."}, {"Time_Start": 467.0, "Time_End": 471.0, "Text": " So make sure the default router is not available."}, {"Time_Start": 471.0, "Time_End": 472.0, "Text": " And the matrix."}, {"Time_Start": 472.0, "Time_End": 474.0, "Text": " It depends on the preference."}, {"Time_Start": 474.0, "Time_End": 476.0, "Text": " Most systems just run with a low preference."}, {"Time_Start": 476.0, "Time_End": 479.0, "Text": " If you use a high preference, you're the first guy."}, {"Time_Start": 479.0, "Time_End": 482.0, "Text": " So, how does it look like?"}, {"Time_Start": 482.0, "Time_End": 484.0, "Text": " It's pretty straightforward."}, {"Time_Start": 484.0, "Time_End": 488.0, "Text": " You just make sure everyone thinks you are a router."}, {"Time_Start": 488.0, "Time_End": 493.0, "Text": " You send them out, make yourself known"}, {"Time_Start": 493.0, "Time_End": 496.0, "Text": " to host A,"}, {"Time_Start": 496.0, "Time_End": 500.0, "Text": " and make sure that this guy is temporary not available."}, {"Time_Start": 500.0, "Time_End": 501.0, "Text": " You want to use it later."}, {"Time_Start": 501.0, "Time_End": 506.0, "Text": " because how are you going to pass the traffic to this cloud here?"}, {"Time_Start": 506.0, "Time_End": 512.0, "Text": " So very interesting is the fact if you have a router that runs dial on demand or something,"}, {"Time_Start": 512.0, "Time_End": 519.0, "Text": " it has to raise the line or just negotiate PPP or something."}, {"Time_Start": 519.0, "Time_End": 525.0, "Text": " If this host here is Windows, he would think the router is not available"}, {"Time_Start": 525.0, "Time_End": 530.0, "Text": " and take the next one in his routing table, which is hopefully you."}, {"Time_Start": 531.0, "Time_End": 534.0, "Text": " So again, here are the tools."}, {"Time_Start": 534.0, "Time_End": 537.0, "Text": " I recommend this attack as an additional thing,"}, {"Time_Start": 537.0, "Time_End": 540.0, "Text": " because you don't get the traffic right away."}, {"Time_Start": 540.0, "Time_End": 544.0, "Text": " So if you do any kind of traffic interception or redirection,"}, {"Time_Start": 544.0, "Time_End": 548.0, "Text": " you can do this in the background just to make sure"}, {"Time_Start": 548.0, "Time_End": 553.0, "Text": " if something goes wrong with your primary attack,"}, {"Time_Start": 553.0, "Time_End": 556.0, "Text": " you still get the traffic."}, {"Time_Start": 556.0, "Time_End": 560.0, "Text": " Hosts, as I said, Windows just really likes it."}, {"Time_Start": 560.0, "Time_End": 565.0, "Text": " really likes it and does it all the time and he just on boot up."}, {"Time_Start": 565.0, "Time_End": 569.0, "Text": " On the other hand, Linux does not care at all."}, {"Time_Start": 569.0, "Time_End": 573.0, "Text": " ICMP redirects."}, {"Time_Start": 573.0, "Time_End": 575.0, "Text": " Most know these."}, {"Time_Start": 575.0, "Time_End": 581.0, "Text": " They were introduced to make routing a little bit more effective."}, {"Time_Start": 581.0, "Time_End": 587.0, "Text": " So when host A sends traffic to router one here,"}, {"Time_Start": 587.0, "Time_End": 589.98, "Text": " and Router 1 discovers shit, I forward"}, {"Time_Start": 590.0, "Time_End": 594.0, "Text": " this packet to the same segment to another router in the same IP network,"}, {"Time_Start": 594.0, "Time_End": 596.0, "Text": " which is called router 2."}, {"Time_Start": 596.0, "Time_End": 598.0, "Text": " This is stupid."}, {"Time_Start": 598.0, "Time_End": 600.0, "Text": " And he actually tells this host A."}, {"Time_Start": 600.0, "Time_End": 604.0, "Text": " So host A happily adjusts his routing table"}, {"Time_Start": 604.0, "Time_End": 607.0, "Text": " and uses router 2 for disconnection."}, {"Time_Start": 607.0, "Time_End": 611.0, "Text": " So how do we use that?"}, {"Time_Start": 611.0, "Time_End": 614.0, "Text": " That works vice versa."}, {"Time_Start": 614.0, "Time_End": 618.0, "Text": " The packet is sent from host A to host B through router 2."}, {"Time_Start": 618.0, "Time_End": 625.0, "Text": " We see this traffic and we think, well, we know a better way."}, {"Time_Start": 625.0, "Time_End": 632.0, "Text": " So we actually tell this, host A, please use me as your next hop."}, {"Time_Start": 632.0, "Time_End": 635.0, "Text": " And it works."}, {"Time_Start": 635.0, "Time_End": 637.0, "Text": " It even works across routers."}, {"Time_Start": 637.0, "Time_End": 644.0, "Text": " If you send ICMP redirect message, let's say, across the internet,"}, {"Time_Start": 644.0, "Time_End": 646.0, "Text": " that works as well."}, {"Time_Start": 646.0, "Time_End": 647.0, "Text": " Why?"}, {"Time_Start": 647.0, "Time_End": 648.0, "Text": " Because the ICMP."}, {"Time_Start": 648.0, "Time_End": 655.0, "Text": " final router who will deliver this packet to the attacked host is actually the one"}, {"Time_Start": 655.0, "Time_End": 661.0, "Text": " who's probably getting all the traffic so the host will believe you."}, {"Time_Start": 661.0, "Time_End": 668.0, "Text": " Okay, one important thing here. There are a lot of redirect tools out there, but most systems"}, {"Time_Start": 668.0, "Time_End": 674.0, "Text": " require the first 64 bits of the original offending packet to be included."}, {"Time_Start": 674.0, "Time_End": 675.0, "Text": " Why?"}, {"Time_Start": 675.0, "Time_End": 677.98, "Text": " It would be cool to know which direction and which communication"}, {"Time_Start": 678.0, "Time_End": 681.0, "Text": " cause this problem."}, {"Time_Start": 681.0, "Time_End": 684.0, "Text": " So host reactions."}, {"Time_Start": 684.0, "Time_End": 688.0, "Text": " Windows just loves ICMP redirects."}, {"Time_Start": 688.0, "Time_End": 695.0, "Text": " And it just adds the thing to the host as a host route to his routing table."}, {"Time_Start": 695.0, "Time_End": 701.0, "Text": " So if you look at your routing table and you have about 500 host routes on your routing table,"}, {"Time_Start": 701.0, "Time_End": 705.0, "Text": " you should look out for ICMP."}, {"Time_Start": 705.0, "Time_End": 707.0, "Text": " Linux host, it depends."}, {"Time_Start": 707.0, "Time_End": 708.0, "Text": " You can set this here."}, {"Time_Start": 708.0, "Time_End": 710.0, "Text": " in this PROC file system."}, {"Time_Start": 710.0, "Time_End": 714.0, "Text": " But most distributions now accept these things."}, {"Time_Start": 714.0, "Time_End": 719.0, "Text": " And it's a little bit evil because you don't see them in the routing table."}, {"Time_Start": 719.0, "Time_End": 723.0, "Text": " You really have to go into the PROC file system and find out."}, {"Time_Start": 723.0, "Time_End": 725.0, "Text": " So which tools exist?"}, {"Time_Start": 725.0, "Time_End": 726.0, "Text": " Okay."}, {"Time_Start": 726.0, "Time_End": 729.0, "Text": " Because we're speaking about it, we coded one."}, {"Time_Start": 729.0, "Time_End": 735.0, "Text": " And there's from Yuri another one which is basically the original ICMP redirect tool."}, {"Time_Start": 735.0, "Time_End": 737.0, "Text": " Works pretty good."}, {"Time_Start": 737.0, "Time_End": 741.0, "Text": " So this is how it looks like on a Windows system."}, {"Time_Start": 741.0, "Time_End": 744.0, "Text": " You might not read this, but you see the pattern."}, {"Time_Start": 744.0, "Time_End": 746.0, "Text": " It's all host routing here."}, {"Time_Start": 746.0, "Time_End": 749.0, "Text": " It's all 255."}, {"Time_Start": 749.0, "Time_End": 752.0, "Text": " Okay, let's go routing."}, {"Time_Start": 752.0, "Time_End": 755.0, "Text": " Let's make it interesting."}, {"Time_Start": 755.0, "Time_End": 760.0, "Text": " IGRP, interior gateway routing protocol, a Cisco idea."}, {"Time_Start": 760.0, "Time_End": 766.0, "Text": " It has actually 65,535 possible autonomous."}, {"Time_Start": 766.0, "Time_End": 768.0, "Text": " possible autonomous systems."}, {"Time_Start": 768.0, "Time_End": 775.0, "Text": " It's just to separate server routing processes from each other."}, {"Time_Start": 775.0, "Time_End": 779.0, "Text": " It uses no authentication, hello."}, {"Time_Start": 779.0, "Time_End": 786.0, "Text": " And various data link information like hop count reliability,"}, {"Time_Start": 786.0, "Time_End": 793.0, "Text": " another word I really like, and bandwidth is used to calculate the matrix."}, {"Time_Start": 793.0, "Time_End": 796.0, "Text": " Well, hosts can actually."}, {"Time_Start": 796.0, "Time_End": 801.0, "Text": " actually listen to IGRP without saying anything that's called a passive interface."}, {"Time_Start": 801.0, "Time_End": 804.0, "Text": " So make sure your protocols scan the hosts."}, {"Time_Start": 804.0, "Time_End": 807.0, "Text": " Maybe they accept your updates."}, {"Time_Start": 807.0, "Time_End": 813.0, "Text": " Spoof updates mostly have a better matrix."}, {"Time_Start": 813.0, "Time_End": 816.0, "Text": " Why? Because you can choose your link however you want"}, {"Time_Start": 816.0, "Time_End": 820.0, "Text": " and you can easily compete with the real world stuff."}, {"Time_Start": 820.0, "Time_End": 825.0, "Text": " But keep in mind that your sender network, whatever you see,"}, {"Time_Start": 825.0, "Time_End": 828.0, "Text": " whatever you select as your sender network,"}, {"Time_Start": 828.0, "Time_End": 832.0, "Text": " has to be enabled as a possible source for route updates."}, {"Time_Start": 832.0, "Time_End": 835.0, "Text": " So how does it look like?"}, {"Time_Start": 835.0, "Time_End": 840.0, "Text": " We could introduce new routes or modifying existing one."}, {"Time_Start": 840.0, "Time_End": 843.0, "Text": " We have this guy here, host B,"}, {"Time_Start": 843.0, "Time_End": 847.0, "Text": " and we have this nice server over here."}, {"Time_Start": 847.0, "Time_End": 851.0, "Text": " And we have the three routers here talking IGRP."}, {"Time_Start": 851.0, "Time_End": 854.0, "Text": " Our air ticker got a connection to another router."}, {"Time_Start": 854.0, "Time_End": 855.0, "Text": " And we have this."}, {"Time_Start": 855.0, "Time_End": 857.0, "Text": " and he's just way off."}, {"Time_Start": 857.0, "Time_End": 859.0, "Text": " Okay, so what does he do?"}, {"Time_Start": 859.0, "Time_End": 866.0, "Text": " First, he adds the IP address of the server"}, {"Time_Start": 866.0, "Time_End": 872.0, "Text": " to his interface as a secondary IP and enables IP forwarding."}, {"Time_Start": 872.0, "Time_End": 875.0, "Text": " Guess why?"}, {"Time_Start": 875.0, "Time_End": 879.0, "Text": " Because in the next step, he's telling Router 1,"}, {"Time_Start": 879.0, "Time_End": 885.0, "Text": " using Router 3's IP address, that 10.1.3.2 is definitely"}, {"Time_Start": 885.0, "Time_End": 888.0, "Text": " the best way to reach the server."}, {"Time_Start": 888.0, "Time_End": 892.0, "Text": " So he just makes himself very interesting for the router."}, {"Time_Start": 892.0, "Time_End": 906.0, "Text": " Now he tells R2 that R1 is definitely a better route to reach server than the original R3."}, {"Time_Start": 906.0, "Time_End": 914.98, "Text": " So host B actually ends up logging into his fake server, running there, submitting his password and other other"}, {"Time_Start": 915.0, "Time_End": 920.0, "Text": " information you just want to have or just being curious."}, {"Time_Start": 920.0, "Time_End": 922.0, "Text": " We don't do bad stuff, right?"}, {"Time_Start": 922.0, "Time_End": 926.0, "Text": " So, and he gets all the traffic."}, {"Time_Start": 926.0, "Time_End": 927.0, "Text": " Great."}, {"Time_Start": 927.0, "Time_End": 932.0, "Text": " He can even run a fake server on it that looks like the original one."}, {"Time_Start": 932.0, "Time_End": 934.0, "Text": " Think about web applications."}, {"Time_Start": 934.0, "Time_End": 938.0, "Text": " So you can get a lot of interesting information there."}, {"Time_Start": 938.0, "Time_End": 945.0, "Text": " If for some reason etiquette just wants to prevent the server talking to host"}, {"Time_Start": 945.0, "Time_End": 949.0, "Text": " he can do another thing he can do routing loops."}, {"Time_Start": 949.0, "Time_End": 957.0, "Text": " He just tells R3, well, the best way to reach your host B is definitely R1."}, {"Time_Start": 957.0, "Time_End": 962.0, "Text": " And he tells R1 that the best way to host B is definitely R3."}, {"Time_Start": 962.0, "Time_End": 970.0, "Text": " Then he sits back and enjoys the packets using up its TTL."}, {"Time_Start": 970.0, "Time_End": 974.0, "Text": " Okay, this is some very old stuff."}, {"Time_Start": 974.0, "Time_End": 975.0, "Text": " Routing information."}, {"Time_Start": 975.0, "Time_End": 979.0, "Text": " protocol version 1."}, {"Time_Start": 979.0, "Time_End": 980.0, "Text": " Rip."}, {"Time_Start": 980.0, "Time_End": 981.0, "Text": " Good."}, {"Time_Start": 981.0, "Time_End": 986.0, "Text": " It's one of the oldest, but it's still in use, because it's so simple."}, {"Time_Start": 986.0, "Time_End": 992.0, "Text": " It uses broadcast and just runs on UDP port 520."}, {"Time_Start": 992.0, "Time_End": 996.0, "Text": " It has no autonomous systems and other stuff."}, {"Time_Start": 996.0, "Time_End": 1001.0, "Text": " It even uses a fixed network size, at least in most implementations."}, {"Time_Start": 1001.0, "Time_End": 1004.0, "Text": " And it really, really is easy to use."}, {"Time_Start": 1004.0, "Time_End": 1006.0, "Text": " is easy to attack."}, {"Time_Start": 1006.0, "Time_End": 1011.0, "Text": " There's the routing information protocol version 2."}, {"Time_Start": 1011.0, "Time_End": 1019.0, "Text": " That actually includes next-top information and netmask into the routing updates."}, {"Time_Start": 1019.0, "Time_End": 1029.0, "Text": " It still has no autonomous systems, but it often uses multicast instead of broadcast."}, {"Time_Start": 1029.0, "Time_End": 1033.0, "Text": " And there is even a clear text authentication defined in an RFC."}, {"Time_Start": 1033.0, "Time_End": 1038.5, "Text": " But this is so strange that most people don't implement it or don't use it."}, {"Time_Start": 1040.0, "Time_End": 1043.0, "Text": " Cisco actually supports MD5 for RIP."}, {"Time_Start": 1043.0, "Time_End": 1045.0, "Text": " What a bright idea."}, {"Time_Start": 1045.0, "Time_End": 1050.0, "Text": " But since they use a double authentication block, this is not by RFC."}, {"Time_Start": 1050.0, "Time_End": 1055.0, "Text": " And if you have anything that is not Cisco, you definitely don't want to run this."}, {"Time_Start": 1055.0, "Time_End": 1058.0, "Text": " So what are the attacks?"}, {"Time_Start": 1058.0, "Time_End": 1062.0, "Text": " It's basically the same stuff you can do with RIP as you can do with RIP as you can do with RG."}, {"Time_Start": 1062.0, "Time_End": 1064.0, "Text": " with IRP."}, {"Time_Start": 1064.0, "Time_End": 1069.0, "Text": " Watch out for the network boundaries for the fixed netmask stuff"}, {"Time_Start": 1069.0, "Time_End": 1073.0, "Text": " because if you send updates that don't make sense"}, {"Time_Start": 1073.0, "Time_End": 1077.0, "Text": " or you just use subnetting or supernetting,"}, {"Time_Start": 1077.0, "Time_End": 1079.0, "Text": " you're going to confuse the network."}, {"Time_Start": 1079.0, "Time_End": 1082.0, "Text": " And we don't want this."}, {"Time_Start": 1082.0, "Time_End": 1089.0, "Text": " The multicast stuff, rip V2, may be forwarded across segments."}, {"Time_Start": 1089.0, "Time_End": 1091.98, "Text": " Why I love multi-casts is, for example, if you write"}, {"Time_Start": 1092.0, "Time_End": 1099.0, "Text": " a checkpoint on AIX system, it will forward multicast whatever the checkpoint setup says."}, {"Time_Start": 1099.0, "Time_End": 1102.0, "Text": " So that's why I really like it."}, {"Time_Start": 1102.0, "Time_End": 1106.0, "Text": " There is a thing called Split Horizon with Poison Reverse,"}, {"Time_Start": 1106.0, "Time_End": 1111.0, "Text": " which actually prevents routing loops from happening."}, {"Time_Start": 1111.0, "Time_End": 1113.0, "Text": " Not really."}, {"Time_Start": 1113.0, "Time_End": 1119.0, "Text": " You have to have at least one router that knows that there is a routing loop"}, {"Time_Start": 1119.0, "Time_End": 1121.0, "Text": " and that is communicating back this."}, {"Time_Start": 1121.0, "Time_End": 1123.9, "Text": " communicating back this to the other routers."}, {"Time_Start": 1123.9, "Time_End": 1128.24, "Text": " If you have just two routers, talking RIP, you can do routing loops."}, {"Time_Start": 1128.24, "Time_End": 1131.76, "Text": " So which tools exist?"}, {"Time_Start": 1131.76, "Time_End": 1139.96, "Text": " R probe and S-RIP from Humble are probably the first RIP attack tools I've seen, which doesn't mean"}, {"Time_Start": 1139.96, "Time_End": 1142.36, "Text": " anything."}, {"Time_Start": 1142.36, "Time_End": 1149.96, "Text": " You can use the Nemesis RIP or anything else you can think of based on the lip because they support"}, {"Time_Start": 1149.96, "Time_End": 1150.96, "Text": " rip."}, {"Time_Start": 1151.0, "Time_End": 1154.0, "Text": " and you can use ASS to scan this."}, {"Time_Start": 1154.0, "Time_End": 1160.0, "Text": " Problem at the moment is the RIP centers I know do not support the clear text authentication,"}, {"Time_Start": 1160.0, "Time_End": 1164.0, "Text": " which is defined in an RFC, so you might see that."}, {"Time_Start": 1164.0, "Time_End": 1169.0, "Text": " OSPF, open shortest path first."}, {"Time_Start": 1169.0, "Time_End": 1172.0, "Text": " That's a very interesting routing protocol."}, {"Time_Start": 1172.0, "Time_End": 1175.0, "Text": " Unfortunately, it's very complex."}, {"Time_Start": 1175.0, "Time_End": 1180.0, "Text": " Basically one thing it does is sending out link state advertisement."}, {"Time_Start": 1180.0, "Time_End": 1183.0, "Text": " advertisements through the area."}, {"Time_Start": 1183.0, "Time_End": 1187.0, "Text": " Area means you can define routing areas in OSPF,"}, {"Time_Start": 1187.0, "Time_End": 1195.0, "Text": " and every router in the area knows the status of every routing information you might have."}, {"Time_Start": 1195.0, "Time_End": 1201.0, "Text": " So these Halo packets are used to tell each other,"}, {"Time_Start": 1201.0, "Time_End": 1207.0, "Text": " hey, I'm here and I speak OSPF, but they don't include much information."}, {"Time_Start": 1207.0, "Time_End": 1209.0, "Text": " So..."}, {"Time_Start": 1209.0, "Time_End": 1216.0, "Text": " there is another thing that makes OSPF more complicated to attack"}, {"Time_Start": 1216.0, "Time_End": 1224.0, "Text": " because it's basically one of the most secure routing protocols currently in use."}, {"Time_Start": 1224.0, "Time_End": 1231.0, "Text": " Defined in RFC are clear text and MD5 authentication."}, {"Time_Start": 1231.0, "Time_End": 1238.0, "Text": " But one thing to remember is if you don't understand OSPF, the administrator might not as well."}, {"Time_Start": 1238.0, "Time_End": 1243.0, "Text": " So there's the hard to understand factor."}, {"Time_Start": 1243.0, "Time_End": 1249.0, "Text": " Let's say, yeah, most people run OSPF in one area because it's simple."}, {"Time_Start": 1249.0, "Time_End": 1254.0, "Text": " So you might have luck and just have a flawed design."}, {"Time_Start": 1254.0, "Time_End": 1256.0, "Text": " So how do we attack this?"}, {"Time_Start": 1256.0, "Time_End": 1259.0, "Text": " There are several possible attack ways."}, {"Time_Start": 1259.0, "Time_End": 1262.0, "Text": " I choose one that's more interesting"}, {"Time_Start": 1262.0, "Time_End": 1267.0, "Text": " because it's a combination of layer two and their three attacks."}, {"Time_Start": 1267.0, "Time_End": 1268.0, "Text": " We spoke about that."}, {"Time_Start": 1268.0, "Time_End": 1276.0, "Text": " the attacker is able to decide forwarding and is able to modify the IP traffic."}, {"Time_Start": 1276.0, "Time_End": 1280.0, "Text": " So what are we going to do?"}, {"Time_Start": 1280.0, "Time_End": 1285.0, "Text": " Since forged LSAs are often contest by the router,"}, {"Time_Start": 1285.0, "Time_End": 1289.0, "Text": " they have a mechanism called fight back."}, {"Time_Start": 1289.0, "Time_End": 1293.0, "Text": " So if you just introduce false information, the routers will cry around and say,"}, {"Time_Start": 1293.0, "Time_End": 1295.0, "Text": " hey, he's a hacker."}, {"Time_Start": 1295.0, "Time_End": 1297.0, "Text": " So that thing seems to..."}, {"Time_Start": 1297.0, "Time_End": 1304.0, "Text": " thing seems to be you just intercept the communication between Router 1 and Router 2"}, {"Time_Start": 1304.0, "Time_End": 1314.0, "Text": " when Router 1 sends out a packet OSPF wise, you just modify the information and pass it on to Router 2"}, {"Time_Start": 1314.0, "Time_End": 1317.0, "Text": " and he will happily distribute it across the area."}, {"Time_Start": 1317.0, "Time_End": 1322.0, "Text": " Thank you very much."}, {"Time_Start": 1322.0, "Time_End": 1325.0, "Text": " BGP4, Border Gateway Protocol."}, {"Time_Start": 1325.0, "Time_End": 1326.0, "Text": " It's an external..."}, {"Time_Start": 1326.0, "Time_End": 1333.0, "Text": " an exterior gateway protocol, which means it used in vans."}, {"Time_Start": 1333.0, "Time_End": 1337.0, "Text": " And it's mentioned only here because it's important."}, {"Time_Start": 1337.0, "Time_End": 1341.0, "Text": " Can anyone think of why BGP is important?"}, {"Time_Start": 1341.0, "Time_End": 1344.0, "Text": " It runs the Internet."}, {"Time_Start": 1344.0, "Time_End": 1347.0, "Text": " So that makes it interesting."}, {"Time_Start": 1347.0, "Time_End": 1352.0, "Text": " It relies on TCP for communication between the routers."}, {"Time_Start": 1352.0, "Time_End": 1355.0, "Text": " It has a port, 179."}, {"Time_Start": 1355.0, "Time_End": 1356.0, "Text": " You probably know."}, {"Time_Start": 1356.0, "Time_End": 1357.0, "Text": " how to find this."}, {"Time_Start": 1357.0, "Time_End": 1371.0, "Text": " And more interesting is there is iBGP and eBGP means there is an interior BGP and an exterior BGP."}, {"Time_Start": 1371.0, "Time_End": 1381.0, "Text": " Interior BGP actually means how do the routers in one area communicate with each other?"}, {"Time_Start": 1381.0, "Time_End": 1385.0, "Text": " Yeah, but to find each other and to do TCP,"}, {"Time_Start": 1385.0, "Time_End": 1388.0, "Text": " they have to have a route."}, {"Time_Start": 1388.0, "Time_End": 1389.0, "Text": " Okay."}, {"Time_Start": 1389.0, "Time_End": 1399.0, "Text": " So mostly they use IGP, any kind of IGP, or static routes, which is, okay, if you have a BGP4 network"}, {"Time_Start": 1399.0, "Time_End": 1404.0, "Text": " and you use static routes, you're just interesting administrator."}, {"Time_Start": 1404.0, "Time_End": 1409.0, "Text": " So the best way is often to attack the IGP."}, {"Time_Start": 1409.0, "Time_End": 1414.0, "Text": " Yeah, because you can just prevent the routers from speaking to each other."}, {"Time_Start": 1414.0, "Time_End": 1421.0, "Text": " from speaking to each other, you could intercept the TCP communication in any way,"}, {"Time_Start": 1421.0, "Time_End": 1427.0, "Text": " or you can use BGP communities."}, {"Time_Start": 1427.0, "Time_End": 1429.0, "Text": " That's an interesting feature."}, {"Time_Start": 1429.0, "Time_End": 1434.0, "Text": " It's not fully researched yet how to do evil stuff with that,"}, {"Time_Start": 1434.0, "Time_End": 1443.0, "Text": " but it is invented to introduce, let's say, properties to routers you don't own."}, {"Time_Start": 1443.0, "Time_End": 1451.0, "Text": " So let's say UUNET uses communities, you can actually tell the router,"}, {"Time_Start": 1451.0, "Time_End": 1456.0, "Text": " okay, whatever I tell you, it's just for the UUNN internal network,"}, {"Time_Start": 1456.0, "Time_End": 1462.0, "Text": " or whatever you sent me, I don't want to have this and that information."}, {"Time_Start": 1462.0, "Time_End": 1465.0, "Text": " Another one, bad updates."}, {"Time_Start": 1465.0, "Time_End": 1472.0, "Text": " Well, it's not too hard to send bad updates in BGP, but the Internet service providers,"}, {"Time_Start": 1472.0, "Time_End": 1478.0, "Text": " service providers, especially the small ones, are very good in sending updates like,"}, {"Time_Start": 1478.0, "Time_End": 1483.0, "Text": " Dear Internet, I actually know where the 10 network is around the world."}, {"Time_Start": 1483.0, "Time_End": 1488.0, "Text": " So the background providers got used to that and filtered them pretty good."}, {"Time_Start": 1488.0, "Time_End": 1497.0, "Text": " So it's mostly useful internal BGP networks because you don't want all the hosts"}, {"Time_Start": 1497.0, "Time_End": 1501.0, "Text": " in the Internet trying to reach the 10 network over your system."}, {"Time_Start": 1501.0, "Time_End": 1503.0, "Text": " system."}, {"Time_Start": 1503.0, "Time_End": 1507.0, "Text": " Okay, after so much dry routing, here's a fun thing."}, {"Time_Start": 1507.0, "Time_End": 1509.0, "Text": " How'd standby router protocol?"}, {"Time_Start": 1509.0, "Time_End": 1511.0, "Text": " Another Cisco idea."}, {"Time_Start": 1513.0, "Time_End": 1519.0, "Text": " It's used to have a virtual or standby IP address and"}, {"Time_Start": 1519.0, "Time_End": 1524.0, "Text": " another virtual-like Mac address bound to an active router."}, {"Time_Start": 1524.0, "Time_End": 1528.0, "Text": " And you have a bunch of inactive routers."}, {"Time_Start": 1528.0, "Time_End": 1530.0, "Text": " Is the call for me?"}, {"Time_Start": 1530.0, "Time_End": 1531.0, "Text": " No?"}, {"Time_Start": 1531.0, "Time_End": 1539.0, "Text": " You have a bunch of inactive routers sitting there and waiting that the active router dies."}, {"Time_Start": 1539.0, "Time_End": 1543.0, "Text": " Okay, the active router is sending out hello packets all the time."}, {"Time_Start": 1543.0, "Time_End": 1547.0, "Text": " And if he stops sending out hello packets,"}, {"Time_Start": 1547.0, "Time_End": 1552.0, "Text": " the other routers are going to fight for the highest priority"}, {"Time_Start": 1552.0, "Time_End": 1556.0, "Text": " and to actually get the active state."}, {"Time_Start": 1556.0, "Time_End": 1559.0, "Text": " Interesting is it's first multicast."}, {"Time_Start": 1559.0, "Time_End": 1560.0, "Text": " I already mentioned, I love multi-cast."}, {"Time_Start": 1560.0, "Time_End": 1562.0, "Text": " and I love multicas."}, {"Time_Start": 1562.0, "Time_End": 1565.0, "Text": " And the authentication is done in clear text."}, {"Time_Start": 1565.0, "Time_End": 1567.0, "Text": " Maximum eight characters."}, {"Time_Start": 1567.0, "Time_End": 1569.0, "Text": " Thank you."}, {"Time_Start": 1569.0, "Time_End": 1572.0, "Text": " So it basically looks like this."}, {"Time_Start": 1572.0, "Time_End": 1575.0, "Text": " The blue thing down here is this virtual IP address"}, {"Time_Start": 1575.0, "Time_End": 1577.0, "Text": " or standby IP address."}, {"Time_Start": 1577.0, "Time_End": 1582.0, "Text": " So everyone is talking over router 1."}, {"Time_Start": 1582.0, "Time_End": 1588.0, "Text": " When you tell router 1 that R2 is actually a new router"}, {"Time_Start": 1588.0, "Time_End": 1589.0, "Text": " just appears."}, {"Time_Start": 1589.0, "Time_End": 1594.0, "Text": " appeared in the network and has a better priority."}, {"Time_Start": 1594.0, "Time_End": 1599.0, "Text": " This is not as it is designed, but it works."}, {"Time_Start": 1599.0, "Time_End": 1603.0, "Text": " R2 actually gets the standby IP address."}, {"Time_Start": 1603.0, "Time_End": 1605.0, "Text": " So everyone is using R2."}, {"Time_Start": 1605.0, "Time_End": 1607.0, "Text": " What's that for?"}, {"Time_Start": 1607.0, "Time_End": 1610.0, "Text": " Well, but you could actually tell both of them"}, {"Time_Start": 1610.0, "Time_End": 1613.0, "Text": " that you have the highest priority."}, {"Time_Start": 1613.0, "Time_End": 1618.0, "Text": " Can you wait with a question or is it?"}, {"Time_Start": 1618.0, "Time_End": 1623.76, "Text": " So the question is, if there is a key?"}, {"Time_Start": 1627.24, "Time_End": 1635.54, "Text": " No, it just uses clear text authentication, but Cisco already went the way to say, okay, HSRP is kind of interesting,"}, {"Time_Start": 1635.7, "Time_End": 1637.74, "Text": " and if you really want to use it, use IPSEC."}, {"Time_Start": 1638.0, "Time_End": 1639.32, "Text": " Okay, tell this, the dot coms."}, {"Time_Start": 1639.62, "Time_End": 1640.68, "Text": " Was this a question?"}, {"Time_Start": 1641.56, "Time_End": 1642.04, "Text": " Okay."}, {"Time_Start": 1644.74, "Time_End": 1647.12, "Text": " So, yeah, you're telling both of them."}, {"Time_Start": 1647.18, "Time_End": 1647.98, "Text": " You're the best route."}, {"Time_Start": 1648.0, "Time_End": 1655.0, "Text": " to do the job and yeah at the end you have about 20 risk processor just for routing so"}, {"Time_Start": 1655.0, "Time_End": 1659.64, "Text": " you get a virtual IP address and the traffic and what's the best about it it's"}, {"Time_Start": 1659.64, "Time_End": 1665.88, "Text": " 100% transparent to the hosts the IP address didn't change the Mac address didn't"}, {"Time_Start": 1665.88, "Time_End": 1671.32, "Text": " change everything is like it is before just there is this guy here deciding which"}, {"Time_Start": 1671.32, "Time_End": 1677.84, "Text": " traffic is passing well so we had a lot of routing"}, {"Time_Start": 1678.0, "Time_End": 1683.96, "Text": " and some fun. After summer routing, let's hop into tunnels. Generic routing and"}, {"Time_Start": 1683.96, "Time_End": 1692.96, "Text": " Capsulation, GRE, is basically used to transport protocol A over protocol B in a backpack."}, {"Time_Start": 1694.08, "Time_End": 1703.44, "Text": " It's not even limited to IP. So, normally you use IPV4 and IPV4, but to connect six bone"}, {"Time_Start": 1703.44, "Time_End": 1706.48, "Text": " islands, you use IPV6 and IPV4."}, {"Time_Start": 1707.28, "Time_End": 1707.98, "Text": " You can transport."}, {"Time_Start": 1708.0, "Time_End": 1713.0, "Text": " IPX over IPV4 or vice versa, whatever."}, {"Time_Start": 1713.0, "Time_End": 1718.0, "Text": " The best authentication you can get with GRE is a 32-bit tunnel key."}, {"Time_Start": 1718.0, "Time_End": 1720.0, "Text": " Okay."}, {"Time_Start": 1720.0, "Time_End": 1726.0, "Text": " There are sequence numbers to prevent evil people like,"}, {"Time_Start": 1726.0, "Time_End": 1729.0, "Text": " any evil people here, no,"}, {"Time_Start": 1729.0, "Time_End": 1733.0, "Text": " to do anything with the routing protocol,"}, {"Time_Start": 1733.0, "Time_End": 1737.98, "Text": " but you can actually forget it, because it's not the not"}, {"Time_Start": 1738.0, "Time_End": 1745.0, "Text": " defined how they work. They're far away from being as good as TCP sequence numbers,"}, {"Time_Start": 1745.0, "Time_End": 1751.0, "Text": " and they're so bad implemented that it just works if you don't use them."}, {"Time_Start": 1751.0, "Time_End": 1760.0, "Text": " Another very important thing is GRE supports source routing. Has anyone idea what you can do"}, {"Time_Start": 1760.0, "Time_End": 1767.0, "Text": " with that? So, once upon a time, this is a very common situation, at least in Europe."}, {"Time_Start": 1767.0, "Time_End": 1770.0, "Text": " Europe."}, {"Time_Start": 1770.0, "Time_End": 1776.82, "Text": " The company has an HQ on the right side with this cute little server and has several branch offices."}, {"Time_Start": 1776.82, "Time_End": 1780.06, "Text": " We have one on the left side here."}, {"Time_Start": 1780.06, "Time_End": 1789.68, "Text": " So they were used to using these lines or something and because they just hate central authorities."}, {"Time_Start": 1789.68, "Time_End": 1796.98, "Text": " They just decided, okay, we go for RFC in 1918 IP addresses, most of you know these"}, {"Time_Start": 1797.0, "Time_End": 1799.0, "Text": " as private IP addresses."}, {"Time_Start": 1799.0, "Time_End": 1803.0, "Text": " So then they decided, okay, I'm going to save money."}, {"Time_Start": 1803.0, "Time_End": 1807.0, "Text": " Because we have the internet, we can pass over traffic to the internet."}, {"Time_Start": 1807.0, "Time_End": 1811.0, "Text": " Then someone said, hello, your stuff is not routable."}, {"Time_Start": 1811.0, "Time_End": 1817.0, "Text": " Okay, the carrier, being a good guy and knows how to do business,"}, {"Time_Start": 1817.0, "Time_End": 1819.0, "Text": " offers a VPN solution."}, {"Time_Start": 1819.0, "Time_End": 1824.0, "Text": " It just says, okay, we build a GRE tunnel between these two."}, {"Time_Start": 1824.0, "Time_End": 1826.0, "Text": " There's one."}, {"Time_Start": 1826.0, "Time_End": 1827.0, "Text": " And we just,"}, {"Time_Start": 1827.0, "Time_End": 1831.0, "Text": " I just encapsulate all the traffic into the tunnel,"}, {"Time_Start": 1831.0, "Time_End": 1836.0, "Text": " and it's passed from the branch office into the tunnel,"}, {"Time_Start": 1836.0, "Time_End": 1839.0, "Text": " gone out in an H-Q."}, {"Time_Start": 1839.0, "Time_End": 1844.0, "Text": " And for security, because we want you to use security,"}, {"Time_Start": 1844.0, "Time_End": 1846.0, "Text": " it has to be secure,"}, {"Time_Start": 1846.0, "Time_End": 1849.0, "Text": " we just say everything that's not out of the tunnel"}, {"Time_Start": 1849.0, "Time_End": 1852.0, "Text": " is dropped directly here on the interface."}, {"Time_Start": 1852.0, "Time_End": 1854.0, "Text": " And whatever comes into this router,"}, {"Time_Start": 1854.0, "Time_End": 1856.0, "Text": " and the destination is not a local network,"}, {"Time_Start": 1856.0, "Time_End": 1857.0, "Text": " we just,"}, {"Time_Start": 1857.0, "Time_End": 1860.0, "Text": " put it into the tunnel. So that makes it perfectly secure."}, {"Time_Start": 1860.0, "Time_End": 1866.0, "Text": " Our poor guy, Aetaker, has its own router,"}, {"Time_Start": 1866.0, "Time_End": 1870.0, "Text": " and actually a routable IP address."}, {"Time_Start": 1870.0, "Time_End": 1874.0, "Text": " Anyone noticing the IP address?"}, {"Time_Start": 1874.0, "Time_End": 1878.0, "Text": " So he's facing the following situation."}, {"Time_Start": 1878.0, "Time_End": 1883.0, "Text": " He has a network, a target network, let's say this branch office here,"}, {"Time_Start": 1883.0, "Time_End": 1887.0, "Text": " which uses not routable IP address, and"}, {"Time_Start": 1887.0, "Time_End": 1892.0, "Text": " uses a filter here to prevent traffic from coming in"}, {"Time_Start": 1892.0, "Time_End": 1896.0, "Text": " and on top of this uses GRE."}, {"Time_Start": 1896.0, "Time_End": 1899.0, "Text": " So he's lost, isn't he?"}, {"Time_Start": 1899.0, "Time_End": 1901.0, "Text": " Not at all."}, {"Time_Start": 1901.0, "Time_End": 1905.0, "Text": " He just sets up another system."}, {"Time_Start": 1905.0, "Time_End": 1911.0, "Text": " In this case, a concept we call an Atec router."}, {"Time_Start": 1911.0, "Time_End": 1915.0, "Text": " Then he decides, okay, this system is my default"}, {"Time_Start": 1915.0, "Time_End": 1916.0, "Text": " is my default gateway."}, {"Time_Start": 1916.0, "Time_End": 1920.0, "Text": " and he passes traffic to this attack router."}, {"Time_Start": 1920.0, "Time_End": 1924.0, "Text": " Notice the destination of his traffic is actually"}, {"Time_Start": 1924.0, "Time_End": 1926.0, "Text": " the host here."}, {"Time_Start": 1926.0, "Time_End": 1931.0, "Text": " It's not routable anyway, but he's sending this to the attack router."}, {"Time_Start": 1931.0, "Time_End": 1936.0, "Text": " The attack router encapsulates the packet into GRE"}, {"Time_Start": 1936.0, "Time_End": 1942.0, "Text": " and the outer packet is addressed to the branch of his router,"}, {"Time_Start": 1942.0, "Time_End": 1946.0, "Text": " which is getting the traffic, seeing that"}, {"Time_Start": 1946.0, "Time_End": 1951.0, "Text": " the source address is the HQ, guess why?"}, {"Time_Start": 1951.0, "Time_End": 1955.0, "Text": " Finds out that's GRE, cool, decapsulates it,"}, {"Time_Start": 1955.0, "Time_End": 1957.0, "Text": " puts it back on a routing process,"}, {"Time_Start": 1957.0, "Time_End": 1961.0, "Text": " finds out he can reach the host over the internal interface"}, {"Time_Start": 1961.0, "Time_End": 1963.0, "Text": " and just pass it to the host."}, {"Time_Start": 1963.0, "Time_End": 1965.0, "Text": " So what does the host do?"}, {"Time_Start": 1965.0, "Time_End": 1969.0, "Text": " The host actually answers the packet,"}, {"Time_Start": 1969.0, "Time_End": 1974.0, "Text": " whatever that was, and sends it back to his default gateway,"}, {"Time_Start": 1974.0, "Time_End": 1975.0, "Text": " the branch of his router."}, {"Time_Start": 1975.0, "Time_End": 1976.0, "Text": " Who was?"}, {"Time_Start": 1976.0, "Time_End": 1978.0, "Text": " will, according to his routing rules,"}, {"Time_Start": 1978.0, "Time_End": 1982.0, "Text": " encapsulated into GRE and send it back to the HQ."}, {"Time_Start": 1982.0, "Time_End": 1986.0, "Text": " So the HQ router is used for internet access as well."}, {"Time_Start": 1986.0, "Time_End": 1990.0, "Text": " So he knows a way uplink to his provider."}, {"Time_Start": 1990.0, "Time_End": 1996.0, "Text": " So he figures out, well, this packet is reachable over the internet."}, {"Time_Start": 1996.0, "Time_End": 1998.0, "Text": " So I just send it out."}, {"Time_Start": 1998.0, "Time_End": 2002.0, "Text": " And see, our attacker just gets the answer."}, {"Time_Start": 2002.0, "Time_End": 2005.0, "Text": " Which means it looks a little bit strange,"}, {"Time_Start": 2005.0, "Time_End": 2006.0, "Text": " but you're actually talking."}, {"Time_Start": 2006.0, "Time_End": 2009.0, "Text": " to assist them with a private IP address,"}, {"Time_Start": 2009.0, "Time_End": 2012.0, "Text": " across the internet, behind the GRE tunnel,"}, {"Time_Start": 2012.0, "Time_End": 2015.0, "Text": " behind filters, and you have fun."}, {"Time_Start": 2019.0, "Time_End": 2021.0, "Text": " So, since this is so funny,"}, {"Time_Start": 2021.0, "Time_End": 2025.0, "Text": " we'll actually put some more work into this."}, {"Time_Start": 2025.0, "Time_End": 2031.0, "Text": " There's at a moment no support for the source"}, {"Time_Start": 2031.0, "Time_End": 2035.0, "Text": " routing, which makes it so interesting."}, {"Time_Start": 2035.0, "Time_End": 2042.0, "Text": " A thing to do probably is you can apply the same attack to IPX encapsulation,"}, {"Time_Start": 2042.0, "Time_End": 2048.0, "Text": " X25, any takers in the banking industry here?"}, {"Time_Start": 2048.0, "Time_End": 2052.0, "Text": " You can encapsulate IPV4 and IPV4"}, {"Time_Start": 2052.0, "Time_End": 2055.0, "Text": " or even attack IPV6,"}, {"Time_Start": 2055.0, "Time_End": 2058.0, "Text": " six bone islands."}, {"Time_Start": 2058.0, "Time_End": 2061.0, "Text": " So what about taking over an IPV6 host"}, {"Time_Start": 2061.0, "Time_End": 2064.0, "Text": " before it's even on the internet?"}, {"Time_Start": 2064.0, "Time_End": 2069.0, "Text": " So, quick ramp up, what tools do we have?"}, {"Time_Start": 2069.0, "Time_End": 2072.0, "Text": " Yeah, it's not that interesting, but for reference."}, {"Time_Start": 2072.0, "Time_End": 2077.0, "Text": " You can download all this stuff here and the slides on this URL,"}, {"Time_Start": 2077.0, "Time_End": 2079.0, "Text": " or actually look at my shirt."}, {"Time_Start": 2079.0, "Time_End": 2084.0, "Text": " Summary."}, {"Time_Start": 2084.0, "Time_End": 2088.0, "Text": " There are a lot of ways to alter..."}, {"Time_Start": 2088.0, "Time_End": 2089.0, "Text": " Sorry."}, {"Time_Start": 2089.0, "Time_End": 2093.0, "Text": " This one."}, {"Time_Start": 2093.0, "Time_End": 2100.0, "Text": " You can actually grab me and I can tell you how to write that."}, {"Time_Start": 2100.0, "Time_End": 2103.0, "Text": " Okay."}, {"Time_Start": 2103.0, "Time_End": 2108.0, "Text": " I put it back on later."}, {"Time_Start": 2108.0, "Time_End": 2111.0, "Text": " Yeah, summary."}, {"Time_Start": 2111.0, "Time_End": 2115.0, "Text": " You saw there are many ways to alter traffic paths."}, {"Time_Start": 2115.0, "Time_End": 2117.0, "Text": " This was not a complete..."}, {"Time_Start": 2117.0, "Time_End": 2118.0, "Text": " Don't go away."}, {"Time_Start": 2118.0, "Time_End": 2120.0, "Text": " There's a demonstration going on later."}, {"Time_Start": 2120.0, "Time_End": 2122.0, "Text": " Okay."}, {"Time_Start": 2122.0, "Time_End": 2123.0, "Text": " This was..."}, {"Time_Start": 2123.0, "Time_End": 2125.0, "Text": " by far not complete."}, {"Time_Start": 2125.0, "Time_End": 2129.0, "Text": " There are a lot of routing protocols, even undocumented ones."}, {"Time_Start": 2129.0, "Time_End": 2134.0, "Text": " It has still a lot of heck value, especially the BGB 4 attacks."}, {"Time_Start": 2134.0, "Time_End": 2139.0, "Text": " Most routing protocols, as we saw, are very interesting protected."}, {"Time_Start": 2139.0, "Time_End": 2141.0, "Text": " It means nearly nothing."}, {"Time_Start": 2141.0, "Time_End": 2145.0, "Text": " And unencrypted tunneling protocols"}, {"Time_Start": 2145.0, "Time_End": 2149.0, "Text": " are really a high risk and really demonstrate the fact"}, {"Time_Start": 2149.0, "Time_End": 2153.0, "Text": " that these so-called private IP addresses do not protect at all"}, {"Time_Start": 2153.0, "Time_End": 2158.0, "Text": " all. So yeah, thank you to these people, especially to these red people here"}, {"Time_Start": 2158.0, "Time_End": 2160.0, "Text": " shipping me here."}, {"Time_Start": 2160.0, "Time_End": 2165.0, "Text": " And special thank you to you, not falling asleep,"}, {"Time_Start": 2165.0, "Time_End": 2168.0, "Text": " and listening to me here and being at DefCon."}, {"Time_Start": 2168.0, "Time_End": 2172.0, "Text": " And whoever is interested, I'm going to show the GRE attack now live."}, {"Time_Start": 2183.0, "Time_End": 2190.0, "Text": " So, now it's getting tricky."}, {"Time_Start": 2190.0, "Time_End": 2208.0, "Text": " So, I know I'm probably."}, {"Time_Start": 2208.0, "Time_End": 2211.0, "Text": " I know I'm probably over my time."}, {"Time_Start": 2211.0, "Time_End": 2216.0, "Text": " But this is really a fun part to do."}, {"Time_Start": 2216.0, "Time_End": 2221.0, "Text": " Unfortunately, my laptop has a blank screen now for me."}, {"Time_Start": 2221.0, "Time_End": 2226.0, "Text": " Just relax."}, {"Time_Start": 2226.0, "Time_End": 2231.0, "Text": " Okay."}, {"Time_Start": 2231.0, "Time_End": 2236.0, "Text": " What do we have here?"}, {"Time_Start": 2236.0, "Time_End": 2240.0, "Text": " On the left side, upper left side, we have a tenant session to Cisco Row."}, {"Time_Start": 2240.0, "Time_End": 2246.0, "Text": " session to Cisco router, who is actually representing this branch office thing"}, {"Time_Start": 2246.0, "Time_End": 2249.0, "Text": " I tried to show you in the presentation."}, {"Time_Start": 2249.0, "Time_End": 2253.0, "Text": " On the right side, top right side, we have a TCP dump"}, {"Time_Start": 2253.0, "Time_End": 2257.0, "Text": " looking for ICMP because we are doing simple pings here."}, {"Time_Start": 2257.0, "Time_End": 2261.0, "Text": " On the lower left side, we have this already mentioned"}, {"Time_Start": 2261.0, "Time_End": 2266.0, "Text": " viper thing, which is our study in ATTG routing technologies."}, {"Time_Start": 2266.0, "Time_End": 2267.0, "Text": " Thouter!"}, {"Time_Start": 2267.0, "Time_End": 2268.0, "Text": " Thouter!"}, {"Time_Start": 2268.0, "Time_End": 2272.0, "Text": " Oh, bad."}, {"Time_Start": 2272.0, "Time_End": 2276.0, "Text": " Okay, and on the right side you see the local routing table."}, {"Time_Start": 2276.0, "Time_End": 2280.0, "Text": " So what are we going to do?"}, {"Time_Start": 2280.0, "Time_End": 2284.0, "Text": " I'm trying to write blind here."}, {"Time_Start": 2284.0, "Time_End": 2287.0, "Text": " Actually it doesn't work, right?"}, {"Time_Start": 2287.0, "Time_End": 2292.0, "Text": " Can someone up here tell me whenever I write shit or not?"}, {"Time_Start": 2298.0, "Time_End": 2303.0, "Text": " Actually works pretty slow."}, {"Time_Start": 2303.0, "Time_End": 2304.0, "Text": " Okay."}, {"Time_Start": 2304.0, "Time_End": 2316.0, "Text": " So we ping this one and here on the right top side we see the Cisco answers actually with administrative prohibited packages"}, {"Time_Start": 2316.0, "Time_End": 2319.0, "Text": " saying, bad guy, bad guy."}, {"Time_Start": 2319.0, "Time_End": 2322.0, "Text": " Don't send traffic to me, please."}, {"Time_Start": 2322.0, "Time_End": 2323.0, "Text": " Okay."}, {"Time_Start": 2328.0, "Time_End": 2332.0, "Text": " Now we have a new routing table."}, {"Time_Start": 2332.0, "Time_End": 2339.0, "Text": " The new routing table says, please use this eddick router, which is this poor little laptop here,"}, {"Time_Start": 2339.0, "Time_End": 2342.0, "Text": " to do the GRE encapsulation."}, {"Time_Start": 2342.0, "Time_End": 2348.0, "Text": " I will show the configuration file later, but it basically just includes tunnel source and tunnel destination"}, {"Time_Start": 2348.0, "Time_End": 2351.0, "Text": " for this virtual interface here."}, {"Time_Start": 2351.0, "Time_End": 2357.0, "Text": " So now we actually do the same thing."}, {"Time_Start": 2357.0, "Time_End": 2358.0, "Text": " What do we see?"}, {"Time_Start": 2358.0, "Time_End": 2387.6, "Text": " I know it's very hard to read in the crowd here, but on the right side, you see, actually, this interface, this virtual interface, has the Mac address, all AAs, and you actually see that the echo request is sent to this virtual interface, and then the MAC address, all AAs, and you actually see that the echo request is sent to this virtual interface, and then,"}, {"Time_Start": 2387.6, "Time_End": 2389.6, "Text": " passed on."}, {"Time_Start": 2389.6, "Time_End": 2393.6, "Text": " We don't see the pass on here because someone thought that it's a good idea."}, {"Time_Start": 2393.6, "Time_End": 2396.6, "Text": " We show something with sniffing and they gave us a switch."}, {"Time_Start": 2396.6, "Time_End": 2397.6, "Text": " Thank you."}, {"Time_Start": 2397.6, "Time_End": 2402.6, "Text": " Just to illustrate that you can do some more stuff with that"}, {"Time_Start": 2402.6, "Time_End": 2406.6, "Text": " you can do some more stuff with that."}, {"Time_Start": 2406.6, "Time_End": 2410.6, "Text": " I'm trying to write something here."}, {"Time_Start": 2410.6, "Time_End": 2416.6, "Text": " Does this make sense?"}, {"Time_Start": 2416.6, "Time_End": 2419.6, "Text": " Does it? Okay."}, {"Time_Start": 2419.6, "Time_End": 2424.6, "Text": " So, we actually don't want it to do NS lookups."}, {"Time_Start": 2424.6, "Time_End": 2429.6, "Text": " Um, where's the shit?"}, {"Time_Start": 2429.6, "Time_End": 2437.6, "Text": " So on the left side we see the tunneling packets, which is just a verbose output."}, {"Time_Start": 2437.6, "Time_End": 2445.6, "Text": " And on the right side, we see it's actually scanning through this virtual IP router and go figure"}, {"Time_Start": 2445.6, "Time_End": 2449.6, "Text": " Go figure, we bound this IP address on a loop bag of the Cisco,"}, {"Time_Start": 2449.6, "Time_End": 2451.6, "Text": " which is by now pretty clear."}, {"Time_Start": 2451.6, "Time_End": 2453.6, "Text": " So that was it. Thank you."}]}