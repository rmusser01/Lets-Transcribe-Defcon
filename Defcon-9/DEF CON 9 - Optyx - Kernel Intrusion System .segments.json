{"segments": [{"Time_Start": 0.0, "Time_End": 19.240000000000002, "Text": " This is the release of Kiss, and hi, I'm Optex."}, {"Time_Start": 19.240000000000002, "Time_End": 27.240000000000002, "Text": " So, I'm going to..."}, {"Time_Start": 27.240000000000002, "Time_End": 32.24, "Text": " I didn't say our way."}, {"Time_Start": 32.24, "Time_End": 48.24, "Text": " No, it'll work, it just takes."}, {"Time_Start": 48.24, "Time_End": 49.24, "Text": " No, it'll work."}, {"Time_Start": 49.24, "Time_End": 56.24, "Text": " Bigger font?"}, {"Time_Start": 56.24, "Time_End": 60.24, "Text": " Do you want to be able to see it?"}, {"Time_Start": 60.24, "Time_End": 62.24, "Text": " It's not my laptop, so..."}, {"Time_Start": 62.24, "Time_End": 63.24, "Text": " Do they on it?"}, {"Time_Start": 63.24, "Time_End": 66.24000000000001, "Text": " You can do bigger fonts if you don't you."}, {"Time_Start": 66.24000000000001, "Time_End": 70.24000000000001, "Text": " Let's do our all exists."}, {"Time_Start": 70.24000000000001, "Time_End": 71.24000000000001, "Text": " Oh, yeah?"}, {"Time_Start": 71.24000000000001, "Time_End": 76.24000000000001, "Text": " You got to exit on."}, {"Time_Start": 76.24000000000001, "Time_End": 78.24000000000001, "Text": " All right."}, {"Time_Start": 78.24, "Time_End": 85.24, "Text": " Oh, my gosh."}, {"Time_Start": 85.24, "Time_End": 86.24, "Text": " Oh, my gosh."}, {"Time_Start": 86.24, "Time_End": 87.24, "Text": " That's great."}, {"Time_Start": 87.24, "Time_End": 88.24, "Text": " That's great."}, {"Time_Start": 108.24000000000001, "Time_End": 122.24000000000001, "Text": " Okay, so I'm going to start by showing how to configure the client and the server."}, {"Time_Start": 122.24000000000001, "Time_End": 130.24, "Text": " You actually configure the server with the client, so you go to server option, server config."}, {"Time_Start": 130.24, "Time_End": 137.24, "Text": " And you have to set a modulus and a remainder value, and key one and key two."}, {"Time_Start": 137.24, "Time_End": 140.24, "Text": " key 2, which act as passwords."}, {"Time_Start": 140.24, "Time_End": 145.24, "Text": " And then you have to specify an install directory and the binary to Trojan."}, {"Time_Start": 145.24, "Time_End": 162.24, "Text": " So, and then I click save."}, {"Time_Start": 162.24, "Time_End": 165.24, "Text": " And you save this as a header file, so server."}, {"Time_Start": 165.24, "Time_End": 166.24, "Text": " And then copy this as a header file, so server."}, {"Time_Start": 166.24, "Time_End": 167.22, "Text": " And then copy this over to"}, {"Time_Start": 167.24, "Time_End": 170.24, "Text": " to the directory of, well, I'll demonstrate that to see."}, {"Time_Start": 170.24, "Time_End": 182.24, "Text": " So here I've already got the server."}, {"Time_Start": 182.24, "Time_End": 183.24, "Text": " ."}, {"Time_Start": 183.24, "Time_End": 190.24, "Text": " And so I copy that to the KISS server source tree directory."}, {"Time_Start": 190.24, "Time_End": 193.24, "Text": " And I do make."}, {"Time_Start": 193.24, "Time_End": 195.24, "Text": " And note the disclaimer."}, {"Time_Start": 195.24, "Time_End": 196.24, "Text": " For educational purposes only."}, {"Time_Start": 196.24, "Time_End": 200.24, "Text": " purposes only."}, {"Time_Start": 200.24, "Time_End": 205.24, "Text": " I'd like to make this clear this is an educational tool."}, {"Time_Start": 205.24, "Time_End": 217.24, "Text": " And it makes a binary called KISSIONER- And it makes a binary called KISS."}, {"Time_Start": 217.24, "Time_End": 225.24, "Text": " And then if I run that, then I go back over to my GUI and I do options."}, {"Time_Start": 225.24, "Time_End": 228.24, "Text": " options and client configuration."}, {"Time_Start": 228.24, "Time_End": 232.24, "Text": " Here I can choose if I want to spoof the source of the packets,"}, {"Time_Start": 232.24, "Time_End": 238.24, "Text": " if I want to get results, and then you have to set the local IP in port."}, {"Time_Start": 238.24, "Time_End": 242.24, "Text": " If you have to set the local IP that you're sending the packets from."}, {"Time_Start": 242.24, "Time_End": 249.24, "Text": " So if you're behind a NAT network, you'd specify the external IP of your NAT box."}, {"Time_Start": 249.24, "Time_End": 254.24, "Text": " This is 60."}, {"Time_Start": 255.24, "Time_End": 269.24, "Text": " And then I can save this as client.h."}, {"Time_Start": 269.24, "Time_End": 273.24, "Text": " And you see it's bound to the socket so that I can receive results"}, {"Time_Start": 273.24, "Time_End": 276.24, "Text": " because I check the get options box."}, {"Time_Start": 276.24, "Time_End": 282.24, "Text": " The first option is ping, and we specify the target here."}, {"Time_Start": 282.24, "Time_End": 284.24, "Text": " It doesn't matter what port we fire the commands to,"}, {"Time_Start": 284.24, "Time_End": 290.24, "Text": " the commands to because that is irrelevant to the protocol that KISS uses."}, {"Time_Start": 290.24, "Time_End": 298.24, "Text": " So I can specify a random port and then I can send a ping and you see I get the ping response."}, {"Time_Start": 298.24, "Time_End": 304.24, "Text": " A shutdown server obviously shuts down the server."}, {"Time_Start": 304.24, "Time_End": 309.24, "Text": " Remove server removes it so that it restores the binary that it backdoored."}, {"Time_Start": 309.24, "Time_End": 314.24, "Text": " And if you if you look at the binary,"}, {"Time_Start": 314.24, "Time_End": 323.24, "Text": " that I backdored. It hasn't been modified. It's on the same I node because it copies a backup and then redirects sys"}, {"Time_Start": 323.24, "Time_End": 342.24, "Text": " calls for files to statistics back over to the original file. So it looks unmodified."}, {"Time_Start": 342.24, "Time_End": 344.22, "Text": " Yes. And whenever you do remove, it"}, {"Time_Start": 344.24, "Time_End": 353.24, "Text": " it replaces and restores the original binary the way it was whenever you installed it."}, {"Time_Start": 353.24, "Time_End": 358.24, "Text": " Okay, I'm going to skip over a few of these features and come back to them."}, {"Time_Start": 358.24, "Time_End": 359.24, "Text": " List P-hides."}, {"Time_Start": 359.24, "Time_End": 363.24, "Text": " This lists all the hidden processes on the machine."}, {"Time_Start": 363.24, "Time_End": 365.24, "Text": " I can hide processes."}, {"Time_Start": 365.24, "Time_End": 371.24, "Text": " So here I have two shells logged in, or actually a lot."}, {"Time_Start": 371.24, "Time_End": 373.24, "Text": " Can you exit out of those shells?"}, {"Time_Start": 373.24, "Time_End": 374.24, "Text": " Sure."}, {"Time_Start": 374.24, "Time_End": 390.24, "Text": " So here I have three shells logged in."}, {"Time_Start": 390.24, "Time_End": 402.24, "Text": " And currently I'm on TTI3, the PTS3, and I see the PTS3, and I see the PID of the BASH I'm running is 1152."}, {"Time_Start": 402.24, "Time_End": 403.24, "Text": " So I go over to my GUI."}, {"Time_Start": 403.24, "Time_End": 404.24, "Text": " So I go over to my GUI."}, {"Time_Start": 404.24, "Time_End": 415.24, "Text": " and I enter an 1152 hide process and it says PID 152 hidden."}, {"Time_Start": 415.24, "Time_End": 426.24, "Text": " So if I list processes in the terminal that's not hidden, I see 1152 is no longer listed for shells running."}, {"Time_Start": 426.24, "Time_End": 432.24, "Text": " But inside the hidden process, I can still see it."}, {"Time_Start": 432.24, "Time_End": 439.24, "Text": " from here, it automatically hides any files, directories, network connections that I make inside hidden processes."}, {"Time_Start": 439.24, "Time_End": 453.24, "Text": " So if I tell that out to another host, you don't see the connection in the connection listing."}, {"Time_Start": 462.24, "Time_End": 463.24, "Text": " it up either."}, {"Time_Start": 463.24, "Time_End": 464.24, "Text": " Any?"}, {"Time_Start": 464.24, "Time_End": 466.24, "Text": " Oh, LSOF is on."}, {"Time_Start": 466.24, "Time_End": 469.24, "Text": " Oh, no, no, that's on my machine."}, {"Time_Start": 469.24, "Time_End": 474.24, "Text": " This is all done at the kernel level, so that bypasses LSOF."}, {"Time_Start": 474.24, "Time_End": 476.24, "Text": " Do you handle KSTAT?"}, {"Time_Start": 476.24, "Time_End": 478.24, "Text": " Which?"}, {"Time_Start": 478.24, "Time_End": 479.24, "Text": " KSTAT?"}, {"Time_Start": 479.24, "Time_End": 480.24, "Text": " KSTAT?"}, {"Time_Start": 480.24, "Time_End": 486.24, "Text": " Actually, yes, and I'll get to that in a second."}, {"Time_Start": 486.24, "Time_End": 491.24, "Text": " And so inside hidden processes, I make a directory."}, {"Time_Start": 491.24, "Time_End": 504.24, "Text": " I look in my non-hidden process, and I don't see it."}, {"Time_Start": 504.24, "Time_End": 506.24, "Text": " And I can see it inside the hidden process."}, {"Time_Start": 506.24, "Time_End": 509.24, "Text": " I can change directory to it inside a hidden process."}, {"Time_Start": 509.24, "Time_End": 511.24, "Text": " I cannot change directory to it."}, {"Time_Start": 511.24, "Time_End": 514.24, "Text": " It looks like it does not exist."}, {"Time_Start": 514.24, "Time_End": 516.24, "Text": " You cannot stat these files."}, {"Time_Start": 516.24, "Time_End": 520.24, "Text": " You cannot rename them outside of hidden processes."}, {"Time_Start": 520.24, "Time_End": 525.24, "Text": " and another thing about the binary trojan,"}, {"Time_Start": 525.24, "Time_End": 530.24, "Text": " it redirects stuff like U-time and to update the time on it,"}, {"Time_Start": 530.24, "Time_End": 534.24, "Text": " so you can touch the file and it will actually update the original"}, {"Time_Start": 534.24, "Time_End": 536.24, "Text": " that it's kept as backup."}, {"Time_Start": 536.24, "Time_End": 539.24, "Text": " So..."}, {"Time_Start": 539.24, "Time_End": 541.24, "Text": " What happens if you in a..."}, {"Time_Start": 541.24, "Time_End": 544.24, "Text": " In a normal shell,"}, {"Time_Start": 544.24, "Time_End": 549.24, "Text": " create something which is inside the hidden shell."}, {"Time_Start": 549.24, "Time_End": 550.24, "Text": " So you have a..."}, {"Time_Start": 550.24, "Time_End": 552.24, "Text": " if you make it directly in the hidden shape,"}, {"Time_Start": 552.24, "Time_End": 556.24, "Text": " and the user wants to make one in the unhidden chair."}, {"Time_Start": 556.24, "Time_End": 561.24, "Text": " It returns bad permission."}, {"Time_Start": 561.24, "Time_End": 568.24, "Text": " So that, I mean, that's an un-reversible way of detecting this,"}, {"Time_Start": 568.24, "Time_End": 571.24, "Text": " but you'd have to know the exact file name."}, {"Time_Start": 571.24, "Time_End": 575.24, "Text": " But you can't really get around that."}, {"Time_Start": 575.24, "Time_End": 576.24, "Text": " Okay."}, {"Time_Start": 576.24, "Time_End": 578.24, "Text": " What was that right?"}, {"Time_Start": 578.24, "Time_End": 586.24, "Text": " That inside a non-hidden shell, if you try and make a directory or a file that's hidden,"}, {"Time_Start": 586.24, "Time_End": 594.24, "Text": " what's the error message or does it work for a user in a non-hidden shell?"}, {"Time_Start": 594.24, "Time_End": 595.24, "Text": " And..."}, {"Time_Start": 595.24, "Time_End": 596.24, "Text": " Hmm?"}, {"Time_Start": 596.24, "Time_End": 597.24, "Text": " No."}, {"Time_Start": 597.24, "Time_End": 599.24, "Text": " Okay."}, {"Time_Start": 599.24, "Time_End": 602.24, "Text": " Proof is in the butter."}, {"Time_Start": 602.24, "Time_End": 607.24, "Text": " All right."}, {"Time_Start": 607.24, "Time_End": 608.24, "Text": " And..."}, {"Time_Start": 608.24, "Time_End": 610.24, "Text": " and you see that it says file exists."}, {"Time_Start": 610.24, "Time_End": 612.24, "Text": " You can return any error."}, {"Time_Start": 612.24, "Time_End": 613.24, "Text": " It's configurable to..."}, {"Time_Start": 613.24, "Time_End": 617.24, "Text": " You just change the error return value, so you can say e-perm."}, {"Time_Start": 617.24, "Time_End": 620.24, "Text": " Any error you want."}, {"Time_Start": 620.24, "Time_End": 624.24, "Text": " You can even have it say that it doesn't have enough pageable memory,"}, {"Time_Start": 624.24, "Time_End": 626.24, "Text": " which confuses the hell out of people."}, {"Time_Start": 630.24, "Time_End": 633.24, "Text": " I can unhide processes from the GUI."}, {"Time_Start": 633.24, "Time_End": 637.24, "Text": " I can remotely start processes as hidden or unhidden."}, {"Time_Start": 637.24, "Time_End": 638.24, "Text": " So if I do..."}, {"Time_Start": 638.24, "Time_End": 645.24, "Text": " A hidden C.E.E. Shadow to temp Bob."}, {"Time_Start": 645.24, "Time_End": 652.24, "Text": " It says it started the process as P.I.D. 1331."}, {"Time_Start": 652.24, "Time_End": 657.24, "Text": " And I see it copied the file."}, {"Time_Start": 657.24, "Time_End": 658.24, "Text": " So."}, {"Time_Start": 658.24, "Time_End": 665.24, "Text": " All right. So, execution redirection."}, {"Time_Start": 665.24, "Time_End": 668.22, "Text": " A common problem that a lot of how a common problem that a lot of"}, {"Time_Start": 668.24, "Time_End": 673.24, "Text": " is if you might modify binaries on disk,"}, {"Time_Start": 673.24, "Time_End": 676.24, "Text": " then if they're running a"}, {"Time_Start": 676.24, "Time_End": 678.24, "Text": " binary check somewhere like trip wire,"}, {"Time_Start": 678.24, "Time_End": 681.24, "Text": " it'll catch that you've modified the binary."}, {"Time_Start": 681.24, "Time_End": 684.24, "Text": " What this does is whenever you execute a program,"}, {"Time_Start": 684.24, "Time_End": 688.24, "Text": " it actually executes another program,"}, {"Time_Start": 688.24, "Time_End": 690.24, "Text": " but it's transparent to user space."}, {"Time_Start": 690.24, "Time_End": 692.24, "Text": " So the program thinks that it's running"}, {"Time_Start": 692.24, "Time_End": 696.24, "Text": " out of the location that you specified to run."}, {"Time_Start": 696.24, "Time_End": 697.24, "Text": " So if I do,"}, {"Time_Start": 697.24, "Time_End": 701.24, "Text": " If I do bin Cheon to bin PS,"}, {"Time_Start": 705.24, "Time_End": 710.24, "Text": " I see that I've got a process listing when I run Cheon."}, {"Time_Start": 710.24, "Time_End": 713.24, "Text": " So I can do this with SSHD"}, {"Time_Start": 713.24, "Time_End": 717.24, "Text": " and have it actually execute a Trojan SSHD."}, {"Time_Start": 717.24, "Time_End": 723.24, "Text": " And it would, any file sum checker would not pick this up."}, {"Time_Start": 723.24, "Time_End": 726.24, "Text": " I do that based off of the"}, {"Time_Start": 726.24, "Time_End": 730.24, "Text": " I know a number, do you use that based off of the strings?"}, {"Time_Start": 730.24, "Time_End": 733.24, "Text": " Based off of the exec VE strings."}, {"Time_Start": 733.24, "Time_End": 736.24, "Text": " Okay, so if I had a hard link to ."}, {"Time_Start": 736.24, "Time_End": 741.24, "Text": " No, it's actually whenever it calls the exec VE syscall,"}, {"Time_Start": 741.24, "Time_End": 747.24, "Text": " it sees the string bin Chaone and it redirects it to bin PS."}, {"Time_Start": 747.24, "Time_End": 753.24, "Text": " But it doesn't modify ARGV, so the program thinks it's running as bin Chaone."}, {"Time_Start": 753.24, "Time_End": 755.24, "Text": " Right, so LM."}, {"Time_Start": 755.24, "Time_End": 756.24, "Text": " So LN."}, {"Time_Start": 756.24, "Time_End": 760.24, "Text": " and then run VU, you still get the original."}, {"Time_Start": 760.24, "Time_End": 762.24, "Text": " Yes."}, {"Time_Start": 762.24, "Time_End": 764.24, "Text": " How does the font can just have the X-on-in"}, {"Time_Start": 764.24, "Time_End": 766.24, "Text": " program?"}, {"Time_Start": 766.24, "Time_End": 770.24, "Text": " No, I've got a command line client."}, {"Time_Start": 770.24, "Time_End": 772.24, "Text": " It's on my web page."}, {"Time_Start": 772.24, "Time_End": 775.24, "Text": " I'll mention that in a bit."}, {"Time_Start": 775.24, "Time_End": 777.24, "Text": " File system controls."}, {"Time_Start": 777.24, "Time_End": 779.24, "Text": " I can hide files,"}, {"Time_Start": 779.24, "Time_End": 781.24, "Text": " list the hidden files."}, {"Time_Start": 781.24, "Time_End": 784.24, "Text": " And there's two methods of hiding files."}, {"Time_Start": 784.24, "Time_End": 786.22, "Text": " The one that it ships by default, it actually"}, {"Time_Start": 786.24, "Time_End": 790.24, "Text": " it keeps an internal linked list so that there's nothing,"}, {"Time_Start": 790.24, "Time_End": 793.24, "Text": " it doesn't modify anything to do with the file,"}, {"Time_Start": 793.24, "Time_End": 796.24, "Text": " but a method that the TESO guys and a few other people use"}, {"Time_Start": 796.24, "Time_End": 799.24, "Text": " was is they changed it to a UID,"}, {"Time_Start": 799.24, "Time_End": 802.24, "Text": " and if the file matched that UID,"}, {"Time_Start": 802.24, "Time_End": 804.24, "Text": " then it would hide it from directory listings."}, {"Time_Start": 804.24, "Time_End": 808.24, "Text": " The problem with this is you can just pull through change-owning a file"}, {"Time_Start": 808.24, "Time_End": 811.24, "Text": " through all possible UIDs, and if it disappears,"}, {"Time_Start": 811.24, "Time_End": 814.24, "Text": " you know you've been owned."}, {"Time_Start": 814.24, "Time_End": 815.24, "Text": " And that's a problem."}, {"Time_Start": 815.24, "Time_End": 818.24, "Text": " That's a problem."}, {"Time_Start": 818.24, "Time_End": 822.24, "Text": " Network control, you can hide unhide network connections."}, {"Time_Start": 822.24, "Time_End": 826.24, "Text": " If you specify just a port, it'll hide everything coming in from that port."}, {"Time_Start": 826.24, "Time_End": 832.24, "Text": " If you specify an IP colon zero, it'll hide all connections from that machine."}, {"Time_Start": 836.24, "Time_End": 845.24, "Text": " The plugin interface, it has a capability to use kernel modules as plugins or user-s"}, {"Time_Start": 845.24, "Time_End": 849.96, "Text": " space binaries as kernel plugins inside hidden processes you can"}, {"Time_Start": 849.96, "Time_End": 870.08, "Text": " exec VE kernel functions so let me demonstrate that well here I'll show you the code for this"}, {"Time_Start": 870.08, "Time_End": 875.22, "Text": " first so all this does is a standard exempt"}, {"Time_Start": 875.24, "Time_End": 879.98, "Text": " VE of any arguments you pass in and as the file name parameter if you"}, {"Time_Start": 879.98, "Time_End": 885.2, "Text": " pass in a zero it won't print anything if it has return values if you specify one it'll"}, {"Time_Start": 885.2, "Time_End": 889.7, "Text": " print it out to the current TTI so I specify one so that I can see what I'm doing"}, {"Time_Start": 889.7, "Time_End": 899.9, "Text": " and I can do say hide file temp and it says temp hidden and yeah so that's"}, {"Time_Start": 899.9, "Time_End": 905.0, "Text": " pretty self-explanatory"}, {"Time_Start": 905.24, "Time_End": 908.84, "Text": " So what are great the system is designed currently?"}, {"Time_Start": 908.84, "Time_End": 910.54, "Text": " It's for Linux 2-2 and 2-4."}, {"Time_Start": 911.74, "Time_End": 916.32, "Text": " This is very kernel-specific code because it is a kernel module,"}, {"Time_Start": 917.12, "Time_End": 919.82, "Text": " but you could easily port it over to other platforms"}, {"Time_Start": 919.82, "Time_End": 923.28, "Text": " because it's just concepts that you have to port over."}, {"Time_Start": 926.46, "Time_End": 933.42, "Text": " And so I can load plugins, and I'll get back to the plug-in interface"}, {"Time_Start": 933.42, "Time_End": 934.8, "Text": " after I talk about the communication."}, {"Time_Start": 935.24, "Time_End": 939.24, "Text": " So this all communicates without listening ports."}, {"Time_Start": 939.24, "Time_End": 946.24, "Text": " The traffic can be spoofed both ways, and you can still get results, even if you spoof it."}, {"Time_Start": 946.24, "Time_End": 948.24, "Text": " I can do a demonstration of that."}, {"Time_Start": 948.24, "Time_End": 964.24, "Text": " To the client, you can pass in parameters minus C, and then the client header file, and then minus S, and the server header file."}, {"Time_Start": 964.24, "Time_End": 967.24, "Text": " server header file so you don't have to go through the config again."}, {"Time_Start": 971.24, "Time_End": 974.24, "Text": " Oh yeah, I guess I can't do that."}, {"Time_Start": 978.24, "Time_End": 982.24, "Text": " Okay, so if I go back to my client config,"}, {"Time_Start": 982.24, "Time_End": 988.24, "Text": " I can select the spoof box and specify an IP."}, {"Time_Start": 988.24, "Time_End": 993.24, "Text": " If I specify an IP of zero, it spooves from a random source IP every time,"}, {"Time_Start": 993.24, "Time_End": 998.24, "Text": " If I specify a port of zero, it spoofs from a random port every time."}, {"Time_Start": 998.24, "Time_End": 1004.24, "Text": " An easy way to get through firewall, since this is all loosely based on the UDP protocol,"}, {"Time_Start": 1004.24, "Time_End": 1006.24, "Text": " it's routed as UDP."}, {"Time_Start": 1006.24, "Time_End": 1013.24, "Text": " You can spoof source port 53 in the IP of their name server and hop through a lot of firewalls."}, {"Time_Start": 1013.24, "Time_End": 1016.24, "Text": " So I'll just do random."}, {"Time_Start": 1016.24, "Time_End": 1022.24, "Text": " For education."}, {"Time_Start": 1022.24, "Time_End": 1023.24, "Text": " Yes."}, {"Time_Start": 1023.24, "Time_End": 1025.24, "Text": " purposes"}, {"Time_Start": 1027.24, "Time_End": 1033.24, "Text": " As in like different levels of access to this?"}, {"Time_Start": 1033.24, "Time_End": 1035.24, "Text": " Less than one from different levels of access to this."}, {"Time_Start": 1039.24, "Time_End": 1043.24, "Text": " In times of port?"}, {"Time_Start": 1043.24, "Time_End": 1045.24, "Text": " Oh no, I could specify any port."}, {"Time_Start": 1045.24, "Time_End": 1047.24, "Text": " So I could specify nine."}, {"Time_Start": 1047.24, "Time_End": 1049.24, "Text": " I don't get it."}, {"Time_Start": 1049.24, "Time_End": 1050.24, "Text": " All right."}, {"Time_Start": 1050.24, "Time_End": 1051.24, "Text": " I could, yeah."}, {"Time_Start": 1051.24, "Time_End": 1052.24, "Text": " So."}, {"Time_Start": 1052.24, "Time_End": 1053.24, "Text": " All right."}, {"Time_Start": 1053.24, "Time_End": 1055.24, "Text": " that's a good port number, I think."}, {"Time_Start": 1063.24, "Time_End": 1066.24, "Text": " Okay, so I think this feature is broken under OpenBSD."}, {"Time_Start": 1066.24, "Time_End": 1070.24, "Text": " I've only tested the client's spoofing capabilities under Linux."}, {"Time_Start": 1070.24, "Time_End": 1074.24, "Text": " But yeah."}, {"Time_Start": 1074.24, "Time_End": 1081.24, "Text": " So the way the communication works is, I came to the problem that a lot of other remote control agents,"}, {"Time_Start": 1081.24, "Time_End": 1083.24, "Text": " it's easy to tell if they're hard."}, {"Time_Start": 1083.24, "Time_End": 1087.24, "Text": " hooking the IP stack because it increases the latency of the IP stack."}, {"Time_Start": 1087.24, "Time_End": 1090.24, "Text": " And you can detect it with anti-sniffers."}, {"Time_Start": 1090.24, "Time_End": 1095.24, "Text": " So what I did was is whenever you set up the client or the server configuration,"}, {"Time_Start": 1095.24, "Time_End": 1100.24, "Text": " you specified a modulus value, a remainder value, and the two keys."}, {"Time_Start": 1100.24, "Time_End": 1103.24, "Text": " What it does is, is when a packet comes in off the IP stack,"}, {"Time_Start": 1103.24, "Time_End": 1107.24, "Text": " it takes a modulus of the length of the packet, and if the remainder matches,"}, {"Time_Start": 1107.24, "Time_End": 1109.24, "Text": " it's a possible command packet."}, {"Time_Start": 1109.24, "Time_End": 1113.24, "Text": " From there, it passes it on to SHA, where it takes the source IP,"}, {"Time_Start": 1113.24, "Time_End": 1122.24, "Text": " the destination IP, the destination port, and Shared Secret 1, which is key 1, sends that through SHA, and XORs the packet with it."}, {"Time_Start": 1122.24, "Time_End": 1126.24, "Text": " And the first part of the packet matches Shared Secret 2, that it's a valid command packet."}, {"Time_Start": 1126.24, "Time_End": 1132.24, "Text": " This means if you change the port you're firing it to, it completely changes the encryption key."}, {"Time_Start": 1132.24, "Time_End": 1136.24, "Text": " If you change the source IP, it changes the encryption key."}, {"Time_Start": 1136.24, "Time_End": 1140.24, "Text": " Yeah, so it can be signatured."}, {"Time_Start": 1140.24, "Time_End": 1142.24, "Text": " The traffic can't, that is."}, {"Time_Start": 1142.24, "Time_End": 1146.24, "Text": " is."}, {"Time_Start": 1146.24, "Time_End": 1154.24, "Text": " Yeah, it, it, it, it, it, it, it, it, it, it's, it, it's doing the encryption of the packets, it uses that IP that it randomly generated as."}, {"Time_Start": 1154.24, "Time_End": 1160.24, "Text": " That is, if, if, if, excuse me?"}, {"Time_Start": 1160.24, "Time_End": 1170.24, "Text": " If you, if you, if you change the port that you're sending the command to, it'll, it'll, it'll, uh."}, {"Time_Start": 1170.24, "Time_End": 1179.24, "Text": " Yes, yes, it would be the same encryption system."}, {"Time_Start": 1179.24, "Time_End": 1184.24, "Text": " So, what else?"}, {"Time_Start": 1184.24, "Time_End": 1192.24, "Text": " Okay, as far as the plug-in capabilities go, you can just take and compile plugins that"}, {"Time_Start": 1192.24, "Time_End": 1196.24, "Text": " there's a plug-in interface for the kernel that I wrote,"}, {"Time_Start": 1196.24, "Time_End": 1199.24, "Text": " it uses the standard module loading capabilities."}, {"Time_Start": 1199.24, "Time_End": 1200.24, "Text": " You just have to define a few."}, {"Time_Start": 1200.24, "Time_End": 1207.24, "Text": " functions and all this does is send you back what you specified as an argument."}, {"Time_Start": 1207.24, "Time_End": 1210.24, "Text": " So I compile this."}, {"Time_Start": 1210.24, "Time_End": 1215.24, "Text": " Oh yeah."}, {"Time_Start": 1230.24, "Time_End": 1237.24, "Text": " Okay, that's, uh, uh, Red Hat 7-0 decided to switch with beta builds of GCC."}, {"Time_Start": 1237.24, "Time_End": 1240.24, "Text": " And so you get tons of assembler, uh,"}, {"Time_Start": 1240.24, "Time_End": 1244.24, "Text": " because that was a poor move on their part."}, {"Time_Start": 1244.24, "Time_End": 1250.24, "Text": " So what I can do to load plugins is I can either load them through the client,"}, {"Time_Start": 1250.24, "Time_End": 1256.24, "Text": " or if I want them to load at startup, I can just cat them to the back of the KISS server."}, {"Time_Start": 1256.24, "Time_End": 1259.24, "Text": " And they'll, they'll load it."}, {"Time_Start": 1259.24, "Time_End": 1260.24, "Text": " It recurs."}, {"Time_Start": 1260.24, "Time_End": 1265.24, "Text": " loads anything you clip onto the back of it."}, {"Time_Start": 1265.24, "Time_End": 1270.24, "Text": " And, yeah, so."}, {"Time_Start": 1270.24, "Time_End": 1273.24, "Text": " Should we scream yes?"}, {"Time_Start": 1273.24, "Time_End": 1276.24, "Text": " Yeah."}, {"Time_Start": 1276.24, "Time_End": 1281.24, "Text": " Okay, so, well, there's, there's some other options."}, {"Time_Start": 1281.24, "Time_End": 1285.24, "Text": " There's some other options I've got in here as well."}, {"Time_Start": 1285.24, "Time_End": 1290.24, "Text": " There's, you can define, by default, it ships this way, anti-secure"}, {"Time_Start": 1290.24, "Time_End": 1292.24, "Text": " which means anti-security modules."}, {"Time_Start": 1292.24, "Time_End": 1297.24, "Text": " It can actively disable every kernel-based IDS I found"}, {"Time_Start": 1297.24, "Time_End": 1301.24, "Text": " without it knowing about it."}, {"Time_Start": 1301.24, "Time_End": 1305.24, "Text": " And if you want to add new modules to the list,"}, {"Time_Start": 1305.24, "Time_End": 1306.24, "Text": " it's really easy."}, {"Time_Start": 1306.24, "Time_End": 1309.24, "Text": " You just edit the KISC file."}, {"Time_Start": 1309.24, "Time_End": 1311.24, "Text": " Let me look."}, {"Time_Start": 1311.24, "Time_End": 1314.24, "Text": " So you just add a string compare."}, {"Time_Start": 1314.24, "Time_End": 1317.24, "Text": " You can choose to either let it load and then disable it,"}, {"Time_Start": 1317.24, "Time_End": 1319.24, "Text": " or just never let it load and not tell the user."}, {"Time_Start": 1319.24, "Time_End": 1326.24, "Text": " user. Right now it actually disables carbonite, the Linux Mac implementation,"}, {"Time_Start": 1326.24, "Time_End": 1329.24, "Text": " St. Michael and St. Jude."}, {"Time_Start": 1329.24, "Time_End": 1331.24, "Text": " Um..."}, {"Time_Start": 1331.24, "Time_End": 1336.24, "Text": " What the modules are not in the mod list?"}, {"Time_Start": 1336.24, "Time_End": 1338.24, "Text": " In the mod list?"}, {"Time_Start": 1338.24, "Time_End": 1343.24, "Text": " The newer versions of St. Michael, it had to remove itself from the modules."}, {"Time_Start": 1343.24, "Time_End": 1346.24, "Text": " Yeah, it'll find it in memory and remove it."}, {"Time_Start": 1346.24, "Time_End": 1348.24, "Text": " The same way it finds itself in memory and removes it."}, {"Time_Start": 1348.24, "Time_End": 1349.24, "Text": " Oh yeah."}, {"Time_Start": 1349.24, "Time_End": 1354.34, "Text": " the way I didn't show this but if you do an LS mod it doesn't show any it doesn't"}, {"Time_Start": 1354.34, "Time_End": 1359.84, "Text": " show that KISS is loaded and this is all done in the module itself as opposed"}, {"Time_Start": 1359.84, "Time_End": 1363.64, "Text": " to the way St. Michael does it by loading a secondary module which removes it"}, {"Time_Start": 1363.64, "Time_End": 1368.08, "Text": " from the list and that's very easily flagged and once it's doing the initialization"}, {"Time_Start": 1368.08, "Time_End": 1373.64, "Text": " process is when I remove it or and if it's already loaded it'll just find it in"}, {"Time_Start": 1373.64, "Time_End": 1379.04, "Text": " kernel space and and unload it."}, {"Time_Start": 1379.24, "Time_End": 1389.84, "Text": " Other options that it has, you can define elite GID and hide the way, use GID based hiding."}, {"Time_Start": 1389.84, "Time_End": 1395.1, "Text": " This is the method I talked about before where you can easily find it if you just chain a file"}, {"Time_Start": 1395.1, "Time_End": 1399.94, "Text": " over and over and over and over until finally the file disappears."}, {"Time_Start": 1399.94, "Time_End": 1402.04, "Text": " What's another option I added?"}, {"Time_Start": 1402.04, "Time_End": 1403.24, "Text": " Oh no, that's it."}, {"Time_Start": 1403.24, "Time_End": 1404.24, "Text": " That's all I ship with."}, {"Time_Start": 1404.24, "Time_End": 1406.24, "Text": " So."}, {"Time_Start": 1406.24, "Time_End": 1407.74, "Text": " There's other things in development there."}, {"Time_Start": 1407.74, "Time_End": 1408.74, "Text": " Yeah, there's other plug."}, {"Time_Start": 1408.74, "Time_End": 1413.98, "Text": " plug-ins in development and the plugin interface is very easy to learn and you don't"}, {"Time_Start": 1413.98, "Time_End": 1416.5, "Text": " have to deal with interrupts from user space. Yeah."}, {"Time_Start": 1416.5, "Time_End": 1433.5, "Text": " Yeah."}, {"Time_Start": 1433.5, "Time_End": 1438.72, "Text": " I've got to decide to use my server for educational services. It's a good proof. Currently, you could detect this version with K-Stat. I've got other code which will beat K-Stat. It's a plug-in to this."}, {"Time_Start": 1438.74, "Time_End": 1447.74, "Text": " that may or may not be made public, depending on the reaction of the security community to this."}, {"Time_Start": 1447.74, "Time_End": 1452.74, "Text": " And, okay."}, {"Time_Start": 1452.74, "Time_End": 1457.74, "Text": " Are you playing to some detection to it?"}, {"Time_Start": 1457.74, "Time_End": 1461.74, "Text": " Actually, here's the funny thing."}, {"Time_Start": 1461.74, "Time_End": 1468.72, "Text": " Here's the funny thing. About a year and a year and a half ago, I wrote a completely in the"}, {"Time_Start": 1468.74, "Time_End": 1474.02, "Text": " kernel sign module loader so that you kept a signing tool and a key on another"}, {"Time_Start": 1474.02, "Time_End": 1477.74, "Text": " machine or floppy disk and you just signed all the modules you wanted to load into kernel space"}, {"Time_Start": 1477.74, "Time_End": 1484.28, "Text": " so that it would only load verified code into kernel space and I had 50 downloads in six"}, {"Time_Start": 1484.28, "Time_End": 1487.58, "Text": " months so I just took it off my website because apparently people weren't concerned"}, {"Time_Start": 1487.58, "Time_End": 1489.24, "Text": " with this even though it's a big problem."}, {"Time_Start": 1492.24, "Time_End": 1498.72, "Text": " In other words, let's say my blog is compromised"}, {"Time_Start": 1498.74, "Time_End": 1501.74, "Text": " they start using it as a file in place."}, {"Time_Start": 1501.74, "Time_End": 1508.74, "Text": " If someone, Satola files would be able to see the file size?"}, {"Time_Start": 1508.74, "Time_End": 1510.74, "Text": " No."}, {"Time_Start": 1510.74, "Time_End": 1515.74, "Text": " Yes, actually you would because you can't hide that on Extended 2 or Rizer."}, {"Time_Start": 1515.74, "Time_End": 1519.74, "Text": " I don't know about other file systems."}, {"Time_Start": 1519.74, "Time_End": 1525.74, "Text": " But if you mounted something using it as fast and used to your mode, right?"}, {"Time_Start": 1525.74, "Time_End": 1528.74, "Text": " Well, well, here's a way to detect it, but you're good."}, {"Time_Start": 1528.74, "Time_End": 1531.04, "Text": " It involves downing the machine."}, {"Time_Start": 1531.04, "Time_End": 1536.14, "Text": " If you do a find and just map out your whole hard drive, like from root,"}, {"Time_Start": 1536.14, "Time_End": 1539.2, "Text": " and then you shut the machine down, boot off of another disk,"}, {"Time_Start": 1539.2, "Time_End": 1543.64, "Text": " and then mount that drive, not as root, however,"}, {"Time_Start": 1543.64, "Time_End": 1544.56, "Text": " and then map it out."}, {"Time_Start": 1544.56, "Time_End": 1548.54, "Text": " If you see any hidden files that weren't there before,"}, {"Time_Start": 1548.54, "Time_End": 1550.68, "Text": " then that's probably where it's located,"}, {"Time_Start": 1550.68, "Time_End": 1552.88, "Text": " and there's a nice backup of it kept there"}, {"Time_Start": 1552.88, "Time_End": 1554.98, "Text": " of your original file so you can restore it."}, {"Time_Start": 1558.74, "Time_End": 1560.74, "Text": " Anything else?"}, {"Time_Start": 1560.74, "Time_End": 1563.74, "Text": " Do you do anything to hide promiscuous mode?"}, {"Time_Start": 1563.74, "Time_End": 1569.74, "Text": " I've got a module, which is on my web page, a plug-in for this, that does that."}, {"Time_Start": 1569.74, "Time_End": 1574.74, "Text": " If you're inside a hidden process and you throw the device into promiscuous mode,"}, {"Time_Start": 1574.74, "Time_End": 1580.74, "Text": " it won't show that it's hidden or that it's in promiscuous mode, but if you do it as an admin, it will."}, {"Time_Start": 1580.74, "Time_End": 1583.74, "Text": " Or is a..."}, {"Time_Start": 1583.74, "Time_End": 1586.74, "Text": " Are both sides?"}, {"Time_Start": 1586.74, "Time_End": 1587.74, "Text": " Are both sides?"}, {"Time_Start": 1587.74, "Time_End": 1588.74, "Text": " Are both sides?"}, {"Time_Start": 1588.74, "Time_End": 1593.74, "Text": " No, the client actually listens on a port, it's standard UDP traffic."}, {"Time_Start": 1593.74, "Time_End": 1596.74, "Text": " Oh."}, {"Time_Start": 1596.74, "Time_End": 1602.74, "Text": " You know, if you run it as for the defensive purposes on your own network,"}, {"Time_Start": 1602.74, "Time_End": 1606.74, "Text": " and it's over, and the name trying to put into the list of purposes"}, {"Time_Start": 1606.74, "Time_End": 1610.74, "Text": " and that person who's broken in the text that you're actually running on your server."}, {"Time_Start": 1610.74, "Time_End": 1614.74, "Text": " Um, you, uh, KISS also has anti-KISS capabilities."}, {"Time_Start": 1614.74, "Time_End": 1617.74, "Text": " Um, so that you can use it as, you can use it as you can use it as you can't use it as you."}, {"Time_Start": 1617.74, "Time_End": 1624.94, "Text": " You can use it as a, it's very easy if you just drop in plugins to make it a security product."}, {"Time_Start": 1624.94, "Time_End": 1630.74, "Text": " You can make it into whatever you want and it would be great for the HoneyNet project for remotely managing machines."}, {"Time_Start": 1630.74, "Time_End": 1637.74, "Text": " My question is, no, they'd have to know the modulus, the remainder value in both shared secrets."}, {"Time_Start": 1647.74, "Time_End": 1656.18, "Text": " this is open BSD, but I, there's, I don't know why the raw sockets don't work on this right now."}, {"Time_Start": 1656.18, "Time_End": 1657.74, "Text": " I'm root and..."}, {"Time_Start": 1657.74, "Time_End": 1660.74, "Text": " Wait, wait, wait, wait, wait."}, {"Time_Start": 1660.74, "Time_End": 1661.74, "Text": " I'm back."}, {"Time_Start": 1661.74, "Time_End": 1674.74, "Text": " I just wanted to say, you know, I think I don't, I use Linux, and I think that you're saying, I don't really understand a lot of it, but I think that you're saying that what you're doing for Linux is making it bad, and I use Linux 2.4, it's really good."}, {"Time_Start": 1677.74, "Time_End": 1680.74, "Text": " for that is, and I just think this is really bad."}, {"Time_Start": 1680.74, "Time_End": 1684.74, "Text": " Yellow."}, {"Time_Start": 1684.74, "Time_End": 1685.74, "Text": " Woo!"}, {"Time_Start": 1685.74, "Time_End": 1692.74, "Text": " You do this, you think it's so funny, and you're laughing at it, but you know what?"}, {"Time_Start": 1692.74, "Time_End": 1694.74, "Text": " You know who is not laughing?"}, {"Time_Start": 1694.74, "Time_End": 1696.74, "Text": " Richard Stone is not laughing."}, {"Time_Start": 1696.74, "Time_End": 1698.74, "Text": " This is not really bad."}, {"Time_Start": 1698.74, "Time_End": 1702.74, "Text": " He thinks he's really bad."}, {"Time_Start": 1702.74, "Time_End": 1704.74, "Text": " You're really bad."}, {"Time_Start": 1704.74, "Time_End": 1705.74, "Text": " Five!"}, {"Time_Start": 1705.74, "Time_End": 1706.74, "Text": " Good!"}, {"Time_Start": 1706.74, "Time_End": 1707.74, "Text": " Put it!"}, {"Time_Start": 1707.74, "Time_End": 1708.74, "Text": " Oh!"}, {"Time_Start": 1734.74, "Time_End": 1748.74, "Text": " We, okay, so my website, my website is uh,"}, {"Time_Start": 1748.74, "Time_End": 1751.74, "Text": " my website is uberhaxor.net."}, {"Time_Start": 1751.74, "Time_End": 1752.74, "Text": " Uh-huh."}, {"Time_Start": 1752.74, "Time_End": 1754.74, "Text": " Yeah."}, {"Time_Start": 1754.74, "Time_End": 1756.74, "Text": " U-Hexhaxor with an O."}, {"Time_Start": 1756.74, "Time_End": 1760.74, "Text": " U-U-B-E-H-R-H-A-H-R-H-A-X-Z."}, {"Time_Start": 1760.74, "Time_End": 1763.74, "Text": " Or, yeah, U-B-E-R-H-A-X-Z."}, {"Time_Start": 1763.74, "Time_End": 1769.74, "Text": " X0R.net, and then the download site is forward slash KIS, but there's a link to it off the main page."}, {"Time_Start": 1769.74, "Time_End": 1771.74, "Text": " Should we taunt for awareness?"}, {"Time_Start": 1771.74, "Time_End": 1772.74, "Text": " I think we should taunt them."}, {"Time_Start": 1772.74, "Time_End": 1773.74, "Text": " Okay."}, {"Time_Start": 1775.74, "Time_End": 1778.74, "Text": " Dude, quality HTML."}, {"Time_Start": 1778.74, "Time_End": 1780.74, "Text": " I added my first picture to the web."}, {"Time_Start": 1780.74, "Time_End": 1782.74, "Text": " What you said right?"}, {"Time_Start": 1782.74, "Time_End": 1784.74, "Text": " Go!"}, {"Time_Start": 1784.74, "Time_End": 1786.74, "Text": " Go!"}, {"Time_Start": 1786.74, "Time_End": 1787.74, "Text": " Right?"}, {"Time_Start": 1787.74, "Time_End": 1788.74, "Text": " Oh."}, {"Time_Start": 1788.74, "Time_End": 1789.74, "Text": " Hey, I am I!"}, {"Time_Start": 1789.74, "Time_End": 1791.74, "Text": " Hi-a-I-ha-ha-ha-ha-ha-ha-ha!"}, {"Time_Start": 1819.74, "Time_End": 1833.74, "Text": " So we should"}, {"Time_Start": 1833.74, "Time_End": 1835.74, "Text": " So we should boot those fuck right?"}, {"Time_Start": 1835.74, "Time_End": 1836.74, "Text": " Um"}, {"Time_Start": 1836.74, "Time_End": 1839.74, "Text": " The special glue exploit"}, {"Time_Start": 1839.74, "Time_End": 1841.74, "Text": " Yeah, um, um,"}, {"Time_Start": 1841.74, "Time_End": 1843.74, "Text": " Yeah, uh, boot them."}, {"Time_Start": 1843.74, "Time_End": 1844.74, "Text": " They won't boot, but..."}, {"Time_Start": 1849.74, "Time_End": 1851.74, "Text": " All right, so that's it."}]}