{"segments": [{"Time_Start": 0.0, "Time_End": 18.0, "Text": " Now, I hope that you have a good time at DEFCON."}, {"Time_Start": 18.0, "Time_End": 23.0, "Text": " So this talk is called HAC-Henny website."}, {"Time_Start": 23.0, "Time_End": 26.0, "Text": " This is a very sexy title."}, {"Time_Start": 26.0, "Time_End": 29.0, "Text": " This is explained but there are so many people in the room."}, {"Time_Start": 29.0, "Time_End": 34.0, "Text": " Actually, it's more about man in the middle attack."}, {"Time_Start": 34.0, "Time_End": 38.0, "Text": " So first I will give you an overview of this attack."}, {"Time_Start": 38.0, "Time_End": 45.0, "Text": " Then I've prepared a few demos to show you what it's possible to do with this attack."}, {"Time_Start": 45.0, "Time_End": 51.0, "Text": " After that, I will give you some general analysis and I will explain to you how it works."}, {"Time_Start": 51.0, "Time_End": 58.0, "Text": " Then I follow up with some technical analysis and I will show you the code to be able to reproduce this attack."}, {"Time_Start": 58.0, "Time_End": 65.0, "Text": " Then I will give you some defense mechanism and then I will conclude."}, {"Time_Start": 65.0, "Time_End": 69.0, "Text": " So what is the man in the middle attack?"}, {"Time_Start": 69.0, "Time_End": 75.0, "Text": " The problem is today server are more and more well protected, but the client are not."}, {"Time_Start": 75.0, "Time_End": 77.0, "Text": " So the idea is the following."}, {"Time_Start": 77.0, "Time_End": 82.0, "Text": " You have a client, you have a server, and between them you have the men in the middle."}, {"Time_Start": 82.0, "Time_End": 86.0, "Text": " You have a communication between the client and the server."}, {"Time_Start": 86.0, "Time_End": 87.0, "Text": " Let's say that the client says,"}, {"Time_Start": 87.0, "Time_End": 94.0, "Text": " that the client send a request to the server, the man in the middle will intercept this request."}, {"Time_Start": 94.0, "Time_End": 97.0, "Text": " It's possible to modify this request."}, {"Time_Start": 97.0, "Time_End": 105.0, "Text": " The server will response and once again the man in the middle will intercept this response."}, {"Time_Start": 105.0, "Time_End": 109.0, "Text": " And once again, it's possible to modify the response."}, {"Time_Start": 109.0, "Time_End": 113.0, "Text": " So this is a very generic man in the middle attack."}, {"Time_Start": 113.0, "Time_End": 116.0, "Text": " And I will show you how it's possible to do it with Internet Explorer."}, {"Time_Start": 116.0, "Time_End": 118.0, "Text": " explorer."}, {"Time_Start": 118.0, "Time_End": 122.0, "Text": " So I've prepared a few demo for you."}, {"Time_Start": 122.0, "Time_End": 125.0, "Text": " And as the wireless connection does not work very well,"}, {"Time_Start": 125.0, "Time_End": 127.0, "Text": " I did it yesterday in my hotel room,"}, {"Time_Start": 127.0, "Time_End": 130.0, "Text": " and I will be able to show you what I did."}, {"Time_Start": 130.0, "Time_End": 135.0, "Text": " So first, I will try, I will start with eye notes."}, {"Time_Start": 135.0, "Time_End": 138.0, "Text": " So you probably know I notes."}, {"Time_Start": 138.0, "Time_End": 141.0, "Text": " This is a webmail interface to access mail"}, {"Time_Start": 141.0, "Time_End": 145.0, "Text": " when you're running Lotus Domino."}, {"Time_Start": 145.0, "Time_End": 149.0, "Text": " So I will launch the demo."}, {"Time_Start": 149.0, "Time_End": 157.0, "Text": " So this is a very basic computer running Windows 2000 with Internet Explorer."}, {"Time_Start": 157.0, "Time_End": 160.0, "Text": " I've started an Internet Explorer."}, {"Time_Start": 160.0, "Time_End": 165.0, "Text": " I will type in the address bar the URL to access the webmail interface."}, {"Time_Start": 165.0, "Time_End": 167.0, "Text": " So I access the login page."}, {"Time_Start": 167.0, "Time_End": 169.0, "Text": " I type the username."}, {"Time_Start": 169.0, "Time_End": 170.0, "Text": " I type my password."}, {"Time_Start": 170.0, "Time_End": 172.0, "Text": " I will login."}, {"Time_Start": 172.0, "Time_End": 174.0, "Text": " I will login."}, {"Time_Start": 174.0, "Time_End": 181.0, "Text": " So very standard the home page of the Inotes web access."}, {"Time_Start": 181.0, "Time_End": 184.0, "Text": " I will click on the mail menu."}, {"Time_Start": 184.0, "Time_End": 187.0, "Text": " I will choose inbox."}, {"Time_Start": 187.0, "Time_End": 190.0, "Text": " And once again, this is very standard."}, {"Time_Start": 190.0, "Time_End": 194.0, "Text": " I have the list view with all my email in my box."}, {"Time_Start": 194.0, "Time_End": 197.0, "Text": " I will right click on one of this email."}, {"Time_Start": 197.0, "Time_End": 200.0, "Text": " And as you can see, you have a very nice pop-up menu."}, {"Time_Start": 200.0, "Time_End": 202.0, "Text": " And actually, this is a..."}, {"Time_Start": 202.0, "Time_End": 203.0, "Text": " It's too fast."}, {"Time_Start": 203.0, "Time_End": 206.0, "Text": " I will just go back a little."}, {"Time_Start": 206.0, "Time_End": 210.0, "Text": " So you have a nice Dhtml pop-up menu."}, {"Time_Start": 210.0, "Time_End": 214.0, "Text": " And this Dhtml menu, you have some feature like open."}, {"Time_Start": 214.0, "Time_End": 216.0, "Text": " So you can open an email."}, {"Time_Start": 216.0, "Time_End": 218.0, "Text": " You can move an email to another folder."}, {"Time_Start": 218.0, "Time_End": 221.0, "Text": " You can remove an email from the folder."}, {"Time_Start": 221.0, "Time_End": 223.0, "Text": " So this is very standard."}, {"Time_Start": 223.0, "Time_End": 226.0, "Text": " I choose the open feature"}, {"Time_Start": 226.0, "Time_End": 229.0, "Text": " and the email is open, so everything is fine."}, {"Time_Start": 229.0, "Time_End": 232.0, "Text": " No problem at this moment."}, {"Time_Start": 232.0, "Time_End": 233.0, "Text": " So now let's try."}, {"Time_Start": 233.0, "Time_End": 235.0, "Text": " the second demo,"}, {"Time_Start": 235.0, "Time_End": 240.0, "Text": " which is the same,"}, {"Time_Start": 240.0, "Time_End": 243.0, "Text": " except that there is somebody"}, {"Time_Start": 243.0, "Time_End": 245.0, "Text": " between the client and the server"}, {"Time_Start": 245.0, "Time_End": 247.0, "Text": " which will attack the communication"}, {"Time_Start": 247.0, "Time_End": 250.0, "Text": " and modify what happens."}, {"Time_Start": 250.0, "Time_End": 253.0, "Text": " So let me show you with the graph."}, {"Time_Start": 253.0, "Time_End": 255.0, "Text": " So you have the client"}, {"Time_Start": 255.0, "Time_End": 258.0, "Text": " which sends a request to the corporate server."}, {"Time_Start": 258.0, "Time_End": 261.0, "Text": " The corporate server sent back the"}, {"Time_Start": 261.0, "Time_End": 262.0, "Text": " response."}, {"Time_Start": 262.0, "Time_End": 263.0, "Text": " And you will modify"}, {"Time_Start": 263.0, "Time_End": 266.0, "Text": " the response and actually I will switch"}, {"Time_Start": 266.0, "Time_End": 269.0, "Text": " the open and the remove feature."}, {"Time_Start": 269.0, "Time_End": 271.0, "Text": " So the open and remove features that you have"}, {"Time_Start": 271.0, "Time_End": 274.0, "Text": " saw in the pop-up menu will be switched."}, {"Time_Start": 274.0, "Time_End": 275.0, "Text": " So what will happen?"}, {"Time_Start": 275.0, "Time_End": 278.0, "Text": " When the user will try to open his email,"}, {"Time_Start": 278.0, "Time_End": 281.0, "Text": " it will send the request I want to remove the email."}, {"Time_Start": 281.0, "Time_End": 285.0, "Text": " So definitely the email will be deleted on the server."}, {"Time_Start": 285.0, "Time_End": 287.0, "Text": " And then the corporate server will send back"}, {"Time_Start": 287.0, "Time_End": 291.0, "Text": " the release view, obviously, without the email."}, {"Time_Start": 291.0, "Time_End": 292.0, "Text": " So let me show you"}, {"Time_Start": 292.0, "Time_End": 298.0, "Text": " how it works. Very easy. I launch once again the demo."}, {"Time_Start": 298.0, "Time_End": 302.0, "Text": " So same stuff. I launch Internet Explorer."}, {"Time_Start": 302.0, "Time_End": 305.0, "Text": " I tap the URL."}, {"Time_Start": 305.0, "Time_End": 310.0, "Text": " The user experience is exactly the same, except that"}, {"Time_Start": 310.0, "Time_End": 314.0, "Text": " somebody is intercepting what happens between the client and the server."}, {"Time_Start": 314.0, "Time_End": 317.0, "Text": " So I tap my username on my password."}, {"Time_Start": 317.0, "Time_End": 321.0, "Text": " I login through this page."}, {"Time_Start": 321.0, "Time_End": 322.0, "Text": " Okay."}, {"Time_Start": 322.0, "Time_End": 329.0, "Text": " I reach the home page of the I notes web access. I choose the inbox from the mail menu."}, {"Time_Start": 329.0, "Time_End": 334.0, "Text": " Once again, I right click on one of the email."}, {"Time_Start": 334.0, "Time_End": 338.0, "Text": " And then take a look. I choose open."}, {"Time_Start": 338.0, "Time_End": 343.0, "Text": " But actually, it removed the email from the inbox."}, {"Time_Start": 343.0, "Time_End": 347.0, "Text": " Once again, I do it for another one."}, {"Time_Start": 347.0, "Time_End": 349.0, "Text": " I choose open."}, {"Time_Start": 349.0, "Time_End": 351.0, "Text": " Same stuff. It will delete the email."}, {"Time_Start": 351.0, "Time_End": 352.0, "Text": " the email."}, {"Time_Start": 352.0, "Time_End": 360.0, "Text": " So it's pretty funny to change those features."}, {"Time_Start": 360.0, "Time_End": 367.0, "Text": " Okay, so I have a second demo, and I think that is even better than the first one."}, {"Time_Start": 367.0, "Time_End": 370.0, "Text": " It's about the CNN webpage."}, {"Time_Start": 370.0, "Time_End": 371.0, "Text": " So let's do again."}, {"Time_Start": 371.0, "Time_End": 374.0, "Text": " I will start the demo."}, {"Time_Start": 374.0, "Time_End": 380.0, "Text": " On this time, the computer is free of the attack."}, {"Time_Start": 380.0, "Time_End": 381.0, "Text": " So I just want to do it."}, {"Time_Start": 381.0, "Time_End": 387.0, "Text": " type www.c.com in the address bar of Internet Explorer."}, {"Time_Start": 387.0, "Time_End": 393.0, "Text": " And I will reach the CNN webpage, home page."}, {"Time_Start": 393.0, "Time_End": 397.0, "Text": " I did this yesterday night."}, {"Time_Start": 397.0, "Time_End": 401.0, "Text": " So let me explain what I will do."}, {"Time_Start": 401.0, "Time_End": 405.0, "Text": " Once again, you have a request between the client and the media website,"}, {"Time_Start": 405.0, "Time_End": 407.0, "Text": " which is CNN."}, {"Time_Start": 407.0, "Time_End": 410.0, "Text": " CNN will send back the HTML page."}, {"Time_Start": 410.0, "Time_End": 416.0, "Text": " HTML page, and this HTML page will be intercepted by the man in the middle."}, {"Time_Start": 416.0, "Time_End": 419.0, "Text": " So what the man in the middle will get?"}, {"Time_Start": 419.0, "Time_End": 423.0, "Text": " This is the standard source of this HTML page."}, {"Time_Start": 423.0, "Time_End": 430.0, "Text": " And the man in the middle will search for a specific tag."}, {"Time_Start": 430.0, "Time_End": 434.0, "Text": " It's a little bit up here."}, {"Time_Start": 434.0, "Time_End": 439.0, "Text": " This tag, actually, if you take a look at the source of the HTML page of the home page of a"}, {"Time_Start": 439.0, "Time_End": 441.0, "Text": " the home page of CNN."}, {"Time_Start": 441.0, "Time_End": 446.0, "Text": " This is a tag to see that you are in the middle of the page with the main title."}, {"Time_Start": 446.0, "Time_End": 450.0, "Text": " And as you remember, it was the title about the doctor of Saddam Hussein."}, {"Time_Start": 450.0, "Time_End": 452.0, "Text": " So you can see it there."}, {"Time_Start": 452.0, "Time_End": 454.0, "Text": " So what will happen?"}, {"Time_Start": 454.0, "Time_End": 457.0, "Text": " The man in the middle will request"}, {"Time_Start": 457.0, "Time_End": 463.0, "Text": " something from a malicious server because I want to change the content of the home page."}, {"Time_Start": 463.0, "Time_End": 466.0, "Text": " So I do a request to the malicious web server."}, {"Time_Start": 466.0, "Time_End": 468.0, "Text": " Obviously, I get a response from this server."}, {"Time_Start": 468.0, "Time_End": 473.0, "Text": " from this server, and then I send back to the client"}, {"Time_Start": 473.0, "Time_End": 475.0, "Text": " the answer that has been modified."}, {"Time_Start": 475.0, "Time_End": 482.0, "Text": " So let me show you what you will get."}, {"Time_Start": 482.0, "Time_End": 487.0, "Text": " So I launch my second CNN demo."}, {"Time_Start": 487.0, "Time_End": 492.0, "Text": " So this time, the man in the middle will intercept the communication."}, {"Time_Start": 492.0, "Time_End": 495.0, "Text": " I will type the CNN."}, {"Time_Start": 498.0, "Time_End": 502.0, "Text": " URL in the address space bar."}, {"Time_Start": 502.0, "Time_End": 506.0, "Text": " And as you can see, this is a little bit different."}, {"Time_Start": 506.0, "Time_End": 509.0, "Text": " So if you have any information about DEFCON,"}, {"Time_Start": 509.0, "Time_End": 515.0, "Text": " I think that you have to report to the DEFCOM website."}, {"Time_Start": 519.0, "Time_End": 525.0, "Text": " Okay, so let me explain to you how it works and how it's possible to do this."}, {"Time_Start": 525.0, "Time_End": 527.0, "Text": " And you will see that this is very, very easy to be able to be able to do this."}, {"Time_Start": 527.0, "Time_End": 532.0, "Text": " to be able to intercept the content from a website."}, {"Time_Start": 532.0, "Time_End": 534.0, "Text": " So is it new?"}, {"Time_Start": 534.0, "Time_End": 535.0, "Text": " No."}, {"Time_Start": 535.0, "Time_End": 539.0, "Text": " Actually, I have to go back in the past."}, {"Time_Start": 539.0, "Time_End": 543.0, "Text": " And it was a war between Internet Explorer and Netscape."}, {"Time_Start": 543.0, "Time_End": 547.0, "Text": " And if you remember, there was the release of version 4"}, {"Time_Start": 547.0, "Time_End": 550.0, "Text": " in the same week of both Internet Explorer and Netscape."}, {"Time_Start": 550.0, "Time_End": 554.0, "Text": " By the way, I have some PC card"}, {"Time_Start": 554.0, "Time_End": 556.0, "Text": " and I'm supposed to give it away right now."}, {"Time_Start": 556.0, "Time_End": 560.0, "Text": " right now. So I will ask a question, and the first one"}, {"Time_Start": 560.0, "Time_End": 564.0, "Text": " who will answer the question will win the PC card."}, {"Time_Start": 564.0, "Time_End": 568.0, "Text": " In which year was released version 4 of Internet Explorer?"}, {"Time_Start": 572.0, "Time_End": 574.0, "Text": " There's seven."}, {"Time_Start": 574.0, "Time_End": 576.0, "Text": " Okay."}, {"Time_Start": 586.0, "Time_End": 595.0, "Text": " the end. There will be another question. So big competition between an Internet Explorer"}, {"Time_Start": 595.0, "Time_End": 602.0, "Text": " and Netscape in 1997, and Internet Explorer introduced a concept which is a BHO,"}, {"Time_Start": 602.0, "Time_End": 608.0, "Text": " the BHO, the Brother Helper object. And actually, it was a very good initiative for Microsoft."}, {"Time_Start": 608.0, "Time_End": 615.0, "Text": " This is a way to open the browser structure, and you can access the browser structure through a DLL."}, {"Time_Start": 615.0, "Time_End": 616.0, "Text": " through a DL."}, {"Time_Start": 616.0, "Time_End": 619.0, "Text": " So this is the purpose of the BHO."}, {"Time_Start": 619.0, "Time_End": 620.0, "Text": " And it's a great feature."}, {"Time_Start": 620.0, "Time_End": 625.0, "Text": " When you, for instance, when you download a PDF file through Internet Explorer,"}, {"Time_Start": 625.0, "Time_End": 628.0, "Text": " the PDF file is displayed with a BHAO."}, {"Time_Start": 628.0, "Time_End": 631.0, "Text": " And it's also the same with the Google Toolbar."}, {"Time_Start": 631.0, "Time_End": 634.0, "Text": " The Google toolbar is using a BHAO."}, {"Time_Start": 634.0, "Time_End": 640.0, "Text": " The problem of the BHAO is that you can change the structure of the HTML page"}, {"Time_Start": 640.0, "Time_End": 642.0, "Text": " inside Internet Explorer,"}, {"Time_Start": 642.0, "Time_End": 644.0, "Text": " but you have absolutely no security around this feature."}, {"Time_Start": 644.0, "Time_End": 646.0, "Text": " around this feature."}, {"Time_Start": 646.0, "Time_End": 650.0, "Text": " I mean Microsoft consider probably that Windows was secure enough,"}, {"Time_Start": 650.0, "Time_End": 653.0, "Text": " and then BHO is totally silent."}, {"Time_Start": 653.0, "Time_End": 657.0, "Text": " So you can fully modify the structure of the HTML page"}, {"Time_Start": 657.0, "Time_End": 660.0, "Text": " without any warning for the user."}, {"Time_Start": 660.0, "Time_End": 668.0, "Text": " And basically, this is what I did for both the INotes and the CNN web page."}, {"Time_Start": 668.0, "Time_End": 673.0, "Text": " So definitely it requires Internet Explorer 4.0 or later."}, {"Time_Start": 673.0, "Time_End": 674.0, "Text": " But,"}, {"Time_Start": 674.0, "Time_End": 681.0, "Text": " If you take a look at the Google Zaggest, we show you all the Google request on the web."}, {"Time_Start": 681.0, "Time_End": 683.0, "Text": " It's more than 90% of the market."}, {"Time_Start": 683.0, "Time_End": 687.0, "Text": " So definitely, it's not a big deal."}, {"Time_Start": 687.0, "Time_End": 691.0, "Text": " And definitely, what you have to do, you have to create a DLL."}, {"Time_Start": 691.0, "Time_End": 699.0, "Text": " You have to execute a code to be pushed, to push this DL into the Internet Explorer process."}, {"Time_Start": 699.0, "Time_End": 704.0, "Text": " The good point is that this is very generic attack that leads to a lot of"}, {"Time_Start": 704.0, "Time_End": 707.0, "Text": " of malicious scenarios as I just show you."}, {"Time_Start": 709.0, "Time_End": 712.0, "Text": " So the good point is that you do not need any hardware."}, {"Time_Start": 712.0, "Time_End": 713.0, "Text": " It's just software."}, {"Time_Start": 713.0, "Time_End": 719.0, "Text": " You have to develop this DLL and to run this DLL on the client."}, {"Time_Start": 719.0, "Time_End": 723.0, "Text": " Another good point is that you do not have to modify the server."}, {"Time_Start": 723.0, "Time_End": 728.0, "Text": " So this is what is very, very good because if I had to change the"}, {"Time_Start": 728.0, "Time_End": 731.0, "Text": " CNN server, it would be probably very, very difficult."}, {"Time_Start": 731.0, "Time_End": 733.0, "Text": " Moreover, this is a very,"}, {"Time_Start": 733.0, "Time_End": 737.0, "Text": " Moreover, this attack used a feature developed by Internet Explorer."}, {"Time_Start": 737.0, "Time_End": 739.0, "Text": " It's developed by Microsoft."}, {"Time_Start": 739.0, "Time_End": 745.0, "Text": " So, definitely, Microsoft gives you all the tools to develop such attack."}, {"Time_Start": 745.0, "Time_End": 752.0, "Text": " And last, this DL actually cannot be detected by antivirus."}, {"Time_Start": 752.0, "Time_End": 758.0, "Text": " So this is a very standard DL with no specific signature, nothing very specific."}, {"Time_Start": 758.0, "Time_End": 762.0, "Text": " So it's very easy to push this DL and it will not be detected by a very specific."}, {"Time_Start": 762.0, "Time_End": 764.0, "Text": " by antivirus."}, {"Time_Start": 764.0, "Time_End": 770.0, "Text": " Last, you can personalize this attack, and this is what I did for the CNN webpage."}, {"Time_Start": 770.0, "Time_End": 775.0, "Text": " I established another connection with the malicious server to get the new content,"}, {"Time_Start": 775.0, "Time_End": 779.0, "Text": " and I will produce the content in for the client."}, {"Time_Start": 779.0, "Time_End": 790.0, "Text": " So let me give you some technical analysis to show you how you can develop this VHO, this attack."}, {"Time_Start": 790.0, "Time_End": 791.0, "Text": " So actually, this."}, {"Time_Start": 791.0, "Time_End": 795.0, "Text": " So actually, BHO, this is a COM in process DLL."}, {"Time_Start": 795.0, "Time_End": 802.0, "Text": " And once you have registered this DLL, it will be automatically loaded by Internet Explorer."}, {"Time_Start": 802.0, "Time_End": 809.0, "Text": " So it means that the next time you start Internet Explorer, the DLL will be loaded in the process."}, {"Time_Start": 809.0, "Time_End": 818.0, "Text": " And then, at this moment, Internet Explorer will check all the DLL, and it will pass an unknown pointer to your DLL."}, {"Time_Start": 818.0, "Time_End": 821.0, "Text": " So this is the way you will be able to modify"}, {"Time_Start": 821.0, "Time_End": 824.0, "Text": " all the structure of the HTML page."}, {"Time_Start": 828.0, "Time_End": 830.0, "Text": " So how can you do that?"}, {"Time_Start": 830.0, "Time_End": 832.0, "Text": " So this is pretty obvious."}, {"Time_Start": 832.0, "Time_End": 836.0, "Text": " You have just to define a set site function."}, {"Time_Start": 836.0, "Time_End": 841.0, "Text": " And in this function, you have to call the Manage Connection"}, {"Time_Start": 841.0, "Time_End": 844.0, "Text": " where you will advise Internet Explorer"}, {"Time_Start": 844.0, "Time_End": 849.0, "Text": " that you want to get back the HTML structure."}, {"Time_Start": 849.0, "Time_End": 851.0, "Text": " So we will pass"}, {"Time_Start": 851.0, "Time_End": 858.0, "Text": " actually a flag advice to tell Internet Explorer that you are interested to get everything."}, {"Time_Start": 858.0, "Time_End": 865.0, "Text": " Once you have done this, you have to connect your BHO to the structure, to the browser."}, {"Time_Start": 865.0, "Time_End": 869.0, "Text": " So you can do this with a fine connection point function,"}, {"Time_Start": 869.0, "Time_End": 873.0, "Text": " and you will get a pointer to a com pointer,"}, {"Time_Start": 873.0, "Time_End": 876.0, "Text": " and then you have just to call the advice function,"}, {"Time_Start": 876.0, "Time_End": 880.0, "Text": " with that you can see the this parameter, and you will be able to be able to come pointer,"}, {"Time_Start": 880.0, "Time_End": 885.0, "Text": " and you will be able to get all the event of the container."}, {"Time_Start": 885.0, "Time_End": 890.0, "Text": " So any event that will be fired in Internet Explorer"}, {"Time_Start": 890.0, "Time_End": 893.0, "Text": " will be catched by your DLL."}, {"Time_Start": 893.0, "Time_End": 897.0, "Text": " So you have many events that you can intercept."}, {"Time_Start": 897.0, "Time_End": 902.0, "Text": " So the first event is DSP ID document complete."}, {"Time_Start": 902.0, "Time_End": 906.0, "Text": " So it means that when the page is downloaded and will be displayed"}, {"Time_Start": 906.0, "Time_End": 909.0, "Text": " on the Internet Explorer, this event will be fired."}, {"Time_Start": 909.0, "Time_End": 911.0, "Text": " will be fired."}, {"Time_Start": 911.0, "Time_End": 915.0, "Text": " So you will be able to get the full content of the HTML page"}, {"Time_Start": 915.0, "Time_End": 918.0, "Text": " and to modify any tag you want"}, {"Time_Start": 918.0, "Time_End": 922.0, "Text": " and then to ask Internet Explorer to render the page."}, {"Time_Start": 922.0, "Time_End": 926.0, "Text": " So this is what I use for the CNN web page."}, {"Time_Start": 926.0, "Time_End": 930.0, "Text": " I capture this event, I modified the page,"}, {"Time_Start": 930.0, "Time_End": 935.0, "Text": " and then Internet Explorer displayed the new content."}, {"Time_Start": 935.0, "Time_End": 938.0, "Text": " You have some other pretty interesting event."}, {"Time_Start": 938.0, "Time_End": 942.0, "Text": " event, like the Navigate complete event,"}, {"Time_Start": 942.0, "Time_End": 945.0, "Text": " the before navigate, and the new window."}, {"Time_Start": 945.0, "Time_End": 948.0, "Text": " The before navigate is pretty interesting because it's fired"}, {"Time_Start": 948.0, "Time_End": 952.0, "Text": " before you send a request to the server."}, {"Time_Start": 952.0, "Time_End": 956.0, "Text": " So I mean when you type a URL or when you want to click"}, {"Time_Start": 956.0, "Time_End": 960.0, "Text": " and enable link, this event will be fired."}, {"Time_Start": 960.0, "Time_End": 963.0, "Text": " So you will be able to get the full URL"}, {"Time_Start": 963.0, "Time_End": 967.0, "Text": " with all the argument that has been sent by the client"}, {"Time_Start": 967.0, "Time_End": 968.0, "Text": " before."}, {"Time_Start": 968.0, "Time_End": 970.0, "Text": " it reached the server."}, {"Time_Start": 970.0, "Time_End": 974.0, "Text": " So you can get the full URL."}, {"Time_Start": 974.0, "Time_End": 979.0, "Text": " You have more than 20 events that you can intercept."}, {"Time_Start": 979.0, "Time_End": 981.0, "Text": " And if you want to take a look,"}, {"Time_Start": 981.0, "Time_End": 986.0, "Text": " you have to go to the ex-disp.h header file,"}, {"Time_Start": 986.0, "Time_End": 990.0, "Text": " which you can find in the SDK."}, {"Time_Start": 990.0, "Time_End": 994.0, "Text": " So let me give you an example with the document complete."}, {"Time_Start": 994.0, "Time_End": 997.0, "Text": " So once you intercept this"}, {"Time_Start": 997.0, "Time_End": 1004.0, "Text": " intercept this event, you will be able to get the document structure of the HTML page."}, {"Time_Start": 1004.0, "Time_End": 1008.0, "Text": " So this is the function get document."}, {"Time_Start": 1008.0, "Time_End": 1011.0, "Text": " So this is the document."}, {"Time_Start": 1011.0, "Time_End": 1015.0, "Text": " And from this document, you will be able to get the body."}, {"Time_Start": 1015.0, "Time_End": 1020.0, "Text": " So it means that the body that you can see in the HTML page,"}, {"Time_Start": 1020.0, "Time_End": 1026.0, "Text": " so I mean from this tag basically to the end,"}, {"Time_Start": 1026.0, "Time_End": 1031.0, "Text": " will be reflected in this structure."}, {"Time_Start": 1031.0, "Time_End": 1035.0, "Text": " And then you can parse all this structure and modify any tag you want."}, {"Time_Start": 1035.0, "Time_End": 1038.0, "Text": " And once you have done this modification,"}, {"Time_Start": 1038.0, "Time_End": 1042.0, "Text": " this new page will be displayed by Internet Explorer."}, {"Time_Start": 1042.0, "Time_End": 1046.0, "Text": " The same way, if you want to get the location, I mean the URL,"}, {"Time_Start": 1046.0, "Time_End": 1050.0, "Text": " you can do it through the get location URL function."}, {"Time_Start": 1054.0, "Time_End": 1055.0, "Text": " So what you have to do it."}, {"Time_Start": 1055.0, "Time_End": 1056.0, "Text": " So what you have to do."}, {"Time_Start": 1056.0, "Time_End": 1058.0, "Text": " do to install your component."}, {"Time_Start": 1058.0, "Time_End": 1059.0, "Text": " Actually, this is very easy."}, {"Time_Start": 1059.0, "Time_End": 1062.0, "Text": " You have just to register the DLL"}, {"Time_Start": 1062.0, "Time_End": 1065.0, "Text": " and you have to create a key in HK local machine,"}, {"Time_Start": 1065.0, "Time_End": 1068.0, "Text": " software, Microsoft, Windows,"}, {"Time_Start": 1068.0, "Time_End": 1071.0, "Text": " current version, Explorer, browser helper object"}, {"Time_Start": 1071.0, "Time_End": 1074.0, "Text": " with the GUID of your DLL."}, {"Time_Start": 1074.0, "Time_End": 1075.0, "Text": " And that's all."}, {"Time_Start": 1075.0, "Time_End": 1079.0, "Text": " Once you have done this, the next time Internet Explorer will be launched,"}, {"Time_Start": 1079.0, "Time_End": 1082.0, "Text": " it will automatically load your BHO."}, {"Time_Start": 1086.0, "Time_End": 1089.0, "Text": " So, how to defend?"}, {"Time_Start": 1089.0, "Time_End": 1093.0, "Text": " First, do not use Internet Explorer."}, {"Time_Start": 1093.0, "Time_End": 1106.0, "Text": " If you want to still use Internet Explorer, you have many, many options."}, {"Time_Start": 1106.0, "Time_End": 1111.0, "Text": " The first one is to disable all or some of the BHAs."}, {"Time_Start": 1111.0, "Time_End": 1114.0, "Text": " So you can do it very simply."}, {"Time_Start": 1114.0, "Time_End": 1115.0, "Text": " Just go through the registry."}, {"Time_Start": 1115.0, "Time_End": 1118.0, "Text": " original tree to the keys that have just"}, {"Time_Start": 1118.0, "Time_End": 1121.0, "Text": " show you before, this key,"}, {"Time_Start": 1121.0, "Time_End": 1125.0, "Text": " and just remove all the keys,"}, {"Time_Start": 1125.0, "Time_End": 1129.0, "Text": " and then all the BHA will not be loaded the next time."}, {"Time_Start": 1129.0, "Time_End": 1131.0, "Text": " The problem is that it's pretty painful"}, {"Time_Start": 1131.0, "Time_End": 1134.0, "Text": " because sometimes the BHA are pretty useful,"}, {"Time_Start": 1134.0, "Time_End": 1137.0, "Text": " and this is the case for the Acrobat plugin"}, {"Time_Start": 1137.0, "Time_End": 1140.0, "Text": " or for the Google 2Barr."}, {"Time_Start": 1140.0, "Time_End": 1144.0, "Text": " Another solution will be for Microsoft"}, {"Time_Start": 1144.0, "Time_End": 1145.0, "Text": " to improve"}, {"Time_Start": 1145.0, "Time_End": 1148.0, "Text": " in the coming release of Internet Explorer,"}, {"Time_Start": 1148.0, "Time_End": 1150.0, "Text": " the support of BHA."}, {"Time_Start": 1150.0, "Time_End": 1154.0, "Text": " First, I'm very, very surprised that there is no warning"}, {"Time_Start": 1154.0, "Time_End": 1157.0, "Text": " that a BHA has modified the web page."}, {"Time_Start": 1157.0, "Time_End": 1160.0, "Text": " So when I have modified the CNN web page,"}, {"Time_Start": 1160.0, "Time_End": 1163.0, "Text": " I get absolutely no warning that something has modified"}, {"Time_Start": 1163.0, "Time_End": 1165.0, "Text": " what I've downloaded from the website."}, {"Time_Start": 1165.0, "Time_End": 1168.0, "Text": " And I hope that in the next release,"}, {"Time_Start": 1168.0, "Time_End": 1170.0, "Text": " they can hide a kind of warning"}, {"Time_Start": 1170.0, "Time_End": 1172.0, "Text": " to let the users that something happen"}, {"Time_Start": 1172.0, "Time_End": 1174.98, "Text": " on the inside the Internet"}, {"Time_Start": 1175.0, "Time_End": 1179.0, "Text": " explorer. Otherwise, they can also create a tag"}, {"Time_Start": 1179.0, "Time_End": 1181.0, "Text": " something like disabled BHA."}, {"Time_Start": 1181.0, "Time_End": 1186.0, "Text": " So for a given web page, you are sure to disable"}, {"Time_Start": 1186.0, "Time_End": 1189.0, "Text": " all the BHA of the page."}, {"Time_Start": 1193.0, "Time_End": 1198.0, "Text": " Okay, so before the conclusion,"}, {"Time_Start": 1198.0, "Time_End": 1203.0, "Text": " I will give the second PC card."}, {"Time_Start": 1203.0, "Time_End": 1205.0, "Text": " So to your mind,"}, {"Time_Start": 1205.0, "Time_End": 1210.0, "Text": " which privilege is required to install a BHO?"}, {"Time_Start": 1210.0, "Time_End": 1215.0, "Text": " Power user, power user."}, {"Time_Start": 1219.0, "Time_End": 1227.0, "Text": " So definitely, what I just wanted to show you is that"}, {"Time_Start": 1227.0, "Time_End": 1232.0, "Text": " using a very standard feature of Microsoft Internet Explorer,"}, {"Time_Start": 1232.0, "Time_End": 1234.0, "Text": " it was possible to develop an attack"}, {"Time_Start": 1234.0, "Time_End": 1237.0, "Text": " an attack, and this is a very flexible attack."}, {"Time_Start": 1237.0, "Time_End": 1240.0, "Text": " It's fully selective and fully personalizable."}, {"Time_Start": 1240.0, "Time_End": 1244.0, "Text": " So definitely, you should not trust what you see."}, {"Time_Start": 1244.0, "Time_End": 1248.0, "Text": " Another point is that you have, if you take a look at Google,"}, {"Time_Start": 1248.0, "Time_End": 1250.0, "Text": " you have a lot of BHA watcher,"}, {"Time_Start": 1250.0, "Time_End": 1252.0, "Text": " and this is small, executable,"}, {"Time_Start": 1252.0, "Time_End": 1256.0, "Text": " to be able to list all the BHOs that are installed on your computer."}, {"Time_Start": 1256.0, "Time_End": 1260.0, "Text": " So definitely, I recommend that you are using such tool"}, {"Time_Start": 1260.0, "Time_End": 1263.0, "Text": " to know all the BHAs that are installed on your PC."}, {"Time_Start": 1263.0, "Time_End": 1270.0, "Text": " your PC and I'm pretty sure that you will be amazed by what you will discover."}, {"Time_Start": 1270.0, "Time_End": 1278.0, "Text": " So this presentation on the code can be downloaded from the DevCon website."}, {"Time_Start": 1278.0, "Time_End": 1284.0, "Text": " You have a clear BHO and you can do whatever, what you want to do with it."}, {"Time_Start": 1284.0, "Time_End": 1290.0, "Text": " And definitely, if you have any question, you can contact me by email."}, {"Time_Start": 1290.0, "Time_End": 1292.0, "Text": " So definitely, have fun with B."}, {"Time_Start": 1292.0, "Time_End": 1294.0, "Text": " Thank you."}]}