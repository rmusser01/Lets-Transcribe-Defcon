{"segments": [{"Time_Start": 0.0, "Time_End": 19.16, "Text": " All right, thank you for coming to this presentation, Embedded reverse engineering cracking mobile binaries."}, {"Time_Start": 19.16, "Time_End": 27.36, "Text": " In short, I'll be showing you how to crack a mobile binary or an EXC on the pocket PC platform."}, {"Time_Start": 30.0, "Time_End": 35.6, "Text": " For the Microsoft side of things, the information I am presenting is also geared toward the arm"}, {"Time_Start": 35.6, "Time_End": 39.08, "Text": " processor, which is multi-platform and multi-device."}, {"Time_Start": 39.08, "Time_End": 42.22, "Text": " So you can use some of this knowledge with other things too."}, {"Time_Start": 42.22, "Time_End": 47.760000000000005, "Text": " Before I actually get started, I have some swag to give away."}, {"Time_Start": 47.760000000000005, "Time_End": 49.44, "Text": " And this is kind of a self-promotional thing too."}, {"Time_Start": 49.44, "Time_End": 50.64, "Text": " I co-authored this."}, {"Time_Start": 50.64, "Time_End": 52.68, "Text": " If you don't win, you can buy it."}, {"Time_Start": 52.68, "Time_End": 54.68, "Text": " It's available."}, {"Time_Start": 54.68, "Time_End": 59.68, "Text": " As I look around, this isn't as black of a crowd with the shirts as I expected."}, {"Time_Start": 59.68, "Time_End": 63.68, "Text": " I've heard this referred to as an oil pit by some people with the number of black shirts in here."}, {"Time_Start": 63.68, "Time_End": 69.68, "Text": " Anyway, I want to give this first book to the person wearing the brightest, most obnoxious shirt, and I think I can spot him from here."}, {"Time_Start": 69.68, "Time_End": 71.68, "Text": " The tie-dye man right here."}, {"Time_Start": 71.68, "Time_End": 73.68, "Text": " So I'll give you the first one."}, {"Time_Start": 77.68, "Time_End": 80.68, "Text": " A second one, picking on another stereotype."}, {"Time_Start": 80.68, "Time_End": 83.68, "Text": " Most of us are probably 35 or under."}, {"Time_Start": 83.68, "Time_End": 86.68, "Text": " So I want to give this to the oldest person in the crowd."}, {"Time_Start": 86.68, "Time_End": 88.68, "Text": " So is there anybody 65 or older?"}, {"Time_Start": 88.68, "Time_End": 90.68, "Text": " Yeah."}, {"Time_Start": 90.68, "Time_End": 95.68, "Text": " Is anybody going to mitt to 55 roller?"}, {"Time_Start": 95.68, "Time_End": 98.68, "Text": " Come on up. Come on up."}, {"Time_Start": 98.68, "Time_End": 101.68, "Text": " Very good."}, {"Time_Start": 101.68, "Time_End": 104.68, "Text": " I want to be coming to DefCon at your age."}, {"Time_Start": 104.68, "Time_End": 106.68, "Text": " Thank you."}, {"Time_Start": 106.68, "Time_End": 111.68, "Text": " Now, the third one is kind of funny, because I received two of these in the mail a couple weeks ago."}, {"Time_Start": 111.68, "Time_End": 113.68, "Text": " I don't know why they sent me two."}, {"Time_Start": 113.68, "Time_End": 114.68, "Text": " This is in traditional Chinese."}, {"Time_Start": 114.68, "Time_End": 116.68, "Text": " I can't read one of them."}, {"Time_Start": 116.68, "Time_End": 117.68, "Text": " So why they sent me two is beyond me."}, {"Time_Start": 117.68, "Time_End": 118.68, "Text": " too is beyond me."}, {"Time_Start": 118.68, "Time_End": 120.68, "Text": " Does anybody know traditional Chinese?"}, {"Time_Start": 120.68, "Time_End": 121.68, "Text": " Come on up."}, {"Time_Start": 121.68, "Time_End": 122.68, "Text": " It's yours."}, {"Time_Start": 122.68, "Time_End": 135.68, "Text": " And if you haven't seen one of these yet, you probably haven't been in a talk."}, {"Time_Start": 135.68, "Time_End": 137.68, "Text": " Let's see."}, {"Time_Start": 137.68, "Time_End": 139.68, "Text": " I'll just give it to the first person who can make it."}, {"Time_Start": 139.68, "Time_End": 141.68, "Text": " Okay, come on up."}, {"Time_Start": 141.68, "Time_End": 142.68, "Text": " He's come behind you, man."}, {"Time_Start": 142.68, "Time_End": 143.68, "Text": " He beat you."}, {"Time_Start": 143.68, "Time_End": 144.68, "Text": " There you go."}, {"Time_Start": 144.68, "Time_End": 145.68, "Text": " All right."}, {"Time_Start": 145.68, "Time_End": 146.68, "Text": " Now to get scared."}, {"Time_Start": 146.68, "Time_End": 148.68, "Text": " get started on this."}, {"Time_Start": 148.68, "Time_End": 149.68, "Text": " Who am I?"}, {"Time_Start": 149.68, "Time_End": 150.68, "Text": " What am I?"}, {"Time_Start": 150.68, "Time_End": 151.68, "Text": " What am I doing here?"}, {"Time_Start": 151.68, "Time_End": 153.68, "Text": " How many people got their way paid?"}, {"Time_Start": 153.68, "Time_End": 157.68, "Text": " Yeah, I had to basically come up here and speak to get my way paid."}, {"Time_Start": 157.68, "Time_End": 161.68, "Text": " So for the rest of you, this is one way to get a free ticket to DefCon."}, {"Time_Start": 161.68, "Time_End": 163.68, "Text": " If you can find a company to sponsor you."}, {"Time_Start": 163.68, "Time_End": 165.68, "Text": " An air scanner is a company that sponsored me."}, {"Time_Start": 165.68, "Time_End": 167.68, "Text": " They do mobile security software."}, {"Time_Start": 167.68, "Time_End": 171.68, "Text": " And if you forget, there are little logos in the upper left-hand corner of every slide."}, {"Time_Start": 171.68, "Time_End": 173.68, "Text": " So I don't think you'll forget very easily."}, {"Time_Start": 173.68, "Time_End": 175.68, "Text": " Anyway, I have always been attracted to reverse."}, {"Time_Start": 175.68, "Time_End": 182.68, "Text": " attracted to reverse engineering since I was a kid at the toaster and remote control cars and whatever else."}, {"Time_Start": 182.68, "Time_End": 184.68, "Text": " I'm sure many of you can share that."}, {"Time_Start": 184.68, "Time_End": 186.68, "Text": " It's that same kind of feeling."}, {"Time_Start": 186.68, "Time_End": 188.68, "Text": " To me, it's a tool, not a weapon."}, {"Time_Start": 188.68, "Time_End": 191.68, "Text": " And with computers, it's all about knowing your computer."}, {"Time_Start": 191.68, "Time_End": 195.68, "Text": " So this is why I targeted this particular subject."}, {"Time_Start": 195.68, "Time_End": 198.68, "Text": " There is a darker side to reverse engineering."}, {"Time_Start": 198.68, "Time_End": 201.68, "Text": " Most of us are familiar with cracking software."}, {"Time_Start": 201.68, "Time_End": 205.68, "Text": " Pay your programmers, especially in the U.S.,"}, {"Time_Start": 205.68, "Time_End": 209.68, "Text": " programmers are already seeing a lot of their jobs outsource, so they're losing money."}, {"Time_Start": 209.68, "Time_End": 211.68, "Text": " And that's about all I'll say."}, {"Time_Start": 211.68, "Time_End": 213.68, "Text": " Have to cover the legal issues."}, {"Time_Start": 213.68, "Time_End": 215.68, "Text": " This is reverse engineering."}, {"Time_Start": 215.68, "Time_End": 218.68, "Text": " And in some contents, it's illegal."}, {"Time_Start": 218.68, "Time_End": 220.68, "Text": " I'll just read this verbatim."}, {"Time_Start": 220.68, "Time_End": 223.68, "Text": " No person shall circumvent a technological measure"}, {"Time_Start": 223.68, "Time_End": 227.68, "Text": " that effectively controls access to a work protected under this title."}, {"Time_Start": 227.68, "Time_End": 229.68, "Text": " And this title is the law that just pertains to."}, {"Time_Start": 229.68, "Time_End": 231.68, "Text": " That basically means you can't"}, {"Time_Start": 231.68, "Time_End": 234.68, "Text": " de-scramble a scrambled work, decrypt and encrypted work,"}, {"Time_Start": 234.68, "Time_End": 235.68, "Text": " or otherwise."}, {"Time_Start": 235.68, "Time_End": 238.68, "Text": " attempt to avoid, bypass, remove, deactivate, or impair"}, {"Time_Start": 238.68, "Time_End": 241.68, "Text": " a technological measure without the authority of the copyright owner."}, {"Time_Start": 241.68, "Time_End": 245.68, "Text": " I don't want anybody here getting arrested, so I made my own little serial program"}, {"Time_Start": 245.68, "Time_End": 246.68, "Text": " validator."}, {"Time_Start": 246.68, "Time_End": 247.68, "Text": " It's on the disk."}, {"Time_Start": 247.68, "Time_End": 248.68, "Text": " At least it should be."}, {"Time_Start": 248.68, "Time_End": 249.68, "Text": " You can reverse that."}, {"Time_Start": 249.68, "Time_End": 252.68, "Text": " I give you my authority and I give you the permission to do so."}, {"Time_Start": 252.68, "Time_End": 253.68, "Text": " So that's out of the way."}, {"Time_Start": 253.68, "Time_End": 255.68, "Text": " If your tablet"}, {"Time_Start": 255.68, "Time_End": 257.68, "Text": " plastic, it's not effective."}, {"Time_Start": 257.68, "Time_End": 258.68, "Text": " What?"}, {"Time_Start": 258.68, "Time_End": 263.68, "Text": " If you're not effective, it's not effective?"}, {"Time_Start": 263.68, "Time_End": 264.68, "Text": " Not effective?"}, {"Time_Start": 264.68, "Time_End": 265.68, "Text": " Right."}, {"Time_Start": 265.68, "Time_End": 270.68, "Text": " Okay."}, {"Time_Start": 270.68, "Time_End": 274.68, "Text": " Yeah, I'll take questions again."}, {"Time_Start": 274.68, "Time_End": 276.68, "Text": " Anyway, I've got to move on this."}, {"Time_Start": 276.68, "Time_End": 277.68, "Text": " It takes 50 minutes."}, {"Time_Start": 277.68, "Time_End": 279.68, "Text": " I am going to show a serial protection."}, {"Time_Start": 279.68, "Time_End": 282.68, "Text": " I'm going to show that basically you want to program your stuff right."}, {"Time_Start": 282.68, "Time_End": 285.68, "Text": " If you program it simply and you look at the upper level languages"}, {"Time_Start": 285.68, "Time_End": 288.68, "Text": " and you think your serial protection is secure,"}, {"Time_Start": 288.68, "Time_End": 290.68, "Text": " you're probably misled because at the bottom level"}, {"Time_Start": 290.68, "Time_End": 292.68, "Text": " and you're dealing with an assembler,"}, {"Time_Start": 292.68, "Time_End": 294.68, "Text": " it's probably going to be flawed."}, {"Time_Start": 294.68, "Time_End": 295.68, "Text": " Most serial protections are."}, {"Time_Start": 295.68, "Time_End": 296.68, "Text": " flawed."}, {"Time_Start": 296.68, "Time_End": 297.68, "Text": " Okay."}, {"Time_Start": 297.68, "Time_End": 298.68, "Text": " Now, get it on to do it."}, {"Time_Start": 298.68, "Time_End": 300.68, "Text": " I'm going to skip these because I don't have time."}, {"Time_Start": 300.68, "Time_End": 301.68, "Text": " There are some memory issues."}, {"Time_Start": 301.68, "Time_End": 306.18, "Text": " If you own one of these devices and you ever let the power run out on it, you'll know that"}, {"Time_Start": 306.18, "Time_End": 310.18, "Text": " you've probably lost all your files, except for the stuff stored on the compact flash."}, {"Time_Start": 310.18, "Time_End": 311.68, "Text": " That's because it's stored in RAM."}, {"Time_Start": 311.68, "Time_End": 313.68, "Text": " We all know RAM needs power to survive."}, {"Time_Start": 313.68, "Time_End": 318.68, "Text": " The OS files are stored on the ROM, so they don't get lost."}, {"Time_Start": 318.68, "Time_End": 323.68, "Text": " There's a unique issue with the way the files are on here."}, {"Time_Start": 323.68, "Time_End": 324.68, "Text": " The OS files are executable in."}, {"Time_Start": 324.68, "Time_End": 330.68, "Text": " executable in place, so that means they don't need to be dumped the RAM to run, so it saves your RAM resources."}, {"Time_Start": 330.68, "Time_End": 335.68, "Text": " Unless they're compressed, then they have to be decompressed to the RAM, which adds a little kind of"}, {"Time_Start": 335.68, "Time_End": 338.68, "Text": " an issue when you're debugging software because you can't debug it straight from the RAM."}, {"Time_Start": 338.68, "Time_End": 344.68, "Text": " Something to keep in mind, we won't really see that here, but if you move on and run with this, keep that in mind."}, {"Time_Start": 344.68, "Time_End": 351.68, "Text": " Moving on, there are some prerequisites to being able to reverse engineer."}, {"Time_Start": 351.68, "Time_End": 353.68, "Text": " You got to understand where assembly fits in the broad scheme of things."}, {"Time_Start": 353.68, "Time_End": 357.68, "Text": " scheme of things, that it's a lower level language, it's not an upper level language,"}, {"Time_Start": 357.68, "Time_End": 362.68, "Text": " it's simply one step up from the machine code, the binary, that the actual processor reads."}, {"Time_Start": 362.68, "Time_End": 364.68, "Text": " It's a way for us humans to understand it more easily."}, {"Time_Start": 364.68, "Time_End": 368.68, "Text": " You got to understand the conversions between hex to binary, ASC, the decimal."}, {"Time_Start": 368.68, "Time_End": 373.68, "Text": " Enough said there, I hope you all know that, or at least are able to figure that out."}, {"Time_Start": 373.68, "Time_End": 378.68, "Text": " However, the ARM processor has a lot of specifics in it that you do need to understand."}, {"Time_Start": 378.68, "Time_End": 382.68, "Text": " That is, the registers and the OP codes, and how the registers work, and what the op codes are, and how they work."}, {"Time_Start": 382.68, "Time_End": 383.68, "Text": " are and how they work."}, {"Time_Start": 383.68, "Time_End": 389.68, "Text": " And we're going to be covering some of those here, not all of them, because there'd be more time than I'm allotted."}, {"Time_Start": 389.68, "Time_End": 395.68, "Text": " To start the registers, there are 37 total registers, and the registers are used by the processor,"}, {"Time_Start": 395.68, "Time_End": 398.68, "Text": " so it doesn't have to keep writing back and forth in RAM."}, {"Time_Start": 398.68, "Time_End": 400.68, "Text": " It basically speeds the process up."}, {"Time_Start": 400.68, "Time_End": 403.68, "Text": " Now, the register purpose changes depending on mode."}, {"Time_Start": 403.68, "Time_End": 404.68, "Text": " You'll read about this."}, {"Time_Start": 404.68, "Time_End": 406.68, "Text": " This is more of an upper level thing."}, {"Time_Start": 406.68, "Time_End": 410.68, "Text": " However, there are some registers that we need to definitely pay attention to."}, {"Time_Start": 410.68, "Time_End": 411.68, "Text": " Register 15."}, {"Time_Start": 411.68, "Time_End": 413.68, "Text": " 15 is the program counter."}, {"Time_Start": 413.68, "Time_End": 418.68, "Text": " And this is important to watch because it lets you know where in the program you are actually executing at."}, {"Time_Start": 418.68, "Time_End": 420.68, "Text": " Register 14 is the link register."}, {"Time_Start": 420.68, "Time_End": 423.68, "Text": " And that's if a program is executing through and it needs to go to subroutine."}, {"Time_Start": 423.68, "Time_End": 426.68, "Text": " It'll continue executing, but it has to know where to bounce back."}, {"Time_Start": 426.68, "Time_End": 428.68, "Text": " And that's what the link registered for."}, {"Time_Start": 428.68, "Time_End": 431.68, "Text": " It points back to where you need to continue executing it."}, {"Time_Start": 431.68, "Time_End": 433.68, "Text": " Register 13 points to the stack."}, {"Time_Start": 433.68, "Time_End": 436.68, "Text": " Now the stack, most of you are probably familiar with the idea of a stack."}, {"Time_Start": 436.68, "Time_End": 440.68, "Text": " It simply is used to hold the temporary values and the variables that are used by your program."}, {"Time_Start": 440.68, "Time_End": 445.18, "Text": " program, including register values when a subroutine is called."}, {"Time_Start": 445.18, "Time_End": 448.68, "Text": " Those values will have to be put aside so the subroutine can then use the registers,"}, {"Time_Start": 448.68, "Time_End": 450.68, "Text": " how the stack is used."}, {"Time_Start": 450.68, "Time_End": 455.68, "Text": " There are four registers, 31 through 28, which are used as status flags."}, {"Time_Start": 455.68, "Time_End": 458.68, "Text": " And these control how your program flows."}, {"Time_Start": 458.68, "Time_End": 460.68, "Text": " And we'll get into that more."}, {"Time_Start": 460.68, "Time_End": 463.68, "Text": " In particular, if you're starting out, you need to pay a lot of attention"}, {"Time_Start": 463.68, "Time_End": 466.68, "Text": " to register 31 and register 30."}, {"Time_Start": 466.68, "Time_End": 469.68, "Text": " And these are used to, the register 31 is a name."}, {"Time_Start": 469.68, "Time_End": 472.18, "Text": " Register 31 is a negative or it's the less than."}, {"Time_Start": 472.18, "Time_End": 475.68, "Text": " So these status flags can mean more than one thing."}, {"Time_Start": 475.68, "Time_End": 479.18, "Text": " And you've got to keep that in mind as you're watching the program execute."}, {"Time_Start": 479.18, "Time_End": 482.18, "Text": " What am I actually using the status flag for at this point?"}, {"Time_Start": 482.18, "Time_End": 486.18, "Text": " And you'll understand as we get into how the status flags work and we'll show this."}, {"Time_Start": 486.18, "Time_End": 488.18, "Text": " The same thing about Register 30."}, {"Time_Start": 488.18, "Time_End": 491.18, "Text": " And this is a little bit confusing if you're new at this because"}, {"Time_Start": 491.18, "Time_End": 496.68, "Text": " if a value is zero and it's checked, the zero flag will be updated to 1."}, {"Time_Start": 496.68, "Time_End": 499.18, "Text": " If the value is equal, it'll be updated to 1."}, {"Time_Start": 499.18, "Time_End": 505.68, "Text": " one. So basically just watch how the zero is working. You might kind of get confused if"}, {"Time_Start": 505.68, "Time_End": 512.1800000000001, "Text": " a zero, then it should be zero, and it's not really works that way. Here is a screenshot of"}, {"Time_Start": 512.1800000000001, "Time_End": 517.6800000000001, "Text": " the register window and the Microsoft debugger, which I will show you. I just want you to"}, {"Time_Start": 517.6800000000001, "Time_End": 521.6800000000001, "Text": " see how these, while we're talking about registers, you have register zero through register 12"}, {"Time_Start": 521.6800000000001, "Time_End": 527.48, "Text": " that are listed as they are. Now the stack pointer is register 13. Link register 14, program"}, {"Time_Start": 527.48, "Time_End": 535.4200000000001, "Text": " counter is 15. Here you can also see the negative, the status flags basically"}, {"Time_Start": 535.4200000000001, "Time_End": 542.4, "Text": " right listed here. Jumping onto the op codes now, I'm going to touch on eight of them or something"}, {"Time_Start": 542.4, "Time_End": 547.5600000000001, "Text": " like that that we'll be using. The first one is the move op code. It simply moves a value from"}, {"Time_Start": 547.5600000000001, "Time_End": 552.6, "Text": " a register into another register or from a hard coded value in the program into a register."}, {"Time_Start": 552.6, "Time_End": 557.46, "Text": " And if you note over here on the right where the hex is, I include"}, {"Time_Start": 557.48, "Time_End": 562.64, "Text": " that so you can kind of get a feeling for, you have to pay a lot of attention to detail"}, {"Time_Start": 562.64, "Time_End": 566.8000000000001, "Text": " when you're working with this. If you wanted to change of value, you have to make sure"}, {"Time_Start": 566.8000000000001, "Time_End": 573.88, "Text": " that you pay attention to all the characters in your hex. The compare op code, this again,"}, {"Time_Start": 573.88, "Time_End": 578.6, "Text": " it'll just compare a value in a register to itself, to another register, or a hard code of value"}, {"Time_Start": 578.6, "Time_End": 583.72, "Text": " to a register. And again, I included the hex just so you can see that there's just a slight variation"}, {"Time_Start": 583.72, "Time_End": 587.46, "Text": " between the two, but it makes a big difference. If you forget that, your program,"}, {"Time_Start": 587.48, "Time_End": 591.54, "Text": " and you try and change something in your program, you probably get confused."}, {"Time_Start": 591.66, "Time_End": 594.3000000000001, "Text": " You'll forget what you changed, and then you might as just start over."}, {"Time_Start": 597.02, "Time_End": 599.54, "Text": " All right, status flags, talked a little bit about this."}, {"Time_Start": 599.94, "Time_End": 601.7, "Text": " Here you can see how the status flags work."}, {"Time_Start": 602.24, "Time_End": 607.0600000000001, "Text": " I have the compare app code comparing R1 to R0."}, {"Time_Start": 607.28, "Time_End": 612.34, "Text": " Now the negative, the end of status flag is updated according to which value is greater."}, {"Time_Start": 613.8000000000001, "Time_End": 617.46, "Text": " Obviously, if R0 is greater than R1, then the status cycle remains zero."}, {"Time_Start": 617.48, "Time_End": 622.24, "Text": " If it's, if R1 is greater than R0, the status flag will be updated to 1."}, {"Time_Start": 622.9200000000001, "Time_End": 627.52, "Text": " The Z status flag, with the compare op code, basically looks and see if the values are the same."}, {"Time_Start": 628.02, "Time_End": 631.54, "Text": " The result determines whether or not the Z is set to 1 or the Z is set to 0."}, {"Time_Start": 631.78, "Time_End": 634.08, "Text": " And the carry kind of works opposite of the negative."}, {"Time_Start": 634.6800000000001, "Time_End": 639.36, "Text": " Now, if you note down here at the moves, that S, if you're familiar with X80-Bugging,"}, {"Time_Start": 639.7, "Time_End": 641.04, "Text": " that does not mean move string."}, {"Time_Start": 641.26, "Time_End": 644.36, "Text": " That means perform the move and then update the status flag."}, {"Time_Start": 645.0, "Time_End": 647.36, "Text": " And here, the same thing with the ANS op code."}, {"Time_Start": 647.48, "Time_End": 653.86, "Text": " Basically, when flags are updated, they're updated based on the result and value."}, {"Time_Start": 654.6, "Time_End": 659.48, "Text": " Now, in the case of the move, both values are going to be the same, so it doesn't only make a difference which value you use."}, {"Time_Start": 659.8000000000001, "Time_End": 667.0, "Text": " And the ANS op code, if you use R1, well, if you and R1 and FF together, then R0 is where the resultant value is written to."}, {"Time_Start": 667.94, "Time_End": 671.96, "Text": " Your status flags are updated based on that value in R0."}, {"Time_Start": 672.62, "Time_End": 674.08, "Text": " Here you can see how it works."}, {"Time_Start": 674.08, "Time_End": 676.88, "Text": " The C status flag isn't really updated with these two."}, {"Time_Start": 677.48, "Time_End": 685.04, "Text": " Here are a list. This is a good reference. You need to be familiar with at least recognizing what they are and how they control the program flow."}, {"Time_Start": 686.24, "Time_End": 687.9200000000001, "Text": " Here's a list of all the status flags."}, {"Time_Start": 688.24, "Time_End": 692.58, "Text": " Primarily, we'll be looking at the equal, not equal, and greater than, and less than."}, {"Time_Start": 692.74, "Time_End": 694.98, "Text": " Pretty straightforward. Most people understand basic math."}, {"Time_Start": 696.12, "Time_End": 702.04, "Text": " Moving on. Now, the status flags are used by the op codes to determine program flow."}, {"Time_Start": 702.52, "Time_End": 706.4200000000001, "Text": " Now, here I have the branch op code, which runs down through a program."}, {"Time_Start": 706.42, "Time_End": 710.5999999999999, "Text": " if the branch op code is in there, it'll bounce it out to another address."}, {"Time_Start": 711.02, "Time_End": 713.7199999999999, "Text": " The branch of the link is used for subroutines."}, {"Time_Start": 714.02, "Time_End": 719.16, "Text": " If you bounce it, run that program, you have a subroutine, it bounces out, and then it bounces back."}, {"Time_Start": 719.4599999999999, "Time_End": 725.5999999999999, "Text": " Now the branch will only be executed in the case of the branch equal if the Z status flag is updated to 1."}, {"Time_Start": 726.86, "Time_End": 729.4799999999999, "Text": " And the not equal if the Z status flag is updated to 0."}, {"Time_Start": 729.4799999999999, "Time_End": 734.18, "Text": " So you can see, here again, I listed a part of the hex that you can see that changes."}, {"Time_Start": 736.42, "Time_End": 739.3199999999999, "Text": " The load register and store register."}, {"Time_Start": 739.8199999999999, "Time_End": 753.04, "Text": " These two are used to write values either to the memory from a register or pull memory into a register and, well, the load loads of value from the memory into the register and the store stores it into memory."}, {"Time_Start": 753.9599999999999, "Time_End": 757.56, "Text": " Here you can see variations in how it's used."}, {"Time_Start": 757.8199999999999, "Time_End": 762.3199999999999, "Text": " There are numerous ways that they can be combined and values can be added, registers can be added."}, {"Time_Start": 762.42, "Time_End": 764.8399999999999, "Text": " It can be stored back to itself or not stored back to itself."}, {"Time_Start": 764.84, "Time_End": 770.2, "Text": " This is kind of like a second level if you want to continue and looking at reverse engineering."}, {"Time_Start": 771.46, "Time_End": 780.08, "Text": " However, at the bottom here, the load multiple and the store multiple, they are used when you, particularly when there's a subroutine called."}, {"Time_Start": 780.24, "Time_End": 782.26, "Text": " They said the program executes down through."}, {"Time_Start": 783.0400000000001, "Time_End": 784.62, "Text": " The subroutine is called out."}, {"Time_Start": 784.7800000000001, "Time_End": 790.72, "Text": " The values in the main program that are being used have to be stored on the stack, and that's what this is used for."}, {"Time_Start": 791.0400000000001, "Time_End": 794.82, "Text": " You'll see this a lot, and it's important to recognize because that means there's probably a subroutine."}, {"Time_Start": 794.84, "Time_End": 795.64, "Text": " routine being called."}, {"Time_Start": 796.36, "Time_End": 800.5, "Text": " And the load will then load the values back off the stack into your registers again."}, {"Time_Start": 802.88, "Time_End": 806.3000000000001, "Text": " And I'll talk about logical shift right, logical shift left."}, {"Time_Start": 806.5400000000001, "Time_End": 808.38, "Text": " These are just used to move."}, {"Time_Start": 808.6800000000001, "Time_End": 815.74, "Text": " Basically, it moves the binary value of, or the binary representation padded left or right with zeros."}, {"Time_Start": 816.7800000000001, "Time_End": 822.7, "Text": " They can be, you can also have arithmetic, which will keep your sign bit, which keeps your sign bit,"}, {"Time_Start": 822.7, "Time_End": 825.86, "Text": " which keeps things flowing right."}, {"Time_Start": 825.9000000000001, "Time_End": 826.86, "Text": " This is kind of a second level."}, {"Time_Start": 826.94, "Time_End": 832.08, "Text": " We won't use it here, but it's important to be able to recognize what they're used for if you see them."}, {"Time_Start": 833.08, "Time_End": 836.72, "Text": " Now, there are three main tools that we use for reverse engineering."}, {"Time_Start": 836.9200000000001, "Time_End": 839.1400000000001, "Text": " The hex editor, disassembler, and debugger."}, {"Time_Start": 840.1400000000001, "Time_End": 844.82, "Text": " The hex editor basically is just used to look at a file in hex, and you can then update that file"}, {"Time_Start": 844.82, "Time_End": 849.32, "Text": " with the values that you need to make it do what you want it to do."}, {"Time_Start": 849.82, "Time_End": 851.9200000000001, "Text": " I use ultra-edit 32 in this demonstration."}, {"Time_Start": 851.9200000000001, "Time_End": 856.8000000000001, "Text": " You're probably all familiar with a hex editor, and you probably have your own preference."}, {"Time_Start": 857.0400000000001, "Time_End": 859.0600000000001, "Text": " This one just works in Windows and works in the presentation."}, {"Time_Start": 860.0200000000001, "Time_End": 868.3800000000001, "Text": " This assembler, this converts your program file into its assembly code, so you can actually understand what's going on, and you can basically read it."}, {"Time_Start": 868.94, "Time_End": 870.1800000000001, "Text": " I use IDA Pro."}, {"Time_Start": 870.46, "Time_End": 876.0200000000001, "Text": " There, again, there's numerous ones, but IDA is pretty much the industry recognized, especially with people like us."}, {"Time_Start": 877.2800000000001, "Time_End": 878.2800000000001, "Text": " Then the debugger."}, {"Time_Start": 878.2800000000001, "Time_End": 881.84, "Text": " Now, the debugger, you don't really have too much choice, especially on the Windows platform."}, {"Time_Start": 881.9200000000001, "Time_End": 886.7, "Text": " However, Microsoft does provide a free debugger, which is nice of them."}, {"Time_Start": 887.2400000000001, "Time_End": 894.6, "Text": " If you use one of these devices, you probably are familiar with the ActiveSink and connecting up to your laptop or whatever with a USB connection."}, {"Time_Start": 895.1800000000001, "Time_End": 898.44, "Text": " You can debug over USB, but it's painstakingly slow."}, {"Time_Start": 898.82, "Time_End": 900.48, "Text": " You will crawl and you get frustrated."}, {"Time_Start": 900.8800000000001, "Time_End": 905.84, "Text": " I recommend that you connect it up with a regular wired network or a wireless network."}, {"Time_Start": 905.84, "Time_End": 910.5600000000001, "Text": " I wasn't going to use wireless here because, well, I don't want to get kicked off my own wireless demonstration or whatever."}, {"Time_Start": 910.5600000000001, "Time_End": 915.8000000000001, "Text": " So I have a crossover cable, plug right into my computer, full 10 megabit connection."}, {"Time_Start": 916.0600000000001, "Time_End": 916.98, "Text": " It works beautifully."}, {"Time_Start": 917.44, "Time_End": 919.96, "Text": " And it's practically instantaneous debugging."}, {"Time_Start": 920.5600000000001, "Time_End": 927.12, "Text": " So you will need a program called Pockethosts for this, which is basically just a host file for the Pocket PC platform."}, {"Time_Start": 929.8800000000001, "Time_End": 930.3800000000001, "Text": " Okay."}, {"Time_Start": 930.8800000000001, "Time_End": 936.0200000000001, "Text": " Now, I debated whether or not to use two laptops at this point, but I went with one so we can see the screens."}, {"Time_Start": 936.44, "Time_End": 937.6400000000001, "Text": " I'm going to jump out."}, {"Time_Start": 937.6400000000001, "Time_End": 940.46, "Text": " At this point, we're going to go into IDA."}, {"Time_Start": 940.5600000000001, "Time_End": 945.0200000000001, "Text": " and we're going to load the file in, and before you do anything, any reversing,"}, {"Time_Start": 945.08, "Time_End": 949.12, "Text": " you have to have the actual executable file on your local computer."}, {"Time_Start": 949.48, "Time_End": 953.74, "Text": " So you can't reverse it directly from here as easily."}, {"Time_Start": 953.86, "Time_End": 958.82, "Text": " IDA has a special, well, it works better as a reverser than the debugger."}, {"Time_Start": 958.9000000000001, "Time_End": 963.1600000000001, "Text": " Although you can reverse with a debugger, it's kind of difficult to follow what's going on sometimes."}, {"Time_Start": 964.84, "Time_End": 970.3800000000001, "Text": " So when we pull, when we load up IDA, we need a place to hook into the program."}, {"Time_Start": 970.5600000000001, "Time_End": 976.2600000000001, "Text": " We've got to figure out where it's going or what it's doing and basically try and find"}, {"Time_Start": 976.2600000000001, "Time_End": 979.98, "Text": " some place that we can just figure out what's going on."}, {"Time_Start": 979.98, "Time_End": 981.1800000000001, "Text": " And there are some options."}, {"Time_Start": 981.1800000000001, "Time_End": 985.6800000000001, "Text": " The more you do this, the more you learn to recognize what these functions are for and how"}, {"Time_Start": 985.6800000000001, "Time_End": 987.32, "Text": " they're used."}, {"Time_Start": 987.32, "Time_End": 992.12, "Text": " One of the primary ones that are used in serial protection is the string compare because it basically"}, {"Time_Start": 992.12, "Time_End": 996.3000000000001, "Text": " compares a serial string with another serial string."}, {"Time_Start": 996.3000000000001, "Time_End": 1000.5400000000001, "Text": " This is one of the biggest taboos that you should not do is use a string compare."}, {"Time_Start": 1000.5600000000001, "Time_End": 1002.0200000000001, "Text": " but people are still doing it."}, {"Time_Start": 1002.7800000000001, "Time_End": 1006.5000000000001, "Text": " You can also use a message box because what's the first thing that happens if you enter"}, {"Time_Start": 1006.5000000000001, "Time_End": 1007.44, "Text": " the wrong serial string?"}, {"Time_Start": 1007.7800000000001, "Time_End": 1010.22, "Text": " It's going to get a message box saying you entered a wrong serial string."}, {"Time_Start": 1010.6400000000001, "Time_End": 1013.6400000000001, "Text": " And that's just another way to hook right into the program and figure out what's going on."}, {"Time_Start": 1015.0200000000001, "Time_End": 1015.5600000000001, "Text": " Let's see."}, {"Time_Start": 1015.6600000000001, "Time_End": 1016.9200000000001, "Text": " I'm going to escape out of here."}, {"Time_Start": 1017.7600000000001, "Time_End": 1018.9000000000001, "Text": " Jump in IDA."}, {"Time_Start": 1020.6, "Time_End": 1023.4200000000001, "Text": " And here you can see the best way to do this is with the names window."}, {"Time_Start": 1023.96, "Time_End": 1029.4, "Text": " Now, I know my stream comparers right here, and IDA makes it really easy."}, {"Time_Start": 1029.4, "Time_End": 1030.54, "Text": " It points right to the address."}, {"Time_Start": 1030.56, "Time_End": 1033.96, "Text": " All I have to do is double click on it, and I'm right there."}, {"Time_Start": 1035.8, "Time_End": 1036.84, "Text": " Now, I'll close this window."}, {"Time_Start": 1037.3799999999999, "Time_End": 1038.52, "Text": " Let's see, open up this."}, {"Time_Start": 1041.6399999999999, "Time_End": 1042.76, "Text": " Go to this nest screen."}, {"Time_Start": 1042.94, "Time_End": 1044.84, "Text": " This is an illustration of what you do not do."}, {"Time_Start": 1047.06, "Time_End": 1050.82, "Text": " I give you one guess what these functions will actually point you to."}, {"Time_Start": 1051.8, "Time_End": 1054.5, "Text": " A registration check, perhaps, or maybe an invalid registration."}, {"Time_Start": 1055.8799999999999, "Time_End": 1060.54, "Text": " So if you're programming, you kind of want to, I mean, obsecurity is."}, {"Time_Start": 1060.56, "Time_End": 1064.46, "Text": " not security, but if you don't want to make it too easy, don't use something obvious like this."}, {"Time_Start": 1066.8799999999999, "Time_End": 1070.8999999999999, "Text": " Here is a screenshot of IDA, and this is where we're at in the program."}, {"Time_Start": 1071.48, "Time_End": 1073.06, "Text": " You can see the circle points."}, {"Time_Start": 1073.36, "Time_End": 1076.76, "Text": " This is where it references it to inside the program."}, {"Time_Start": 1078.0, "Time_End": 1082.1599999999999, "Text": " If there are two points of reference, like the function is used twice, it will have two listings."}, {"Time_Start": 1082.1599999999999, "Time_End": 1084.34, "Text": " If there are three or more, it will have a dot, dot, dot."}, {"Time_Start": 1084.34, "Time_End": 1086.46, "Text": " You simply click on it, and it will open up a nice window."}, {"Time_Start": 1086.6599999999999, "Time_End": 1090.2, "Text": " You can find the point you want to go to, and you double-click it again, and you're there."}, {"Time_Start": 1090.56, "Time_End": 1095.44, "Text": " You may have to hunt and peck for a while before you find the place that you actually are looking for."}, {"Time_Start": 1096.24, "Time_End": 1102.86, "Text": " For our illustration, though, we are, we only have one, so here we are."}, {"Time_Start": 1103.56, "Time_End": 1108.78, "Text": " This is the point in our program that our serial check is being performed."}, {"Time_Start": 1109.94, "Time_End": 1111.7, "Text": " I'm going to start up here at the top."}, {"Time_Start": 1111.98, "Time_End": 1112.8, "Text": " Back over here."}, {"Time_Start": 1115.2, "Time_End": 1119.12, "Text": " The point in the program, this is the code that we're looking at."}, {"Time_Start": 1119.12, "Time_End": 1120.3999999999999, "Text": " I don't know if any of you have laptop."}, {"Time_Start": 1120.56, "Time_End": 1124.22, "Text": " you're following along, but if you did, then you can see this, or if you go through the presentation later,"}, {"Time_Start": 1124.32, "Time_End": 1128.24, "Text": " you can see this is the entire, basically the serial validation check that we're looking at."}, {"Time_Start": 1130.3999999999999, "Time_End": 1131.6399999999999, "Text": " I use IDA."}, {"Time_Start": 1132.6799999999998, "Time_End": 1139.1799999999998, "Text": " One important thing to keep in mind, well, a tip for you is if you're using IDA pro less than 4.5,"}, {"Time_Start": 1139.62, "Time_End": 1144.32, "Text": " you'll have some issues trying to figure out what's going on because your function calls will be labeled"}, {"Time_Start": 1144.32, "Time_End": 1150.2, "Text": " with some really cryptic stuff like MCS or MCE 300 underscore 2445."}, {"Time_Start": 1150.56, "Time_End": 1155.08, "Text": " you kind of have to figure out what's going on and how it's being used and it can get frustrating."}, {"Time_Start": 1155.78, "Time_End": 1159.3999999999999, "Text": " Now, Datawirm, if you're familiar with him, he does a lot of work with reversing,"}, {"Time_Start": 1159.78, "Time_End": 1165.28, "Text": " and he actually came up with the IDT files that convert those cryptic into something you can understand."}, {"Time_Start": 1165.6599999999999, "Time_End": 1171.1599999999999, "Text": " And he has them available at his website, and I hereby give him a public note of gratitude"}, {"Time_Start": 1171.1599999999999, "Time_End": 1174.8, "Text": " because he helped save me a lot of time working out some of what was going on."}, {"Time_Start": 1176.8, "Time_End": 1178.26, "Text": " Jump back over to here."}, {"Time_Start": 1179.32, "Time_End": 1180.24, "Text": " Here is the program."}, {"Time_Start": 1180.56, "Time_End": 1185.74, "Text": " you can see right here, we're setting up some strings, and we're starting to load some values into the string."}, {"Time_Start": 1186.1799999999998, "Time_End": 1191.8999999999999, "Text": " Now, because this is a simple illustration, my serial number is not really hidden."}, {"Time_Start": 1192.12, "Time_End": 1192.6, "Text": " Here it is."}, {"Time_Start": 1192.6799999999998, "Time_End": 1194.3, "Text": " One, two, three, four, five, six, seven, eight."}, {"Time_Start": 1194.6, "Time_End": 1198.94, "Text": " I kind of start out giving you it, but it shows you that we're working toward a goal."}, {"Time_Start": 1199.24, "Time_End": 1206.54, "Text": " Now, this is a really sloppy code, but it still happens quite a lot where the serial number is actually included right in the program."}, {"Time_Start": 1206.6399999999999, "Time_End": 1207.58, "Text": " You can see it in a hex editor."}, {"Time_Start": 1208.82, "Time_End": 1210.3799999999999, "Text": " We have another string being loaded."}, {"Time_Start": 1210.56, "Time_End": 1212.32, "Text": " This is correct serial number."}, {"Time_Start": 1214.72, "Time_End": 1215.8799999999999, "Text": " Thanks for registering."}, {"Time_Start": 1216.6, "Time_End": 1217.5, "Text": " There it is, right in memory."}, {"Time_Start": 1217.9199999999998, "Time_End": 1218.96, "Text": " And that happens a lot."}, {"Time_Start": 1219.06, "Time_End": 1222.0, "Text": " That happens more often than it doesn't."}, {"Time_Start": 1222.78, "Time_End": 1226.52, "Text": " Incorrect serial number, please contact technical support."}, {"Time_Start": 1226.98, "Time_End": 1230.86, "Text": " And we have a final value right here being loaded into the register."}, {"Time_Start": 1231.94, "Time_End": 1232.8799999999999, "Text": " And correct the people number."}, {"Time_Start": 1233.02, "Time_End": 1233.62, "Text": " Holy cow."}, {"Time_Start": 1234.1399999999999, "Time_End": 1237.78, "Text": " It says please verify something or another."}, {"Time_Start": 1238.98, "Time_End": 1239.8999999999999, "Text": " Incorrect serial number."}, {"Time_Start": 1239.9, "Time_End": 1241.7, "Text": " please verify it was typed correctly."}, {"Time_Start": 1241.8400000000001, "Time_End": 1246.8000000000002, "Text": " So we have two incorrect messages and a correct message and are loaded into the memory and placed on the stack."}, {"Time_Start": 1247.7, "Time_End": 1252.5400000000002, "Text": " Now, at this point, many of you might update, I mean, might recognize this update data."}, {"Time_Start": 1252.66, "Time_End": 1260.68, "Text": " If you program in C++, it's the function that basically loads the value on the screen into your program for, so you can use it."}, {"Time_Start": 1261.88, "Time_End": 1267.52, "Text": " Now at this point, we're going to jump into the debugger side of it, because this is at the point where we want to see what's going on."}, {"Time_Start": 1269.0800000000002, "Time_End": 1269.88, "Text": " So I'm in."}, {"Time_Start": 1269.9, "Time_End": 1273.24, "Text": " an embedded visual C++, let me open up my file."}, {"Time_Start": 1275.22, "Time_End": 1276.92, "Text": " Here it is, serial.exe."}, {"Time_Start": 1278.1200000000001, "Time_End": 1278.92, "Text": " It's open."}, {"Time_Start": 1279.8000000000002, "Time_End": 1286.76, "Text": " Now, as we get into here, the first thing you're going to want to do is, again,"}, {"Time_Start": 1286.88, "Time_End": 1289.72, "Text": " copy the file over to your PC if you haven't already done so."}, {"Time_Start": 1289.9, "Time_End": 1291.0600000000002, "Text": " And you're going to hit F11."}, {"Time_Start": 1291.16, "Time_End": 1295.96, "Text": " And this basically just prompts the debugger to go to the first line of execution in the program."}, {"Time_Start": 1296.46, "Time_End": 1297.92, "Text": " And you're going to want to set break points."}, {"Time_Start": 1297.92, "Time_End": 1299.88, "Text": " And breakpoints are very handy because if,"}, {"Time_Start": 1299.9, "Time_End": 1304.46, "Text": " if you're in a huge program with like thousands and tens of thousands of lines of code,"}, {"Time_Start": 1304.94, "Time_End": 1308.0800000000002, "Text": " do you want to be able to stop it at a point where you know what's going on?"}, {"Time_Start": 1310.5800000000002, "Time_End": 1314.16, "Text": " Now, we already determined in IDEA that we want to stop it right here."}, {"Time_Start": 1314.2800000000002, "Time_End": 1316.24, "Text": " So I'm going to stop it at 11280."}, {"Time_Start": 1316.92, "Time_End": 1321.72, "Text": " And you can see another little tip is that you see 0-0-1-1-2-8-0."}, {"Time_Start": 1321.88, "Time_End": 1327.4, "Text": " It's because it doesn't, it's a relative address, not using a base address."}, {"Time_Start": 1328.22, "Time_End": 1329.88, "Text": " So you need to keep that in mind because,"}, {"Time_Start": 1329.9, "Time_End": 1335.38, "Text": " in your debugger, you're going to have, let me hit F-11, and it goes for a bunch of connections,"}, {"Time_Start": 1335.6200000000001, "Time_End": 1339.24, "Text": " it'll ask you for some DLs if you have a more complex program."}, {"Time_Start": 1340.74, "Time_End": 1344.3600000000001, "Text": " And it'll also take about 30 seconds longer if you're using a USB connection."}, {"Time_Start": 1346.6200000000001, "Time_End": 1352.3400000000001, "Text": " Right here, you can see, back on the addressing, we have 18, and this is just because it is the"}, {"Time_Start": 1352.3400000000001, "Time_End": 1353.0600000000002, "Text": " absolute address."}, {"Time_Start": 1353.16, "Time_End": 1354.98, "Text": " It is looking at a real address inside the program."}, {"Time_Start": 1356.5400000000002, "Time_End": 1359.88, "Text": " Now I'm going to set my, it's already pretty much set up, Alt F9."}, {"Time_Start": 1359.9, "Time_End": 1363.5800000000002, "Text": " It's already set. It's already checked. I'm ready to go. Hit okay."}, {"Time_Start": 1364.72, "Time_End": 1367.66, "Text": " Let me take a moment and talk about these screens here. These are probably two of your,"}, {"Time_Start": 1367.7800000000002, "Time_End": 1371.5, "Text": " going to be your best buddies. This one shows you the register values that are currently in use."}, {"Time_Start": 1371.88, "Time_End": 1377.24, "Text": " And this one shows you the memory address that you can then look up and see what's going on in your memory."}, {"Time_Start": 1379.64, "Time_End": 1389.3000000000002, "Text": " Back to IDEA, sorry, back to our program. Let me hit F5. The break point set. I expected to actually break."}, {"Time_Start": 1389.9, "Time_End": 1397.3200000000002, "Text": " And it did. Well, actually, no, the program is running. Now, this debugger includes a really nice tool that you can see what's going on on my Pocket PC."}, {"Time_Start": 1398.0800000000002, "Time_End": 1401.74, "Text": " So you don't get kept in the dark. Here's what my serial program looks like."}, {"Time_Start": 1402.3600000000001, "Time_End": 1403.38, "Text": " Now I'm going to enter a value."}, {"Time_Start": 1409.22, "Time_End": 1414.44, "Text": " I hit submit and again, I'll update the screen so you can follow along."}, {"Time_Start": 1415.1200000000001, "Time_End": 1419.7800000000002, "Text": " Here we go. This is the serial number I entered. If I have no clue what it is, I'm just going to enter a value and see what happens."}, {"Time_Start": 1419.9, "Time_End": 1422.8600000000001, "Text": " My break point is hit and it stops the program."}, {"Time_Start": 1423.46, "Time_End": 1429.2800000000002, "Text": " Here we are at 11288. If we look at IDA, 11288 is the update data."}, {"Time_Start": 1429.8400000000001, "Time_End": 1433.74, "Text": " So let's start at that point and watch and see what happens in the program."}, {"Time_Start": 1435.66, "Time_End": 1437.8000000000002, "Text": " And I move step by step, you hit F11."}, {"Time_Start": 1437.96, "Time_End": 1441.38, "Text": " This will just move it to the next line of code, and it's the best way to work through a program."}, {"Time_Start": 1442.0, "Time_End": 1445.94, "Text": " One thing I should also mention is you can see, I hope, that these are red."}, {"Time_Start": 1446.2800000000002, "Time_End": 1448.5800000000002, "Text": " If it's red, then the value has just been changed."}, {"Time_Start": 1448.7800000000002, "Time_End": 1449.88, "Text": " It's another important thing to keep."}, {"Time_Start": 1449.9, "Time_End": 1451.9, "Text": " keep an eye on so you can watch and see what's going on."}, {"Time_Start": 1453.14, "Time_End": 1459.02, "Text": " I'm going to hit F11 here and it's going to load a value right into R1, the register 1."}, {"Time_Start": 1459.5800000000002, "Time_End": 1465.48, "Text": " Now you can take this value, copy it out of here, drop right into your memory, hit enter, and there we go."}, {"Time_Start": 1465.7800000000002, "Time_End": 1467.3000000000002, "Text": " My serial number is in the memory."}, {"Time_Start": 1467.7800000000002, "Time_End": 1468.7800000000002, "Text": " It's part of the program."}, {"Time_Start": 1468.94, "Time_End": 1469.6200000000001, "Text": " It's being used."}, {"Time_Start": 1469.8200000000002, "Time_End": 1471.1200000000001, "Text": " And we're watching what's going on."}, {"Time_Start": 1472.38, "Time_End": 1477.64, "Text": " Now here at the next line, basically what we're having is a string compare."}, {"Time_Start": 1477.64, "Time_End": 1479.0400000000002, "Text": " It's checking the value of R0."}, {"Time_Start": 1479.9, "Time_End": 1483.22, "Text": " which, let me hit F11."}, {"Time_Start": 1485.4, "Time_End": 1488.14, "Text": " It's checking the value of R0 with the value 8."}, {"Time_Start": 1488.98, "Time_End": 1492.88, "Text": " Now, anybody give me a guess what the value in Register 0 is."}, {"Time_Start": 1493.38, "Time_End": 1494.0, "Text": " Just yell it out."}, {"Time_Start": 1496.72, "Time_End": 1498.1200000000001, "Text": " It's the length of our string."}, {"Time_Start": 1498.76, "Time_End": 1499.5400000000002, "Text": " Four characters."}, {"Time_Start": 1499.92, "Time_End": 1501.22, "Text": " You have a four character string right here."}, {"Time_Start": 1502.44, "Time_End": 1502.8200000000002, "Text": " All right?"}, {"Time_Start": 1502.92, "Time_End": 1505.0400000000002, "Text": " So we can see a little bit what's going on."}, {"Time_Start": 1505.2800000000002, "Time_End": 1507.1000000000001, "Text": " And you'll get the idea of what's going on here."}, {"Time_Start": 1507.6000000000001, "Time_End": 1508.5600000000002, "Text": " The more you work with it."}, {"Time_Start": 1509.16, "Time_End": 1509.88, "Text": " Here we have a couple."}, {"Time_Start": 1509.9, "Time_End": 1514.4, "Text": " compare op code. We talked about this. It compares the value in R0 with the hard code of value of"}, {"Time_Start": 1514.4, "Time_End": 1521.44, "Text": " number 8. Our 0 is 4. 8 is 8. If we hit F11, our flags down here should be updated accordingly,"}, {"Time_Start": 1521.88, "Time_End": 1527.3000000000002, "Text": " which is not equal. So our zero status flag is updated to the not equal status. And it's less than."}, {"Time_Start": 1527.3000000000002, "Time_End": 1529.8000000000002, "Text": " So our negative status flag will be updated to 1."}, {"Time_Start": 1530.52, "Time_End": 1534.38, "Text": " Now hit F11, and you can see that that is what actually happened. I hope."}, {"Time_Start": 1535.7800000000002, "Time_End": 1538.7800000000002, "Text": " Now we have a branch of less than and a branch of greater than."}, {"Time_Start": 1539.9, "Time_End": 1542.9, "Text": " So the condition is met with a less than."}, {"Time_Start": 1543.02, "Time_End": 1546.1000000000001, "Text": " So if I hit F11, it should bypass the rest of my serial validation."}, {"Time_Start": 1546.8200000000002, "Time_End": 1548.14, "Text": " And I'm just going to hit F5 here."}, {"Time_Start": 1549.2800000000002, "Time_End": 1551.0600000000002, "Text": " And I'm going to update the screen."}, {"Time_Start": 1551.6000000000001, "Time_End": 1555.3000000000002, "Text": " And you can see that it gave us an air message right off the back."}, {"Time_Start": 1555.74, "Time_End": 1557.5400000000002, "Text": " So it's not long enough."}, {"Time_Start": 1557.68, "Time_End": 1558.48, "Text": " Something's going on."}, {"Time_Start": 1558.72, "Time_End": 1563.5800000000002, "Text": " Let's go back into the program and start again."}, {"Time_Start": 1563.5800000000002, "Time_End": 1566.72, "Text": " Now we know we want to come down to this point to compare."}, {"Time_Start": 1567.6000000000001, "Time_End": 1569.88, "Text": " And a nice thing about a debugger is you can change the about."}, {"Time_Start": 1569.9, "Time_End": 1573.5600000000002, "Text": " using your register. So you can change the flow of the program as it is executing."}, {"Time_Start": 1573.9, "Time_End": 1576.74, "Text": " It's a very useful tool to try and figure out how a program works."}, {"Time_Start": 1577.42, "Time_End": 1580.92, "Text": " I'm going to change this value to eight. So now we have R0 equal to eight."}, {"Time_Start": 1581.3400000000001, "Time_End": 1584.26, "Text": " The value eight being compared, it's going to come out in our favor."}, {"Time_Start": 1584.8600000000001, "Time_End": 1590.1000000000001, "Text": " I hit F11. You can see the equal status flag is set, so these next two lines are going to be"}, {"Time_Start": 1590.1000000000001, "Time_End": 1595.5800000000002, "Text": " jumped right over. Now we have another load register. And this is loading a value into R0"}, {"Time_Start": 1595.5800000000002, "Time_End": 1599.18, "Text": " from the stack. I hit the F11. I hit the F11."}, {"Time_Start": 1599.9, "Time_End": 1600.6000000000001, "Text": " check my memory."}, {"Time_Start": 1602.52, "Time_End": 1604.18, "Text": " One, two, three, four, five, six, seven, eight."}, {"Time_Start": 1604.42, "Time_End": 1606.3200000000002, "Text": " So here's our value."}, {"Time_Start": 1606.48, "Time_End": 1609.46, "Text": " Even if I didn't catch it in the IDA, I can now catch it."}, {"Time_Start": 1609.8000000000002, "Time_End": 1610.6200000000001, "Text": " There's my serial number."}, {"Time_Start": 1610.7, "Time_End": 1611.24, "Text": " It's right in memory."}, {"Time_Start": 1612.3000000000002, "Time_End": 1617.5, "Text": " Now this next line, 2A4, just so you can see what's going on, is right here."}, {"Time_Start": 1617.5600000000002, "Time_End": 1618.5400000000002, "Text": " This is our string compare."}, {"Time_Start": 1618.94, "Time_End": 1619.74, "Text": " 112."}, {"Time_Start": 1622.6200000000001, "Time_End": 1623.6000000000001, "Text": " I hit F11."}, {"Time_Start": 1625.1000000000001, "Time_End": 1627.1200000000001, "Text": " And you can see that our status flags are updated."}, {"Time_Start": 1627.1200000000001, "Time_End": 1629.5800000000002, "Text": " Now, one equals fail, zero equals,"}, {"Time_Start": 1629.9, "Time_End": 1636.3000000000002, "Text": " one in this case. Here we have a value, another memory value, one, one, two, two."}, {"Time_Start": 1636.38, "Time_End": 1641.42, "Text": " So it's part of our serial number. If you work through this enough, you would see that this R1 equals"}, {"Time_Start": 1641.42, "Time_End": 1647.3600000000001, "Text": " the address of the character that failed. And then R2 equals the character that did fail,"}, {"Time_Start": 1647.5800000000002, "Time_End": 1652.18, "Text": " and R3 equals the character it should have been. This is why you don't use the string compare"}, {"Time_Start": 1652.18, "Time_End": 1656.94, "Text": " in any kind of serial check, because I could simply work through this one character at a time"}, {"Time_Start": 1656.94, "Time_End": 1659.7, "Text": " learning the serial number as I went and simply loop through it."}, {"Time_Start": 1659.9, "Time_End": 1660.9, "Text": " and I have the serial number."}, {"Time_Start": 1660.9, "Time_End": 1664.4, "Text": " Then it ends up on deluxe cereals or something like that, and not everybody has a serial number."}, {"Time_Start": 1667.9, "Time_End": 1671.9, "Text": " Moving on, we overwrite R2 with a zero."}, {"Time_Start": 1671.9, "Time_End": 1676.9, "Text": " Now we're moving R0 value, which is the 1, it's the status that was passed back from the string to pair,"}, {"Time_Start": 1676.9, "Time_End": 1677.9, "Text": " into R3."}, {"Time_Start": 1677.9, "Time_End": 1680.4, "Text": " But we're updating the status flag after we do this."}, {"Time_Start": 1680.4, "Time_End": 1682.9, "Text": " This is going to control the rest of our program's flow."}, {"Time_Start": 1682.9, "Time_End": 1684.4, "Text": " I hit F11."}, {"Time_Start": 1684.4, "Time_End": 1689.88, "Text": " You can see that the value is one, so the zero flag is set the zero,"}, {"Time_Start": 1689.9, "Time_End": 1691.52, "Text": " because it did not equal zero."}, {"Time_Start": 1691.52, "Time_End": 1693.74, "Text": " And the negative left alone."}, {"Time_Start": 1693.74, "Time_End": 1695.7800000000002, "Text": " Now, the next two lines of code here are interesting,"}, {"Time_Start": 1695.7800000000002, "Time_End": 1699.2, "Text": " because if you look at them, you can see that regardless of what happens,"}, {"Time_Start": 1699.2, "Time_End": 1703.92, "Text": " the value one or zero is going to end up in R0."}, {"Time_Start": 1703.92, "Time_End": 1707.68, "Text": " Now, we've got to work through it, figure out what is controlling the program flow,"}, {"Time_Start": 1707.68, "Time_End": 1710.64, "Text": " and why this R0 is so important."}, {"Time_Start": 1710.64, "Time_End": 1712.64, "Text": " We hit F11, hit F11 again."}, {"Time_Start": 1712.64, "Time_End": 1717.52, "Text": " You can see now that R0 is used in the and's instruction."}, {"Time_Start": 1717.52, "Time_End": 1719.88, "Text": " FFF is being anded."}, {"Time_Start": 1719.9, "Time_End": 1723.1000000000001, "Text": " with the value in R0, which in this case is zero."}, {"Time_Start": 1723.1000000000001, "Time_End": 1726.6000000000001, "Text": " So if it fails, if the string compare fails,"}, {"Time_Start": 1726.6000000000001, "Time_End": 1729.3400000000001, "Text": " the value zero will end up in R0."}, {"Time_Start": 1729.3400000000001, "Time_End": 1733.3400000000001, "Text": " And that has ended up, that value, that result ends up in R3."}, {"Time_Start": 1733.3400000000001, "Time_End": 1734.5, "Text": " R3 equals zero."}, {"Time_Start": 1734.5, "Time_End": 1736.7800000000002, "Text": " The status flags are updated because of that little S"}, {"Time_Start": 1736.7800000000002, "Time_End": 1739.48, "Text": " on the end to update the status flag."}, {"Time_Start": 1739.48, "Time_End": 1741.3000000000002, "Text": " Hit F11 again."}, {"Time_Start": 1741.3000000000002, "Time_End": 1747.1000000000001, "Text": " Now it's doing a load if the non-equal status is set."}, {"Time_Start": 1747.1000000000001, "Time_End": 1749.88, "Text": " Our status flag is set because the equal"}, {"Time_Start": 1749.9, "Time_End": 1755.5400000000002, "Text": " status flag is set, so it's going to bypass this line, and hit F11, hit F5, just for a"}, {"Time_Start": 1755.5400000000002, "Time_End": 1759.98, "Text": " convenient sake, update this screen, and now we have a different error message."}, {"Time_Start": 1759.98, "Time_End": 1764.66, "Text": " So it looks like if we enter the wrong length serial number, we get one error message."}, {"Time_Start": 1764.66, "Time_End": 1768.3400000000001, "Text": " If we enter the wrong serial number and it's the right length, we get a different error message."}, {"Time_Start": 1768.3400000000001, "Time_End": 1773.4, "Text": " It's adding a little bit of variation in the program."}, {"Time_Start": 1773.4, "Time_End": 1777.7, "Text": " Hit OK, hit submit. Now we're back into the beginning of the program again."}, {"Time_Start": 1777.7, "Time_End": 1779.88, "Text": " Now I'm going to jump immediately down to the computer."}, {"Time_Start": 1779.9, "Time_End": 1783.9, "Text": " except this time I'm going to show you something else that we can do."}, {"Time_Start": 1783.9, "Time_End": 1789.9, "Text": " I'm going to let the compare, update the status flags with the failed, basically it's going to say less than."}, {"Time_Start": 1789.9, "Time_End": 1791.9, "Text": " So I can overwrite these status flags too."}, {"Time_Start": 1791.9, "Time_End": 1794.9, "Text": " I'll write my negative status flag."}, {"Time_Start": 1794.9, "Time_End": 1796.9, "Text": " I overwrite my zero status flag."}, {"Time_Start": 1796.9, "Time_End": 1797.9, "Text": " Now I have an equal status."}, {"Time_Start": 1797.9, "Time_End": 1801.9, "Text": " So the next line of code executes is going to look at these status flags and go, oh, it's equal."}, {"Time_Start": 1801.9, "Time_End": 1802.9, "Text": " I don't need to execute."}, {"Time_Start": 1802.9, "Time_End": 1805.9, "Text": " Hit F11, hit F11, and you can see it didn't jump."}, {"Time_Start": 1805.9, "Time_End": 1808.9, "Text": " So again, I just redirected the program flow on the fly."}, {"Time_Start": 1808.9, "Time_End": 1809.9, "Text": " All right."}, {"Time_Start": 1809.9, "Time_End": 1817.9, "Text": " and then bounce down to this point. As I discussed, the value in R0 controls what's going to happen here at the ANS instruction."}, {"Time_Start": 1819.9, "Time_End": 1826.9, "Text": " So since R0, I don't want it to equal 0, I want it to equal 1, because I want FF to be an at the 1,"}, {"Time_Start": 1826.9, "Time_End": 1829.9, "Text": " and then the result in value 1 be written in the R3."}, {"Time_Start": 1829.9, "Time_End": 1832.9, "Text": " The status flags will be updated based on the 1 value."}, {"Time_Start": 1832.9, "Time_End": 1835.9, "Text": " I hit F11 and that happens."}, {"Time_Start": 1835.9, "Time_End": 1838.9, "Text": " Now the non-equal status is set."}, {"Time_Start": 1838.9, "Time_End": 1839.9, "Text": " So I know that."}, {"Time_Start": 1839.9, "Time_End": 1843.9, "Text": " that the value on the stack is going to be loaded into R1."}, {"Time_Start": 1843.9, "Time_End": 1845.9, "Text": " I hit F11 again."}, {"Time_Start": 1845.9, "Time_End": 1847.9, "Text": " Let's see what R1. Well, you know what?"}, {"Time_Start": 1847.9, "Time_End": 1849.9, "Text": " I'll just hit F5. And you can see what R1 says."}, {"Time_Start": 1849.9, "Time_End": 1854.9, "Text": " Correct serial number. Thank you for registering."}, {"Time_Start": 1854.9, "Time_End": 1857.9, "Text": " So I just manually bypass my serial check."}, {"Time_Start": 1857.9, "Time_End": 1863.9, "Text": " I could stop here if I just want to do it for myself."}, {"Time_Start": 1863.9, "Time_End": 1866.9, "Text": " But now comes the point of a cracker where they're going to write a program"}, {"Time_Start": 1866.9, "Time_End": 1869.9, "Text": " and they're just going to automate this, or they're just going to patch"}, {"Time_Start": 1869.9, "Time_End": 1873.98, "Text": " program in the first place and just distribute that as the patched serial check."}, {"Time_Start": 1873.98, "Time_End": 1875.9, "Text": " So you don't, they basically will bypass it."}, {"Time_Start": 1875.9, "Time_End": 1880.9, "Text": " So let me see where I'm at here, click, catch you up."}, {"Time_Start": 1880.9, "Time_End": 1885.9, "Text": " Here we do, this is slides talking about what we just went through."}, {"Time_Start": 1885.9, "Time_End": 1889.9, "Text": " The first crack, I'm just labeling it to sleight of hand because we're just going to trick the program"}, {"Time_Start": 1889.9, "Time_End": 1891.9, "Text": " into believing something that's not true."}, {"Time_Start": 1891.9, "Time_End": 1898.9, "Text": " And you can see that back in the compare in Ida right here, right in this line, we're comparing,"}, {"Time_Start": 1898.9, "Time_End": 1899.9, "Text": " we're comparing."}, {"Time_Start": 1899.9, "Time_End": 1906.9, "Text": " a value. Now, how can we make this permanently in our favor? Well, R0, R0, correct."}, {"Time_Start": 1906.9, "Time_End": 1912.9, "Text": " Here you go. Come up and get a CD. And I have a couple more things up here too, if you do answer."}, {"Time_Start": 1912.9, "Time_End": 1917.9, "Text": " Right, R0 R0. So you're comparing a value with itself, it's always going to be in our favor."}, {"Time_Start": 1917.9, "Time_End": 1921.9, "Text": " Now, I already highlighted this particular point of the code right here."}, {"Time_Start": 1921.9, "Time_End": 1924.9, "Text": " And no, you can't answer again. I'm only giving you one thing."}, {"Time_Start": 1924.9, "Time_End": 1929.88, "Text": " We know that the value R0, if it's a zero, if it's a zero,"}, {"Time_Start": 1929.9, "Time_End": 1934.46, "Text": " we'll end up basically controlling the program against our favor at this point."}, {"Time_Start": 1934.5600000000002, "Time_End": 1939.26, "Text": " I'm sorry, if it's a 1, it will control the program against our favor at this point."}, {"Time_Start": 1939.74, "Time_End": 1944.2, "Text": " So we want to control this value right here."}, {"Time_Start": 1944.3200000000002, "Time_End": 1947.0400000000002, "Text": " We want one to be moved into R0."}, {"Time_Start": 1947.96, "Time_End": 1953.6000000000001, "Text": " And it's moved in here, and it can be moved in here if we simply change this value to a 1."}, {"Time_Start": 1954.0600000000002, "Time_End": 1956.6000000000001, "Text": " So to do that, let's start with the compare."}, {"Time_Start": 1956.6000000000001, "Time_End": 1958.5400000000002, "Text": " We need to load up our hex editor."}, {"Time_Start": 1959.9, "Time_End": 1961.0, "Text": " Here's a serial program."}, {"Time_Start": 1961.8000000000002, "Time_End": 1962.7800000000002, "Text": " Load it up in Ultra Edit."}, {"Time_Start": 1966.3000000000002, "Time_End": 1967.2, "Text": " Page down."}, {"Time_Start": 1967.42, "Time_End": 1972.3000000000002, "Text": " Now, the point in Ida, IDA that we need to go to, 294,"}, {"Time_Start": 1972.68, "Time_End": 1975.72, "Text": " this is the address in IDA."}, {"Time_Start": 1975.96, "Time_End": 1978.7800000000002, "Text": " Now, in the file itself, it points to a different location."}, {"Time_Start": 1978.9, "Time_End": 1980.68, "Text": " This is the current position in the input file."}, {"Time_Start": 1980.76, "Time_End": 1983.7800000000002, "Text": " And this is the value we actually need to, this is the address line we need to locate."}, {"Time_Start": 1984.18, "Time_End": 1986.0800000000002, "Text": " So at 694, we need to change."}, {"Time_Start": 1986.0800000000002, "Time_End": 1989.48, "Text": " This compare from an R0, I mean from an 8 to an R0."}, {"Time_Start": 1989.48, "Time_End": 1995.42, "Text": " And also change that one last hex character on the end because now we're moving a register into a register,"}, {"Time_Start": 1995.54, "Time_End": 1996.76, "Text": " not a hard-coded into a register."}, {"Time_Start": 1997.6, "Time_End": 2000.8600000000001, "Text": " If I open up, I'll add it, and I think it was 6-9-4."}, {"Time_Start": 2003.88, "Time_End": 2007.4, "Text": " Page down, 6-9-4 is this line right here."}, {"Time_Start": 2007.64, "Time_End": 2013.04, "Text": " You can see 8, once you get familiar with how the assembly, I mean, how the hex looks, you'll,"}, {"Time_Start": 2013.6, "Time_End": 2016.1200000000001, "Text": " you can kind of even figure, you can read through a program like this."}, {"Time_Start": 2016.54, "Time_End": 2018.8600000000001, "Text": " But 8's moved into R-0, and this is to compare."}, {"Time_Start": 2018.8600000000001, "Time_End": 2025.14, "Text": " So we need to change this 8 to a 0, and we need to change the fact that it's moving a hard code"}, {"Time_Start": 2025.14, "Time_End": 2028.42, "Text": " at a value into a register from a register into register, so that's a 1."}, {"Time_Start": 2028.92, "Time_End": 2030.64, "Text": " It takes care of our first point."}, {"Time_Start": 2031.0600000000002, "Time_End": 2033.7400000000002, "Text": " Come down to this point in the program, 2B4."}, {"Time_Start": 2033.96, "Time_End": 2035.16, "Text": " We want to make this a 1."}, {"Time_Start": 2035.66, "Time_End": 2048.28, "Text": " So at 2B4 or 6B4, right at this point, this is the move not equal, make this value of 1, file, save as,"}, {"Time_Start": 2048.86, "Time_End": 2054.86, "Text": " and I say this is serial number two, on my serial number one, hit save, copy it from my local file"}, {"Time_Start": 2054.86, "Time_End": 2063.34, "Text": " directory, over to the start menu on my Pocket PC, open it up on my pocket PC, so you're"}, {"Time_Start": 2063.34, "Time_End": 2071.46, "Text": " not, you're not full of crap, hit submit, and update the screen, no serial number entered, thank"}, {"Time_Start": 2071.46, "Time_End": 2072.38, "Text": " you for registering."}, {"Time_Start": 2072.38, "Time_End": 2074.76, "Text": " So here's one way that you can crack a program."}, {"Time_Start": 2075.42, "Time_End": 2078.6800000000003, "Text": " Now, just like there are many ways to program,"}, {"Time_Start": 2078.86, "Time_End": 2082.88, "Text": " There are many weaknesses in a program that can be exploited."}, {"Time_Start": 2083.1, "Time_End": 2084.5, "Text": " And I'm going to show you a couple more."}, {"Time_Start": 2086.5, "Time_End": 2087.88, "Text": " Right here, we have to compare."}, {"Time_Start": 2088.06, "Time_End": 2088.94, "Text": " We already looked at that."}, {"Time_Start": 2089.54, "Time_End": 2090.8, "Text": " How about these two lines right here?"}, {"Time_Start": 2091.76, "Time_End": 2095.82, "Text": " Let's simply overwrite those lines so we don't have to worry about what happens to compare."}, {"Time_Start": 2096.46, "Time_End": 2099.88, "Text": " I'm going to jump back into this point."}, {"Time_Start": 2102.96, "Time_End": 2104.02, "Text": " Here you updated the hex."}, {"Time_Start": 2104.1800000000003, "Time_End": 2105.54, "Text": " This is kind of like a slide."}, {"Time_Start": 2105.6200000000003, "Time_End": 2106.6400000000003, "Text": " You're basically notpping it."}, {"Time_Start": 2106.7000000000003, "Time_End": 2108.76, "Text": " You're basically putting a non-operation in there."}, {"Time_Start": 2108.86, "Time_End": 2113.86, "Text": " However, there is no NOP instruction on the arm processor."}, {"Time_Start": 2114.1600000000003, "Time_End": 2115.56, "Text": " You have to kind of do a virtual knob."}, {"Time_Start": 2116.06, "Time_End": 2122.52, "Text": " So to do that, we simply just move a value into itself, move a register value into itself."}, {"Time_Start": 2122.6400000000003, "Time_End": 2123.4, "Text": " It won't do anything."}, {"Time_Start": 2123.6, "Time_End": 2125.32, "Text": " It won't update the status flags."}, {"Time_Start": 2125.88, "Time_End": 2126.98, "Text": " It's the perfect way to do it."}, {"Time_Start": 2127.7000000000003, "Time_End": 2131.06, "Text": " Just for curiosity, I put the 9-0 in there to see what happened,"}, {"Time_Start": 2131.1200000000003, "Time_End": 2132.6200000000003, "Text": " because that's how you do a NOP on an X-86."}, {"Time_Start": 2133.28, "Time_End": 2136.08, "Text": " And it came up with probably the opposite of a NOP."}, {"Time_Start": 2136.92, "Time_End": 2138.84, "Text": " You mall-all-all's S, blah, blah, blah."}, {"Time_Start": 2138.86, "Time_End": 2143.36, "Text": " And that basically stands for an unsigned multiple long if the LS status flag is set,"}, {"Time_Start": 2143.46, "Time_End": 2145.48, "Text": " and then it updates the status flags with the result in value."}, {"Time_Start": 2146.02, "Time_End": 2146.6400000000003, "Text": " Not a knob."}, {"Time_Start": 2149.1400000000003, "Time_End": 2150.8, "Text": " So what do we have to do?"}, {"Time_Start": 2155.06, "Time_End": 2155.78, "Text": " Here we are."}, {"Time_Start": 2155.9, "Time_End": 2164.46, "Text": " We're going to overwrite these values right here with our, basically, our virtual knob."}, {"Time_Start": 2164.92, "Time_End": 2167.52, "Text": " So I'm going to jump over to my hex editor."}, {"Time_Start": 2167.76, "Time_End": 2168.84, "Text": " I'm going to go to that point."}, {"Time_Start": 2168.86, "Time_End": 2174.2000000000003, "Text": " the program, which is 298, and that's 698."}, {"Time_Start": 2175.4, "Time_End": 2178.6600000000003, "Text": " And right here we are, these two lines right here need to be changed."}, {"Time_Start": 2179.26, "Time_End": 2184.1600000000003, "Text": " I'm going to make this a 0-1-1-0-0-0-0-A-0-0-E-1."}, {"Time_Start": 2184.6200000000003, "Time_End": 2189.58, "Text": " And that next line's the same thing, 1-0-0-A-0-0-1."}, {"Time_Start": 2190.08, "Time_End": 2192.78, "Text": " Now I still need to patch this point down here."}, {"Time_Start": 2193.48, "Time_End": 2196.86, "Text": " So I still need to go to 6B4 and change this 0 to a 1."}, {"Time_Start": 2198.86, "Time_End": 2203.86, "Text": " 6B. Ah, crud."}, {"Time_Start": 2203.86, "Time_End": 2204.36, "Text": " You know what?"}, {"Time_Start": 2204.36, "Time_End": 2205.86, "Text": " I got to start with a fresh one."}, {"Time_Start": 2213.86, "Time_End": 2215.86, "Text": " 694, here we go."}, {"Time_Start": 2215.86, "Time_End": 2220.86, "Text": " 1-110, A0, E1, E1."}, {"Time_Start": 2220.86, "Time_End": 2221.86, "Text": " 1."}, {"Time_Start": 2221.86, "Time_End": 2222.86, "Text": " 1."}, {"Time_Start": 2222.86, "Time_End": 2224.86, "Text": " 1."}, {"Time_Start": 2224.86, "Time_End": 2227.86, "Text": " Come down to 6B4 and change this value rate."}, {"Time_Start": 2227.86, "Time_End": 2236.86, "Text": " value right here at 01. File. Save as. Sale number 2. Save."}, {"Time_Start": 2236.86, "Time_End": 2240.86, "Text": " Copy it from our local over to our other side."}, {"Time_Start": 2240.86, "Time_End": 2245.86, "Text": " And somebody's car alarm is going off."}, {"Time_Start": 2249.86, "Time_End": 2253.86, "Text": " Update the screen so you can see it worked."}, {"Time_Start": 2253.86, "Time_End": 2254.86, "Text": " Here we are."}, {"Time_Start": 2254.86, "Time_End": 2255.86, "Text": " Seal number two."}, {"Time_Start": 2255.86, "Time_End": 2256.86, "Text": " Thank you for registering."}, {"Time_Start": 2256.86, "Time_End": 2257.86, "Text": " Third one."}, {"Time_Start": 2257.86, "Time_End": 2263.6600000000003, "Text": " I'm going to show you, since the rest of these have been kind of like after the fact."}, {"Time_Start": 2263.78, "Time_End": 2269.6800000000003, "Text": " So if we could actually find a correct seal number before and use it for our validation without knowing it,"}, {"Time_Start": 2269.76, "Time_End": 2270.56, "Text": " that would be really handy."}, {"Time_Start": 2270.6600000000003, "Time_End": 2273.38, "Text": " It's kind of preventative maintenance, so you don't have to patch anything else."}, {"Time_Start": 2274.1, "Time_End": 2277.6, "Text": " And you can do that because right here at the string compare,"}, {"Time_Start": 2277.8, "Time_End": 2280.1200000000003, "Text": " we know that a correct seal is loaded into R0."}, {"Time_Start": 2287.86, "Time_End": 2291.86, "Text": " Okay."}, {"Time_Start": 2291.86, "Time_End": 2292.86, "Text": " So here we are."}, {"Time_Start": 2292.86, "Time_End": 2295.86, "Text": " We know our correct serial is loaded into R0."}, {"Time_Start": 2295.86, "Time_End": 2300.86, "Text": " We know our value is loaded into R1, so why don't we just take this value,"}, {"Time_Start": 2300.86, "Time_End": 2303.86, "Text": " right out the stack, and load it right into the register 1?"}, {"Time_Start": 2303.86, "Time_End": 2307.86, "Text": " That'll save us all the trouble of trying to patch anything because we'll have the correctional"}, {"Time_Start": 2307.86, "Time_End": 2308.86, "Text": " and we'll right from the get-go."}, {"Time_Start": 2308.86, "Time_End": 2312.86, "Text": " To do that, that's at 6-8C."}, {"Time_Start": 2312.86, "Time_End": 2316.86, "Text": " Open up my blank serial again."}, {"Time_Start": 2316.86, "Time_End": 2317.86, "Text": " Jump down to 6."}, {"Time_Start": 2317.86, "Time_End": 2327.3, "Text": " 8C. Right here we are. Now we're loading the value C into our, or loading it from our"}, {"Time_Start": 2327.3, "Time_End": 2331.5, "Text": " stack pointer. Now this is register 4. I'm changing to the stack pointer, or the rank,"}, {"Time_Start": 2331.5, "Time_End": 2337.34, "Text": " yeah, the stack pointer, which is actually 13, and that's represented by hex character D."}, {"Time_Start": 2337.34, "Time_End": 2343.98, "Text": " So you have to change two characters. Hit files, save as, seal number three, save"}, {"Time_Start": 2343.98, "Time_End": 2357.98, "Text": " from local, update the screen, and there we go."}, {"Time_Start": 2357.98, "Time_End": 2361.78, "Text": " Three different ways to crack the program in, what, a whole 10 minutes."}, {"Time_Start": 2362.98, "Time_End": 2364.58, "Text": " I'm going to jump back to my slides now."}, {"Time_Start": 2366.38, "Time_End": 2367.08, "Text": " Catch us up."}, {"Time_Start": 2368.38, "Time_End": 2373.08, "Text": " Here is the actual code that I used, and I just included this so you can understand what not to do."}, {"Time_Start": 2373.52, "Time_End": 2373.96, "Text": " The string."}, {"Time_Start": 2373.98, "Time_End": 2379.22, "Text": " is simply dumped into a string character, the serial number is dumped into a variable, and"}, {"Time_Start": 2379.22, "Time_End": 2383.48, "Text": " so are the error messages. The update data is performed, like we saw, and we have our little get"}, {"Time_Start": 2383.48, "Time_End": 2387.7400000000002, "Text": " length, and it just basically compares that value to eight, and that compare instruction where"}, {"Time_Start": 2387.7400000000002, "Time_End": 2394.08, "Text": " we're comparing our 0 to 8, the incorrect message length boxes shown. If the serial is"}, {"Time_Start": 2394.08, "Time_End": 2400.94, "Text": " at least eight characters is then validated, and you have another set of boxes that are shown"}, {"Time_Start": 2400.94, "Time_End": 2401.82, "Text": " depending on what you entered."}, {"Time_Start": 2403.98, "Time_End": 2409.02, "Text": " There are, again, the tools that we need to use are the disassembler, debugger, and hex editor."}, {"Time_Start": 2409.54, "Time_End": 2411.92, "Text": " You got an understanding arm processor, any op-codes, or registers."}, {"Time_Start": 2412.46, "Time_End": 2415.94, "Text": " And to reverse it, you've got to find a point in, you've got to be able to watch the execution,"}, {"Time_Start": 2416.3, "Time_End": 2418.72, "Text": " figure out what's going on, and then patch it if you prefer."}, {"Time_Start": 2419.34, "Time_End": 2424.02, "Text": " Now, the spin on this is not always something like cracking a program."}, {"Time_Start": 2424.42, "Time_End": 2429.68, "Text": " Earlier this week, I wanted to use my terminal services client on my Dell,"}, {"Time_Start": 2429.68, "Time_End": 2432.88, "Text": " and I wanted to connect to a port other than the default 3389."}, {"Time_Start": 2432.88, "Time_End": 2439.54, "Text": " If you ever looked that up on the internet, I don't think everybody ever cared, you can't supposedly do it."}, {"Time_Start": 2439.62, "Time_End": 2440.7000000000003, "Text": " I'm like, that's bogus."}, {"Time_Start": 2440.86, "Time_End": 2442.08, "Text": " I've got to be able to do it."}, {"Time_Start": 2442.2000000000003, "Time_End": 2448.2200000000003, "Text": " So I went in, I found a point in the program where 3389 is actually hard-coded into the terminal services client."}, {"Time_Start": 2448.7000000000003, "Time_End": 2455.1600000000003, "Text": " I changed it to the port I wanted to, at which point I then discovered that the program actually writes a register key in,"}, {"Time_Start": 2455.54, "Time_End": 2462.52, "Text": " and then through that, it's just as simple as adding a register key into your pocket PC, and you can connect to any port."}, {"Time_Start": 2462.88, "Time_End": 2470.1, "Text": " It's undocumented. I haven't found any other place online that can be done, but you can use reverse engineering for things like that."}, {"Time_Start": 2470.36, "Time_End": 2471.26, "Text": " Make a program better."}, {"Time_Start": 2471.6600000000003, "Time_End": 2472.84, "Text": " Change something that you don't like."}, {"Time_Start": 2473.1400000000003, "Time_End": 2474.1400000000003, "Text": " Get rid of timers."}, {"Time_Start": 2474.26, "Time_End": 2477.6400000000003, "Text": " Get rid of various things that you may not like to see in a program."}, {"Time_Start": 2480.12, "Time_End": 2483.7200000000003, "Text": " Lots of sites, not a whole lot, but there are several sites out there."}, {"Time_Start": 2483.88, "Time_End": 2492.6800000000003, "Text": " Chaos.net is one of the, it's more of the cracking side of things, but that's usually where technology,"}, {"Time_Start": 2492.88, "Time_End": 2499.0, "Text": " is innovative and people start figuring stuff out is if they're the hackers, they get a lot of the stuff moving."}, {"Time_Start": 2499.42, "Time_End": 2503.86, "Text": " DataWorm, again, he's got a lot of information, and he did the IDT files."}, {"Time_Start": 2504.28, "Time_End": 2505.02, "Text": " He knows this stuff."}, {"Time_Start": 2506.32, "Time_End": 2508.6400000000003, "Text": " The third line here, this is a great PDF."}, {"Time_Start": 2508.92, "Time_End": 2516.1, "Text": " If you want a great intro and an understanding of how the op codes work, read this PDF because it has a lot of valid information in it."}, {"Time_Start": 2516.82, "Time_End": 2519.6, "Text": " The rest of these are at various importance."}, {"Time_Start": 2519.98, "Time_End": 2522.6800000000003, "Text": " The armref.f. PDF, that's a great reference sheet."}, {"Time_Start": 2522.88, "Time_End": 2526.88, "Text": " That gives you a list of the op codes and some of their hex comparisons and so on."}, {"Time_Start": 2527.38, "Time_End": 2530.5, "Text": " And, of course, Arm has a lot of manuals and error scanner."}, {"Time_Start": 2531.12, "Time_End": 2533.86, "Text": " Anyway, I guess I am done early."}, {"Time_Start": 2535.0, "Time_End": 2540.98, "Text": " I'm opposed to tell you that you have to clear out because the next line is already really long."}, {"Time_Start": 2541.42, "Time_End": 2543.02, "Text": " And that's really all I have to say."}, {"Time_Start": 2543.2200000000003, "Time_End": 2546.38, "Text": " If you have questions, I'm going to go out by the pool so the next crowd can get in here a while."}, {"Time_Start": 2546.94, "Time_End": 2548.02, "Text": " So thank you for your time."}, {"Time_Start": 2552.88, "Time_End": 2553.88, "Text": " You know, you know."}]}