{"segments": [{"Time_Start": 0.0, "Time_End": 14.56, "Text": " Today we're going to do a talk on the project that three of us worked on."}, {"Time_Start": 14.56, "Time_End": 19.76, "Text": " We are with the Tri Valley Security Group that is a non-profit security organization formed"}, {"Time_Start": 19.76, "Time_End": 24.080000000000002, "Text": " out of the Bay Area, just East Bay."}, {"Time_Start": 24.080000000000002, "Time_End": 27.12, "Text": " We have Spider who acquired the hardware for us."}, {"Time_Start": 27.12, "Time_End": 29.98, "Text": " We had Mystic here who basically kept us organized."}, {"Time_Start": 30.0, "Time_End": 33.2, "Text": " and my name is Otto, I did the software development."}, {"Time_Start": 33.2, "Time_End": 41.4, "Text": " The concept is we need a way to break into Natted networks."}, {"Time_Start": 41.4, "Time_End": 46.6, "Text": " And the best way to do that is to put something inside there so we can own them from the inside out."}, {"Time_Start": 46.6, "Time_End": 52.2, "Text": " So we wanted to place a stealth, a hostile packet sniffer on a victim network."}, {"Time_Start": 52.2, "Time_End": 57.0, "Text": " We wanted to make it blend in, hide in plain sight, make it as a UPS."}, {"Time_Start": 57.0, "Time_End": 59.6, "Text": " This guy right here is our second model UPS."}, {"Time_Start": 59.6, "Time_End": 63.6, "Text": " You take a look at it, from all external purposes, it looks completely stock."}, {"Time_Start": 63.6, "Time_End": 66.6, "Text": " We maintain the same connectivity and everything."}, {"Time_Start": 66.6, "Time_End": 68.6, "Text": " The power switch works."}, {"Time_Start": 68.6, "Time_End": 71.6, "Text": " It's sort of tough."}, {"Time_Start": 71.6, "Time_End": 72.6, "Text": " Careful."}, {"Time_Start": 72.6, "Time_End": 74.6, "Text": " Do you zoom in?"}, {"Time_Start": 74.6, "Time_End": 77.6, "Text": " They don't have any video, so."}, {"Time_Start": 77.6, "Time_End": 79.6, "Text": " Use your eyes and zoom in."}, {"Time_Start": 79.6, "Time_End": 81.6, "Text": " There you go. Thank you."}, {"Time_Start": 81.6, "Time_End": 84.6, "Text": " We'll have it around afterwards if you want to take a look at it."}, {"Time_Start": 84.6, "Time_End": 86.6, "Text": " We'll shut it down and you can play with it or something."}, {"Time_Start": 86.6, "Time_End": 87.6, "Text": " Okay."}, {"Time_Start": 87.60000000000001, "Time_End": 94.60000000000001, "Text": " Everyone, especially in California, with all the rolling blackouts we had and all the brownouts and shit,"}, {"Time_Start": 94.60000000000001, "Time_End": 100.60000000000001, "Text": " sorry, stuff, you know, everyone had one of these on their desk because you just like,"}, {"Time_Start": 100.60000000000001, "Time_End": 103.60000000000001, "Text": " oh, you run up, and we'd have to shut down and stuff."}, {"Time_Start": 103.60000000000001, "Time_End": 107.60000000000001, "Text": " So this, they have the nice land jacks on the back because, you know, lightning strikes"}, {"Time_Start": 107.60000000000001, "Time_End": 110.60000000000001, "Text": " and you have the integrated nicks on your laptops."}, {"Time_Start": 110.60000000000001, "Time_End": 111.60000000000001, "Text": " Those things are money to replace."}, {"Time_Start": 111.60000000000001, "Time_End": 116.60000000000001, "Text": " So you want to plug it in and plug it into your corporate network and we own you."}, {"Time_Start": 116.60000000000001, "Time_End": 117.60000000000001, "Text": " So."}, {"Time_Start": 117.60000000000001, "Time_End": 119.60000000000001, "Text": " Let's see here."}, {"Time_Start": 119.60000000000001, "Time_End": 122.60000000000001, "Text": " So we'll talk more about that."}, {"Time_Start": 122.60000000000001, "Time_End": 124.60000000000001, "Text": " So like I said, today is a prototype."}, {"Time_Start": 124.60000000000001, "Time_End": 125.60000000000001, "Text": " This is the Mark 2."}, {"Time_Start": 125.60000000000001, "Time_End": 127.60000000000001, "Text": " The Mark 1 was kind of ugly."}, {"Time_Start": 127.60000000000001, "Time_End": 130.60000000000002, "Text": " And really this isn't undetectable."}, {"Time_Start": 130.60000000000002, "Time_End": 133.60000000000002, "Text": " I'm sorry if you came here to see the newest Uber-Lie thing."}, {"Time_Start": 133.60000000000002, "Time_End": 136.60000000000002, "Text": " This is mostly undetectable."}, {"Time_Start": 136.60000000000002, "Time_End": 140.60000000000002, "Text": " Depending on what mode you put it in, it could be very, very, very quiet."}, {"Time_Start": 140.60000000000002, "Time_End": 143.60000000000002, "Text": " But it would have no IP and you'd have to dead drop it in,"}, {"Time_Start": 143.60000000000002, "Time_End": 145.60000000000002, "Text": " and then go back later and dead drop it out."}, {"Time_Start": 145.60000000000002, "Time_End": 147.60000000000002, "Text": " If you actually want to exfiltrate data,"}, {"Time_Start": 147.6, "Time_End": 149.6, "Text": " Obviously, you have to make network noise."}, {"Time_Start": 149.6, "Time_End": 151.6, "Text": " Someone might be listening, you never know."}, {"Time_Start": 151.6, "Time_End": 158.6, "Text": " We're working on getting more hardware, more software to reduce the risk and increase onage."}, {"Time_Start": 158.6, "Time_End": 161.6, "Text": " So we've been introducing, and we're going to talk about integration."}, {"Time_Start": 161.6, "Time_End": 163.6, "Text": " I'm going to pass over to Mystic for integration."}, {"Time_Start": 163.6, "Time_End": 166.6, "Text": " Spider here will talk about the hardware he gave."}, {"Time_Start": 166.6, "Time_End": 167.6, "Text": " Oh, you're doing integration?"}, {"Time_Start": 167.6, "Time_End": 169.6, "Text": " Oh, okay. See how organized we are?"}, {"Time_Start": 169.6, "Time_End": 170.6, "Text": " Yeah."}, {"Time_Start": 170.6, "Time_End": 172.6, "Text": " So, I'll talk about the software."}, {"Time_Start": 172.6, "Time_End": 176.6, "Text": " We'll do a little demo, and then we'll do a little Q&A."}, {"Time_Start": 176.6, "Time_End": 179.6, "Text": " If you're going to do one of these things yourself, do little case mods."}, {"Time_Start": 179.6, "Time_End": 181.6, "Text": " Those of you do case mods, you know about this."}, {"Time_Start": 181.6, "Time_End": 182.6, "Text": " Amps kill."}, {"Time_Start": 182.6, "Time_End": 184.6, "Text": " They will hurt you very badly and then you will die."}, {"Time_Start": 184.6, "Time_End": 188.6, "Text": " So if you're going to open up stuff, work with live power, keep this in mind."}, {"Time_Start": 188.6, "Time_End": 190.6, "Text": " Okay."}, {"Time_Start": 190.6, "Time_End": 191.6, "Text": " Okay."}, {"Time_Start": 191.6, "Time_End": 196.6, "Text": " One of our biggest goals on this UPS unit was to make it look as stock as possible."}, {"Time_Start": 196.6, "Time_End": 199.6, "Text": " I actually work for an embedded computer company in the Bay Area,"}, {"Time_Start": 199.6, "Time_End": 202.6, "Text": " so I had access to a lot of really cool equipment."}, {"Time_Start": 202.6, "Time_End": 205.6, "Text": " But a lot of things that people don't understand about embedded computers,"}, {"Time_Start": 205.6, "Time_End": 207.6, "Text": " that are easy to use."}, {"Time_Start": 207.6, "Time_End": 209.6, "Text": " Embedded computers are basically an entire system"}, {"Time_Start": 209.6, "Time_End": 212.6, "Text": " that's been miniaturized into one system,"}, {"Time_Start": 212.6, "Time_End": 214.6, "Text": " my apologies."}, {"Time_Start": 214.6, "Time_End": 216.6, "Text": " An embedded system is an entire computer"}, {"Time_Start": 216.6, "Time_End": 219.6, "Text": " that's been modified to fit into a very small space."}, {"Time_Start": 219.6, "Time_End": 221.6, "Text": " The board that we're using in here"}, {"Time_Start": 221.6, "Time_End": 225.6, "Text": " currently houses a Pentium 166 with 128 megabytes of RAM"}, {"Time_Start": 225.6, "Time_End": 227.6, "Text": " and a..."}, {"Time_Start": 227.6, "Time_End": 229.6, "Text": " Sorry,"}, {"Time_Start": 229.6, "Time_End": 231.6, "Text": " and a one gigabyte hard drive."}, {"Time_Start": 231.6, "Time_End": 234.6, "Text": " I mean, you can attach any laptop hard drive in there,"}, {"Time_Start": 234.6, "Time_End": 235.6, "Text": " so you storage capacity is."}, {"Time_Start": 235.6, "Time_End": 239.6, "Text": " unlimited. So really one of the most important things when we're building this unit is to keep"}, {"Time_Start": 239.6, "Time_End": 245.6, "Text": " it looking out from the outside as stock as possible, while on the inside getting the maximum functionality"}, {"Time_Start": 245.6, "Time_End": 249.6, "Text": " and getting everything to run as smooth as possible."}, {"Time_Start": 249.6, "Time_End": 256.6, "Text": " All right, there was four things we needed for this design. We needed obviously the UPS, the box itself."}, {"Time_Start": 256.6, "Time_End": 261.6, "Text": " We basically stripped out the entire insides, the battery, everything that was in there"}, {"Time_Start": 261.6, "Time_End": 264.6, "Text": " and replaced it with our stuff. So this isn't a functioning UPS."}, {"Time_Start": 264.6, "Time_End": 272.6, "Text": " UPS. It really is just deployed. It just is hard to, you know, hard to see, and no one really thinks to look inside a UPS for anything hostile."}, {"Time_Start": 272.6, "Time_End": 274.6, "Text": " It's a leak case mod."}, {"Time_Start": 274.6, "Time_End": 282.6, "Text": " The power supply is just used for taking our AC voltage and converting into DC, all computers run on DC."}, {"Time_Start": 282.6, "Time_End": 286.6, "Text": " Embedded systems especially, there's only a couple voltages that computers really run at."}, {"Time_Start": 286.6, "Time_End": 290.6, "Text": " They're either running at 5 volt, 3.3 volt or 12 volt."}, {"Time_Start": 290.6, "Time_End": 294.6, "Text": " So as far as power supplies go, I mean, eBay is a great place to pick up really cheap power"}, {"Time_Start": 294.6, "Time_End": 299.6, "Text": " supplies. If you're doing any work with electronics, you know, computer equipment,"}, {"Time_Start": 299.6, "Time_End": 304.6, "Text": " having power supplies just handy, small compact power supplies is really useful."}, {"Time_Start": 304.6, "Time_End": 310.6, "Text": " Okay, the other thing you can do, if you don't have a lot of money,"}, {"Time_Start": 310.6, "Time_End": 313.6, "Text": " embedded systems, you can start looking at them for around $200."}, {"Time_Start": 313.6, "Time_End": 316.6, "Text": " But a lot of the times I know people want to get it even cheaper than that."}, {"Time_Start": 316.6, "Time_End": 319.6, "Text": " HP has made a model of machines called the e-machines."}, {"Time_Start": 319.6, "Time_End": 321.6, "Text": " I'm sure a lot of people are familiar with them."}, {"Time_Start": 321.6, "Time_End": 324.58000000000004, "Text": " The e-machines are basically like a really tiny computer that HP,"}, {"Time_Start": 324.6, "Time_End": 328.3, "Text": " made and the really nice thing about them is if you look inside, they've got an integrated"}, {"Time_Start": 328.3, "Time_End": 332.40000000000003, "Text": " motherboard that has everything included in it. So you can go on eBay and pick up one of these"}, {"Time_Start": 332.40000000000003, "Time_End": 337.34000000000003, "Text": " e-machines for $30 and go and rip the motherboard out and you've got basically an embedded computer"}, {"Time_Start": 337.34000000000003, "Time_End": 338.1, "Text": " for 30 bucks."}, {"Time_Start": 338.1, "Time_End": 340.70000000000005, "Text": " You want to go back one?"}, {"Time_Start": 340.70000000000005, "Time_End": 341.1, "Text": " Sorry."}, {"Time_Start": 341.1, "Time_End": 342.1, "Text": " Back."}, {"Time_Start": 342.1, "Time_End": 346.1, "Text": " Oh, there's some pictures of our first prototype."}, {"Time_Start": 346.1, "Time_End": 348.1, "Text": " As you can see, it's a lot bigger and it was harder to mod."}, {"Time_Start": 348.1, "Time_End": 352.1, "Text": " But really the first prototype, we just wanted to make sure that this idea was going to work"}, {"Time_Start": 352.1, "Time_End": 354.1, "Text": " before continuing on."}, {"Time_Start": 354.1, "Time_End": 355.1, "Text": " on."}, {"Time_Start": 355.1, "Time_End": 358.1, "Text": " Auto actually was responsible for the design of the second unit here."}, {"Time_Start": 358.1, "Time_End": 361.1, "Text": " Okay, the board that we've picked to use comes from Contron."}, {"Time_Start": 361.1, "Time_End": 366.1, "Text": " If you want to get into embedded computers, I'd recommend just visiting some of the sites."}, {"Time_Start": 366.1, "Time_End": 369.1, "Text": " We've got some links on the CD."}, {"Time_Start": 369.1, "Time_End": 370.1, "Text": " We picked this."}, {"Time_Start": 370.1, "Time_End": 372.1, "Text": " It's a Pentium 166."}, {"Time_Start": 372.1, "Time_End": 374.1, "Text": " It's got 128 meg of RAM in it."}, {"Time_Start": 374.1, "Time_End": 377.1, "Text": " We've got two IDE channels so we can hook up to four devices."}, {"Time_Start": 377.1, "Time_End": 378.1, "Text": " We can have CD ROMs."}, {"Time_Start": 378.1, "Time_End": 381.1, "Text": " We can have extra hard drives."}, {"Time_Start": 381.1, "Time_End": 383.1, "Text": " Really, when you're dealing with embedded systems, you are dealing with a PC."}, {"Time_Start": 383.1, "Time_End": 388.1, "Text": " dealing with a PC. There's no reason to think outside of PC terms. It's really just"}, {"Time_Start": 388.1, "Time_End": 392.1, "Text": " the form factor and the way that it's being connected together. A really good example of this"}, {"Time_Start": 392.1, "Time_End": 396.1, "Text": " is embedded computer people will know a term called PC104."}, {"Time_Start": 396.1, "Time_End": 401.1, "Text": " PC104 is basically an ISOBUS, but we've carried it out into an embedded form factor."}, {"Time_Start": 401.1, "Time_End": 404.1, "Text": " As far as it's concerned, the timing, everything's identical to it."}, {"Time_Start": 404.1, "Time_End": 408.1, "Text": " The chips sets, you know, you're using chips and technology, 69,000s, you're using all in wonders,"}, {"Time_Start": 408.1, "Time_End": 409.1, "Text": " everything's the same."}, {"Time_Start": 409.1, "Time_End": 413.1, "Text": " It's just that you're changing the form factor and you're changing the size of the unit to fit."}, {"Time_Start": 413.1, "Time_End": 415.5, "Text": " into an application."}, {"Time_Start": 415.5, "Time_End": 418.3, "Text": " Our embedded system had only one Ethernet."}, {"Time_Start": 418.3, "Time_End": 420.6, "Text": " That was mainly because I got the system for free,"}, {"Time_Start": 420.6, "Time_End": 424.20000000000005, "Text": " and we didn't want to spend any money on it."}, {"Time_Start": 424.20000000000005, "Time_End": 426.66, "Text": " Just because we wanted to keep it simple,"}, {"Time_Start": 426.66, "Time_End": 431.6, "Text": " we just ripped the 10-100 Hub and placed it inside here,"}, {"Time_Start": 431.6, "Time_End": 434.16, "Text": " which just allowed traffic to go through it."}, {"Time_Start": 438.20000000000005, "Time_End": 441.38, "Text": " Yeah, I made this slide, so it's kind of important."}, {"Time_Start": 441.38, "Time_End": 443.08000000000004, "Text": " One of the problems with the"}, {"Time_Start": 443.1, "Time_End": 445.1, "Text": " putting a hub in there instead of bridging through."}, {"Time_Start": 445.1, "Time_End": 450.1, "Text": " Well, it's good because even if the UPS, the embedded machine is still booting,"}, {"Time_Start": 450.1, "Time_End": 455.1, "Text": " and it's not being told to bridge, your victim will still get a lane, will still get through"}, {"Time_Start": 455.1, "Time_End": 457.1, "Text": " and you won't impede his traffic."}, {"Time_Start": 457.1, "Time_End": 459.1, "Text": " But the bad thing is you can't do proxy ARP attacks."}, {"Time_Start": 459.1, "Time_End": 464.1, "Text": " That'd be really cool, where instead of the client going out on his Mac address,"}, {"Time_Start": 464.1, "Time_End": 468.1, "Text": " if you can bridge it through your box and then everything goes on your Mac address,"}, {"Time_Start": 468.1, "Time_End": 470.1, "Text": " you can effectively take over his IP."}, {"Time_Start": 470.1, "Time_End": 473.08000000000004, "Text": " That was a mode that I wanted to work on for the con but didn't get it."}, {"Time_Start": 473.1, "Time_End": 477.1, "Text": " in time because we couldn't do a bridge through the embedded machine."}, {"Time_Start": 477.1, "Time_End": 483.1, "Text": " So if we could have done that, it would have been almost impossible to tell the victim traffic from our traffic"}, {"Time_Start": 483.1, "Time_End": 486.1, "Text": " because it had been exactly the same MAC address."}, {"Time_Start": 486.1, "Time_End": 488.1, "Text": " So maybe next year."}, {"Time_Start": 488.1, "Time_End": 493.1, "Text": " And the ugly part is that you get link from a UPS."}, {"Time_Start": 493.1, "Time_End": 496.1, "Text": " You're not supposed to do that."}, {"Time_Start": 496.1, "Time_End": 500.1, "Text": " It's a dumb hub."}, {"Time_Start": 500.1, "Time_End": 502.1, "Text": " So the bridge run, the box this runs in."}, {"Time_Start": 502.1, "Time_End": 503.86, "Text": " box this runs in primiscus mode."}, {"Time_Start": 503.86, "Time_End": 509.1, "Text": " Yes, the embedded machine itself has a variety of different processes running on it that"}, {"Time_Start": 509.1, "Time_End": 511.40000000000003, "Text": " all make the interface going through rescus mode."}, {"Time_Start": 511.40000000000003, "Time_End": 512.1, "Text": " I'll talk about those."}, {"Time_Start": 512.1, "Time_End": 513.1, "Text": " Just a quick sec."}, {"Time_Start": 513.1, "Time_End": 516.1, "Text": " Okay, transition to software now."}, {"Time_Start": 516.1, "Time_End": 518.1, "Text": " I used Red Hat 7-2."}, {"Time_Start": 518.1, "Time_End": 521.1, "Text": " I know people don't like Red Hat, but sorry, I know it works."}, {"Time_Start": 521.1, "Time_End": 522.1, "Text": " It works."}, {"Time_Start": 522.1, "Time_End": 528.1, "Text": " 7-2 was the first one that had the EXT file system, the EXT file system, the journaling,"}, {"Time_Start": 528.1, "Time_End": 532.1, "Text": " so I can yank at the power supply and it just dies, and it doesn't really hurt"}, {"Time_Start": 532.1, "Time_End": 534.1, "Text": " the hard drive too much, which is kind of cool."}, {"Time_Start": 534.1, "Time_End": 538.1, "Text": " I used a lot of scroll scripts and shell scripts"}, {"Time_Start": 538.1, "Time_End": 540.1, "Text": " and then added a neat fun tools."}, {"Time_Start": 540.1, "Time_End": 542.1, "Text": " I used Netcat by Hobbit."}, {"Time_Start": 542.1, "Time_End": 544.1, "Text": " That's like standard issue these days."}, {"Time_Start": 544.1, "Time_End": 548.1, "Text": " The core of the unit as far as actually acquiring victim traffic"}, {"Time_Start": 548.1, "Time_End": 550.1, "Text": " is D-sniff by Doug Song."}, {"Time_Start": 550.1, "Time_End": 552.1, "Text": " It's a really cool tool. I recommend you check it out."}, {"Time_Start": 552.1, "Time_End": 555.1, "Text": " Of course, we use NMAP by Fyodor."}, {"Time_Start": 555.1, "Time_End": 558.1, "Text": " And at the last minute I threw in the hacker's choice,"}, {"Time_Start": 558.1, "Time_End": 561.1, "Text": " the TCHRU there for network discovery."}, {"Time_Start": 561.1, "Time_End": 562.1, "Text": " for network discovery."}, {"Time_Start": 562.1, "Time_End": 563.1, "Text": " It works great."}, {"Time_Start": 563.1, "Time_End": 565.1, "Text": " Okay, so many hangs still hot."}, {"Time_Start": 565.1, "Time_End": 568.1, "Text": " This is used for, basically for the plumbing."}, {"Time_Start": 568.1, "Time_End": 570.1, "Text": " I wrote the scripts."}, {"Time_Start": 570.1, "Time_End": 573.1, "Text": " I wrote them without any network code in them just to make it easier,"}, {"Time_Start": 573.1, "Time_End": 575.1, "Text": " and I basically is NetCat everything."}, {"Time_Start": 575.1, "Time_End": 576.1, "Text": " It's cool."}, {"Time_Start": 576.1, "Time_End": 583.1, "Text": " By default, I use it over UDP 53, which to a normal firewall would look exactly like a DNS request,"}, {"Time_Start": 583.1, "Time_End": 585.1, "Text": " so it would let it through."}, {"Time_Start": 585.1, "Time_End": 590.1, "Text": " The problem with DNS request is not really DNS request."}, {"Time_Start": 590.1, "Time_End": 594.82, "Text": " is not really DNS. It's encrypted, but it doesn't look like a DNS request."}, {"Time_Start": 594.82, "Time_End": 599.34, "Text": " So an IDS or an IDP system would notice this."}, {"Time_Start": 599.34, "Time_End": 602.62, "Text": " This is not dNs traffic. It doesn't even look like it."}, {"Time_Start": 602.62, "Time_End": 607.98, "Text": " If you sniff this traffic and then you would use it's real to read it, it'll freak out."}, {"Time_Start": 607.98, "Time_End": 614.14, "Text": " It'll go 10,000 requests, 5,000 replies, and it's one packet, it's freaking."}, {"Time_Start": 614.14, "Time_End": 620.08, "Text": " So tunneling alternatives. I could be more elite and then do Port 80, TCP, and actually amassed"}, {"Time_Start": 620.1, "Time_End": 624.6, "Text": " the UPS requests in HCP URLs and have the replies be webp pages."}, {"Time_Start": 624.6, "Time_End": 629.1, "Text": " And at the last minute, I also found some really cool pearl scripts out down on the web that do exactly this,"}, {"Time_Start": 629.1, "Time_End": 631.1, "Text": " but I didn't have a chance to integrate them."}, {"Time_Start": 631.1, "Time_End": 634.1, "Text": " So another alternative, I really do like DNS."}, {"Time_Start": 634.1, "Time_End": 637.1, "Text": " Even though it's a UDP and you can lose packets, that's a real issue."}, {"Time_Start": 637.1, "Time_End": 640.1, "Text": " No one uses internal DNS."}, {"Time_Start": 640.1, "Time_End": 643.1, "Text": " They always allow it out. It's pathetic, so."}, {"Time_Start": 643.1, "Time_End": 649.1, "Text": " But it'd be really cool if I can make you look more like a DNS request and DNS replies, but that's next year."}, {"Time_Start": 649.1, "Time_End": 652.0400000000001, "Text": " So back on the D-SNF now."}, {"Time_Start": 652.0400000000001, "Time_End": 655.7, "Text": " This is an incredibly cool, and it's actually kind of old."}, {"Time_Start": 655.84, "Time_End": 658.98, "Text": " It's been out for a couple of years now, so if you haven't heard about it, go and find it."}, {"Time_Start": 659.22, "Time_End": 665.46, "Text": " You might need to do you a little tweaking to the Berkeley path because they're expecting an older version of the Berkeley."}, {"Time_Start": 665.7, "Time_End": 666.98, "Text": " So we were set."}, {"Time_Start": 668.0400000000001, "Time_End": 670.5600000000001, "Text": " Here's the tools that we use from D-Sniff, actually on the box."}, {"Time_Start": 671.3000000000001, "Time_End": 671.98, "Text": " He's Mac-Off."}, {"Time_Start": 672.14, "Time_End": 677.24, "Text": " Mac-Off was actually in the D-Sniff suite, the Mac-Off was actually as the port of the Perl script,"}, {"Time_Start": 677.24, "Time_End": 678.0400000000001, "Text": " D-Mack-Off."}, {"Time_Start": 679.1, "Time_End": 682.86, "Text": " start spamming out a whole bunch of packets with forged Mac addresses."}, {"Time_Start": 683.34, "Time_End": 685.72, "Text": " This allows you to break open a typical switch."}, {"Time_Start": 686.6, "Time_End": 691.78, "Text": " Switches have cam tables that keep track of every Mac address on a physical interface,"}, {"Time_Start": 692.1800000000001, "Time_End": 695.0, "Text": " and they only have so much buffer space to hold those."}, {"Time_Start": 695.16, "Time_End": 699.44, "Text": " And if they overflow that, they go, I can't keep track of all these stupid Mac addresses,"}, {"Time_Start": 699.6800000000001, "Time_End": 702.3000000000001, "Text": " so I'm just going to put everything down this port."}, {"Time_Start": 702.9, "Time_End": 706.5, "Text": " And that basically gives you access to the traffic transference in the entire switch,"}, {"Time_Start": 706.8000000000001, "Time_End": 707.32, "Text": " which is kind of cool."}, {"Time_Start": 708.4, "Time_End": 708.84, "Text": " D-sniff."}, {"Time_Start": 709.1, "Time_End": 710.94, "Text": " Clear text authentication extractor."}, {"Time_Start": 711.0600000000001, "Time_End": 724.3000000000001, "Text": " It decodes approximately 20 to 25 clear text protocols, Pop 3, Telnet, HDP off, S&B, S&B, SQL."}, {"Time_Start": 724.84, "Time_End": 725.66, "Text": " It's brutal."}, {"Time_Start": 726.52, "Time_End": 728.26, "Text": " FileSnarf does NFSinterceptor."}, {"Time_Start": 728.4200000000001, "Time_End": 734.28, "Text": " If there's someone copies an FS file across their box, it say it's a copy of the file locally."}, {"Time_Start": 735.3000000000001, "Time_End": 739.0, "Text": " Email Interceptor is MailSnarf, and we actually have a little test."}, {"Time_Start": 739.1, "Time_End": 744.52, "Text": " that we're going to show a little later. I'd already ran this earlier and snarfed off some"}, {"Time_Start": 744.52, "Time_End": 748.76, "Text": " email, so I'll always show you how that looks. U.R. Interceptor is U.R.S. Snarf,"}, {"Time_Start": 749.22, "Time_End": 752.16, "Text": " and Instant Messenger is instant messenger is MSNSNF. So."}, {"Time_Start": 754.0400000000001, "Time_End": 758.98, "Text": " And, of course, the Hackers Toolkit, EnMAP, thanks for our, you rock. This is so cool."}, {"Time_Start": 759.48, "Time_End": 763.88, "Text": " It came with RPM, so we didn't have to do anything. We use it for the network connectivity with"}, {"Time_Start": 763.88, "Time_End": 767.6800000000001, "Text": " the box to make sure it can actually call out. If it can't call home, it won't try to."}, {"Time_Start": 769.1, "Time_End": 771.24, "Text": " And then I made a whole bunch of PIRL scripts."}, {"Time_Start": 773.64, "Time_End": 775.8000000000001, "Text": " The first PIRL script is the master control script."}, {"Time_Start": 775.9200000000001, "Time_End": 781.5600000000001, "Text": " It starts on boot-up and it handles all the other processes that the UPS does as far as"}, {"Time_Start": 782.16, "Time_End": 785.84, "Text": " turning on SIFR process, turning off SIFR process, calling home, that kind of a thing."}, {"Time_Start": 786.86, "Time_End": 787.86, "Text": " So this is what it does."}, {"Time_Start": 787.9200000000001, "Time_End": 789.0400000000001, "Text": " And when it boots up, it loads a config."}, {"Time_Start": 789.72, "Time_End": 792.32, "Text": " I don't use the Red Hat network configuration scripts."}, {"Time_Start": 792.48, "Time_End": 794.1800000000001, "Text": " I've just used everything myself."}, {"Time_Start": 794.1800000000001, "Time_End": 798.6, "Text": " That way, it has a unified interface for the different modes that I use for,"}, {"Time_Start": 799.1, "Time_End": 801.8000000000001, "Text": " IP addresses, which I'll talk about in a second."}, {"Time_Start": 801.8000000000001, "Time_End": 807.28, "Text": " So it confids the network, make sure everything's good, and then tries to call home."}, {"Time_Start": 807.28, "Time_End": 812.64, "Text": " And it's, from there, does an endless loop, calls the home, works on what it gets, sets what"}, {"Time_Start": 812.64, "Time_End": 816.84, "Text": " it does, calls home every number of seconds."}, {"Time_Start": 816.84, "Time_End": 819.44, "Text": " The IP, we have four different modes."}, {"Time_Start": 819.44, "Time_End": 823.1, "Text": " Mode number one is what I talked about earlier when I said that, you know, it's almost"}, {"Time_Start": 823.1, "Time_End": 824.14, "Text": " undetectable."}, {"Time_Start": 824.14, "Time_End": 828.9200000000001, "Text": " And that's no IP where it won't respond to anything, it just sits there and it sniffs."}, {"Time_Start": 828.9200000000001, "Time_End": 831.84, "Text": " Now, this, you have to be able to sneak in, put the box in place,"}, {"Time_Start": 832.7600000000001, "Time_End": 835.1200000000001, "Text": " hope it comes up okay, and start sniffing."}, {"Time_Start": 835.1800000000001, "Time_End": 838.1400000000001, "Text": " You have to turn on all the sniffing you want, and ahead of time,"}, {"Time_Start": 838.34, "Time_End": 841.9000000000001, "Text": " and hope that your hard drive doesn't go full, and just come back later and get it."}, {"Time_Start": 842.4000000000001, "Time_End": 845.3000000000001, "Text": " That's really stealthy, but it's not really fun."}, {"Time_Start": 845.6400000000001, "Time_End": 846.48, "Text": " You have to go in twice."}, {"Time_Start": 847.08, "Time_End": 848.72, "Text": " Fixed IP mode is really good for testing."}, {"Time_Start": 848.94, "Time_End": 850.1400000000001, "Text": " Here's your IP, blah."}, {"Time_Start": 851.1600000000001, "Time_End": 855.5600000000001, "Text": " DGP mode, it's not very stealthy, though, because if you're on a network that either doesn't have a DHP server"}, {"Time_Start": 855.5600000000001, "Time_End": 857.6800000000001, "Text": " or they don't have a lot of nodes,"}, {"Time_Start": 857.6800000000001, "Time_End": 860.6, "Text": " and they have registered MAC addresses for all their DCB nodes,"}, {"Time_Start": 861.0200000000001, "Time_End": 864.08, "Text": " and you start asking for an IP address, they're going to know, who's this?"}, {"Time_Start": 864.4000000000001, "Time_End": 865.1600000000001, "Text": " That's not very cool."}, {"Time_Start": 866.0400000000001, "Time_End": 871.1200000000001, "Text": " Mode 4 was the most elite mode, but it's also extremely noisy at layer 2."}, {"Time_Start": 872.0200000000001, "Time_End": 874.44, "Text": " It actually will, well, here, let's do this."}, {"Time_Start": 876.9000000000001, "Time_End": 878.9000000000001, "Text": " It watches the network for ARP requests."}, {"Time_Start": 879.4200000000001, "Time_End": 882.32, "Text": " At first it starts listening for ARP requests, and it listens to the requester."}, {"Time_Start": 883.4000000000001, "Time_End": 887.32, "Text": " Obviously, if I hear ARP request from someone on my wire,"}, {"Time_Start": 887.6800000000001, "Time_End": 890.6600000000001, "Text": " That means that they're on my local layer 2 subnet."}, {"Time_Start": 891.3800000000001, "Time_End": 896.2600000000001, "Text": " It takes that IP as a seed, turns around and uses the Hacker's Choice, Are You There?"}, {"Time_Start": 896.7800000000001, "Time_End": 901.4200000000001, "Text": " And basically, for that, you can generate ARP requests for anything you want."}, {"Time_Start": 901.5000000000001, "Time_End": 902.4000000000001, "Text": " So I use it as a seed."}, {"Time_Start": 902.7800000000001, "Time_End": 903.72, "Text": " I do a Class B."}, {"Time_Start": 904.1600000000001, "Time_End": 905.6200000000001, "Text": " That's typical."}, {"Time_Start": 905.6200000000001, "Time_End": 908.36, "Text": " I mean, most networks should be less than a Class B."}, {"Time_Start": 908.9000000000001, "Time_End": 912.7800000000001, "Text": " And it doesn't take that much longer to do a Class B than a Class C in this way."}, {"Time_Start": 913.08, "Time_End": 914.1400000000001, "Text": " You'll get Super Nets this way."}, {"Time_Start": 914.9000000000001, "Time_End": 917.6600000000001, "Text": " The Hacker's Choice, the T, C, C."}, {"Time_Start": 917.6800000000001, "Time_End": 921.7, "Text": " rut, it can do 3,000 ARPs in parallel."}, {"Time_Start": 922.0000000000001, "Time_End": 925.3000000000001, "Text": " So this doesn't take that long, maybe 5, 10 seconds for a whole Class B."}, {"Time_Start": 925.96, "Time_End": 926.3800000000001, "Text": " It's brutal."}, {"Time_Start": 927.22, "Time_End": 929.24, "Text": " So it'll sit there and it'll scan the whole."}, {"Time_Start": 929.3800000000001, "Time_End": 934.5000000000001, "Text": " It'll do ARPs for every single IP in a class B segment that it detects from the top part."}, {"Time_Start": 935.3000000000001, "Time_End": 937.7600000000001, "Text": " And then it'll, it sees everything that's there."}, {"Time_Start": 938.0600000000001, "Time_End": 941.9000000000001, "Text": " It finds a IP that's not in use that's in the range and just picks it."}, {"Time_Start": 942.7, "Time_End": 943.6800000000001, "Text": " So that's kind of fun."}, {"Time_Start": 943.6800000000001, "Time_End": 950.1200000000001, "Text": " Another thing I didn't write in here, the next thing it does is then it turns around"}, {"Time_Start": 950.1200000000001, "Time_End": 956.48, "Text": " and it listens again for more ARPs, but now it listens for who they're asking for."}, {"Time_Start": 957.2800000000001, "Time_End": 959.2800000000001, "Text": " It counts about 20 or 30 packets."}, {"Time_Start": 959.2800000000001, "Time_End": 962.58, "Text": " It's asking, it's listening for who is everyone trying to find."}, {"Time_Start": 963.0200000000001, "Time_End": 968.7600000000001, "Text": " Nine times out of 10, the most popular ARP target on a network is the default gateway."}, {"Time_Start": 969.5200000000001, "Time_End": 973.6600000000001, "Text": " So we do a little statistical analysis there and say the top one, we'll pick him as a"}, {"Time_Start": 973.6800000000001, "Time_End": 979.08, "Text": " default gateway. If it doesn't work, the whole thing has a check here at the end where it'll"}, {"Time_Start": 979.08, "Time_End": 985.7, "Text": " try to go out, try to go out, tries to contact the listing post even. If it fails, it comes back"}, {"Time_Start": 985.7, "Time_End": 991.4000000000001, "Text": " here and starts again. So another cool thing about mode 3, the DHCP mode, if you do set it"}, {"Time_Start": 991.4000000000001, "Time_End": 998.08, "Text": " for mode 3 and there is no DGCP server, there is no spoon, it'll keep the fact that it's"}, {"Time_Start": 998.08, "Time_End": 1003.6600000000001, "Text": " in mode 3 but fail down to mode 4 to try to get out. So it'll always try to try to try to"}, {"Time_Start": 1003.6800000000001, "Time_End": 1007.6800000000001, "Text": " try DHCP, but if I can't get out, it'll try mode 4 as well, which is kind of fun."}, {"Time_Start": 1007.6800000000001, "Time_End": 1013.6800000000001, "Text": " And there's other neat stuff, little Huss cleaning scripts, that kind of stuff."}, {"Time_Start": 1013.6800000000001, "Time_End": 1020.6800000000001, "Text": " The actual, let me skip ahead this real quick and show you the concept here."}, {"Time_Start": 1020.6800000000001, "Time_End": 1024.68, "Text": " So you have a UPS behind a firewall, and you have an attacker out there anywhere on the internet."}, {"Time_Start": 1024.68, "Time_End": 1028.68, "Text": " You also have a listing post, which can be the same as the attack or not."}, {"Time_Start": 1028.68, "Time_End": 1032.68, "Text": " It doesn't really matter, but you can allow it to point to different directions."}, {"Time_Start": 1032.68, "Time_End": 1036.5800000000002, "Text": " The UPS will, at intervals, try to contact the listing post."}, {"Time_Start": 1036.78, "Time_End": 1039.1000000000001, "Text": " The listing post is actually a command queue server."}, {"Time_Start": 1039.74, "Time_End": 1042.6000000000001, "Text": " It will, it can actually support multiple nodes."}, {"Time_Start": 1043.26, "Time_End": 1048.96, "Text": " And when a UPS calls home, it will then identify itself by its node."}, {"Time_Start": 1049.46, "Time_End": 1051.7, "Text": " The listing post will say, do I have any commands for this node?"}, {"Time_Start": 1051.8200000000002, "Time_End": 1054.42, "Text": " And if it goes yes, then it feeds the commands one of the time."}, {"Time_Start": 1054.5, "Time_End": 1057.28, "Text": " Each time the listing post asks for the next command, it comes back down."}, {"Time_Start": 1057.88, "Time_End": 1062.66, "Text": " When it's done, it says, I'm done, it disconnects, and it then goes to sleep for a specified"}, {"Time_Start": 1062.68, "Time_End": 1064.44, "Text": " amount of time and then tries again."}, {"Time_Start": 1066.24, "Time_End": 1069.3, "Text": " One of the commands is call this guy."}, {"Time_Start": 1069.8600000000001, "Time_End": 1072.26, "Text": " And the call this guy by default is TCP port 80."}, {"Time_Start": 1072.46, "Time_End": 1074.92, "Text": " And since the connection is being initiated outbound through the firewall,"}, {"Time_Start": 1075.3, "Time_End": 1076.3, "Text": " generally that's permitted too."}, {"Time_Start": 1076.3600000000001, "Time_End": 1080.1200000000001, "Text": " Not a whole lot of people have proxy servers behind there."}, {"Time_Start": 1080.16, "Time_End": 1082.3400000000001, "Text": " So they'll allow clients to go out in HTTP."}, {"Time_Start": 1083.64, "Time_End": 1088.04, "Text": " So I have a deal set up where basically it connects out to the attacker on HTTP."}, {"Time_Start": 1088.48, "Time_End": 1092.66, "Text": " Again, thank you, Netcat, and provides the connect."}, {"Time_Start": 1092.68, "Time_End": 1095.3600000000001, "Text": " connect E with bash shell."}, {"Time_Start": 1095.3600000000001, "Time_End": 1098.72, "Text": " So if you, something that wasn't there in my command structure"}, {"Time_Start": 1098.72, "Time_End": 1102.22, "Text": " and you just want to get something done, there you go."}, {"Time_Start": 1102.22, "Time_End": 1103.7, "Text": " So we'll back back up here a little bit."}, {"Time_Start": 1103.7, "Time_End": 1106.3600000000001, "Text": " Okay, so now you know what the client server is"}, {"Time_Start": 1106.3600000000001, "Time_End": 1107.46, "Text": " what I'm talking about here."}, {"Time_Start": 1107.46, "Time_End": 1111.4, "Text": " This is the DNS-like beacon that goes out"}, {"Time_Start": 1111.4, "Time_End": 1115.64, "Text": " by default every 20 seconds, but it's user-settable."}, {"Time_Start": 1115.64, "Time_End": 1118.88, "Text": " It's des encrypted, it has randomly generated keys"}, {"Time_Start": 1118.88, "Time_End": 1121.6000000000001, "Text": " for each session, and there's also a pre-shared key system."}, {"Time_Start": 1121.6000000000001, "Time_End": 1122.66, "Text": " Each side,"}, {"Time_Start": 1122.68, "Time_End": 1126.98, "Text": " has a pre-shared string that they will do an MD5 hash of real quick"}, {"Time_Start": 1126.98, "Time_End": 1131.26, "Text": " and then use that along with another randomly generated string"}, {"Time_Start": 1131.26, "Time_End": 1134.7, "Text": " and put those both together as the actual crypto key."}, {"Time_Start": 1135.1200000000001, "Time_End": 1137.5600000000002, "Text": " They only exchange the first part,"}, {"Time_Start": 1137.6200000000001, "Time_End": 1140.24, "Text": " the part that they randomly generate on the fly for that session."}, {"Time_Start": 1140.8, "Time_End": 1143.5800000000002, "Text": " So each of them already knows about the pre-shared secret ahead of time."}, {"Time_Start": 1143.78, "Time_End": 1148.02, "Text": " So even if you see this in flight and you see your keys going back and forth,"}, {"Time_Start": 1148.3400000000001, "Time_End": 1150.46, "Text": " you still can't decrypt it because you know what the pre-share is."}, {"Time_Start": 1151.0600000000002, "Time_End": 1151.5800000000002, "Text": " That's kind of cool."}, {"Time_Start": 1152.68, "Time_End": 1156.0800000000002, "Text": " So, yeah, so the client connects at intervals control"}, {"Time_Start": 1156.0800000000002, "Time_End": 1157.3, "Text": " to the master control script to the server."}, {"Time_Start": 1157.8400000000001, "Time_End": 1159.5600000000002, "Text": " But check the command queue for change the configure behavior."}, {"Time_Start": 1161.24, "Time_End": 1166.1000000000001, "Text": " Like I said, it goes out of our UDP for configging and then a reverse shell on TCP aiding."}, {"Time_Start": 1167.04, "Time_End": 1172.16, "Text": " Looking towards next year to add mail attachments to send out SMTP as well."}, {"Time_Start": 1172.72, "Time_End": 1175.3400000000001, "Text": " That's a really good exploitation, but I just didn't have enough time to finish it."}, {"Time_Start": 1176.1200000000001, "Time_End": 1177.68, "Text": " So, okay, so you saw this, it's pretty."}, {"Time_Start": 1178.22, "Time_End": 1181.52, "Text": " So in the listing post, you know, of course, SSH, so you can command to it."}, {"Time_Start": 1181.92, "Time_End": 1182.66, "Text": " Just real quick."}, {"Time_Start": 1182.68, "Time_End": 1183.14, "Text": " quick."}, {"Time_Start": 1184.6000000000001, "Time_End": 1188.1000000000001, "Text": " This is, uh-oh, it's not happy."}, {"Time_Start": 1189.88, "Time_End": 1190.72, "Text": " Oh, no."}, {"Time_Start": 1191.96, "Time_End": 1194.88, "Text": " So there's what the encryption looks like, by the way."}, {"Time_Start": 1196.28, "Time_End": 1197.46, "Text": " Actually, that's the key exchange."}, {"Time_Start": 1198.78, "Time_End": 1205.0, "Text": " My listing post thinks it's trying to send data, and the LP is trying to send its key instead."}, {"Time_Start": 1205.0, "Time_End": 1207.3600000000001, "Text": " So it should recover here in a little sec."}, {"Time_Start": 1207.42, "Time_End": 1208.66, "Text": " But anyways, we're not ready for that yet."}, {"Time_Start": 1209.8400000000001, "Time_End": 1210.3600000000001, "Text": " Oh, I guess we are."}, {"Time_Start": 1211.66, "Time_End": 1212.46, "Text": " That rocks."}, {"Time_Start": 1212.68, "Time_End": 1217.68, "Text": " So, okay, so, um, yeah, when we switch over to the, uh, the victim here?"}, {"Time_Start": 1219.8, "Time_End": 1223.0, "Text": " Okay, so what, what died?"}, {"Time_Start": 1223.0, "Time_End": 1224.92, "Text": " I don't know."}, {"Time_Start": 1224.92, "Time_End": 1225.44, "Text": " Okay."}, {"Time_Start": 1227.44, "Time_End": 1229.44, "Text": " Expanscing technical difficulties, please wait."}, {"Time_Start": 1231.02, "Time_End": 1231.5, "Text": " Thank you."}, {"Time_Start": 1232.44, "Time_End": 1235.8, "Text": " Okay, so something unplugged."}, {"Time_Start": 1242.68, "Time_End": 1252.5600000000002, "Text": " Just a one please, please, thank you, sorry."}, {"Time_Start": 1272.68, "Time_End": 1273.68, "Text": " I don't know."}]}