{"segments": [{"Time_Start": 0.0, "Time_End": 15.5, "Text": " Hi, everyone, oh my God."}, {"Time_Start": 15.5, "Time_End": 22.76, "Text": " Hi, would that go over there, we'll give a tiny minute we have 10 minutes."}, {"Time_Start": 22.76, "Time_End": 24.76, "Text": " Test."}, {"Time_Start": 24.76, "Time_End": 29.98, "Text": " Okay, hello everyone, welcome to the annual"}, {"Time_Start": 30.0, "Time_End": 34.32, "Text": " phenylate speech at DefCon."}, {"Time_Start": 34.32, "Time_End": 39.6, "Text": " We got plenty of material to cover, so I might actually step over some stuff pretty quick."}, {"Time_Start": 39.6, "Time_End": 44.28, "Text": " And if you got questions, the idea is I will hang out on the first pool and you're"}, {"Time_Start": 44.28, "Time_End": 49.24, "Text": " going to buy me beer and I answer your questions."}, {"Time_Start": 49.24, "Time_End": 50.24, "Text": " Okay, let's go."}, {"Time_Start": 50.24, "Time_End": 51.24, "Text": " What we're going to do?"}, {"Time_Start": 51.24, "Time_End": 56.6, "Text": " First, if you catch Richard Themes talk, lots of people are concerned about what's the"}, {"Time_Start": 56.6, "Time_End": 59.18, "Text": " matrix, are we in the matrix, how to hack the matrix."}, {"Time_Start": 59.18, "Time_End": 66.54, "Text": " So we thought we're going to look at it and tell you how to hack the matrix."}, {"Time_Start": 66.54, "Time_End": 71.42, "Text": " Then we have some GSM stuff, you know."}, {"Time_Start": 71.42, "Time_End": 78.42, "Text": " After that short, fun excurs, we were actually covered GSM and GPRS, basics."}, {"Time_Start": 78.42, "Time_End": 83.46000000000001, "Text": " GSM is swapping over finally to the United States, so you finally got decent phones."}, {"Time_Start": 83.46000000000001, "Time_End": 89.16, "Text": " And I thought it would be quite useful to actually give you an introduction."}, {"Time_Start": 89.18, "Time_End": 90.56, "Text": " and how the backbones work."}, {"Time_Start": 90.56, "Time_End": 97.96000000000001, "Text": " So we will also discuss two things about the mobile phone networks, attacking mobile phones"}, {"Time_Start": 97.96000000000001, "Time_End": 100.58000000000001, "Text": " and attacking mobile phone backbones."}, {"Time_Start": 100.58000000000001, "Time_End": 108.22, "Text": " And of course, this being a phenolid speech, we have the usual Cisco Odecrab and shell codes"}, {"Time_Start": 108.22, "Time_End": 110.46000000000001, "Text": " and stuff."}, {"Time_Start": 110.46000000000001, "Time_End": 111.86000000000001, "Text": " Hacking the Matrix."}, {"Time_Start": 111.86000000000001, "Time_End": 115.56, "Text": " There is a product from made by interiors."}, {"Time_Start": 115.56, "Time_End": 117.06, "Text": " They used to be cable-chon."}, {"Time_Start": 117.06, "Time_End": 118.06, "Text": " It's called The Matrix."}, {"Time_Start": 118.06, "Time_End": 122.06, "Text": " So just because they gave it the wrong name, I started looking at it."}, {"Time_Start": 122.06, "Time_End": 132.06, "Text": " This is basically a switch router, so you have a switch and you basically can say these and that port is now going to be a router."}, {"Time_Start": 132.06, "Time_End": 143.06, "Text": " And, well, to sum it up, the vulnerabilities to God, if you do anything for management, you better have TCP IP working, right?"}, {"Time_Start": 143.06, "Time_End": 148.04, "Text": " So this being an embedded system, you do like,"}, {"Time_Start": 148.06, "Time_End": 154.7, "Text": " 10 connections or you complete 10 TCP handshakes to any given service that you use for"}, {"Time_Start": 154.7, "Time_End": 158.82, "Text": " management, let's say it's Telnet or SSH, and that's about it."}, {"Time_Start": 158.82, "Time_End": 163.06, "Text": " Nobody else is going to do that anymore."}, {"Time_Start": 163.06, "Time_End": 168.18, "Text": " The same thing on the switch ports that are not assigned to a router."}, {"Time_Start": 168.18, "Time_End": 173.98000000000002, "Text": " They use this very advanced technique for calculating initial sequence numbers for TCP"}, {"Time_Start": 173.98000000000002, "Time_End": 177.06, "Text": " that's known as the 64K rule."}, {"Time_Start": 177.06, "Time_End": 183.06, "Text": " So NMET will actually tell you it's a piece of crap and it's easy to hijack."}, {"Time_Start": 183.06, "Time_End": 187.06, "Text": " So, well, when you unpack the box, it is a switch."}, {"Time_Start": 187.06, "Time_End": 191.06, "Text": " So as soon someone telnet's there, you can hijack the connection easily."}, {"Time_Start": 191.06, "Time_End": 195.06, "Text": " And also, of course, it does OSPF."}, {"Time_Start": 195.06, "Time_End": 199.06, "Text": " For those of you guys to talk to years ago,"}, {"Time_Start": 199.06, "Time_End": 205.06, "Text": " you know that OSPF is quite useful and you can do lots of things with it."}, {"Time_Start": 205.06, "Time_End": 207.06, "Text": " The bad thing is,"}, {"Time_Start": 207.06, "Time_End": 209.82, "Text": " Lenders tend to read RFCs incompletely."}, {"Time_Start": 209.82, "Time_End": 214.3, "Text": " So they actually read the part that told them how to build the packets for OSPF,"}, {"Time_Start": 214.3, "Time_End": 218.1, "Text": " but they didn't read the part that told them how to make OSPF work."}, {"Time_Start": 218.1, "Time_End": 221.72, "Text": " So you just sit there and flot it with OSPF hello messages,"}, {"Time_Start": 221.72, "Time_End": 227.1, "Text": " which basically means, here's a new router, here's the next new router, here's the next new router."}, {"Time_Start": 227.1, "Time_End": 230.6, "Text": " And instead of validating that first and then tell everyone else,"}, {"Time_Start": 230.6, "Time_End": 234.18, "Text": " it will tell everyone else in the network right away."}, {"Time_Start": 234.18, "Time_End": 237.04, "Text": " Which translates to all you need is one of those."}, {"Time_Start": 237.06, "Time_End": 243.42000000000002, "Text": " boxes in your OSPF network and it will actually kill the whole network for you."}, {"Time_Start": 243.42000000000002, "Time_End": 249.54, "Text": " And well, to make a long story short, last year I said if you got an embedded system and it got"}, {"Time_Start": 249.54, "Time_End": 253.5, "Text": " port 80 TCP open, you can bet your assets vulnerable."}, {"Time_Start": 253.5, "Time_End": 256.34000000000003, "Text": " So same holds true for the matrix."}, {"Time_Start": 256.34000000000003, "Time_End": 262.58, "Text": " Which answers the question, how to hack the matrix, use HTTP."}, {"Time_Start": 262.58, "Time_End": 265.5, "Text": " Okay, GSM Basics."}, {"Time_Start": 265.5, "Time_End": 266.62, "Text": " The global system for mobile companies."}, {"Time_Start": 266.62, "Time_End": 277.02, "Text": " mobile communication, GSM, is actually used for quite a while and was standardized by the ETSI."}, {"Time_Start": 277.02, "Time_End": 283.54, "Text": " In contrast to the mobile networks you got here, usually, there is a very specific difference"}, {"Time_Start": 283.54, "Time_End": 289.4, "Text": " between what they call the terminal equipment and everyone else calls a phone and the SIM card"}, {"Time_Start": 289.4, "Time_End": 293.74, "Text": " that is actually a smart chip handling all your information."}, {"Time_Start": 294.58, "Time_End": 296.6, "Text": " You use the SIM card."}, {"Time_Start": 296.62, "Time_End": 302.18, "Text": " to authenticate the key material on the SIM card to authenticate and to use your caller"}, {"Time_Start": 302.18, "Time_End": 310.08, "Text": " ID and other IDs to authenticate. The phone does not matter. The GSM core networks actually"}, {"Time_Start": 310.08, "Time_End": 316.52, "Text": " rely on this information to find out who you are and actually build you for the service they provide."}, {"Time_Start": 316.52, "Time_End": 323.86, "Text": " So lots of people have tried to do caller ID spoofing and other stuff with GSM. Some succeeded"}, {"Time_Start": 323.86, "Time_End": 325.54, "Text": " in very limited environments."}, {"Time_Start": 325.54, "Time_End": 326.6, "Text": " But in just,"}, {"Time_Start": 326.62, "Time_End": 333.34000000000003, "Text": " general, it's all fine and all good. Which actually changes. It changes with what's known"}, {"Time_Start": 333.34000000000003, "Time_End": 340.58, "Text": " as GPRS, the general packet radio service. Well, this service now is pretty much like the internet"}, {"Time_Start": 340.58, "Time_End": 346.72, "Text": " was compared to least line services. So you had, in the beginning of networking, you had"}, {"Time_Start": 346.72, "Time_End": 351.48, "Text": " least line services and direct connections, and then someone came up with the internet thingy and"}, {"Time_Start": 351.48, "Time_End": 356.6, "Text": " all the packet forwarding crap, and all hell broke loose. Same here."}, {"Time_Start": 356.62, "Time_End": 360.76, "Text": " So this is actually packet services for mobile phones."}, {"Time_Start": 360.76, "Time_End": 365.2, "Text": " So you can serve web faster and do all kinds of stuff with it."}, {"Time_Start": 365.78000000000003, "Time_End": 369.58, "Text": " And consequently, the whole backbone infrastructure is running on IPV4."}, {"Time_Start": 371.02, "Time_End": 373.68, "Text": " Now, authentication is a bit different here."}, {"Time_Start": 374.6, "Time_End": 380.4, "Text": " If you want to find out which network you're talking to, you use the APN, the access point name."}, {"Time_Start": 380.96, "Time_End": 386.32, "Text": " This is something you transmit to the GSM network, and it will figure out on which side you will"}, {"Time_Start": 386.32, "Time_End": 393.71999999999997, "Text": " pop up. So that does not have to be the internet or a VAP gateway. And then optionally,"}, {"Time_Start": 394.2, "Time_End": 398.88, "Text": " you got PPP running over that, giving you IP addresses, and of course doing this chat,"}, {"Time_Start": 398.88, "Time_End": 402.76, "Text": " pat thingy, find out who you are if you got to write username and password."}, {"Time_Start": 404.36, "Time_End": 414.76, "Text": " APNs. You should actually think of an APN as a URL. It is quite similar, actually, because"}, {"Time_Start": 414.76, "Time_End": 419.62, "Text": " you give it a name and it will tell you which network you're talking to in"}, {"Time_Start": 419.62, "Time_End": 427.59999999999997, "Text": " contrast to a real URL telling you which server you're talking to. So the same"}, {"Time_Start": 427.59999999999997, "Time_End": 435.92, "Text": " thing in full color. What you got here is actually a very basic, well, yeah, very"}, {"Time_Start": 435.92, "Time_End": 440.86, "Text": " basic picture of a GSM network. You got the guy here being the mobile phone"}, {"Time_Start": 440.86, "Time_End": 444.74, "Text": " talking to the PLM and which is the public land mobile network. Everyone else just"}, {"Time_Start": 444.76, "Time_End": 450.02, "Text": " just stays the mobile network. You got the HLR, which is the home location register,"}, {"Time_Start": 450.14, "Time_End": 457.42, "Text": " and you can actually think of it as a huge fucking database. Often it runs Oracle. If you roam,"}, {"Time_Start": 457.52, "Time_End": 463.88, "Text": " there is another thing that's called the visitor location register. And the HLR actually holds"}, {"Time_Start": 463.88, "Time_End": 469.36, "Text": " all the information about you and your credentials and where you're supposed to do and what you're not"}, {"Time_Start": 469.36, "Time_End": 474.52, "Text": " supposed to do. Then you've got the SGS and a GGS. The SGS ends, the SGS ends, the SGS ends are the"}, {"Time_Start": 474.52, "Time_End": 482.28, "Text": " serving GPRS support node and GGSN gateway GPRS support node. Think of the GGSN as a backbone"}, {"Time_Start": 482.28, "Time_End": 490.88, "Text": " router and the SGSN as the one actually talking to the HLR and forwarding this stuff. So it's pretty"}, {"Time_Start": 490.88, "Time_End": 495.96, "Text": " much like a framework-line network. And of course you've got more than one GGSN. So you've"}, {"Time_Start": 495.96, "Time_End": 502.03999999999996, "Text": " got one facing the internet. You've got others facing company dedicated networks. So big companies"}, {"Time_Start": 502.03999999999996, "Time_End": 504.35999999999996, "Text": " go there and say, okay, you're doing GPRS."}, {"Time_Start": 504.52000000000004, "Time_End": 510.8, "Text": " That is quite useful. So you got, let's say you got any kind of logistics company like"}, {"Time_Start": 510.8, "Time_End": 516.64, "Text": " UPS or FedEx, and they got what I call the oversized Game Boys, where you're supposed to sign"}, {"Time_Start": 516.64, "Time_End": 522.3000000000001, "Text": " on. These devices have to talk back and actually make sure that, well, you signed and the package"}, {"Time_Start": 522.3000000000001, "Time_End": 528.96, "Text": " was delivered. And, well, that's quite easy for them to actually order GPRS services, request"}, {"Time_Start": 528.96, "Time_End": 534.5, "Text": " an APN, and every time those devices have to talk to the network, they open the APN, say,"}, {"Time_Start": 534.52, "Time_End": 541.6, "Text": " this is where I want to talk to. And now, they end up being in the UPS internal network"}, {"Time_Start": 541.6, "Time_End": 549.54, "Text": " instead of the internet. Of course, nobody prevents you from doing the same. So GPRS attack"}, {"Time_Start": 549.54, "Time_End": 556.78, "Text": " points. First, the GGSN, as I said, is just another IPV4 device. At stake actually figured that out."}, {"Time_Start": 557.48, "Time_End": 564.38, "Text": " They had a Nokia GPS box hanging off the internet, and they actually found a vulnerability there."}, {"Time_Start": 564.52, "Time_End": 571.56, "Text": " something totally simple, like a special TCP option. So you can actually expect a lot of"}, {"Time_Start": 571.56, "Time_End": 578.34, "Text": " stuff going on with those, especially on the networks that face not the internet, but some company"}, {"Time_Start": 578.34, "Time_End": 587.88, "Text": " networks. And the scary thing here is Cisco also does GGSNs. Now, APNs can actually be"}, {"Time_Start": 587.88, "Time_End": 594.04, "Text": " gas. They're not considered a secret. It's like the URL. So most of the APNs are actually either"}, {"Time_Start": 594.04, "Time_End": 600.0999999999999, "Text": " the URL of the company's homepage or the company name. So you can just go ahead and try it."}, {"Time_Start": 600.54, "Time_End": 607.0999999999999, "Text": " I did that in Germany, and it turned out that lots of major companies actually have their company name"}, {"Time_Start": 607.0999999999999, "Time_End": 613.02, "Text": " as APN, and you get asked for a username and password via PPP. And of course, this being a large"}, {"Time_Start": 613.02, "Time_End": 618.68, "Text": " user base, you often find usernames and passwords called test and test, and yeah, you know how that works."}, {"Time_Start": 620.5999999999999, "Time_End": 624.02, "Text": " So the thing here is, you can actually do APN filet."}, {"Time_Start": 624.04, "Time_End": 630.66, "Text": " during an HLR, but no provider does it. For a simple design failure reason. You can only"}, {"Time_Start": 630.66, "Time_End": 637.8, "Text": " say that a user account is allowed to do all APNs he wants or a limited list. Now that would"}, {"Time_Start": 637.8, "Time_End": 642.5999999999999, "Text": " be pretty bad for the database if they had to write that down into the database for 22 million"}, {"Time_Start": 642.5999999999999, "Time_End": 649.4399999999999, "Text": " customers. So they don't say that. They just say everyone can go to whatever APN he wants."}, {"Time_Start": 649.4399999999999, "Time_End": 654.02, "Text": " And yeah, the GGSN were the authentication"}, {"Time_Start": 654.04, "Time_End": 659.0799999999999, "Text": " servers, radio servers hanging off that during the authentication. And with a large"}, {"Time_Start": 659.0799999999999, "Time_End": 665.54, "Text": " username and actually a user account database, you sure as hell find weak passwords."}, {"Time_Start": 669.54, "Time_End": 676.54, "Text": " So, but there's actually more to it. So if you happen to have for whatever reason, maybe for"}, {"Time_Start": 676.54, "Time_End": 684.02, "Text": " staying at DefCon or talking to some guys, you happen to have one single computer in"}, {"Time_Start": 684.04, "Time_End": 690.04, "Text": " a mobile phone provider's network. It can be the secretary's Windows PC or whatever."}, {"Time_Start": 690.04, "Time_End": 697.04, "Text": " You can actually do quite some interesting stuff. There is the GPRS tunneling protocol GTP."}, {"Time_Start": 697.04, "Time_End": 701.04, "Text": " It's standardized here for everyone who loves to read boring documents."}, {"Time_Start": 701.04, "Time_End": 705.04, "Text": " You can actually get that off the ETSI webpage."}, {"Time_Start": 705.04, "Time_End": 714.02, "Text": " The protocol is actually designed to transport user data and control data via IPV4 in a GPRS"}, {"Time_Start": 714.04, "Time_End": 721.04, "Text": " and is also used in UMTS backbone, so the third generation that you didn't even hear of."}, {"Time_Start": 721.04, "Time_End": 727.04, "Text": " The protocol can control pretty much everything in the network."}, {"Time_Start": 727.04, "Time_End": 732.04, "Text": " This includes setting up modifying tunnels, connections, data transfer path."}, {"Time_Start": 732.04, "Time_End": 736.04, "Text": " You can modify the VPN access for an active subscriber."}, {"Time_Start": 736.04, "Time_End": 739.04, "Text": " You control how they roam."}, {"Time_Start": 739.04, "Time_End": 742.04, "Text": " And of course, you control how the accounting works."}, {"Time_Start": 742.04, "Time_End": 743.04, "Text": " Now, but you control how the accounting works."}, {"Time_Start": 743.04, "Time_End": 744.02, "Text": " Now, but"}, {"Time_Start": 744.04, "Time_End": 748.54, "Text": " both the control connections and the user data are ran over the same protocol."}, {"Time_Start": 748.54, "Time_End": 751.04, "Text": " So we're talking about all the same thing."}, {"Time_Start": 751.04, "Time_End": 756.04, "Text": " Now, the most funny thing is actually already on like the fifth page of the standard,"}, {"Time_Start": 756.04, "Time_End": 760.04, "Text": " because it says that every device, SGSN and GGSN,"}, {"Time_Start": 760.04, "Time_End": 764.04, "Text": " is supposed to support this protocol, including version zero."}, {"Time_Start": 764.04, "Time_End": 769.04, "Text": " So what they did was actually they standardized their inability to fix the protocol."}, {"Time_Start": 769.04, "Time_End": 774.04, "Text": " Because, well, even if they come up with a new version,"}, {"Time_Start": 774.04, "Time_End": 777.4399999999999, "Text": " that isn't so screwed as the one we're now talking about."}, {"Time_Start": 777.9399999999999, "Time_End": 780.8399999999999, "Text": " The devices are supposed to support the screwed version."}, {"Time_Start": 781.64, "Time_End": 782.78, "Text": " And this is in the standard."}, {"Time_Start": 783.0999999999999, "Time_End": 785.0999999999999, "Text": " I would say that was not a good move."}, {"Time_Start": 787.8199999999999, "Time_End": 790.16, "Text": " So what's it all about?"}, {"Time_Start": 790.24, "Time_End": 791.12, "Text": " What's the cool about it?"}, {"Time_Start": 792.3399999999999, "Time_End": 795.04, "Text": " This is in protocol running over IP,"}, {"Time_Start": 795.24, "Time_End": 796.86, "Text": " so we're quite familiar with it, right?"}, {"Time_Start": 797.98, "Time_End": 801.4399999999999, "Text": " It runs on UDP, which enables us to spoof."}, {"Time_Start": 802.06, "Time_End": 803.54, "Text": " It has no authentication."}, {"Time_Start": 804.04, "Time_End": 811.04, "Text": " You can create, update, or delete user contextes to your lightning with one UDP packet."}, {"Time_Start": 811.04, "Time_End": 816.04, "Text": " You can modify or remove billing information with one UDP packet."}, {"Time_Start": 816.04, "Time_End": 821.04, "Text": " You can actually reroute traffic and redirect traffic over the backbone."}, {"Time_Start": 821.04, "Time_End": 824.04, "Text": " Guess what? One UDP packet."}, {"Time_Start": 824.04, "Time_End": 828.04, "Text": " You can actually invite people into VPNs."}, {"Time_Start": 828.04, "Time_End": 833.04, "Text": " So you've got one of those boxes, and you got a friend who got a GPRS phone."}, {"Time_Start": 833.04, "Time_End": 834.04, "Text": " You can actually invite people into VPNs."}, {"Time_Start": 834.04, "Time_End": 839.04, "Text": " invite him actively to one of the company VPNs, one UDP packet."}, {"Time_Start": 839.04, "Time_End": 843.04, "Text": " And of course, you can force people to roam."}, {"Time_Start": 843.04, "Time_End": 847.04, "Text": " Roaming is handled by GDP between the SGSNs."}, {"Time_Start": 847.04, "Time_End": 853.04, "Text": " So I was actually wondering why there isn't someone, maybe I do it,"}, {"Time_Start": 853.04, "Time_End": 859.04, "Text": " starting a company as a mobile phone provider and just having one SGSN"}, {"Time_Start": 859.04, "Time_End": 863.04, "Text": " and constantly sending out UDP packets and make all the users roam over you."}, {"Time_Start": 863.04, "Time_End": 870.04, "Text": " you, which I think is a good business concept, but it wasn't declared as such in the standard."}, {"Time_Start": 870.04, "Time_End": 880.04, "Text": " The fun thing is how they dealt with security is this. They say, we're ETSI, we're doing GSM."}, {"Time_Start": 880.04, "Time_End": 889.04, "Text": " So we don't care about IP. Someone else is going to make IP secure, period, and a statement."}, {"Time_Start": 889.04, "Time_End": 892.04, "Text": " Okay, assumed you do not have a computer in a mobile phone network."}, {"Time_Start": 892.04, "Time_End": 894.04, "Text": " in a mobile phone network."}, {"Time_Start": 894.04, "Time_End": 897.04, "Text": " And of course, most of you are not supposed to have one."}, {"Time_Start": 897.04, "Time_End": 901.04, "Text": " There is other stuff you can actually do with GPRS and Bob."}, {"Time_Start": 901.04, "Time_End": 904.04, "Text": " This is anonymous HTTP."}, {"Time_Start": 904.04, "Time_End": 909.04, "Text": " The good thing here is a lot of people, especially at this conference,"}, {"Time_Start": 909.04, "Time_End": 916.04, "Text": " have certain interest in doing HTTP without revealing their real IP address to the server they're talking to."}, {"Time_Start": 916.04, "Time_End": 921.04, "Text": " Those reasons might include something like Unicode or web applications."}, {"Time_Start": 921.04, "Time_End": 926.04, "Text": " or other overflows that you might find in Port 80 applications."}, {"Time_Start": 926.04, "Time_End": 929.04, "Text": " So how do you do that?"}, {"Time_Start": 929.04, "Time_End": 933.04, "Text": " The WAP protocol is actually the vehicle to go for."}, {"Time_Start": 933.04, "Time_End": 937.04, "Text": " You have the wireless transport protocol and the wireless session protocol."}, {"Time_Start": 937.04, "Time_End": 942.04, "Text": " The wireless transport protocol is used to do basic transport stuff."}, {"Time_Start": 942.04, "Time_End": 946.04, "Text": " The wireless session protocol is actually the one doing a session over the UDP"}, {"Time_Start": 946.04, "Time_End": 950.04, "Text": " stuff you talk on the air interface to your mobile network."}, {"Time_Start": 950.04, "Time_End": 952.04, "Text": " mobile network."}, {"Time_Start": 952.04, "Time_End": 957.04, "Text": " Now, this is used to actually talk to something that's called a WAP gateway."}, {"Time_Start": 957.04, "Time_End": 964.04, "Text": " The WAP gateway is supposed to work as a proxy both in protocol terms and in HTTP terms."}, {"Time_Start": 964.04, "Time_End": 971.04, "Text": " It will accept UDP on one side, which is your phone, and it will talk TCP to the other,"}, {"Time_Start": 971.04, "Time_End": 980.02, "Text": " and it will grab down the webpages you asked for, do something that they call compiling, which basically means take an HDP"}, {"Time_Start": 980.04, "Time_End": 987.04, "Text": " or in this case WML tags, make them non-tax, so compile them in one binary"}, {"Time_Start": 987.04, "Time_End": 991.04, "Text": " format, so it's smaller, and send it to your phone."}, {"Time_Start": 991.04, "Time_End": 998.04, "Text": " So WSP in the default setting that your phones use is a connection over UDP,"}, {"Time_Start": 998.04, "Time_End": 1003.04, "Text": " so it got actually numbers to track the connection and the session,"}, {"Time_Start": 1003.04, "Time_End": 1009.04, "Text": " which you compare for those of you who know DNS and the DNS IDs for packets, for requests."}, {"Time_Start": 1009.04, "Time_End": 1010.04, "Text": " This is pretty much."}, {"Time_Start": 1010.0400000000001, "Time_End": 1016.0400000000001, "Text": " the same idea here. Now, an often overlooked fact is that actually the standard says there"}, {"Time_Start": 1016.0400000000001, "Time_End": 1025.04, "Text": " is a way to do connectionless WSP. Connectionized WSP means you're not setting up a connection."}, {"Time_Start": 1025.04, "Time_End": 1032.04, "Text": " You just send the HTTP request to the WAP Gateway. This has several advantages."}, {"Time_Start": 1032.04, "Time_End": 1039.04, "Text": " First of all, you can tell the Wab Gateway you're not really interested in the answer, which means it's not going to send one."}, {"Time_Start": 1039.04, "Time_End": 1046.04, "Text": " one. The second thing is, this being UDP, of course, we can easily spoof again."}, {"Time_Start": 1046.04, "Time_End": 1056.04, "Text": " Which now means we're actually giving the company, the mobile phone company money by using GPRS."}, {"Time_Start": 1056.04, "Time_End": 1061.04, "Text": " But we're actually not using our own source IP address, but someone else's."}, {"Time_Start": 1061.04, "Time_End": 1066.04, "Text": " And this is quite okay. The Web Gateway does not filter that usually."}, {"Time_Start": 1066.04, "Time_End": 1068.04, "Text": " I have not seen the Web Gateway or any other device."}, {"Time_Start": 1068.04, "Time_End": 1072.04, "Text": " or any other device in a mobile network that will actually detect spoofing."}, {"Time_Start": 1072.04, "Time_End": 1075.04, "Text": " But they might exist. Correct me if I'm wrong."}, {"Time_Start": 1075.04, "Time_End": 1080.04, "Text": " So you actually got anonymous HTTP request capabilities."}, {"Time_Start": 1080.04, "Time_End": 1087.04, "Text": " And to make it nice and have a little drop of sugar on top of it, it's built to someone else."}, {"Time_Start": 1087.04, "Time_End": 1094.04, "Text": " You just find out which IP addresses are used, which of course you do with this ICMP sending utility called ping."}, {"Time_Start": 1094.04, "Time_End": 1097.04, "Text": " And then you use their IP addresses."}, {"Time_Start": 1097.04, "Time_End": 1104.04, "Text": " So not only is your HTTP-based attack anonymous, but someone else is going to pay for it."}, {"Time_Start": 1104.04, "Time_End": 1110.04, "Text": " So this is the summary how to do that in case you want to try that at home."}, {"Time_Start": 1110.04, "Time_End": 1116.04, "Text": " The good thing is you don't actually need to have a phone."}, {"Time_Start": 1116.04, "Time_End": 1119.04, "Text": " There are open web gateways in the Internet."}, {"Time_Start": 1119.04, "Time_End": 1126.04, "Text": " So you can actually look for UDP port 9,200 and well then apply your responsible."}, {"Time_Start": 1126.04, "Time_End": 1136.04, "Text": " responsible procedure in dealing with new ways of exploiting things."}, {"Time_Start": 1136.04, "Time_End": 1145.04, "Text": " Yeah, I had a certain problem with an NDA here, so I just wanted to make sure that this is covered in the slides."}, {"Time_Start": 1145.04, "Time_End": 1148.04, "Text": " Go make me drunk."}, {"Time_Start": 1148.04, "Time_End": 1154.04, "Text": " Okay, from the backbone to the actual devices, this is the thing we're talking about."}, {"Time_Start": 1154.04, "Time_End": 1155.04, "Text": " The Siemens S55."}, {"Time_Start": 1155.04, "Time_End": 1163.04, "Text": " 55. Now, there are lots of smart people actually dealing with PDA-sized phones and other,"}, {"Time_Start": 1163.04, "Time_End": 1170.04, "Text": " yeah, the new generation stuff that runs Symbianos, and I'm not really smart enough to compete with them."}, {"Time_Start": 1170.04, "Time_End": 1177.04, "Text": " So we had a different reason looking at that one, simple for the reason was we had it."}, {"Time_Start": 1177.04, "Time_End": 1182.04, "Text": " And those semi-smartphones, as I call them, are very widespread use."}, {"Time_Start": 1182.04, "Time_End": 1184.04, "Text": " It's like the camera phones and MMS crap."}, {"Time_Start": 1184.04, "Time_End": 1190.04, "Text": " S-crap and Java applications, and so we picked actually one to play with it."}, {"Time_Start": 1190.04, "Time_End": 1193.04, "Text": " It got Bluetooth."}, {"Time_Start": 1193.04, "Time_End": 1198.04, "Text": " So what's bad about the Bluetooth implementation here is every time you start a connection,"}, {"Time_Start": 1198.04, "Time_End": 1202.04, "Text": " it will, of course, ask you if you want to pair with this device."}, {"Time_Start": 1202.04, "Time_End": 1203.04, "Text": " This is fine."}, {"Time_Start": 1203.04, "Time_End": 1207.04, "Text": " Well, if you start the next connection, it will ask you again."}, {"Time_Start": 1207.04, "Time_End": 1212.04, "Text": " So you open about 100 connections and it will have 100 message boxes on the screen."}, {"Time_Start": 1212.04, "Time_End": 1214.04, "Text": " That thing is, there is not be a next connection."}, {"Time_Start": 1214.04, "Time_End": 1220.04, "Text": " being Windows, you don't see that those are multiple message boxes lying on top of each other."}, {"Time_Start": 1220.04, "Time_End": 1225.04, "Text": " So you acknowledge one or dismiss one, and it still looks the same."}, {"Time_Start": 1225.04, "Time_End": 1227.04, "Text": " You have no idea what's going on."}, {"Time_Start": 1227.04, "Time_End": 1233.04, "Text": " And, well, the same problem actually holds true for the connection,"}, {"Time_Start": 1233.04, "Time_End": 1237.04, "Text": " well, say, the connection resources in the phone."}, {"Time_Start": 1237.04, "Time_End": 1239.04, "Text": " So you do more connect to it."}, {"Time_Start": 1239.04, "Time_End": 1244.02, "Text": " At some point in time, it's so busy waiting for the user to acknowledge or"}, {"Time_Start": 1244.04, "Time_End": 1250.04, "Text": " dismiss this pairing that it doesn't have any connections left. So if this guy had a headset"}, {"Time_Start": 1250.04, "Time_End": 1255.04, "Text": " or anything else actually working with the phone, this changed. It's no longer working."}, {"Time_Start": 1255.04, "Time_End": 1261.04, "Text": " And all you need is something that's called an L2 ping. It's just a layer 2 kind of ping."}, {"Time_Start": 1261.04, "Time_End": 1263.04, "Text": " So that's quite easy."}, {"Time_Start": 1263.04, "Time_End": 1268.04, "Text": " The big inbox is something I really like to do in airport lounges."}, {"Time_Start": 1268.04, "Time_End": 1274.02, "Text": " You got all the executives with their little nice phones and, well, everything they do is like they"}, {"Time_Start": 1274.04, "Time_End": 1278.04, "Text": " get the phone, they set a new background picture and turn on every possible feature."}, {"Time_Start": 1278.04, "Time_End": 1288.04, "Text": " So the thing is the S55 accepts whatever files you send to and puts it in a directory saying incoming data."}, {"Time_Start": 1288.04, "Time_End": 1295.04, "Text": " Now it is quite easy and not really time consuming to send 2,100 files."}, {"Time_Start": 1295.04, "Time_End": 1301.04, "Text": " Unfortunately, it is quite time consuming to delete 2,100 files on your phone."}, {"Time_Start": 1301.04, "Time_End": 1304.02, "Text": " Because they actually got a function that's actually"}, {"Time_Start": 1304.04, "Time_End": 1312.04, "Text": " called delete all, but this function seems to use a counter for what all actually means that is bite-sized."}, {"Time_Start": 1312.04, "Time_End": 1323.04, "Text": " So you can actually delete 255 files at the same time, but this is not going to win the race against the one sending the files."}, {"Time_Start": 1323.04, "Time_End": 1329.04, "Text": " And it is, by the way, quite annoying when they're on the phone because it keeps peeping."}, {"Time_Start": 1334.04, "Time_End": 1338.04, "Text": " that the vendors of the phones actually advertise is the whole Java stuff."}, {"Time_Start": 1338.04, "Time_End": 1342.04, "Text": " Well, if you remember last year, I hate Java."}, {"Time_Start": 1342.04, "Time_End": 1347.04, "Text": " But Java is actually supposed to be a secure programming language,"}, {"Time_Start": 1347.04, "Time_End": 1353.04, "Text": " and this is done by having exceptional circumstances in your program code"}, {"Time_Start": 1353.04, "Time_End": 1356.04, "Text": " manifest themselves as exceptions."}, {"Time_Start": 1356.04, "Time_End": 1359.04, "Text": " One of those exceptions is an out-pointer."}, {"Time_Start": 1359.04, "Time_End": 1362.04, "Text": " Well, another pointer exception shouldn't kill a Java virtual machine."}, {"Time_Start": 1362.04, "Time_End": 1363.04, "Text": " Actually, here it does."}, {"Time_Start": 1363.04, "Time_End": 1364.04, "Text": " here it does."}, {"Time_Start": 1364.04, "Time_End": 1372.04, "Text": " So everything that could possibly trigger a non-pointer exception, which often is just leaving out data,"}, {"Time_Start": 1372.04, "Time_End": 1375.04, "Text": " will result in what we call the widescreen of death."}, {"Time_Start": 1375.04, "Time_End": 1379.04, "Text": " Because as you see on a picture, this is how it looks like."}, {"Time_Start": 1379.04, "Time_End": 1383.04, "Text": " All you have to do is trigger a non-pointer exception, and we're going to show you how."}, {"Time_Start": 1383.04, "Time_End": 1387.04, "Text": " There is the thing called the Jod files."}, {"Time_Start": 1387.04, "Time_End": 1388.04, "Text": " Jod files are actually text files."}, {"Time_Start": 1388.04, "Time_End": 1392.04, "Text": " They're comparable to like INI files on Windows."}, {"Time_Start": 1392.04, "Time_End": 1395.04, "Text": " They're lying around on WAP servers."}, {"Time_Start": 1395.04, "Time_End": 1399.04, "Text": " So you serve WAP and it says download Java application,"}, {"Time_Start": 1399.04, "Time_End": 1403.04, "Text": " or it says click here, and you actually pull down a JAD file,"}, {"Time_Start": 1403.04, "Time_End": 1406.04, "Text": " and it figures out what the name of the Java application is,"}, {"Time_Start": 1406.04, "Time_End": 1410.04, "Text": " what size, where it comes from, what classes it needs, and stuff."}, {"Time_Start": 1410.04, "Time_End": 1414.04, "Text": " And of course, the name of the Java application is quite interesting"}, {"Time_Start": 1414.04, "Time_End": 1417.04, "Text": " because it wants to ask you if you want to install it or not."}, {"Time_Start": 1417.04, "Time_End": 1420.04, "Text": " And that's stored in the Midlet name."}, {"Time_Start": 1420.04, "Time_End": 1421.04, "Text": " Well, if the Midlet name is a name is."}, {"Time_Start": 1421.04, "Time_End": 1427.04, "Text": " If the midlet name is missing, you get what you see here, a widescreen of DAF."}, {"Time_Start": 1427.04, "Time_End": 1433.04, "Text": " So you can actually build web pages with evil Z-Men's links, which is quite funny."}, {"Time_Start": 1433.04, "Time_End": 1437.04, "Text": " But the other thing is even more funny."}, {"Time_Start": 1437.04, "Time_End": 1442.04, "Text": " I didn't find a way to exploit it, but that might be just the stupid me."}, {"Time_Start": 1442.04, "Time_End": 1444.04, "Text": " You have an overlong mid-led name."}, {"Time_Start": 1444.04, "Time_End": 1451.02, "Text": " So in case the user actually is stupid enough to acknowledge the installation of the Java application"}, {"Time_Start": 1451.04, "Time_End": 1459.04, "Text": " what happens is it will create a directory to put the Java application in."}, {"Time_Start": 1459.04, "Time_End": 1467.04, "Text": " So it passes the Java application name as a directory name to the core operating system."}, {"Time_Start": 1467.04, "Time_End": 1472.04, "Text": " Now there seems to be a limit, which means that if you have a normal name, that works well."}, {"Time_Start": 1472.04, "Time_End": 1480.04, "Text": " If you have an overlong name, it will actually overwrite the name of the file and some structures that are supposed to"}, {"Time_Start": 1480.04, "Time_End": 1483.04, "Text": " to, yeah, run the file system."}, {"Time_Start": 1483.04, "Time_End": 1486.04, "Text": " So you cannot delete this."}, {"Time_Start": 1486.04, "Time_End": 1490.04, "Text": " You actually have to flash the phone and remove all the data"}, {"Time_Start": 1490.04, "Time_End": 1492.04, "Text": " by, like, reformating the whole phone,"}, {"Time_Start": 1492.04, "Time_End": 1495.04, "Text": " which is the reason this little fucker here doesn't know any other ringtones"}, {"Time_Start": 1495.04, "Time_End": 1497.04, "Text": " than the default one anymore."}, {"Time_Start": 1501.04, "Time_End": 1507.04, "Text": " So, but even with the Java stuff, well, you can crash it,"}, {"Time_Start": 1507.04, "Time_End": 1509.04, "Text": " but you can actually do more."}, {"Time_Start": 1509.04, "Time_End": 1520.04, "Text": " SpyD. Jar. The idea actually is here that you can have some limited information pulled off the phone by Java applications."}, {"Time_Start": 1520.04, "Time_End": 1529.04, "Text": " Most phones will actually complain if a Java application tries to make a connection outgoing and send data."}, {"Time_Start": 1529.04, "Time_End": 1538.04, "Text": " Well, the Siemens doesn't. The Siemens just says, well, it does a tiny little beep, nobody really hears, and then lets you through."}, {"Time_Start": 1538.04, "Time_End": 1547.04, "Text": " And questions, which information can you get? In the standard Java classes, Java X and all the midlet stuff, there isn't any interesting."}, {"Time_Start": 1547.04, "Time_End": 1554.04, "Text": " But we got the company class trees, and of course Siemens got one, and they're growing every time."}, {"Time_Start": 1554.04, "Time_End": 1557.04, "Text": " This is the information from like today."}, {"Time_Start": 1557.04, "Time_End": 1560.04, "Text": " It might change with the next firmware and they got new classes."}, {"Time_Start": 1560.04, "Time_End": 1566.04, "Text": " But today you also can, you already can get the list of missed calls."}, {"Time_Start": 1566.04, "Time_End": 1575.04, "Text": " Now, the information what calls you missed and from which number they came can be quite interesting if it's sent to some external server."}, {"Time_Start": 1575.04, "Time_End": 1585.04, "Text": " And of course, you can also get the IMEI of the phone, so you can actually identify the phone correctly."}, {"Time_Start": 1585.04, "Time_End": 1589.04, "Text": " So we try that and you can have a Java application."}, {"Time_Start": 1589.04, "Time_End": 1593.04, "Text": " It could be a little game or whatever it is posing as."}, {"Time_Start": 1593.04, "Time_End": 1595.04, "Text": " And every time you play the game, it's actually telling us."}, {"Time_Start": 1595.04, "Time_End": 1601.04, "Text": " It's actually telling some web server in south of Russia, which calls you missed."}, {"Time_Start": 1601.04, "Time_End": 1604.04, "Text": " I don't think that's a good idea."}, {"Time_Start": 1604.04, "Time_End": 1613.04, "Text": " Time.Jar is very, very funny because it shows that Java does not necessarily prevent you from doing stupid things."}, {"Time_Start": 1613.04, "Time_End": 1621.04, "Text": " Sending an SMS or placing a call can be a costy thing, depending on where you call or where you send the SMS to."}, {"Time_Start": 1621.04, "Time_End": 1625.04, "Text": " I don't actually know if you got so-called value-ededded services."}, {"Time_Start": 1625.04, "Time_End": 1628.04, "Text": " SMS and MMS in the States already."}, {"Time_Start": 1628.04, "Time_End": 1631.04, "Text": " So where an SMS costs you about three bucks."}, {"Time_Start": 1631.04, "Time_End": 1635.04, "Text": " But we got quite a lot of them in Europe and guess what they're offering."}, {"Time_Start": 1635.04, "Time_End": 1643.04, "Text": " So normally it is supposed to actually ask you when a Java application will trigger"}, {"Time_Start": 1643.04, "Time_End": 1646.04, "Text": " the phone to call someone or send an SMS."}, {"Time_Start": 1646.04, "Time_End": 1651.04, "Text": " It is supposed to ask you and say, hey look, do you want to do that?"}, {"Time_Start": 1651.04, "Time_End": 1653.04, "Text": " But we got a little problem here."}, {"Time_Start": 1653.04, "Time_End": 1654.04, "Text": " This confirmation is done."}, {"Time_Start": 1654.04, "Time_End": 1657.04, "Text": " is done by a dialogue."}, {"Time_Start": 1657.04, "Time_End": 1661.04, "Text": " Now, Java, not being the fastest programming language in the world,"}, {"Time_Start": 1661.04, "Time_End": 1663.04, "Text": " has a timing issue here."}, {"Time_Start": 1663.04, "Time_End": 1666.04, "Text": " If you, before you try to send the SMS,"}, {"Time_Start": 1666.04, "Time_End": 1671.04, "Text": " actually fill the screen and do something else on it."}, {"Time_Start": 1671.04, "Time_End": 1673.04, "Text": " So to make that visual,"}, {"Time_Start": 1673.04, "Time_End": 1675.04, "Text": " this is what it is supposed to do."}, {"Time_Start": 1675.04, "Time_End": 1677.04, "Text": " For those who cannot read it, it says it's allowed"}, {"Time_Start": 1677.04, "Time_End": 1679.04, "Text": " sending SMS to whatever number."}, {"Time_Start": 1679.04, "Time_End": 1683.04, "Text": " And, well, you're supposed to press yes or no."}, {"Time_Start": 1683.04, "Time_End": 1684.04, "Text": " Due to the timing,"}, {"Time_Start": 1684.04, "Time_End": 1686.04, "Text": " problem, you can ask different questions,"}, {"Time_Start": 1686.04, "Time_End": 1688.04, "Text": " like would you like to play a game?"}, {"Time_Start": 1688.04, "Time_End": 1691.04, "Text": " I had the idea of actually using the two buttons"}, {"Time_Start": 1691.04, "Time_End": 1694.04, "Text": " that are supposed to say yes or no"}, {"Time_Start": 1694.04, "Time_End": 1697.04, "Text": " as a control in some jump and run game."}, {"Time_Start": 1697.04, "Time_End": 1702.04, "Text": " So you would actually press yes approximately 50 times,"}, {"Time_Start": 1702.04, "Time_End": 1708.04, "Text": " 50% of the time, and send about 1,000 SMS each three bucks."}, {"Time_Start": 1708.04, "Time_End": 1713.04, "Text": " The next thing we got"}, {"Time_Start": 1713.04, "Time_End": 1721.04, "Text": " The next thing we got here is something that is actually related to the whole MMS picture phone thingy."}, {"Time_Start": 1721.04, "Time_End": 1726.04, "Text": " Well, of course, to send pictures and do MMSs, you need to have image formats."}, {"Time_Start": 1726.04, "Time_End": 1731.04, "Text": " So the image format of choice here is GIF and JPEC."}, {"Time_Start": 1731.04, "Time_End": 1739.04, "Text": " Now, the GIF file format, as you all know, supports multiple frames for animated GIFs."}, {"Time_Start": 1739.04, "Time_End": 1742.04, "Text": " For that to be flexible, you got something in the file format."}, {"Time_Start": 1742.04, "Time_End": 1752.04, "Text": " in the file format that is called the virtual screen, which describes which area on the screen is actually covered by the sum of all frames in the gift file."}, {"Time_Start": 1752.04, "Time_End": 1763.04, "Text": " Now what you can do here is send a gift file that actually has in one of the frames offsetting in this virtual screen."}, {"Time_Start": 1763.04, "Time_End": 1765.04, "Text": " This is supported by the standard."}, {"Time_Start": 1765.04, "Time_End": 1771.04, "Text": " The good thing about that is, well, the virtual screen itself is not really supported by Siemens."}, {"Time_Start": 1771.04, "Time_End": 1772.04, "Text": " by Siemens."}, {"Time_Start": 1772.04, "Time_End": 1779.04, "Text": " So you're actually writing the gift data into some memory that is not displayed, but holds something different."}, {"Time_Start": 1779.04, "Time_End": 1786.04, "Text": " So if you actually open such a gift file or you get an MMS with it, your phone will crash."}, {"Time_Start": 1786.04, "Time_End": 1789.04, "Text": " It will crash and it will just go off."}, {"Time_Start": 1789.04, "Time_End": 1797.04, "Text": " It is very interesting, but you can make this permanent by placing this picture as a background image on the phone,"}, {"Time_Start": 1797.04, "Time_End": 1800.04, "Text": " which is pretty much the last thing you did with the phone."}, {"Time_Start": 1800.04, "Time_End": 1806.04, "Text": " Okay, enough of that crap."}, {"Time_Start": 1806.04, "Time_End": 1810.04, "Text": " I actually go and do some of the Cisco stuff."}, {"Time_Start": 1810.04, "Time_End": 1812.04, "Text": " This was not intended to be here,"}, {"Time_Start": 1812.04, "Time_End": 1817.04, "Text": " but since a lot of people were talking about the latest iOS bug"}, {"Time_Start": 1817.04, "Time_End": 1820.04, "Text": " where you could, like, deny of service a device,"}, {"Time_Start": 1820.04, "Time_End": 1823.04, "Text": " and actually some brilliant people sent very extensively"}, {"Time_Start": 1823.04, "Time_End": 1827.04, "Text": " explained IRC chatlocks to full disclosure,"}, {"Time_Start": 1827.04, "Time_End": 1829.04, "Text": " claiming this might be exploitable."}, {"Time_Start": 1829.04, "Time_End": 1830.04, "Text": " I thought."}, {"Time_Start": 1830.04, "Time_End": 1832.04, "Text": " are going to come in on it."}, {"Time_Start": 1832.04, "Time_End": 1837.04, "Text": " So the recently discovered bug is, for those of you who don't have email,"}, {"Time_Start": 1837.04, "Time_End": 1843.04, "Text": " that there is a way with metform packets to fill the input queue."}, {"Time_Start": 1843.04, "Time_End": 1846.04, "Text": " Now the question was, is this exploitable?"}, {"Time_Start": 1846.04, "Time_End": 1853.04, "Text": " Well, my question is, when you're stuck in a traffic jam, does that mean you control the traffic light?"}, {"Time_Start": 1853.04, "Time_End": 1860.02, "Text": " You can describe the bug as something like you have people checking in in Alexis Park, and you"}, {"Time_Start": 1860.04, "Time_End": 1867.04, "Text": " got like 75 people go into the front counter and then you kind of like kill the"}, {"Time_Start": 1867.04, "Time_End": 1871.04, "Text": " person behind the counter, which still doesn't mean you get their money."}, {"Time_Start": 1871.04, "Time_End": 1874.04, "Text": " So to answer the question, no, it's not exploitable."}, {"Time_Start": 1874.04, "Time_End": 1879.04, "Text": " But the good question would really be what is the problem?"}, {"Time_Start": 1879.04, "Time_End": 1883.04, "Text": " The problem here is that iOS is interrupt and message driven."}, {"Time_Start": 1883.04, "Time_End": 1889.04, "Text": " So the processes themselves are responsible for draining the cues, which obviously those four processes"}, {"Time_Start": 1889.04, "Time_End": 1891.04, "Text": " those four processes didn't do."}, {"Time_Start": 1891.04, "Time_End": 1897.04, "Text": " And, well, most processes in iOS, for what I know,"}, {"Time_Start": 1897.04, "Time_End": 1899.04, "Text": " do their own protocol pausing."}, {"Time_Start": 1899.04, "Time_End": 1903.04, "Text": " It means the IP header is actually parsed at a central place,"}, {"Time_Start": 1903.04, "Time_End": 1906.04, "Text": " but everything else is parsed each and every time"}, {"Time_Start": 1906.04, "Time_End": 1910.04, "Text": " in each and every process, whoever is responsible for it."}, {"Time_Start": 1910.04, "Time_End": 1913.04, "Text": " That means if you've got 100 types processes,"}, {"Time_Start": 1913.04, "Time_End": 1916.04, "Text": " 99 can do IP protocol pausing quite well,"}, {"Time_Start": 1916.04, "Time_End": 1918.04, "Text": " and one is totally fucked up."}, {"Time_Start": 1918.04, "Time_End": 1919.04, "Text": " And all you have done,"}, {"Time_Start": 1919.04, "Time_End": 1922.8, "Text": " to do is find the one."}, {"Time_Start": 1922.8, "Time_End": 1928.24, "Text": " So that obviously leads to the point can we expect more of that?"}, {"Time_Start": 1928.24, "Time_End": 1932.84, "Text": " I guess the simple and short answer is yes."}, {"Time_Start": 1932.84, "Time_End": 1937.2, "Text": " The bug is actually a design failure in my eyes."}, {"Time_Start": 1937.2, "Time_End": 1942.0, "Text": " iOS 123 is already out and it's already deferred."}, {"Time_Start": 1942.0, "Time_End": 1946.52, "Text": " And there are some specific protocols that are handled differently and have higher priorities"}, {"Time_Start": 1946.52, "Time_End": 1947.6, "Text": " and stuff."}, {"Time_Start": 1947.6, "Time_End": 1948.6, "Text": " So it's just a matter of time."}, {"Time_Start": 1948.6000000000001, "Time_End": 1954.7600000000002, "Text": " of time. The effects of the bug were not as bad as we thought because Cisco"}, {"Time_Start": 1954.7600000000002, "Time_End": 1959.16, "Text": " actually went to the background providers and towed them up front. Here is something"}, {"Time_Start": 1959.16, "Time_End": 1964.8000000000002, "Text": " major coming, so please figure that. And the bug actually was found Cisco"}, {"Time_Start": 1964.8000000000002, "Time_End": 1972.3000000000002, "Text": " internally, so they could do that, but what if the next bug is not? Well, at this point"}, {"Time_Start": 1972.3000000000002, "Time_End": 1978.5800000000002, "Text": " in time, here is the one finding the bug. He's the only one from the"}, {"Time_Start": 1978.6000000000001, "Time_End": 1984.6000000000001, "Text": " Cisco's dad team. I'm glad he is here. He didn't get credit in the advisory, so I wanted to give him credit here."}, {"Time_Start": 1988.6000000000001, "Time_End": 1993.6000000000001, "Text": " Okay, back two bucks that we found."}, {"Time_Start": 1993.6000000000001, "Time_End": 2001.6000000000001, "Text": " Cisco iOS 11 and X, 11X and below, there is the UDP Echo Service."}, {"Time_Start": 2001.6000000000001, "Time_End": 2008.5800000000002, "Text": " Now NASA is telling you, since ages, that the UDP Echo Service is bad because someone can do"}, {"Time_Start": 2008.6000000000001, "Time_End": 2013.72, "Text": " ping pong attacks on it. On Cisco, the UDP Echo service is actually worse."}, {"Time_Start": 2014.92, "Time_End": 2018.9800000000002, "Text": " Because they got a buck here that is, on first time, very small."}, {"Time_Start": 2019.6000000000001, "Time_End": 2026.1000000000001, "Text": " You look at it and you send the UDP Echo request packet, and in the UDP"}, {"Time_Start": 2026.1000000000001, "Time_End": 2030.7600000000002, "Text": " length, you actually say it's longer than you actually include the data off."}, {"Time_Start": 2031.0200000000002, "Time_End": 2036.2800000000002, "Text": " So you have one single character in the packet, but you say the packet was 100 bytes long."}, {"Time_Start": 2036.5600000000002, "Time_End": 2038.0400000000002, "Text": " You get 100 bytes answer."}, {"Time_Start": 2038.6000000000001, "Time_End": 2047.7400000000002, "Text": " Now, we tried and tried to look at how much data we actually can get back, and it ended up being something about 19K with one packet."}, {"Time_Start": 2048.94, "Time_End": 2052.48, "Text": " So that could be quite useful because that is I.O. memory."}, {"Time_Start": 2053.32, "Time_End": 2062.28, "Text": " I.O. memory is used on Cisco for handling all the crap that has something to do with the packets themselves and some limited routing information."}, {"Time_Start": 2063.96, "Time_End": 2068.58, "Text": " So we actually got comparable box in 12."}, {"Time_Start": 2068.6, "Time_End": 2077.2799999999997, "Text": " like the Cisco Express forwarding, that's a certain way of getting packets from A to B that Cisco uses."}, {"Time_Start": 2077.92, "Time_End": 2079.68, "Text": " I think it's now the standard setting."}, {"Time_Start": 2080.48, "Time_End": 2084.7999999999997, "Text": " This one had a comparable bug where the IP length was the trigger."}, {"Time_Start": 2085.3399999999997, "Time_End": 2087.1, "Text": " So there is more of it."}, {"Time_Start": 2087.2, "Time_End": 2088.64, "Text": " But back to the UDP Echo Service."}, {"Time_Start": 2088.74, "Time_End": 2089.54, "Text": " What can we do with it?"}, {"Time_Start": 2090.0, "Time_End": 2098.38, "Text": " Oh, no, here's something because people start complaining about finding box in 11 is useless because nobody uses 11."}, {"Time_Start": 2098.6, "Time_End": 2103.44, "Text": " This is a router actually live in the internet."}, {"Time_Start": 2103.96, "Time_End": 2104.8399999999997, "Text": " He found it."}, {"Time_Start": 2105.44, "Time_End": 2106.7799999999997, "Text": " It runs iOS 9."}, {"Time_Start": 2107.64, "Time_End": 2111.04, "Text": " Well, this one is not even a label on the Cisco FTP service anymore."}, {"Time_Start": 2112.2599999999998, "Time_End": 2115.06, "Text": " So people do update their routers once in a time."}, {"Time_Start": 2116.96, "Time_End": 2117.2, "Text": " Okay."}, {"Time_Start": 2117.54, "Time_End": 2126.46, "Text": " The UDP Echo Info Info league bug actually is quite useful because we can do reliable iOS fingerprinting."}, {"Time_Start": 2127.2599999999998, "Time_End": 2128.58, "Text": " In the past we've got the product."}, {"Time_Start": 2128.6, "Time_End": 2136.08, "Text": " problem that you got like 22,000 different iOS images sitting on Cisco and well,"}, {"Time_Start": 2136.08, "Time_End": 2141.48, "Text": " you don't know what the router you're targeting is running now you can because it contains"}, {"Time_Start": 2141.48, "Time_End": 2147.92, "Text": " block headers which contain addresses who allocated the block you got addresses of the"}, {"Time_Start": 2147.92, "Time_End": 2153.08, "Text": " allocating image allocating function which changed their image so you know which"}, {"Time_Start": 2153.08, "Time_End": 2158.58, "Text": " image it is and you got address ranges for I.O. memory and heat memory and those"}, {"Time_Start": 2158.6, "Time_End": 2164.2799999999997, "Text": " changed by platform. So you can fingerprint it. This is what you actually"}, {"Time_Start": 2164.2799999999997, "Time_End": 2170.9, "Text": " get back. You see you have the allocation stuff and the pointers we talked about last"}, {"Time_Start": 2170.9, "Time_End": 2175.52, "Text": " year. They're all platform specific but you also got the ring buffer information"}, {"Time_Start": 2175.52, "Time_End": 2183.14, "Text": " and the actual packets in the device. So question is can we and yes we can. There"}, {"Time_Start": 2183.14, "Time_End": 2188.58, "Text": " is of course the possibility of draining the router of memory"}, {"Time_Start": 2188.6, "Time_End": 2193.92, "Text": " leakage and actually gap 19k per packet bag and parsed that correctly so we came"}, {"Time_Start": 2193.92, "Time_End": 2198.8399999999997, "Text": " up with phenolid IOS sniff which is remote iOS sniffing you don't need any"}, {"Time_Start": 2198.8399999999997, "Time_End": 2203.96, "Text": " account you just need UDP echo what it does is actually pulling down the"}, {"Time_Start": 2203.96, "Time_End": 2211.58, "Text": " information parsing the memory block identify them identify the packet offset"}, {"Time_Start": 2211.58, "Time_End": 2217.94, "Text": " do the packet decoding and present you with a nice TCP dump like output so"}, {"Time_Start": 2217.94, "Time_End": 2223.76, "Text": " So this being the receive buffers, it's quite useful because, well, the router receives"}, {"Time_Start": 2223.76, "Time_End": 2230.7400000000002, "Text": " certain information, especially when people log in. So what you see here are the first two"}, {"Time_Start": 2230.7400000000002, "Time_End": 2236.7000000000003, "Text": " lines or three lines of stuff that actually is sent to the router when someone is telnetting"}, {"Time_Start": 2236.7000000000003, "Time_End": 2242.28, "Text": " to it. Well, the first lines he's probably sending are the passwords. So that's quite"}, {"Time_Start": 2242.28, "Time_End": 2247.44, "Text": " useful. But there is another bug."}, {"Time_Start": 2247.44, "Time_End": 2251.28, "Text": " Cisco has an HTTP service."}, {"Time_Start": 2251.38, "Time_End": 2256.9, "Text": " And as I said earlier, if you got an embedded system and it got a TCP port 80 open, it is vulnerable."}, {"Time_Start": 2257.86, "Time_End": 2259.2200000000003, "Text": " Well, Cisco is no exception."}, {"Time_Start": 2261.26, "Time_End": 2269.52, "Text": " The HTTP server on 11.x and 12 up to 122 has an integer overflow."}, {"Time_Start": 2270.12, "Time_End": 2273.48, "Text": " It unfortunately requires you to send two gigabytes of data."}, {"Time_Start": 2275.16, "Time_End": 2277.42, "Text": " But, well, I actually did a survey."}, {"Time_Start": 2277.44, "Time_End": 2282.52, "Text": " on people and say, is this bullshit or should we actually go ahead and see if we can exploit it?"}, {"Time_Start": 2282.88, "Time_End": 2286.44, "Text": " And most said, yeah, I don't care if I wait a week and I got root on a device, that's fine."}, {"Time_Start": 2288.52, "Time_End": 2294.44, "Text": " And since that is the stack-based overflow, and it might be quite interesting to do,"}, {"Time_Start": 2294.6, "Time_End": 2296.7200000000003, "Text": " because last year we did heap overflows, we did it."}, {"Time_Start": 2297.28, "Time_End": 2304.16, "Text": " So exploitation issues in the past for those who missed last year, we need server image-dependent"}, {"Time_Start": 2304.16, "Time_End": 2307.2000000000003, "Text": " information like previous pointers, size value and I.O."}, {"Time_Start": 2307.44, "Time_End": 2314.44, "Text": " stack location, location of the own code, which probably means you should already have"}, {"Time_Start": 2314.44, "Time_End": 2317.44, "Text": " a console connection to the router you're trying to hack."}, {"Time_Start": 2317.44, "Time_End": 2320.44, "Text": " And this isn't really practical."}, {"Time_Start": 2320.44, "Time_End": 2323.44, "Text": " So things change."}, {"Time_Start": 2323.44, "Time_End": 2327.44, "Text": " What we got now is the UDP Echo Memory League."}, {"Time_Start": 2327.44, "Time_End": 2332.44, "Text": " We see AETCA provided data, which is the UDP stuff you send there in the first place."}, {"Time_Start": 2332.44, "Time_End": 2336.44, "Text": " We have live iOS memory addresses."}, {"Time_Start": 2336.44, "Time_End": 2337.44, "Text": " The leaked memory blocker."}, {"Time_Start": 2337.44, "Time_End": 2338.44, "Text": " headers, if you remember."}, {"Time_Start": 2338.44, "Time_End": 2344.28, "Text": " And we have the ability to fill multiple memory locations because it's a ring buffer."}, {"Time_Start": 2344.28, "Time_End": 2346.6, "Text": " So we just send it multiple times."}, {"Time_Start": 2346.6, "Time_End": 2352.56, "Text": " And we got the HDP Overflow, which is a direct frame pointer overwrite and return address"}, {"Time_Start": 2352.56, "Time_End": 2353.28, "Text": " overwrite."}, {"Time_Start": 2353.28, "Time_End": 2357.76, "Text": " So it's straightforward to exploit."}, {"Time_Start": 2357.76, "Time_End": 2366.76, "Text": " So what we can do is we actually send four binary shell code there via the UDP echo bug."}, {"Time_Start": 2366.76, "Time_End": 2374.2000000000003, "Text": " On the response, we see where it ended up, and we can calculate the exact a address it is."}, {"Time_Start": 2374.6200000000003, "Time_End": 2379.38, "Text": " We also have no limitations on byte because UDP Echo doesn't care what it got in a payload."}, {"Time_Start": 2380.76, "Time_End": 2393.5600000000004, "Text": " We need actually to select a good address from those in the ring buffers, because if the router is not sitting in a phenolith lapse, it has probably something else to do, namely forwarding packets."}, {"Time_Start": 2394.28, "Time_End": 2396.7400000000002, "Text": " So it's using the ring buffers actually to do the"}, {"Time_Start": 2396.76, "Time_End": 2402.76, "Text": " job and we need to find a way to actually have a stable address where the"}, {"Time_Start": 2402.76, "Time_End": 2406.76, "Text": " shell code survived and is not overridden by other IP packets."}, {"Time_Start": 2406.76, "Time_End": 2410.76, "Text": " But, well, if we figure that out, we own the box."}, {"Time_Start": 2410.76, "Time_End": 2416.76, "Text": " So combined, we actually send the maximum URL length allowed by iOS."}, {"Time_Start": 2416.76, "Time_End": 2426.36, "Text": " Then we send two gigabytes of additional URL elements, which has a nice side effect because it keeps"}, {"Time_Start": 2426.36, "Time_End": 2432.1, "Text": " counting and counting the number of bytes received and compares it to the size of the buffer."}, {"Time_Start": 2432.5, "Time_End": 2438.54, "Text": " Now, after you send two gigabytes of data, this being assigned integer, the number of bytes received"}, {"Time_Start": 2438.54, "Time_End": 2439.9, "Text": " variable will be negative."}, {"Time_Start": 2440.54, "Time_End": 2445.86, "Text": " And this is smaller than the size of the buffer, so they can still copy it, which means they're"}, {"Time_Start": 2445.86, "Time_End": 2446.7400000000002, "Text": " overflowing the buffer."}, {"Time_Start": 2447.9, "Time_End": 2453.98, "Text": " Then after sending all the crap over there, we perform a UDP memory leak server times, so we get"}, {"Time_Start": 2453.98, "Time_End": 2455.0, "Text": " all the code addresses."}, {"Time_Start": 2455.0, "Time_End": 2461.0, "Text": " make an intelligent decision on which address to use, well, and complete the overflow."}, {"Time_Start": 2461.0, "Time_End": 2465.0, "Text": " For those of you who prefer, like, all in color, here it is."}, {"Time_Start": 2465.0, "Time_End": 2480.0, "Text": " HTTP Connect legalize URL, send lots of A's, do the UDP echo, get the info back, repeat until happy, send the overflow, own the box."}, {"Time_Start": 2480.0, "Time_End": 2482.0, "Text": " End of slide."}, {"Time_Start": 2485.0, "Time_End": 2493.5, "Text": " A problem we got here is, of course, the binary via HTTP."}, {"Time_Start": 2494.3, "Time_End": 2501.36, "Text": " We're overriding the return address, so HTTP doesn't really like characters like line feeds,"}, {"Time_Start": 2501.48, "Time_End": 2505.0, "Text": " character returns, slashes, zero bytes are obviously bad."}, {"Time_Start": 2506.0, "Time_End": 2514.44, "Text": " But we found out that the HTTP encoding, you know, the percent X, X, X, and stuff that everyone uses to screw up in their web servers."}, {"Time_Start": 2515.0, "Time_End": 2521.0, "Text": " is actually performed on the same buffer before the overflowed function returns."}, {"Time_Start": 2521.0, "Time_End": 2530.0, "Text": " So we can actually do overflow and use the HTTP encoding, so we can use arbitrary addresses, which made it even easier."}, {"Time_Start": 2530.0, "Time_End": 2536.0, "Text": " I said we need an intelligent address selection."}, {"Time_Start": 2536.0, "Time_End": 2543.0, "Text": " So what we are doing is there is service strategies, they are listed here, I'm running out of time, so I'll skip over and just tell you,"}, {"Time_Start": 2543.0, "Time_End": 2548.28, "Text": " tell you, use the second smallest address or the third smallest address is the best way to do."}, {"Time_Start": 2548.68, "Time_End": 2549.68, "Text": " You will see it in the code."}, {"Time_Start": 2551.26, "Time_End": 2552.2, "Text": " Now, shell code."}, {"Time_Start": 2552.6, "Time_End": 2555.94, "Text": " We had shell code in the past that overwrote a complete configuration,"}, {"Time_Start": 2556.38, "Time_End": 2561.92, "Text": " which unfortunately means you lose all the juicy info, like the passwords they use,"}, {"Time_Start": 2561.92, "Time_End": 2566.12, "Text": " and they're never, never going to use on any other router in their network."}, {"Time_Start": 2567.38, "Time_End": 2572.34, "Text": " And the routing information, access lists, all the stuff you could be interested in."}, {"Time_Start": 2573.0, "Time_End": 2579.5, "Text": " So we figured we need new shell code, and for that we actually did binary research on iOS."}, {"Time_Start": 2581.5, "Time_End": 2586.5, "Text": " iOS, Cisco actually supports serial debugging via GDP, but it sucks."}, {"Time_Start": 2587.34, "Time_End": 2596.48, "Text": " But they also got some debugging capability in the ROM monitor, which is comparable to what you have in your PC as a BIOS."}, {"Time_Start": 2597.0, "Time_End": 2599.22, "Text": " And so you can set breakpoints and do this assembly."}, {"Time_Start": 2599.82, "Time_End": 2602.98, "Text": " The cool thing here is code identification."}, {"Time_Start": 2603.0, "Time_End": 2609.16, "Text": " of the critical part of the huge chunk of code you got is quite simple because the"}, {"Time_Start": 2609.16, "Time_End": 2615.16, "Text": " string that is shown in a function is actually stored right next to the function in the text segment"}, {"Time_Start": 2615.16, "Time_End": 2621.56, "Text": " and that's before the function so all you do is turn on every possible debugging you can get"}, {"Time_Start": 2621.56, "Time_End": 2627.72, "Text": " and do whatever you wanted to find out and then look for the strings find them in the code"}, {"Time_Start": 2627.72, "Time_End": 2631.88, "Text": " disassemble the function after that and you got the function using those strings."}, {"Time_Start": 2633.0, "Time_End": 2638.0, "Text": " So equipped with this knowledge, we actually figured out we need new shell code,"}, {"Time_Start": 2638.0, "Time_End": 2641.0, "Text": " call it next generation code, whatever."}, {"Time_Start": 2641.0, "Time_End": 2645.0, "Text": " What we do is runtime iOS patching."}, {"Time_Start": 2645.0, "Time_End": 2651.0, "Text": " We actually teach the Cisco device to forget about certain functions it performed before,"}, {"Time_Start": 2651.0, "Time_End": 2653.0, "Text": " namely password validation."}, {"Time_Start": 2653.0, "Time_End": 2657.0, "Text": " So with the new shell code, you turn it to the device and it stops"}, {"Time_Start": 2657.0, "Time_End": 2661.0, "Text": " doing the annoying user authentication, give me the password stuff."}, {"Time_Start": 2661.0, "Time_End": 2662.0, "Text": " It just drops you on a user share."}, {"Time_Start": 2662.0, "Time_End": 2668.0, "Text": " drops you on a user shell. And of course, the same is possible for the enable password."}, {"Time_Start": 2668.0, "Time_End": 2675.0, "Text": " So it will actually ask you for the enable password when you say enable, but it will not validate the"}, {"Time_Start": 2675.0, "Time_End": 2681.0, "Text": " results. Of course, you can do other stuff. You could actually introduce something like"}, {"Time_Start": 2681.0, "Time_End": 2687.0, "Text": " forgetting about to check if the BGP neighbor I'm talking to is really the one I'm supposed to talk to."}, {"Time_Start": 2687.0, "Time_End": 2691.98, "Text": " Use your imagination. The problem here is, um,"}, {"Time_Start": 2692.0, "Time_End": 2694.0, "Text": " We have to keep iOS running."}, {"Time_Start": 2694.0, "Time_End": 2702.0, "Text": " Well, the overflow actually destroys lots of stuff on the heap because of the encoding we use."}, {"Time_Start": 2702.0, "Time_End": 2707.0, "Text": " We send 24 bytes and they end up being 8 bytes, but we destroyed a lot."}, {"Time_Start": 2707.0, "Time_End": 2715.0, "Text": " But the Motorola call structure actually saves frame pointer and stack pointer pretty comparable to the Intel ones."}, {"Time_Start": 2715.0, "Time_End": 2721.0, "Text": " And so all you need to do is search the stack upwards for information that was set upwards."}, {"Time_Start": 2721.0, "Time_End": 2728.0, "Text": " that was set there by a function preamble and use this information and do a clean return"}, {"Time_Start": 2728.0, "Time_End": 2735.0, "Text": " and better like clear the return information so it will actually return faults and nobody cares."}, {"Time_Start": 2735.0, "Time_End": 2739.0, "Text": " This is the code. I guess nobody can read it there."}, {"Time_Start": 2739.0, "Time_End": 2742.0, "Text": " It just finds the return and cleans."}, {"Time_Start": 2742.0, "Time_End": 2745.0, "Text": " Yeah, you can check it out on the slides later."}, {"Time_Start": 2745.0, "Time_End": 2748.0, "Text": " iOS runtime patching, advantage."}, {"Time_Start": 2748.0, "Time_End": 2751.0, "Text": " Of course, the router stays online."}, {"Time_Start": 2751.0, "Time_End": 2757.0, "Text": " doesn't reboot anymore. The configuration is preserved. So if you're interested in stuff like the passwords,"}, {"Time_Start": 2757.0, "Time_End": 2764.0, "Text": " they're so heavily encrypted with a password seven algorithm. And of course, it proves that what"}, {"Time_Start": 2764.0, "Time_End": 2771.0, "Text": " people talked about for years and years back during iOS runtime code is actually possible and quite easy."}, {"Time_Start": 2771.0, "Time_End": 2777.0, "Text": " Disadvantages, of course, it's depending on the image. So we got the image independence again."}, {"Time_Start": 2777.0, "Time_End": 2780.98, "Text": " You need therefore a large target list. And well, you actually, you actually,"}, {"Time_Start": 2781.0, "Time_End": 2790.0, "Text": " you got annoying messages on a console saying check-some error because it does check some the text segment and figures out that there is a problem."}, {"Time_Start": 2790.0, "Time_End": 2795.0, "Text": " But of course, we patched that out as well."}, {"Time_Start": 2795.0, "Time_End": 2798.0, "Text": " So this is what the exploit is."}, {"Time_Start": 2798.0, "Time_End": 2803.0, "Text": " Cisco Kazum asked reliable iOS remote exploitation."}, {"Time_Start": 2803.0, "Time_End": 2805.0, "Text": " That's just a summary."}, {"Time_Start": 2805.0, "Time_End": 2808.0, "Text": " And this is how it looks like."}, {"Time_Start": 2808.0, "Time_End": 2810.0, "Text": " Quite easy."}, {"Time_Start": 2810.0, "Time_End": 2815.0, "Text": " She's bad."}, {"Time_Start": 2815.0, "Time_End": 2818.0, "Text": " Okay, here is something."}, {"Time_Start": 2818.0, "Time_End": 2822.0, "Text": " Lots of people for the last years were complaining that all the presentations held on Blackhead"}, {"Time_Start": 2822.0, "Time_End": 2827.0, "Text": " or actually held the same way on DefCon and there is no value at."}, {"Time_Start": 2827.0, "Time_End": 2830.0, "Text": " So here's how well you add to DefCon."}, {"Time_Start": 2830.0, "Time_End": 2832.0, "Text": " What about image independent shell code?"}, {"Time_Start": 2832.0, "Time_End": 2837.0, "Text": " We can actually, instead of modifying the image, we can actually modify the configuration."}, {"Time_Start": 2837.0, "Time_End": 2839.0, "Text": " Now the configuration is portable."}, {"Time_Start": 2839.0, "Time_End": 2842.0, "Text": " is portable over images and versions."}, {"Time_Start": 2842.0, "Time_End": 2846.0, "Text": " So all we need to do is have a shell code that does string search,"}, {"Time_Start": 2846.0, "Time_End": 2849.0, "Text": " mem copy, and checksums."}, {"Time_Start": 2849.0, "Time_End": 2851.0, "Text": " Well, we can do that."}, {"Time_Start": 2851.0, "Time_End": 2854.0, "Text": " Config modification code."}, {"Time_Start": 2854.0, "Time_End": 2856.0, "Text": " We start searching at the beginning of the NV RAM."}, {"Time_Start": 2856.0, "Time_End": 2860.0, "Text": " We look for occurrences of like interesting data,"}, {"Time_Start": 2860.0, "Time_End": 2863.0, "Text": " let's say password and enable."}, {"Time_Start": 2863.0, "Time_End": 2867.0, "Text": " We replace it with our information"}, {"Time_Start": 2867.0, "Time_End": 2868.0, "Text": " and hereby replace authentic."}, {"Time_Start": 2868.0, "Time_End": 2872.0, "Text": " replace authentication information for the listed services."}, {"Time_Start": 2872.0, "Time_End": 2880.0, "Text": " We then just need to recalculate the checksum for the NV RAM and write it back."}, {"Time_Start": 2880.0, "Time_End": 2883.0, "Text": " And this is how that looks like."}, {"Time_Start": 2883.0, "Time_End": 2890.0, "Text": " You know, iOS also has the advantage of ignoring lines with bullshit."}, {"Time_Start": 2890.0, "Time_End": 2895.0, "Text": " So we can actually replace the stuff and introduce a line feed."}, {"Time_Start": 2895.0, "Time_End": 2897.0, "Text": " The rest of the encrypted strings ends up being bullshit."}, {"Time_Start": 2897.0, "Time_End": 2900.0, "Text": " bullshit, iOS ignores it, that's fine."}, {"Time_Start": 2900.0, "Time_End": 2901.0, "Text": " Advantage is here."}, {"Time_Start": 2901.0, "Time_End": 2903.0, "Text": " It's image independent."}, {"Time_Start": 2903.0, "Time_End": 2907.0, "Text": " The configuration is pretty much preserved except for the passwords,"}, {"Time_Start": 2907.0, "Time_End": 2911.0, "Text": " but of course we can change the shell code and copy the passwords elsewhere."}, {"Time_Start": 2911.0, "Time_End": 2914.0, "Text": " And we have actually more choices of what to do."}, {"Time_Start": 2914.0, "Time_End": 2918.0, "Text": " We can have shell codes just renaming every router to like piece of crap."}, {"Time_Start": 2918.0, "Time_End": 2923.0, "Text": " Disadvantage, of course, it's still platform dependent,"}, {"Time_Start": 2923.0, "Time_End": 2927.0, "Text": " but well, we cannot change that except for if one"}, {"Time_Start": 2927.0, "Time_End": 2934.36, "Text": " of the guys at Cesar's Challenge comes up with a cross-platform shell code for Motorola and MIPS."}, {"Time_Start": 2934.36, "Time_End": 2939.02, "Text": " And the router has to reboot, so we got a little downtime."}, {"Time_Start": 2939.02, "Time_End": 2941.5, "Text": " So what? What's the whole thing about?"}, {"Time_Start": 2941.5, "Time_End": 2947.76, "Text": " Well, didn't we mention last year that you shouldn't run unneeded services like UDP Echo,"}, {"Time_Start": 2947.76, "Time_End": 2953.72, "Text": " that you actually should protect your infrastructure, and that you actually should not copy data"}, {"Time_Start": 2953.72, "Time_End": 2955.88, "Text": " into buffers that are not large enough to hold them?"}, {"Time_Start": 2955.88, "Time_End": 2960.88, "Text": " So the problem here is iOS moves forward."}, {"Time_Start": 2960.88, "Time_End": 2964.88, "Text": " The new iOS versions actually got legal interception built in."}, {"Time_Start": 2964.88, "Time_End": 2970.88, "Text": " Half a year ago, I was talking to Jaya, who did the legal interception talk,"}, {"Time_Start": 2970.88, "Time_End": 2976.88, "Text": " and I said that would be quite interesting because then you can wear a t-shirt saying,"}, {"Time_Start": 2976.88, "Time_End": 2979.88, "Text": " my other computer is your legal interception system."}, {"Time_Start": 2979.88, "Time_End": 2984.88, "Text": " Well, this seems to become true slowly."}, {"Time_Start": 2984.88, "Time_End": 2992.88, "Text": " Well, and if your infrastructure is owned, you can't defend your systems, of course."}, {"Time_Start": 2992.88, "Time_End": 2995.88, "Text": " Okay."}, {"Time_Start": 2995.88, "Time_End": 3002.88, "Text": " And one thing I wanted to mention is that there are more people than we researching iOS exploitation."}, {"Time_Start": 3002.88, "Time_End": 3006.88, "Text": " As a birthday gift, I got Body of Secrets, James Bamford."}, {"Time_Start": 3006.88, "Time_End": 3014.86, "Text": " It actually has a whole page on the fact that the NSA is actively trying to find hacks for iOS, so they can't"}, {"Time_Start": 3014.88, "Time_End": 3020.88, "Text": " take over Cisco routers. I just wanted to mention that here. So you actually"}, {"Time_Start": 3020.88, "Time_End": 3030.88, "Text": " got some very excellent experience on DefCon. We just have to identify the people."}, {"Time_Start": 3030.88, "Time_End": 3035.88, "Text": " So the defense part, of course mobile phones, that's easy. Turn the crap off."}, {"Time_Start": 3035.88, "Time_End": 3042.88, "Text": " Do not do Bluetooth or have no infrared enabled when you're sitting in the airport."}, {"Time_Start": 3042.88, "Time_End": 3043.88, "Text": " Do not run any Java code."}, {"Time_Start": 3043.88, "Time_End": 3047.88, "Text": " run any Java code just because it says it's going to show you titties."}, {"Time_Start": 3047.88, "Time_End": 3052.88, "Text": " When you receive files, delete them right away."}, {"Time_Start": 3052.88, "Time_End": 3056.88, "Text": " Think of your mobile phone as a crappy version of Outlook."}, {"Time_Start": 3056.88, "Time_End": 3061.88, "Text": " And, well, if you got a chance, keep your phone firmware up to date."}, {"Time_Start": 3061.88, "Time_End": 3064.88, "Text": " Some vendors actually allow you to do that for others."}, {"Time_Start": 3064.88, "Time_End": 3067.88, "Text": " You have to arrest the people at the shop."}, {"Time_Start": 3067.88, "Time_End": 3072.88, "Text": " And if you're anyone else with a company doing that, don't do GPS VPNs."}, {"Time_Start": 3072.88, "Time_End": 3074.88, "Text": " ends."}, {"Time_Start": 3074.88, "Time_End": 3081.88, "Text": " Defense Cisco, well, in summary, do not trust devices just because they're in a black box."}, {"Time_Start": 3081.88, "Time_End": 3085.88, "Text": " It doesn't mean they're more secure. It mostly means they're less secure."}, {"Time_Start": 3085.88, "Time_End": 3087.88, "Text": " Keep your iOS up to date."}, {"Time_Start": 3087.88, "Time_End": 3091.88, "Text": " If possible, actually block every direct communication to your routers."}, {"Time_Start": 3091.88, "Time_End": 3097.88, "Text": " There is no legitimate use to someone else in the internet talk directly to your router."}, {"Time_Start": 3097.88, "Time_End": 3102.88, "Text": " So if you had done that in the first place, even the queue filling back wouldn't even"}, {"Time_Start": 3102.88, "Time_End": 3104.88, "Text": " even affect you."}, {"Time_Start": 3104.88, "Time_End": 3109.88, "Text": " And of course, to do that, you should prefer out of management."}, {"Time_Start": 3109.88, "Time_End": 3114.88, "Text": " So the one talking to your router is actually coming in on a different interface."}, {"Time_Start": 3114.88, "Time_End": 3118.88, "Text": " And well, you should include your router in an IDS watch list."}, {"Time_Start": 3118.88, "Time_End": 3123.88, "Text": " Well, I was racing through it, and I guess I made it on time."}, {"Time_Start": 3123.88, "Time_End": 3126.88, "Text": " Thanks a lot for being here."}, {"Time_Start": 3126.88, "Time_End": 3131.88, "Text": " And well, I will be at the pool for questions."}, {"Time_Start": 3131.88, "Time_End": 3135.88, "Text": " questions. I know that most people don't see the lower part of the screen,"}, {"Time_Start": 3135.88, "Time_End": 3139.88, "Text": " but this is something they just got in Germany out with the advertisements,"}, {"Time_Start": 3139.88, "Time_End": 3141.88, "Text": " and I thought we're going to change that a bit."}, {"Time_Start": 3141.88, "Time_End": 3143.88, "Text": " And thanks very much."}]}