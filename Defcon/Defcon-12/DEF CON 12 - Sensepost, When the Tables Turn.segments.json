{"segments": [{"Time_Start": 0.0, "Time_End": 7.0, "Text": " We're going to get this talk started in just a minute."}, {"Time_Start": 7.0, "Time_End": 12.0, "Text": " Are we ready?"}, {"Time_Start": 12.0, "Time_End": 17.0, "Text": " All right."}, {"Time_Start": 17.0, "Time_End": 22.0, "Text": " It is my pleasure to introduce a few guys from SensePosts who are going to give the talk today,"}, {"Time_Start": 22.0, "Time_End": 28.0, "Text": " when the table's turn, dealing with passive strike back attacker on networks."}, {"Time_Start": 28.0, "Time_End": 33.0, "Text": " First is Ralph Hemming, Harun Mir, and Charo van dervalt."}, {"Time_Start": 33.0, "Time_End": 35.0, "Text": " Take it away."}, {"Time_Start": 35.0, "Time_End": 38.0, "Text": " Thank you."}, {"Time_Start": 38.0, "Time_End": 43.0, "Text": " Okay."}, {"Time_Start": 43.0, "Time_End": 47.0, "Text": " I can see how this is going to become a little bit of a problem."}, {"Time_Start": 47.0, "Time_End": 48.0, "Text": " Is there?"}, {"Time_Start": 48.0, "Time_End": 53.0, "Text": " All right. Excellent."}, {"Time_Start": 53.0, "Time_End": 54.0, "Text": " Thanks."}, {"Time_Start": 54.0, "Time_End": 55.0, "Text": " Welcome."}, {"Time_Start": 55.0, "Time_End": 57.0, "Text": " I'm glad to see we have such a big turnout after last."}, {"Time_Start": 57.0, "Time_End": 64.0, "Text": " after last night, I thought that nobody would ever be here after a night like last night."}, {"Time_Start": 64.0, "Time_End": 70.0, "Text": " Right, we're doing a talk today."}, {"Time_Start": 70.0, "Time_End": 74.0, "Text": " It's called When the Table's Turn."}, {"Time_Start": 74.0, "Time_End": 80.0, "Text": " This is my beautiful assistant, Harun."}, {"Time_Start": 80.0, "Time_End": 82.0, "Text": " All right."}, {"Time_Start": 82.0, "Time_End": 84.0, "Text": " Sorry?"}, {"Time_Start": 84.0, "Time_End": 86.0, "Text": " Can't hear me."}, {"Time_Start": 86.0, "Time_End": 87.0, "Text": " Can't hear me."}, {"Time_Start": 87.0, "Time_End": 88.0, "Text": " Should I speak like this?"}, {"Time_Start": 88.0, "Time_End": 89.0, "Text": " Is this better?"}, {"Time_Start": 89.0, "Time_End": 90.0, "Text": " Yes."}, {"Time_Start": 90.0, "Time_End": 91.0, "Text": " Gee, words."}, {"Time_Start": 91.0, "Time_End": 96.0, "Text": " Is there any chance that we might turn this up a bit?"}, {"Time_Start": 96.0, "Time_End": 100.0, "Text": " Because I don't know if I can sustain this for this long."}, {"Time_Start": 100.0, "Time_End": 101.0, "Text": " Okay."}, {"Time_Start": 101.0, "Time_End": 103.0, "Text": " Okay, let's go."}, {"Time_Start": 103.0, "Time_End": 106.0, "Text": " So basically, this is the agenda."}, {"Time_Start": 106.0, "Time_End": 108.0, "Text": " This is what we're going to go through."}, {"Time_Start": 108.0, "Time_End": 111.0, "Text": " Think about the concept, a little bit of introduction."}, {"Time_Start": 111.0, "Time_End": 115.0, "Text": " We gave this talk at Black Hat as well, and we kind of run out of time at the last couple of slides."}, {"Time_Start": 115.0, "Time_End": 118.0, "Text": " couple of slides. So I'm not going to spend a whole lot of time on the introduction."}, {"Time_Start": 118.0, "Time_End": 122.0, "Text": " I rather get to the interesting bits, which is a demo."}, {"Time_Start": 122.0, "Time_End": 129.0, "Text": " At Black Hat, we didn't actually do the demo because we had some interesting issues with hardware."}, {"Time_Start": 129.0, "Time_End": 132.0, "Text": " This time around, I think we're going to be able to do that."}, {"Time_Start": 132.0, "Time_End": 136.0, "Text": " I've got the screenshots on the presentation as a backup as well."}, {"Time_Start": 136.0, "Time_End": 140.0, "Text": " So if it doesn't work, then we'll just revert back to the screenshots in the presentation,"}, {"Time_Start": 140.0, "Time_End": 142.0, "Text": " but I think everything is good."}, {"Time_Start": 142.0, "Time_End": 144.0, "Text": " Okay."}, {"Time_Start": 144.0, "Time_End": 145.0, "Text": " So I'm going to start off."}, {"Time_Start": 145.0, "Time_End": 153.0, "Text": " by saying, if you don't know this, we, from a small little country, at the southern tip of Africa, called South Africa,"}, {"Time_Start": 153.0, "Time_End": 157.0, "Text": " it is a country, it's not a region, okay?"}, {"Time_Start": 157.0, "Time_End": 164.0, "Text": " And in South Africa, we have lots and lots and lots of robberies and crimes and hijacks and those kind of things."}, {"Time_Start": 164.0, "Time_End": 167.0, "Text": " So I want to quickly tell you a story about a friend of mine."}, {"Time_Start": 167.0, "Time_End": 172.0, "Text": " There's a road in Pretoria called Etterbury Road, which is, there's a big sign up there."}, {"Time_Start": 172.0, "Time_End": 174.98, "Text": " I must actually show you the picture that says hijacking hot."}, {"Time_Start": 175.0, "Time_End": 181.0, "Text": " spot. It's an official government sign. It's not a small little poster that someone put on there."}, {"Time_Start": 181.0, "Time_End": 185.0, "Text": " So the government tells you, if you go there, you know, skip the robot."}, {"Time_Start": 185.0, "Time_End": 188.0, "Text": " You don't talk about robot, right? You talk about traffic light."}, {"Time_Start": 188.0, "Time_End": 194.0, "Text": " Okay. Skip the traffic light and just, you know, go on because otherwise you're going to get hijacked."}, {"Time_Start": 194.0, "Time_End": 196.0, "Text": " That's for sure, okay?"}, {"Time_Start": 196.0, "Time_End": 198.0, "Text": " It's not that bad."}, {"Time_Start": 198.0, "Time_End": 202.0, "Text": " Okay, anyhow, so a friend of mine actually got robbed over there."}, {"Time_Start": 202.0, "Time_End": 204.98, "Text": " They smashed his window and they took something out of his car, his wallet,"}, {"Time_Start": 205.0, "Time_End": 212.0, "Text": " and stuff. And they ran into the bushes. We also have a lot of bushes in there. It's not like, you know, America, no."}, {"Time_Start": 212.0, "Time_End": 232.0, "Text": " Right. So, anyhow, so my friend said to me, he wished that he had this little C-fall, piece of C-fall, attached to his wallet with a remote detonator, so that if someone steals his wallet, he can just go, you take it, there you go, and pull out his remote and go."}, {"Time_Start": 235.0, "Time_End": 239.0, "Text": " Okay, you get the same kind of thing."}, {"Time_Start": 239.0, "Time_End": 242.0, "Text": " If you think about electric fencing, okay?"}, {"Time_Start": 242.0, "Time_End": 246.0, "Text": " So electric fencing, everybody in South Africa has got electric fencing around their properties."}, {"Time_Start": 246.0, "Time_End": 253.0, "Text": " And the idea there is really that if you don't want to climb over the wall to steal stuff from our house,"}, {"Time_Start": 253.0, "Time_End": 256.0, "Text": " that electric fencing is not going to bother you at all, right?"}, {"Time_Start": 256.0, "Time_End": 260.0, "Text": " It's not very pretty, but, you know, that's the idea."}, {"Time_Start": 260.0, "Time_End": 264.0, "Text": " The idea is that this talk is about attacking attacker."}, {"Time_Start": 264.0, "Time_End": 274.0, "Text": " attacking attackers, right? But doing it in a clever way, so that we don't attack the wrong people, and we attack them by basically throwing them poison out."}, {"Time_Start": 274.0, "Time_End": 283.0, "Text": " You see the same thing in the natural world, in the insect world, you get these bugs that are very acidy, is that what you call it?"}, {"Time_Start": 283.0, "Time_End": 286.0, "Text": " Yeah, they taste like shit, okay?"}, {"Time_Start": 286.0, "Time_End": 293.0, "Text": " So basically what happens is when something eats this bug, they're like, ah, that's not nice."}, {"Time_Start": 293.0, "Time_End": 297.0, "Text": " And you get the electric eel, which got the same concept."}, {"Time_Start": 297.0, "Time_End": 301.0, "Text": " You know, it's mining its own business, swimming through the water, and..."}, {"Time_Start": 301.0, "Time_End": 303.0, "Text": " Hello?"}, {"Time_Start": 303.0, "Time_End": 304.0, "Text": " Yeah."}, {"Time_Start": 304.0, "Time_End": 309.0, "Text": " His son, his son is safe."}, {"Time_Start": 309.0, "Time_End": 313.0, "Text": " Okay, never mind, you know, private joke in here."}, {"Time_Start": 313.0, "Time_End": 314.0, "Text": " All right."}, {"Time_Start": 314.0, "Time_End": 317.0, "Text": " And an electric eel won't do anything to you unless you touch it."}, {"Time_Start": 317.0, "Time_End": 322.0, "Text": " Okay, if you start prodding it and agitating it, it's going to shock you, right?"}, {"Time_Start": 322.0, "Time_End": 332.0, "Text": " We see the same in the information world, with disinformation, right, one country feeding your other country, shit, right?"}, {"Time_Start": 332.0, "Time_End": 336.0, "Text": " Saying, you should know this, actually, you know, it's that all bullshit."}, {"Time_Start": 336.0, "Time_End": 340.0, "Text": " Okay, so we're going to quickly go through this again."}, {"Time_Start": 340.0, "Time_End": 343.0, "Text": " Like I said, there's a lot of stuff we want to show you."}, {"Time_Start": 343.0, "Time_End": 351.0, "Text": " What we find at the moment is current trends in the assessment space, and I put assessment there in brackets,"}, {"Time_Start": 351.0, "Time_End": 352.0, "Text": " because I don't want to say,"}, {"Time_Start": 352.0, "Time_End": 354.0, "Text": " a hacking space, right?"}, {"Time_Start": 354.0, "Time_End": 359.0, "Text": " We're finding that technology is really getting smarter and smarter and smarter."}, {"Time_Start": 359.0, "Time_End": 362.0, "Text": " Everybody is building a better scanner these days."}, {"Time_Start": 362.0, "Time_End": 364.0, "Text": " People are getting lazy."}, {"Time_Start": 364.0, "Time_End": 368.0, "Text": " In the good old days, you had the concept that a hacker, a good hacker,"}, {"Time_Start": 368.0, "Time_End": 371.0, "Text": " was really someone that was technically clever."}, {"Time_Start": 371.0, "Time_End": 376.0, "Text": " These days, you find the perception that someone is really clever if they have a big toolbox."}, {"Time_Start": 376.0, "Time_End": 380.0, "Text": " And they've got lots of tools that sits in this toolbox."}, {"Time_Start": 380.0, "Time_End": 382.0, "Text": " And we find scanners and tools for,"}, {"Time_Start": 382.0, "Time_End": 386.0, "Text": " every possible level of attack."}, {"Time_Start": 386.0, "Time_End": 392.0, "Text": " Also the other perception that you have is that administrators are dumb and hackers are clever."}, {"Time_Start": 392.0, "Time_End": 396.0, "Text": " So you read about something in the paper or you see it on the news when a hacker broken into"}, {"Time_Start": 396.0, "Time_End": 400.0, "Text": " a site and everyone goes, wow, you know, that guy must be smart."}, {"Time_Start": 400.0, "Time_End": 403.0, "Text": " And the rest of the here, nobody breaks into that site."}, {"Time_Start": 403.0, "Time_End": 406.0, "Text": " And nobody goes, wow, that administrator must be good."}, {"Time_Start": 406.0, "Time_End": 410.0, "Text": " So it's a little bit unfair towards the administrators."}, {"Time_Start": 410.0, "Time_End": 411.98, "Text": " And what we find is that"}, {"Time_Start": 412.0, "Time_End": 419.0, "Text": " in many cases, the attackers' network, the guy that's attacking you, his network is not secure."}, {"Time_Start": 419.0, "Time_End": 421.0, "Text": " And his tools are not patched."}, {"Time_Start": 421.0, "Time_End": 423.0, "Text": " And he's not running the latest service packs."}, {"Time_Start": 423.0, "Time_End": 427.0, "Text": " So in many cases, the mechanics car is always broken."}, {"Time_Start": 427.0, "Time_End": 430.0, "Text": " And in this talk, we're going to see how we can exploit that,"}, {"Time_Start": 430.0, "Time_End": 435.0, "Text": " or make it interesting, or create a little bit of paranoia on the side of the attacker side"}, {"Time_Start": 435.0, "Time_End": 438.0, "Text": " before he attacks a site."}, {"Time_Start": 438.0, "Time_End": 439.0, "Text": " Okay?"}, {"Time_Start": 439.0, "Time_End": 442.0, "Text": " Okay, so let's look at the type of defense system."}, {"Time_Start": 442.0, "Time_End": 444.0, "Text": " technologies that we have out there today."}, {"Time_Start": 444.0, "Time_End": 449.0, "Text": " And I'm going to kind of map it back to the analogies that I've given you."}, {"Time_Start": 449.0, "Time_End": 457.0, "Text": " So with the robbery analogy, a firewall would be preventing the attack, right?"}, {"Time_Start": 457.0, "Time_End": 463.0, "Text": " So imagine you have this big tank that rolls up to the highway, which takes you to your office."}, {"Time_Start": 463.0, "Time_End": 467.0, "Text": " Someone is not going to smash the windows of this tank, right?"}, {"Time_Start": 467.0, "Time_End": 469.0, "Text": " So it's preventing it."}, {"Time_Start": 469.0, "Time_End": 471.98, "Text": " You have the technology called IDAS, Intrude,"}, {"Time_Start": 472.0, "Time_End": 477.0, "Text": " protection systems, which is basically a little bit like the South African police, right?"}, {"Time_Start": 477.0, "Time_End": 479.0, "Text": " They always arrive at the scene two hours late."}, {"Time_Start": 483.0, "Time_End": 485.0, "Text": " And IDS tends to be like that."}, {"Time_Start": 485.0, "Time_End": 489.0, "Text": " IDS tends to tell you you've been hacked, right?"}, {"Time_Start": 489.0, "Time_End": 493.0, "Text": " And then we move a little bit of step up, which is IPS."}, {"Time_Start": 493.0, "Time_End": 497.0, "Text": " In IPS, what's basically happening is we're trying to avoid the attack, right?"}, {"Time_Start": 497.0, "Time_End": 501.0, "Text": " So when we detect there's something happening, we try to block that, correct?"}, {"Time_Start": 501.0, "Time_End": 506.0, "Text": " that can be seen as simply, you know, driving away."}, {"Time_Start": 506.0, "Time_End": 510.0, "Text": " You see someone walking to you or you just drive away."}, {"Time_Start": 510.0, "Time_End": 513.0, "Text": " Then you have some people that think it's really clever"}, {"Time_Start": 513.0, "Time_End": 518.0, "Text": " that if they see something in the IDS logs that seems a little bit strange"}, {"Time_Start": 518.0, "Time_End": 520.0, "Text": " or they see a machine attacking them,"}, {"Time_Start": 520.0, "Time_End": 524.0, "Text": " the next thing that they do is they attack that machine back, right?"}, {"Time_Start": 524.0, "Time_End": 527.0, "Text": " And we know that that is very scary, that's a very scary thing"}, {"Time_Start": 527.0, "Time_End": 531.0, "Text": " because IPs can be spoofed and decoys can be put into end-map"}, {"Time_Start": 531.0, "Time_End": 532.0, "Text": " and that kind of thing."}, {"Time_Start": 532.0, "Time_End": 535.0, "Text": " So that's a little bit like carrying a gun in your car."}, {"Time_Start": 535.0, "Time_End": 538.0, "Text": " And if someone walks up to your car, you go,"}, {"Time_Start": 538.0, "Time_End": 541.0, "Text": " right, and you blast them straight away."}, {"Time_Start": 541.0, "Time_End": 544.0, "Text": " And that's also not a clever idea."}, {"Time_Start": 544.0, "Time_End": 546.0, "Text": " And the fence analogy have the same thing."}, {"Time_Start": 546.0, "Time_End": 549.0, "Text": " The fence, the wall itself is the firewall."}, {"Time_Start": 549.0, "Time_End": 551.0, "Text": " Again, the IDS is the police."}, {"Time_Start": 551.0, "Time_End": 554.0, "Text": " The IPS is a kind of armed response,"}, {"Time_Start": 554.0, "Time_End": 558.0, "Text": " and a back hack would be my wife with a shotgun"}, {"Time_Start": 558.0, "Time_End": 560.0, "Text": " that sits there, you know, quite paranoid."}, {"Time_Start": 560.0, "Time_End": 565.0, "Text": " quite paranoid and when you walk into the house at 3 o'clock in the morning or drunk,"}, {"Time_Start": 565.0, "Time_End": 567.0, "Text": " she goes, I don't know you."}, {"Time_Start": 567.0, "Time_End": 569.0, "Text": " And there you go."}, {"Time_Start": 569.0, "Time_End": 575.0, "Text": " Right, so what you're trying to do with this is basically saying"}, {"Time_Start": 575.0, "Time_End": 581.0, "Text": " we want to raise the cost, the cost of an assessment."}, {"Time_Start": 581.0, "Time_End": 584.0, "Text": " And I have cost in brackets and I have assessment in,"}, {"Time_Start": 584.0, "Time_End": 589.0, "Text": " not brackets, inverted, commas, quotes, whatever, curly brackets,"}, {"Time_Start": 589.0, "Time_End": 589.98, "Text": " you know,"}, {"Time_Start": 590.0, "Time_End": 592.0, "Text": " cause, whatever."}, {"Time_Start": 592.0, "Time_End": 594.0, "Text": " Raising the cost of assessment."}, {"Time_Start": 594.0, "Time_End": 597.0, "Text": " When I'm in cost, I mean a whole lot of different things."}, {"Time_Start": 597.0, "Time_End": 599.0, "Text": " It could be the time that you spend on it."}, {"Time_Start": 599.0, "Time_End": 603.0, "Text": " The level of certainty you have about your own network."}, {"Time_Start": 603.0, "Time_End": 605.0, "Text": " It could be a whole lot of different things that we mean in cost."}, {"Time_Start": 605.0, "Time_End": 610.0, "Text": " We don't mean cost in terms of, you know, real money."}, {"Time_Start": 610.0, "Time_End": 614.0, "Text": " And in the assessment, we mean all sorts of attacks, right?"}, {"Time_Start": 614.0, "Time_End": 616.0, "Text": " All different kind of attacks."}, {"Time_Start": 616.0, "Time_End": 618.0, "Text": " It's not really an assessment."}, {"Time_Start": 618.0, "Time_End": 619.0, "Text": " And in all of these cases, what we're trying to be."}, {"Time_Start": 619.0, "Time_End": 620.0, "Text": " And in this, and in all of these cases, what we're trying to be."}, {"Time_Start": 620.0, "Time_End": 627.0, "Text": " do is we're trying to attack the technology and not the person that sits behind the technology."}, {"Time_Start": 627.0, "Time_End": 632.0, "Text": " So one of the things that you will see that we're doing is attacking automation."}, {"Time_Start": 632.0, "Time_End": 637.0, "Text": " In that case, we just make it so difficult to attack our sites that a would-be attacker goes,"}, {"Time_Start": 637.0, "Time_End": 639.0, "Text": " yes, this is going to take a long while."}, {"Time_Start": 639.0, "Time_End": 643.0, "Text": " I can just as well move on to my next target, right?"}, {"Time_Start": 643.0, "Time_End": 649.0, "Text": " It used to be, today it is a thing that says, are you sure when you attack a machine that you're not sitting on a honeypot?"}, {"Time_Start": 649.0, "Time_End": 653.0, "Text": " you're not sitting on a honeypot, right? So you kind of go, well, I'm not quite sure."}, {"Time_Start": 653.0, "Time_End": 662.0, "Text": " But what we wanted to be is a situation where you say, before I attack something, I've got to be sure that the tools that I am using"}, {"Time_Start": 662.0, "Time_End": 667.0, "Text": " is secure against attacks back into the tools. I'm going to show you how we're doing that."}, {"Time_Start": 667.0, "Time_End": 671.0, "Text": " We have to worry is our network safe when we attack something."}, {"Time_Start": 671.0, "Time_End": 676.0, "Text": " Do we have all the service packs installed on our machines?"}, {"Time_Start": 676.0, "Time_End": 678.98, "Text": " And what we find is we go to clients and we do at our own."}, {"Time_Start": 679.0, "Time_End": 684.0, "Text": " ourselves. We go to clients and say, you guys should really look at this, this, this, this, and that."}, {"Time_Start": 684.0, "Time_End": 688.0, "Text": " And we think that you didn't do quite a good job in securing your network."}, {"Time_Start": 688.0, "Time_End": 692.0, "Text": " But do we measure ourselves as we measure our targets?"}, {"Time_Start": 692.0, "Time_End": 696.0, "Text": " And I find that just about nobody does that, right?"}, {"Time_Start": 696.0, "Time_End": 701.0, "Text": " Very quick of the mark to tell someone that he should patch his machines, but you don't do it yourself."}, {"Time_Start": 701.0, "Time_End": 705.0, "Text": " Okay, so I'm going to skip this slide."}, {"Time_Start": 705.0, "Time_End": 708.0, "Text": " Okay, and so what we're going to do here is we're going to look at different things."}, {"Time_Start": 708.0, "Time_End": 715.0, "Text": " So look at different types of attacks that we'll be doing and look at different levels where we can do those attacks."}, {"Time_Start": 715.0, "Time_End": 719.0, "Text": " So the type of attacks, these four categories, in the first instance,"}, {"Time_Start": 719.0, "Time_End": 722.0, "Text": " it's really avoiding or stopping the individual attack."}, {"Time_Start": 722.0, "Time_End": 730.0, "Text": " The second thing would be to create a lot of noise and confusion within the results coming back."}, {"Time_Start": 730.0, "Time_End": 737.0, "Text": " In the third section, we're looking at actually stopping the tool or killing the tool itself that the person is using to attack you."}, {"Time_Start": 737.0, "Time_End": 745.0, "Text": " attack you and if you get really hectic, then you can see if you can attack the attacker through his own tools and through his own methods."}, {"Time_Start": 745.0, "Time_End": 747.0, "Text": " And we're going to look at that on three levels."}, {"Time_Start": 747.0, "Time_End": 753.0, "Text": " You're going to look at it on a network level, on a network application level, and finally on an application level."}, {"Time_Start": 753.0, "Time_End": 756.0, "Text": " Now consider this, right?"}, {"Time_Start": 756.0, "Time_End": 766.0, "Text": " If somebody attacks you, every single bit of information going back into the attacker's tool or into his network is really under your control."}, {"Time_Start": 766.0, "Time_End": 770.0, "Text": " You control what the attacker is seeing."}, {"Time_Start": 770.0, "Time_End": 774.0, "Text": " You control the data that's been sent back to the attacker."}, {"Time_Start": 774.0, "Time_End": 776.0, "Text": " All right?"}, {"Time_Start": 776.0, "Time_End": 779.0, "Text": " So let's just look at examples of that."}, {"Time_Start": 779.0, "Time_End": 780.0, "Text": " You can look at the packets."}, {"Time_Start": 780.0, "Time_End": 782.0, "Text": " The packets itself that's going back to the attacker,"}, {"Time_Start": 782.0, "Time_End": 785.0, "Text": " plus all its features are under your control."}, {"Time_Start": 785.0, "Time_End": 789.0, "Text": " You control the forward and reverse entries, DNS entries,"}, {"Time_Start": 789.0, "Time_End": 791.0, "Text": " that the attacker will be seen."}, {"Time_Start": 791.0, "Time_End": 795.0, "Text": " You control the banners that's spewed back to the attacker."}, {"Time_Start": 795.0, "Time_End": 796.0, "Text": " You control the banners."}, {"Time_Start": 796.0, "Time_End": 799.0, "Text": " the error codes and the messages within web pages."}, {"Time_Start": 799.0, "Time_End": 805.0, "Text": " You actually control the whole web page itself, if you're looking at a web application level, right?"}, {"Time_Start": 805.0, "Time_End": 813.0, "Text": " And this data that is under your control that you're sending back to the attacker could be used"}, {"Time_Start": 813.0, "Time_End": 817.0, "Text": " where the scanner or the tool actually reads the data, right?"}, {"Time_Start": 817.0, "Time_End": 822.0, "Text": " Where the tool stores the data, when it writes it into a database, given into a file,"}, {"Time_Start": 822.0, "Time_End": 825.0, "Text": " and when the scanner or the tool renders the data to show it to you."}, {"Time_Start": 825.0, "Time_End": 826.0, "Text": " to show it to you."}, {"Time_Start": 826.0, "Time_End": 830.0, "Text": " And we can look at examples what we can do with this."}, {"Time_Start": 830.0, "Time_End": 831.0, "Text": " Am I doing for time?"}, {"Time_Start": 831.0, "Time_End": 832.0, "Text": " Okay, for time?"}, {"Time_Start": 832.0, "Time_End": 833.0, "Text": " 15 minutes?"}, {"Time_Start": 833.0, "Time_End": 834.0, "Text": " Right."}, {"Time_Start": 834.0, "Time_End": 839.0, "Text": " Now, before we start showing you the interesting parts of the demos and that kind of thing,"}, {"Time_Start": 839.0, "Time_End": 842.0, "Text": " there's two things that you really must consider over here."}, {"Time_Start": 842.0, "Time_End": 846.0, "Text": " The first is the legal implications of what you are doing."}, {"Time_Start": 846.0, "Time_End": 850.0, "Text": " So I'm not an expert in law, and I don't know really how it would work,"}, {"Time_Start": 850.0, "Time_End": 854.0, "Text": " but I could guess that, you know, someone would want to look into this and say,"}, {"Time_Start": 854.0, "Time_End": 861.0, "Text": " say, well, you know what, we know that this guy was really out there to get you and he was attacking your network,"}, {"Time_Start": 861.0, "Time_End": 866.0, "Text": " but you wiped out his whole, you know, corporate network where he was attacking you from,"}, {"Time_Start": 866.0, "Time_End": 870.0, "Text": " and that could lead to some legal ramifications."}, {"Time_Start": 870.0, "Time_End": 876.0, "Text": " So before you implement this stuff, speak to someone that's in a suit and a tie and that knows the law"}, {"Time_Start": 876.0, "Time_End": 880.0, "Text": " and drives a big car, okay?"}, {"Time_Start": 880.0, "Time_End": 883.98, "Text": " The second thing is the stuff that we build here,"}, {"Time_Start": 884.0, "Time_End": 885.0, "Text": " you're not going to give it away."}, {"Time_Start": 885.0, "Time_End": 886.0, "Text": " I tell you why."}, {"Time_Start": 886.0, "Time_End": 889.0, "Text": " It's a little bit sucky in terms of its implementation."}, {"Time_Start": 889.0, "Time_End": 891.0, "Text": " We're not hardcore programmers."}, {"Time_Start": 891.0, "Time_End": 895.0, "Text": " So the stuff that we build is only meant for a demo."}, {"Time_Start": 895.0, "Time_End": 902.0, "Text": " And before you start deploying this or this kind of idea on your corporate network,"}, {"Time_Start": 902.0, "Time_End": 905.0, "Text": " look at it a little bit in more detail technically, right?"}, {"Time_Start": 905.0, "Time_End": 909.0, "Text": " Because the stuff that we build is not made to be robust."}, {"Time_Start": 909.0, "Time_End": 913.0, "Text": " That's why we don't want to give it out."}, {"Time_Start": 913.0, "Time_End": 914.0, "Text": " Okay."}, {"Time_Start": 914.0, "Time_End": 916.0, "Text": " So I'm going to quickly go through here."}, {"Time_Start": 916.0, "Time_End": 918.0, "Text": " Let's look at examples."}, {"Time_Start": 918.0, "Time_End": 924.0, "Text": " First of all, in the first part of our assessment, what we're going to do is we're going to try to do a footprint of this company, right?"}, {"Time_Start": 924.0, "Time_End": 927.0, "Text": " And you all know that SensePose is very passionate about footprinting."}, {"Time_Start": 927.0, "Time_End": 931.0, "Text": " So we looked at ways that we can break our own footprinting tools."}, {"Time_Start": 931.0, "Time_End": 941.0, "Text": " Avoiding, we can really go into DNS obfuscation to hide ourselves away, which can actually be done quite nicely."}, {"Time_Start": 941.0, "Time_End": 944.0, "Text": " You can have, you know, MX records that's offsite."}, {"Time_Start": 944.0, "Time_End": 948.0, "Text": " with split dns between you and that amics record,"}, {"Time_Start": 948.0, "Time_End": 952.0, "Text": " you can hide away your website to put it totally off your network"}, {"Time_Start": 952.0, "Time_End": 957.0, "Text": " so that nobody can actually get the IP numbers where your network is located."}, {"Time_Start": 957.0, "Time_End": 960.0, "Text": " It's not that hard, especially when you don't offer services"}, {"Time_Start": 960.0, "Time_End": 963.0, "Text": " that need to interact with your internal network."}, {"Time_Start": 963.0, "Time_End": 967.0, "Text": " If we want to create noise, one of the things that we do"}, {"Time_Start": 967.0, "Time_End": 973.0, "Text": " is we create a zone file, which we allow people to do a zone transfer from our network."}, {"Time_Start": 973.0, "Time_End": 978.0, "Text": " And in this zone, we put a whole lot of IP numbers and names in there."}, {"Time_Start": 978.0, "Time_End": 983.0, "Text": " At one stage we had something like 25,000 entries within our zone file,"}, {"Time_Start": 983.0, "Time_End": 988.0, "Text": " pointing to all sorts of interesting places which you don't want to attack."}, {"Time_Start": 988.0, "Time_End": 993.0, "Text": " So someone gets our zone file, they basically go through all the IPAs, they say,"}, {"Time_Start": 993.0, "Time_End": 997.0, "Text": " well, yes, look at this network, it's rather large."}, {"Time_Start": 997.0, "Time_End": 999.0, "Text": " Let's attack all of these machines automatically."}, {"Time_Start": 999.0, "Time_End": 1001.0, "Text": " Remember we want to attack automation."}, {"Time_Start": 1001.0, "Time_End": 1003.0, "Text": " And they'll be attacking very interesting."}, {"Time_Start": 1003.0, "Time_End": 1005.0, "Text": " machines around the world."}, {"Time_Start": 1005.0, "Time_End": 1009.0, "Text": " You do not want to attack the FBI, for instance."}, {"Time_Start": 1009.0, "Time_End": 1013.0, "Text": " In terms of stopping, in terms of stopping footprinting,"}, {"Time_Start": 1013.0, "Time_End": 1018.0, "Text": " what we can do is we can build a name server that basically"}, {"Time_Start": 1018.0, "Time_End": 1024.0, "Text": " sends back an endless loop of entries when we do his own transfer, right?"}, {"Time_Start": 1024.0, "Time_End": 1025.0, "Text": " It never stops."}, {"Time_Start": 1025.0, "Time_End": 1027.0, "Text": " It always keeps on going."}, {"Time_Start": 1027.0, "Time_End": 1030.0, "Text": " Now, manually you would detect that it never stops,"}, {"Time_Start": 1030.0, "Time_End": 1032.98, "Text": " but if you have something that runs automatically, that will just"}, {"Time_Start": 1033.0, "Time_End": 1040.0, "Text": " run forever. And in terms of killing, we can control, like I said, the forward and reverse"}, {"Time_Start": 1040.0, "Time_End": 1046.0, "Text": " entries, DNS entries for our zone, right? So with the forward entries, we are a little bit limited"}, {"Time_Start": 1046.0, "Time_End": 1050.0, "Text": " in terms of what our IP number should look like, correct? But in the reverse entries,"}, {"Time_Start": 1050.0, "Time_End": 1058.0, "Text": " if we build our own DNA server, we can be very creative with the kind of entries that we give"}, {"Time_Start": 1058.0, "Time_End": 1062.0, "Text": " for our reverse DNS. I'm going to show you an example of that."}, {"Time_Start": 1063.0, "Time_End": 1071.0, "Text": " Okay, that's a name server that's basically running, it's kind of an evil name server."}, {"Time_Start": 1071.0, "Time_End": 1081.0, "Text": " And if you look at the reverse entries that we have there, if we start taking, doing a, you know, a host command and piping it through something like CET or Orc or Grip,"}, {"Time_Start": 1081.0, "Time_End": 1087.0, "Text": " you can see that there's, to start off with some HTML in there for rendering when we start rendering and stuff."}, {"Time_Start": 1087.0, "Time_End": 1092.98, "Text": " Well, we can just do backtick and see if we, not backtick, single quote, see if we can break the actual"}, {"Time_Start": 1093.0, "Time_End": 1098.66, "Text": " query, not query, the actual command, break out of that command and start executing stuff."}, {"Time_Start": 1098.66, "Time_End": 1104.7, "Text": " So that LS, for instance, pipe LS could be interesting when someone just runs it from a command line,"}, {"Time_Start": 1105.0, "Time_End": 1109.88, "Text": " do the host lookup from a command line. And we can get really creative with it, like, you know,"}, {"Time_Start": 1109.88, "Time_End": 1113.8, "Text": " maybe RN minus RF, slash, you know, those kind of things."}, {"Time_Start": 1115.88, "Time_End": 1122.68, "Text": " Now what we've done is we've implemented the very large zone files on our domain. And"}, {"Time_Start": 1123.0, "Time_End": 1139.0, "Text": " And then just to see how the tools would react to it, we used a tool called the, it's actually the trial kind of free demo of the Qualis Network Discovery Tool to see how Qualis would show our network."}, {"Time_Start": 1139.0, "Time_End": 1147.0, "Text": " Now before I share this picture, keep in mind that we have one class C network and we've got about 25 machines in there."}, {"Time_Start": 1147.0, "Time_End": 1149.0, "Text": " Okay, so it's not a big network."}, {"Time_Start": 1149.0, "Time_End": 1152.0, "Text": " When you let Qualis run on it, however,"}, {"Time_Start": 1152.0, "Time_End": 1155.14, "Text": " it looks like this."}, {"Time_Start": 1156.56, "Time_End": 1159.24, "Text": " Okay, so it thinks we've got a hell of a big network."}, {"Time_Start": 1160.2, "Time_End": 1168.38, "Text": " And eventually, it starts saying, your discovery has exceeded the time limit to view your entire map sign up for QualisGuard."}, {"Time_Start": 1168.84, "Time_End": 1169.04, "Text": " Okay?"}, {"Time_Start": 1169.34, "Time_End": 1175.88, "Text": " So you can see that just by looking at the reverse entries, this thing thinks to be everywhere around the world."}, {"Time_Start": 1177.58, "Time_End": 1180.88, "Text": " Okay, so that's about what we can do on our..."}, {"Time_Start": 1182.0, "Time_End": 1183.74, "Text": " footprinting side."}, {"Time_Start": 1184.36, "Time_End": 1186.12, "Text": " So I'm going to go on to a network level."}, {"Time_Start": 1186.9, "Time_End": 1187.66, "Text": " What's the time?"}, {"Time_Start": 1188.2, "Time_End": 1189.2, "Text": " We're doing good for time."}, {"Time_Start": 1190.94, "Time_End": 1191.44, "Text": " You want to go?"}, {"Time_Start": 1192.08, "Time_End": 1192.28, "Text": " Okay."}, {"Time_Start": 1192.68, "Time_End": 1197.38, "Text": " So on network level, what we can do is avoiding the stuff is obvious, right?"}, {"Time_Start": 1197.44, "Time_End": 1198.44, "Text": " We put a firewall in there."}, {"Time_Start": 1198.88, "Time_End": 1199.72, "Text": " This is easy as there."}, {"Time_Start": 1200.64, "Time_End": 1203.46, "Text": " When we want to create noise, we can play with interesting stuff."}, {"Time_Start": 1203.46, "Time_End": 1208.46, "Text": " We can play with, we can play with the honey-dee kind of configurations."}, {"Time_Start": 1208.94, "Time_End": 1211.7, "Text": " I've played with a transparent reverse proxy."}, {"Time_Start": 1212.0, "Time_End": 1215.78, "Text": " just because I found it to be a little bit easier at the time."}, {"Time_Start": 1216.98, "Time_End": 1219.54, "Text": " And what we can do is we can take random IPs."}, {"Time_Start": 1219.6, "Time_End": 1222.26, "Text": " We put random IPs up to be alive."}, {"Time_Start": 1223.22, "Time_End": 1226.56, "Text": " We can have random ports open on those machines."}, {"Time_Start": 1227.34, "Time_End": 1229.42, "Text": " This is not a big deal."}, {"Time_Start": 1230.32, "Time_End": 1233.18, "Text": " We can have fake network broadcasts."}, {"Time_Start": 1234.28, "Time_End": 1239.52, "Text": " And the nice thing that we can do is we can do a trace route interception in this direction."}, {"Time_Start": 1239.68, "Time_End": 1241.98, "Text": " If you look at trace route, what does it actually do?"}, {"Time_Start": 1242.0, "Time_End": 1247.9, "Text": " It sends a packet right, and it accepts back, ICMP TTL expired, correct?"}, {"Time_Start": 1248.9, "Time_End": 1256.5, "Text": " Now, that IP address that sending out the ICMP TTL expired can obviously be spoofed."}, {"Time_Start": 1257.5, "Time_End": 1264.76, "Text": " And if we spoofed that IP address, our trace-root engine at the other side is going to think that's the next hop,"}, {"Time_Start": 1265.18, "Time_End": 1268.96, "Text": " which means we can basically control the next hop or where we are going."}, {"Time_Start": 1270.74, "Time_End": 1271.74, "Text": " We'll show you that."}, {"Time_Start": 1272.0, "Time_End": 1276.24, "Text": " show you that live. Are we going to do it now? Okay, let's see it now."}, {"Time_Start": 1280.56, "Time_End": 1286.18, "Text": " Okay, what we used here is just to visually show it, we brought up, again, a demo version"}, {"Time_Start": 1286.18, "Time_End": 1291.84, "Text": " of Visual Route. Okay, and Visual Route at this point, tracing to some host behind a gateway"}, {"Time_Start": 1291.84, "Time_End": 1296.9, "Text": " that we control. We're not going to get name resolution here because we're not live on the net."}, {"Time_Start": 1297.66, "Time_End": 1301.98, "Text": " But what we should see is once it tries to get its name resolution going,"}, {"Time_Start": 1302.0, "Time_End": 1304.34, "Text": " if the demo gods are kind to us."}, {"Time_Start": 1306.92, "Time_End": 1310.86, "Text": " Just give it a few seconds, we hope."}, {"Time_Start": 1311.74, "Time_End": 1314.92, "Text": " Okay, at this point there's no packets actually going out on the network."}, {"Time_Start": 1315.12, "Time_End": 1317.34, "Text": " We should be seeing it come up on TCP dump."}, {"Time_Start": 1319.32, "Time_End": 1323.02, "Text": " Okay, what you're seeing here is ICMP packets getting to our gateway,"}, {"Time_Start": 1323.7, "Time_End": 1326.34, "Text": " and here you've got our gateway picking random hosts,"}, {"Time_Start": 1326.6, "Time_End": 1329.28, "Text": " sending results back to the trace route server."}, {"Time_Start": 1330.64, "Time_End": 1330.92, "Text": " Okay."}, {"Time_Start": 1332.0, "Time_End": 1337.22, "Text": " As it gets a packet, it just repackages it, it sends it back at the moment using a list of IPs"}, {"Time_Start": 1337.22, "Time_End": 1340.68, "Text": " that we picked from random three-letter agencies around the world."}, {"Time_Start": 1342.24, "Time_End": 1342.6, "Text": " Okay?"}, {"Time_Start": 1343.5, "Time_End": 1346.02, "Text": " So at this point, it's going to keep going."}, {"Time_Start": 1346.86, "Time_End": 1350.54, "Text": " Unfortunately, we're not live on the internet or you'd see interesting lines as this thing"}, {"Time_Start": 1350.54, "Time_End": 1353.66, "Text": " bounces around, trying to figure out where in the world you are."}, {"Time_Start": 1353.86, "Time_End": 1356.86, "Text": " We got that on a screenshot, so I'm going to show you that on this side."}, {"Time_Start": 1357.06, "Time_End": 1358.66, "Text": " But that's pretty much what this does."}, {"Time_Start": 1358.84, "Time_End": 1360.94, "Text": " Okay, the first hop you see it hitting our gateway."}, {"Time_Start": 1361.74, "Time_End": 1361.98, "Text": " Okay."}, {"Time_Start": 1362.0, "Time_End": 1367.52, "Text": " And after that, it's literally taking the IPs from our list until it decides to stop trying."}, {"Time_Start": 1368.26, "Time_End": 1375.5, "Text": " Okay, the IPs we can pick, you can make it as believable as you want, so you don't have to go Russia, Mongolia, UK."}, {"Time_Start": 1376.0, "Time_End": 1382.54, "Text": " You could bounce it around in the UK, bounce it around a little more just to add to effect, and it should be pretty good."}, {"Time_Start": 1382.54, "Time_End": 1389.54, "Text": " The interesting thing that we thought about there was actually, you know, showing the route going back into the attackers network."}, {"Time_Start": 1392.0, "Time_End": 1397.0, "Text": " So I'm going to show you what the slide looks like."}, {"Time_Start": 1397.0, "Time_End": 1402.0, "Text": " When we actually show, we've done it at the other side, and it looks like this."}, {"Time_Start": 1402.0, "Time_End": 1412.0, "Text": " Okay, so we got it going through the Russian Information Agency, the Bulgarian Government Network,"}, {"Time_Start": 1412.0, "Time_End": 1418.0, "Text": " and all sorts of interesting places where you wouldn't expect it to go, correct?"}, {"Time_Start": 1418.0, "Time_End": 1421.98, "Text": " Okay, and like I said, what we can do as well is"}, {"Time_Start": 1422.0, "Time_End": 1431.52, "Text": " basically intercepting all the, basically putting random machines live on this, on this network as we wish."}, {"Time_Start": 1431.82, "Time_End": 1435.4, "Text": " We actually have it in a cron drop that will change this every five minutes."}, {"Time_Start": 1435.4, "Time_End": 1437.8, "Text": " So it shuffles the whole network around a little bit."}, {"Time_Start": 1443.52, "Time_End": 1448.0, "Text": " Okay, so for now we're just going to kick off a port scan against the subnet."}, {"Time_Start": 1448.66, "Time_End": 1449.76, "Text": " Pretty straightforward."}, {"Time_Start": 1450.62, "Time_End": 1451.82, "Text": " What we're looking for here."}, {"Time_Start": 1452.0, "Time_End": 1457.0, "Text": " As Rolf mentioned, it's also just how most tools will interpret broadcast addresses."}, {"Time_Start": 1457.0, "Time_End": 1464.3, "Text": " Okay, there was recently a whole long thread on one of the security focus mail lists on how to determine a subnet of a company."}, {"Time_Start": 1464.84, "Time_End": 1471.12, "Text": " Okay, just about everyone uses broadcasts as a good indication of where networks are subnetted."}, {"Time_Start": 1471.84, "Time_End": 1477.86, "Text": " In this case, the tool randomly picks subnets and decides to return multiple replies for that."}, {"Time_Start": 1478.44, "Time_End": 1481.9, "Text": " So at this network, you've got, I think, about 15."}, {"Time_Start": 1482.0, "Time_End": 1487.1, "Text": " different subnet broadcast addresses and random hosts that appear to be up at any given time."}, {"Time_Start": 1488.2, "Time_End": 1494.04, "Text": " Yeah, and we can do this easily, if you look on this screen, sorry, we're going to take you from here to there to there, okay?"}, {"Time_Start": 1494.48, "Time_End": 1495.82, "Text": " It's like ten, you go."}, {"Time_Start": 1497.76, "Time_End": 1500.06, "Text": " You can see, here's a simple post script that does that."}, {"Time_Start": 1500.12, "Time_End": 1507.42, "Text": " We say we want seven web servers, three FTP service, and 20 generic ports spread across 12 IPs with five broadcasts."}, {"Time_Start": 1507.98, "Time_End": 1511.64, "Text": " Okay, this results into a whole lot of IPFW rules."}, {"Time_Start": 1512.0, "Time_End": 1514.0, "Text": " to set up the transparent proxies."}, {"Time_Start": 1514.0, "Time_End": 1518.0, "Text": " And then we have specialized listeners that gets those ports."}, {"Time_Start": 1518.0, "Time_End": 1522.0, "Text": " We're going to show you some of those just now."}, {"Time_Start": 1522.0, "Time_End": 1526.0, "Text": " Okay, that was for if the demo didn't work."}, {"Time_Start": 1526.0, "Time_End": 1532.0, "Text": " Okay, so we move on to the next level, which is your network application level,"}, {"Time_Start": 1532.0, "Time_End": 1535.0, "Text": " avoiding you just need to install your patches."}, {"Time_Start": 1535.0, "Time_End": 1538.0, "Text": " When you do noise in the system, that can get interesting."}, {"Time_Start": 1538.0, "Time_End": 1541.98, "Text": " We do fake banners, which is also not that, you know,"}, {"Time_Start": 1542.0, "Time_End": 1545.0, "Text": " but we can also start to play with combined banners."}, {"Time_Start": 1545.0, "Time_End": 1547.0, "Text": " Combine banner is basically a thing that says,"}, {"Time_Start": 1547.0, "Time_End": 1554.0, "Text": " I'm a WFTP 4.2 server and I'm a Microsoft FTP server,"}, {"Time_Start": 1554.0, "Time_End": 1556.0, "Text": " and in fact I've got a bigger entity crisis."}, {"Time_Start": 1556.0, "Time_End": 1559.0, "Text": " I'm all of the servers in the world that I can be."}, {"Time_Start": 1559.0, "Time_End": 1562.0, "Text": " Now, if you look at a Nes plugin and how they determine that banner,"}, {"Time_Start": 1562.0, "Time_End": 1566.0, "Text": " and some of the plugins look at it for the beginning of the stream, right?"}, {"Time_Start": 1566.0, "Time_End": 1571.0, "Text": " But a lot of the plugins actually looks at it anywhere within the stream."}, {"Time_Start": 1571.0, "Time_End": 1572.0, "Text": " And those plugins,"}, {"Time_Start": 1572.0, "Time_End": 1575.0, "Text": " if they look at the banner, they're all going to fire up now and say,"}, {"Time_Start": 1575.0, "Time_End": 1577.0, "Text": " well, you're running a bad version."}, {"Time_Start": 1577.0, "Time_End": 1579.0, "Text": " We can in fact go as far as saying,"}, {"Time_Start": 1579.0, "Time_End": 1581.0, "Text": " we want to build a nasal reverse interpreter,"}, {"Time_Start": 1581.0, "Time_End": 1585.0, "Text": " which says, if you see, normally how the nasal stuff works,"}, {"Time_Start": 1585.0, "Time_End": 1588.0, "Text": " is we send this and we accept that."}, {"Time_Start": 1588.0, "Time_End": 1591.0, "Text": " We're waiting for this kind of output."}, {"Time_Start": 1591.0, "Time_End": 1592.0, "Text": " If that output is here, we're going to trigger."}, {"Time_Start": 1592.0, "Time_End": 1595.0, "Text": " In this case, what we can do is we can do it the other way around."}, {"Time_Start": 1595.0, "Time_End": 1598.0, "Text": " And so when you see this kind of request"}, {"Time_Start": 1598.0, "Time_End": 1600.0, "Text": " respond in such a way,"}, {"Time_Start": 1600.0, "Time_End": 1602.0, "Text": " so that all the plugins is going to trigger,"}, {"Time_Start": 1602.0, "Time_End": 1604.0, "Text": " that thing, right?"}, {"Time_Start": 1604.0, "Time_End": 1606.0, "Text": " We haven't built it, it's a little bit difficult."}, {"Time_Start": 1606.0, "Time_End": 1609.0, "Text": " In killing network application level scanners,"}, {"Time_Start": 1609.0, "Time_End": 1613.0, "Text": " we can look for buffer overflows within the scanner itself,"}, {"Time_Start": 1613.0, "Time_End": 1615.0, "Text": " see if there's a buffer overflow in there."}, {"Time_Start": 1615.0, "Time_End": 1618.0, "Text": " We can look where it renders data, and a lot of the scanners"}, {"Time_Start": 1618.0, "Time_End": 1621.0, "Text": " actually render data in HTML."}, {"Time_Start": 1621.0, "Time_End": 1622.0, "Text": " So how cool is that?"}, {"Time_Start": 1622.0, "Time_End": 1625.0, "Text": " As soon as the scanner render stuff in HTML,"}, {"Time_Start": 1625.0, "Time_End": 1629.0, "Text": " what do you think happens when I put a HTTP redirect to a porn site"}, {"Time_Start": 1629.0, "Time_End": 1631.0, "Text": " within my banner, right?"}, {"Time_Start": 1631.0, "Time_End": 1633.0, "Text": " Okay, the scanner's going to pick it up."}, {"Time_Start": 1633.0, "Time_End": 1636.0, "Text": " It's going to display that banner at some stage."}, {"Time_Start": 1636.0, "Time_End": 1639.0, "Text": " And if my application that's displaying that data"}, {"Time_Start": 1639.0, "Time_End": 1645.0, "Text": " is not escaping the HTML, I can basically put anything into the report."}, {"Time_Start": 1645.0, "Time_End": 1647.0, "Text": " Okay?"}, {"Time_Start": 1647.0, "Time_End": 1652.0, "Text": " We can look at where the scanner actually puts data into a database."}, {"Time_Start": 1652.0, "Time_End": 1655.0, "Text": " So we've all played with S-KL injection, correct?"}, {"Time_Start": 1655.0, "Time_End": 1658.0, "Text": " And we love playing with S-KL injection on our victims."}, {"Time_Start": 1658.0, "Time_End": 1661.0, "Text": " Well, imagine if someone is now playing with S-KL injection"}, {"Time_Start": 1661.0, "Time_End": 1665.0, "Text": " I don't want to say on your tool, that just sounds wrong."}, {"Time_Start": 1665.0, "Time_End": 1670.0, "Text": " Where someone is actually using SKL injection on your scanner,"}, {"Time_Start": 1670.0, "Time_End": 1673.0, "Text": " now you've got to look at how you parse your input,"}, {"Time_Start": 1673.0, "Time_End": 1676.0, "Text": " your input being the output of the banners, right?"}, {"Time_Start": 1676.0, "Time_End": 1679.0, "Text": " We're going to look at an example of that just now."}, {"Time_Start": 1679.0, "Time_End": 1682.0, "Text": " And then, of course, scanners that use other scanners."}, {"Time_Start": 1682.0, "Time_End": 1684.0, "Text": " Everybody's going to scatter these days."}, {"Time_Start": 1684.0, "Time_End": 1687.0, "Text": " And basically we only have a couple of real good scanners,"}, {"Time_Start": 1687.0, "Time_End": 1690.0, "Text": " but people build a scanner and then they use,"}, {"Time_Start": 1690.0, "Time_End": 1693.68, "Text": " like they use NMAP or NNES within their scanner to actually do the work."}, {"Time_Start": 1694.4, "Time_End": 1699.0, "Text": " So you've got to be careful when you're getting the data off your actual scanner."}, {"Time_Start": 1699.0, "Time_End": 1700.0, "Text": " Okay?"}, {"Time_Start": 1700.0, "Time_End": 1702.0, "Text": " We're going to go into examples of that."}, {"Time_Start": 1702.0, "Time_End": 1705.0, "Text": " Let me just see what I have in here."}, {"Time_Start": 1705.0, "Time_End": 1707.0, "Text": " That's not just some of the tools."}, {"Time_Start": 1709.0, "Time_End": 1717.0, "Text": " Okay, what we've got here quickly just to set up a concept is an example of a bad banner running on an FTP server."}, {"Time_Start": 1717.0, "Time_End": 1719.0, "Text": " Okay, in this case the FTP server is a generic listener."}, {"Time_Start": 1719.0, "Time_End": 1725.0, "Text": " generic listener. An FTP to it gives back a whole bunch of meta characters."}, {"Time_Start": 1725.0, "Time_End": 1729.0, "Text": " Okay, but one of the things that's really interesting is a concept that we borrowed from"}, {"Time_Start": 1729.0, "Time_End": 1735.0, "Text": " a paper written by H.D. Moore on terminal security."}, {"Time_Start": 1735.0, "Time_End": 1739.0, "Text": " Okay, in this case, the X term that we're running it allowed the banner that came back"}, {"Time_Start": 1739.0, "Time_End": 1742.0, "Text": " to inject characters into the title bar."}, {"Time_Start": 1742.0, "Time_End": 1744.0, "Text": " Okay, so as soon as the guy connects,"}, {"Time_Start": 1744.0, "Time_End": 1748.0, "Text": " what he's got up here is messing with sense post you are owned you will become."}, {"Time_Start": 1748.0, "Time_End": 1749.0, "Text": " Okay."}, {"Time_Start": 1749.0, "Time_End": 1752.44, "Text": " Okay, we're going to borrow that again in a few minutes."}, {"Time_Start": 1753.04, "Time_End": 1757.12, "Text": " But also what you see is at this point, we're just spraying and playing."}, {"Time_Start": 1757.36, "Time_End": 1760.0, "Text": " Okay, we've got a pipe RM minus RF in there."}, {"Time_Start": 1760.44, "Time_End": 1762.64, "Text": " We've got an HTTP redirect in there."}, {"Time_Start": 1763.0, "Time_End": 1767.12, "Text": " So pretty much we're saying, let a scanner hit this and let's see what results come out of it."}, {"Time_Start": 1768.24, "Time_End": 1769.32, "Text": " You're going to go on to the..."}, {"Time_Start": 1769.32, "Time_End": 1770.14, "Text": " No, no, just hang up."}, {"Time_Start": 1770.14, "Time_End": 1770.18, "Text": " Okay."}, {"Time_Start": 1771.38, "Time_End": 1775.72, "Text": " Okay, so for the people that can't see over there, I've got a little bit enlarged over here."}, {"Time_Start": 1776.16, "Time_End": 1777.26, "Text": " So you see the banner over there."}, {"Time_Start": 1777.52, "Time_End": 1778.98, "Text": " You see we're trying S-scale injection."}, {"Time_Start": 1779.0, "Time_End": 1780.66, "Text": " just with a simple 1 equals 1."}, {"Time_Start": 1781.08, "Time_End": 1783.52, "Text": " You've got the RM minus RF on 10th there,"}, {"Time_Start": 1783.96, "Time_End": 1785.8, "Text": " and it's just a nasty thing."}, {"Time_Start": 1786.16, "Time_End": 1791.76, "Text": " When we run a NACIS against this particular FTP server,"}, {"Time_Start": 1793.46, "Time_End": 1793.62, "Text": " okay?"}, {"Time_Start": 1795.76, "Time_End": 1797.32, "Text": " Oh, no, no, I don't have that."}, {"Time_Start": 1797.52, "Time_End": 1798.36, "Text": " Sorry."}, {"Time_Start": 1799.02, "Time_End": 1799.3, "Text": " Sorry. Okay."}, {"Time_Start": 1800.18, "Time_End": 1800.46, "Text": " Okay."}, {"Time_Start": 1801.56, "Time_End": 1802.02, "Text": " Yep."}, {"Time_Start": 1802.5, "Time_End": 1806.06, "Text": " The second thing we want to go through pretty much in the same term,"}, {"Time_Start": 1806.34, "Time_End": 1807.84, "Text": " in the same issues,"}, {"Time_Start": 1808.34, "Time_End": 1808.94, "Text": " again,"}, {"Time_Start": 1809.0, "Time_End": 1815.12, "Text": " server security is actually a strikeback at people running MetaSploit on insecure terms."}, {"Time_Start": 1815.56, "Time_End": 1818.62, "Text": " Okay, I'm not sure how many of you caught it, but Metasploits absolutely killer."}, {"Time_Start": 1818.96, "Time_End": 1821.3, "Text": " The guys gave a really good demonstration yesterday."}, {"Time_Start": 1821.96, "Time_End": 1825.52, "Text": " In this case, we've got a fake web server sitting up here."}, {"Time_Start": 1826.04, "Time_End": 1831.0, "Text": " Okay, and what we've got up here at the moment is the web server running in invisible mode."}, {"Time_Start": 1831.0, "Time_End": 1833.88, "Text": " Sorry, I'm just going to kill that and instead run it invisible."}, {"Time_Start": 1837.48, "Time_End": 1838.24, "Text": " Okay, screw."}, {"Time_Start": 1838.24, "Time_End": 1838.98, "Text": " Let's just go visible."}, {"Time_Start": 1839.0, "Time_End": 1843.66, "Text": " Okay, basically, I've got the MSF CLI here."}, {"Time_Start": 1844.0, "Time_End": 1850.5, "Text": " Okay, so I'm just running Medisploit, picking an IIS, printer overflow, and asking for it to bind to Port 80."}, {"Time_Start": 1851.24, "Time_End": 1856.24, "Text": " Okay, as the connect goes through, okay, you should see it get a return connection."}, {"Time_Start": 1857.08, "Time_End": 1863.4, "Text": " And then what it does, okay, if you're quick enough, you would have seen the title bar change briefly to LS minus AL."}, {"Time_Start": 1864.26, "Time_End": 1868.28, "Text": " Okay, and then it goes and drops LS minus AL on the command line."}, {"Time_Start": 1868.72, "Time_End": 1868.92, "Text": " Okay."}, {"Time_Start": 1869.0, "Time_End": 1879.68, "Text": " This example, taken straight from HTML's terminal server security paper, okay, and basically the thinking here is, what do you do the moment you get a remote shell pop up once you run an exploit?"}, {"Time_Start": 1880.04, "Time_End": 1882.74, "Text": " Okay, just about everyone, the first thing they do is hit enter."}, {"Time_Start": 1883.36, "Time_End": 1892.36, "Text": " Okay, so if we're feeling particularly evil, we could kill this, and instead, okay, I'm just going to drop the mic for a second, or if my useful assistant holds it for me."}, {"Time_Start": 1893.22, "Time_End": 1897.78, "Text": " Okay, we're going to run the same command again."}, {"Time_Start": 1899.0, "Time_End": 1901.56, "Text": " If you get that out of my face."}, {"Time_Start": 1901.66, "Time_End": 1903.1, "Text": " Okay, we're going to run the same thing again."}, {"Time_Start": 1903.54, "Time_End": 1904.62, "Text": " Run it on port 80."}, {"Time_Start": 1905.08, "Time_End": 1911.96, "Text": " This time we tell it to run in invisible mode, and this time we tell it RM minus, no, okay, let's just do LS minus AL again."}, {"Time_Start": 1913.44, "Time_End": 1919.98, "Text": " Okay, so I'm going to run that, you got it listening in invisible mode, the exact same command that we just ran."}, {"Time_Start": 1920.62, "Time_End": 1928.38, "Text": " Okay, and this time, you see, get its reverse connection, okay, and drop you into what looks like a shell."}, {"Time_Start": 1928.38, "Time_End": 1933.42, "Text": " except this time it also includes the escape meta characters to make your text invisible."}, {"Time_Start": 1934.2600000000002, "Time_End": 1938.7800000000002, "Text": " Okay, so what you're sitting with at your command line now is the command that we decided to inject."}, {"Time_Start": 1939.2800000000002, "Time_End": 1944.8400000000001, "Text": " Okay, you hit your enter, and that's the results of the LS minus AL running on your invisible term."}, {"Time_Start": 1945.5200000000002, "Time_End": 1950.18, "Text": " Okay, so the next time you get a remote shell pop up on your machine, you want to make sure that it's a shell"}, {"Time_Start": 1950.18, "Time_End": 1953.1000000000001, "Text": " and not something like screw term coming back at you."}, {"Time_Start": 1953.66, "Time_End": 1956.9, "Text": " Okay, again, it's not a problem with metasploid."}, {"Time_Start": 1958.38, "Time_End": 1965.98, "Text": " Okay, just to confirm again, it's not a problem with Medisploit."}, {"Time_Start": 1966.5200000000002, "Time_End": 1973.5, "Text": " What we are saying is, it's cool if you want to use tools, now secure your term before you decide to tell me my network's insecure."}, {"Time_Start": 1974.0200000000002, "Time_End": 1978.64, "Text": " Okay, so start, this is genetic X term, nothing special done to it."}, {"Time_Start": 1979.74, "Time_End": 1986.0400000000002, "Text": " Okay, so let's look at, this was if our demo didn't work, which you did."}, {"Time_Start": 1987.0, "Time_End": 1988.16, "Text": " Okay, now let's look at that."}, {"Time_Start": 1988.38, "Time_End": 1994.0800000000002, "Text": " level. Okay. So I'm going to look at application level and generally at web server"}, {"Time_Start": 1994.0800000000002, "Time_End": 2001.48, "Text": " assessments. Well, if we want to avoid it, we need an application level firewall, which is beginning"}, {"Time_Start": 2001.48, "Time_End": 2007.5800000000002, "Text": " to become a reality nowadays, which is quite cool. You're on the life, you're on then, eh?"}, {"Time_Start": 2008.38, "Time_End": 2017.24, "Text": " Okay. And what you can do there, I don't know if you've seen Samuel Shaw's talk on PHP guard."}, {"Time_Start": 2017.24, "Time_End": 2018.74, "Text": " Did anyone see it at Black Hat?"}, {"Time_Start": 2019.78, "Time_End": 2023.06, "Text": " If you haven't, then wait for the paper to come out, it's really kick as."}, {"Time_Start": 2024.64, "Time_End": 2028.04, "Text": " Okay, what we're going to do there, I'm going to briefly explain to you what we're going to do there."}, {"Time_Start": 2028.4, "Time_End": 2040.44, "Text": " Basically, what we can do is we can return random 404s, the 302s, 500s, 200s, on any of the listeners that we have on that firewall, correct?"}, {"Time_Start": 2041.7, "Time_End": 2043.52, "Text": " Now, we wanted to do it in two ways."}, {"Time_Start": 2043.6200000000001, "Time_End": 2045.06, "Text": " We actually have two versions of these."}, {"Time_Start": 2045.06, "Time_End": 2058.74, "Text": " The one version just don't return enough results for a tool like Nettoe to actually realize that it's getting too many fake 4s coming back, right?"}, {"Time_Start": 2059.0, "Time_End": 2065.86, "Text": " So it basically shows your report, and all of those things are just about, are just nonsense."}, {"Time_Start": 2066.16, "Time_End": 2071.18, "Text": " They're not really there, right? Because we can control exactly the error code that we're sending back."}, {"Time_Start": 2072.2999999999997, "Time_End": 2075.04, "Text": " If you look at Nessus, they've got this plugin that they can."}, {"Time_Start": 2075.06, "Time_End": 2077.12, "Text": " call no 4-4, right?"}, {"Time_Start": 2077.62, "Time_End": 2083.36, "Text": " What basically happens with No 4-4 plugin is that we test for a couple of files that we know"}, {"Time_Start": 2083.36, "Time_End": 2085.7, "Text": " will never exist on the system, okay?"}, {"Time_Start": 2086.5, "Time_End": 2090.88, "Text": " And if we find that for those files that we, that does not exist in the system,"}, {"Time_Start": 2091.44, "Time_End": 2097.08, "Text": " if we find that there's a 200 coming back for those, then we say, well, these guys are"}, {"Time_Start": 2097.08, "Time_End": 2103.7799999999997, "Text": " actually doing something, they're not really returning a nice 200 or a 4-4, so we better be careful"}, {"Time_Start": 2103.7799999999997, "Time_End": 2104.34, "Text": " what we do."}, {"Time_Start": 2105.06, "Time_End": 2109.86, "Text": " In our case, we can know exactly, we know what this string is that NACIS test for."}, {"Time_Start": 2109.86, "Time_End": 2113.74, "Text": " It's called capital NN, NACTS test, capital T."}, {"Time_Start": 2113.74, "Time_End": 2119.4, "Text": " So when we see NACTS test coming through on the system, we send it a nice, gently formed"}, {"Time_Start": 2119.4, "Time_End": 2125.56, "Text": " 404, and for anything else, we just give it Bogi's information, which means that plug-in,"}, {"Time_Start": 2125.56, "Time_End": 2129.2999999999997, "Text": " the no 404 plug-in, never triggers."}, {"Time_Start": 2129.2999999999997, "Time_End": 2131.56, "Text": " And now we can control all of the rest."}, {"Time_Start": 2131.56, "Time_End": 2133.24, "Text": " I'm going to show you what it looks like."}, {"Time_Start": 2133.24, "Time_End": 2135.04, "Text": " And within that piece,"}, {"Time_Start": 2135.06, "Time_End": 2140.06, "Text": " application itself, we can go crazy, right? We can have bogus forms, bogus fields."}, {"Time_Start": 2140.06, "Time_End": 2145.68, "Text": " As soon as we detect that someone is in there trying to scan us, and we can do that."}, {"Time_Start": 2145.68, "Time_End": 2150.38, "Text": " Samuel did it nicely, we didn't do it like that, but he says, let's put an invisible pixel"}, {"Time_Start": 2150.38, "Time_End": 2155.18, "Text": " on the screen, right? A user is never going to click on that invisible pixel because you can't"}, {"Time_Start": 2155.18, "Time_End": 2160.2999999999997, "Text": " see it. But a trolling tool, a kind of a spider tool, that kind of thing, is going to click on"}, {"Time_Start": 2160.2999999999997, "Time_End": 2164.96, "Text": " it, correct, because it's a link that's there. And as soon as you see that tool clicking on that link,"}, {"Time_Start": 2165.06, "Time_End": 2170.2599999999998, "Text": " a trawler, clicking on the ring or mirroring site, mirroring tool, then we know that it's"}, {"Time_Start": 2170.2599999999998, "Time_End": 2175.46, "Text": " a machine on the other side that's trying to attack us, okay?"}, {"Time_Start": 2175.46, "Time_End": 2182.42, "Text": " If we want to stop this, if we want to stop automated application level tools, we can"}, {"Time_Start": 2182.42, "Time_End": 2189.22, "Text": " build what we call a spider trap, and it also works for spiders, of course, and a spider trap is basically"}, {"Time_Start": 2189.22, "Time_End": 2195.04, "Text": " a page that contains links. When you click on a link, you get another link. And if you"}, {"Time_Start": 2195.06, "Time_End": 2199.24, "Text": " click on that link, you get another link, and so forth and so on. I'm going to show you a screenshot of that."}, {"Time_Start": 2201.44, "Time_End": 2206.72, "Text": " What we can also do is we can build in there what I call human detectors or browser detectors,"}, {"Time_Start": 2206.72, "Time_End": 2213.14, "Text": " which we're going to go into just in a bit. And what we can do in the killing bit, this is the stopping"}, {"Time_Start": 2213.14, "Time_End": 2218.94, "Text": " bit, if we want to go into kill actually the application or attack that application, I don't know how many"}, {"Time_Start": 2218.94, "Time_End": 2225.04, "Text": " of you have seen that page that says, you are a idiot. Ha ha ha ha ha ha. You've seen it. You've seen"}, {"Time_Start": 2225.06, "Time_End": 2231.82, "Text": " that. It's a small little flash that runs within a browser, and we can't ever stop that."}, {"Time_Start": 2231.82, "Time_End": 2235.98, "Text": " If we try to kill that window, it spawns off another seven windows that starts bouncing"}, {"Time_Start": 2235.98, "Time_End": 2241.04, "Text": " around on the screen. You've seen it, right? Now, what we can do is we can take code like that"}, {"Time_Start": 2241.04, "Time_End": 2245.88, "Text": " or any other kind of malicious HTML code that we would wish to want, and we can put that"}, {"Time_Start": 2245.88, "Time_End": 2254.14, "Text": " into our listener that's basically listening on random IPs. Okay? The other thing that we can do is"}, {"Time_Start": 2254.14, "Time_End": 2261.74, "Text": " we can simply take a file that's a very nasty virus or let's say a very nasty denial"}, {"Time_Start": 2261.74, "Time_End": 2268.8199999999997, "Text": " of service attack tool, create a directory on our website called slash admin or slash secret"}, {"Time_Start": 2268.8199999999997, "Time_End": 2275.48, "Text": " or something like this, right? Take that EXE, call it admin tool.exe and copy it in there."}, {"Time_Start": 2276.02, "Time_End": 2283.0, "Text": " Now a normal user will never see that, right? But someone that's scanning your neck with something like"}, {"Time_Start": 2283.0, "Time_End": 2286.96, "Text": " NETO-NES, going to say, there's an interesting directory called Secret."}, {"Time_Start": 2288.46, "Time_End": 2294.38, "Text": " And we make that slash secret indexable so that a guy can serve to it, see, there's a tool says"}, {"Time_Start": 2294.38, "Time_End": 2299.06, "Text": " admin tool, or don't run this, or secret.exe. What do you think they're going to do? They're going to"}, {"Time_Start": 2299.06, "Time_End": 2304.68, "Text": " pull it down, run on a local machine, and take out the whole network. Okay? Again, remember the"}, {"Time_Start": 2304.68, "Time_End": 2312.98, "Text": " legal implication? Okay. All right. So, so this is a, it's a, it's a, you know,"}, {"Time_Start": 2313.0, "Time_End": 2320.5, "Text": " there's a screenshot of what NACIS looks like, the output of NESWX, when you run it against one of these,"}, {"Time_Start": 2321.5, "Time_End": 2329.18, "Text": " when you run it against one of these sites, and you'd find out that it's basically triggering on just about any plugin that you can find."}, {"Time_Start": 2330.18, "Time_End": 2340.66, "Text": " The idea would be that if someone sees there's a thing called, what is this, VSetCookie.E, if they actually go to that page and search to that page,"}, {"Time_Start": 2341.16, "Time_End": 2342.98, "Text": " we know that there's no such web server."}, {"Time_Start": 2343.0, "Time_End": 2348.68, "Text": " it's one of our listeners. And that's going to result in a page like that on the right"}, {"Time_Start": 2348.68, "Time_End": 2354.86, "Text": " hand side. We wanted to show you this live here, but there were some issues with the internet"}, {"Time_Start": 2354.86, "Time_End": 2361.38, "Text": " connectivity. And on the left-hand side, what you see is you see what a spider trap typically"}, {"Time_Start": 2361.38, "Time_End": 2366.38, "Text": " looks like. So you've got lots of, lots of links, random links, basically just points into other"}, {"Time_Start": 2366.38, "Time_End": 2371.98, "Text": " links. And if you have automated web assessment tool that basically crawls the site, it's going"}, {"Time_Start": 2371.98, "Time_End": 2377.62, "Text": " to run into this and it's never ever going to stop. Okay, so the very last section"}, {"Time_Start": 2377.62, "Time_End": 2382.96, "Text": " where we want to tell you about is the thing that we called armpit. It was like we thought about"}, {"Time_Start": 2382.96, "Time_End": 2387.78, "Text": " tarpits and then we thought about, you know, something that's smelly and nasty, so we thought"}, {"Time_Start": 2387.78, "Time_End": 2394.94, "Text": " about armpits. Okay, and an armpits we use against automation, really worms and that kind of thing."}, {"Time_Start": 2395.58, "Time_End": 2401.7, "Text": " So let me tell you how we got about that. On our website, we had this, the marketing people"}, {"Time_Start": 2401.7000000000003, "Time_End": 2406.8, "Text": " decided we need to have this flash intro to our website. And it had a little thing in there"}, {"Time_Start": 2406.8, "Time_End": 2412.86, "Text": " that says skip intro, which everybody clicks on always, right? So what I've done is I looked"}, {"Time_Start": 2412.86, "Time_End": 2419.34, "Text": " at that flash intro and I basically took away the link that says skip intro. And then if"}, {"Time_Start": 2419.34, "Time_End": 2424.9800000000005, "Text": " you try to mirror the site, you find that you can't mirror it because your mirroring tool can't understand"}, {"Time_Start": 2424.9800000000005, "Time_End": 2430.86, "Text": " flash and it can never get to the end of the movie that redirects the spider into the actual site."}, {"Time_Start": 2430.86, "Time_End": 2433.0, "Text": " So I thought, hey, that's interesting."}, {"Time_Start": 2433.4, "Time_End": 2440.1, "Text": " I spoke to the developer. I said, can you make me a movie that's one pixel big and that's zero seconds long?"}, {"Time_Start": 2440.7000000000003, "Time_End": 2442.86, "Text": " It's like, eh? You know?"}, {"Time_Start": 2444.36, "Time_End": 2448.82, "Text": " Well, just do it and give me the redirect into the site."}, {"Time_Start": 2448.9, "Time_End": 2452.08, "Text": " So we started playing, we started to playing with flash stuff."}, {"Time_Start": 2452.84, "Time_End": 2456.6, "Text": " And basically what we built is a small little thing that runs on a network level,"}, {"Time_Start": 2457.4, "Time_End": 2460.46, "Text": " it runs on a session level, and it acts as a proxy."}, {"Time_Start": 2460.86, "Time_End": 2464.08, "Text": " and it sits between you and your website."}, {"Time_Start": 2464.88, "Time_End": 2468.86, "Text": " And basically what happens is it uses flash to create a session ID,"}, {"Time_Start": 2469.54, "Time_End": 2476.34, "Text": " dynamically it builds up a flashplate, that creates a session ID in terms of, as a request to the site."}, {"Time_Start": 2477.6600000000003, "Time_End": 2482.2000000000003, "Text": " Okay? When we see that request, a valid request with a valid checks I'm coming through,"}, {"Time_Start": 2482.4, "Time_End": 2485.4, "Text": " we generate a cookie, we send that cookie back to the browser."}, {"Time_Start": 2486.1200000000003, "Time_End": 2490.84, "Text": " The browser now makes new connection with that cookie. And if the cookie is there,"}, {"Time_Start": 2490.86, "Time_End": 2495.02, "Text": " the cookies check sum is good. We say, that's right. You can relay it through the site."}, {"Time_Start": 2495.1200000000003, "Time_End": 2498.82, "Text": " I'm going to show you, I'm going to show you what that looks like. It looks a little bit like this."}, {"Time_Start": 2499.1400000000003, "Time_End": 2503.94, "Text": " So we've got incoming connection. Is it a valid cookie? If it's not a valid cookie,"}, {"Time_Start": 2503.94, "Time_End": 2509.2400000000002, "Text": " the first request will never be a valid cookie. We say, is it a valid requesting? Is the check sum correct?"}, {"Time_Start": 2509.9, "Time_End": 2513.76, "Text": " If the check sum was correct, we built the flash page. We send it back to the client."}, {"Time_Start": 2514.7000000000003, "Time_End": 2520.08, "Text": " Now it says, do we have a valid cookie? Now we don't. Is it a valid requesting? Yes. Okay."}, {"Time_Start": 2520.08, "Time_End": 2523.3199999999997, "Text": " We'll send a cookie to the user with a checksum in."}, {"Time_Start": 2523.7, "Time_End": 2526.1, "Text": " Now the user's got the cookie. Makes a connection again."}, {"Time_Start": 2526.56, "Time_End": 2528.7599999999998, "Text": " Does he have a valid cookie? Yes, he's got a valid cookie."}, {"Time_Start": 2529.14, "Time_End": 2530.64, "Text": " And now we can reload this."}, {"Time_Start": 2531.7, "Time_End": 2533.8199999999997, "Text": " So what Arun's going to do, no, no, no, no, no."}, {"Time_Start": 2533.98, "Time_End": 2539.7, "Text": " What Arun's going to do is he's going to simply tell net to a site that's running that."}, {"Time_Start": 2540.64, "Time_End": 2550.06, "Text": " If we tell me to that IP address that we're running that site, oh, not two, one and two, one and two, one or something."}, {"Time_Start": 2550.08, "Time_End": 2554.92, "Text": " 6.8, when I'm 2.10, hey? Let's go. Okay."}, {"Time_Start": 2557.02, "Time_End": 2564.9, "Text": " Can you just do the Control L? Okay. Basically what you're going to see is,"}, {"Time_Start": 2564.9, "Time_End": 2574.2, "Text": " before he even starts to send stuff in there, okay, we immediately get back a flash page, right?"}, {"Time_Start": 2574.2999999999997, "Time_End": 2579.92, "Text": " That's a flash page that we dynamically build. Okay. So it doesn't matter what it puts in"}, {"Time_Start": 2580.08, "Time_End": 2584.16, "Text": " the network level, we're always sending him back to this flash plate. And in order to"}, {"Time_Start": 2584.16, "Time_End": 2588.58, "Text": " actually go to the site, he needs to interpret the flash. So you don't get a lot of guys"}, {"Time_Start": 2588.58, "Time_End": 2593.96, "Text": " coding the exploit going, well, you know, this exploit, we need to make this exploit flash aware."}, {"Time_Start": 2593.96, "Time_End": 2601.2, "Text": " Okay? And this is the whole idea. The idea is that we can identify our browser. We can identify"}, {"Time_Start": 2601.2, "Time_End": 2606.94, "Text": " that the user is using a browser. We can, we can combine that, okay, that's just what it looks"}, {"Time_Start": 2606.94, "Time_End": 2610.06, "Text": " like. We can combine that with a firewall that"}, {"Time_Start": 2610.08, "Time_End": 2614.96, "Text": " It only allows this stuff into our relay in different ways. We can do it either with"}, {"Time_Start": 2614.96, "Time_End": 2619.86, "Text": " a human detector there. We can have it running on Port 80 and our real site running on Port"}, {"Time_Start": 2619.86, "Time_End": 2626.1, "Text": " 81, which is exactly what we're doing over here. And lastly, what we can do is we can start"}, {"Time_Start": 2626.1, "Time_End": 2633.06, "Text": " combining that. See, this slide doesn't come up nice. We can combine this with the IPS, okay,"}, {"Time_Start": 2633.06, "Time_End": 2637.84, "Text": " which is we basically now have a bad cookie jar over there. And if we see someone doing something"}, {"Time_Start": 2637.84, "Time_End": 2642.84, "Text": " wrong, we just send the guy, we close the connection, we mark the cookie as bad, and"}, {"Time_Start": 2642.84, "Time_End": 2648.5, "Text": " we basically now track, bad cookies are not good cookies, right? So what we're going to do on this"}, {"Time_Start": 2648.5, "Time_End": 2653.84, "Text": " side is a woman's going to show you when he goes to the site what's going to happen. Now we're"}, {"Time_Start": 2653.84, "Time_End": 2658.6000000000004, "Text": " running two BMW images in here, so it's going to be a little bit slow. But what you will see"}, {"Time_Start": 2658.6000000000004, "Time_End": 2663.52, "Text": " is a quick flash there in the right-hand corner, which is the flash that's actually executing."}, {"Time_Start": 2663.52, "Time_End": 2667.82, "Text": " And then, there you saw it, and then you see it coming back."}, {"Time_Start": 2667.84, "Time_End": 2673.2200000000003, "Text": " to the actual page. Now remember at this stage, he's got the cookie, so he can basically"}, {"Time_Start": 2673.2200000000003, "Time_End": 2679.38, "Text": " surf into the site as he wish for now, the cookie never expires. And it doesn't have to go"}, {"Time_Start": 2679.38, "Time_End": 2683.58, "Text": " through the whole flash exercise again. It's only the very first time that it connects there."}, {"Time_Start": 2683.58, "Time_End": 2690.58, "Text": " Okay, so that's an interesting thing on a network, on a wear application level. When he puts"}, {"Time_Start": 2690.58, "Time_End": 2697.82, "Text": " in something bad in there, okay, we can detect it. So if he puts in a single quote, um,"}, {"Time_Start": 2697.84, "Time_End": 2702.2400000000002, "Text": " let's just do ex-pick-comanshal. We don't have all our signatures in there."}, {"Time_Start": 2702.32, "Time_End": 2706.04, "Text": " We basically, we don't want to build the IPS, right? Not right now."}, {"Time_Start": 2715.08, "Time_End": 2717.96, "Text": " Then it says, you are naughty. I will blacklist your cookie."}, {"Time_Start": 2718.28, "Time_End": 2724.2000000000003, "Text": " Now that cookie is destroyed. If the cookie is destroyed, he's got to go through the flash exercise again."}, {"Time_Start": 2725.08, "Time_End": 2727.42, "Text": " Okay, so a scanner is going to trigger that every time."}, {"Time_Start": 2727.84, "Time_End": 2733.5, "Text": " time. Okay. Lastly, what we're going to look at is on content level, I'm just going to"}, {"Time_Start": 2733.5, "Time_End": 2738.1000000000004, "Text": " spend a minute on this. This is basically when you think someone is sniffing your traffic and"}, {"Time_Start": 2738.1000000000004, "Time_End": 2742.34, "Text": " reading your email. You can do a whole lot of interesting things within then. You can throw"}, {"Time_Start": 2742.34, "Time_End": 2748.48, "Text": " them bait, right? I can send a mail to Arun saying, dude, you know what? There's lots of secret"}, {"Time_Start": 2748.48, "Time_End": 2753.7200000000003, "Text": " stuff on this website. There's no such, there is a website. Nobody ever looks at it. We"}, {"Time_Start": 2753.7200000000003, "Time_End": 2757.82, "Text": " basically just look at the logs and we put some very nasty malicious."}, {"Time_Start": 2757.84, "Time_End": 2763.98, "Text": " just HTML code in there. And we see if someone hits that site, ever. Now, if anyone"}, {"Time_Start": 2763.98, "Time_End": 2771.34, "Text": " hits that site, we know it's someone reading our email, correct? We can do the same thing"}, {"Time_Start": 2771.34, "Time_End": 2778.76, "Text": " with basically creating traffic that bites back. Like we know there's some issues in some"}, {"Time_Start": 2778.76, "Time_End": 2783.8, "Text": " of the sniffing technologies, which means if I send a particular string through there, it's going"}, {"Time_Start": 2783.8, "Time_End": 2787.6800000000003, "Text": " to break the sniffer, right? It's going to cause a buffer overflow in the sniffer itself."}, {"Time_Start": 2787.84, "Time_End": 2798.54, "Text": " And we can start looking at putting our offensive kind of technologies into, well, we can put our offensive"}, {"Time_Start": 2798.54, "Time_End": 2803.96, "Text": " technologies there where our sniffer is actually going to read our stuff, right? So we send through"}, {"Time_Start": 2803.96, "Time_End": 2809.52, "Text": " data all the time that's basically causing the sniffer to break, and in that case, in some cases"}, {"Time_Start": 2809.52, "Time_End": 2815.42, "Text": " we might even attack the guy that's sniffing our traffic. So that on a content level, and I think"}, {"Time_Start": 2815.42, "Time_End": 2817.1800000000003, "Text": " they want to throw me off the stage by now."}, {"Time_Start": 2817.18, "Time_End": 2824.96, "Text": " So if there's any questions, we're going to be outside basically at the pool area, but I think we need to get off here."}, {"Time_Start": 2824.96, "Time_End": 2827.98, "Text": " Thanks all for your attention, and I hope you enjoyed it."}]}