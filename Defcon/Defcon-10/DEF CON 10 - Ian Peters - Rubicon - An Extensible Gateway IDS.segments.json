{"segments": [{"Time_Start": 0.0, "Time_End": 6.0, "Text": " Okay, I'll start now then."}, {"Time_Start": 6.0, "Time_End": 12.0, "Text": " I'm Ian Peters, I'm going to be talking about Rubicon, an extensive IDFs."}, {"Time_Start": 12.0, "Time_End": 17.0, "Text": " First about a bit about me and I look at what we're going to be doing."}, {"Time_Start": 17.0, "Time_End": 22.0, "Text": " I until very recently was studying in London, at Bureau College, now graduated,"}, {"Time_Start": 22.0, "Time_End": 26.0, "Text": " and this project was my final year degree project."}, {"Time_Start": 26.0, "Time_End": 29.0, "Text": " It sort of started with Thomas Munn's,"}, {"Time_Start": 29.0, "Time_End": 40.0, "Text": " Mons presentation in Defcom 9 in which he mentioned the idea of active IDS, basically an IDS which can root an integration of a firewall and an IDS."}, {"Time_Start": 40.0, "Time_End": 44.0, "Text": " Now some of the problems I came across were, well, academia."}, {"Time_Start": 44.0, "Time_End": 46.0, "Text": " They don't seem to like products."}, {"Time_Start": 46.0, "Time_End": 51.0, "Text": " They like algorithms, that's cool, but actually trying to even let them do this was a bit of an art."}, {"Time_Start": 51.0, "Time_End": 58.0, "Text": " Now in about seven hours before I was due to presentation, I had a head crash and all my backups were screwed."}, {"Time_Start": 58.0, "Time_End": 60.0, "Text": " were screwed, so that was a bit of an issue."}, {"Time_Start": 60.0, "Time_End": 64.0, "Text": " And tested backups, if there's one thing you're going to learn today."}, {"Time_Start": 64.0, "Time_End": 70.0, "Text": " So I rewrote it, and this presentation is primarily on version 2.8, as it were."}, {"Time_Start": 70.0, "Time_End": 76.0, "Text": " There's a very bit, a little bit of background, most of you can probably sleep through this bit."}, {"Time_Start": 76.0, "Time_End": 79.0, "Text": " Fire rules, well we all know what it does."}, {"Time_Start": 79.0, "Time_End": 85.0, "Text": " Simple example, allow stuff out and replies, but stop the hackers come in here."}, {"Time_Start": 85.0, "Time_End": 87.0, "Text": " There's stateless and stateful."}, {"Time_Start": 87.0, "Time_End": 89.0, "Text": " you all know this."}, {"Time_Start": 89.0, "Time_End": 91.0, "Text": " A couple of shortcomings, though."}, {"Time_Start": 91.0, "Time_End": 96.0, "Text": " You can't understand upper-level traffic data, you know, things like HTTP."}, {"Time_Start": 96.0, "Time_End": 99.0, "Text": " You can't filter on that most of the time."}, {"Time_Start": 99.0, "Time_End": 103.0, "Text": " And similarly, you have issues with encrypted or tunnel traffic."}, {"Time_Start": 103.0, "Time_End": 107.0, "Text": " And some of that I'm trying to address."}, {"Time_Start": 107.0, "Time_End": 112.0, "Text": " A bit of our proxies, that's, you know, firewalls which can handle it."}, {"Time_Start": 112.0, "Time_End": 116.0, "Text": " They do, a lot of them work just by a matter-in-middle type effort."}, {"Time_Start": 116.0, "Time_End": 120.0, "Text": " Now, there's no such thing as 100% secure network."}, {"Time_Start": 120.0, "Time_End": 124.0, "Text": " So we want to know when there's problems, you know, what's going in."}, {"Time_Start": 124.0, "Time_End": 127.0, "Text": " And I know people say lots of the hackers are on the inside."}, {"Time_Start": 127.0, "Time_End": 129.0, "Text": " I guess you guys don't know that."}, {"Time_Start": 129.0, "Time_End": 131.0, "Text": " So you want to know about what's going on."}, {"Time_Start": 131.0, "Time_End": 134.0, "Text": " So you use an intrusion detection which gives you the information"}, {"Time_Start": 134.0, "Time_End": 139.0, "Text": " which allows a human to look into it, respond, whatever."}, {"Time_Start": 139.0, "Time_End": 143.0, "Text": " Host-based, running on the server, network-based, looking at network traffic."}, {"Time_Start": 143.0, "Time_End": 145.0, "Text": " This is primarily a network-based solution."}, {"Time_Start": 145.0, "Time_End": 147.0, "Text": " based solution that I'm dealing with."}, {"Time_Start": 147.0, "Time_End": 151.0, "Text": " A couple of patterns and a couple of different types and techniques"}, {"Time_Start": 151.0, "Time_End": 153.0, "Text": " mentioned in the previous, so I'll miss that."}, {"Time_Start": 153.0, "Time_End": 156.0, "Text": " Two things which we've got to remember,"}, {"Time_Start": 156.0, "Time_End": 158.0, "Text": " false positives and false negatives."}, {"Time_Start": 158.0, "Time_End": 161.0, "Text": " They do happen and there's nothing we can do with it."}, {"Time_Start": 161.0, "Time_End": 164.0, "Text": " IBSs currently can't stop an attack."}, {"Time_Start": 164.0, "Time_End": 166.0, "Text": " That's a big problem with it."}, {"Time_Start": 166.0, "Time_End": 168.0, "Text": " It's all right knowing about it six hours later."}, {"Time_Start": 168.0, "Time_End": 170.0, "Text": " But by then your web servers down,"}, {"Time_Start": 170.0, "Time_End": 174.0, "Text": " half your systems have been routed, so on and so forth."}, {"Time_Start": 174.0, "Time_End": 179.0, "Text": " A lot of the traditional signature-based stuff can't detect a whole new attack."}, {"Time_Start": 179.0, "Time_End": 182.0, "Text": " Now, if you're looking for a buffer overflow, somebody changes to the shell code"}, {"Time_Start": 182.0, "Time_End": 185.0, "Text": " or the specific bit of the signature, you screwed."}, {"Time_Start": 185.0, "Time_End": 190.0, "Text": " And as mentioned, you can't have no false positives and negatives."}, {"Time_Start": 190.0, "Time_End": 195.0, "Text": " So, one of the solutions integrate a firewall and an IDS"}, {"Time_Start": 195.0, "Time_End": 198.0, "Text": " to our firewall start filtering off IDS results."}, {"Time_Start": 198.0, "Time_End": 202.0, "Text": " Packet comes in, you run your signature analysis and says,"}, {"Time_Start": 202.0, "Time_End": 203.0, "Text": " oh, buffer overflow."}, {"Time_Start": 203.0, "Time_End": 204.0, "Text": " So drop it."}, {"Time_Start": 204.0, "Time_End": 206.0, "Text": " you use it, or whatever."}, {"Time_Start": 206.0, "Time_End": 211.0, "Text": " By doing this, it means humans aren't involved so it can happen straight away."}, {"Time_Start": 211.0, "Time_End": 214.0, "Text": " And additionally, you can have some quite funky functionality."}, {"Time_Start": 214.0, "Time_End": 217.0, "Text": " Hopefully, I'll cover that in a minute."}, {"Time_Start": 217.0, "Time_End": 222.0, "Text": " Now, ways you could integrate, fortune control packets, like TCP resets."}, {"Time_Start": 222.0, "Time_End": 226.0, "Text": " Now, snort do that, does that, quite a few IDSs are doing that."}, {"Time_Start": 226.0, "Time_End": 232.0, "Text": " You could react based on the log outputs of the IDS, you know, using swatch, syslog, whatever."}, {"Time_Start": 232.0, "Time_End": 234.0, "Text": " You could wrap firewall out,"}, {"Time_Start": 234.0, "Time_End": 240.0, "Text": " built around IDS code, for example, hogwash with snort, basically does that."}, {"Time_Start": 240.0, "Time_End": 243.0, "Text": " You can insert IDS facilities into a firewall."}, {"Time_Start": 243.0, "Time_End": 249.0, "Text": " For example, net filter, you can take packets off into user space,"}, {"Time_Start": 249.0, "Time_End": 253.0, "Text": " do your ID stuff that return it back up to net filter IP tables,"}, {"Time_Start": 253.0, "Time_End": 256.0, "Text": " and it can then deal with a dropping forwarding."}, {"Time_Start": 256.0, "Time_End": 261.0, "Text": " Or, and this is what I did, fully integrate a bespoke solution."}, {"Time_Start": 261.0, "Time_End": 264.0, "Text": " Current state the art, well, as a set up,"}, {"Time_Start": 264.0, "Time_End": 268.0, "Text": " academia don't seem to be interested in products, especially not in the UK."}, {"Time_Start": 268.0, "Time_End": 272.0, "Text": " That's a real shortfall in their part, I think."}, {"Time_Start": 272.0, "Time_End": 275.0, "Text": " Hogwash already mentioned, a few others."}, {"Time_Start": 275.0, "Time_End": 279.0, "Text": " Recently, GID's functionality has been added by several vendors."}, {"Time_Start": 279.0, "Time_End": 283.0, "Text": " I started this project about October last year."}, {"Time_Start": 283.0, "Time_End": 286.0, "Text": " A lot has changed since then, and that's one of the things I've really learnt."}, {"Time_Start": 286.0, "Time_End": 290.0, "Text": " IDS is a fast-moving area, now anyway, originally."}, {"Time_Start": 290.0, "Time_End": 292.0, "Text": " It was all firewalls."}, {"Time_Start": 292.0, "Time_End": 295.9, "Text": " Problems with integration, false positives."}, {"Time_Start": 295.9, "Time_End": 300.5, "Text": " You don't want to go dropping everything from your upstream rooser."}, {"Time_Start": 300.5, "Time_End": 302.0, "Text": " That would be a bad thing."}, {"Time_Start": 302.0, "Time_End": 306.0, "Text": " Denial of service, same sort of thing, or just hitting it with so much traffic,"}, {"Time_Start": 306.0, "Time_End": 310.0, "Text": " because don't forget, IDS stuff takes a lot of processing power."}, {"Time_Start": 310.0, "Time_End": 313.0, "Text": " And finally, processing power and bandwidth."}, {"Time_Start": 313.0, "Time_End": 317.0, "Text": " So, what are I going to do, or what have I done?"}, {"Time_Start": 317.0, "Time_End": 321.0, "Text": " The design was very modular, or supposed to be it."}, {"Time_Start": 321.0, "Time_End": 325.0, "Text": " or supposed to be, because the idea was things change."}, {"Time_Start": 325.0, "Time_End": 327.0, "Text": " We get new protocols all the time."}, {"Time_Start": 327.0, "Time_End": 330.0, "Text": " We need to be able to modify quickly."}, {"Time_Start": 330.0, "Time_End": 335.0, "Text": " For example, how hard is it to add IPX support to snort?"}, {"Time_Start": 335.0, "Time_End": 337.0, "Text": " I've looked at it, and it looks quite hard."}, {"Time_Start": 337.0, "Time_End": 339.0, "Text": " I don't know snort that well on the inside."}, {"Time_Start": 339.0, "Time_End": 342.0, "Text": " I'm sure some of you will correct me in that."}, {"Time_Start": 342.0, "Time_End": 347.0, "Text": " I always start with an example of where this would be useful,"}, {"Time_Start": 347.0, "Time_End": 349.0, "Text": " and that helps me design it."}, {"Time_Start": 349.0, "Time_End": 350.0, "Text": " So, you know, basic file."}, {"Time_Start": 350.0, "Time_End": 352.0, "Text": " firewall type functionality."}, {"Time_Start": 352.0, "Time_End": 356.0, "Text": " But how about, instead of blocking, just blocking,"}, {"Time_Start": 356.0, "Time_End": 361.0, "Text": " straight away based on, say, source IP address or port or whatever,"}, {"Time_Start": 361.0, "Time_End": 365.0, "Text": " how about we run the IDS on the input?"}, {"Time_Start": 365.0, "Time_End": 370.0, "Text": " Say it contains a buffer overflow, which we know from one of the different analyses"}, {"Time_Start": 370.0, "Time_End": 372.0, "Text": " which you could do, for example, the power matching,"}, {"Time_Start": 372.0, "Time_End": 377.0, "Text": " but you could easily do statistical, you could do protocol anomalies, so on and so forth."}, {"Time_Start": 377.0, "Time_End": 379.0, "Text": " If there's a buffer overflow, we,"}, {"Time_Start": 379.0, "Time_End": 383.0, "Text": " Overflow, or an attack, we rerout it transparently to a honeynet."}, {"Time_Start": 383.0, "Time_End": 389.0, "Text": " Rubicon can map bridging the, so the only thing which changes is like the waytime or something."}, {"Time_Start": 389.0, "Time_End": 396.0, "Text": " And then the hacker could then use your box to attack someone else, which you might get sued for."}, {"Time_Start": 396.0, "Time_End": 400.0, "Text": " So how about we IDS the outbound as well?"}, {"Time_Start": 400.0, "Time_End": 407.0, "Text": " And then, if it contains an attack, which we recognise, how about we then modify the packet to kill that attack?"}, {"Time_Start": 407.0, "Time_End": 408.0, "Text": " For example, stand buffer overflow."}, {"Time_Start": 408.0, "Time_End": 412.0, "Text": " buffer overflow, your payload is, you know, shell code and that."}, {"Time_Start": 412.0, "Time_End": 415.0, "Text": " How about just changing the payload, just some rules?"}, {"Time_Start": 415.0, "Time_End": 419.0, "Text": " It means that the attacker just thinks, oh crap, it didn't work,"}, {"Time_Start": 419.0, "Time_End": 423.0, "Text": " unless they're trying to hack their own box to test whether you've got Rubicon in place."}, {"Time_Start": 423.0, "Time_End": 425.0, "Text": " There's nothing I can do about that."}, {"Time_Start": 425.0, "Time_End": 427.0, "Text": " But they might just think, oh, it didn't work."}, {"Time_Start": 427.0, "Time_End": 433.0, "Text": " Next, meanwhile, you're getting information on who they're attacking and what they're attacking with."}, {"Time_Start": 433.0, "Time_End": 435.0, "Text": " And similarly coming back."}, {"Time_Start": 435.0, "Time_End": 437.0, "Text": " So from that, a few requirements."}, {"Time_Start": 437.0, "Time_End": 439.0, "Text": " It must itself be secure."}, {"Time_Start": 439.0, "Time_End": 443.0, "Text": " You don't want your box, your Rubicon box, getting heads,"}, {"Time_Start": 443.0, "Time_End": 446.0, "Text": " and then everything falls apart at that point."}, {"Time_Start": 446.0, "Time_End": 447.0, "Text": " Must be stable."}, {"Time_Start": 447.0, "Time_End": 450.0, "Text": " Otherwise, I mean, it will fail safe,"}, {"Time_Start": 450.0, "Time_End": 454.0, "Text": " but if you're on a really high bandwidth, important network,"}, {"Time_Start": 454.0, "Time_End": 456.0, "Text": " you don't want it to fail and block everything."}, {"Time_Start": 456.0, "Time_End": 458.0, "Text": " Well, you don't want it to fail, full stop."}, {"Time_Start": 458.0, "Time_End": 461.0, "Text": " And it must be able to handle the load."}, {"Time_Start": 461.0, "Time_End": 465.0, "Text": " So a quick high-level design, basically on the left here,"}, {"Time_Start": 465.0, "Time_End": 466.0, "Text": " you got all the different types of plug-in."}, {"Time_Start": 466.0, "Time_End": 468.0, "Text": " types of plug-in currently supported."}, {"Time_Start": 468.0, "Time_End": 472.0, "Text": " Now, these are all connected via a central loop process."}, {"Time_Start": 472.0, "Time_End": 475.0, "Text": " And on the right is the policy subsystem."}, {"Time_Start": 475.0, "Time_End": 479.0, "Text": " That's actually run as a separate thread, for reasons I'll go into in a bit."}, {"Time_Start": 479.0, "Time_End": 484.0, "Text": " Each of the dark black lines can be thought of as an interface between each part."}, {"Time_Start": 484.0, "Time_End": 488.0, "Text": " Interfaces need APIs or similar to be designed."}, {"Time_Start": 488.0, "Time_End": 491.0, "Text": " So the core loops contains a package structure,"}, {"Time_Start": 491.0, "Time_End": 495.0, "Text": " which just wraps the packet and all the other data that's attached to it."}, {"Time_Start": 495.0, "Time_End": 496.0, "Text": " One of those is."}, {"Time_Start": 496.0, "Time_End": 503.0, "Text": " a link list of protocols. A protocol is basically the decoded protocol header or whatever"}, {"Time_Start": 503.0, "Time_End": 508.0, "Text": " with a name, for example, Ethernet will point to the start of the Ethernet header,"}, {"Time_Start": 508.0, "Time_End": 511.0, "Text": " the length of the Ethernet header and so on, and the payload."}, {"Time_Start": 511.0, "Time_End": 516.0, "Text": " Normally that's just a pointer into the actual packet itself, otherwise you copy and stuff,"}, {"Time_Start": 516.0, "Time_End": 517.0, "Text": " which is a bad thing."}, {"Time_Start": 517.0, "Time_End": 523.0, "Text": " However, you might want to do IDS on decrypted SSL traffic."}, {"Time_Start": 523.0, "Time_End": 526.0, "Text": " Now, just a quick digression here about SSL."}, {"Time_Start": 526.0, "Time_End": 529.0, "Text": " because I didn't know about this, maybe that's just me, but"}, {"Time_Start": 529.0, "Time_End": 535.0, "Text": " SSL, which, you know, client server, exchange a key,"}, {"Time_Start": 535.0, "Time_End": 539.0, "Text": " and mess around with it a bit, and then use that from now on."}, {"Time_Start": 539.0, "Time_End": 541.0, "Text": " A couple of different methods for that, RSA,"}, {"Time_Start": 541.0, "Time_End": 545.0, "Text": " where the client encrypts the session key,"}, {"Time_Start": 545.0, "Time_End": 547.0, "Text": " with the service public, sends it off to the server,"}, {"Time_Start": 547.0, "Time_End": 549.0, "Text": " server decrypts, and then that sort of,"}, {"Time_Start": 549.0, "Time_End": 553.0, "Text": " or Diffie-Hellman which uses combining logs, but I won't go into that."}, {"Time_Start": 553.0, "Time_End": 555.0, "Text": " Now, if RSA is used,"}, {"Time_Start": 555.0, "Time_End": 558.0, "Text": " which you can normally set up."}, {"Time_Start": 558.0, "Time_End": 562.0, "Text": " And the IDS has a copy of the service public-private key pair,"}, {"Time_Start": 562.0, "Time_End": 565.0, "Text": " and what you can do is use on your IDS,"}, {"Time_Start": 565.0, "Time_End": 569.0, "Text": " you can use a combination of a hacked-up version of SSL and open SSL"}, {"Time_Start": 569.0, "Time_End": 571.0, "Text": " to actually decrypt the traffic as it's going through,"}, {"Time_Start": 571.0, "Time_End": 573.0, "Text": " not performing the man in middle, anything like that."}, {"Time_Start": 573.0, "Time_End": 578.0, "Text": " So that means that, say for example, one thing which has been done a lot at the moment,"}, {"Time_Start": 578.0, "Time_End": 581.0, "Text": " is hiding web attacks using SSL."}, {"Time_Start": 581.0, "Time_End": 584.0, "Text": " Well, this would totally circumvent that."}, {"Time_Start": 584.0, "Time_End": 588.0, "Text": " A quick look at the plugins."}, {"Time_Start": 588.0, "Time_End": 594.0, "Text": " Everything has the plugin interface, basically registration, initialization and cleaning up at the end of the day."}, {"Time_Start": 594.0, "Time_End": 600.0, "Text": " Full types of plug-in, input, fully enough is input, output's obvious, analysis, and protocol."}, {"Time_Start": 600.0, "Time_End": 604.0, "Text": " Rubicon, by default, does not have any support for any protocols."}, {"Time_Start": 604.0, "Time_End": 612.0, "Text": " Instead, everything, Ethernet, IP, ATM, IPX, Sonet, whatever, has a protocol plugin,"}, {"Time_Start": 612.0, "Time_End": 613.0, "Text": " with a few different things."}, {"Time_Start": 613.0, "Time_End": 618.0, "Text": " things, decode basically is the one which produces the protocol link list."}, {"Time_Start": 618.0, "Time_End": 623.0, "Text": " Test is used for special tests, for example, to check whether check sums are valid."}, {"Time_Start": 623.0, "Time_End": 629.0, "Text": " Print, for printed out, obviously, and make test, whatever."}, {"Time_Start": 629.0, "Time_End": 635.0, "Text": " Policy interface, on the internal, you've got a mutex shared pointer for the threads,"}, {"Time_Start": 635.0, "Time_End": 640.0, "Text": " because compiling the policy from an intermediate language to the low-level representation"}, {"Time_Start": 640.0, "Time_End": 642.0, "Text": " is potentially processor intensive, and you don't want that to."}, {"Time_Start": 642.0, "Time_End": 644.0, "Text": " and you don't want that to affect your system."}, {"Time_Start": 644.0, "Time_End": 646.0, "Text": " So hence a separate thread."}, {"Time_Start": 646.0, "Time_End": 650.0, "Text": " On the external side, well, I haven't really written much that way, so I can't be asked."}, {"Time_Start": 650.0, "Time_End": 654.0, "Text": " High level policy hasn't been implemented."}, {"Time_Start": 654.0, "Time_End": 658.0, "Text": " I'm not interested in doing it. If anybody does, get in touch."}, {"Time_Start": 658.0, "Time_End": 663.0, "Text": " Intermediate level is XML, but it's used basically to get around,"}, {"Time_Start": 663.0, "Time_End": 669.0, "Text": " well, some of the problems which occur with lower level, you know, binary type things."}, {"Time_Start": 669.0, "Time_End": 671.98, "Text": " And the real level is what's actually actually"}, {"Time_Start": 672.0, "Time_End": 674.0, "Text": " on the box, which I'll get into now."}, {"Time_Start": 674.0, "Time_End": 679.0, "Text": " Intermediate, write-ordering, etc. You don't have to worry about."}, {"Time_Start": 679.0, "Time_End": 682.0, "Text": " It's human readable and writable, which is good because I haven't written a high-level policy,"}, {"Time_Start": 682.0, "Time_End": 685.0, "Text": " so I need to write the intermediate level by hand."}, {"Time_Start": 685.0, "Time_End": 688.0, "Text": " I certainly don't want to be writing this by hand."}, {"Time_Start": 688.0, "Time_End": 692.0, "Text": " And we want fast translation, so there's a one-to-one mapping, realistically,"}, {"Time_Start": 692.0, "Time_End": 696.0, "Text": " between the XML structure and the low-level structure."}, {"Time_Start": 696.0, "Time_End": 699.0, "Text": " An example, XML."}, {"Time_Start": 699.0, "Time_End": 701.0, "Text": " The low-level,"}, {"Time_Start": 701.0, "Time_End": 705.0, "Text": " The low level is a link list, which I'm going to show you in a moment,"}, {"Time_Start": 705.0, "Time_End": 708.0, "Text": " basically a very large tree, which you process descends down,"}, {"Time_Start": 708.0, "Time_End": 715.0, "Text": " and potentially back it up, nodes or tests, leaves are the outputs or whatever."}, {"Time_Start": 715.0, "Time_End": 719.0, "Text": " For example, that's the generic link list."}, {"Time_Start": 719.0, "Time_End": 725.0, "Text": " So you'll start the policy head, go down to the first relevant protocol that you've decoded,"}, {"Time_Start": 725.0, "Time_End": 730.84, "Text": " say, well, say Ethernet or whatever, go along the matches, looking for the match of the match"}, {"Time_Start": 731.0, "Time_End": 734.0, "Text": " source address, that sort of thing."}, {"Time_Start": 734.0, "Time_End": 738.0, "Text": " And if a match is made, then descends down the output chain,"}, {"Time_Start": 738.0, "Time_End": 741.0, "Text": " so on and so forth."}, {"Time_Start": 741.0, "Time_End": 745.0, "Text": " More accurate example, following this along, you go down,"}, {"Time_Start": 745.0, "Time_End": 749.0, "Text": " you hit Ethernet, so your source address is that one."}, {"Time_Start": 749.0, "Time_End": 752.0, "Text": " Then you won't go down, that drop ERF,"}, {"Time_Start": 752.0, "Time_End": 756.0, "Text": " it's basically, well, it's end of processing, so it should be EOP."}, {"Time_Start": 756.0, "Time_End": 760.0, "Text": " Then you go back up, down into IP and through."}, {"Time_Start": 760.0, "Time_End": 764.0, "Text": " Quick look at the plugins which have sort of been written,"}, {"Time_Start": 764.0, "Time_End": 768.0, "Text": " because it's version two, they haven't totally been written."}, {"Time_Start": 768.0, "Time_End": 773.0, "Text": " I've just been moving house, so that wiped out my internet connection for two weeks."}, {"Time_Start": 773.0, "Time_End": 776.0, "Text": " It's so hard to live without the internet these days."}, {"Time_Start": 776.0, "Time_End": 779.0, "Text": " All right, LibP-CAP, standard, everyone knows that."}, {"Time_Start": 779.0, "Time_End": 784.0, "Text": " Lib IPQ, that's for user space handling of packets from net filter, IPTables."}, {"Time_Start": 784.0, "Time_End": 788.0, "Text": " So say you want to just phase your product in on a live network,"}, {"Time_Start": 788.0, "Time_End": 792.0, "Text": " Well, you could just have the odd packet or the odd set of rules"}, {"Time_Start": 792.0, "Time_End": 795.0, "Text": " sending into Rubicon from your net filter,"}, {"Time_Start": 795.0, "Time_End": 799.0, "Text": " so your network wouldn't really be affected if Rubicon screws up."}, {"Time_Start": 799.0, "Time_End": 806.0, "Text": " One thing to notice this about LibiPQ is it exports both the input and output plug-in interfaces."}, {"Time_Start": 806.0, "Time_End": 812.0, "Text": " Input to get the packet, output to tell LibIPQ or Netfilter what to do with it."}, {"Time_Start": 812.0, "Time_End": 817.98, "Text": " Protocol, well mentioned, analysis, and basically I pulled out the"}, {"Time_Start": 818.0, "Time_End": 821.0, "Text": " snorts matching."}, {"Time_Start": 821.0, "Time_End": 823.0, "Text": " It was an old version of snort."}, {"Time_Start": 823.0, "Time_End": 825.0, "Text": " I think they've updated it recently."}, {"Time_Start": 825.0, "Time_End": 827.0, "Text": " Basically, that gets initialized."}, {"Time_Start": 827.0, "Time_End": 831.0, "Text": " In the XML policy, you can actually include snort rules."}, {"Time_Start": 831.0, "Time_End": 836.0, "Text": " So that gives some of cross-platform compatibility I was looking for."}, {"Time_Start": 836.0, "Time_End": 840.0, "Text": " It gets initialized with a load of rules and names."}, {"Time_Start": 840.0, "Time_End": 845.0, "Text": " So for example, you could use IIS and all the rules that you want to do IAS,"}, {"Time_Start": 845.0, "Time_End": 847.0, "Text": " and then any traffic sent to your web server."}, {"Time_Start": 847.0, "Time_End": 849.0, "Text": " server, I'm not a Microsoft fan by the way."}, {"Time_Start": 849.0, "Time_End": 852.0, "Text": " I'm just using Windows for the hell of it."}, {"Time_Start": 852.0, "Time_End": 857.0, "Text": " You could just run the IAS rules against the packet"}, {"Time_Start": 857.0, "Time_End": 860.0, "Text": " rather than having to run everything."}, {"Time_Start": 860.0, "Time_End": 864.0, "Text": " Another nice one, personally I think,"}, {"Time_Start": 864.0, "Time_End": 865.0, "Text": " counter."}, {"Time_Start": 865.0, "Time_End": 868.0, "Text": " So you can increment, decrement, set, whatever, values,"}, {"Time_Start": 868.0, "Time_End": 872.0, "Text": " for as many user-defined variables as you want."}, {"Time_Start": 872.0, "Time_End": 874.0, "Text": " And then you can test them, always test there."}, {"Time_Start": 874.0, "Time_End": 876.0, "Text": " So say, for example, you only want so many"}, {"Time_Start": 876.0, "Time_End": 879.0, "Text": " You only want so many FTP connections per hour."}, {"Time_Start": 879.0, "Time_End": 882.0, "Text": " One thing, I'm trying to modify counter,"}, {"Time_Start": 882.0, "Time_End": 886.0, "Text": " so that you can do stuff on time as well, so reset every hour."}, {"Time_Start": 886.0, "Time_End": 890.0, "Text": " Defrag, well, what can be said, it's defragmentation."}, {"Time_Start": 890.0, "Time_End": 894.0, "Text": " Output, you've got the network outputs, same as any firewall,"}, {"Time_Start": 894.0, "Time_End": 896.0, "Text": " and you've got your log outputs, same as any IDS."}, {"Time_Start": 896.0, "Time_End": 900.0, "Text": " The network, all provided by LibNet,"}, {"Time_Start": 900.0, "Time_End": 904.0, "Text": " it doesn't do masquerading yet, but you can do drop except reject."}, {"Time_Start": 904.0, "Time_End": 905.0, "Text": " Net"}, {"Time_Start": 905.0, "Time_End": 910.0, "Text": " is the term I use for the modification of packets in rhyme."}, {"Time_Start": 910.0, "Time_End": 914.0, "Text": " You can modify any packet you want,"}, {"Time_Start": 914.0, "Time_End": 919.0, "Text": " and any header or payload is specifiable."}, {"Time_Start": 919.0, "Time_End": 921.0, "Text": " You can't resize, though."}, {"Time_Start": 921.0, "Time_End": 923.0, "Text": " This isn't strictly true."}, {"Time_Start": 923.0, "Time_End": 926.0, "Text": " You can't resize on anything which uses sequence numbering."}, {"Time_Start": 926.0, "Time_End": 929.0, "Text": " If it's not using sequence numbering, then you've got nothing to worry about,"}, {"Time_Start": 929.0, "Time_End": 931.0, "Text": " and you can resize your packet."}, {"Time_Start": 931.0, "Time_End": 933.0, "Text": " But currently, it just doesn't allow you to resize."}, {"Time_Start": 933.0, "Time_End": 934.0, "Text": " All it allows you to do is just..."}, {"Time_Start": 934.0, "Time_End": 936.0, "Text": " to do is just replace."}, {"Time_Start": 936.0, "Time_End": 939.0, "Text": " Logging, well, all the standard stuff."}, {"Time_Start": 939.0, "Time_End": 945.0, "Text": " I have a quick look at IDXP, which is an IDMEF."}, {"Time_Start": 945.0, "Time_End": 952.0, "Text": " They're sort of cross-platform ideas for common logging formats or whatever."}, {"Time_Start": 952.0, "Time_End": 955.0, "Text": " It doesn't really work yet."}, {"Time_Start": 955.0, "Time_End": 958.0, "Text": " And that's not my fault, that's theirs."}, {"Time_Start": 958.0, "Time_End": 963.0, "Text": " Right, now, conclusions, God, I'm racing through this, we'll always be on time."}, {"Time_Start": 963.0, "Time_End": 968.0, "Text": " Well, because of the code review, there aren't any benchmarks available yet,"}, {"Time_Start": 968.0, "Time_End": 972.0, "Text": " but the old version of the code, basically, I only had a crap network at home,"}, {"Time_Start": 972.0, "Time_End": 977.0, "Text": " so I just banged away with a full, every single snort rule I could find,"}, {"Time_Start": 977.0, "Time_End": 982.0, "Text": " and it didn't drop anything at 8 megabips, and that was log into file."}, {"Time_Start": 982.0, "Time_End": 987.0, "Text": " Just to make sure that everything was working correctly,"}, {"Time_Start": 987.0, "Time_End": 993.0, "Text": " I would use both Rubicon and snort with identical rules to pass the Sands,"}, {"Time_Start": 993.0, "Time_End": 1000.0, "Text": " 2000 log, Rubicon, a bit slower, but the output was identical, so I'm not, I haven't screwed up too much there."}, {"Time_Start": 1002.0, "Time_End": 1008.0, "Text": " Problems and limitations, well, because of the way I've written it, access internal traffic is a real issue."}, {"Time_Start": 1008.0, "Time_End": 1014.0, "Text": " Trying to say, when you're referring to IP, you know, IP source address, which IP source address?"}, {"Time_Start": 1014.0, "Time_End": 1016.0, "Text": " The one at the bottom or the one being tunneled?"}, {"Time_Start": 1016.0, "Time_End": 1019.0, "Text": " Bugs obviously need loads of work."}, {"Time_Start": 1019.0, "Time_End": 1022.9, "Text": " The big thing, and this is one of the reasons I'm here, is there needs to be uptake."}, {"Time_Start": 1023.0, "Time_End": 1025.3, "Text": " You need people testing any product."}, {"Time_Start": 1025.8, "Time_End": 1031.1, "Text": " Every year at DefCon, products are talked about, some of them are quite good, some of them less so."}, {"Time_Start": 1031.4, "Time_End": 1032.86, "Text": " I'll leave you to decide which this is."}, {"Time_Start": 1033.28, "Time_End": 1038.46, "Text": " The fact of the matter is, if no one uses it, then good or bad, it'll just fall flat on its face."}, {"Time_Start": 1040.0, "Time_End": 1041.46, "Text": " There have been some successes."}, {"Time_Start": 1041.7, "Time_End": 1042.8, "Text": " It is very modular."}, {"Time_Start": 1044.8, "Time_End": 1047.5, "Text": " It took me about two hours to write the TCP plugin."}, {"Time_Start": 1049.0, "Time_End": 1052.98, "Text": " Most of that is copy and pasting for printing, and that's..."}, {"Time_Start": 1053.0, "Time_End": 1055.0, "Text": " sort of thing. It's very fast and very easy."}, {"Time_Start": 1055.0, "Time_End": 1058.0, "Text": " It does do everything I was wanted to."}, {"Time_Start": 1058.0, "Time_End": 1062.0, "Text": " At the time, it was unique functionality, the mangling."}, {"Time_Start": 1062.0, "Time_End": 1066.0, "Text": " I believe Hogwash, I don't know if anybody can agree or disagree,"}, {"Time_Start": 1066.0, "Time_End": 1068.0, "Text": " hogwash apparently can do this."}, {"Time_Start": 1068.0, "Time_End": 1071.0, "Text": " Does it, can you mangle packets now?"}, {"Time_Start": 1071.0, "Time_End": 1074.0, "Text": " I think that was a yes."}, {"Time_Start": 1074.0, "Time_End": 1078.0, "Text": " Yeah. Okay, so, well, it wasn't that unique, but still."}, {"Time_Start": 1078.0, "Time_End": 1083.0, "Text": " In theory, using automaking, lib tool in that, it's relatively,"}, {"Time_Start": 1083.0, "Time_End": 1086.0, "Text": " cross-platform, although I haven't tested it that much."}, {"Time_Start": 1086.0, "Time_End": 1089.0, "Text": " And as I said, it is very easy to develop for."}, {"Time_Start": 1089.0, "Time_End": 1093.0, "Text": " Further work, as you can see, loads of different possibilities."}, {"Time_Start": 1093.0, "Time_End": 1096.0, "Text": " This doesn't have to just be a security tool."}, {"Time_Start": 1096.0, "Time_End": 1101.0, "Text": " Now, this is primarily for non-production use, although maybe it'll scale up."}, {"Time_Start": 1101.0, "Time_End": 1105.0, "Text": " But say, for example, you want to add quality of service to your network or load balance it."}, {"Time_Start": 1105.0, "Time_End": 1109.0, "Text": " But because of the whole modular design, then you can do that as well."}, {"Time_Start": 1109.0, "Time_End": 1113.0, "Text": " A few conclusions on a few conclusions on,"}, {"Time_Start": 1113.0, "Time_End": 1116.0, "Text": " intrusion detection systems that I've come across,"}, {"Time_Start": 1116.0, "Time_End": 1118.0, "Text": " or made in my time,"}, {"Time_Start": 1118.0, "Time_End": 1120.0, "Text": " that we have to reduce false positives."}, {"Time_Start": 1120.0, "Time_End": 1122.0, "Text": " We have to come up with new ways to do that."}, {"Time_Start": 1122.0, "Time_End": 1124.0, "Text": " Now, academia is working on it."}, {"Time_Start": 1124.0, "Time_End": 1126.0, "Text": " We are coming up with algorithms."}, {"Time_Start": 1126.0, "Time_End": 1130.0, "Text": " I'm not that impressed most of the time,"}, {"Time_Start": 1130.0, "Time_End": 1133.0, "Text": " but I don't work that close in the area."}, {"Time_Start": 1133.0, "Time_End": 1136.0, "Text": " We also need to pick up new attacks."}, {"Time_Start": 1136.0, "Time_End": 1138.0, "Text": " Now, false positives picking up new attacks"}, {"Time_Start": 1138.0, "Time_End": 1140.0, "Text": " are working against each other here."}, {"Time_Start": 1140.0, "Time_End": 1143.0, "Text": " We're starting to destroy"}, {"Time_Start": 1143.0, "Time_End": 1145.0, "Text": " through analysis in that."}, {"Time_Start": 1145.0, "Time_End": 1150.0, "Text": " I think three commas produce mix with firewalling capabilities."}, {"Time_Start": 1150.0, "Time_End": 1153.0, "Text": " Apparently they can do IDS stuff in as well."}, {"Time_Start": 1153.0, "Time_End": 1156.0, "Text": " I hope today that that's quite crap there."}, {"Time_Start": 1156.0, "Time_End": 1161.0, "Text": " That's a correlation of the previous presentation actually covered that."}, {"Time_Start": 1161.0, "Time_End": 1163.0, "Text": " Standardisation."}, {"Time_Start": 1163.0, "Time_End": 1168.0, "Text": " How are we supposed to communicate between different intrusion section,"}, {"Time_Start": 1168.0, "Time_End": 1170.0, "Text": " firewall, etc."}, {"Time_Start": 1170.0, "Time_End": 1171.0, "Text": " There's no standardisation."}, {"Time_Start": 1171.0, "Time_End": 1172.0, "Text": " There's so many vendors in the other."}, {"Time_Start": 1172.0, "Time_End": 1174.0, "Text": " many vendors in the area now and each of them"}, {"Time_Start": 1174.0, "Time_End": 1176.0, "Text": " seem to want to follow Microsoft route"}, {"Time_Start": 1176.0, "Time_End": 1178.0, "Text": " of, yeah, let's follow the RFC,"}, {"Time_Start": 1178.0, "Time_End": 1180.0, "Text": " but change it."}, {"Time_Start": 1180.0, "Time_End": 1182.0, "Text": " So we need to sort that out and"}, {"Time_Start": 1182.0, "Time_End": 1185.0, "Text": " we're going to have to have more host-based"}, {"Time_Start": 1185.0, "Time_End": 1188.0, "Text": " juicer encryption, you know, okay, I can handle SSL,"}, {"Time_Start": 1188.0, "Time_End": 1190.0, "Text": " maybe, sometimes."}, {"Time_Start": 1190.0, "Time_End": 1193.0, "Text": " And finally, I'm not sure that's snort,"}, {"Time_Start": 1193.0, "Time_End": 1197.0, "Text": " but I know certain of the IDS is out there"}, {"Time_Start": 1197.0, "Time_End": 1200.0, "Text": " have themselves got security flaws"}, {"Time_Start": 1200.0, "Time_End": 1201.0, "Text": " and exploits they're off."}, {"Time_Start": 1201.0, "Time_End": 1207.0, "Text": " points there off. And just because you've not got a portal open doesn't mean you can't be broken into."}, {"Time_Start": 1207.0, "Time_End": 1211.0, "Text": " That's basically it. It was a very quick run through."}, {"Time_Start": 1211.0, "Time_End": 1215.0, "Text": " Hopefully there'll be questions. Otherwise, you've got enough time to go and get a drink."}, {"Time_Start": 1215.0, "Time_End": 1216.0, "Text": " Yes."}, {"Time_Start": 1220.0, "Time_End": 1225.0, "Text": " Sorry, I couldn't quite catch that. Do you want to roll up here and grab the mic for a minute?"}, {"Time_Start": 1227.0, "Time_End": 1230.0, "Text": " Sorry, am I hearing shot after a flight yesterday."}, {"Time_Start": 1230.0, "Time_End": 1241.0, "Text": " Any plans to move it over to"}, {"Time_Start": 1241.0, "Time_End": 1245.0, "Text": " a packet filter or IPF on free BSD and open BSD?"}, {"Time_Start": 1245.0, "Time_End": 1249.0, "Text": " Not especially."}, {"Time_Start": 1249.0, "Time_End": 1252.0, "Text": " Most of the effort and plans at the moment are basically"}, {"Time_Start": 1252.0, "Time_End": 1255.0, "Text": " on just expanding what's here."}, {"Time_Start": 1255.0, "Time_End": 1258.0, "Text": " Partly because I haven't got that much BSD experience."}, {"Time_Start": 1258.0, "Time_End": 1259.0, "Text": " I'm primarily a sort of learner person."}, {"Time_Start": 1259.0, "Time_End": 1265.0, "Text": " Leonex person. However, if anyone's interested, then I would definitely be interested in doing that."}, {"Time_Start": 1265.0, "Time_End": 1267.0, "Text": " Anyone else?"}, {"Time_Start": 1267.0, "Time_End": 1270.0, "Text": " Louise? Ah, yes, Willey."}, {"Time_Start": 1270.0, "Time_End": 1275.0, "Text": " You're talking about future."}, {"Time_Start": 1275.0, "Time_End": 1276.0, "Text": " IES and the firewall?"}, {"Time_Start": 1276.0, "Time_End": 1277.0, "Text": " Yeah."}, {"Time_Start": 1277.0, "Time_End": 1280.0, "Text": " It sounds like you have a lot of two problems."}, {"Time_Start": 1280.0, "Time_End": 1283.0, "Text": " Either you are doing pretty simply a practice."}, {"Time_Start": 1283.0, "Time_End": 1286.0, "Text": " And so for anything other than email, you can introduce, you know,"}, {"Time_Start": 1286.0, "Time_End": 1288.0, "Text": " unaccepted one about latency."}, {"Time_Start": 1288.0, "Time_End": 1289.0, "Text": " Yeah."}, {"Time_Start": 1289.0, "Time_End": 1291.0, "Text": " by the time I get to see stuff,"}, {"Time_Start": 1291.0, "Time_End": 1293.0, "Text": " we'll have to work on the wire wall,"}, {"Time_Start": 1293.0, "Time_End": 1294.0, "Text": " and if you look at the other thing,"}, {"Time_Start": 1294.0, "Time_End": 1295.0, "Text": " it's not very easy."}, {"Time_Start": 1295.0, "Time_End": 1298.0, "Text": " Okay, and the question was, or comment,"}, {"Time_Start": 1298.0, "Time_End": 1302.0, "Text": " and basically, to do with defragmentation,"}, {"Time_Start": 1302.0, "Time_End": 1304.0, "Text": " what do we defragment?"}, {"Time_Start": 1304.0, "Time_End": 1307.0, "Text": " If we defragment everything, then we're going to have problems"}, {"Time_Start": 1307.0, "Time_End": 1308.0, "Text": " with latency."}, {"Time_Start": 1308.0, "Time_End": 1311.0, "Text": " If we don't, then by the time we see stuff,"}, {"Time_Start": 1311.0, "Time_End": 1312.0, "Text": " it's already gone through."}, {"Time_Start": 1312.0, "Time_End": 1315.0, "Text": " The answer is, that was the question pretty much here,"}, {"Time_Start": 1315.0, "Time_End": 1318.0, "Text": " the answer is, it's a configuration issue, surely."}, {"Time_Start": 1318.0, "Time_End": 1325.0, "Text": " issue surely you defrag stuff which you don't think is an issue and you"}, {"Time_Start": 1325.0, "Time_End": 1333.0, "Text": " allow flags through otherwise. This is, or no, I'd say, defrag everything. This isn't set"}, {"Time_Start": 1333.0, "Time_End": 1341.0, "Text": " for production, so the quality code. So the latency introduced shouldn't be too much of an issue,"}, {"Time_Start": 1341.0, "Time_End": 1346.0, "Text": " although that's a potential denial of service problem. But that's the same with anything."}, {"Time_Start": 1346.0, "Time_End": 1347.0, "Text": " There's very, there's realistically not an issue."}, {"Time_Start": 1347.0, "Time_End": 1350.0, "Text": " realistically nothing you can do to get around that."}, {"Time_Start": 1350.0, "Time_End": 1354.0, "Text": " One thing that just occurred to me a while back bit,"}, {"Time_Start": 1354.0, "Time_End": 1358.0, "Text": " you could do protocol and package shaping as it comes through."}, {"Time_Start": 1358.0, "Time_End": 1360.0, "Text": " For example, fragments,"}, {"Time_Start": 1360.0, "Time_End": 1365.0, "Text": " common way to get around intrusion detection systems, overlapping fragments."}, {"Time_Start": 1365.0, "Time_End": 1368.0, "Text": " Well, what we could do is remove that overlap,"}, {"Time_Start": 1368.0, "Time_End": 1371.0, "Text": " because overlapping fragments, it's breaking the RCs anyway."}, {"Time_Start": 1371.0, "Time_End": 1375.0, "Text": " So by removing that overlap and resizing one or the other,"}, {"Time_Start": 1375.0, "Time_End": 1376.0, "Text": " and that again is a configuration."}, {"Time_Start": 1376.0, "Time_End": 1382.0, "Text": " again, is a configuration issue. Then you can get rid of that particular problem."}, {"Time_Start": 1382.0, "Time_End": 1384.0, "Text": " Yes, sir?"}, {"Time_Start": 1384.0, "Time_End": 1403.0, "Text": " Right, again, that's currently, although I'm thinking about involving some sort of"}, {"Time_Start": 1403.0, "Time_End": 1405.0, "Text": " the stop list list. Sorry, the question was,"}, {"Time_Start": 1405.0, "Time_End": 1410.0, "Text": " How does Rubicon handle like spoof attacks and things like that, yeah?"}, {"Time_Start": 1410.0, "Time_End": 1413.0, "Text": " Again, it's a configuration issue."}, {"Time_Start": 1413.0, "Time_End": 1419.0, "Text": " I'm considering looking into stop lists, so, you know, do not ever drop these IP addresses."}, {"Time_Start": 1419.0, "Time_End": 1424.0, "Text": " However, if you think about it, that you can involve that in your rules."}, {"Time_Start": 1424.0, "Time_End": 1428.0, "Text": " So that's more of a configuration issue than anything."}, {"Time_Start": 1428.0, "Time_End": 1430.0, "Text": " Anyone else?"}, {"Time_Start": 1430.0, "Time_End": 1432.0, "Text": " Nope."}, {"Time_Start": 1432.0, "Time_End": 1434.0, "Text": " Okay, thank you for listening and"}, {"Time_Start": 1434.0, "Time_End": 1436.0, "Text": " and go and get a drink."}]}