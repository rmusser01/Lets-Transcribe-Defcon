{"segments": [{"Time_Start": 0.0, "Time_End": 3.0, "Text": " All right now, wasn't that fun?"}, {"Time_Start": 7.0, "Time_End": 10.0, "Text": " So, yeah, I had to do that."}, {"Time_Start": 10.0, "Time_End": 12.0, "Text": " Got forced to do that."}, {"Time_Start": 12.0, "Time_End": 14.0, "Text": " Good morning, everyone."}, {"Time_Start": 14.0, "Time_End": 15.0, "Text": " I'm FX."}, {"Time_Start": 15.0, "Time_End": 17.0, "Text": " This is FTR."}, {"Time_Start": 17.0, "Time_End": 18.0, "Text": " We're from Fenalate."}, {"Time_Start": 18.0, "Time_End": 20.0, "Text": " Nobody can pronounce that."}, {"Time_Start": 20.0, "Time_End": 24.0, "Text": " And we're talking about attacking networked embedded systems."}, {"Time_Start": 24.0, "Time_End": 26.0, "Text": " All kinds of, actually."}, {"Time_Start": 26.0, "Time_End": 29.0, "Text": " Yeah, what are we going to do?"}, {"Time_Start": 29.0, "Time_End": 32.16, "Text": " It's like today's session over here."}, {"Time_Start": 32.16, "Time_End": 35.6, "Text": " I can't see my screen, so I have to look over there all the time."}, {"Time_Start": 35.6, "Time_End": 38.0, "Text": " We're talking about design failures."}, {"Time_Start": 38.0, "Time_End": 40.6, "Text": " Actually, FTR is going to cover some neat shit."}, {"Time_Start": 40.6, "Time_End": 42.0, "Text": " You can do with printers."}, {"Time_Start": 42.0, "Time_End": 46.0, "Text": " Basically, complementary to Little Wars talk yesterday."}, {"Time_Start": 46.0, "Time_End": 51.0, "Text": " And we, of course, released some tools, so you guys have some fun."}, {"Time_Start": 51.0, "Time_End": 57.0, "Text": " And, yeah, after that, we talk about software vulnerabilities and embedded systems."}, {"Time_Start": 57.0, "Time_End": 58.900000000000006, "Text": " Get some examples out."}, {"Time_Start": 59.0, "Time_End": 64.0, "Text": " and then run a tutorial, how to root a Cisco."}, {"Time_Start": 64.0, "Time_End": 67.0, "Text": " So I pass on to FTR."}, {"Time_Start": 67.0, "Time_End": 70.0, "Text": " Thanks for that."}, {"Time_Start": 70.0, "Time_End": 76.0, "Text": " Okay, first we have to define somehow what for us in the limited system is."}, {"Time_Start": 76.0, "Time_End": 84.0, "Text": " And for the purpose of this speech, we think about an embedded system just as a small computer device running is"}, {"Time_Start": 84.0, "Time_End": 89.0, "Text": " custom OS, which is used for one particular job,"}, {"Time_Start": 89.0, "Time_End": 91.7, "Text": " and yeah, it's actually something small,"}, {"Time_Start": 91.7, "Time_End": 94.5, "Text": " doesn't need a keyboard or screen or something like that,"}, {"Time_Start": 94.5, "Time_End": 99.6, "Text": " and it's more fun if it has some kind of network connections"}, {"Time_Start": 99.6, "Time_End": 102.0, "Text": " that we can play with it and we have some fun."}, {"Time_Start": 102.0, "Time_End": 107.5, "Text": " What are the most common problems within embedded systems?"}, {"Time_Start": 107.5, "Time_End": 113.0, "Text": " Obviously, since nobody is thinking about attacking them,"}, {"Time_Start": 113.0, "Time_End": 118.0, "Text": " the operating system itself covers lots of undocumented functionality,"}, {"Time_Start": 118.0, "Time_End": 119.0, "Text": " which is..."}, {"Time_Start": 119.0, "Time_End": 121.0, "Text": " still hidden and therefore,"}, {"Time_Start": 121.0, "Time_End": 126.0, "Text": " normally developers leave back some backdoors from the beginning of the development"}, {"Time_Start": 126.0, "Time_End": 131.0, "Text": " and you can still access these functionalities,"}, {"Time_Start": 131.0, "Time_End": 134.0, "Text": " and so you can play with the system and have some more fun."}, {"Time_Start": 134.0, "Time_End": 136.0, "Text": " And there are lots of different other features,"}, {"Time_Start": 136.0, "Time_End": 139.0, "Text": " like auto-do something functions, what basically means"}, {"Time_Start": 139.0, "Time_End": 144.0, "Text": " you get a system out of the box and start it and it's getting from somewhere a configuration"}, {"Time_Start": 144.0, "Time_End": 146.0, "Text": " and therefore some kind of communication required,"}, {"Time_Start": 146.0, "Time_End": 148.0, "Text": " and sometimes you can break into these protocols and have some sort of."}, {"Time_Start": 148.0, "Time_End": 150.0, "Text": " protocols and have some fun with it."}, {"Time_Start": 150.0, "Time_End": 155.0, "Text": " And finally, the biggest problem for the developers of these kinds of systems"}, {"Time_Start": 155.0, "Time_End": 159.0, "Text": " is that marketing comes up as a cool new feature that's required on a marketplace."}, {"Time_Start": 159.0, "Time_End": 160.0, "Text": " Everything is fine."}, {"Time_Start": 160.0, "Time_End": 162.0, "Text": " We're going to need this."}, {"Time_Start": 162.0, "Time_End": 166.0, "Text": " And they enforce the developers to bring it out and bring it up and running and they develop it."}, {"Time_Start": 166.0, "Time_End": 168.0, "Text": " And the time frame is really short and really limited."}, {"Time_Start": 168.0, "Time_End": 171.0, "Text": " And so nobody is able to spend a solid on security"}, {"Time_Start": 171.0, "Time_End": 177.0, "Text": " and how the new feature impact the original design within this embedded system."}, {"Time_Start": 177.0, "Time_End": 182.0, "Text": " Okay, let's have some examples."}, {"Time_Start": 182.0, "Time_End": 185.0, "Text": " Our first example will be the loose and brick."}, {"Time_Start": 185.0, "Time_End": 190.0, "Text": " Lozen brick actually is a really cool, really cool,"}, {"Time_Start": 190.0, "Time_End": 194.0, "Text": " really cool, really handy layer 2 firewall,"}, {"Time_Start": 194.0, "Time_End": 198.0, "Text": " which is certified from the NSA and seems to be secure,"}, {"Time_Start": 198.0, "Time_End": 201.0, "Text": " but it somehow has some problem with the ARP functionality."}, {"Time_Start": 201.0, "Time_End": 206.0, "Text": " And what was the beam over there?"}, {"Time_Start": 206.0, "Time_End": 210.0, "Text": " Okay, we don't need to take that one for sure."}, {"Time_Start": 210.0, "Time_End": 216.0, "Text": " The app functionality and there has some really, really important problems."}, {"Time_Start": 216.0, "Time_End": 225.0, "Text": " Like, at first, the biggest problem is that all up traffic will be forwarded to any..."}, {"Time_Start": 225.0, "Time_End": 228.0, "Text": " I hate that."}, {"Time_Start": 228.0, "Time_End": 231.0, "Text": " Oh, thanks."}, {"Time_Start": 231.0, "Time_End": 235.0, "Text": " All up traffic from a brick, through a brick, is forwarded to any..."}, {"Time_Start": 235.0, "Time_End": 239.0, "Text": " forward to any network segment this brick firewall is based on."}, {"Time_Start": 239.0, "Time_End": 243.0, "Text": " And so with the user knowing that ability,"}, {"Time_Start": 243.0, "Time_End": 246.0, "Text": " you can do an upsweep through the whole network,"}, {"Time_Start": 246.0, "Time_End": 249.0, "Text": " and regardless what the firewall rules have says,"}, {"Time_Start": 249.0, "Time_End": 251.0, "Text": " and that might be a big problem."}, {"Time_Start": 251.0, "Time_End": 254.0, "Text": " Actually, a firewall is supposed to block traffic and somehow,"}, {"Time_Start": 254.0, "Time_End": 259.0, "Text": " and if you use the blocking feature as firewall rules"}, {"Time_Start": 259.0, "Time_End": 263.0, "Text": " and it's still forwarding traffic, I mean, what's the use in that?"}, {"Time_Start": 263.0, "Time_End": 265.0, "Text": " The next problem is,"}, {"Time_Start": 265.0, "Time_End": 272.0, "Text": " in here is that you will be able to poisoning the app table itself."}, {"Time_Start": 272.0, "Time_End": 281.0, "Text": " If you just send an ARP reply at this normal C-None network, it will insert this entry into the ARP table"}, {"Time_Start": 281.0, "Time_End": 283.0, "Text": " and replace the existing one."}, {"Time_Start": 283.0, "Time_End": 285.0, "Text": " And therefore, we have a cool example."}, {"Time_Start": 285.0, "Time_End": 289.0, "Text": " The management server on top of the system"}, {"Time_Start": 289.0, "Time_End": 294.0, "Text": " is actually the heartbeat of the whole box."}, {"Time_Start": 294.0, "Time_End": 295.0, "Text": " I mean, all the computer."}, {"Time_Start": 295.0, "Time_End": 299.0, "Text": " configuration, all logging, everything is done on this and with this server."}, {"Time_Start": 299.0, "Time_End": 300.0, "Text": " And therefore, it's really needful."}, {"Time_Start": 300.0, "Time_End": 303.0, "Text": " And if you send in a spoofed ARP reply,"}, {"Time_Start": 303.0, "Time_End": 305.0, "Text": " there is the IP address of that server,"}, {"Time_Start": 305.0, "Time_End": 307.0, "Text": " and another MAC address,"}, {"Time_Start": 307.0, "Time_End": 311.0, "Text": " the brick firewall will insert this one into its own ARP table"}, {"Time_Start": 311.0, "Time_End": 315.0, "Text": " and will replace the MAC address from the management server."}, {"Time_Start": 315.0, "Time_End": 319.0, "Text": " And you guess what the solution, the result of this is,"}, {"Time_Start": 319.0, "Time_End": 322.0, "Text": " yeah, the management server goes away and not so long available."}, {"Time_Start": 322.0, "Time_End": 324.0, "Text": " And what that means for us is actually no longer available."}, {"Time_Start": 324.0, "Time_End": 325.0, "Text": " And what that means for us is actually no longer."}, {"Time_Start": 325.0, "Time_End": 326.0, "Text": " no management."}, {"Time_Start": 326.0, "Time_End": 328.0, "Text": " I mean that's when the fund begins."}, {"Time_Start": 328.0, "Time_End": 329.0, "Text": " Okay?"}, {"Time_Start": 329.0, "Time_End": 334.0, "Text": " I mean, this is one point."}, {"Time_Start": 334.0, "Time_End": 335.0, "Text": " And it becomes harder."}, {"Time_Start": 335.0, "Time_End": 340.0, "Text": " Since the whole app functionality is not stateful as it is supposed to be,"}, {"Time_Start": 340.0, "Time_End": 343.0, "Text": " you can sit in tons of ARP replies."}, {"Time_Start": 343.0, "Time_End": 346.0, "Text": " They never ask it for it to fill out the ARP table."}, {"Time_Start": 346.0, "Time_End": 350.0, "Text": " It means normally it's not a problem since the ARP cache is supposed to time out,"}, {"Time_Start": 350.0, "Time_End": 353.0, "Text": " but loose and brick firewall doesn't even let it"}, {"Time_Start": 353.0, "Time_End": 354.0, "Text": " up cache time out."}, {"Time_Start": 354.0, "Time_End": 355.0, "Text": " And so far you just fill up."}, {"Time_Start": 355.0, "Time_End": 359.0, "Text": " the app table till all the memory is exhausted and the machine crashes."}, {"Time_Start": 359.0, "Time_End": 364.0, "Text": " And I think that's something different than I would expect from an MSA certified device."}, {"Time_Start": 364.0, "Time_End": 368.0, "Text": " It's not about it."}, {"Time_Start": 368.0, "Time_End": 372.0, "Text": " Maybe, maybe the NSA want to have it that way."}, {"Time_Start": 372.0, "Time_End": 373.0, "Text": " Who knows?"}, {"Time_Start": 373.0, "Time_End": 378.0, "Text": " The next example we have over here is the ARCEN Routers."}, {"Time_Start": 378.0, "Time_End": 383.0, "Text": " The Assen Routers themselves uses an undocumented discovery protocol,"}, {"Time_Start": 383.0, "Time_End": 384.0, "Text": " which is sent to..."}, {"Time_Start": 384.0, "Time_End": 387.0, "Text": " send to the discount part."}, {"Time_Start": 387.0, "Time_End": 390.0, "Text": " And normally you would expect that the discard port it discards the packet,"}, {"Time_Start": 390.0, "Time_End": 392.0, "Text": " why that's what it's used for."}, {"Time_Start": 392.0, "Time_End": 395.0, "Text": " But we adapt this standard and we do something different."}, {"Time_Start": 395.0, "Time_End": 397.0, "Text": " Lost the idea by Essen."}, {"Time_Start": 397.0, "Time_End": 400.0, "Text": " And so when you send the right packet to this port,"}, {"Time_Start": 400.0, "Time_End": 403.0, "Text": " you will get a new packet with lots of nice information on it."}, {"Time_Start": 403.0, "Time_End": 407.0, "Text": " These information contain the IP addresses, the Mac addresses,"}, {"Time_Start": 407.0, "Time_End": 410.0, "Text": " the names, even what kind of devices you will find in the machine"}, {"Time_Start": 410.0, "Time_End": 413.0, "Text": " like T1 interface or something like that."}, {"Time_Start": 413.0, "Time_End": 417.0, "Text": " I mean, that's one thing you can gather some information,"}, {"Time_Start": 417.0, "Time_End": 421.0, "Text": " but if you use that packet and change the values and send it right back"}, {"Time_Start": 421.0, "Time_End": 426.0, "Text": " and use the SNP white community, which is by guideline white,"}, {"Time_Start": 426.0, "Time_End": 430.0, "Text": " you can change these values, and obviously you don't want that something"}, {"Time_Start": 430.0, "Time_End": 434.0, "Text": " and someone is changing their peers of your T1 interface."}, {"Time_Start": 434.0, "Time_End": 441.0, "Text": " Okay, the next point, HP printers."}, {"Time_Start": 441.0, "Time_End": 446.0, "Text": " HP printers, you are quite handy and useful for printing."}, {"Time_Start": 446.0, "Time_End": 452.0, "Text": " And to configure these machines, you can have several ways of accessing these machines,"}, {"Time_Start": 452.0, "Time_End": 455.0, "Text": " like HTTP, TANET, FTP, whatever."}, {"Time_Start": 455.0, "Time_End": 461.0, "Text": " The most important ones is the HTTP port and the PJL port,"}, {"Time_Start": 461.0, "Time_End": 466.0, "Text": " which allows you different information together from the machine."}, {"Time_Start": 466.0, "Time_End": 470.0, "Text": " HP thought about security and somehow and introduced several ways of action."}, {"Time_Start": 470.0, "Time_End": 474.0, "Text": " ways of access restrictions on that."}, {"Time_Start": 474.0, "Time_End": 478.0, "Text": " So it seems to be pretty cool, but there's one little problem."}, {"Time_Start": 478.0, "Time_End": 484.0, "Text": " You have someone who's thought about security and the other ones thought about usability."}, {"Time_Start": 484.0, "Time_End": 487.0, "Text": " They're sitting far away in HP and they don't know it,"}, {"Time_Start": 487.0, "Time_End": 490.0, "Text": " other until we come to one major problem."}, {"Time_Start": 490.0, "Time_End": 495.0, "Text": " For example, with only the knowledge of the SNMP read community,"}, {"Time_Start": 495.0, "Time_End": 499.0, "Text": " you can gather with these SNMP variable, the HGTP variable."}, {"Time_Start": 499.0, "Time_End": 503.0, "Text": " HTTP password for full access."}, {"Time_Start": 503.0, "Time_End": 506.0, "Text": " And once you got this, the printer is more or less yours."}, {"Time_Start": 506.0, "Time_End": 510.0, "Text": " Okay, next step with HTTP printers."}, {"Time_Start": 510.0, "Time_End": 511.0, "Text": " PGL."}, {"Time_Start": 511.0, "Time_End": 515.0, "Text": " PJL, it's supposed to be the printer job language."}, {"Time_Start": 515.0, "Time_End": 518.0, "Text": " And normally whenever you do something with a printer"}, {"Time_Start": 518.0, "Time_End": 521.0, "Text": " and you print something out, you use this PGL."}, {"Time_Start": 521.0, "Time_End": 523.0, "Text": " This is quite cool."}, {"Time_Start": 523.0, "Time_End": 526.0, "Text": " You send out your stuff in that there and you have some environment values."}, {"Time_Start": 526.0, "Time_End": 528.0, "Text": " You can use it for,"}, {"Time_Start": 528.0, "Time_End": 529.0, "Text": " when you copy, you want to print."}, {"Time_Start": 529.0, "Time_End": 534.0, "Text": " and which paper trail you want to use and all this information."}, {"Time_Start": 534.0, "Time_End": 538.0, "Text": " This is quite easy and quite handy and you very often use it."}, {"Time_Start": 538.0, "Time_End": 542.0, "Text": " The whole security on even PGL for the environment variables"}, {"Time_Start": 542.0, "Time_End": 551.0, "Text": " is based on one single password, which is actually a number between 1 and 65,535."}, {"Time_Start": 551.0, "Time_End": 555.0, "Text": " And easily you can remotely put forth this in within six hours."}, {"Time_Start": 555.0, "Time_End": 558.0, "Text": " And I mean, what kind of security is this in here?"}, {"Time_Start": 558.0, "Time_End": 559.0, "Text": " Okay."}, {"Time_Start": 559.0, "Time_End": 560.0, "Text": " Okay, let's go on."}, {"Time_Start": 560.0, "Time_End": 561.0, "Text": " This is the PGL."}, {"Time_Start": 561.0, "Time_End": 573.0, "Text": " That's where I want to go to."}, {"Time_Start": 573.0, "Time_End": 577.0, "Text": " PGL also allows you access to the file system of the printer itself."}, {"Time_Start": 577.0, "Time_End": 580.0, "Text": " I mean, it's a cool idea that the new printers."}, {"Time_Start": 580.0, "Time_End": 583.0, "Text": " Thanks."}, {"Time_Start": 583.0, "Time_End": 586.0, "Text": " My fault."}, {"Time_Start": 586.0, "Time_End": 588.0, "Text": " Anyway."}, {"Time_Start": 588.0, "Time_End": 593.0, "Text": " Yeah, PG outside gives you access to the file system of the printer."}, {"Time_Start": 593.0, "Time_End": 598.0, "Text": " And with that file system, we found lots of needful things like the firmware of the printer,"}, {"Time_Start": 598.0, "Time_End": 604.0, "Text": " like the print jobs, everything what's going on in the printer that's actually based in that file system."}, {"Time_Start": 604.0, "Time_End": 607.0, "Text": " Once you have access to it, you can manipulate it in the way you like it."}, {"Time_Start": 607.0, "Time_End": 613.0, "Text": " And for example, we have here, it should be coming now."}, {"Time_Start": 613.0, "Time_End": 617.0, "Text": " Oh, this is actually the one printer of the file."}, {"Time_Start": 617.0, "Time_End": 618.0, "Text": " one printer of the file system."}, {"Time_Start": 618.0, "Time_End": 620.0, "Text": " I mean, it's a five system as you know it."}, {"Time_Start": 620.0, "Time_End": 621.0, "Text": " Normally from every other system."}, {"Time_Start": 621.0, "Time_End": 627.0, "Text": " It's just file entries, files, you can copy, you can download, you can do whatever you"}, {"Time_Start": 627.0, "Time_End": 628.0, "Text": " can create software."}, {"Time_Start": 628.0, "Time_End": 631.0, "Text": " Everything you need is on that machine."}, {"Time_Start": 631.0, "Time_End": 636.0, "Text": " Okay, okay."}, {"Time_Start": 636.0, "Time_End": 640.0, "Text": " Okay."}, {"Time_Start": 640.0, "Time_End": 645.0, "Text": " In order to get the PGLT, if it's not much more handy for you guys, we develop two kinds of tools."}, {"Time_Start": 645.0, "Time_End": 646.0, "Text": " The first two we developed is a command."}, {"Time_Start": 646.0, "Time_End": 648.0, "Text": " we developed as a command line tool."}, {"Time_Start": 648.0, "Time_End": 654.0, "Text": " Use that for command line tool, you can access the file system, even the environment"}, {"Time_Start": 654.0, "Time_End": 656.0, "Text": " variables and all that stuff."}, {"Time_Start": 656.0, "Time_End": 659.0, "Text": " This is running from the same source through on our Windows and our Linux."}, {"Time_Start": 659.0, "Time_End": 660.0, "Text": " It's really cool."}, {"Time_Start": 660.0, "Time_End": 661.0, "Text": " It's really handy."}, {"Time_Start": 661.0, "Time_End": 664.0, "Text": " The screenshot you have seen earlier is actually out of this tool."}, {"Time_Start": 664.0, "Time_End": 669.0, "Text": " And for all the guys who don't like any kind of command line tools, I need something to click on,"}, {"Time_Start": 669.0, "Time_End": 671.0, "Text": " we created..."}, {"Time_Start": 671.0, "Time_End": 674.0, "Text": " The real hackers, yeah, sure."}, {"Time_Start": 674.0, "Time_End": 676.0, "Text": " We created a really, really nice looking..."}, {"Time_Start": 676.0, "Time_End": 678.0, "Text": " that's called hi-jetter."}, {"Time_Start": 687.0, "Time_End": 689.0, "Text": " Okay, this is the basic interface."}, {"Time_Start": 689.0, "Time_End": 690.0, "Text": " I mean, it's very complicated to use."}, {"Time_Start": 690.0, "Time_End": 692.0, "Text": " You have to type in an IP address in the right port,"}, {"Time_Start": 692.0, "Time_End": 694.0, "Text": " which is more or less the same."}, {"Time_Start": 694.0, "Time_End": 696.0, "Text": " And just connect to the print and then you have access"}, {"Time_Start": 696.0, "Time_End": 700.0, "Text": " to the environment where you have the file system or even the display."}, {"Time_Start": 700.0, "Time_End": 702.0, "Text": " For example, right here we have the file system."}, {"Time_Start": 702.0, "Time_End": 705.0, "Text": " On the left-hand side, you have your local system."}, {"Time_Start": 705.0, "Time_End": 706.0, "Text": " And on the right-hand side, you have your local system."}, {"Time_Start": 706.0, "Time_End": 708.0, "Text": " you have the system of the printer."}, {"Time_Start": 708.0, "Time_End": 712.0, "Text": " Just to get sure that you know how to use this tool, okay?"}, {"Time_Start": 714.0, "Time_End": 718.0, "Text": " And as you can see there, you have the web server staff,"}, {"Time_Start": 718.0, "Time_End": 722.0, "Text": " the filmware stuff and everything you want to get on."}, {"Time_Start": 722.0, "Time_End": 726.0, "Text": " The second is just for setting environment variables."}, {"Time_Start": 726.0, "Time_End": 730.0, "Text": " Then there's a third dialogue for setting discipline message."}, {"Time_Start": 730.0, "Time_End": 735.0, "Text": " One cool thing is we have done and we really scared people with their foreign idea."}, {"Time_Start": 735.0, "Time_End": 739.0, "Text": " idea, just setting the environment value for locking the printer"}, {"Time_Start": 739.0, "Time_End": 743.0, "Text": " panel so that nobody can go on the printer and switch and ready or something like that"}, {"Time_Start": 743.0, "Time_End": 746.0, "Text": " and change the digital message as a failure to insert coin."}, {"Time_Start": 746.0, "Time_End": 749.0, "Text": " People get scared on that."}, {"Time_Start": 749.0, "Time_End": 758.0, "Text": " Oh shit."}, {"Time_Start": 758.0, "Time_End": 760.0, "Text": " Okay, now I have to hurry up a bit."}, {"Time_Start": 760.0, "Time_End": 764.0, "Text": " Another new feature of within HP printers is CHIBM."}, {"Time_Start": 764.0, "Time_End": 770.0, "Text": " ChivM is a Java virtual machine, which is introduced by HP normally for printers,"}, {"Time_Start": 770.0, "Time_End": 775.0, "Text": " but ChyVM also, and that's in statement quoted from HP,"}, {"Time_Start": 775.0, "Time_End": 777.0, "Text": " and the last sense is the most interesting."}, {"Time_Start": 777.0, "Time_End": 781.0, "Text": " These appliances are powered by HB, child embedded software."}, {"Time_Start": 781.0, "Time_End": 786.0, "Text": " That basically means HP is not going to do this only to supply printers with ChivM,"}, {"Time_Start": 786.0, "Time_End": 787.0, "Text": " also other systems."}, {"Time_Start": 787.0, "Time_End": 792.0, "Text": " And that's where it comes interesting, because Chivam"}, {"Time_Start": 792.0, "Time_End": 800.0, "Text": " allows you to insert new modules onto the system and to run your own services on a printer."}, {"Time_Start": 800.0, "Time_End": 806.0, "Text": " In order to do this, HP introduced one service that's called,"}, {"Time_Start": 806.0, "Time_End": 807.0, "Text": " this is not loader."}, {"Time_Start": 807.0, "Time_End": 815.0, "Text": " This is a nice and really, really cool security feature that all the new servers you want to introduce has to be signed by HP."}, {"Time_Start": 815.0, "Time_End": 821.0, "Text": " But it wasn't that still, as it should be, so HP released a new loader, the easy loader."}, {"Time_Start": 821.0, "Time_End": 825.0, "Text": " The easy loader is a signed jar packets so that you can upload it through the printer."}, {"Time_Start": 825.0, "Time_End": 831.0, "Text": " But if you get this one running, you don't need to get your new jar packets is signed in some,"}, {"Time_Start": 831.0, "Time_End": 835.0, "Text": " or you can just upload any kind of stuff you want to do."}, {"Time_Start": 835.0, "Time_End": 839.0, "Text": " That's a complicated way and the more easiest way."}, {"Time_Start": 839.0, "Time_End": 846.0, "Text": " Both of these loaders are actually nothing else to, and doing nothing else than transforming the CS config file,"}, {"Time_Start": 846.0, "Time_End": 848.0, "Text": " which is based in a file system."}, {"Time_Start": 848.0, "Time_End": 851.0, "Text": " Once you have access to the file, you change this file, loaded it in you up, and,"}, {"Time_Start": 851.0, "Time_End": 854.0, "Text": " Yeah, you have uploaded your new service."}, {"Time_Start": 854.0, "Time_End": 859.0, "Text": " I think I'm going to get this one because we are a bit in hurry."}, {"Time_Start": 859.0, "Time_End": 863.0, "Text": " Anyway, as far as we have played with Chibirang,"}, {"Time_Start": 863.0, "Time_End": 866.0, "Text": " Chibu is very stable."}, {"Time_Start": 866.0, "Time_End": 872.0, "Text": " We had real problems with the development environment."}, {"Time_Start": 872.0, "Time_End": 875.0, "Text": " You can get by HP and the real world."}, {"Time_Start": 875.0, "Time_End": 880.0, "Text": " Something that runs in a development environment, not necessarily must run stable on the printer."}, {"Time_Start": 880.0, "Time_End": 885.0, "Text": " And, yeah, therefore, very often to use the edge,"}, {"Time_Start": 885.0, "Time_End": 888.0, "Text": " there's an appeal to reset the printer to get the child stuff up and running"}, {"Time_Start": 888.0, "Time_End": 890.0, "Text": " without going on the machine."}, {"Time_Start": 890.0, "Time_End": 893.0, "Text": " What you can do with Charm."}, {"Time_Start": 893.0, "Time_End": 896.0, "Text": " Yeah."}, {"Time_Start": 896.0, "Time_End": 898.0, "Text": " What you can do with Charm."}, {"Time_Start": 898.0, "Time_End": 903.0, "Text": " We have developed one port scanner which is actually running on the printer"}, {"Time_Start": 903.0, "Time_End": 906.0, "Text": " and scanning from the printer, the remote network,"}, {"Time_Start": 906.0, "Time_End": 909.0, "Text": " so that we might just kick this on, wait a while, come back and get results."}, {"Time_Start": 910.0, "Time_End": 916.0, "Text": " that's more than funny. I mean, I don't even have to be on site. I'm using a printer."}, {"Time_Start": 916.0, "Time_End": 922.0, "Text": " The next thing is, we decided that we don't want to spend power cycles on all our laptops."}, {"Time_Start": 922.0, "Time_End": 925.0, "Text": " We decided to use the printer for that and we implemented a chai cracker,"}, {"Time_Start": 925.0, "Time_End": 930.0, "Text": " which is used to just break cryptic passwords and somehow."}, {"Time_Start": 930.0, "Time_End": 937.0, "Text": " The summarization of that is everything you get running with Java and you get running on the printer,"}, {"Time_Start": 937.0, "Time_End": 939.0, "Text": " you can do with the printer. I mean, this is fun."}, {"Time_Start": 939.0, "Time_End": 941.0, "Text": " I mean, this is fun, isn't it?"}, {"Time_Start": 941.0, "Time_End": 942.0, "Text": " I mean, the printer is not anymore."}, {"Time_Start": 942.0, "Time_End": 943.0, "Text": " It's more, it's more."}, {"Time_Start": 943.0, "Time_End": 945.0, "Text": " It's actually a full-powered machine."}, {"Time_Start": 945.0, "Time_End": 948.0, "Text": " You can play with."}, {"Time_Start": 948.0, "Time_End": 953.0, "Text": " This is actually a screenshot from the crypt-cracker,"}, {"Time_Start": 953.0, "Time_End": 956.0, "Text": " running on the printer."}, {"Time_Start": 956.0, "Time_End": 959.0, "Text": " The last thing I want to describe you is"}, {"Time_Start": 959.0, "Time_End": 963.0, "Text": " that there are already lots of nice services with child in the wild available."}, {"Time_Start": 963.0, "Time_End": 966.0, "Text": " The most interesting are two ones of them."}, {"Time_Start": 966.0, "Time_End": 968.0, "Text": " The one is the notifier service."}, {"Time_Start": 968.0, "Time_End": 969.0, "Text": " The notifier service"}, {"Time_Start": 969.0, "Time_End": 974.0, "Text": " enables you to get a notification when something nice is going on on a printer."}, {"Time_Start": 974.0, "Time_End": 978.0, "Text": " Maybe your boss is printing something after six and you want to know what it is."}, {"Time_Start": 978.0, "Time_End": 980.0, "Text": " You get an email and you know what it is."}, {"Time_Start": 982.0, "Time_End": 985.0, "Text": " And the last service, quite cool, is the email service."}, {"Time_Start": 985.0, "Time_End": 991.0, "Text": " You can configure your printer to pull a certain pop account somewhere in the right world."}, {"Time_Start": 991.0, "Time_End": 996.0, "Text": " And whenever you send a right formatted email to this pop account,"}, {"Time_Start": 996.0, "Time_End": 999.0, "Text": " the printer pulls it down and execute a command,"}, {"Time_Start": 999.0, "Time_End": 1000.0, "Text": " is hidden in."}, {"Time_Start": 1000.0, "Time_End": 1001.0, "Text": " What does it mean to us?"}, {"Time_Start": 1001.0, "Time_End": 1005.0, "Text": " We just jump on the network, pick up the printer, implement that service,"}, {"Time_Start": 1005.0, "Time_End": 1007.0, "Text": " and whatever you do is your firewall, I don't care."}, {"Time_Start": 1007.0, "Time_End": 1011.5, "Text": " As long as you let pop through, pops through going out of the network, I can play with your printer."}, {"Time_Start": 1011.5, "Time_End": 1014.5, "Text": " I don't need to be on site anymore."}, {"Time_Start": 1014.5, "Time_End": 1017.0, "Text": " Okay, that's it from my side currently."}, {"Time_Start": 1017.0, "Time_End": 1022.0, "Text": " All the stuff we have done, you will find on Finlay to slash HP."}, {"Time_Start": 1022.0, "Time_End": 1028.0, "Text": " You can download it from there, you will find there the command line tools, some of the child services,"}, {"Time_Start": 1028.0, "Time_End": 1031.0, "Text": " services and even the hydator as well."}, {"Time_Start": 1031.0, "Time_End": 1034.0, "Text": " Now I have to hand over to TC, FX."}, {"Time_Start": 1034.0, "Time_End": 1037.0, "Text": " Anyway, different style, different area."}, {"Time_Start": 1037.0, "Time_End": 1042.0, "Text": " He want you to describe software vulnerabilities and have some fun with Cisco."}, {"Time_Start": 1042.0, "Time_End": 1044.0, "Text": " Thanks for FTR."}, {"Time_Start": 1044.0, "Time_End": 1048.0, "Text": " Thank you, FTR."}, {"Time_Start": 1048.0, "Time_End": 1054.0, "Text": " Hey, hey, hey, don't waste my time, okay?"}, {"Time_Start": 1054.0, "Time_End": 1057.0, "Text": " Software vulnerabilities, I mean,"}, {"Time_Start": 1057.0, "Time_End": 1059.0, "Text": " I mean, yeah."}, {"Time_Start": 1059.0, "Time_End": 1060.0, "Text": " Huh?"}, {"Time_Start": 1060.0, "Time_End": 1069.0, "Text": " Just try to figure out how to spell our website and then put slash HP on it."}, {"Time_Start": 1069.0, "Time_End": 1073.0, "Text": " Okay, software vulnerabilities."}, {"Time_Start": 1073.0, "Time_End": 1077.0, "Text": " Well, embedded systems actually are just a bunch of codes."}, {"Time_Start": 1077.0, "Time_End": 1082.0, "Text": " And the guys who coded are just a bunch of developers."}, {"Time_Start": 1082.0, "Time_End": 1086.0, "Text": " So, they do the same thoughts like Windows and Unix coders."}, {"Time_Start": 1086.0, "Time_End": 1090.0, "Text": " do, which basically is like input validation, we all know that stuff."}, {"Time_Start": 1090.0, "Time_End": 1093.0, "Text": " Format strings, especially in the logging code."}, {"Time_Start": 1093.0, "Time_End": 1095.0, "Text": " It's real bad."}, {"Time_Start": 1095.0, "Time_End": 1097.0, "Text": " Buffer overflows, well-known stuff."}, {"Time_Start": 1097.0, "Time_End": 1100.0, "Text": " I mean, even some buffer overflows on embedded systems"}, {"Time_Start": 1100.0, "Time_End": 1102.0, "Text": " got published to bug trick."}, {"Time_Start": 1102.0, "Time_End": 1105.0, "Text": " And yes, you can do cross-scripting on it."}, {"Time_Start": 1105.0, "Time_End": 1107.0, "Text": " Actually, the HP printers are one example."}, {"Time_Start": 1107.0, "Time_End": 1110.0, "Text": " You just go in, enter some additional information."}, {"Time_Start": 1110.0, "Time_End": 1113.0, "Text": " It will show up on the website, and of course it's cross-scriptible."}, {"Time_Start": 1113.0, "Time_End": 1115.0, "Text": " So, yeah, most embedded HD printers."}, {"Time_Start": 1115.0, "Time_End": 1116.0, "Text": " So, yeah."}, {"Time_Start": 1116.0, "Time_End": 1120.0, "Text": " DEMs I played with died within five minutes."}, {"Time_Start": 1120.0, "Time_End": 1126.0, "Text": " And I never saw a rock stable HTTP demon for embedded systems."}, {"Time_Start": 1126.0, "Time_End": 1133.0, "Text": " So, yeah, summary, limited resources lead to the fact that the developers think,"}, {"Time_Start": 1133.0, "Time_End": 1139.0, "Text": " oh, well, I skip that check, I skip that check, and the user's going to be nice."}, {"Time_Start": 1139.0, "Time_End": 1145.0, "Text": " But for overflows, we have like four, just for starters,"}, {"Time_Start": 1145.0, "Time_End": 1146.0, "Text": " ZDR routers."}, {"Time_Start": 1146.0, "Time_End": 1150.0, "Text": " Quite nice routers. Today, a Luzon product."}, {"Time_Start": 1150.0, "Time_End": 1152.0, "Text": " Actually pretty good routers."}, {"Time_Start": 1152.0, "Time_End": 1155.0, "Text": " And they have an HTTP demon."}, {"Time_Start": 1155.0, "Time_End": 1158.0, "Text": " You do a long get request, you crash the router."}, {"Time_Start": 1158.0, "Time_End": 1160.0, "Text": " I mean, it's so plain simple."}, {"Time_Start": 1160.0, "Time_End": 1163.0, "Text": " Rother network printer, same thing,"}, {"Time_Start": 1163.0, "Time_End": 1166.0, "Text": " but you don't actually have to do a long get request."}, {"Time_Start": 1166.0, "Time_End": 1169.0, "Text": " You just go to the browser printer to the web page."}, {"Time_Start": 1169.0, "Time_End": 1171.0, "Text": " It asks you for the administrator password."}, {"Time_Start": 1171.0, "Time_End": 1175.0, "Text": " You put over 100 characters in, click, submit, it dies."}, {"Time_Start": 1176.0, "Time_End": 1179.0, "Text": " HP, they did a cool switch."}, {"Time_Start": 1179.0, "Time_End": 1180.0, "Text": " ProKov."}, {"Time_Start": 1180.0, "Time_End": 1184.0, "Text": " Actually, that vulnerability is pretty neat because normally with SNMP right,"}, {"Time_Start": 1184.0, "Time_End": 1186.0, "Text": " you would really badly abuse the switch."}, {"Time_Start": 1186.0, "Time_End": 1188.0, "Text": " No, you don't do that."}, {"Time_Start": 1188.0, "Time_End": 1191.0, "Text": " You just feel that variable over here with 85 characters,"}, {"Time_Start": 1191.0, "Time_End": 1193.0, "Text": " and it doesn't die."}, {"Time_Start": 1193.0, "Time_End": 1197.0, "Text": " No, it dies next time the admin tries to access the switch."}, {"Time_Start": 1197.0, "Time_End": 1200.0, "Text": " That's like awesome."}, {"Time_Start": 1200.0, "Time_End": 1206.0, "Text": " And of course, even like, like, cigarette box, size,"}, {"Time_Start": 1206.0, "Time_End": 1210.0, "Text": " devices and for the non-smokers, this is how a cigarette box looks like."}, {"Time_Start": 1210.0, "Time_End": 1214.0, "Text": " There's a print service hanging off printers."}, {"Time_Start": 1214.0, "Time_End": 1217.0, "Text": " They actually have same vulnerabilities."}, {"Time_Start": 1217.0, "Time_End": 1219.0, "Text": " You go to the print server."}, {"Time_Start": 1219.0, "Time_End": 1221.0, "Text": " It asks, so forth a password, guess what you do?"}, {"Time_Start": 1221.0, "Time_End": 1223.0, "Text": " You put a bunch of ASIN."}, {"Time_Start": 1223.0, "Time_End": 1226.0, "Text": " You click submit, it dies, and it takes the printer with us."}, {"Time_Start": 1226.0, "Time_End": 1228.0, "Text": " And that's actually how the device looks."}, {"Time_Start": 1228.0, "Time_End": 1231.0, "Text": " I mean, it's innocent, isn't it?"}, {"Time_Start": 1231.0, "Time_End": 1234.0, "Text": " Yeah, common misconceptions."}, {"Time_Start": 1234.0, "Time_End": 1235.0, "Text": " Stuff I always hear about exploits."}, {"Time_Start": 1235.0, "Time_End": 1237.0, "Text": " here about exploiting embedded systems."}, {"Time_Start": 1237.0, "Time_End": 1239.0, "Text": " It's like, it's so hard."}, {"Time_Start": 1239.0, "Time_End": 1243.0, "Text": " It's way harder than writing a heck for Windows."}, {"Time_Start": 1243.0, "Time_End": 1247.0, "Text": " I mean, you really have to reverse-engineer the full firmware"}, {"Time_Start": 1247.0, "Time_End": 1249.0, "Text": " to find out how it is going."}, {"Time_Start": 1249.0, "Time_End": 1252.0, "Text": " And then you really need to know how the syskhauls work"}, {"Time_Start": 1252.0, "Time_End": 1255.0, "Text": " and how the libraries are getting in and all that."}, {"Time_Start": 1255.0, "Time_End": 1259.0, "Text": " And basically the worst thing that can happen is the device crashes."}, {"Time_Start": 1259.0, "Time_End": 1261.0, "Text": " You know what?"}, {"Time_Start": 1265.0, "Time_End": 1271.0, "Text": " And, yeah, for all the guys here, just don't know what to do after DEFCOM."}, {"Time_Start": 1271.0, "Time_End": 1280.0, "Text": " And to prove that wrong and make sure embedded system vendors actually understand that they should care about security and get some good coders,"}, {"Time_Start": 1280.0, "Time_End": 1286.0, "Text": " we're going to do kind of tutorial on how Wright exploits for iOS."}, {"Time_Start": 1286.0, "Time_End": 1290.0, "Text": " So now we go to some heavy-duty shit."}, {"Time_Start": 1290.0, "Time_End": 1294.0, "Text": " Actually, yeah, the problem here is if you do something to a something to a service,"}, {"Time_Start": 1294.0, "Time_End": 1301.0, "Text": " do something to a Cisco router, it will crash. I mean honestly, if it doesn't feel good, it will crash."}, {"Time_Start": 1301.0, "Time_End": 1307.0, "Text": " They have a bunch of platforms, so we need something that is like widely used."}, {"Time_Start": 1307.0, "Time_End": 1312.0, "Text": " And of course we can't go to like iOS. SourceForge.net and check out how it works."}, {"Time_Start": 1312.0, "Time_End": 1322.0, "Text": " Actually, this is from the Cisco TFTP advisory saying that the worst thing that can happen is that the Cisco crash."}, {"Time_Start": 1322.0, "Time_End": 1323.0, "Text": " Let's see if that's true."}, {"Time_Start": 1323.0, "Time_End": 1325.0, "Text": " Yeah."}, {"Time_Start": 1325.0, "Time_End": 1329.0, "Text": " According to Cisco, the biggest problem are memory corruptions."}, {"Time_Start": 1329.0, "Time_End": 1333.0, "Text": " Actually, 85% of all iOS bugs are memory corruptions."}, {"Time_Start": 1333.0, "Time_End": 1339.0, "Text": " Now, if you put a bunch of A's somewhere in, and it dies, and it is a memory corruption,"}, {"Time_Start": 1339.0, "Time_End": 1343.0, "Text": " you can guess it as a heap exploit, or at least a heap overflow."}, {"Time_Start": 1343.0, "Time_End": 1345.0, "Text": " Let's see if we can explore that."}, {"Time_Start": 1345.0, "Time_End": 1352.0, "Text": " So to research the vulnerability, we actually found something with a TFTP server."}, {"Time_Start": 1352.0, "Time_End": 1353.0, "Text": " Nobody used it."}, {"Time_Start": 1353.0, "Time_End": 1356.0, "Text": " anyway, but we needed some to research it."}, {"Time_Start": 1356.0, "Time_End": 1357.0, "Text": " It's just a lame bug."}, {"Time_Start": 1357.0, "Time_End": 1361.0, "Text": " I mean, you send a TFTP request with a long file name."}, {"Time_Start": 1361.0, "Time_End": 1363.0, "Text": " It crashes."}, {"Time_Start": 1363.0, "Time_End": 1364.0, "Text": " Good."}, {"Time_Start": 1364.0, "Time_End": 1368.0, "Text": " Actually, someone said yesterday to me that this was already published two years ago,"}, {"Time_Start": 1368.0, "Time_End": 1371.0, "Text": " so if that's the case, I'm sorry."}, {"Time_Start": 1371.0, "Time_End": 1374.0, "Text": " Okay, taking it apart."}, {"Time_Start": 1374.0, "Time_End": 1379.0, "Text": " Then, if we get like a crash dump on a console,"}, {"Time_Start": 1379.0, "Time_End": 1381.0, "Text": " that's basically one part of it."}, {"Time_Start": 1381.0, "Time_End": 1382.0, "Text": " That's how it looks."}, {"Time_Start": 1382.0, "Time_End": 1383.0, "Text": " So, without it."}, {"Time_Start": 1383.0, "Time_End": 1389.0, "Text": " doing all that IDA stuff on the iOS image, we just do a correlation between the crash dump,"}, {"Time_Start": 1389.0, "Time_End": 1395.0, "Text": " this kind of info, core dumps, all kinds of stuff, and what we find out is this."}, {"Time_Start": 1395.0, "Time_End": 1397.0, "Text": " Look, we have a block magic."}, {"Time_Start": 1397.0, "Time_End": 1401.0, "Text": " This is like, okay, I start here, common sense."}, {"Time_Start": 1401.0, "Time_End": 1404.0, "Text": " The next thing is probably the process ID."}, {"Time_Start": 1404.0, "Time_End": 1408.0, "Text": " I can't think of anything else that needs it to in here."}, {"Time_Start": 1408.0, "Time_End": 1413.0, "Text": " Then we have a memory block that is later in the memory, like higher up, and"}, {"Time_Start": 1413.0, "Time_End": 1417.0, "Text": " also starts with the block magic, so it's probably the next block."}, {"Time_Start": 1417.0, "Time_End": 1421.0, "Text": " And if something points lower in memory, it might be the previous block."}, {"Time_Start": 1421.0, "Time_End": 1427.0, "Text": " And yeah, finally we have the size over there with a quite funny, most significant bit,"}, {"Time_Start": 1427.0, "Time_End": 1432.0, "Text": " which we found out is used for, is that block in use or not."}, {"Time_Start": 1432.0, "Time_End": 1438.0, "Text": " So, again, going to Cisco's website, they're all verbose about it."}, {"Time_Start": 1438.0, "Time_End": 1441.0, "Text": " We check which memory addresses are used."}, {"Time_Start": 1441.0, "Time_End": 1443.0, "Text": " Just to make sense of it, we check,"}, {"Time_Start": 1443.0, "Time_End": 1450.0, "Text": " over here, these are the models we have in a lab, so, and of course we are most interested in the NV-RAM"}, {"Time_Start": 1450.0, "Time_End": 1454.0, "Text": " because it stores the config."}, {"Time_Start": 1454.0, "Time_End": 1458.0, "Text": " So putting it together, that's basically how it looks."}, {"Time_Start": 1458.0, "Time_End": 1461.0, "Text": " Oh great, you don't even see the errors."}, {"Time_Start": 1461.0, "Time_End": 1464.0, "Text": " Yeah, let's do some laser pointer magic here."}, {"Time_Start": 1464.0, "Time_End": 1470.0, "Text": " We have the magic block, we have the PID, we have some addresses, I mean that's like serious overhead."}, {"Time_Start": 1470.0, "Time_End": 1472.0, "Text": " We have the next pointer, previous pointer."}, {"Time_Start": 1472.0, "Time_End": 1475.0, "Text": " a previous pointer, then we have size and usage,"}, {"Time_Start": 1475.0, "Time_End": 1477.0, "Text": " then we have some field, that's mostly one."}, {"Time_Start": 1477.0, "Time_End": 1482.0, "Text": " I don't really care about it, but it's called RF, C&T,"}, {"Time_Start": 1482.0, "Time_End": 1485.0, "Text": " for me, that sounds like reference count."}, {"Time_Start": 1485.0, "Time_End": 1488.0, "Text": " And then we have a red zone that's basically a cannery"}, {"Time_Start": 1488.0, "Time_End": 1493.0, "Text": " and makes sure that iOS catches it when it overflows the buffer."}, {"Time_Start": 1493.0, "Time_End": 1499.0, "Text": " So, okay, what we plan to do here is we have that host block"}, {"Time_Start": 1499.0, "Time_End": 1502.0, "Text": " with our legitimate data, that's basically"}, {"Time_Start": 1502.0, "Time_End": 1505.0, "Text": " where we're sitting in, that's why we call it the host block."}, {"Time_Start": 1505.0, "Time_End": 1513.0, "Text": " And what we try to do is we overflow it, and the next block, after that, also has an header."}, {"Time_Start": 1513.0, "Time_End": 1520.0, "Text": " So we try to overflow it a way that we can influence that header here, as intelligent as possible,"}, {"Time_Start": 1520.0, "Time_End": 1525.0, "Text": " and hope that IS makes some use of it and abuses itself."}, {"Time_Start": 1525.0, "Time_End": 1529.0, "Text": " That's basically how it's planned to work."}, {"Time_Start": 1529.0, "Time_End": 1531.0, "Text": " So what happens if..."}, {"Time_Start": 1532.0, "Time_End": 1535.0, "Text": " iOS freeze the memory block we just overwrote."}, {"Time_Start": 1535.0, "Time_End": 1538.0, "Text": " Basically, they have a double-linked list."}, {"Time_Start": 1538.0, "Time_End": 1541.0, "Text": " It's, yeah, pointing back and forward."}, {"Time_Start": 1541.0, "Time_End": 1545.0, "Text": " I mean, everyone who knows how that goes, it's just two pointers,"}, {"Time_Start": 1545.0, "Time_End": 1547.0, "Text": " always pointing to the next and the previous block."}, {"Time_Start": 1547.0, "Time_End": 1553.0, "Text": " And when it freeze that, it will try to take out this block of the linked list,"}, {"Time_Start": 1553.0, "Time_End": 1556.0, "Text": " which is basically, yeah, that's the way it looks."}, {"Time_Start": 1556.0, "Time_End": 1561.0, "Text": " It's a coming pointer exchange operation, and that's what we looked for."}, {"Time_Start": 1561.0, "Time_End": 1563.0, "Text": " Oh, I'm actually burning the table here."}, {"Time_Start": 1563.0, "Time_End": 1564.0, "Text": " Cool."}, {"Time_Start": 1564.0, "Time_End": 1568.0, "Text": " FDR, could you, like, take care of that fire stuff over here?"}, {"Time_Start": 1568.0, "Time_End": 1570.0, "Text": " Thank you."}, {"Time_Start": 1570.0, "Time_End": 1573.0, "Text": " So, yeah, that's what we were looking for."}, {"Time_Start": 1573.0, "Time_End": 1576.0, "Text": " And, yeah, let's see if we can exploit that a bit."}, {"Time_Start": 1576.0, "Time_End": 1582.0, "Text": " But first, we have to find out what iOS actually needs of that."}, {"Time_Start": 1582.0, "Time_End": 1587.0, "Text": " And it's quite funny, because if you look, that's red, that's red."}, {"Time_Start": 1587.0, "Time_End": 1590.0, "Text": " So what is the other stuff for?"}, {"Time_Start": 1590.0, "Time_End": 1595.0, "Text": " You usually have to buy new memory if you put a new iOS image on the router."}, {"Time_Start": 1595.0, "Time_End": 1597.0, "Text": " Now you know why."}, {"Time_Start": 1597.0, "Time_End": 1601.0, "Text": " Okay, so we have that magic block."}, {"Time_Start": 1601.0, "Time_End": 1602.0, "Text": " Of course, that's checked."}, {"Time_Start": 1602.0, "Time_End": 1606.0, "Text": " The PID and these RAM addresses here are not checked at all."}, {"Time_Start": 1606.0, "Time_End": 1609.0, "Text": " I don't actually know what they're used for."}, {"Time_Start": 1609.0, "Time_End": 1613.0, "Text": " Funny, the next pointer is not checked,"}, {"Time_Start": 1613.0, "Time_End": 1616.0, "Text": " but the previous pointer has to be 100% correct."}, {"Time_Start": 1616.0, "Time_End": 1619.0, "Text": " And the size field shouldn't contain any bullshit."}, {"Time_Start": 1619.0, "Time_End": 1626.0, "Text": " bullshit. So, and of course the red zone is checked, so it finds out of a shit all over himself."}, {"Time_Start": 1626.0, "Time_End": 1635.0, "Text": " But you know what? Did you notice something? From here to here, we know everything."}, {"Time_Start": 1635.0, "Time_End": 1643.0, "Text": " Or we can put in bogus values and it will not care. But one of the two pointers is used in a pointer operation."}, {"Time_Start": 1643.0, "Time_End": 1648.98, "Text": " Let's take a Cisco. We overflow it over here, put some stuff that's like the"}, {"Time_Start": 1649.0, "Time_End": 1654.0, "Text": " red zone from the last block. That's the magic beginning. We put some stuff in here."}, {"Time_Start": 1654.0, "Time_End": 1658.0, "Text": " It doesn't really matter. Put the NV-RAM address over here."}, {"Time_Start": 1658.0, "Time_End": 1666.0, "Text": " And on 2,500, the free, this pointer exchange operation, will then write this previous pointer"}, {"Time_Start": 1666.0, "Time_End": 1669.0, "Text": " right into the NV RAM."}, {"Time_Start": 1669.0, "Time_End": 1672.0, "Text": " The fun part is what happens if this happens?"}, {"Time_Start": 1672.0, "Time_End": 1678.0, "Text": " The device notices, oh fuck. I fucked up my memory. It's all toast."}, {"Time_Start": 1678.0, "Time_End": 1680.0, "Text": " So, safest thing to do, reboot."}, {"Time_Start": 1680.0, "Time_End": 1682.0, "Text": " We got all used of that."}, {"Time_Start": 1682.0, "Time_End": 1688.0, "Text": " But it comes up and says, oops, config checks them wrong."}, {"Time_Start": 1688.0, "Time_End": 1690.0, "Text": " So what I'm going to do?"}, {"Time_Start": 1690.0, "Time_End": 1694.0, "Text": " Either I sit here and be a useless piece of shit,"}, {"Time_Start": 1694.0, "Time_End": 1698.0, "Text": " or I go out on a network and ask for a config."}, {"Time_Start": 1698.0, "Time_End": 1699.0, "Text": " Well."}, {"Time_Start": 1699.0, "Time_End": 1700.0, "Text": " Well."}, {"Time_Start": 1700.0, "Time_End": 1703.0, "Text": " So..."}, {"Time_Start": 1703.0, "Time_End": 1704.0, "Text": " So..."}, {"Time_Start": 1708.0, "Time_End": 1720.0, "Text": " Obviously, we sent stuff over here, device shits all over itself, asks for a config, and of course we're the nice guys, you know."}, {"Time_Start": 1720.0, "Time_End": 1722.0, "Text": " It's so hilarious."}, {"Time_Start": 1722.0, "Time_End": 1725.0, "Text": " You don't need any special knowledge about it."}, {"Time_Start": 1725.0, "Time_End": 1726.0, "Text": " Bad part?"}, {"Time_Start": 1726.0, "Time_End": 1728.0, "Text": " Okay, here comes the review."}, {"Time_Start": 1728.0, "Time_End": 1733.0, "Text": " Disadvantages, it only works on a 2500, so that sucks."}, {"Time_Start": 1733.0, "Time_End": 1737.0, "Text": " And a hacker has to be on the same subnet or own the TFTP server."}, {"Time_Start": 1737.0, "Time_End": 1743.0, "Text": " over. That also sucks. But the good part is you don't need to know shit. I mean, really,"}, {"Time_Start": 1743.0, "Time_End": 1749.0, "Text": " you just send it over and provide the new config. But let's see if it can get some more devices."}, {"Time_Start": 1749.0, "Time_End": 1756.0, "Text": " In order to do that, we have to get around this annoying previous pointer check."}, {"Time_Start": 1756.0, "Time_End": 1762.0, "Text": " It took us really a while to figure that up, but that's basically for the guys who know C."}, {"Time_Start": 1762.0, "Time_End": 1766.0, "Text": " That's basically how it looks like. Means the block we are sitting in."}, {"Time_Start": 1766.0, "Time_End": 1773.0, "Text": " we are sitting in the host block actually gets checked and iOS checks, is that still okay?"}, {"Time_Start": 1773.0, "Time_End": 1780.0, "Text": " And while checking the next pointer of the host block, and it sees if the place where it points to,"}, {"Time_Start": 1780.0, "Time_End": 1784.0, "Text": " points back to the place where it got the address from in the first place."}, {"Time_Start": 1784.0, "Time_End": 1790.0, "Text": " Like, I'm pointing to FTR and someone is going to check if FTR is pointing back to me."}, {"Time_Start": 1790.0, "Time_End": 1794.0, "Text": " So, yeah, how we get around that?"}, {"Time_Start": 1794.0, "Time_End": 1795.0, "Text": " Still have no stable solution for that."}, {"Time_Start": 1795.0, "Time_End": 1798.0, "Text": " solution for that, but a pretty okay one."}, {"Time_Start": 1798.0, "Time_End": 1802.0, "Text": " We just overflowed once, uncontrolled, just a bunch of A's in there."}, {"Time_Start": 1802.0, "Time_End": 1806.0, "Text": " It reboots, and this puts the device in a fairly predictable state."}, {"Time_Start": 1806.0, "Time_End": 1812.0, "Text": " Because after the reboot, you can pretty much tell how the memory looks like."}, {"Time_Start": 1812.0, "Time_End": 1817.0, "Text": " So that's basically how we get around the previous pointer issue."}, {"Time_Start": 1817.0, "Time_End": 1819.0, "Text": " Now we have that size field."}, {"Time_Start": 1819.0, "Time_End": 1824.0, "Text": " IOS doesn't like it if you put in the size field that you override, you put in something like"}, {"Time_Start": 1824.0, "Time_End": 1827.44, "Text": " like huge numbers, all F, it will notice it."}, {"Time_Start": 1827.44, "Time_End": 1829.44, "Text": " It will say, no, no, no, no, no, that's push it."}, {"Time_Start": 1829.44, "Time_End": 1830.9, "Text": " I don't have so much memory."}, {"Time_Start": 1830.9, "Time_End": 1834.4, "Text": " I could use it, but I don't have it."}, {"Time_Start": 1834.4, "Time_End": 1838.7, "Text": " And you can't do like normal values because we're doing a string overflow here,"}, {"Time_Start": 1838.7, "Time_End": 1842.76, "Text": " so it sucks, we can't just put no bytes in here."}, {"Time_Start": 1842.76, "Time_End": 1848.94, "Text": " Funny, if we put 7 and all F in here, it works."}, {"Time_Start": 1849.94, "Time_End": 1851.84, "Text": " It's all happy about it."}, {"Time_Start": 1851.84, "Time_End": 1853.84, "Text": " I assume some..."}, {"Time_Start": 1854.0, "Time_End": 1861.0, "Text": " The developer decided to use 32-bit fields on iOS, which is mostly 164-bit platform,"}, {"Time_Start": 1861.0, "Time_End": 1862.0, "Text": " anyway."}, {"Time_Start": 1862.0, "Time_End": 1869.0, "Text": " And do the calculation that way, and just by right shifting, left-shifting, adding something,"}, {"Time_Start": 1869.0, "Time_End": 1871.0, "Text": " it all makes sense again."}, {"Time_Start": 1871.0, "Time_End": 1874.0, "Text": " So this is the size field we're using."}, {"Time_Start": 1874.0, "Time_End": 1878.0, "Text": " But since the size field, okay, let's go back,"}, {"Time_Start": 1878.0, "Time_End": 1883.0, "Text": " that one has a seven over here, which means the most significant bit is not set."}, {"Time_Start": 1883.0, "Time_End": 1884.0, "Text": " So what we do,"}, {"Time_Start": 1884.0, "Time_End": 1891.0, "Text": " we take a look at free memory blocks because if the MSP is not said, iOS thinks it's free,"}, {"Time_Start": 1891.0, "Time_End": 1894.0, "Text": " so we need to look at free memory blocks."}, {"Time_Start": 1894.0, "Time_End": 1899.0, "Text": " Again, we take our crash dumps and our hex dumps and all that and figure the following out."}, {"Time_Start": 1899.0, "Time_End": 1904.0, "Text": " After all the overhead we already have seen, we got similar overhead."}, {"Time_Start": 1904.0, "Time_End": 1911.0, "Text": " Another magic value over here, padding, more padding."}, {"Time_Start": 1911.0, "Time_End": 1913.0, "Text": " This is like 8 bytes, just so you know."}, {"Time_Start": 1913.0, "Time_End": 1915.0, "Text": " just so you know where your memory goes."}, {"Time_Start": 1915.0, "Time_End": 1919.0, "Text": " Some address in code space, never used."}, {"Time_Start": 1919.0, "Time_End": 1924.0, "Text": " A pointer and yet another pointer, and since they were only in free blocks,"}, {"Time_Start": 1924.0, "Time_End": 1927.0, "Text": " we decided to call them free next and free previous."}, {"Time_Start": 1927.0, "Time_End": 1929.0, "Text": " They basically have the same purpose."}, {"Time_Start": 1929.0, "Time_End": 1932.0, "Text": " They run yet another linked list."}, {"Time_Start": 1932.0, "Time_End": 1936.0, "Text": " I honestly never want to get the full picture on iOS memory management."}, {"Time_Start": 1936.0, "Time_End": 1942.0, "Text": " And this information is probably also used when the block is freed."}, {"Time_Start": 1942.0, "Time_End": 1946.0, "Text": " block is freed to get two three blocks together to one big block."}, {"Time_Start": 1946.0, "Time_End": 1949.0, "Text": " It's all textbook, free export."}, {"Time_Start": 1949.0, "Time_End": 1955.0, "Text": " And yeah, we asked for it, we got it, we got it, these two pointers are not checked."}, {"Time_Start": 1955.0, "Time_End": 1961.0, "Text": " So, we can write any pointer to any address in the address space of iOS."}, {"Time_Start": 1961.0, "Time_End": 1962.0, "Text": " Thanks."}, {"Time_Start": 1962.0, "Time_End": 1964.0, "Text": " That's basically where we do."}, {"Time_Start": 1964.0, "Time_End": 1971.0, "Text": " There is a pointer exchange can take place here, and it's all complicated, like where the"}, {"Time_Start": 1971.0, "Time_End": 1973.0, "Text": " where the previous pointer points to,"}, {"Time_Start": 1973.0, "Time_End": 1977.0, "Text": " that gets the value that's in the next pointer."}, {"Time_Start": 1977.0, "Time_End": 1982.0, "Text": " So, and vice versa, plus 20 bytes for some offset."}, {"Time_Start": 1982.0, "Time_End": 1986.0, "Text": " Yeah, so we have something to write into memory."}, {"Time_Start": 1986.0, "Time_End": 1989.0, "Text": " But what do we do with that?"}, {"Time_Start": 1989.0, "Time_End": 1992.0, "Text": " I mean, we can write one pointer."}, {"Time_Start": 1992.0, "Time_End": 1994.0, "Text": " That's pretty neat."}, {"Time_Start": 1994.0, "Time_End": 1996.0, "Text": " But where do we write it to?"}, {"Time_Start": 1996.0, "Time_End": 2000.0, "Text": " There is, if you do like a showman prog alloc,"}, {"Time_Start": 2000.0, "Time_End": 2004.0, "Text": " there is a place that's called Process Away."}, {"Time_Start": 2004.0, "Time_End": 2009.0, "Text": " It obviously is a ray of addresses."}, {"Time_Start": 2009.0, "Time_End": 2015.0, "Text": " And funny, it's the same number of elements like the number of processes you're running."}, {"Time_Start": 2015.0, "Time_End": 2019.0, "Text": " So it might be that it has an entry for every process."}, {"Time_Start": 2019.0, "Time_End": 2020.0, "Text": " Yeah."}, {"Time_Start": 2020.0, "Time_End": 2022.0, "Text": " It actually is that."}, {"Time_Start": 2022.0, "Time_End": 2025.0, "Text": " It points to a huge process record."}, {"Time_Start": 2025.0, "Time_End": 2029.0, "Text": " They have, I don't know, it's several hundred bytes of information for process to"}, {"Time_Start": 2029.0, "Time_End": 2034.0, "Text": " process to run. But the first thing in this process record"}, {"Time_Start": 2034.0, "Time_End": 2038.0, "Text": " actually points to yet another memory block, which is the stack."}, {"Time_Start": 2038.0, "Time_End": 2042.0, "Text": " And the second one points inside that memory block."}, {"Time_Start": 2042.0, "Time_End": 2044.0, "Text": " So obviously, it's a stack pointer."}, {"Time_Start": 2044.0, "Time_End": 2046.0, "Text": " Cool."}, {"Time_Start": 2046.0, "Time_End": 2049.0, "Text": " So let's take it over."}, {"Time_Start": 2049.0, "Time_End": 2056.0, "Text": " We have, like, on the 1,600 series, we tested out,"}, {"Time_Start": 2056.0, "Time_End": 2059.0, "Text": " and it's quite easy because the free operation"}, {"Time_Start": 2059.0, "Time_End": 2062.44, "Text": " actually can write into anyone's stack."}, {"Time_Start": 2062.44, "Time_End": 2064.24, "Text": " Every process you want."}, {"Time_Start": 2064.24, "Time_End": 2066.26, "Text": " So you just pick one."}, {"Time_Start": 2066.26, "Time_End": 2069.72, "Text": " Mostly you pick a process that's not running too often,"}, {"Time_Start": 2069.72, "Time_End": 2072.44, "Text": " but it's kicked off like once a minute."}, {"Time_Start": 2072.44, "Time_End": 2075.12, "Text": " A good target, I figured is load meter,"}, {"Time_Start": 2075.12, "Time_End": 2077.12, "Text": " because it doesn't do anything useful anyway."}, {"Time_Start": 2077.12, "Time_End": 2083.36, "Text": " So, yeah, and if you look at the stack here,"}, {"Time_Start": 2083.36, "Time_End": 2085.78, "Text": " that's like the safe stack pointer,"}, {"Time_Start": 2085.78, "Time_End": 2087.32, "Text": " and that's the safe return address."}, {"Time_Start": 2089.0, "Time_End": 2096.0, "Text": " So everyone who ever wrote and exploit knows that we now have like 5,000 ways of exploiting that thing."}, {"Time_Start": 2096.0, "Time_End": 2100.0, "Text": " By either overriding the return address straight ahead over here,"}, {"Time_Start": 2100.0, "Time_End": 2107.0, "Text": " overriding the stick pointer, and providing our own stack with the new return address,"}, {"Time_Start": 2107.0, "Time_End": 2112.0, "Text": " actually changing the world stack pointer in that process array entry,"}, {"Time_Start": 2112.0, "Time_End": 2117.0, "Text": " or just replace the old process array entry and provide our own."}, {"Time_Start": 2117.0, "Time_End": 2124.0, "Text": " So, yeah, we got, we used the first one because it's like the most obvious."}, {"Time_Start": 2124.0, "Time_End": 2131.0, "Text": " So, next question, buffer. We need some buffer to store some code."}, {"Time_Start": 2131.0, "Time_End": 2140.0, "Text": " And here's the bad news. If you overflow it and it thinks this is free and this one should be freed,"}, {"Time_Start": 2140.0, "Time_End": 2146.0, "Text": " it will actually erase the memory and overwrite it by OD. Oh dear."}, {"Time_Start": 2146.0, "Time_End": 2155.0, "Text": " year. But actually, since the block we over flew is a free memory block, or yeah,"}, {"Time_Start": 2155.0, "Time_End": 2163.0, "Text": " we made it a free memory block, we don't care what it was before, we can have our export code in there."}, {"Time_Start": 2163.0, "Time_End": 2175.98, "Text": " So let's write some share code. We have an example based on a Cisco 600. It has that funny Motorola processor, which really got me because I"}, {"Time_Start": 2176.0, "Time_End": 2178.0, "Text": " we coded Motorola before."}, {"Time_Start": 2178.0, "Time_End": 2182.0, "Text": " The memory protection, according to Motorola's manual,"}, {"Time_Start": 2182.0, "Time_End": 2185.0, "Text": " is set in some base register."}, {"Time_Start": 2185.0, "Time_End": 2188.0, "Text": " We found that base register after some series"}, {"Time_Start": 2188.0, "Time_End": 2192.0, "Text": " waiting through hex thumbs over here in that address."}, {"Time_Start": 2192.0, "Time_End": 2195.0, "Text": " Luckily, it has no zeros in it, cool."}, {"Time_Start": 2195.0, "Time_End": 2199.0, "Text": " You can, like, disable that by changing the,"}, {"Time_Start": 2199.0, "Time_End": 2201.0, "Text": " actually the second bit,"}, {"Time_Start": 2201.0, "Time_End": 2205.0, "Text": " changing it from one, like protected memory to zero, as in unprotected memory."}, {"Time_Start": 2205.0, "Time_End": 2207.0, "Text": " unprotected memory."}, {"Time_Start": 2207.0, "Time_End": 2212.0, "Text": " And yeah, then write some invalid value into the NV RAM and get the device."}, {"Time_Start": 2212.0, "Time_End": 2214.0, "Text": " Yeah, so that's what we do."}, {"Time_Start": 2214.0, "Time_End": 2217.0, "Text": " See, that code is like not huge."}, {"Time_Start": 2217.0, "Time_End": 2219.0, "Text": " I mean, that's the whole code."}, {"Time_Start": 2219.0, "Time_End": 2221.0, "Text": " That's all you need."}, {"Time_Start": 2221.0, "Time_End": 2222.0, "Text": " It's totally simple."}, {"Time_Start": 2222.0, "Time_End": 2226.0, "Text": " It takes the address of that protection base register."}, {"Time_Start": 2226.0, "Time_End": 2233.0, "Text": " There's a right shift on it because the next bit is actually zero, so it's nice to us."}, {"Time_Start": 2233.0, "Time_End": 2235.0, "Text": " We tricked the address of the address of that"}, {"Time_Start": 2235.0, "Time_End": 2243.0, "Text": " the NV-RAM in here and yeah, then write some coffee babe stuff in there."}, {"Time_Start": 2243.0, "Time_End": 2247.0, "Text": " So we got that NV-RM invalidated quite easily."}, {"Time_Start": 2247.0, "Time_End": 2252.0, "Text": " What we actually did here to show how to get around pointer exchange,"}, {"Time_Start": 2252.0, "Time_End": 2255.0, "Text": " things that would write in your shell code."}, {"Time_Start": 2255.0, "Time_End": 2259.0, "Text": " This instruction over here, you see this 01-1-1-1-1."}, {"Time_Start": 2259.0, "Time_End": 2265.0, "Text": " This is actually where the other pointer, it's an exchange, so yeah, give and take, as in you buy beer,"}, {"Time_Start": 2265.0, "Time_End": 2269.0, "Text": " I buy beer. So that's where the other pointer is stored."}, {"Time_Start": 2269.0, "Time_End": 2274.0, "Text": " You just put some innocent op code in here, get the data part overwritten, all set."}, {"Time_Start": 2274.0, "Time_End": 2281.0, "Text": " Yeah, summary, if you overflowed once to get the predictable previous pointer,"}, {"Time_Start": 2281.0, "Time_End": 2287.0, "Text": " set all the stuff here, fired up, and you have the same reaction, like it asks for a config."}, {"Time_Start": 2287.0, "Time_End": 2293.0, "Text": " And that's how it looks like, I took out the legal ally here."}, {"Time_Start": 2293.0, "Time_End": 2298.0, "Text": " Yeah, it has some error later on, I don't care."}, {"Time_Start": 2298.0, "Time_End": 2303.0, "Text": " Comes up, asks for the config, asks for another config,"}, {"Time_Start": 2303.0, "Time_End": 2307.0, "Text": " yeah, that's Cisco, and then you got the device."}, {"Time_Start": 2307.0, "Time_End": 2309.0, "Text": " But you know, it still sucks."}, {"Time_Start": 2309.0, "Time_End": 2311.0, "Text": " You still have to be on the same segment."}, {"Time_Start": 2311.0, "Time_End": 2313.0, "Text": " So let's go on."}, {"Time_Start": 2313.0, "Time_End": 2316.0, "Text": " We need some more info here,"}, {"Time_Start": 2316.0, "Time_End": 2321.0, "Text": " which is iOS seems to use some kind of cooperative multitasking,"}, {"Time_Start": 2321.0, "Time_End": 2322.0, "Text": " but honestly it more looks like a..."}, {"Time_Start": 2322.0, "Time_End": 2329.0, "Text": " more looks like a huge program that has tons of interrupt handlers to fire off important stuff."}, {"Time_Start": 2329.0, "Time_End": 2332.0, "Text": " So it's not really tasked."}, {"Time_Start": 2332.0, "Time_End": 2338.0, "Text": " I didn't find any task handler on it. There is no scheduling service or anything I'm aware of."}, {"Time_Start": 2338.0, "Time_End": 2344.0, "Text": " Maybe one of you guys worked with Cisco and can tell me something I don't know, but..."}, {"Time_Start": 2344.0, "Time_End": 2349.0, "Text": " It's all interrupt driven, so that really sucks."}, {"Time_Start": 2349.0, "Time_End": 2351.0, "Text": " The NV-RAM actually contains a bit more."}, {"Time_Start": 2351.0, "Time_End": 2354.0, "Text": " contains a bit more than just the config."}, {"Time_Start": 2354.0, "Time_End": 2355.0, "Text": " It has a checksome."}, {"Time_Start": 2355.0, "Time_End": 2358.0, "Text": " It has a field for the size of the config."}, {"Time_Start": 2358.0, "Time_End": 2362.0, "Text": " It actually contains the stack traces and all the stuff that"}, {"Time_Start": 2362.0, "Time_End": 2366.0, "Text": " you would normally use to do forensics on the router."}, {"Time_Start": 2366.0, "Time_End": 2369.0, "Text": " So, and what's that?"}, {"Time_Start": 2369.0, "Time_End": 2373.0, "Text": " Yeah, and the config is actually like a long C-string."}, {"Time_Start": 2373.0, "Time_End": 2376.0, "Text": " It's just a string with some line feeds in it."}, {"Time_Start": 2376.0, "Time_End": 2379.0, "Text": " You can do some funny shit with that."}, {"Time_Start": 2379.0, "Time_End": 2380.0, "Text": " Anyone who gets bored with your Cisco."}, {"Time_Start": 2380.0, "Time_End": 2384.0, "Text": " your Cisco and just play with the configs and long lines."}, {"Time_Start": 2384.0, "Time_End": 2387.0, "Text": " I don't have to tell you more."}, {"Time_Start": 2387.0, "Time_End": 2391.0, "Text": " And it's terminated by the end keyword and the normal 0byte."}, {"Time_Start": 2391.0, "Time_End": 2394.0, "Text": " So it's basically a long C-string."}, {"Time_Start": 2394.0, "Time_End": 2397.0, "Text": " So what we do is write a remote sharecode."}, {"Time_Start": 2397.0, "Time_End": 2402.0, "Text": " That one will have a minimum config in a backpack."}, {"Time_Start": 2402.0, "Time_End": 2406.0, "Text": " Disabled interrupts, so we don't get interrupted."}, {"Time_Start": 2406.0, "Time_End": 2409.0, "Text": " Unprotecting V-RM calculates the new Jackson."}, {"Time_Start": 2409.0, "Time_End": 2412.0, "Text": " the new Jackson, so iOS is all happy,"}, {"Time_Start": 2412.0, "Time_End": 2415.0, "Text": " writes a 2DNV RAM,"}, {"Time_Start": 2415.0, "Time_End": 2418.0, "Text": " and just to be nice, does a clean reset."}, {"Time_Start": 2418.0, "Time_End": 2422.0, "Text": " Well, you don't need any CIS call,"}, {"Time_Start": 2422.0, "Time_End": 2424.0, "Text": " you don't need any knowledge about iOS."}, {"Time_Start": 2424.0, "Time_End": 2426.0, "Text": " And the new thing is a way around always,"}, {"Time_Start": 2426.0, "Time_End": 2428.0, "Text": " because you don't use iOS."}, {"Time_Start": 2428.0, "Time_End": 2430.0, "Text": " You just kick it off."}, {"Time_Start": 2430.0, "Time_End": 2435.0, "Text": " We still have that problem with a 0 byte,"}, {"Time_Start": 2435.0, "Time_End": 2438.0, "Text": " still string, overflow, no 0 bytes, everyone knows that."}, {"Time_Start": 2438.0, "Time_End": 2439.0, "Text": " knows that."}, {"Time_Start": 2439.0, "Time_End": 2442.0, "Text": " Yeah, but that's like solved ages ago."}, {"Time_Start": 2442.0, "Time_End": 2444.0, "Text": " And we did it the same way."}, {"Time_Start": 2444.0, "Time_End": 2449.0, "Text": " You have a self-modifying code that first sits there has no 0 bytes."}, {"Time_Start": 2449.0, "Time_End": 2452.0, "Text": " Bootstrap code decodes the rest of it."}, {"Time_Start": 2452.0, "Time_End": 2459.0, "Text": " It uses a different pattern like D5 instead of 55 because 55 would lead to Colon's in the"}, {"Time_Start": 2459.0, "Time_End": 2461.0, "Text": " exord config."}, {"Time_Start": 2461.0, "Time_End": 2466.5, "Text": " And Colones are real bad in that particular overflow because they're used as delimiter between like"}, {"Time_Start": 2466.5, "Time_End": 2467.0, "Text": " file name and file name."}, {"Time_Start": 2467.0, "Time_End": 2470.0, "Text": " name and fine name. So that's cruised to overflow."}, {"Time_Start": 2470.0, "Time_End": 2473.0, "Text": " It took me about three days to find that out."}, {"Time_Start": 2473.0, "Time_End": 2479.0, "Text": " Yeah, gets decoded, gets executed, and plainly works."}, {"Time_Start": 2479.0, "Time_End": 2482.0, "Text": " Then we had another problem, which was really nice."}, {"Time_Start": 2482.0, "Time_End": 2484.0, "Text": " The code worked, you're all happy."}, {"Time_Start": 2484.0, "Time_End": 2486.0, "Text": " It comes up. It says, no, config fucked up."}, {"Time_Start": 2486.0, "Time_End": 2490.0, "Text": " You take the config, you find out it wrote like every six byte."}, {"Time_Start": 2490.0, "Time_End": 2493.0, "Text": " And it's a plain loop."}, {"Time_Start": 2493.0, "Time_End": 2495.0, "Text": " I mean, it really writes every byte."}, {"Time_Start": 2495.0, "Time_End": 2496.0, "Text": " And you tried again, and it writes every byte."}, {"Time_Start": 2496.0, "Time_End": 2497.0, "Text": " And you tried again, and it writes."}, {"Time_Start": 2497.0, "Time_End": 2499.0, "Text": " every other sticks by."}, {"Time_Start": 2499.0, "Time_End": 2501.0, "Text": " Hey?"}, {"Time_Start": 2501.0, "Time_End": 2505.0, "Text": " That's because the NV-RAM chips are so fucking lame and slow."}, {"Time_Start": 2505.0, "Time_End": 2508.0, "Text": " Like by design."}, {"Time_Start": 2508.0, "Time_End": 2512.0, "Text": " And according to the manual, you're supposed to keep the address lines straight,"}, {"Time_Start": 2512.0, "Time_End": 2515.0, "Text": " so don't do any instructions on like A1 to A9."}, {"Time_Start": 2515.0, "Time_End": 2520.0, "Text": " And pull the status register of that NV-RM thing."}, {"Time_Start": 2520.0, "Time_End": 2522.0, "Text": " I don't know where that is."}, {"Time_Start": 2522.0, "Time_End": 2526.0, "Text": " Honestly, in that huge memory area, I don't know what that is."}, {"Time_Start": 2526.0, "Time_End": 2527.0, "Text": " So we just."}, {"Time_Start": 2527.0, "Time_End": 2530.0, "Text": " took some loops. After every ride, we loop a bit,"}, {"Time_Start": 2530.0, "Time_End": 2533.0, "Text": " make the Cisco all happy and sweaty."}, {"Time_Start": 2533.0, "Time_End": 2535.0, "Text": " And yeah."}, {"Time_Start": 2535.0, "Time_End": 2537.0, "Text": " So we got around that problem."}, {"Time_Start": 2537.0, "Time_End": 2540.0, "Text": " And that's what you can download."}, {"Time_Start": 2540.0, "Time_End": 2543.0, "Text": " We call it Ultima Ratio."}, {"Time_Start": 2543.0, "Time_End": 2545.0, "Text": " Go figure what that means."}, {"Time_Start": 2545.0, "Time_End": 2547.0, "Text": " The code isn't actually that big."}, {"Time_Start": 2547.0, "Time_End": 2551.0, "Text": " It has like the overflow, the fake block,"}, {"Time_Start": 2551.0, "Time_End": 2555.0, "Text": " this bootstrap code to decode all the other stuff."}, {"Time_Start": 2555.0, "Time_End": 2557.0, "Text": " Exort code to export code to"}, {"Time_Start": 2557.0, "Time_End": 2560.0, "Text": " actually write a config, has the config in the backpack."}, {"Time_Start": 2560.0, "Time_End": 2563.0, "Text": " So what you do is you have your command line utility"}, {"Time_Start": 2563.0, "Time_End": 2566.0, "Text": " that takes the IP address, the previous pointer,"}, {"Time_Start": 2566.0, "Time_End": 2569.0, "Text": " which we still need, unfortunately,"}, {"Time_Start": 2569.0, "Time_End": 2573.0, "Text": " and the config as like a file on your file system,"}, {"Time_Start": 2573.0, "Time_End": 2576.0, "Text": " fired up, got root on a Cisco."}, {"Time_Start": 2576.0, "Time_End": 2579.0, "Text": " Yep, that's how it looks like."}, {"Time_Start": 2579.0, "Time_End": 2581.0, "Text": " You see no crash info, no blah, blah, blah,"}, {"Time_Start": 2581.0, "Time_End": 2583.0, "Text": " I'm not feeling happy."}, {"Time_Start": 2583.0, "Time_End": 2586.0, "Text": " Just boot straight, legal la la la."}, {"Time_Start": 2586.0, "Time_End": 2589.0, "Text": " Lala figures out of the sudden,"}, {"Time_Start": 2589.0, "Time_End": 2591.0, "Text": " oops, there's a new interface."}, {"Time_Start": 2591.0, "Time_End": 2593.0, "Text": " Yeah, because the config we uploaded didn't say anything"}, {"Time_Start": 2593.0, "Time_End": 2595.0, "Text": " about Bree Zero, so it just figured,"}, {"Time_Start": 2595.0, "Time_End": 2599.0, "Text": " oh, I'm a 1600, I'm all surprised about having a Bree interface."}, {"Time_Start": 2599.0, "Time_End": 2602.0, "Text": " And, yeah, then you just turn it to your router,"}, {"Time_Start": 2602.0, "Time_End": 2607.0, "Text": " and well, it's your config, and it's your password."}, {"Time_Start": 2607.0, "Time_End": 2610.0, "Text": " That's basically how it looks like in detail."}, {"Time_Start": 2610.0, "Time_End": 2613.0, "Text": " I'm not expecting that everyone is going to get that right way,"}, {"Time_Start": 2613.0, "Time_End": 2615.0, "Text": " but, I mean, the presentation is on a CD."}, {"Time_Start": 2615.0, "Time_End": 2622.0, "Text": " CD. It's again the red block, magic, PID, stuff, stuff. Next pointer,"}, {"Time_Start": 2622.0, "Time_End": 2628.0, "Text": " previous point, that don't really matter. That size field, that funny size field,"}, {"Time_Start": 2628.0, "Time_End": 2638.0, "Text": " this ref field over here, padding, free magic, more padding, actually total crap over here."}, {"Time_Start": 2638.0, "Time_End": 2644.98, "Text": " Yeah, more padding, next pointer, previous pointer, this one is pointing to"}, {"Time_Start": 2645.0, "Time_End": 2651.0, "Text": " the code, this one is pointing to the stick, and here we go. And that's how the XR code is."}, {"Time_Start": 2651.0, "Time_End": 2659.0, "Text": " That's what we use. I mean, if some guys here really know Motorola coding, you might come up with something more decent than that."}, {"Time_Start": 2659.0, "Time_End": 2664.0, "Text": " But it's not too big, and you don't need any knowledge about iOS."}, {"Time_Start": 2664.0, "Time_End": 2667.0, "Text": " I'm still putting the big end faces on that one."}, {"Time_Start": 2667.0, "Time_End": 2673.0, "Text": " Yeah, work to do. I mean, this is not like Tiso SSH."}, {"Time_Start": 2673.0, "Time_End": 2684.0, "Text": " This doesn't really, really work well. If you don't have access to the syslog host or in the lab you do it with a console on and stuff,"}, {"Time_Start": 2684.0, "Time_End": 2690.0, "Text": " you don't like download it, fire it off and turn off Yahoo. That's not going to work."}, {"Time_Start": 2690.0, "Time_End": 2700.0, "Text": " But I hope we showed that it works and I hope that these heat exploits actually will basically wake up call, but anyway."}, {"Time_Start": 2700.0, "Time_End": 2702.0, "Text": " So what do we have to do?"}, {"Time_Start": 2702.0, "Time_End": 2704.0, "Text": " We have to find differences."}, {"Time_Start": 2704.0, "Time_End": 2712.0, "Text": " If someone has a buck for 12.2 iOS, just come over, tell me I'll buy you a bunch of BS4."}, {"Time_Start": 2712.0, "Time_End": 2716.0, "Text": " We have the problem of smaller buffers."}, {"Time_Start": 2716.0, "Time_End": 2722.0, "Text": " I mean, that buffer is just huge, 1,400 bytes, like for UDP packet."}, {"Time_Start": 2722.0, "Time_End": 2725.0, "Text": " We have to figure out how that works."}, {"Time_Start": 2725.0, "Time_End": 2729.0, "Text": " Basically, my idea is to send in the shell code via CDP."}, {"Time_Start": 2729.0, "Time_End": 2731.0, "Text": " We have that previous pointer stake."}, {"Time_Start": 2731.0, "Time_End": 2736.0, "Text": " pointers and stack addresses, that's still a problem."}, {"Time_Start": 2736.0, "Time_End": 2742.0, "Text": " But we're with us, we will come back to you and have a solution for that one."}, {"Time_Start": 2742.0, "Time_End": 2747.0, "Text": " And in VRM config, we need some different chaircode, but that's like the easy part on it."}, {"Time_Start": 2747.0, "Time_End": 2754.0, "Text": " We have to write to flash instead of in VRM to like take over GSRs."}, {"Time_Start": 2754.0, "Time_End": 2760.0, "Text": " We need some anti-phoransics shell code, but actually after I had some people telling you"}, {"Time_Start": 2760.0, "Time_End": 2763.0, "Text": " people telling me how they do forensics on a Cisco."}, {"Time_Start": 2763.0, "Time_End": 2766.0, "Text": " I decided that's not going to be needed."}, {"Time_Start": 2766.0, "Time_End": 2770.0, "Text": " Because nobody actually looks at the NVWM when doing forensics on Cisco."}, {"Time_Start": 2770.0, "Time_End": 2775.0, "Text": " But it would be need to have a share code that really does the same as ours,"}, {"Time_Start": 2775.0, "Time_End": 2780.0, "Text": " but additionally it deletes all traces from your exploitation and stuff like that."}, {"Time_Start": 2780.0, "Time_End": 2784.0, "Text": " And, you know, so the forensics guys are all happy about it."}, {"Time_Start": 2784.0, "Time_End": 2790.0, "Text": " And of course, real-time configuration modification code is like the next thing I'm going to"}, {"Time_Start": 2790.0, "Time_End": 2797.0, "Text": " to do is a shell code that goes over, removes all access list bindings, sets the passwords"}, {"Time_Start": 2797.0, "Time_End": 2804.0, "Text": " to something you might know, and reboots the device so you don't have to figure out which interfaces it has"}, {"Time_Start": 2804.0, "Time_End": 2806.0, "Text": " and stuff like that."}, {"Time_Start": 2806.0, "Time_End": 2808.0, "Text": " Come on."}, {"Time_Start": 2808.0, "Time_End": 2809.0, "Text": " Yeah."}, {"Time_Start": 2809.0, "Time_End": 2810.0, "Text": " Summary."}, {"Time_Start": 2810.0, "Time_End": 2819.0, "Text": " For the 1000, it's local export, like just invalidating NVRAM or remote export."}, {"Time_Start": 2819.0, "Time_End": 2826.0, "Text": " not exploit. It's even simpler here. You can actually write your return address right into"}, {"Time_Start": 2826.0, "Time_End": 2831.5, "Text": " the exception handler for memory problems. That's pretty neat because as soon as it figures out"}, {"Time_Start": 2831.5, "Time_End": 2837.0, "Text": " that it screwed up the memory, it would screw up even more. The 1600,"}, {"Time_Start": 2837.0, "Time_End": 2843.0, "Text": " basically same issue. Fun part on the 2600, if you want to test that TFTP stuff,"}, {"Time_Start": 2843.0, "Time_End": 2848.98, "Text": " you have to be a bit more tricky because you have to fire up TFTP first with a web"}, {"Time_Start": 2849.0, "Time_End": 2855.54, "Text": " request so the TFTP service gets loaded. I was looking for the process entry"}, {"Time_Start": 2855.54, "Time_End": 2860.94, "Text": " of the TFTP service for like ages before I figured out you have to fire it up once so"}, {"Time_Start": 2860.94, "Time_End": 2867.26, "Text": " it actually gets activated. But basically it's the same. The 2,600 has a power PC processor,"}, {"Time_Start": 2867.26, "Time_End": 2876.56, "Text": " so you're not going to use this shell code, but the concept is still the same. And 2,500, so far"}, {"Time_Start": 2876.56, "Time_End": 2878.98, "Text": " we can't do remote exploits on it."}, {"Time_Start": 2879.0, "Time_End": 2885.76, "Text": " that's going to change. And yeah, it's like the loser Cisco. That's, yeah, the"}, {"Time_Start": 2885.76, "Time_End": 2892.44, "Text": " script kitty Cisco die thing. So what? For everyone who didn't get it yet, this is how"}, {"Time_Start": 2892.44, "Time_End": 2901.76, "Text": " you do exploits on 85% of bugs in iOS. So I hope someone is going to get a phone and"}, {"Time_Start": 2901.76, "Time_End": 2908.3, "Text": " call Cisco and tell them to fix the shit. You can do it like protocol based. You can do it like"}, {"Time_Start": 2908.3, "Time_End": 2916.04, "Text": " do a debug based. You can actually do all kinds of stuff. And I mean, who actually expects"}, {"Time_Start": 2916.04, "Time_End": 2922.5800000000004, "Text": " you to take over a Cisco? So it's still unprotected. I mean, really. And as I said, then VRAM"}, {"Time_Start": 2922.5800000000004, "Time_End": 2927.6600000000003, "Text": " still contains stuff. For the local exploitation, actually, it still contains the former config."}, {"Time_Start": 2928.1600000000003, "Time_End": 2933.52, "Text": " So after you got it, you just turn it to it, get the former config down, which is a neat way to get"}, {"Time_Start": 2933.52, "Time_End": 2938.2200000000003, "Text": " around this no-service password recovery. You just exploit."}, {"Time_Start": 2938.3, "Time_End": 2945.3, "Text": " it. You get the config down, you get the passwords, you get like tunnel keys, IP addresses,"}, {"Time_Start": 2945.6000000000004, "Time_End": 2952.2000000000003, "Text": " net settings, all kinds of stuff. How to protect. I guess some of you have that question"}, {"Time_Start": 2952.2000000000003, "Time_End": 2959.54, "Text": " right now. Basically, in general, do not rely on one type of device. If all your protection"}, {"Time_Start": 2959.54, "Time_End": 2967.86, "Text": " and frontline protection and firewall and IDS systems say Cisco on it, you're screwed. If it all says"}, {"Time_Start": 2967.86, "Time_End": 2973.04, "Text": " checkpoint on it, here's crew two. So mix the two, or better get some different"}, {"Time_Start": 2973.04, "Time_End": 2979.8, "Text": " technology in there. Consider all your networked equipment, vulnerable and exploitable to the"}, {"Time_Start": 2979.8, "Time_End": 2984.96, "Text": " full of stack's tent. Someone is going to be sick enough, that's probably us, to write"}, {"Time_Start": 2984.96, "Time_End": 2992.02, "Text": " a shell code for it. Believe me. No, it is small, it is simple, it doesn't even have"}, {"Time_Start": 2992.02, "Time_End": 2996.8, "Text": " an LED on it or something. That doesn't mean that nobody's going to exploit it."}, {"Time_Start": 2997.86, "Time_End": 3002.06, "Text": " They will. Believe me. If not, I make them do it."}, {"Time_Start": 3004.36, "Time_End": 3009.6600000000003, "Text": " For the HPs, basically, use the features it has, even if they suck."}, {"Time_Start": 3010.76, "Time_End": 3014.26, "Text": " Assign an admin password, change SNMP read and write community."}, {"Time_Start": 3015.32, "Time_End": 3018.76, "Text": " Do the PGGR protection, even if, yeah, it gives you some time."}, {"Time_Start": 3020.54, "Time_End": 3027.7000000000003, "Text": " Make sure, I mean, if you have a print server, the printer should only be accessed from the print server."}, {"Time_Start": 3027.86, "Time_End": 3032.1, "Text": " Really, because nobody is going to print directly to a printer."}, {"Time_Start": 3032.1, "Time_End": 3038.1, "Text": " If you print to the print server, like you have that loser Windows network thing."}, {"Time_Start": 3038.1, "Time_End": 3043.1800000000003, "Text": " The only server that has to talk to the printer is the print server."}, {"Time_Start": 3043.1800000000003, "Time_End": 3044.7400000000002, "Text": " Get rid of this.loader."}, {"Time_Start": 3044.7400000000002, "Time_End": 3049.9, "Text": " Actually use one of our elite tools to get rid of it."}, {"Time_Start": 3049.9, "Time_End": 3057.6, "Text": " And consider putting your printer behind firewalls if it is real critical, or really if it is"}, {"Time_Start": 3057.6, "Time_End": 3060.7599999999998, "Text": " finance department or something, use common sense."}, {"Time_Start": 3060.88, "Time_End": 3066.2799999999997, "Text": " I mean, the PCs have LPD ports for some reason, just connected to the PC."}, {"Time_Start": 3067.5, "Time_End": 3074.2, "Text": " Actually, one thing I wanted to mention for this one, be sure that your firewall does not allow"}, {"Time_Start": 3074.2, "Time_End": 3081.14, "Text": " outgoing connections from your printer to the internet, because in the CS config file here, you can"}, {"Time_Start": 3081.14, "Time_End": 3087.44, "Text": " actually put the location of the code, not in like file system, like Ocolon, backslash, mycode."}, {"Time_Start": 3087.6, "Time_End": 3093.92, "Text": " class, but you can say like HTTP, column, double, slash, my dot evil,"}, {"Time_Start": 3093.92, "Time_End": 3098.2, "Text": " server, slash, my superevil dot class."}, {"Time_Start": 3098.2, "Time_End": 3107.22, "Text": " Yeah, for the Cisco's, basically router hardening, textbook stuff, other than that,"}, {"Time_Start": 3107.22, "Time_End": 3112.5, "Text": " yeah, try to convince people to have no overflows in iOS, then it's all no issue."}, {"Time_Start": 3112.5, "Time_End": 3115.42, "Text": " Keep your iOS up to date."}, {"Time_Start": 3115.42, "Time_End": 3117.58, "Text": " I know it sucks, but they will."}, {"Time_Start": 3117.6, "Time_End": 3122.6, "Text": " really just fix the stuff on the 12 series, mostly just 12.2."}, {"Time_Start": 3122.6, "Time_End": 3130.6, "Text": " Yeah, find out which software version is fixed, which is kid a hard sometimes, but try to find it out."}, {"Time_Start": 3130.6, "Time_End": 3134.6, "Text": " Tell your IDS about it, that's basically the signature."}, {"Time_Start": 3134.6, "Time_End": 3140.6, "Text": " You will, if you really paid attention, you will see that this is like the red zone from the block where you're coming from."}, {"Time_Start": 3140.6, "Time_End": 3141.6, "Text": " This is the magic."}, {"Time_Start": 3141.6, "Time_End": 3146.6, "Text": " There is an undocumented, thank you, debug command that is debug sanity."}, {"Time_Start": 3146.6, "Time_End": 3153.6, "Text": " is debug sanity. It doesn't debug anything. It just makes iOS check more often, the memory."}, {"Time_Start": 3153.6, "Time_End": 3160.6, "Text": " It doesn't help. You can still exploit it, but it gets it faster. So if some loser tries it, you will get him."}, {"Time_Start": 3160.6, "Time_End": 3168.6, "Text": " The hardware, config register, zero, next time the thing boots it will sit in Realm 1."}, {"Time_Start": 3168.6, "Time_End": 3173.6, "Text": " If you do that and you forget about it and you say, reload, you have to get in your car."}, {"Time_Start": 3173.6, "Time_End": 3175.6, "Text": " Yeah, and of course, logging."}, {"Time_Start": 3175.6, "Time_End": 3179.6, "Text": " Of course, logging should be not like all visible."}, {"Time_Start": 3179.6, "Time_End": 3191.6, "Text": " Or, yeah, your syslog host should actually be protected correctly so that people don't use your syslog host as an information based on how to get the pointer straight to exploit your siscos."}, {"Time_Start": 3191.6, "Time_End": 3194.6, "Text": " That's basically it."}, {"Time_Start": 3194.6, "Time_End": 3196.6, "Text": " Thanks a lot."}, {"Time_Start": 3196.6, "Time_End": 3198.6, "Text": " And I hope you enjoyed it."}, {"Time_Start": 3198.6, "Time_End": 3200.6, "Text": " And yeah, I hope you guys around."}, {"Time_Start": 3205.6, "Time_End": 3212.6, "Text": " Thank you."}]}