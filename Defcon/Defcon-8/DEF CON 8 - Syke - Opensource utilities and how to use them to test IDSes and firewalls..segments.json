[{"Time_Start": 0.0, "Time_End": 29.900000000000002, "Text": " So, my name is Matt, and my handle is spelled S-Y-K-E, and I'm a member of a New Hack City, which is a hacker collected in San Francisco, and J-Roo, which is right here, he's also going to attempt to speak."}, {"Time_Start": 30.0, "Time_End": 35.0, "Text": " hopefully with a video projector in place of some kind."}, {"Time_Start": 35.0, "Time_End": 39.0, "Text": " What else can I say?"}, {"Time_Start": 39.0, "Time_End": 45.0, "Text": " So I worked for two years for a commercial vendor of security software."}, {"Time_Start": 45.0, "Time_End": 49.0, "Text": " It doesn't really matter which one, and I prefer not to say,"}, {"Time_Start": 49.0, "Time_End": 52.0, "Text": " because I'd hate to think that people think their products are better,"}, {"Time_Start": 52.0, "Time_End": 56.0, "Text": " because of my knowledge, anyway."}, {"Time_Start": 56.0, "Time_End": 59.980000000000004, "Text": " We have T-shirts for sale out there, and I'm going to get"}, {"Time_Start": 60.0, "Time_End": 61.0, "Text": " out T-shirts."}, {"Time_Start": 61.0, "Time_End": 66.0, "Text": " New Hack has already sold out before anyone even knew who they really were."}, {"Time_Start": 66.0, "Time_End": 71.0, "Text": " If we just jumped the gun, I think the inspiration was at stake selling out so fast,"}, {"Time_Start": 71.0, "Time_End": 74.0, "Text": " or locked selling out to outstakes so fast."}, {"Time_Start": 74.0, "Time_End": 80.0, "Text": " So here's the basic deal, is that there's four major areas I'm going to cover,"}, {"Time_Start": 80.0, "Time_End": 86.0, "Text": " and I posted an outline to, or Jeff posted my outline to the DefCon web page,"}, {"Time_Start": 86.0, "Time_End": 89.98, "Text": " and I've changed it a little bit since then because I thought it'd be a little bit more interesting to look"}, {"Time_Start": 90.0, "Time_End": 92.4, "Text": " look at things from a bit more holistic perspective."}, {"Time_Start": 92.4, "Time_End": 98.5, "Text": " So in a couple of four areas, and those four areas are what user expectations of IDS and firewalls are,"}, {"Time_Start": 98.5, "Time_End": 101.0, "Text": " like why do people buy these things in the first place?"}, {"Time_Start": 101.0, "Time_End": 106.0, "Text": " And then the second thing is how to test for those expectations to make sure that people"}, {"Time_Start": 106.0, "Time_End": 108.0, "Text": " are getting what they want hypothetically."}, {"Time_Start": 108.0, "Time_End": 114.0, "Text": " And then the third section is common coding problems that sort of come up,"}, {"Time_Start": 114.0, "Time_End": 119.0, "Text": " that sort of bubble to the surface when you actually start doing this kind of testing, testing."}, {"Time_Start": 119.0, "Time_End": 120.0, "Text": " And then the first,"}, {"Time_Start": 120.0, "Time_End": 125.0, "Text": " thing is what designers and people who are writing these things, like right now,"}, {"Time_Start": 125.0, "Time_End": 132.0, "Text": " like from scratch, can do to avoid a lot of the mistakes that I have seen in the last couple"}, {"Time_Start": 132.0, "Time_End": 135.9, "Text": " years, code-wise, and design wise."}, {"Time_Start": 135.9, "Time_End": 143.0, "Text": " So the first thing is users, why do people buy IDS's and firewalls?"}, {"Time_Start": 143.0, "Time_End": 146.0, "Text": " And like, why is it such a popular market right now?"}, {"Time_Start": 146.0, "Time_End": 149.0, "Text": " In like the last year, it's up to a couple of big."}, {"Time_Start": 149.0, "Time_End": 151.8, "Text": " to a couple billion dollars or something."}, {"Time_Start": 151.8, "Time_End": 156.7, "Text": " It's like crazy that people are actually paying money for this stuff."}, {"Time_Start": 156.7, "Time_End": 165.7, "Text": " Well, I think that the, I think the main reason is, is people basically don't care."}, {"Time_Start": 165.7, "Time_End": 170.5, "Text": " People, users really don't care if a proxy firewall or a packet filtering based firewall"}, {"Time_Start": 170.5, "Time_End": 173.8, "Text": " or a hybrid firewall is going to make them more safe."}, {"Time_Start": 173.8, "Time_End": 178.3, "Text": " Or if a network-based IDS or host-based IDS is going to make them more safe."}, {"Time_Start": 178.3, "Time_End": 178.9, "Text": " All of they care about."}, {"Time_Start": 179.0, "Time_End": 182.9, "Text": " about is they have a topology and an infrastructure, they don't want to change,"}, {"Time_Start": 182.9, "Time_End": 187.5, "Text": " and they will put in whatever it's going to fit in what they have right now."}, {"Time_Start": 187.5, "Time_End": 191.0, "Text": " Whatever is the easiest thing to implement is what they're going to end up implementing."}, {"Time_Start": 191.0, "Time_End": 193.0, "Text": " And that's basically what it comes down to."}, {"Time_Start": 193.0, "Time_End": 199.0, "Text": " So this talk has nothing to do with arguing over which is better or any of this complete nonsense."}, {"Time_Start": 199.0, "Time_End": 207.0, "Text": " So because you have to make both because people want both or need both or have been convinced that they want or need both."}, {"Time_Start": 207.0, "Time_End": 208.0, "Text": " Both kinds."}, {"Time_Start": 209.0, "Time_End": 212.0, "Text": " in either the FIRO or the IDS space."}, {"Time_Start": 212.0, "Time_End": 222.0, "Text": " So, yeah, people just want to deploy and not have to deal with anything."}, {"Time_Start": 222.0, "Time_End": 226.5, "Text": " I think most people actually are aware that IDS is don't make you safe."}, {"Time_Start": 226.5, "Time_End": 229.0, "Text": " I'm pretty confident of this."}, {"Time_Start": 229.0, "Time_End": 235.0, "Text": " I don't, a lot of people think, a lot of, I don't know, hacksores and like security consultants,"}, {"Time_Start": 235.0, "Time_End": 238.98, "Text": " over, think that, like, general, I don't know, if you call them,"}, {"Time_Start": 239.0, "Time_End": 242.0, "Text": " or not think that IDS is making more safe somehow."}, {"Time_Start": 242.0, "Time_End": 246.0, "Text": " IDS has just give you time to react, and that's all that they do."}, {"Time_Start": 246.0, "Time_End": 248.0, "Text": " And I think that most people are aware of this."}, {"Time_Start": 248.0, "Time_End": 252.0, "Text": " I think that most people don't think that IDS are going to magically stop you from being attacked."}, {"Time_Start": 252.0, "Time_End": 255.0, "Text": " So I don't think that there's a misperception there."}, {"Time_Start": 255.0, "Time_End": 262.0, "Text": " Firewalls, this is kind of weird, because real purists will say,"}, {"Time_Start": 262.0, "Time_End": 266.0, "Text": " you know, firewalls and IDS are fluff and crap, and they just need to fix the real problems"}, {"Time_Start": 266.0, "Time_End": 268.0, "Text": " and, like, make the code in the OS is better, and then the FTN."}, {"Time_Start": 268.0, "Time_End": 271.0, "Text": " better and in the FTP demons and whatever."}, {"Time_Start": 271.0, "Time_End": 273.0, "Text": " That's not really practical."}, {"Time_Start": 273.0, "Time_End": 281.0, "Text": " So from a certain standpoint, firewalls do help you reduce and manage risk, right?"}, {"Time_Start": 281.0, "Time_End": 286.0, "Text": " If the firewalls are implemented properly in both code and topology, right?"}, {"Time_Start": 286.0, "Time_End": 291.0, "Text": " If the coding is solid, like they've done everything properly, and you've deployed it properly"}, {"Time_Start": 291.0, "Time_End": 295.0, "Text": " in your infrastructure and you've configured it properly and everything,"}, {"Time_Start": 295.0, "Time_End": 297.0, "Text": " hypothetically speaking, it was."}, {"Time_Start": 297.0, "Time_End": 304.0, "Text": " it will reduce, like, the ways people can get in, hypothetically."}, {"Time_Start": 304.0, "Time_End": 309.0, "Text": " Although, we've all seen, like, the hacking exposed things that Ernst & Young and those guys did,"}, {"Time_Start": 309.0, "Time_End": 315.0, "Text": " were like, they don't need, all they need is Port 18, and they bounce in and do a Port 139 redirect,"}, {"Time_Start": 315.0, "Time_End": 318.0, "Text": " and using NetCat, and like, all kinds of crazy shit."}, {"Time_Start": 318.0, "Time_End": 323.0, "Text": " So, but hypothetically, from a certain perspective, it does reduce risk."}, {"Time_Start": 323.0, "Time_End": 327.0, "Text": " And so, vendors have convinced people, of course, that since some bullfurt"}, {"Time_Start": 327.0, "Time_End": 333.24, "Text": " shit percent number, let's say 80% of all intrusions are come internally, and your firewall"}, {"Time_Start": 333.24, "Time_End": 336.6, "Text": " isn't going to protect you from those, you need to have an IDS anyway, so you need to have your ideas"}, {"Time_Start": 336.6, "Time_End": 346.3, "Text": " to protect you from the outside problems, and you need an IDS to protect you from the problems"}, {"Time_Start": 346.3, "Time_End": 356.98, "Text": " that the firewall can't block or you just can't deal with or whatever. Okay, so people"}, {"Time_Start": 357.0, "Time_End": 362.24, "Text": " expect firewalls to keep packets out and people expect IDS to tell them when they're"}, {"Time_Start": 362.24, "Time_End": 368.6, "Text": " being attacked with whatever signatures. Oh my God, is that a video projector?"}, {"Time_Start": 368.6, "Time_End": 380.24, "Text": " Be still my heart. So this is what people are expecting. So section two, how do you test"}, {"Time_Start": 380.24, "Time_End": 386.8, "Text": " for these expectations? I have three favorite tools, basically."}, {"Time_Start": 387.0, "Time_End": 391.26, "Text": " They are NAP, Whisker, and Isick."}, {"Time_Start": 391.76, "Time_End": 393.06, "Text": " And Isick is a suite of utilities."}, {"Time_Start": 393.22, "Time_End": 395.1, "Text": " And I think Mike Franson, who Isaac is here?"}, {"Time_Start": 395.26, "Time_End": 395.86, "Text": " He's right there."}, {"Time_Start": 396.72, "Time_End": 398.7, "Text": " This guy is the bomb shit right here."}, {"Time_Start": 399.3, "Time_End": 402.84, "Text": " This guy's tools have helped me find so many bugs."}, {"Time_Start": 403.76, "Time_End": 406.56, "Text": " We released, Newhack, released a NetBSD advisory"}, {"Time_Start": 406.56, "Time_End": 408.62, "Text": " about two months ago or something."}, {"Time_Start": 409.9, "Time_End": 410.36, "Text": " A new shirt."}, {"Time_Start": 410.74, "Time_End": 411.76, "Text": " Yes, you do get a T-shirt."}, {"Time_Start": 412.76, "Time_End": 413.06, "Text": " I promise."}, {"Time_Start": 415.76, "Time_End": 416.68, "Text": " There's a T-shirt."}, {"Time_Start": 417.0, "Time_End": 418.32, "Text": " Oh, by the way, here's what they look like."}, {"Time_Start": 421.24, "Time_End": 421.92, "Text": " Aski Art."}, {"Time_Start": 423.48, "Time_End": 424.56, "Text": " You can actually look at the bottom."}, {"Time_Start": 426.54, "Time_End": 427.76, "Text": " Let me see if I can throw it that far, right?"}, {"Time_Start": 429.86, "Time_End": 430.96, "Text": " Oh, pretty close."}, {"Time_Start": 432.42, "Time_End": 432.86, "Text": " There you go."}, {"Time_Start": 434.44, "Time_End": 436.96, "Text": " Yeah, so NMAP, Whisker, and Isaac."}, {"Time_Start": 438.94, "Time_End": 440.78, "Text": " Basically, here's the deal."}, {"Time_Start": 440.98, "Time_End": 442.8, "Text": " You can't just download these tools and start using them"}, {"Time_Start": 442.8, "Time_End": 444.06, "Text": " and, like, think you're going to find shit."}, {"Time_Start": 445.06, "Time_End": 446.74, "Text": " Please, understand."}, {"Time_Start": 447.0, "Time_End": 451.88, "Text": " these tools are doing. Like, even if you can't read code, read the docs and, like, figure"}, {"Time_Start": 451.88, "Time_End": 458.72, "Text": " it out. Like, I don't think I'm that smart, and yet, like, I can, like, sort of, like, know"}, {"Time_Start": 458.72, "Time_End": 463.94, "Text": " how this stuff works. And if you actually read the docs and understand how works, you'll"}, {"Time_Start": 463.94, "Time_End": 468.76, "Text": " understand that when you're using I-SIC or ESIC, that you should disconnect yourself from, like,"}, {"Time_Start": 468.76, "Time_End": 476.84, "Text": " public networks so that, you know, like, DOS every box on, like, the Subnet Plus, which people still"}, {"Time_Start": 476.84000000000003, "Time_End": 478.90000000000003, "Text": " will do. Yes?"}, {"Time_Start": 480.66, "Time_End": 482.88000000000005, "Text": " ISIC. Oh, I'm sorry, it's IP stack integrity"}, {"Time_Start": 482.88000000000005, "Time_End": 484.94000000000005, "Text": " checker. And it's actually a suite of"}, {"Time_Start": 484.94000000000005, "Time_End": 487.76000000000005, "Text": " utilities. And I'm going to go through each of them individually"}, {"Time_Start": 487.76000000000005, "Time_End": 490.72, "Text": " and how they should be used. And I'll"}, {"Time_Start": 490.72, "Time_End": 492.88000000000005, "Text": " say the URLs at the end, it's really pathetic. I have all"}, {"Time_Start": 492.88000000000005, "Time_End": 493.64000000000004, "Text": " these URLs memorized."}, {"Time_Start": 493.64000000000004, "Time_End": 497.64000000000004, "Text": " Um, so"}, {"Time_Start": 497.64000000000004, "Time_End": 501.04, "Text": " why is it kind of, I understand that's what you will."}, {"Time_Start": 505.64000000000004, "Time_End": 505.96000000000004, "Text": " Okay."}, {"Time_Start": 506.84000000000003, "Time_End": 507.72, "Text": " What the fuck is that?"}, {"Time_Start": 510.38000000000005, "Time_End": 510.98, "Text": " That's odd."}, {"Time_Start": 511.14000000000004, "Time_End": 511.38000000000005, "Text": " Okay."}, {"Time_Start": 512.8000000000001, "Time_End": 513.82, "Text": " What do the tools do?"}, {"Time_Start": 514.1, "Time_End": 515.3000000000001, "Text": " I'm glad you ask."}, {"Time_Start": 516.32, "Time_End": 518.32, "Text": " I think everyone knows what NMAP is."}, {"Time_Start": 518.38, "Time_End": 522.4, "Text": " I think it's pretty ridiculous how popular NMAP is and how much everyone uses it for everything."}, {"Time_Start": 522.9, "Time_End": 525.9, "Text": " And how every time you go on an IAC channel, someone says, you're running NetBSD."}, {"Time_Start": 526.2, "Time_End": 527.24, "Text": " And it's like, well, that's great."}, {"Time_Start": 528.9200000000001, "Time_End": 530.52, "Text": " Thanks for telling me something I didn't know."}, {"Time_Start": 532.94, "Time_End": 535.34, "Text": " So NMAP is really good."}, {"Time_Start": 535.34, "Time_End": 537.58, "Text": " not as a port scan or anything like that."}, {"Time_Start": 537.7800000000001, "Time_End": 543.1600000000001, "Text": " NMAP is really cool for testing a couple of things in firewalls and IDSs."}, {"Time_Start": 543.1600000000001, "Time_End": 547.1, "Text": " In state-based packet filtering firewalls and MAP implementations,"}, {"Time_Start": 547.58, "Time_End": 549.4200000000001, "Text": " and even IPSEC tunnel implementations,"}, {"Time_Start": 550.22, "Time_End": 554.44, "Text": " NMAP is really, it's so simple, it's really elegant."}, {"Time_Start": 554.9, "Time_End": 558.22, "Text": " Just like doing a port scan through like a trusted tunnel,"}, {"Time_Start": 558.22, "Time_End": 563.5600000000001, "Text": " like a thin scan or something, and then, you know, watch like the IPSECIC implementation"}, {"Time_Start": 563.5600000000001, "Time_End": 564.8000000000001, "Text": " and then like take a shit."}, {"Time_Start": 565.34, "Time_End": 570.84, "Text": " All these tools, by the way, are like the focus is firewalls and IDS, but testing IPSEC tunnels,"}, {"Time_Start": 570.98, "Time_End": 576.74, "Text": " like if you go to your VPN bakeoffs in like your area or whatever, take these tools with you."}, {"Time_Start": 576.84, "Time_End": 580.9200000000001, "Text": " Whisker, not so much, but like Isaac especially, holy shit."}, {"Time_Start": 581.44, "Time_End": 585.46, "Text": " Isaac found so many things, so many bugs in IPSEC and limitations."}, {"Time_Start": 585.6600000000001, "Time_End": 586.7, "Text": " It's not even funny."}, {"Time_Start": 588.6, "Time_End": 590.9000000000001, "Text": " So, anyway, end map."}, {"Time_Start": 590.9000000000001, "Time_End": 595.32, "Text": " So just sort of a simple port scan with the night."}, {"Time_Start": 595.34, "Time_End": 600.44, "Text": " will usually suffice. So because I don't have my slides and my pretty pictures, I'm going"}, {"Time_Start": 600.44, "Time_End": 606.86, "Text": " to use my hands. So I have an untrusted network, the big bed internet over here. I have my"}, {"Time_Start": 606.86, "Time_End": 613.74, "Text": " firewall IDS, you know, whatever the fuck. And then I have my trusted machines that are"}, {"Time_Start": 613.74, "Time_End": 621.2800000000001, "Text": " protected by the firewall and whatever else. So the interesting thing to do is to run an NMAP scan"}, {"Time_Start": 621.2800000000001, "Time_End": 625.08, "Text": " through all 65,535 ports."}, {"Time_Start": 625.34, "Time_End": 633.58, "Text": " Just to really, like, give, like, the state table, should I explain this?"}, {"Time_Start": 634.32, "Time_End": 640.94, "Text": " So in an IDS, like, when you make a connection, when you send a sin, like, there's a state table structure generally."}, {"Time_Start": 641.5400000000001, "Time_End": 644.64, "Text": " I don't know if everyone's implemented this the same way, but I don't know how else you do it."}, {"Time_Start": 645.1600000000001, "Time_End": 649.24, "Text": " There's a state table structure, then it adds your source into destination like this."}, {"Time_Start": 649.62, "Time_End": 649.9200000000001, "Text": " Yes?"}, {"Time_Start": 650.88, "Time_End": 653.6600000000001, "Text": " Oh my goodness."}, {"Time_Start": 654.6600000000001, "Time_End": 655.0600000000001, "Text": " All right."}, {"Time_Start": 655.34, "Time_End": 657.34, "Text": " Where is that at?"}, {"Time_Start": 657.34, "Time_End": 659.34, "Text": " Right here?"}, {"Time_Start": 659.34, "Time_End": 660.34, "Text": " Awesome."}, {"Time_Start": 660.34, "Time_End": 665.34, "Text": " What?"}, {"Time_Start": 665.34, "Time_End": 671.34, "Text": " What?"}, {"Time_Start": 671.34, "Time_End": 675.34, "Text": " Do you actually expect me to you star office?"}, {"Time_Start": 675.34, "Time_End": 677.34, "Text": " Yeah."}, {"Time_Start": 677.34, "Time_End": 679.34, "Text": " Whatever."}, {"Time_Start": 685.34, "Time_End": 687.34, "Text": " The user expectations testing for blah."}, {"Time_Start": 687.34, "Time_End": 691.34, "Text": " Most users are where."}, {"Time_Start": 691.34, "Time_End": 694.34, "Text": " I should have both anyway, NNAPWISC."}, {"Time_Start": 694.34, "Time_End": 697.34, "Text": " Oh, I'm sorry. So I'll start here."}, {"Time_Start": 697.34, "Time_End": 699.34, "Text": " So here's this."}, {"Time_Start": 699.34, "Time_End": 703.34, "Text": " So NMNMAPWISCII, IPSic and Turn Checker."}, {"Time_Start": 703.34, "Time_End": 706.34, "Text": " Don't just use these tools blindly understand how the fuck they work."}, {"Time_Start": 706.34, "Time_End": 709.34, "Text": " Otherwise, like your testing means dick and you post a security focus like an idiot,"}, {"Time_Start": 709.34, "Time_End": 711.34, "Text": " or post a bug check like an idiot."}, {"Time_Start": 711.34, "Time_End": 712.34, "Text": " Like no."}, {"Time_Start": 712.34, "Time_End": 715.34, "Text": " I ran an NMAP a thousand times and then when I came back in the morning,"}, {"Time_Start": 715.34, "Time_End": 717.34, "Text": " the box crash, that doesn't help anybody."}, {"Time_Start": 717.34, "Time_End": 719.34, "Text": " It really doesn't."}, {"Time_Start": 719.34, "Time_End": 722.34, "Text": " The vendor's like, well, what's your configuration?"}, {"Time_Start": 722.34, "Time_End": 724.34, "Text": " It's like, I wipe the box already."}, {"Time_Start": 724.34, "Time_End": 726.34, "Text": " Like, you really aren't helping anybody"}, {"Time_Start": 726.34, "Time_End": 730.34, "Text": " trying to solve the problem that you've found."}, {"Time_Start": 730.34, "Time_End": 733.34, "Text": " Configuration can make a difference, especially on fireballs."}, {"Time_Start": 733.34, "Time_End": 736.34, "Text": " Like, let's say that you do an MAP test,"}, {"Time_Start": 736.34, "Time_End": 739.34, "Text": " or you run TCP sick, route it through the firewall,"}, {"Time_Start": 739.34, "Time_End": 742.34, "Text": " and you have one deny rule."}, {"Time_Start": 742.34, "Time_End": 745.34, "Text": " I've seen situations where you add and allow rule."}, {"Time_Start": 745.34, "Time_End": 748.34, "Text": " or you add an absorb rule or whatever,"}, {"Time_Start": 748.34, "Time_End": 750.34, "Text": " or you add two deny rules or something,"}, {"Time_Start": 750.34, "Time_End": 753.34, "Text": " and then the machine will crash, or then it'll leak packets,"}, {"Time_Start": 753.34, "Time_End": 755.34, "Text": " or what have you."}, {"Time_Start": 755.34, "Time_End": 759.34, "Text": " So if you're really interested in, like, finding problems and stuff,"}, {"Time_Start": 759.34, "Time_End": 765.34, "Text": " just be really diligent if you have the time and the resources and whatever."}, {"Time_Start": 765.34, "Time_End": 770.34, "Text": " Oh yeah, so here's the network idea."}, {"Time_Start": 770.34, "Time_End": 774.34, "Text": " Untrusted, you have your target machine, which is your firewall."}, {"Time_Start": 774.34, "Time_End": 777.34, "Text": " firewall and then you have your trusted network."}, {"Time_Start": 777.34, "Time_End": 780.34, "Text": " And so usually my examples I'll say go from untrusted to trusted,"}, {"Time_Start": 780.34, "Time_End": 783.34, "Text": " because that's usually what people do when they're doing penetration testing."}, {"Time_Start": 783.34, "Time_End": 785.34, "Text": " But if you're looking for crashes or packet leakage or whatever,"}, {"Time_Start": 785.34, "Time_End": 787.34, "Text": " you can find it the other way as well."}, {"Time_Start": 787.34, "Time_End": 790.34, "Text": " And people usually miss this."}, {"Time_Start": 790.34, "Time_End": 793.34, "Text": " I found a couple of bugs in the software I was testing"}, {"Time_Start": 793.34, "Time_End": 796.34, "Text": " by just going the other way around, especially with Nat."}, {"Time_Start": 796.34, "Time_End": 801.34, "Text": " If you have a knatted or IP masqueraded or what the links, people call it,"}, {"Time_Start": 801.34, "Time_End": 804.34, "Text": " and you send like the other way instead of, you send"}, {"Time_Start": 804.34, "Time_End": 807.84, "Text": " like from trusted to untrusted so the other round."}, {"Time_Start": 807.84, "Time_End": 813.34, "Text": " That gives the code that maintains the state tables for Nat a really good workout."}, {"Time_Start": 813.34, "Time_End": 819.34, "Text": " I give an example of a bug that I found that worked like that."}, {"Time_Start": 819.34, "Time_End": 824.34, "Text": " When you sent fin packets through Nat from trusted to untrusted,"}, {"Time_Start": 824.34, "Time_End": 832.84, "Text": " the firewall made an entry in the state table for that fin, and then never removed it ever."}, {"Time_Start": 832.84, "Time_End": 834.32, "Text": " So if you did a fin"}, {"Time_Start": 834.34, "Time_End": 838.34, "Text": " scan or flooded it with fins or what have you with like from random source addresses,"}, {"Time_Start": 838.34, "Time_End": 842.34, "Text": " um, basically you're testing to see if there's any unchecked malics."}, {"Time_Start": 842.34, "Time_End": 845.34, "Text": " And if there's an unchecked malloc and these are the stuff as a ring zero,"}, {"Time_Start": 845.34, "Time_End": 849.34, "Text": " you've got a blue screen or an oops, or whatever Linux calls it,"}, {"Time_Start": 849.34, "Time_End": 851.34, "Text": " or a Chroma Panic or what have you."}, {"Time_Start": 851.34, "Time_End": 853.34, "Text": " Huh?"}, {"Time_Start": 853.34, "Time_End": 854.34, "Text": " Who's Firewall?"}, {"Time_Start": 854.34, "Time_End": 855.34, "Text": " Yeah."}, {"Time_Start": 855.34, "Time_End": 856.34, "Text": " Who's firewall as well?"}, {"Time_Start": 856.34, "Time_End": 857.34, "Text": " It doesn't matter."}, {"Time_Start": 857.34, "Time_End": 859.34, "Text": " It's been fixed."}, {"Time_Start": 859.34, "Time_End": 861.34, "Text": " Next?"}, {"Time_Start": 861.34, "Time_End": 862.34, "Text": " Right."}, {"Time_Start": 862.34, "Time_End": 863.34, "Text": " Okay."}, {"Time_Start": 863.34, "Time_End": 864.34, "Text": " Okay."}, {"Time_Start": 864.34, "Time_End": 869.34, "Text": " So NMAP, yeah, state table code and packet filter and net implementations."}, {"Time_Start": 869.34, "Time_End": 878.34, "Text": " From untrusted, from an untrusted machine, NetMap, NMap, Sinscan, ports 1 through 65, 535."}, {"Time_Start": 878.34, "Time_End": 883.34, "Text": " A really cool thing to do, by the way, that NMAP won't let you do, is send stuff in port zero through a firewall."}, {"Time_Start": 883.34, "Time_End": 885.34, "Text": " That gets interesting results sometimes."}, {"Time_Start": 885.34, "Time_End": 891.34, "Text": " Same way with through an IPSEC tunnel, et cetera, et cetera."}, {"Time_Start": 891.34, "Time_End": 894.34, "Text": " And so what you can see when you do this, if you know how to do this, if you know how to look at a lot,"}, {"Time_Start": 894.34, "Time_End": 900.0, "Text": " look, by the way, if anyone knows how to see non-page kernel memory usage in Linux,"}, {"Time_Start": 900.0, "Time_End": 905.58, "Text": " could you please tell me, either programmatically or otherwise, because I couldn't find any information"}, {"Time_Start": 905.58, "Time_End": 908.6800000000001, "Text": " on the net at all on how to do it."}, {"Time_Start": 908.6800000000001, "Time_End": 914.98, "Text": " But if you were able to do that, like you are on NT in about one second, what you'd see is that"}, {"Time_Start": 914.98, "Time_End": 919.24, "Text": " when you do that, you see non-page kernel memory increase because what's happening is the state"}, {"Time_Start": 919.24, "Time_End": 923.9200000000001, "Text": " table is growing because you're doing, you're doing like a lot of connections."}, {"Time_Start": 924.34, "Time_End": 931.34, "Text": " And so, like I said, what this test for is one unchecked malloc, like most operating systems impose a hard limit on non-page kernel memory,"}, {"Time_Start": 931.34, "Time_End": 934.34, "Text": " like 16 meg or 20 meg, or however much it is."}, {"Time_Start": 934.34, "Time_End": 937.34, "Text": " I mean, it depends on how it's physical RAM you have."}, {"Time_Start": 937.34, "Time_End": 942.34, "Text": " And for you not always architecture people, a non-page kernel memory is,"}, {"Time_Start": 946.34, "Time_End": 953.34, "Text": " non-page kernel memory is memory only accessible to the kernel that never gets paged out, ever,"}, {"Time_Start": 953.34, "Time_End": 982.88, "Text": " ever because if it gets because for whatever reason the data structure that's holding it couldn't handle like a virtual memory fault or a page fault of any kind and state tables happen to fall into this sort of category. And so if you make the state table grow large enough, eventually it's going to hit that hard limit of non-page Chrome memory. The OS is going to say sorry, right? And I've seen it time and time and time again where"}, {"Time_Start": 982.88, "Time_End": 993.88, "Text": " I don't know why, but people don't check the return values of cis calls, not just Malik, although Malik is like the most common, or in all the other Alec calls as well."}, {"Time_Start": 993.88, "Time_End": 1000.88, "Text": " There's been a couple vulnerabilities now, like people weren't checking the return of set GID."}, {"Time_Start": 1000.88, "Time_End": 1003.88, "Text": " Like if that failed, then like defaulted to zero or something."}, {"Time_Start": 1003.88, "Time_End": 1005.88, "Text": " I think it was a weird or something."}, {"Time_Start": 1005.88, "Time_End": 1009.88, "Text": " It's the Ipho pic show."}, {"Time_Start": 1009.88, "Time_End": 1014.88, "Text": " So that's basically what you're testing."}, {"Time_Start": 1014.88, "Time_End": 1021.88, "Text": " And if you're looking for stuff like that, like you're looking for DOS is where they run out of memory and then they fuck up because they didn't check a Malik somewhere."}, {"Time_Start": 1021.88, "Time_End": 1027.88, "Text": " Both in Linux and an NT and probably BBSD as well, you can limit the amount of physical memory."}, {"Time_Start": 1027.88, "Time_End": 1031.88, "Text": " The OS will use that will help you greatly in finding these bugs faster."}, {"Time_Start": 1031.88, "Time_End": 1038.88, "Text": " Because if you do this a 120 meg machine, you really have to beat the living fuck out of it in order to like get it to crash or do whatever you're trying to get it to do."}, {"Time_Start": 1038.88, "Time_End": 1040.38, "Text": " you're trying to get to do."}, {"Time_Start": 1040.38, "Time_End": 1043.38, "Text": " And so if you just kind of lower it just a little bit,"}, {"Time_Start": 1043.38, "Time_End": 1045.88, "Text": " you'll hit these conditions a lot easier."}, {"Time_Start": 1045.88, "Time_End": 1047.88, "Text": " Wait, I don't want to go whisker."}, {"Time_Start": 1047.88, "Time_End": 1048.88, "Text": " What the fuck?"}, {"Time_Start": 1048.88, "Time_End": 1050.88, "Text": " Go back on."}, {"Time_Start": 1050.88, "Time_End": 1051.88, "Text": " There we go."}, {"Time_Start": 1051.88, "Time_End": 1053.88, "Text": " Different scan types, like I said."}, {"Time_Start": 1053.88, "Time_End": 1056.88, "Text": " Fin packet and a certain implementation"}, {"Time_Start": 1056.88, "Time_End": 1059.88, "Text": " of a Safele packet filter filter firewall."}, {"Time_Start": 1059.88, "Time_End": 1062.88, "Text": " Didn't remove fins if you just sent a fin."}, {"Time_Start": 1062.88, "Time_End": 1063.88, "Text": " It was really odd."}, {"Time_Start": 1063.88, "Time_End": 1066.88, "Text": " I don't know how the thing ever worked."}, {"Time_Start": 1066.88, "Time_End": 1067.88, "Text": " It probably did never work."}, {"Time_Start": 1067.88, "Time_End": 1068.88, "Text": " But it probably didn't ever work."}, {"Time_Start": 1068.88, "Time_End": 1070.38, "Text": " Axe scans, et cetera, et cetera."}, {"Time_Start": 1070.38, "Time_End": 1073.88, "Text": " So tiny IP frags, this used to be an interesting way"}, {"Time_Start": 1073.88, "Time_End": 1077.88, "Text": " to leak packets through firewalls and to make firewalls crash"}, {"Time_Start": 1077.88, "Time_End": 1081.88, "Text": " because for a stateful packet filter-based firewall,"}, {"Time_Start": 1081.88, "Time_End": 1084.88, "Text": " God damn it, it's hard."}, {"Time_Start": 1084.88, "Time_End": 1085.88, "Text": " Wow."}, {"Time_Start": 1085.88, "Time_End": 1089.88, "Text": " For a stateful packet filter to do its job properly,"}, {"Time_Start": 1089.88, "Time_End": 1095.38, "Text": " if I've blocked port 80, I'm assuming, I'm going to assume some knowledge of TCPIP here."}, {"Time_Start": 1095.38, "Time_End": 1098.8600000000001, "Text": " If I block port 80 and the TCP"}, {"Time_Start": 1098.88, "Time_End": 1101.88, "Text": " header is split up across multiple IP packets, right?"}, {"Time_Start": 1101.88, "Time_End": 1105.88, "Text": " So when I get my first IP packet on the file and I'm analyzing it and I'm looking at it,"}, {"Time_Start": 1105.88, "Time_End": 1109.88, "Text": " and I'll say, okay, is this allowed on the ports that I'm allowing to pass through me?"}, {"Time_Start": 1109.88, "Time_End": 1115.88, "Text": " Well, I can't see the port because the port information in the TCP header is in the next IP fragment."}, {"Time_Start": 1115.88, "Time_End": 1118.88, "Text": " You can do one of two things if you're an implementer."}, {"Time_Start": 1118.88, "Time_End": 1123.88, "Text": " You can either reassemble it to get the full TCP header, in which case you're opening yourself to DOS"}, {"Time_Start": 1123.88, "Time_End": 1128.7600000000002, "Text": " is with memory usage, with people selling a whole lot of frags, and you're holding them waiting for the next"}, {"Time_Start": 1128.88, "Time_End": 1130.88, "Text": " to come see and get the full header."}, {"Time_Start": 1130.88, "Time_End": 1132.88, "Text": " Or you can just drop them."}, {"Time_Start": 1132.88, "Time_End": 1134.88, "Text": " I'd recommend dropping them because"}, {"Time_Start": 1134.88, "Time_End": 1138.88, "Text": " the likelihood that an MTU is that small,"}, {"Time_Start": 1138.88, "Time_End": 1141.88, "Text": " that a TCP header would be split across IP packets,"}, {"Time_Start": 1141.88, "Time_End": 1144.88, "Text": " is very, very, very, very, very unlikely."}, {"Time_Start": 1144.88, "Time_End": 1146.88, "Text": " In fact, if anyone can tell me a configuration"}, {"Time_Start": 1146.88, "Time_End": 1148.88, "Text": " in which I would really happen, I'd really like to hear it."}, {"Time_Start": 1148.88, "Time_End": 1151.88, "Text": " So if you're an implementer, drop tiny IP frags."}, {"Time_Start": 1151.88, "Time_End": 1152.88, "Text": " Don't even fuck with them."}, {"Time_Start": 1152.88, "Time_End": 1157.88, "Text": " It's not even worth any trouble because it doesn't happen"}, {"Time_Start": 1157.88, "Time_End": 1161.88, "Text": " in real life. If someone sends your tiny IP frags, they're fucking with you, period."}, {"Time_Start": 1161.88, "Time_End": 1169.88, "Text": " So the new thing tiny IP frags does now is that state-based IDS is they keep track of connections and whatever else."}, {"Time_Start": 1169.88, "Time_End": 1175.88, "Text": " If your IDS is like a logic tree-like, they're not just doing flat sort of packet grepping,"}, {"Time_Start": 1175.88, "Time_End": 1181.88, "Text": " and they actually check to see that, okay, there's a sin, all right, there's an act, okay, and then I look for my get-PHF."}, {"Time_Start": 1181.88, "Time_End": 1186.88, "Text": " Stuff like, excuse me, ideas that do stuff like that,"}, {"Time_Start": 1186.88, "Time_End": 1191.88, "Text": " stuff like that are actually, you can actually, this sort of stuff kind of works."}, {"Time_Start": 1191.88, "Time_End": 1201.88, "Text": " Because for IDSs that don't do IP fragmentation reassembly, like, it has the same problem that the"}, {"Time_Start": 1201.88, "Time_End": 1204.88, "Text": " state-based packet filtering firewalls do, and that they can't get the full state with the"}, {"Time_Start": 1204.88, "Time_End": 1210.5600000000002, "Text": " first packet, so it's like, what do I do? I can't do reassembly either, so I guess I'm just not going"}, {"Time_Start": 1210.5600000000002, "Time_End": 1213.88, "Text": " to pay attention to this stream unless it matches like my packet gripping."}, {"Time_Start": 1213.88, "Time_End": 1216.8600000000001, "Text": " And because you're fragmenting that small anyway."}, {"Time_Start": 1216.88, "Time_End": 1218.88, "Text": " It doesn't really matter."}, {"Time_Start": 1218.88, "Time_End": 1224.88, "Text": " And you can do tiny IP frags with another tool that I almost mentioned called frag router."}, {"Time_Start": 1224.88, "Time_End": 1227.88, "Text": " And frag router is a fine tool, I think is written by Doug Song."}, {"Time_Start": 1227.88, "Time_End": 1229.88, "Text": " Maybe he's here."}, {"Time_Start": 1229.88, "Time_End": 1236.88, "Text": " And that can send tiny IP frags with just regular traffic."}, {"Time_Start": 1236.88, "Time_End": 1238.88, "Text": " It looks just like it sounds."}, {"Time_Start": 1238.88, "Time_End": 1244.88, "Text": " It's a router that fragments, packets to whatever interesting configuration you want."}, {"Time_Start": 1244.88, "Time_End": 1251.88, "Text": " So, SIN scan, like all the ports basically, doing a full port sweep."}, {"Time_Start": 1251.88, "Time_End": 1256.88, "Text": " Like, expands and contracts state tables if they're implemented properly."}, {"Time_Start": 1256.88, "Time_End": 1265.88, "Text": " So this is pretty evil because this next example here, NMAP, SIN scan, all the ports,"}, {"Time_Start": 1265.88, "Time_End": 1268.88, "Text": " Decoy Scan. I love Decoy Scan."}, {"Time_Start": 1268.88, "Time_End": 1270.88, "Text": " Let me tell you why I love Decoy Scan."}, {"Time_Start": 1270.88, "Time_End": 1273.88, "Text": " And with decoy scan, you can fill up state tables faster than you."}, {"Time_Start": 1273.88, "Time_End": 1275.88, "Text": " faster than anything."}, {"Time_Start": 1275.88, "Time_End": 1280.88, "Text": " And I really like using really fucked-up addresses for the decoy scam,"}, {"Time_Start": 1280.88, "Time_End": 1287.88, "Text": " which if you're one or two hops away, you could probably get away with, but it might not be practical."}, {"Time_Start": 1287.88, "Time_End": 1291.88, "Text": " So, if we, can I go back more?"}, {"Time_Start": 1291.88, "Time_End": 1297.88, "Text": " So see here, this network here is 192, 168.2, and the one I'm sending from is 10.0.0."}, {"Time_Start": 1297.88, "Time_End": 1299.88, "Text": " Can you go back again?"}, {"Time_Start": 1299.88, "Time_End": 1300.88, "Text": " Forward one?"}, {"Time_Start": 1300.88, "Time_End": 1304.88, "Text": " Oh, thanks."}, {"Time_Start": 1304.88, "Time_End": 1307.88, "Text": " This thing here?"}, {"Time_Start": 1307.88, "Time_End": 1308.88, "Text": " Yeah."}, {"Time_Start": 1308.88, "Time_End": 1314.88, "Text": " So I'm using the loopback address of the destination network, the broadcast address of the destination network,"}, {"Time_Start": 1314.88, "Time_End": 1319.88, "Text": " and then the loopback and the broadcast of my network, and then just crazy shit like, you know,"}, {"Time_Start": 1319.88, "Time_End": 1321.88, "Text": " 255.25.25."}, {"Time_Start": 1321.88, "Time_End": 1324.88, "Text": " And 0.0.0.0."}, {"Time_Start": 1324.88, "Time_End": 1328.88, "Text": " I've found interesting packet leakage problems doing stuff like this."}, {"Time_Start": 1328.88, "Time_End": 1329.88, "Text": " Whether or not these packs can be routed."}, {"Time_Start": 1329.88, "Time_End": 1333.88, "Text": " these packs can be routed through the actual internet is a whole other question."}, {"Time_Start": 1333.88, "Time_End": 1341.88, "Text": " But, I mean, if someone owns your ISP and they're one hop away, it's a completely feasible scenario."}, {"Time_Start": 1341.88, "Time_End": 1346.88, "Text": " Yeah, so decoy scans are actually pretty neat."}, {"Time_Start": 1346.88, "Time_End": 1351.88, "Text": " And actually, I don't think that they're really useful for evading IES detection at all,"}, {"Time_Start": 1351.88, "Time_End": 1354.88, "Text": " because that's what the original purpose was, was that you do so many parallel scans,"}, {"Time_Start": 1354.88, "Time_End": 1359.88, "Text": " that the IDS logs flood, and they can't tell what's going on because they see so many sorts of"}, {"Time_Start": 1359.88, "Time_End": 1365.1200000000001, "Text": " addresses for the voice council and can't tell which one's the real one."}, {"Time_Start": 1365.1200000000001, "Time_End": 1375.38, "Text": " And so NMAP can be gotten from HTTP colon slash slash insecure.org slash NMAP, I N-S-C-U-R-E-S-C-U-R-E-D-R-S-S-N-M-Map."}, {"Time_Start": 1375.38, "Time_End": 1376.88, "Text": " I think everyone knows that."}, {"Time_Start": 1376.88, "Time_End": 1378.88, "Text": " Whoever doesn't know that shouldn't be here."}, {"Time_Start": 1378.88, "Time_End": 1379.88, "Text": " Next."}, {"Time_Start": 1379.88, "Time_End": 1381.88, "Text": " Next, please."}, {"Time_Start": 1381.88, "Time_End": 1384.88, "Text": " Thank you."}, {"Time_Start": 1384.88, "Time_End": 1385.88, "Text": " Whisker."}, {"Time_Start": 1385.88, "Time_End": 1387.88, "Text": " Whisker is really cool."}, {"Time_Start": 1387.88, "Time_End": 1389.88, "Text": " It's written in Pearl."}, {"Time_Start": 1389.88, "Time_End": 1396.88, "Text": " So you can just run it on Win 32 or Linux or BSD or whatever the fuck runs Pearl."}, {"Time_Start": 1396.88, "Time_End": 1399.88, "Text": " Probably your Palm Pilot can run a whisker if it runs Perl."}, {"Time_Start": 1399.88, "Time_End": 1402.88, "Text": " Yes, sir?"}, {"Time_Start": 1402.88, "Time_End": 1403.88, "Text": " I'm sorry."}, {"Time_Start": 1403.88, "Time_End": 1405.88, "Text": " All right."}, {"Time_Start": 1405.88, "Time_End": 1409.88, "Text": " That would be nice."}, {"Time_Start": 1409.88, "Time_End": 1412.88, "Text": " Do what?"}, {"Time_Start": 1412.88, "Time_End": 1415.88, "Text": " Turn up the volume."}, {"Time_Start": 1415.88, "Time_End": 1417.88, "Text": " Like this?"}, {"Time_Start": 1417.88, "Time_End": 1418.88, "Text": " All right."}, {"Time_Start": 1418.88, "Time_End": 1420.88, "Text": " All right."}, {"Time_Start": 1420.88, "Time_End": 1435.88, "Text": " So, I think everyone knows what Whisker is basically made to, it's an HCP scanner, but Rainforest puppy, bless his heart, at a whole bunch of IDS evasion functionality, which is really cool."}, {"Time_Start": 1435.88, "Time_End": 1439.88, "Text": " If you see him, give him a big hug and a smooch, because he really deserves it."}, {"Time_Start": 1439.88, "Time_End": 1448.8600000000001, "Text": " Because this gets past, these things, I think, I don't, have not seen a firewall, or I haven't seen an IDS, that,"}, {"Time_Start": 1448.88, "Time_End": 1451.68, "Text": " One of those evasion techniques does not get passed."}, {"Time_Start": 1451.68, "Time_End": 1456.3200000000002, "Text": " If you can show me one, I'll blow you or something."}, {"Time_Start": 1456.3200000000002, "Time_End": 1459.72, "Text": " So, Whisker basically, what?"}, {"Time_Start": 1459.72, "Time_End": 1461.88, "Text": " Oh, thank you."}, {"Time_Start": 1461.88, "Time_End": 1463.48, "Text": " Let me take a door, quick."}, {"Time_Start": 1463.48, "Time_End": 1473.48, "Text": " Um, so Whisker works like this."}, {"Time_Start": 1473.48, "Time_End": 1475.88, "Text": " So Whisker works like this."}, {"Time_Start": 1478.88, "Time_End": 1483.88, "Text": " You have pearl installed, or you have pearl installed, I'm sorry, you have pearl installed."}, {"Time_Start": 1483.88, "Time_End": 1486.88, "Text": " It's just a whisker, dash H, your target host."}, {"Time_Start": 1486.88, "Time_End": 1491.88, "Text": " And then dash I goes through all of the various IDS evasion techniques."}, {"Time_Start": 1491.88, "Time_End": 1497.88, "Text": " Um, dash I1 is your own coding, which is a very popular one to do."}, {"Time_Start": 1497.88, "Time_End": 1501.88, "Text": " Which, uh, what's his face, Robert Grant from Network Eyes blasted, Network Associates,"}, {"Time_Start": 1501.88, "Time_End": 1504.88, "Text": " Cybercop Monitor for not doing when it really does."}, {"Time_Start": 1504.88, "Time_End": 1507.88, "Text": " Um, so."}, {"Time_Start": 1507.88, "Time_End": 1511.88, "Text": " So I think everyone knows, like, Whisker is good for doing this stuff."}, {"Time_Start": 1511.88, "Time_End": 1515.88, "Text": " But here's the interesting point that I don't think you guys thought of is, HCTP proxies"}, {"Time_Start": 1515.88, "Time_End": 1521.2, "Text": " that block by URL, like they block, you know, like anything where fuck is in the URL"}, {"Time_Start": 1521.2, "Time_End": 1522.7600000000002, "Text": " or something."}, {"Time_Start": 1522.7600000000002, "Time_End": 1528.6000000000001, "Text": " How much you want to bet that they're all susceptible to URL encoding?"}, {"Time_Start": 1528.6000000000001, "Time_End": 1530.0, "Text": " I bet you that they all are."}, {"Time_Start": 1530.0, "Time_End": 1534.88, "Text": " So a lot of people think proxies are just deployed so that users on the inside can browse"}, {"Time_Start": 1534.88, "Time_End": 1535.88, "Text": " work through this proxy."}, {"Time_Start": 1535.88, "Time_End": 1536.88, "Text": " Actually, sometimes it works earlier around."}, {"Time_Start": 1536.88, "Time_End": 1537.88, "Text": " Well, they'll have a proxy."}, {"Time_Start": 1537.88, "Time_End": 1541.7800000000002, "Text": " But people coming in from the outside, like our limited access,"}, {"Time_Start": 1541.7800000000002, "Time_End": 1545.7800000000002, "Text": " unless they belong to certain URLs, unless they belong to a certain IP range,"}, {"Time_Start": 1545.7800000000002, "Time_End": 1547.88, "Text": " or something like that, or they authenticate first."}, {"Time_Start": 1547.88, "Time_End": 1549.88, "Text": " This gets past that."}, {"Time_Start": 1549.88, "Time_End": 1553.88, "Text": " Something else to test for in HTTP proxies."}, {"Time_Start": 1553.88, "Time_End": 1557.0800000000002, "Text": " I'm not going to talk too much about this because Westker has great docs."}, {"Time_Start": 1557.0800000000002, "Time_End": 1560.88, "Text": " Everyone knows what the hell it is and knows what it does and knows what its capabilities are."}, {"Time_Start": 1560.88, "Time_End": 1565.88, "Text": " So the URL is HTTP colon slash slash www."}, {"Time_Start": 1565.88, "Time_End": 1567.8600000000001, "Text": " Wyrtrip.net slash RFP."}, {"Time_Start": 1567.88, "Time_End": 1573.88, "Text": " you can go in there and choose your theme and then find the whisker docks that's"}, {"Time_Start": 1573.88, "Time_End": 1580.88, "Text": " www.w-w-w-I-R-E-T-R-I-T-R-I-P for Rainforest Puppy."}, {"Time_Start": 1584.88, "Time_End": 1585.88, "Text": " I-S-SIC."}, {"Time_Start": 1585.88, "Time_End": 1588.88, "Text": " Okay, I'm sorry, I can't get over it."}, {"Time_Start": 1588.88, "Time_End": 1592.88, "Text": " These are my favorite tools ever for testing this kind of stuff."}, {"Time_Start": 1592.88, "Time_End": 1595.88, "Text": " It's not necessarily a new idea."}, {"Time_Start": 1595.88, "Time_End": 1597.88, "Text": " It's just something finally did it."}, {"Time_Start": 1597.88, "Time_End": 1600.88, "Text": " ISEC is a suite of utilities."}, {"Time_Start": 1600.88, "Time_End": 1605.88, "Text": " There is ISIC, which is IP stack integrity checker."}, {"Time_Start": 1605.88, "Time_End": 1607.88, "Text": " TCPSIC is TCP stack integrity checker."}, {"Time_Start": 1607.88, "Time_End": 1612.88, "Text": " UDP is UDP and ICP is ICMP is ICP, and ESEC is Ethernet,"}, {"Time_Start": 1612.88, "Time_End": 1615.88, "Text": " which is actually really cool."}, {"Time_Start": 1615.88, "Time_End": 1619.88, "Text": " We found some interesting problems with that that will probably release"}, {"Time_Start": 1619.88, "Time_End": 1623.88, "Text": " sometime in the next millennia, hopefully."}, {"Time_Start": 1623.88, "Time_End": 1626.88, "Text": " Great for testing protocol implementations."}, {"Time_Start": 1626.88, "Time_End": 1628.88, "Text": " protocol implementations on all of these."}, {"Time_Start": 1628.88, "Time_End": 1629.88, "Text": " All of these."}, {"Time_Start": 1629.88, "Time_End": 1632.88, "Text": " Like I said, we found the NetBSD bug, the remote crash,"}, {"Time_Start": 1632.88, "Time_End": 1635.88, "Text": " with an ICMP packet using, I'm sorry, it was an ICMP packet."}, {"Time_Start": 1635.88, "Time_End": 1640.88, "Text": " It was an unilined IP options, cause an underlying memory access."}, {"Time_Start": 1640.88, "Time_End": 1642.88, "Text": " Using, ah, it stopped working."}, {"Time_Start": 1642.88, "Time_End": 1643.88, "Text": " There it goes."}, {"Time_Start": 1643.88, "Time_End": 1647.88, "Text": " Using ICNPSEC, and the steps were to reproduce from the advisory."}, {"Time_Start": 1647.88, "Time_End": 1652.88, "Text": " ICSIC, I'm sorry, IIC, all the utilities are used Libnet by Route,"}, {"Time_Start": 1652.88, "Time_End": 1654.88, "Text": " which is also a great library."}, {"Time_Start": 1654.88, "Time_End": 1655.88, "Text": " Beautiful code to read."}, {"Time_Start": 1655.88, "Time_End": 1659.88, "Text": " code to read if you're into that kind of thing."}, {"Time_Start": 1659.88, "Time_End": 1663.88, "Text": " State-based IDS and packet filters."}, {"Time_Start": 1663.88, "Time_End": 1666.88, "Text": " Wow."}, {"Time_Start": 1666.88, "Time_End": 1671.88, "Text": " Basically what these tools do is they send"}, {"Time_Start": 1671.88, "Time_End": 1674.88, "Text": " sort of controlled random packets."}, {"Time_Start": 1674.88, "Time_End": 1676.88, "Text": " It's kind of interesting."}, {"Time_Start": 1676.88, "Time_End": 1677.88, "Text": " So basically you see it with a random seed."}, {"Time_Start": 1677.88, "Time_End": 1679.88, "Text": " Remembering all your basic stuff,"}, {"Time_Start": 1679.88, "Time_End": 1681.88, "Text": " we would use RAND and you have to seed it with like"}, {"Time_Start": 1681.88, "Time_End": 1683.88, "Text": " 32K to negative 32K."}, {"Time_Start": 1683.88, "Time_End": 1684.88, "Text": " Works kind of like that."}, {"Time_Start": 1684.88, "Time_End": 1686.88, "Text": " that."}, {"Time_Start": 1686.88, "Time_End": 1688.88, "Text": " And so basically, if you enter the same random seed,"}, {"Time_Start": 1688.88, "Time_End": 1691.88, "Text": " you'll get the same random results."}, {"Time_Start": 1691.88, "Time_End": 1697.88, "Text": " And it, you know, does IP options, it changes all the IP options,"}, {"Time_Start": 1697.88, "Time_End": 1701.88, "Text": " it changes the length, changes the header length,"}, {"Time_Start": 1701.88, "Time_End": 1704.88, "Text": " lies about the header length, all kinds of crazy shit."}, {"Time_Start": 1704.88, "Time_End": 1709.88, "Text": " Basically, it throws a lot, it just pukes all over the protocol stack"}, {"Time_Start": 1709.88, "Time_End": 1712.88, "Text": " and sees if the protocol stack can take it."}, {"Time_Start": 1712.88, "Time_End": 1713.88, "Text": " Because state-based,"}, {"Time_Start": 1713.88, "Time_End": 1721.88, "Text": " Because state-based, I guess, as a packet folders, are sort of kind of implementations of TCP IP to an extent."}, {"Time_Start": 1721.88, "Time_End": 1727.88, "Text": " Um, God, it's hot."}, {"Time_Start": 1727.88, "Time_End": 1734.88, "Text": " Um, our implementation of TCP IP to an extent, this sort of vomiting works as well."}, {"Time_Start": 1734.88, "Time_End": 1743.88, "Text": " And it's just like NMAP with the state-based IDS where from a certain IP, I go a state-based IDS, I go a state-based IDS."}, {"Time_Start": 1743.88, "Time_End": 1748.88, "Text": " I go sin and wait a minute, I don't get an act, I get a fin immediately, no God, I'm screwed and I puk."}, {"Time_Start": 1748.88, "Time_End": 1758.88, "Text": " Same way with state-based firewalls, small IP packets, tiny, not necessarily tiny IP frags, certain fragment offsets."}, {"Time_Start": 1758.88, "Time_End": 1760.88, "Text": " That's what else. This is good at finding is."}, {"Time_Start": 1760.88, "Time_End": 1763.88, "Text": " Some things are sensitive to just certain fragment offsets."}, {"Time_Start": 1763.88, "Time_End": 1768.88, "Text": " And if you run these tools for long enough, eventually you'll hit all of them."}, {"Time_Start": 1768.88, "Time_End": 1773.38, "Text": " So IPSEC tunnel, same thing."}, {"Time_Start": 1773.38, "Time_End": 1779.1000000000001, "Text": " In fact, I would, if someone would take these, I, uh, Hugh Daniel and I talked about this a couple months ago."}, {"Time_Start": 1779.16, "Time_End": 1783.7800000000002, "Text": " I don't know if he's done it yet, but he used to take H-Ping, some utility called H-Ping, to"}, {"Time_Start": 1783.7800000000002, "Time_End": 1789.2600000000002, "Text": " leap-p and bake-offs and try and get other people's IPSECII limitations to crash at the bake-offs."}, {"Time_Start": 1790.6200000000001, "Time_End": 1793.72, "Text": " And I, I pointed out in Isaac, and I don't know if he's actually used it yet."}, {"Time_Start": 1794.0600000000002, "Time_End": 1799.48, "Text": " I really hope he does, because I'm sure that it'll just make a whole lot of people's IPSEC implementation just puke."}, {"Time_Start": 1800.48, "Time_End": 1802.42, "Text": " And that as well, that once again."}, {"Time_Start": 1803.38, "Time_End": 1810.38, "Text": " testing from both, routing from both, the trusted network to untrusted and untrusted to trusted and everything in between."}, {"Time_Start": 1810.38, "Time_End": 1817.38, "Text": " Also firing directly at the untrusted interface of the firewall and at the trusted interface of the firewall as well can yield some different results."}, {"Time_Start": 1817.38, "Time_End": 1820.38, "Text": " And also before, like I said, try all kinds of different configurations."}, {"Time_Start": 1820.38, "Time_End": 1824.38, "Text": " One with the denial, one with an allow, two denies, two allows and absorb, whatever."}, {"Time_Start": 1824.38, "Time_End": 1826.38, "Text": " So here's the example."}, {"Time_Start": 1826.38, "Time_End": 1832.38, "Text": " TCPS, which is the specifies the source IP, RAND."}, {"Time_Start": 1832.38, "Time_End": 1837.88, "Text": " And if you specify RAND, it will pick a random IP for every single packet it sends out."}, {"Time_Start": 1837.88, "Time_End": 1839.38, "Text": " It's pretty cool."}, {"Time_Start": 1839.38, "Time_End": 1845.38, "Text": " Sometimes, though, you don't want to do that because the firewall would just drop things that."}, {"Time_Start": 1845.38, "Time_End": 1850.38, "Text": " Like, if you're testing from the trusted network to an untrusted network, for instance."}, {"Time_Start": 1850.38, "Time_End": 1854.38, "Text": " I'll do questions I can end."}, {"Time_Start": 1854.38, "Time_End": 1860.38, "Text": " If you're testing from the trusted network to an untrusted network, and you're sending from the subnet of the untrusted network,"}, {"Time_Start": 1860.38, "Time_End": 1861.38, "Text": " the firewall will be smart enough to just drop your password."}, {"Time_Start": 1861.38, "Time_End": 1866.38, "Text": " be smart enough to just drop your packet and you won't go all the way through the code pass that you need to to test them properly."}, {"Time_Start": 1866.38, "Time_End": 1868.38, "Text": " So dash s rand is a good way to do things."}, {"Time_Start": 1868.38, "Time_End": 1875.38, "Text": " When you use dash s rand, unplug yourself from the public internet, all right?"}, {"Time_Start": 1875.38, "Time_End": 1881.38, "Text": " When you send packets at a host, it's going to reply back to the source address, right?"}, {"Time_Start": 1881.38, "Time_End": 1888.38, "Text": " And if you hit some dot mill by accident or something and people come knocking on your door, that's why."}, {"Time_Start": 1888.38, "Time_End": 1891.3600000000001, "Text": " Especially when you're using ESIC, because ESIC by default,"}, {"Time_Start": 1891.38, "Time_End": 1894.38, "Text": " sends to the broadcast Ethernet address."}, {"Time_Start": 1894.38, "Time_End": 1896.38, "Text": " It kills networks, okay?"}, {"Time_Start": 1896.38, "Time_End": 1901.38, "Text": " If you can hide a laptop store in an ESIC that's broadcasting,"}, {"Time_Start": 1901.38, "Time_End": 1904.38, "Text": " that's sending, like, Ethernet frames,"}, {"Time_Start": 1904.38, "Time_End": 1908.38, "Text": " to the broadcast address, you will kill a network."}, {"Time_Start": 1908.38, "Time_End": 1910.38, "Text": " That's not a legitimate testing, though."}, {"Time_Start": 1910.38, "Time_End": 1912.38, "Text": " It's just on the side."}, {"Time_Start": 1912.38, "Time_End": 1917.38, "Text": " So, and then dash D is the destination, trusted,"}, {"Time_Start": 1917.38, "Time_End": 1920.38, "Text": " so if we're going from untrusted, and set,"}, {"Time_Start": 1920.38, "Time_End": 1921.88, "Text": " be sure to set your random seed."}, {"Time_Start": 1921.88, "Time_End": 1927.38, "Text": " If you don't set it, it uses the process ID of what it's running as right now."}, {"Time_Start": 1927.38, "Time_End": 1933.38, "Text": " And so when you don't use dash R, like your PID is incremental or random and open BSD or whatever,"}, {"Time_Start": 1933.38, "Time_End": 1935.38, "Text": " you won't get consistent results."}, {"Time_Start": 1935.38, "Time_End": 1941.38, "Text": " And I've seen this mistake happen with people who didn't understand the tool, basically."}, {"Time_Start": 1941.38, "Time_End": 1946.38, "Text": " They just, you know, they did dash S, ran, dash D, trusted, and then they just went to town."}, {"Time_Start": 1946.38, "Time_End": 1949.38, "Text": " And then, like, they got something to crash, and then they could never get to crash again."}, {"Time_Start": 1949.38, "Time_End": 1955.38, "Text": " it to crash again, and I go, what was your random seed? I don't know. Well, oh well."}, {"Time_Start": 1955.38, "Time_End": 1960.38, "Text": " So I usually use 3137 or 666, something's really dumb and easy to remember."}, {"Time_Start": 1960.38, "Time_End": 1964.38, "Text": " If you can't get anything to happen in like the first 5 million packets or so,"}, {"Time_Start": 1964.38, "Time_End": 1968.38, "Text": " try changing the random seed to something else."}, {"Time_Start": 1968.38, "Time_End": 1975.38, "Text": " Dash M-700 limits, it's like the maximum, maximum not a package you can pump out on the network,"}, {"Time_Start": 1975.38, "Time_End": 1977.38, "Text": " kilobytes per second wise."}, {"Time_Start": 1977.38, "Time_End": 1983.38, "Text": " Now, like the next point says, Linux sends packets fucking fast."}, {"Time_Start": 1983.38, "Time_End": 1990.38, "Text": " Like, 4 meg per second, really fast, but as we mentioned in our NetBSD advisory,"}, {"Time_Start": 1990.38, "Time_End": 1993.38, "Text": " Linux mangles packets and doesn't tell you."}, {"Time_Start": 1993.38, "Time_End": 1997.38, "Text": " And so when we were doing some last minute, like, test,"}, {"Time_Start": 1997.38, "Time_End": 1999.38, "Text": " when we make sure this was completely reproducible,"}, {"Time_Start": 1999.38, "Time_End": 2002.38, "Text": " we couldn't reproduce it on Linux, and we were like,"}, {"Time_Start": 2002.38, "Time_End": 2003.38, "Text": " what the fuck is going on?"}, {"Time_Start": 2003.38, "Time_End": 2006.38, "Text": " And so we tested it from BSD, it worked."}, {"Time_Start": 2006.38, "Time_End": 2014.38, "Text": " Problem with BSD is that because, for whatever architectural reason, it's a lot slower at sending packets."}, {"Time_Start": 2014.38, "Time_End": 2020.38, "Text": " It has these things called M&B clusters that fill up very fast for whatever reason."}, {"Time_Start": 2020.38, "Time_End": 2022.38, "Text": " So you can't send them as fast."}, {"Time_Start": 2022.38, "Time_End": 2025.38, "Text": " If you send them as fast, it will drop packets."}, {"Time_Start": 2025.38, "Time_End": 2028.38, "Text": " So instead of sending mangled packets, you don't send the packets at all."}, {"Time_Start": 2028.38, "Time_End": 2030.38, "Text": " And this can be a problem."}, {"Time_Start": 2030.38, "Time_End": 2035.38, "Text": " So dash M 700, when we are sending from some ARM 32 boxes, we're sending up BSD,"}, {"Time_Start": 2035.38, "Time_End": 2040.38, "Text": " running nut BSD and also from an open BSD on like some pinning twos or something,"}, {"Time_Start": 2040.38, "Time_End": 2042.38, "Text": " that's seem to be about right."}, {"Time_Start": 2042.38, "Time_End": 2044.38, "Text": " And I don't think it has anything to do with how fast the machine is."}, {"Time_Start": 2044.38, "Time_End": 2047.38, "Text": " I think it has to do with the drivers and how they are written."}, {"Time_Start": 2047.38, "Time_End": 2051.38, "Text": " And if you run into that, if your machine is slower, whatever, you can increase NMV clusters."}, {"Time_Start": 2051.38, "Time_End": 2056.38, "Text": " Don't ask me how. I don't know anything about Unix."}, {"Time_Start": 2056.38, "Time_End": 2064.38, "Text": " So, so the URL for ISIC, the suite of utilities, is HTTP,"}, {"Time_Start": 2064.38, "Time_End": 2073.38, "Text": " H-D-P-C-C-P-P-R-A-N-T-T-E-N-T-E-N."}, {"Time_Start": 2073.38, "Time_End": 2075.38, "Text": " That man's last name right there."}, {"Time_Start": 2075.38, "Time_End": 2081.1800000000003, "Text": " So EXP-E-R-T-E-R-T-E-E-E-E-D-U-U-S-T-E-U-S-T-E-U-L-A-R-F-E-E-U-S."}, {"Time_Start": 2081.1800000000003, "Time_End": 2083.38, "Text": " So that's slide 8."}, {"Time_Start": 2083.38, "Time_End": 2085.38, "Text": " Next, please."}, {"Time_Start": 2085.38, "Time_End": 2091.38, "Text": " I was going to have a code example, by the way, but it's got lost in the ether,"}, {"Time_Start": 2091.38, "Time_End": 2094.38, "Text": " so I can't do it."}, {"Time_Start": 2094.38, "Time_End": 2105.38, "Text": " Okay, so, this is only loosely related, but as far as like, the kind of, the kind of,"}, {"Time_Start": 2105.38, "Time_End": 2110.38, "Text": " the kind of testing, like, brings about certain problems, certain problems with memory allocation,"}, {"Time_Start": 2110.38, "Time_End": 2117.38, "Text": " not checking sys calls, not taking the return values of, not taking the return values of"}, {"Time_Start": 2117.38, "Time_End": 2123.38, "Text": " calls, various other problems, so just some suggestions."}, {"Time_Start": 2123.38, "Time_End": 2127.46, "Text": " for dev managers, for whatever else."}, {"Time_Start": 2129.5, "Time_End": 2133.7000000000003, "Text": " For the love of Christ, don't just start coding if you're going to do something serious."}, {"Time_Start": 2134.2400000000002, "Time_End": 2140.96, "Text": " If you're going to write, like, a 200-line program, fine, like, get stoned, drunk, and, like, code until your fingers bleed."}, {"Time_Start": 2141.3, "Time_End": 2145.7400000000002, "Text": " But if you're going to do something serious, define your interfaces first, plan first."}, {"Time_Start": 2146.1600000000003, "Time_End": 2148.4, "Text": " Try and maintain consistency in the interfaces."}, {"Time_Start": 2150.0, "Time_End": 2151.2200000000003, "Text": " God, it drives me crazy."}, {"Time_Start": 2151.2200000000003, "Time_End": 2153.36, "Text": " I really, really hate..."}, {"Time_Start": 2153.38, "Time_End": 2160.38, "Text": " code that's just a total rat's nest. There's no consistency at all."}, {"Time_Start": 2160.38, "Time_End": 2164.7200000000003, "Text": " So this is always a good idea, and if you're in a professional environment, modeling tools"}, {"Time_Start": 2164.7200000000003, "Time_End": 2173.1, "Text": " like UML, what else are? UML, like Rational Rows, whatever, can maybe help you with them to that"}, {"Time_Start": 2173.1, "Time_End": 2179.06, "Text": " kind of thing. Writing well, writing clean, well-documented code, I mean, like, well-formatted,"}, {"Time_Start": 2179.06, "Time_End": 2183.36, "Text": " like you can read it, good comments, stuff like that, we'll save you time."}, {"Time_Start": 2183.38, "Time_End": 2184.82, "Text": " Time and annuisms later."}, {"Time_Start": 2184.92, "Time_End": 2186.2000000000003, "Text": " A lot of people think it's a waste of time."}, {"Time_Start": 2186.3, "Time_End": 2188.44, "Text": " A lot of manuals think, no, you know, we don't have time to clean it up, whatever."}, {"Time_Start": 2188.7400000000002, "Time_End": 2191.42, "Text": " It will always bite you in the ass every single time."}, {"Time_Start": 2191.46, "Time_End": 2194.04, "Text": " When you think the code is going to be used for three months, you're going to rewrite it."}, {"Time_Start": 2194.2000000000003, "Time_End": 2197.92, "Text": " It's going to last three years every single time."}, {"Time_Start": 2198.26, "Time_End": 2199.6800000000003, "Text": " Have never seen it not happen."}, {"Time_Start": 2202.42, "Time_End": 2205.02, "Text": " And, all right, this is a real pet peeve."}, {"Time_Start": 2205.82, "Time_End": 2206.1800000000003, "Text": " All right."}, {"Time_Start": 2206.6800000000003, "Time_End": 2208.92, "Text": " Anybody try to compile NMAP, like, 2.08, like, MMAP, P, 2.08."}, {"Time_Start": 2209.3, "Time_End": 2210.82, "Text": " Or, like, MMAP, E, think, pre-25."}, {"Time_Start": 2211.54, "Time_End": 2212.94, "Text": " And there's a zillion more."}, {"Time_Start": 2213.38, "Time_End": 2217.52, "Text": " warnings, complaining about all kinds of crazy shit and all that most of it ended up being bugs."}, {"Time_Start": 2219.36, "Time_End": 2224.36, "Text": " Linux, G&U, not so much BSD, like G&U program is just all the time."}, {"Time_Start": 2224.8, "Time_End": 2228.2400000000002, "Text": " We're like, the compiler gives you warnings for a reason, okay?"}, {"Time_Start": 2228.86, "Time_End": 2231.88, "Text": " It's not telling you just for like, you know, to fill up your screen with crap."}, {"Time_Start": 2232.82, "Time_End": 2235.1400000000003, "Text": " Please fix warnings if you see them."}, {"Time_Start": 2236.5, "Time_End": 2239.1400000000003, "Text": " It's like the most simple thing that's overlooked every single time."}, {"Time_Start": 2239.5, "Time_End": 2241.42, "Text": " Nothing is source and runtime analysis tools."}, {"Time_Start": 2241.42, "Time_End": 2243.36, "Text": " If you have the loads and loads of accounts,"}, {"Time_Start": 2243.38, "Time_End": 2248.78, "Text": " to spend on purify, but ensure plus plus and flexulent and stuff like that."}, {"Time_Start": 2249.58, "Time_End": 2253.28, "Text": " If anyone wants to talk to me further about this stuff, I can talk about it at great length,"}, {"Time_Start": 2253.7000000000003, "Time_End": 2254.5, "Text": " but it's nothing to do with."}, {"Time_Start": 2256.6600000000003, "Time_End": 2257.88, "Text": " Oh, we're supposed to be here."}, {"Time_Start": 2259.7000000000003, "Time_End": 2262.54, "Text": " No, go back. I'll embellish in my name this for a minute."}, {"Time_Start": 2264.48, "Time_End": 2272.26, "Text": " It was supposed to be here, and I was going to, like, ask the crowd for, like, for, like, to tell me what was wrong with it."}, {"Time_Start": 2272.62, "Time_End": 2273.36, "Text": " And so I'll put it up on."}, {"Time_Start": 2273.38, "Time_End": 2280.42, "Text": " the new hack page or off my page off of new hack and along with these slides and hopefully"}, {"Time_Start": 2280.42, "Time_End": 2286.02, "Text": " recording of the talk and you all can send email saying like what you see be like where's"}, {"Time_Start": 2286.02, "Time_End": 2290.7400000000002, "Text": " well though of loom coding so what I was going to do was for every guess and got right of what was"}, {"Time_Start": 2290.7400000000002, "Time_End": 2293.94, "Text": " wrong was going to hand out a shirt so I'm going to hand out shirt doing the Q&A instead for people"}, {"Time_Start": 2293.94, "Time_End": 2303.2200000000003, "Text": " have really good questions for designers um for designers um"}, {"Time_Start": 2303.38, "Time_End": 2309.48, "Text": " Designers and coders, um, if you're implementing on NT and you're interested in application"}, {"Time_Start": 2309.48, "Time_End": 2316.34, "Text": " level stuff, use TDI, uh, transport something interface."}, {"Time_Start": 2316.34, "Time_End": 2322.28, "Text": " I can remember it is transport data, transport driver interface, thank you."}, {"Time_Start": 2322.28, "Time_End": 2327.2400000000002, "Text": " Um, you get stuff pre-IP assemble, um, so you don't have to duplicate work of the IP stack and further"}, {"Time_Start": 2327.2400000000002, "Time_End": 2328.5, "Text": " slow your IDS down."}, {"Time_Start": 2328.5, "Time_End": 2332.8, "Text": " Um, however, comma, this only works on host-based."}, {"Time_Start": 2333.38, "Time_End": 2341.1800000000003, "Text": " IDS is, which could be argued with the ideas that really work, but, um, on, and it"}, {"Time_Start": 2341.1800000000003, "Time_End": 2347.2200000000003, "Text": " worked on Windows 9, uh, Windows 95, 98, whatever, NT and Win 2K, so if you write code,"}, {"Time_Start": 2347.2200000000003, "Time_End": 2351.1400000000003, "Text": " it's gonna be portable for the most part. Um, the thing you can use, I didn't mention here on"}, {"Time_Start": 2351.1400000000003, "Time_End": 2356.1600000000003, "Text": " the slide, is IP helper functionality is kind of interesting instead of like seeing, uh, maintaining"}, {"Time_Start": 2356.1600000000003, "Time_End": 2363.32, "Text": " your own state table, excuse me, just use the OSS's. Um, in Windows 98 and NT starting"}, {"Time_Start": 2363.38, "Time_End": 2367.62, "Text": " Service Pack 4, NT4, which is IP helper functions."}, {"Time_Start": 2367.62, "Time_End": 2369.54, "Text": " We can actually get the connection table."}, {"Time_Start": 2369.54, "Time_End": 2372.98, "Text": " You can see who's connected and not have to deal with maintaining your own state and"}, {"Time_Start": 2372.98, "Time_End": 2374.42, "Text": " duplicating more work."}, {"Time_Start": 2374.42, "Time_End": 2377.88, "Text": " And if you do this, you're just going to be faster and you're just not duplicating work."}, {"Time_Start": 2377.88, "Time_End": 2381.0, "Text": " So because you're not duplicating code, you're not going to like implement mistakes"}, {"Time_Start": 2381.0, "Time_End": 2382.88, "Text": " all over again, et cetera, et cetera."}, {"Time_Start": 2382.88, "Time_End": 2387.7400000000002, "Text": " And in Linux 2.4, you can use the net filter interfaces, like the links"}, {"Time_Start": 2387.7400000000002, "Time_End": 2391.1, "Text": " current actually has proper interfaces for something, if you can find them such a thing."}, {"Time_Start": 2391.1, "Time_End": 2392.94, "Text": " Um, you can use the Netfilter interfaces."}, {"Time_Start": 2392.94, "Time_End": 2401.94, "Text": " You can use the net filter interfaces to read yourself at whatever point in the stack you want to get data, much like TDI slash and this on Windows."}, {"Time_Start": 2401.94, "Time_End": 2404.94, "Text": " And this is what I highly recommend."}, {"Time_Start": 2404.94, "Time_End": 2410.94, "Text": " I wouldn't bother re-implementing IPFrague reassembly, TCP stream reassembly."}, {"Time_Start": 2410.94, "Time_End": 2412.94, "Text": " It's just dumb, okay?"}, {"Time_Start": 2412.94, "Time_End": 2413.94, "Text": " Seriously."}, {"Time_Start": 2413.94, "Time_End": 2415.94, "Text": " Seriously, okay?"}, {"Time_Start": 2415.94, "Time_End": 2420.44, "Text": " Because when you re-implement things, this does the other thing."}, {"Time_Start": 2420.44, "Time_End": 2421.94, "Text": " Don't re-implement things, okay?"}, {"Time_Start": 2421.94, "Time_End": 2422.94, "Text": " Don't re-implement things."}, {"Time_Start": 2422.94, "Time_End": 2429.84, "Text": " Lib C calls. It's stupid. All right. When you write code, you're going to make mistakes."}, {"Time_Start": 2430.02, "Time_End": 2436.48, "Text": " When you rewrite code that's existed for 10 to 15 plus years, right? It's been around for that long."}, {"Time_Start": 2436.78, "Time_End": 2440.82, "Text": " People have probably found a lot of the bugs, right? People aren't going to find the bugs that"}, {"Time_Start": 2440.82, "Time_End": 2448.4, "Text": " are in your shitty code. Don't rewrite Lib C calls. If someone can argue with me later and"}, {"Time_Start": 2448.4, "Time_End": 2452.58, "Text": " prove me wrong on this, great. I'd really like to be proven wrong."}, {"Time_Start": 2452.94, "Time_End": 2458.7000000000003, "Text": " Right now, it just annoys the shit out of me that things take three times long just because someone has to rewrite SM printf."}, {"Time_Start": 2462.7000000000003, "Time_End": 2466.94, "Text": " Oh, and also, when you're doing NAT and IPSEC stuff, use the free stuff."}, {"Time_Start": 2466.94, "Time_End": 2468.94, "Text": " There's no reason not to."}, {"Time_Start": 2468.94, "Time_End": 2471.94, "Text": " Try and find someone else who has a NAT implementation like Cisco."}, {"Time_Start": 2471.94, "Time_End": 2478.94, "Text": " Like everyone in the world use Cisco's first, like, basic, reference implementation of IPSEC."}, {"Time_Start": 2478.94, "Time_End": 2480.94, "Text": " And it's a can't."}, {"Time_Start": 2480.94, "Time_End": 2482.92, "Text": " And that's why they're all vulnerable to, you know,"}, {"Time_Start": 2482.94, "Time_End": 2488.94, "Text": " garbage appendage bugs, but if it's mature code and you're reusing it, that's a good thing."}, {"Time_Start": 2488.94, "Time_End": 2489.94, "Text": " You aren't wasting time."}, {"Time_Start": 2489.94, "Time_End": 2490.94, "Text": " It's a really good thing."}, {"Time_Start": 2490.94, "Time_End": 2492.94, "Text": " I can't stress this enough."}, {"Time_Start": 2492.94, "Time_End": 2495.94, "Text": " If you have to argue with your manager about it, tell them send me mail."}, {"Time_Start": 2495.94, "Time_End": 2496.94, "Text": " I'll gladly argue."}, {"Time_Start": 2496.94, "Time_End": 2499.94, "Text": " This is something I love arguing about."}, {"Time_Start": 2499.94, "Time_End": 2504.94, "Text": " So there's a NewHexCity web page, www.newHexcccd.net."}, {"Time_Start": 2504.94, "Time_End": 2509.94, "Text": " There is not a whole heck of a lot there right now."}, {"Time_Start": 2509.94, "Time_End": 2511.94, "Text": " But I'm sure there will be in the future will be able to buy."}, {"Time_Start": 2511.94, "Time_End": 2515.94, "Text": " various memorabilia, thongs, et cetera."}, {"Time_Start": 2515.94, "Time_End": 2516.94, "Text": " And that's my email address."}, {"Time_Start": 2516.94, "Time_End": 2525.94, "Text": " S Y-K-E at NewhackC-C-C-C-C-Y-H-A-C-Y-T-Y-T-Y-Y-T-Y-Y-T-Y-Y-Y-Y-Y-Y-Y."}, {"Time_Start": 2525.94, "Time_End": 2527.94, "Text": " And that's it."}, {"Time_Start": 2527.94, "Time_End": 2528.94, "Text": " So Q-N-A."}, {"Time_Start": 2528.94, "Time_End": 2540.94, "Text": " If you're running, Isaac,"}, {"Time_Start": 2540.94, "Time_End": 2545.94, "Text": " Isaac, and it sends like 5 million packets at your IDS and one of them crashes it."}, {"Time_Start": 2545.94, "Time_End": 2548.94, "Text": " How do you narrow down which one and did it?"}, {"Time_Start": 2548.94, "Time_End": 2550.94, "Text": " Excellent question."}, {"Time_Start": 2550.94, "Time_End": 2551.94, "Text": " Excellent question."}, {"Time_Start": 2551.94, "Time_End": 2555.94, "Text": " It was something overlooked and I forgot that in."}, {"Time_Start": 2555.94, "Time_End": 2563.94, "Text": " Isaac has two options, dash P, which says to send this many packets and dash K, which says skip this many packets."}, {"Time_Start": 2563.94, "Time_End": 2567.94, "Text": " Mike should really be doing a talk on Isaac at this con."}, {"Time_Start": 2567.94, "Time_End": 2569.94, "Text": " And so what you do is,"}, {"Time_Start": 2569.94, "Time_End": 2573.94, "Text": " And so what you do is, is, if you know, if you're, don't let it run overnight."}, {"Time_Start": 2573.94, "Time_End": 2578.94, "Text": " Like, try and pay attention, like, look every 500,000 packets or something and see if it crashes."}, {"Time_Start": 2578.94, "Time_End": 2584.94, "Text": " Um, J-Roo actually wrote a patch that pinged after every so many packets."}, {"Time_Start": 2584.94, "Time_End": 2590.94, "Text": " Um, and I think, uh, wasn't, maybe it was Mike told me, someone, like, wrote a shell script or something"}, {"Time_Start": 2590.94, "Time_End": 2595.94, "Text": " that would send X number of packets, ping the host, and, like, you know, sort of incrementally go."}, {"Time_Start": 2595.94, "Time_End": 2596.94, "Text": " Huh?"}, {"Time_Start": 2596.94, "Time_End": 2597.94, "Text": " Huh?"}, {"Time_Start": 2597.94, "Time_End": 2598.94, "Text": " That's one included in the tarball."}, {"Time_Start": 2598.94, "Time_End": 2599.94, "Text": " Okay."}, {"Time_Start": 2599.94, "Time_End": 2601.94, "Text": " He says there's one included in the tarball."}, {"Time_Start": 2601.94, "Time_End": 2604.94, "Text": " So if you get the, if you go to the web page, expert.c."}, {"Time_Start": 2604.94, "Time_End": 2605.94, "Text": " ."}, {"Time_Start": 2605.94, "Time_End": 2610.94, "Text": " Purdu.edu slash Tilda, F-R-A, and T-Z-E-E-N, it's in the tarball."}, {"Time_Start": 2610.94, "Time_End": 2614.94, "Text": " But, to answer your question, so you understand what you're going on."}, {"Time_Start": 2614.94, "Time_End": 2618.94, "Text": " So what you do is like, you know it crashed sometime between packets,"}, {"Time_Start": 2618.94, "Time_End": 2623.94, "Text": " two and a half million and three million, sake of argument."}, {"Time_Start": 2623.94, "Time_End": 2625.94, "Text": " So what you do is you do a..."}, {"Time_Start": 2625.94, "Time_End": 2630.94, "Text": " do Isaac, dash S, whatever, dash D, whatever, dash R, whatever."}, {"Time_Start": 2630.94, "Time_End": 2634.7000000000003, "Text": " And then you do dash P for sending, and you say,"}, {"Time_Start": 2634.7000000000003, "Time_End": 2639.94, "Text": " dash P, send three million packets, and you say, dash K, skip the first 2.5 million."}, {"Time_Start": 2639.94, "Time_End": 2642.94, "Text": " When it skips packets, it takes a really long time because it has to go through"}, {"Time_Start": 2642.94, "Time_End": 2646.94, "Text": " with the random things, so you get the same results if you use the same random seed."}, {"Time_Start": 2646.94, "Time_End": 2648.94, "Text": " And then from there used to do binary search."}, {"Time_Start": 2648.94, "Time_End": 2650.94, "Text": " If it crashes again, you say, fucken a is reproducible."}, {"Time_Start": 2650.94, "Time_End": 2652.94, "Text": " Otherwise, you know, you expand your search a bit."}, {"Time_Start": 2652.94, "Time_End": 2654.94, "Text": " And so once you have the range, you know the range."}, {"Time_Start": 2654.94, "Time_End": 2655.94, "Text": " Just don't do the binary search."}, {"Time_Start": 2655.94, "Time_End": 2656.94, "Text": " search."}, {"Time_Start": 2656.94, "Time_End": 2661.94, "Text": " And you say, okay, it's between 2.5 million and 3 million, right?"}, {"Time_Start": 2661.94, "Time_End": 2664.94, "Text": " If that doesn't do it, then you know it's the other half minutes, like narrow down, narrow"}, {"Time_Start": 2664.94, "Time_End": 2665.94, "Text": " down, narrow down, narrow down."}, {"Time_Start": 2665.94, "Time_End": 2670.94, "Text": " And it took me an hour and a half to two hours to do that with a NetBST exploit."}, {"Time_Start": 2670.94, "Time_End": 2673.94, "Text": " Except I was lucky there where it didn't happen at 3 million packets."}, {"Time_Start": 2673.94, "Time_End": 2676.94, "Text": " It happened at like 30,000 something."}, {"Time_Start": 2676.94, "Time_End": 2677.94, "Text": " So that's how you do that."}, {"Time_Start": 2677.94, "Time_End": 2678.94, "Text": " That's an excellent question."}, {"Time_Start": 2678.94, "Time_End": 2679.94, "Text": " You get a t-shirt."}, {"Time_Start": 2679.94, "Time_End": 2684.94, "Text": " Anybody else?"}, {"Time_Start": 2684.94, "Time_End": 2688.94, "Text": " Mr. Bacom, we'd like to come up and..."}, {"Time_Start": 2688.94, "Time_End": 2691.94, "Text": " How many?"}, {"Time_Start": 2691.94, "Time_End": 2697.94, "Text": " He said, how many intrusion detection systems did you test?"}, {"Time_Start": 2697.94, "Time_End": 2698.94, "Text": " With Whisker?"}, {"Time_Start": 2698.94, "Time_End": 2701.94, "Text": " With all these tools?"}, {"Time_Start": 2701.94, "Time_End": 2703.94, "Text": " What are you testing?"}, {"Time_Start": 2703.94, "Time_End": 2707.94, "Text": " Five?"}, {"Time_Start": 2707.94, "Time_End": 2708.94, "Text": " Five?"}, {"Time_Start": 2708.94, "Time_End": 2709.94, "Text": " Five?"}, {"Time_Start": 2709.94, "Time_End": 2713.94, "Text": " Professionally or in my spare time?"}, {"Time_Start": 2713.94, "Time_End": 2714.94, "Text": " Huh?"}, {"Time_Start": 2714.94, "Time_End": 2716.94, "Text": " Huh?"}, {"Time_Start": 2716.94, "Time_End": 2717.94, "Text": " Together?"}, {"Time_Start": 2717.94, "Time_End": 2718.94, "Text": " Seven."}, {"Time_Start": 2718.94, "Time_End": 2719.94, "Text": " Huh?"}, {"Time_Start": 2719.94, "Time_End": 2727.94, "Text": " I really don't want to... I would rather not advocate anything."}, {"Time_Start": 2727.94, "Time_End": 2730.94, "Text": " I don't work for a vendor anymore, by the way."}, {"Time_Start": 2730.94, "Time_End": 2735.94, "Text": " As I'm sure you all find out, you get burnt out on this crap after a while, and you just don't"}, {"Time_Start": 2735.94, "Time_End": 2739.94, "Text": " want to deal with it anymore."}, {"Time_Start": 2739.94, "Time_End": 2741.94, "Text": " That's why I'm doing this."}, {"Time_Start": 2741.94, "Time_End": 2743.94, "Text": " So people can test this stuff themselves so admins can go."}, {"Time_Start": 2743.94, "Time_End": 2747.94, "Text": " a vendor says, it detects everything under the planet, you know?"}, {"Time_Start": 2747.94, "Time_End": 2749.94, "Text": " And then you can just, you can test for yourself."}, {"Time_Start": 2749.94, "Time_End": 2755.94, "Text": " And if you really feel like it, you can post a bug track and get your 255 TTLs of fame."}, {"Time_Start": 2759.94, "Time_End": 2763.94, "Text": " So that's part of the reason for this talk I want to do this, so people, to enable people to do this themselves."}, {"Time_Start": 2763.94, "Time_End": 2766.94, "Text": " Yes?"}, {"Time_Start": 2766.94, "Time_End": 2771.94, "Text": " Yes?"}, {"Time_Start": 2771.94, "Time_End": 2772.94, "Text": " Yes."}, {"Time_Start": 2773.94, "Time_End": 2775.94, "Text": " Thank you."}, {"Time_Start": 2803.94, "Time_End": 2805.94, "Text": " Thank you."}, {"Time_Start": 2833.94, "Time_End": 2835.94, "Text": " Thank you."}, {"Time_Start": 2863.94, "Time_End": 2865.94, "Text": " Thank you."}, {"Time_Start": 2893.94, "Time_End": 2895.94, "Text": " Thank you."}, {"Time_Start": 2923.94, "Time_End": 2925.94, "Text": " Thank you."}, {"Time_Start": 2953.94, "Time_End": 2955.94, "Text": " Thank you."}, {"Time_Start": 2983.94, "Time_End": 2985.94, "Text": " Thank you."}, {"Time_Start": 3013.94, "Time_End": 3015.94, "Text": " Thank you."}, {"Time_Start": 3043.94, "Time_End": 3045.94, "Text": " Thank you."}, {"Time_Start": 3073.94, "Time_End": 3075.94, "Text": " Thank you."}, {"Time_Start": 3103.94, "Time_End": 3105.94, "Text": " Thank you."}, {"Time_Start": 3133.94, "Time_End": 3135.94, "Text": " Thank you."}, {"Time_Start": 3163.94, "Time_End": 3165.94, "Text": " Thank you."}, {"Time_Start": 3193.94, "Time_End": 3195.94, "Text": " Thank you."}, {"Time_Start": 3223.94, "Time_End": 3225.94, "Text": " Thank you."}, {"Time_Start": 3253.94, "Time_End": 3255.94, "Text": " Thank you."}, {"Time_Start": 3283.94, "Time_End": 3285.94, "Text": " Thank you."}, {"Time_Start": 3313.94, "Time_End": 3315.94, "Text": " Thank you."}, {"Time_Start": 3343.94, "Time_End": 3345.94, "Text": " Thank you."}, {"Time_Start": 3373.94, "Time_End": 3375.94, "Text": " Thank you."}]