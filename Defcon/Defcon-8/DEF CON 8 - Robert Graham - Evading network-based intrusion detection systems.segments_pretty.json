{
  "segments": [
    {
      "Time_Start": 0.0,
      "Time_End": 18.080000000000002,
      "Text": "This text was transcribed using whisper model: large-v2\n\n Network ICE and the chief architect of Black Ice Intrusion Detection System."
    },
    {
      "Time_Start": 18.080000000000002,
      "Time_End": 24.080000000000002,
      "Text": " And what I'll be discussing today is some of our experiences of running IDS systems"
    },
    {
      "Time_Start": 24.080000000000002,
      "Time_End": 26.0,
      "Text": " in the battlefield."
    },
    {
      "Time_Start": 26.0,
      "Time_End": 31.82,
      "Text": " In particular, I'll be discussing how to evade or how people are evading intrusion"
    },
    {
      "Time_Start": 31.82,
      "Time_End": 34.34,
      "Text": " detection systems."
    },
    {
      "Time_Start": 34.34,
      "Time_End": 40.28,
      "Text": " And then I'll be introducing some new methods that we've been working on that allow hackers"
    },
    {
      "Time_Start": 40.28,
      "Time_End": 46.24,
      "Text": " to implement new methods of evading intrusion detection systems."
    },
    {
      "Time_Start": 46.24,
      "Time_End": 50.0,
      "Text": " To start with, I'm going to talk a little bit about the background and the surrounding"
    },
    {
      "Time_Start": 50.0,
      "Time_End": 54.0,
      "Text": " areas of intrusion detection systems and how this applies."
    },
    {
      "Time_Start": 54.0,
      "Time_End": 59.0,
      "Text": " It's basically marketing drivel, but you'll have to bear with me for a moment."
    },
    {
      "Time_Start": 59.0,
      "Time_End": 65.04,
      "Text": " IDS systems are sort of like weaponry in the war against hackers, but they're kind of like"
    },
    {
      "Time_Start": 65.04,
      "Time_End": 66.04,
      "Text": " flaky weaponry."
    },
    {
      "Time_Start": 66.04,
      "Time_End": 70.4,
      "Text": " It's kind of like a tank that you might take out to a battlefield and an enemy soldier"
    },
    {
      "Time_Start": 70.4,
      "Time_End": 75.24000000000001,
      "Text": " walks up behind it, aims a gun at it, and the tank explodes."
    },
    {
      "Time_Start": 75.24000000000001,
      "Time_End": 81.64,
      "Text": " This is like in the movie Kelly's Heroes from 1968, where Donald Sutherland plays Oddball,"
    },
    {
      "Time_Start": 81.64,
      "Time_End": 87.72,
      "Text": " who gets behind a German Panzer tank and aims a small little missile at it, and poof,"
    },
    {
      "Time_Start": 87.72,
      "Time_End": 88.72,
      "Text": " the tank blows up."
    },
    {
      "Time_Start": 88.72,
      "Time_End": 93.88,
      "Text": " And the way he was able to do this was by a foot soldier running around behind the tank"
    },
    {
      "Time_Start": 93.88,
      "Time_End": 96.88,
      "Text": " rather than the frontal assault where all the armor is."
    },
    {
      "Time_Start": 96.88,
      "Time_End": 101.92,
      "Text": " Now, of course, all tanks can be blown up, the only question is whether you do it with"
    },
    {
      "Time_Start": 101.92,
      "Time_End": 106.16,
      "Text": " a nuke or howitzer or with a handgun."
    },
    {
      "Time_Start": 106.67999999999999,
      "Time_End": 113.6,
      "Text": " IDSs are a lot like radar systems that trigger on the passing flight of flocks of birds and"
    },
    {
      "Time_Start": 113.6,
      "Time_End": 120.8,
      "Text": " automatically launch missiles at them, while at the same time not detecting enemy fighter"
    },
    {
      "Time_Start": 120.8,
      "Time_End": 126.16,
      "Text": " planes that are bearing down on you."
    },
    {
      "Time_Start": 126.16,
      "Time_End": 134.4,
      "Text": " During the Iran-Iraq war, the Iraqi, not the Iran-Iraq war, the Gulf War, Desert Storm,"
    },
    {
      "Time_Start": 134.4,
      "Time_End": 139.08,
      "Text": " the Iraqi soldiers were famous for throwing down their weapons and running away."
    },
    {
      "Time_Start": 139.08,
      "Time_End": 147.6,
      "Text": " This was their primary battle strategy."
    },
    {
      "Time_Start": 147.6,
      "Time_End": 152.6,
      "Text": " So these analogies in the weaponry in the war against hackers, IDS systems are a lot"
    },
    {
      "Time_Start": 152.6,
      "Time_End": 154.76,
      "Text": " like this."
    },
    {
      "Time_Start": 154.76,
      "Time_End": 156.28,
      "Text": " They work well in the laboratory."
    },
    {
      "Time_Start": 156.28,
      "Time_End": 161.4,
      "Text": " I can bring my IDS system in, I can run an exploit script that can say, see, my IDS catches"
    },
    {
      "Time_Start": 161.4,
      "Time_End": 162.4,
      "Text": " this attack."
    },
    {
      "Time_Start": 163.4,
      "Time_End": 167.44,
      "Text": " But when you put them into the real world, into the battle conditions, they start to"
    },
    {
      "Time_Start": 167.44,
      "Time_End": 168.44,
      "Text": " fail."
    },
    {
      "Time_Start": 168.44,
      "Time_End": 172.16,
      "Text": " They start to flee the battlefield, they blow up from behind, they trigger on the passing"
    },
    {
      "Time_Start": 172.16,
      "Time_End": 174.36,
      "Text": " flights of birds."
    },
    {
      "Time_Start": 174.36,
      "Time_End": 179.92000000000002,
      "Text": " Now here's the blatant marketing pitch."
    },
    {
      "Time_Start": 179.92000000000002,
      "Time_End": 187.48000000000002,
      "Text": " Network ICE right now, we estimate, is the market leader in intrusion detection system."
    },
    {
      "Time_Start": 187.48,
      "Time_End": 193.44,
      "Text": " We're only like number five in terms of monetary value or whatever from 1999 according to Internet"
    },
    {
      "Time_Start": 193.44,
      "Time_End": 194.44,
      "Text": " Week."
    },
    {
      "Time_Start": 194.44,
      "Time_End": 198.6,
      "Text": " But we believe that more traffic is being monitored by Black Ice than any other intrusion"
    },
    {
      "Time_Start": 198.6,
      "Time_End": 200.92,
      "Text": " detection system."
    },
    {
      "Time_Start": 200.92,
      "Time_End": 206.79999999999998,
      "Text": " And this is partially because we run on lots of ISP backbones and high-end websites because"
    },
    {
      "Time_Start": 206.79999999999998,
      "Time_End": 209.48,
      "Text": " we can keep up with the traffic where a lot of others fail."
    },
    {
      "Time_Start": 209.48,
      "Time_End": 214.04,
      "Text": " But it's also because we've got it running on two million desktops."
    },
    {
      "Time_Start": 214.04,
      "Time_End": 215.04,
      "Text": " We have two versions."
    },
    {
      "Time_Start": 215.04,
      "Time_End": 220.04,
      "Text": " We've got Black Ice Defender, which is a personal IDS that runs on a desktop computer."
    },
    {
      "Time_Start": 220.04,
      "Time_End": 224.56,
      "Text": " And then Black Ice Sentry, which is a traditional network-based intrusion detection system like"
    },
    {
      "Time_Start": 224.56,
      "Time_End": 230.23999999999998,
      "Text": " Snort or RealSecure or NetRanger and so forth."
    },
    {
      "Time_Start": 230.23999999999998,
      "Time_End": 239.48,
      "Text": " And in the competitions products, first of all, the exploit signatures are not as extensive"
    },
    {
      "Time_Start": 239.48,
      "Time_End": 241.28,
      "Text": " as they would have you believe."
    },
    {
      "Time_Start": 241.28,
      "Time_End": 245.2,
      "Text": " There's lots of decodes that just sort of say, well, somebody logged in and that's about"
    },
    {
      "Time_Start": 245.2,
      "Time_End": 246.2,
      "Text": " it."
    },
    {
      "Time_Start": 246.2,
      "Time_End": 248.0,
      "Text": " There are lots of port numbers they trigger on."
    },
    {
      "Time_Start": 248.0,
      "Time_End": 250.88,
      "Text": " There's lots of CGI strings you just add one right after the other."
    },
    {
      "Time_Start": 250.88,
      "Time_End": 255.12,
      "Text": " When you get beyond all that and really hunt down the exploit signatures they have, they're"
    },
    {
      "Time_Start": 255.12,
      "Time_End": 257.52,
      "Text": " not nearly as extensive as you would think."
    },
    {
      "Time_Start": 257.52,
      "Time_End": 262.68,
      "Text": " Even ours, if you go through our list, you'll see lots of CGI programs, lots of ports."
    },
    {
      "Time_Start": 262.68,
      "Time_End": 266.44,
      "Text": " Though we do have lots of other good exploit signatures."
    },
    {
      "Time_Start": 266.44,
      "Time_End": 272.71999999999997,
      "Text": " Defeating technologies are easily evaded by really commonly available programs."
    },
    {
      "Time_Start": 272.71999999999997,
      "Time_End": 275.96,
      "Text": " These aren't really uber-hacker programs."
    },
    {
      "Time_Start": 275.96,
      "Time_End": 281.4,
      "Text": " They're things you can download, configure, and run, like FragRider, Whisker, and other"
    },
    {
      "Time_Start": 281.4,
      "Time_End": 282.4,
      "Text": " stuff."
    },
    {
      "Time_Start": 282.4,
      "Time_End": 286.96,
      "Text": " I'll also be introducing some new techniques that really will put them in knots."
    },
    {
      "Time_Start": 286.96,
      "Time_End": 291.52,
      "Text": " And they also die pretty gruesomely under heavy load or complex traffic."
    },
    {
      "Time_Start": 291.59999999999997,
      "Time_End": 297.79999999999995,
      "Text": " I always like to say that they'll easily flee the field of battle like Iraqi soldiers."
    },
    {
      "Time_Start": 297.79999999999995,
      "Time_End": 301.35999999999996,
      "Text": " To start my talk of the technical side of things now, now that I'm done with the marketing"
    },
    {
      "Time_Start": 301.35999999999996,
      "Time_End": 302.35999999999996,
      "Text": " stuff."
    },
    {
      "Time_Start": 302.35999999999996,
      "Time_End": 306.03999999999996,
      "Text": " You see the marketing department pays for my flight out here in my hotel so I have to"
    },
    {
      "Time_Start": 306.03999999999996,
      "Time_End": 310.71999999999997,
      "Text": " sort of throw them a bone here."
    },
    {
      "Time_Start": 310.71999999999997,
      "Time_End": 313.71999999999997,
      "Text": " What is a network IDS?"
    },
    {
      "Time_Start": 313.71999999999997,
      "Time_End": 314.71999999999997,
      "Text": " Fundamentally it's shown in this little diagram."
    },
    {
      "Time_Start": 314.71999999999997,
      "Time_End": 319.47999999999996,
      "Text": " You have a hacker and he wants to break into your website or behind your website into your"
    },
    {
      "Time_Start": 319.47999999999996,
      "Time_End": 320.47999999999996,
      "Text": " corporation."
    },
    {
      "Time_Start": 320.48,
      "Time_End": 325.48,
      "Text": " Your external presence is the web server, the FTP server, your name server, your mail"
    },
    {
      "Time_Start": 325.48,
      "Time_End": 328.0,
      "Text": " exchanger."
    },
    {
      "Time_Start": 328.0,
      "Time_End": 334.56,
      "Text": " The network IDS will monitor the network traffic looking for signs of intrusions against your"
    },
    {
      "Time_Start": 334.56,
      "Time_End": 335.56,
      "Text": " computers."
    },
    {
      "Time_Start": 335.56,
      "Time_End": 340.6,
      "Text": " Hopefully it will tip you off that someone is actively attacking you and if they break"
    },
    {
      "Time_Start": 340.6,
      "Time_End": 345.64000000000004,
      "Text": " in it will tell you how they did it."
    },
    {
      "Time_Start": 345.64,
      "Time_End": 354.64,
      "Text": " However, a network intrusion detection system."
    },
    {
      "Time_Start": 354.64,
      "Time_End": 356.64,
      "Text": " Is there a Sean Hedges in the room?"
    },
    {
      "Time_Start": 356.64,
      "Time_End": 359.64,
      "Text": " Some of you might know this already."
    },
    {
      "Time_Start": 359.64,
      "Time_End": 360.64,
      "Text": " Okay, he's not."
    },
    {
      "Time_Start": 360.64,
      "Time_End": 361.64,
      "Text": " Thank you very much."
    },
    {
      "Time_Start": 361.64,
      "Time_End": 362.64,
      "Text": " He's lost."
    },
    {
      "Time_Start": 362.64,
      "Time_End": 366.88,
      "Text": " Yeah, the feds are looking for him."
    },
    {
      "Time_Start": 366.88,
      "Time_End": 375.15999999999997,
      "Text": " Is there a Sean Hedges?"
    },
    {
      "Time_Start": 375.68,
      "Time_End": 379.0,
      "Text": " So in the previous diagram I tried to emphasize the fact that network intrusion detection"
    },
    {
      "Time_Start": 379.0,
      "Time_End": 384.44,
      "Text": " systems detect that they're happening but don't necessarily protect you."
    },
    {
      "Time_Start": 384.44,
      "Time_End": 391.04,
      "Text": " They're sort of a early warning system and then a post forensic system."
    },
    {
      "Time_Start": 391.04,
      "Time_End": 397.68,
      "Text": " They're like a detective that doesn't witness the actual crime but tries to piece together"
    },
    {
      "Time_Start": 397.68,
      "Time_End": 398.68,
      "Text": " the clues afterwards."
    },
    {
      "Time_Start": 398.68,
      "Time_End": 403.8,
      "Text": " It's like the Columbo movies and television shows where he comes in 15 minutes after the"
    },
    {
      "Time_Start": 403.8,
      "Time_End": 408.88,
      "Text": " crime has happened and then he tries to, over the course of the show, pieces together"
    },
    {
      "Time_Start": 408.88,
      "Time_End": 412.8,
      "Text": " the clues until he figures out what happened."
    },
    {
      "Time_Start": 412.8,
      "Time_End": 416.92,
      "Text": " And hackers are really, really good at, at least really good hackers I should say, they're"
    },
    {
      "Time_Start": 416.92,
      "Time_End": 421.72,
      "Text": " really good at smudging these clues and hiding their fingerprints."
    },
    {
      "Time_Start": 421.72,
      "Time_End": 426.16,
      "Text": " So a network IDS system is like a detective or a sleuth and it really isn't like this"
    },
    {
      "Time_Start": 426.16,
      "Time_End": 430.6,
      "Text": " psychic system that sort of knows everything that happened and tells you exactly that you've"
    },
    {
      "Time_Start": 430.6,
      "Time_End": 433.04,
      "Text": " been broken into or not."
    },
    {
      "Time_Start": 433.04,
      "Time_End": 438.04,
      "Text": " They detect, it's not really a protection thing, it's an enhancement to your protection."
    },
    {
      "Time_Start": 438.04,
      "Time_End": 444.64000000000004,
      "Text": " Now I'm going to start talking about classic evasion techniques."
    },
    {
      "Time_Start": 444.64000000000004,
      "Time_End": 447.92,
      "Text": " The first one was written, I'm not quite sure when it was written, a year and a half ago,"
    },
    {
      "Time_Start": 447.92,
      "Time_End": 451.20000000000005,
      "Text": " two years ago, called Frag Router."
    },
    {
      "Time_Start": 451.20000000000005,
      "Time_End": 458.68,
      "Text": " It was written by a reseller of NFR to really, to really irk the market leaders like Cisco"
    },
    {
      "Time_Start": 458.68,
      "Time_End": 459.68,
      "Text": " and ISS."
    },
    {
      "Time_Start": 459.8,
      "Time_End": 463.8,
      "Text": " It's a very simple utility, you can download it, run it."
    },
    {
      "Time_Start": 463.8,
      "Time_End": 471.76,
      "Text": " It's, what it does is, as shown by the little two diagrams here, is it fragments the attack."
    },
    {
      "Time_Start": 471.76,
      "Time_End": 475.84000000000003,
      "Text": " Most IDS systems bring in a packet, look for a signature and then say, well, is it a sign"
    },
    {
      "Time_Start": 475.84000000000003,
      "Time_End": 478.24,
      "Text": " of intrusion?"
    },
    {
      "Time_Start": 478.24,
      "Time_End": 481.8,
      "Text": " A common intrusion is the PHF attack."
    },
    {
      "Time_Start": 481.8,
      "Time_End": 486.2,
      "Text": " It's the one that we all use now as the sort of the standard one that we, when we describe"
    },
    {
      "Time_Start": 486.2,
      "Time_End": 487.48,
      "Text": " signatures."
    },
    {
      "Time_Start": 487.48,
      "Time_End": 493.6,
      "Text": " What Frag Router does is it fragments that across three different packets."
    },
    {
      "Time_Start": 493.6,
      "Time_End": 497.52000000000004,
      "Text": " So none of the three packets now contain the signature CGI bin PHF."
    },
    {
      "Time_Start": 497.52000000000004,
      "Time_End": 503.20000000000005,
      "Text": " You see a little bit of the CGI bin and a little bit of the PHF in each packet but not"
    },
    {
      "Time_Start": 503.20000000000005,
      "Time_End": 504.88,
      "Text": " the whole signature."
    },
    {
      "Time_Start": 504.88,
      "Time_End": 509.52000000000004,
      "Text": " This causes the IDS system to be completely silent."
    },
    {
      "Time_Start": 509.52000000000004,
      "Time_End": 512.4,
      "Text": " Frag Router also goes through a lot of firewalls."
    },
    {
      "Time_Start": 512.4,
      "Time_End": 517.04,
      "Text": " Most firewalls have a configuration option saying disallow fragments but it's frequently"
    },
    {
      "Time_Start": 517.04,
      "Time_End": 520.3199999999999,
      "Text": " not configured correctly."
    },
    {
      "Time_Start": 520.3199999999999,
      "Time_End": 524.3199999999999,
      "Text": " And since you can fragment packets so they can't get a good reading on the port number,"
    },
    {
      "Time_Start": 524.3199999999999,
      "Time_End": 528.28,
      "Text": " they'll allow the packets on through."
    },
    {
      "Time_Start": 528.28,
      "Time_End": 532.56,
      "Text": " Frag Router requires an extra machine."
    },
    {
      "Time_Start": 532.56,
      "Time_End": 538.36,
      "Text": " The hacker sets up this extra machine on his own side."
    },
    {
      "Time_Start": 538.36,
      "Time_End": 544.12,
      "Text": " He then passes all of the traffic on through and the Frag Router then automatically fragments"
    },
    {
      "Time_Start": 544.12,
      "Time_End": 545.12,
      "Text": " whatever it is."
    },
    {
      "Time_Start": 545.2,
      "Time_End": 553.12,
      "Text": " The IDS at the victim side can no longer detect the attack and is pretty much silent."
    },
    {
      "Time_Start": 553.12,
      "Time_End": 557.8,
      "Text": " Some IDSs at least give a little bit of indication and will say I'm seeing an excessive number"
    },
    {
      "Time_Start": 557.8,
      "Time_End": 562.72,
      "Text": " of fragments but they have no visibility into what's really going on."
    },
    {
      "Time_Start": 562.72,
      "Time_End": 570.4,
      "Text": " Nmap, which is a common utility that pretty much is the first thing a hacker is going"
    },
    {
      "Time_Start": 570.4,
      "Time_End": 575.48,
      "Text": " to run against your site when they're attacking you, has a couple of stealth features."
    },
    {
      "Time_Start": 575.48,
      "Time_End": 581.4399999999999,
      "Text": " The first stealth feature of Nmap was this stealth scan or half open scan or SYN scan."
    },
    {
      "Time_Start": 581.4399999999999,
      "Time_End": 584.8,
      "Text": " And what it does is it doesn't complete the TCP connection."
    },
    {
      "Time_Start": 584.8,
      "Time_End": 587.04,
      "Text": " It starts it but doesn't complete it."
    },
    {
      "Time_Start": 587.04,
      "Time_End": 592.52,
      "Text": " And this evaded lots of host-based intrusion detection systems because they would only"
    },
    {
      "Time_Start": 592.52,
      "Time_End": 597.04,
      "Text": " start the logging process once the connection had completed."
    },
    {
      "Time_Start": 597.04,
      "Time_End": 600.92,
      "Text": " But from the network side of things, this doesn't evade network intrusion detection"
    },
    {
      "Time_Start": 600.92,
      "Time_End": 602.3199999999999,
      "Text": " systems at all."
    },
    {
      "Time_Start": 602.3199999999999,
      "Time_End": 603.8,
      "Text": " We see all the SYN packets."
    },
    {
      "Time_Start": 603.8,
      "Time_End": 607.8,
      "Text": " As a matter of fact, when we see lots of these connections not being completed, we actually"
    },
    {
      "Time_Start": 607.8,
      "Time_End": 612.04,
      "Text": " can tell that it's a stealth scan."
    },
    {
      "Time_Start": 612.04,
      "Time_End": 616.56,
      "Text": " But there are other stealth scan features of Nmap that do evade intrusion detection"
    },
    {
      "Time_Start": 616.56,
      "Time_End": 617.56,
      "Text": " systems."
    },
    {
      "Time_Start": 617.56,
      "Time_End": 620.16,
      "Text": " And that's again using the fragmentation technique."
    },
    {
      "Time_Start": 620.16,
      "Time_End": 625.0799999999999,
      "Text": " Is you fragment the SYN and then the IDS system can't put it together and figure out what"
    },
    {
      "Time_Start": 625.08,
      "Time_End": 629.84,
      "Text": " it is and doesn't know what it is and doesn't detect the SYN scan."
    },
    {
      "Time_Start": 629.84,
      "Time_End": 633.08,
      "Text": " And it evades some firewalls, evades some IDS systems."
    },
    {
      "Time_Start": 633.08,
      "Time_End": 638.84,
      "Text": " I recently tested one IDS from a vendor that claimed to support a reassembly but yet could"
    },
    {
      "Time_Start": 638.84,
      "Time_End": 645.96,
      "Text": " not detect the Nmap SYN scan, the fragmented one."
    },
    {
      "Time_Start": 645.96,
      "Time_End": 651.98,
      "Text": " Another classic evasion technique is to flood the IDS, to attack it itself."
    },
    {
      "Time_Start": 651.98,
      "Time_End": 658.4200000000001,
      "Text": " Lots of IDSs fail under these DDOS attacks, distributed denial of service attacks."
    },
    {
      "Time_Start": 658.4200000000001,
      "Time_End": 665.1,
      "Text": " I heard one vendor recently comment that they can do like 30,000 and even more packets per"
    },
    {
      "Time_Start": 665.1,
      "Time_End": 672.0600000000001,
      "Text": " second which is more than you'll ever see on normal networks, normal 100 megabit networks."
    },
    {
      "Time_Start": 672.0600000000001,
      "Time_End": 678.78,
      "Text": " But yet, they do fail still under 148,000 frames per second under heavy loads."
    },
    {
      "Time_Start": 678.78,
      "Time_End": 681.46,
      "Text": " And yes, they're not normal but that's what the hacker does."
    },
    {
      "Time_Start": 681.46,
      "Time_End": 684.02,
      "Text": " They create abnormal conditions."
    },
    {
      "Time_Start": 684.02,
      "Time_End": 687.82,
      "Text": " But for overflow isn't normal, it's abnormal."
    },
    {
      "Time_Start": 687.82,
      "Time_End": 693.22,
      "Text": " Vendors are designing for the normal case, not so much the exceptional case."
    },
    {
      "Time_Start": 693.22,
      "Time_End": 697.4200000000001,
      "Text": " Today's IDSs are built under the same assumptions that applications are built under which is"
    },
    {
      "Time_Start": 697.4200000000001,
      "Time_End": 701.98,
      "Text": " to say you're building for what normal people normally do for that 80% of what normally"
    },
    {
      "Time_Start": 701.98,
      "Time_End": 702.98,
      "Text": " happens."
    },
    {
      "Time_Start": 702.98,
      "Time_End": 708.6600000000001,
      "Text": " IDSs really need to be built for that 20% exceptional cases."
    },
    {
      "Time_Start": 708.66,
      "Time_End": 713.02,
      "Text": " And by the way, packets per second is often the more difficult thing that IDSs have to"
    },
    {
      "Time_Start": 713.02,
      "Time_End": 715.3399999999999,
      "Text": " handle rather than bits per second."
    },
    {
      "Time_Start": 715.3399999999999,
      "Time_End": 720.9,
      "Text": " Most IDSs can handle 100 megabits per second but they can't handle the fully loaded and"
    },
    {
      "Time_Start": 720.9,
      "Time_End": 724.78,
      "Text": " saturated network with lots of small packets."
    },
    {
      "Time_Start": 724.78,
      "Time_End": 731.14,
      "Text": " As a matter of fact, the maximum for 100 megabit networks is 148,800 packets per second."
    },
    {
      "Time_Start": 731.14,
      "Time_End": 736.02,
      "Text": " That's actually only about 66 megabits per second because of spacing between frames but"
    },
    {
      "Time_Start": 736.02,
      "Time_End": 740.1,
      "Text": " it'll kill most IDSs."
    },
    {
      "Time_Start": 740.1,
      "Time_End": 742.5799999999999,
      "Text": " And when they fail, they fail really hard."
    },
    {
      "Time_Start": 742.5799999999999,
      "Time_End": 746.14,
      "Text": " I show three graphs here of three possibilities."
    },
    {
      "Time_Start": 746.14,
      "Time_End": 753.62,
      "Text": " Let's say that the number 100 represents the maximum that you can put across that wire."
    },
    {
      "Time_Start": 753.62,
      "Time_End": 757.9,
      "Text": " And maybe the IDS fails at about 75%."
    },
    {
      "Time_Start": 757.9,
      "Time_End": 762.78,
      "Text": " Well IDS number 1 in this diagram shows that the IDS basically processes 75% of the traffic"
    },
    {
      "Time_Start": 762.78,
      "Time_End": 767.18,
      "Text": " and drops the other 25% no matter what that traffic is."
    },
    {
      "Time_Start": 767.18,
      "Time_End": 771.54,
      "Text": " But what really happens is that IDSs start to degrade."
    },
    {
      "Time_Start": 771.54,
      "Time_End": 777.1,
      "Text": " So you pump, the more traffic you pump in, the fewer that's actually processing over"
    },
    {
      "Time_Start": 777.1,
      "Time_End": 778.1,
      "Text": " time."
    },
    {
      "Time_Start": 778.1,
      "Time_End": 781.18,
      "Text": " So you pump in 75, it processes 75."
    },
    {
      "Time_Start": 781.18,
      "Time_End": 783.54,
      "Text": " You pump in 80, it now processes 70."
    },
    {
      "Time_Start": 783.54,
      "Time_End": 787.5,
      "Text": " You pump in 90, now it processes 60."
    },
    {
      "Time_Start": 787.5,
      "Time_End": 791.06,
      "Text": " In reality, they really act like IDS number 3."
    },
    {
      "Time_Start": 791.3000000000001,
      "Time_End": 795.3800000000001,
      "Text": " Soon after they reach their limit, they start failing really, really fast."
    },
    {
      "Time_Start": 795.3800000000001,
      "Time_End": 800.4200000000001,
      "Text": " A lot of them, when you do pump in that full 148,000 frames per second, they actually detect"
    },
    {
      "Time_Start": 800.4200000000001,
      "Time_End": 801.4200000000001,
      "Text": " zero frames."
    },
    {
      "Time_Start": 801.4200000000001,
      "Time_End": 809.3800000000001,
      "Text": " And I've run that test against a couple of competitors and that's indeed what they do."
    },
    {
      "Time_Start": 809.3800000000001,
      "Time_End": 812.3000000000001,
      "Text": " Black ice can handle 148,000 frames per second."
    },
    {
      "Time_Start": 812.3000000000001,
      "Time_End": 818.34,
      "Text": " This little notebook is a 400 megahertz Pentium II and I've pumped 148,000 frames per second"
    },
    {
      "Time_Start": 818.34,
      "Time_End": 820.7800000000001,
      "Text": " at it with a little SmartBits tester."
    },
    {
      "Time_Start": 820.7800000000001,
      "Time_End": 825.0600000000001,
      "Text": " It's actually kind of cool."
    },
    {
      "Time_Start": 825.0600000000001,
      "Time_End": 829.6600000000001,
      "Text": " That's because the founders of NetworkICE, we come from the sniffer world."
    },
    {
      "Time_Start": 829.6600000000001,
      "Time_End": 832.3000000000001,
      "Text": " And this is the same diagram we would use to describe sniffers."
    },
    {
      "Time_Start": 832.3000000000001,
      "Time_End": 835.94,
      "Text": " We would look at our competitors and we would say they do the same thing."
    },
    {
      "Time_Start": 835.94,
      "Time_End": 839.38,
      "Text": " You pump in too much traffic and they go to zero."
    },
    {
      "Time_Start": 839.38,
      "Time_End": 843.6600000000001,
      "Text": " So Network General, we tried to do the same optimizations as try to optimize the system"
    },
    {
      "Time_Start": 843.6600000000001,
      "Time_End": 847.86,
      "Text": " to at least fail gracefully when it's going to fail."
    },
    {
      "Time_Start": 847.86,
      "Time_End": 853.14,
      "Text": " Network General started with sniffers on 286s, so on 10 megabit networks."
    },
    {
      "Time_Start": 853.14,
      "Time_End": 857.58,
      "Text": " The engineer that wrote the drivers for the 286 on 10 megabits is the one who wrote the"
    },
    {
      "Time_Start": 857.58,
      "Time_End": 864.82,
      "Text": " drivers for 100 megabits at NetworkICE."
    },
    {
      "Time_Start": 864.82,
      "Time_End": 868.74,
      "Text": " So how can you generate that if you're a hacker and you want to flood the system?"
    },
    {
      "Time_Start": 868.74,
      "Time_End": 873.74,
      "Text": " A lot of DDOS attacks will work if you're trying to attack Yahoo or eBay or E-Trade"
    },
    {
      "Time_Start": 873.74,
      "Time_End": 877.5,
      "Text": " or all these other major websites and they've got really fast links."
    },
    {
      "Time_Start": 877.5,
      "Time_End": 878.5,
      "Text": " They've got gigabit links."
    },
    {
      "Time_Start": 878.5,
      "Time_End": 879.5,
      "Text": " How are you going to flood them?"
    },
    {
      "Time_Start": 879.5,
      "Time_End": 884.02,
      "Text": " Well, one easy way is with a smurf or a fraggle attack."
    },
    {
      "Time_Start": 884.02,
      "Time_End": 887.54,
      "Text": " My home network, I'm running off of DSL and I see this a lot."
    },
    {
      "Time_Start": 887.54,
      "Time_End": 893.42,
      "Text": " I see lots of people trying to use my whole area around my home to do these attacks."
    },
    {
      "Time_Start": 893.42,
      "Time_End": 899.22,
      "Text": " The way they work is the hacker sends in a ping to the broadcast address for my whole"
    },
    {
      "Time_Start": 899.22,
      "Time_End": 900.5,
      "Text": " area."
    },
    {
      "Time_Start": 900.5,
      "Time_End": 905.66,
      "Text": " The router then splits that out essentially and sends a ping to everybody in that subnet."
    },
    {
      "Time_Start": 905.66,
      "Time_End": 911.42,
      "Text": " Well by spoofing the IP address of the victim, everyone in that subnet responds to that victim."
    },
    {
      "Time_Start": 911.42,
      "Time_End": 915.46,
      "Text": " So even though the hacker has maybe a dial-up line, they can do some pretty severe damage"
    },
    {
      "Time_Start": 915.46,
      "Time_End": 917.26,
      "Text": " against a victim that's got a gigabit line."
    },
    {
      "Time_Start": 917.26,
      "Time_End": 920.14,
      "Text": " That's what they do on my home network."
    },
    {
      "Time_Start": 920.14,
      "Time_End": 926.42,
      "Text": " My machine, of course, doesn't respond to these pings or to the UDP echoes, but I see"
    },
    {
      "Time_Start": 926.4200000000001,
      "Time_End": 931.3800000000001,
      "Text": " the attempts."
    },
    {
      "Time_Start": 931.3800000000001,
      "Time_End": 938.46,
      "Text": " Now let's say that the victim only has a T1 line and the IDS is behind it on 100 megabit."
    },
    {
      "Time_Start": 938.46,
      "Time_End": 942.5000000000001,
      "Text": " Well you're not going to be able to overflow, you can overflow the T1 line but the IDS itself"
    },
    {
      "Time_Start": 942.5000000000001,
      "Time_End": 947.7400000000001,
      "Text": " will not be overflowed because it's still only processing 1.5 megabits per second."
    },
    {
      "Time_Start": 947.7400000000001,
      "Time_End": 954.7400000000001,
      "Text": " But you can do a lot of internal smurfs that you send the smurf inside through to the corporation"
    },
    {
      "Time_Start": 955.5,
      "Time_End": 958.82,
      "Text": " and the corporation basically smurfs itself and the IDS overloads now on a 100 megabit"
    },
    {
      "Time_Start": 958.82,
      "Time_End": 963.46,
      "Text": " network."
    },
    {
      "Time_Start": 963.46,
      "Time_End": 965.1800000000001,
      "Text": " A similar technique is jamming."
    },
    {
      "Time_Start": 965.1800000000001,
      "Time_End": 967.74,
      "Text": " This is like radar jamming."
    },
    {
      "Time_Start": 967.74,
      "Time_End": 971.46,
      "Text": " Back in World War II and World War I when radars were first developed, they equally"
    },
    {
      "Time_Start": 971.46,
      "Time_End": 976.98,
      "Text": " developed lots of techniques against radars and the easiest way was to jam the radar."
    },
    {
      "Time_Start": 976.98,
      "Time_End": 980.26,
      "Text": " Flood it with electronic signals it didn't know how to handle or too much signal and"
    },
    {
      "Time_Start": 980.26,
      "Time_End": 983.44,
      "Text": " it would basically die."
    },
    {
      "Time_Start": 983.44,
      "Time_End": 986.4000000000001,
      "Text": " You can do this against a lot of IDSs from a dial-up line."
    },
    {
      "Time_Start": 986.4000000000001,
      "Time_End": 991.6400000000001,
      "Text": " You run attacks that generate lots and lots of frames with lots and lots of signatures."
    },
    {
      "Time_Start": 991.6400000000001,
      "Time_End": 998.6400000000001,
      "Text": " The IDSs attempt to be really robust and try to log each and every attack."
    },
    {
      "Time_Start": 998.6400000000001,
      "Time_End": 1004.1600000000001,
      "Text": " So you do a decoy scan which spoofs your IP address or run target which spoofs most of"
    },
    {
      "Time_Start": 1004.1600000000001,
      "Time_End": 1010.1600000000001,
      "Text": " its attacks IP addresses and you just keep running it on your dial-up line."
    },
    {
      "Time_Start": 1010.16,
      "Time_End": 1014.56,
      "Text": " Eventually the database will fill up with all these events and keel over."
    },
    {
      "Time_Start": 1014.56,
      "Time_End": 1021.92,
      "Text": " A lot of vendors use access databases which keel over really, really easily."
    },
    {
      "Time_Start": 1021.92,
      "Time_End": 1031.1599999999999,
      "Text": " We use, we allow access but we recommend other databases, real databases."
    },
    {
      "Time_Start": 1031.1599999999999,
      "Time_End": 1034.48,
      "Text": " One of our vendors has an interesting message that I've found that every single customer"
    },
    {
      "Time_Start": 1034.48,
      "Time_End": 1038.68,
      "Text": " that uses this vendor product that I've ever talked to is familiar with this error message"
    },
    {
      "Time_Start": 1038.68,
      "Time_End": 1041.0,
      "Text": " which is DB high watermark reached."
    },
    {
      "Time_Start": 1041.0,
      "Time_End": 1044.16,
      "Text": " There's also a queue overflow message."
    },
    {
      "Time_Start": 1044.16,
      "Time_End": 1047.52,
      "Text": " And they all are familiar with this message because they get it and they have to go in"
    },
    {
      "Time_Start": 1047.52,
      "Time_End": 1049.52,
      "Text": " and start cleaning out their database."
    },
    {
      "Time_Start": 1049.52,
      "Time_End": 1056.92,
      "Text": " This is one of the ways that they flee from the field of battle."
    },
    {
      "Time_Start": 1056.92,
      "Time_End": 1060.88,
      "Text": " Another classic evasion technique is Rainforest Puppy's Whisker."
    },
    {
      "Time_Start": 1060.88,
      "Time_End": 1065.1200000000001,
      "Text": " It changes the signature of how the attack appears on the wire but doesn't change its"
    },
    {
      "Time_Start": 1065.1200000000001,
      "Time_End": 1068.1200000000001,
      "Text": " meaning."
    },
    {
      "Time_Start": 1068.1200000000001,
      "Time_End": 1070.92,
      "Text": " And here's an example of all of these attacks are the same."
    },
    {
      "Time_Start": 1070.92,
      "Time_End": 1075.5200000000002,
      "Text": " They all mean the first one which is CGI bin PHF."
    },
    {
      "Time_Start": 1075.5200000000002,
      "Time_End": 1077.5200000000002,
      "Text": " And it changes this pattern."
    },
    {
      "Time_Start": 1077.5200000000002,
      "Time_End": 1082.3600000000001,
      "Text": " One way is to use the head command rather than the get command."
    },
    {
      "Time_Start": 1082.3600000000001,
      "Time_End": 1085.64,
      "Text": " It doesn't get the full file but we'll test to see if it's there and can often do a lot"
    },
    {
      "Time_Start": 1085.64,
      "Time_End": 1087.96,
      "Text": " of buffer overflow exploits with it."
    },
    {
      "Time_Start": 1087.96,
      "Time_End": 1093.72,
      "Text": " You can URL encode the characters so like percent 63 is a C."
    },
    {
      "Time_Start": 1093.72,
      "Time_End": 1098.08,
      "Text": " You can append some extra slashes which a lot of web servers just strip out to meaning"
    },
    {
      "Time_Start": 1098.08,
      "Time_End": 1099.82,
      "Text": " one slash."
    },
    {
      "Time_Start": 1099.82,
      "Time_End": 1104.04,
      "Text": " You can go descend directories and pop back up again with a dot dot."
    },
    {
      "Time_Start": 1104.04,
      "Time_End": 1108.48,
      "Text": " So a foobar slash dot dot means the same as nothing."
    },
    {
      "Time_Start": 1108.48,
      "Time_End": 1112.2,
      "Text": " You can put a slash and a dot in the middle of it or a string of these as many as you"
    },
    {
      "Time_Start": 1112.2,
      "Time_End": 1115.1200000000001,
      "Text": " want and all they really mean is the same directory."
    },
    {
      "Time_Start": 1115.1200000000001,
      "Time_End": 1120.1200000000001,
      "Text": " So tells the web server go into CGI bin then go into the same directory and if you repeat"
    },
    {
      "Time_Start": 1120.1200000000001,
      "Time_End": 1125.88,
      "Text": " them it's going to same directory, same directory, same directory and then execute PHF."
    },
    {
      "Time_Start": 1125.88,
      "Time_End": 1130.0800000000002,
      "Text": " Another one takes advantage, I believe this is Windows, of putting the percent 00 which"
    },
    {
      "Time_Start": 1130.0800000000002,
      "Time_End": 1132.0400000000002,
      "Text": " encodes a null string."
    },
    {
      "Time_Start": 1132.0400000000002,
      "Time_End": 1138.48,
      "Text": " If the HTTP server is doing string copies, it will fail to copy the rest of the string"
    },
    {
      "Time_Start": 1138.48,
      "Time_End": 1144.48,
      "Text": " or if the web server doesn't do that and doesn't do the string copy, it gets the entire string"
    },
    {
      "Time_Start": 1144.48,
      "Time_End": 1148.8000000000002,
      "Text": " but if you do a string copy on the IDS, it will fail to get the entire string and the"
    },
    {
      "Time_Start": 1148.8,
      "Time_End": 1151.6399999999999,
      "Text": " rest of it is ignored."
    },
    {
      "Time_Start": 1151.6399999999999,
      "Time_End": 1157.6399999999999,
      "Text": " When RFP released this, he released his original whisker scanner with just the head command"
    },
    {
      "Time_Start": 1157.6399999999999,
      "Time_End": 1162.72,
      "Text": " as being the IDS evasion technique and then a few months later, I'm not quite sure how"
    },
    {
      "Time_Start": 1162.72,
      "Time_End": 1170.36,
      "Text": " long later, he released the next version that had ten of these style of IDS evasion techniques."
    },
    {
      "Time_Start": 1170.36,
      "Time_End": 1173.44,
      "Text": " Most of them would only work on specific web servers."
    },
    {
      "Time_Start": 1173.44,
      "Time_End": 1177.1599999999999,
      "Text": " These other ones listed here are pretty much generic."
    },
    {
      "Time_Start": 1177.16,
      "Time_End": 1182.8000000000002,
      "Text": " I pull out just the head and the two of these are sort of off to the side because those"
    },
    {
      "Time_Start": 1182.8000000000002,
      "Time_End": 1185.52,
      "Text": " are the ones that affected Black Ice."
    },
    {
      "Time_Start": 1185.52,
      "Time_End": 1189.3200000000002,
      "Text": " I was kind of ticked off on this first release because it immediately evaded us and I had"
    },
    {
      "Time_Start": 1189.3200000000002,
      "Time_End": 1193.5800000000002,
      "Text": " to go in and fix the head and re-release, you know, release a patch but then I went"
    },
    {
      "Time_Start": 1193.5800000000002,
      "Time_End": 1196.3600000000001,
      "Text": " through and tried to figure out everything else he might be adding because he claims"
    },
    {
      "Time_Start": 1196.3600000000001,
      "Time_End": 1200.52,
      "Text": " he's going to add some more IDS evasion techniques and I figured out nine of them but I didn't"
    },
    {
      "Time_Start": 1200.52,
      "Time_End": 1206.6000000000001,
      "Text": " quite catch the tenth one and the cool thing is we release patches to our product very"
    },
    {
      "Time_Start": 1206.6000000000001,
      "Time_End": 1210.7600000000002,
      "Text": " quickly after our whisker was released, both versions."
    },
    {
      "Time_Start": 1210.7600000000002,
      "Time_End": 1215.44,
      "Text": " A lot of vendors today still can't catch these or at least catch all of them, especially"
    },
    {
      "Time_Start": 1215.44,
      "Time_End": 1224.0800000000002,
      "Text": " if you combine multiple techniques like encoding in URL encoding and then add the dot directory,"
    },
    {
      "Time_Start": 1224.0800000000002,
      "Time_End": 1228.2400000000002,
      "Text": " self-referencing directories."
    },
    {
      "Time_Start": 1228.2400000000002,
      "Time_End": 1230.4,
      "Text": " Now whisker is just a CGI scanner."
    },
    {
      "Time_Start": 1230.4,
      "Time_End": 1234.2,
      "Text": " It scans a website and looks for a few hundred possible scripts that the website might be"
    },
    {
      "Time_Start": 1234.2,
      "Time_End": 1235.44,
      "Text": " running."
    },
    {
      "Time_Start": 1235.44,
      "Time_End": 1238.3200000000002,
      "Text": " If you're a script kiddie and you want to break into a website, the first thing you're"
    },
    {
      "Time_Start": 1238.3200000000002,
      "Time_End": 1244.24,
      "Text": " going to do is run whisker on it, find out it's got one CGI, one of the hundreds of CGI"
    },
    {
      "Time_Start": 1244.24,
      "Time_End": 1248.72,
      "Text": " programs vulnerable, then you'll exploit that CGI program."
    },
    {
      "Time_Start": 1248.72,
      "Time_End": 1252.0,
      "Text": " When you do the exploit, you have to do the evasion yourself."
    },
    {
      "Time_Start": 1252.0,
      "Time_End": 1259.8400000000001,
      "Text": " Like in this case, I've shown how to access a website for the PHF and put the self-referencing"
    },
    {
      "Time_Start": 1259.8400000000001,
      "Time_End": 1264.44,
      "Text": " directory, a dot, and then to encode the dot with URL encoding, which comes out as a percent"
    },
    {
      "Time_Start": 1264.44,
      "Time_End": 1266.48,
      "Text": " two e."
    },
    {
      "Time_Start": 1266.48,
      "Time_End": 1270.96,
      "Text": " My website actually has a, what looks to be a PHF script on robertgraham.com, which is"
    },
    {
      "Time_Start": 1270.96,
      "Time_End": 1275.16,
      "Text": " my website, just so I have fun with hackers that try to access it."
    },
    {
      "Time_Start": 1275.16,
      "Time_End": 1278.88,
      "Text": " Actually, I do a lot of stuff on my website."
    },
    {
      "Time_Start": 1278.88,
      "Time_End": 1286.24,
      "Text": " If you scan around, you'll find lots of these little Easter eggs on it."
    },
    {
      "Time_Start": 1286.24,
      "Time_End": 1287.24,
      "Text": " Next classic evasion."
    },
    {
      "Time_Start": 1287.24,
      "Time_End": 1290.44,
      "Text": " Now I believe somebody yesterday discussed this."
    },
    {
      "Time_Start": 1290.44,
      "Time_End": 1294.52,
      "Text": " I wanted to go to it, but the room was filled and I couldn't ever get into it."
    },
    {
      "Time_Start": 1294.52,
      "Time_End": 1297.48,
      "Text": " To see how much of that's overlapping with this, it probably overlaps entirely."
    },
    {
      "Time_Start": 1297.48,
      "Time_End": 1305.0800000000002,
      "Text": " It probably showed a lot more techniques."
    },
    {
      "Time_Start": 1305.0800000000002,
      "Time_End": 1308.3200000000002,
      "Text": " Fed spying on us again."
    },
    {
      "Time_Start": 1308.3200000000002,
      "Time_End": 1312.2,
      "Text": " When you write a buffer overflow, one characteristic that you see for most of them is that they"
    },
    {
      "Time_Start": 1312.2,
      "Time_End": 1319.6000000000001,
      "Text": " have these fillers of NOOP codes to align where they want to jump into the code."
    },
    {
      "Time_Start": 1319.7600000000002,
      "Time_End": 1324.96,
      "Text": " For example, on the x86 architecture, the nine zero op code is a NOOP."
    },
    {
      "Time_Start": 1324.96,
      "Time_End": 1325.96,
      "Text": " It does nothing."
    },
    {
      "Time_Start": 1325.96,
      "Time_End": 1329.8400000000001,
      "Text": " A lot of CPUs have multiple NOOP codes."
    },
    {
      "Time_Start": 1329.8400000000001,
      "Time_End": 1336.2,
      "Text": " So simply by replacing the standard NOOP with a different NOOP, you can evade the signature"
    },
    {
      "Time_Start": 1336.2,
      "Time_End": 1337.88,
      "Text": " looking for NOOP codes."
    },
    {
      "Time_Start": 1337.88,
      "Time_End": 1342.16,
      "Text": " You can also fill it with normal ops, stuff that, you know, actually do things."
    },
    {
      "Time_Start": 1342.16,
      "Time_End": 1345.7600000000002,
      "Text": " If you're going to overwrite a register, your NOOP code could actually just be an increment"
    },
    {
      "Time_Start": 1345.76,
      "Time_End": 1348.76,
      "Text": " of the register you're about to overwrite later on."
    },
    {
      "Time_Start": 1348.76,
      "Time_End": 1354.4,
      "Text": " The x86 has lots of NOOPs, being a nice little CISC processor, it, you know, provides us"
    },
    {
      "Time_Start": 1354.4,
      "Time_End": 1360.04,
      "Text": " lots of complicated ways to do nothing."
    },
    {
      "Time_Start": 1360.04,
      "Time_End": 1365.4,
      "Text": " Now if you want to be truly evil, when you do that fill, most of these exploit scripts"
    },
    {
      "Time_Start": 1365.4,
      "Time_End": 1370.92,
      "Text": " start with a little fill of fill all the NOOPs, and like this little for loop here."
    },
    {
      "Time_Start": 1370.92,
      "Time_End": 1374.4,
      "Text": " If you want to be nasty, what you do is you create your little table of what you want"
    },
    {
      "Time_Start": 1374.4,
      "Time_End": 1377.1200000000001,
      "Text": " to be your NOOP codes, and do a random lookup."
    },
    {
      "Time_Start": 1377.1200000000001,
      "Time_End": 1381.2800000000002,
      "Text": " So every time you run your script, you'll have a different signature on the wire."
    },
    {
      "Time_Start": 1381.2800000000002,
      "Time_End": 1386.0400000000002,
      "Text": " So even if I'm looking for certain patterns in NOOPs, it still won't work because there"
    },
    {
      "Time_Start": 1386.0400000000002,
      "Time_End": 1388.64,
      "Text": " are different patterns every single time."
    },
    {
      "Time_Start": 1388.64,
      "Time_End": 1393.6000000000001,
      "Text": " And the reason this affects network-based intrusion detection systems is that they're"
    },
    {
      "Time_Start": 1393.6000000000001,
      "Time_End": 1400.2,
      "Text": " mostly based upon the packet grep technology, which is bring in a packet, look for a pattern."
    },
    {
      "Time_Start": 1400.2,
      "Time_End": 1406.0800000000002,
      "Text": " The alternative technology that I know at least one company is using is protocol decoding."
    },
    {
      "Time_Start": 1406.0800000000002,
      "Time_End": 1410.52,
      "Text": " It doesn't really care about the exact pattern that you're using, what it cares about is"
    },
    {
      "Time_Start": 1410.52,
      "Time_End": 1412.76,
      "Text": " that you're doing something suspicious."
    },
    {
      "Time_Start": 1412.76,
      "Time_End": 1419.3600000000001,
      "Text": " In this case, if you're doing a buffer overflow attack against a POP3 server, rather than"
    },
    {
      "Time_Start": 1419.3600000000001,
      "Time_End": 1424.0,
      "Text": " looking for the actual overflow itself, you say, hey, he's just entered in a username"
    },
    {
      "Time_Start": 1424.0,
      "Time_End": 1428.2,
      "Text": " that's a thousand characters long, and it's got some binary in the username."
    },
    {
      "Time_Start": 1428.2,
      "Time_End": 1431.4,
      "Text": " This is something extremely suspicious."
    },
    {
      "Time_Start": 1431.4,
      "Time_End": 1436.64,
      "Text": " Now you can, you know, evade that actual pattern of buffer overflow all you want, but you still"
    },
    {
      "Time_Start": 1436.64,
      "Time_End": 1444.0800000000002,
      "Text": " detect the fact that you've got the suspiciously long username."
    },
    {
      "Time_Start": 1444.0800000000002,
      "Time_End": 1448.2,
      "Text": " As I mentioned before, a lot of these intrusion detection systems have a long list of ports"
    },
    {
      "Time_Start": 1448.2,
      "Time_End": 1455.8400000000001,
      "Text": " that are suspicious ports, like back-orifice is 31337, sub-7 uses two different ports,"
    },
    {
      "Time_Start": 1455.84,
      "Time_End": 1459.76,
      "Text": " but these things can run on any port."
    },
    {
      "Time_Start": 1459.76,
      "Time_End": 1466.1599999999999,
      "Text": " If you look on your firewall logs right now, you'll see lots of scans for port 27374 and"
    },
    {
      "Time_Start": 1466.1599999999999,
      "Time_End": 1472.1999999999998,
      "Text": " 1243, for the sub-7 Trojan horse, and you're seeing lots and lots and lots of these scans,"
    },
    {
      "Time_Start": 1472.1999999999998,
      "Time_End": 1475.9599999999998,
      "Text": " so you're thinking, I see so many of these scans, it must be that everyone's running"
    },
    {
      "Time_Start": 1475.9599999999998,
      "Time_End": 1483.1599999999999,
      "Text": " sub-7 on the default ports, but actually looking at our own, what we've seen on the net, is"
    },
    {
      "Time_Start": 1483.48,
      "Time_End": 1491.28,
      "Text": " that most successful compromisers are actually at non-default ports with non-default passwords."
    },
    {
      "Time_Start": 1491.28,
      "Time_End": 1495.24,
      "Text": " And we can see this sort of stuff because we run on some ISP backbones, and our customer"
    },
    {
      "Time_Start": 1495.24,
      "Time_End": 1499.3200000000002,
      "Text": " base actually sends us a large number of these files when our product detects the fact that"
    },
    {
      "Time_Start": 1499.3200000000002,
      "Time_End": 1502.8400000000001,
      "Text": " they've been exploited."
    },
    {
      "Time_Start": 1502.8400000000001,
      "Time_End": 1507.92,
      "Text": " So the real danger is, is that you've got these Trojan horses running on non-default"
    },
    {
      "Time_Start": 1507.92,
      "Time_End": 1512.1200000000001,
      "Text": " ports, and the default ports are just noise."
    },
    {
      "Time_Start": 1512.1200000000001,
      "Time_End": 1516.4,
      "Text": " And the reason they're so common is not because people are running at those ports, it's because"
    },
    {
      "Time_Start": 1516.4,
      "Time_End": 1520.7600000000002,
      "Text": " the scanner, the sub-7 itself contains a built-in scanner."
    },
    {
      "Time_Start": 1520.7600000000002,
      "Time_End": 1524.3600000000001,
      "Text": " I compromise one person, and the first thing I do is I tell that one person to scan the"
    },
    {
      "Time_Start": 1524.3600000000001,
      "Time_End": 1528.96,
      "Text": " whole internet looking for other possible victims."
    },
    {
      "Time_Start": 1528.96,
      "Time_End": 1533.72,
      "Text": " It rarely finds them, though, at the default ports."
    },
    {
      "Time_Start": 1533.72,
      "Time_End": 1540.16,
      "Text": " The way these Trojan infections work is that a hacker wants to get the Trojan on your computer."
    },
    {
      "Time_Start": 1540.2,
      "Time_End": 1544.8000000000002,
      "Text": " It might do so by posting to Usenet."
    },
    {
      "Time_Start": 1544.8000000000002,
      "Time_End": 1548.72,
      "Text": " Some victim, somewhere in the world, unrelated to the hacker, goes to Usenet group, says,"
    },
    {
      "Time_Start": 1548.72,
      "Time_End": 1553.5600000000002,
      "Text": " hey, this is a great new porn picture viewer or something, downloads the program, runs"
    },
    {
      "Time_Start": 1553.5600000000002,
      "Time_End": 1556.28,
      "Text": " it, and infects themselves."
    },
    {
      "Time_Start": 1556.28,
      "Time_End": 1560.6000000000001,
      "Text": " Now if it's running at a non-default port or a non-default password, one way that the"
    },
    {
      "Time_Start": 1560.6000000000001,
      "Time_End": 1565.64,
      "Text": " hacker can find who that is, is by telling the Trojan horse to notify them."
    },
    {
      "Time_Start": 1565.64,
      "Time_End": 1569.92,
      "Text": " Now you can't notify the hacker directly because then it's like a clear finger pointing for"
    },
    {
      "Time_Start": 1569.92,
      "Time_End": 1571.48,
      "Text": " the feds to follow."
    },
    {
      "Time_Start": 1571.48,
      "Time_End": 1576.88,
      "Text": " So instead, the hacker has to notify a third party, which can be done with email, IRC,"
    },
    {
      "Time_Start": 1576.88,
      "Time_End": 1580.0800000000002,
      "Text": " ICQ, or a number of other options."
    },
    {
      "Time_Start": 1580.0800000000002,
      "Time_End": 1583.96,
      "Text": " The hacker then logs on to that third party system and finds the victims that have all"
    },
    {
      "Time_Start": 1583.96,
      "Time_End": 1585.72,
      "Text": " notified themselves to him."
    },
    {
      "Time_Start": 1585.72,
      "Time_End": 1593.44,
      "Text": " At that point, he uses the password and port number to break into the victim's machine."
    },
    {
      "Time_Start": 1593.44,
      "Time_End": 1599.28,
      "Text": " This is the sub-7 edit server program, which sets all these values of how it's going to"
    },
    {
      "Time_Start": 1599.6399999999999,
      "Time_End": 1602.0,
      "Text": " actually compromise the person."
    },
    {
      "Time_Start": 1602.0,
      "Time_End": 1610.44,
      "Text": " You can see that it will notify via ICQ, via IRC, which IRC servers, email systems, and"
    },
    {
      "Time_Start": 1610.44,
      "Time_End": 1611.44,
      "Text": " so forth."
    },
    {
      "Time_Start": 1611.44,
      "Time_End": 1617.44,
      "Text": " One of the cool things it has is that it can use a random port on startup, which means"
    },
    {
      "Time_Start": 1617.44,
      "Time_End": 1621.52,
      "Text": " every time it runs, it's going to run at a different port, so that there's no amount"
    },
    {
      "Time_Start": 1621.52,
      "Time_End": 1624.8,
      "Text": " of scanning for ports that will ever find this system because it'll always run at some"
    },
    {
      "Time_Start": 1624.8,
      "Time_End": 1625.8,
      "Text": " other port."
    },
    {
      "Time_Start": 1625.8,
      "Time_End": 1631.96,
      "Text": " But yet, having an IRC notify will always tell the hacker exactly which port is currently"
    },
    {
      "Time_Start": 1631.96,
      "Time_End": 1632.96,
      "Text": " in use."
    },
    {
      "Time_Start": 1632.96,
      "Time_End": 1638.36,
      "Text": " So even if you're a user with a notebook computer maybe on the road dialing up, every time you"
    },
    {
      "Time_Start": 1638.36,
      "Time_End": 1644.44,
      "Text": " dial up, you notify the hacker where you are and he'll come find you."
    },
    {
      "Time_Start": 1644.44,
      "Time_End": 1648.96,
      "Text": " It's from our own evidence, it looks like the IRC is the most popular way for notifying"
    },
    {
      "Time_Start": 1648.96,
      "Time_End": 1654.2,
      "Text": " the hacker."
    },
    {
      "Time_Start": 1654.2,
      "Time_End": 1657.72,
      "Text": " So those are the standard evasion techniques that people are using today."
    },
    {
      "Time_Start": 1657.72,
      "Time_End": 1660.88,
      "Text": " They're very simple to use."
    },
    {
      "Time_Start": 1660.88,
      "Time_End": 1661.88,
      "Text": " It's not really too difficult."
    },
    {
      "Time_Start": 1661.88,
      "Time_End": 1667.76,
      "Text": " Now we get into some uber evasion techniques."
    },
    {
      "Time_Start": 1667.76,
      "Time_End": 1668.76,
      "Text": " First is the theory."
    },
    {
      "Time_Start": 1668.76,
      "Time_End": 1675.64,
      "Text": " As I mentioned before, packet-gripped systems are looking on the wire for patterns."
    },
    {
      "Time_Start": 1675.64,
      "Time_End": 1682.28,
      "Text": " Logically, according to the OSI model, that belongs in the presentation layer."
    },
    {
      "Time_Start": 1682.36,
      "Time_End": 1686.84,
      "Text": " The OSI model was this model developed back in the 80s, it's a very big bureaucratic process"
    },
    {
      "Time_Start": 1686.84,
      "Time_End": 1691.96,
      "Text": " and it's supposed to be the overall end-all of describing how technologies like this should"
    },
    {
      "Time_Start": 1691.96,
      "Time_End": 1692.96,
      "Text": " work."
    },
    {
      "Time_Start": 1692.96,
      "Time_End": 1696.32,
      "Text": " It tries to define, okay, layer one, you're worried about cabling, getting the bits across"
    },
    {
      "Time_Start": 1696.32,
      "Time_End": 1697.56,
      "Text": " the wire."
    },
    {
      "Time_Start": 1697.56,
      "Time_End": 1703.48,
      "Text": " Label two is getting two machines to actually talk and send data to each other and getting"
    },
    {
      "Time_Start": 1703.48,
      "Time_End": 1705.76,
      "Text": " frames, what they call, across the wire."
    },
    {
      "Time_Start": 1705.76,
      "Time_End": 1710.04,
      "Text": " Layer three is getting IP end-to-end across the entire internet done just locally."
    },
    {
      "Time_Start": 1710.8,
      "Time_End": 1714.32,
      "Text": " TCP is getting two applications to talk to each other."
    },
    {
      "Time_Start": 1714.32,
      "Time_End": 1717.08,
      "Text": " The session layer is this meaningless thing that everyone actually never turned out to"
    },
    {
      "Time_Start": 1717.08,
      "Time_End": 1720.28,
      "Text": " be worthwhile in practice and no one ever uses it."
    },
    {
      "Time_Start": 1720.28,
      "Time_End": 1725.76,
      "Text": " The presentation layer, by the way, there's lots of books about OSI model, and when you"
    },
    {
      "Time_Start": 1725.76,
      "Time_End": 1728.6,
      "Text": " look for the description of the session layer, it always comes down to two things."
    },
    {
      "Time_Start": 1728.6,
      "Time_End": 1730.6,
      "Text": " The session layer is something that manages sessions."
    },
    {
      "Time_Start": 1730.6,
      "Time_End": 1731.6,
      "Text": " Well, what's a session?"
    },
    {
      "Time_Start": 1731.6,
      "Time_End": 1735.48,
      "Text": " Well, it's one of these things that you get in the session layer."
    },
    {
      "Time_Start": 1735.48,
      "Time_End": 1739.76,
      "Text": " So I've looked, every time I find a new book on the OSI model, I look to see if they've"
    },
    {
      "Time_Start": 1739.76,
      "Time_End": 1742.96,
      "Text": " actually defined it anyway, it's not circular, I've never found one that does."
    },
    {
      "Time_Start": 1742.96,
      "Time_End": 1747.76,
      "Text": " Well, I found one a long time ago, and really the session layer came from these old teletype"
    },
    {
      "Time_Start": 1747.76,
      "Time_End": 1751.52,
      "Text": " terminal type things, and there are some concepts in there that never apply outside of that"
    },
    {
      "Time_Start": 1751.52,
      "Time_End": 1752.52,
      "Text": " environment."
    },
    {
      "Time_Start": 1752.52,
      "Time_End": 1758.4,
      "Text": " So then there's the presentation layer, and back in the OSI model, they wanted to negotiate"
    },
    {
      "Time_Start": 1758.4,
      "Time_End": 1762.56,
      "Text": " the presentation layer, but really lots of protocols have a presentation layer, even"
    },
    {
      "Time_Start": 1762.56,
      "Time_End": 1767.48,
      "Text": " though it's not really a separate entity, and all it's specifying is how data is formatted"
    },
    {
      "Time_Start": 1767.48,
      "Time_End": 1770.8,
      "Text": " across the network."
    },
    {
      "Time_Start": 1770.8,
      "Time_End": 1774.52,
      "Text": " For example, in SMTP, it might be the MIME encoding, sort of a presentation layer type"
    },
    {
      "Time_Start": 1774.52,
      "Time_End": 1775.52,
      "Text": " concept."
    },
    {
      "Time_Start": 1775.52,
      "Time_End": 1784.48,
      "Text": " And the application layer is the mail, the IRC, FTP, web, and so forth."
    },
    {
      "Time_Start": 1784.48,
      "Time_End": 1790.08,
      "Text": " RPC has a very distinctive presentation layer."
    },
    {
      "Time_Start": 1790.08,
      "Time_End": 1795.6399999999999,
      "Text": " One of the lesser known things about that layer is something called record marking,"
    },
    {
      "Time_Start": 1795.6399999999999,
      "Time_End": 1801.04,
      "Text": " is when you send RPC packets across a TCP connection, TCP creates this virtual byte"
    },
    {
      "Time_Start": 1801.04,
      "Time_End": 1807.48,
      "Text": " stream, so you must know when a command ends and begins, and so they do that with this"
    },
    {
      "Time_Start": 1807.48,
      "Time_End": 1809.6399999999999,
      "Text": " record marking code."
    },
    {
      "Time_Start": 1809.6399999999999,
      "Time_End": 1816.8799999999999,
      "Text": " Now lots of protocols do this, but what RPC has added to that whole mix is the ability"
    },
    {
      "Time_Start": 1816.8799999999999,
      "Time_End": 1818.84,
      "Text": " to fragment the records."
    },
    {
      "Time_Start": 1818.8400000000001,
      "Time_End": 1822.16,
      "Text": " But most protocols, when running over TCP, they have a length field, that's the first"
    },
    {
      "Time_Start": 1822.16,
      "Time_End": 1824.2800000000002,
      "Text": " field that says the length of the command."
    },
    {
      "Time_Start": 1824.2800000000002,
      "Time_End": 1827.92,
      "Text": " So even though TCP might segment it out into multiple packets, they know exactly how many"
    },
    {
      "Time_Start": 1827.92,
      "Time_End": 1830.2400000000002,
      "Text": " bytes are in that command."
    },
    {
      "Time_Start": 1830.2400000000002,
      "Time_End": 1837.0000000000002,
      "Text": " TCP adds something where you can send multiple of these length-encoded items that all then"
    },
    {
      "Time_Start": 1837.0000000000002,
      "Time_End": 1840.8400000000001,
      "Text": " combine back into the common original record."
    },
    {
      "Time_Start": 1840.8400000000001,
      "Time_End": 1848.64,
      "Text": " And the way that would work is, in this little diagram here, I have the normal record, which"
    },
    {
      "Time_Start": 1848.64,
      "Time_End": 1854.5600000000002,
      "Text": " is the RPC command in white, which is prefixed with a four byte length field."
    },
    {
      "Time_Start": 1854.5600000000002,
      "Time_End": 1862.3600000000001,
      "Text": " The top bit of that length field says whether there will be another, whether it's the last"
    },
    {
      "Time_Start": 1862.3600000000001,
      "Time_End": 1867.2800000000002,
      "Text": " fragment of this record, or whether more fragments follow across the TCP connection."
    },
    {
      "Time_Start": 1867.2800000000002,
      "Time_End": 1872.96,
      "Text": " So I split, in this case, in this diagram, that white command into two fragments, each"
    },
    {
      "Time_Start": 1872.96,
      "Time_End": 1875.6000000000001,
      "Text": " with its own record mark."
    },
    {
      "Time_Start": 1875.6000000000001,
      "Time_End": 1881.0400000000002,
      "Text": " The first one says that another record fragment follows, and the last one says that's the"
    },
    {
      "Time_Start": 1881.0400000000002,
      "Time_End": 1884.0400000000002,
      "Text": " last fragment in the whole stream."
    },
    {
      "Time_Start": 1884.0400000000002,
      "Time_End": 1893.6000000000001,
      "Text": " Now if you want to be nasty, you want to randomly combine the TCP layer segmenting and the RPC"
    },
    {
      "Time_Start": 1893.6000000000001,
      "Time_End": 1897.2,
      "Text": " layer record marking."
    },
    {
      "Time_Start": 1897.2,
      "Time_End": 1902.0800000000002,
      "Text": " And then one of the cool things is, normally, in normal traffic, these things are always"
    },
    {
      "Time_Start": 1902.0800000000002,
      "Time_End": 1903.0800000000002,
      "Text": " working together."
    },
    {
      "Time_Start": 1903.08,
      "Time_End": 1907.28,
      "Text": " So if you see a TCP segment across the wire, it always starts with a record mark."
    },
    {
      "Time_Start": 1907.28,
      "Time_End": 1909.06,
      "Text": " But it doesn't have to be."
    },
    {
      "Time_Start": 1909.06,
      "Time_End": 1914.48,
      "Text": " So in this third little diagram here, I show where I fragmented the TCP segment separately"
    },
    {
      "Time_Start": 1914.48,
      "Time_End": 1916.0,
      "Text": " from the record marking segment."
    },
    {
      "Time_Start": 1916.0,
      "Time_End": 1926.72,
      "Text": " So I'm sending four TCP segments for that original request."
    },
    {
      "Time_Start": 1926.72,
      "Time_End": 1933.32,
      "Text": " So the upshot of that is that you're not going to find a traditional RPC pattern in"
    },
    {
      "Time_Start": 1933.32,
      "Time_End": 1936.32,
      "Text": " that TCP connection."
    },
    {
      "Time_Start": 1936.32,
      "Time_End": 1941.8,
      "Text": " So I wrote a little code, I'll be posting this to my website after DEF CON, and what"
    },
    {
      "Time_Start": 1941.8,
      "Time_End": 1946.2,
      "Text": " it does is you replace your traditional socket send function that sends the data across the"
    },
    {
      "Time_Start": 1946.2,
      "Time_End": 1950.44,
      "Text": " wire in your exploit script with my send."
    },
    {
      "Time_Start": 1950.44,
      "Time_End": 1955.1200000000001,
      "Text": " What my send does is it randomizes where it's going to record mark and fragment the stuff,"
    },
    {
      "Time_Start": 1955.1200000000001,
      "Time_End": 1959.8000000000002,
      "Text": " and where it's going to segment at the TCP layer."
    },
    {
      "Time_Start": 1959.8000000000002,
      "Time_End": 1966.8000000000002,
      "Text": " If you're familiar with RPC, it has, XDR has this very distinctive rule that everything"
    },
    {
      "Time_Start": 1966.8000000000002,
      "Time_End": 1971.24,
      "Text": " has to be fragmented on four, or everything has to be on four byte boundaries."
    },
    {
      "Time_Start": 1971.24,
      "Time_End": 1975.16,
      "Text": " So all integers must be four bytes, you can't have a three byte integer."
    },
    {
      "Time_Start": 1975.16,
      "Time_End": 1980.72,
      "Text": " A string of someone's name that's nine bytes long has to be padded out to an even 12 bytes"
    },
    {
      "Time_Start": 1980.72,
      "Time_End": 1983.48,
      "Text": " with nulls at the end."
    },
    {
      "Time_Start": 1983.48,
      "Time_End": 1987.04,
      "Text": " But that XDR restriction does not apply to record marking."
    },
    {
      "Time_Start": 1987.04,
      "Time_End": 1992.4,
      "Text": " I point this out because the first time I did the anti-evasion stuff in Black Ice, I"
    },
    {
      "Time_Start": 1992.4,
      "Time_End": 1995.16,
      "Text": " made the assumption that it was XDR."
    },
    {
      "Time_Start": 1995.16,
      "Time_End": 1998.3600000000001,
      "Text": " And then I played around with the spec, realized it didn't have to apply, tried it out on the"
    },
    {
      "Time_Start": 1998.3600000000001,
      "Time_End": 2003.6,
      "Text": " exploit script, and sure enough, it evaded, so I had to change my code yet again."
    },
    {
      "Time_Start": 2003.6,
      "Time_End": 2006.6,
      "Text": " So anyways, we call the my send function, instead of your normal send function that"
    },
    {
      "Time_Start": 2006.6,
      "Time_End": 2011.84,
      "Text": " you have as part of your exploit script, it calls the my send upper function, which as"
    },
    {
      "Time_Start": 2011.8400000000001,
      "Time_End": 2019.68,
      "Text": " the record marking stuff to it, with a random length field, and then passes it to the TCP"
    },
    {
      "Time_Start": 2019.68,
      "Time_End": 2025.2,
      "Text": " layer, where I again then randomize how long the TCP segment is going to be."
    },
    {
      "Time_Start": 2025.2,
      "Time_End": 2030.5200000000002,
      "Text": " I also put a little random sleep time there, so if you're trying to find the traffic over"
    },
    {
      "Time_Start": 2030.5200000000002,
      "Time_End": 2033.88,
      "Text": " time, that messes up too."
    },
    {
      "Time_Start": 2033.88,
      "Time_End": 2037.3600000000001,
      "Text": " And what I come up with is something that looks like this, is randomized where I'm going"
    },
    {
      "Time_Start": 2037.3600000000001,
      "Time_End": 2042.64,
      "Text": " to record frag, and randomized where I'm going to TCP segment."
    },
    {
      "Time_Start": 2042.64,
      "Time_End": 2049.4,
      "Text": " So if my original command is like a port dump command, port dump is a scanning technique,"
    },
    {
      "Time_Start": 2049.4,
      "Time_End": 2054.44,
      "Text": " you scan an RPC server and ask it what services are running, this is how you hunt down to"
    },
    {
      "Time_Start": 2054.44,
      "Time_End": 2059.7200000000003,
      "Text": " see which ones might be vulnerable that you're going to exploit with buffer overflow exploits."
    },
    {
      "Time_Start": 2059.7200000000003,
      "Time_End": 2064.52,
      "Text": " This is what the packet looks like in hex, right below it is a decode, the first four"
    },
    {
      "Time_Start": 2064.52,
      "Time_End": 2069.88,
      "Text": " bytes are that record frag, the byte, the first byte is that little bit saying that"
    },
    {
      "Time_Start": 2069.88,
      "Time_End": 2075.44,
      "Text": " there's a, it's the last record frag in the sequence, because it normally doesn't record"
    },
    {
      "Time_Start": 2075.44,
      "Time_End": 2076.44,
      "Text": " frag on requests."
    },
    {
      "Time_Start": 2076.44,
      "Time_End": 2081.8,
      "Text": " Then you have the XID, the message type, it calls, it's RPC version 2, which is all RPC"
    },
    {
      "Time_Start": 2081.8,
      "Time_End": 2082.8,
      "Text": " we use today."
    },
    {
      "Time_Start": 2082.8,
      "Time_End": 2087.6,
      "Text": " It's a port map command, it's port map version 2, the procedure is dump, which is procedure"
    },
    {
      "Time_Start": 2087.6,
      "Time_End": 2092.16,
      "Text": " number 4, there's no authentication or verification."
    },
    {
      "Time_Start": 2092.16,
      "Time_End": 2095.7999999999997,
      "Text": " Here's what it looks like after it gets through my, the MySend functions."
    },
    {
      "Time_Start": 2095.7999999999997,
      "Time_End": 2099.6,
      "Text": " The first packet has a TCP segment of 0 and 0."
    },
    {
      "Time_Start": 2099.6,
      "Time_End": 2104.96,
      "Text": " The next packet has a TCP segment of 0, 5, and so on and so forth."
    },
    {
      "Time_Start": 2104.96,
      "Time_End": 2108.8799999999997,
      "Text": " Those first four bytes, of course, are the record marking stuff, where I've randomly"
    },
    {
      "Time_Start": 2108.8799999999997,
      "Time_End": 2114.04,
      "Text": " chosen that the first record is going to be 5 bytes long, and even I, the random, by the"
    },
    {
      "Time_Start": 2114.04,
      "Time_End": 2120.66,
      "Text": " randomization of the packet, even that record mark itself was segmented in the TCP segments."
    },
    {
      "Time_Start": 2120.66,
      "Time_End": 2126.94,
      "Text": " So I have about 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, so I've got"
    },
    {
      "Time_Start": 2126.94,
      "Time_End": 2131.02,
      "Text": " 17 packets there, where originally I had only one packet."
    },
    {
      "Time_Start": 2131.02,
      "Time_End": 2137.7,
      "Text": " It's also about 70 bytes long, where the original packet was about 40 bytes long."
    },
    {
      "Time_Start": 2137.7,
      "Time_End": 2140.74,
      "Text": " And this, of course, gives IDS's fits."
    },
    {
      "Time_Start": 2140.74,
      "Time_End": 2145.5,
      "Text": " Most IDS's still don't reassemble TCP streams, but even if they did, the stream wouldn't"
    },
    {
      "Time_Start": 2145.5,
      "Time_End": 2149.06,
      "Text": " look like anything like they've ever seen with RPC."
    },
    {
      "Time_Start": 2149.06,
      "Time_End": 2150.7799999999997,
      "Text": " They don't detect the port map attack."
    },
    {
      "Time_Start": 2150.7799999999997,
      "Time_End": 2155.06,
      "Text": " Now, I've tried this against a number of the other IDS's, and sure enough, they detect"
    },
    {
      "Time_Start": 2155.06,
      "Time_End": 2159.06,
      "Text": " the normal one, but they don't detect the evaded one."
    },
    {
      "Time_Start": 2159.06,
      "Time_End": 2166.1,
      "Text": " And this is particularly important because of the way that a lot of IDS's work, well,"
    },
    {
      "Time_Start": 2166.1,
      "Time_End": 2174.1,
      "Text": " I assume they work, with RPC, is RPC runs its services at random ports, like CMSD, Calendar"
    },
    {
      "Time_Start": 2174.1,
      "Time_End": 2180.2599999999998,
      "Text": " Messenger Service, an exploit that a lot of Solaris machines fell victim to last year,"
    },
    {
      "Time_Start": 2180.2599999999998,
      "Time_End": 2181.86,
      "Text": " runs at a randomly chosen port."
    },
    {
      "Time_Start": 2181.86,
      "Time_End": 2186.58,
      "Text": " When it starts up, it registers with PortMapper at the well-known port of 111 and tells it"
    },
    {
      "Time_Start": 2186.58,
      "Time_End": 2190.06,
      "Text": " which port it's running at."
    },
    {
      "Time_Start": 2190.06,
      "Time_End": 2193.06,
      "Text": " Back at Network General, when we worked on the sniffer, the way we got around this fact"
    },
    {
      "Time_Start": 2193.06,
      "Time_End": 2197.3399999999997,
      "Text": " was by using a heuristic called smells-like, where we looked at an RPC request and said,"
    },
    {
      "Time_Start": 2197.3399999999997,
      "Time_End": 2199.3399999999997,
      "Text": " does this look like an RPC request?"
    },
    {
      "Time_Start": 2199.3399999999997,
      "Time_End": 2202.9,
      "Text": " RPC is kind of cool because it's very distinctive."
    },
    {
      "Time_Start": 2202.9,
      "Time_End": 2207.9,
      "Text": " You have that record mark, you have the XID, which is random, the message type is either"
    },
    {
      "Time_Start": 2207.9,
      "Time_End": 2211.9,
      "Text": " 0 or 1, so you've got four bytes that are either going to be 0 or 1, RPC version is"
    },
    {
      "Time_Start": 2211.9,
      "Time_End": 2216.9,
      "Text": " always 2, so that field must be 2, and so on and so forth, we can really distinctively"
    },
    {
      "Time_Start": 2216.9,
      "Time_End": 2220.9,
      "Text": " say 99.9% of the time whether it's RPC."
    },
    {
      "Time_Start": 2220.9,
      "Time_End": 2224.9,
      "Text": " But, in this packet, those rules don't apply."
    },
    {
      "Time_Start": 2224.9,
      "Time_End": 2228.9,
      "Text": " It looks nothing like RPC anymore, according to those heuristics."
    },
    {
      "Time_Start": 2228.9,
      "Time_End": 2232.86,
      "Text": " And heuristics that try to deal with the record mark can always be evaded by carefully constructing"
    },
    {
      "Time_Start": 2232.86,
      "Time_End": 2236.86,
      "Text": " record to look like something else."
    },
    {
      "Time_Start": 2236.86,
      "Time_End": 2242.86,
      "Text": " So, the only way to get around that is the IDS needs to not use those heuristics and"
    },
    {
      "Time_Start": 2242.86,
      "Time_End": 2246.86,
      "Text": " must instead keep a lot more state around, must profile the target to say, I've seen"
    },
    {
      "Time_Start": 2246.86,
      "Time_End": 2250.86,
      "Text": " a port map response come back, therefore I know which ports all the services are running"
    },
    {
      "Time_Start": 2250.86,
      "Time_End": 2253.86,
      "Text": " at."
    },
    {
      "Time_Start": 2253.86,
      "Time_End": 2255.86,
      "Text": " So that's RPC record fragging."
    },
    {
      "Time_Start": 2255.86,
      "Time_End": 2259.86,
      "Text": " That was suggested to me by Doug Song, who wrote the original frag router."
    },
    {
      "Time_Start": 2259.86,
      "Time_End": 2263.86,
      "Text": " He's working on like a frag proxier, I'm not quite sure what he's working on, that"
    },
    {
      "Time_Start": 2263.86,
      "Time_End": 2267.86,
      "Text": " will do this automatically for you, whereas my code you have to sort of add to your script"
    },
    {
      "Time_Start": 2267.86,
      "Time_End": 2271.86,
      "Text": " and change the script."
    },
    {
      "Time_Start": 2271.86,
      "Time_End": 2277.86,
      "Text": " The next one is something that I discovered myself, where I'm using the telnet channel"
    },
    {
      "Time_Start": 2277.86,
      "Time_End": 2279.86,
      "Text": " on FTP."
    },
    {
      "Time_Start": 2279.86,
      "Time_End": 2285.86,
      "Text": " If you read the FTP specification, it says that the control channel is really telnet."
    },
    {
      "Time_Start": 2285.86,
      "Time_End": 2289.86,
      "Text": " Now, the later on host requirements RFC says no, it's really not telnet, it's just something"
    },
    {
      "Time_Start": 2289.86,
      "Time_End": 2297.86,
      "Text": " that looks a lot like telnet, using the same option strings, the out of band option communication."
    },
    {
      "Time_Start": 2297.86,
      "Time_End": 2303.86,
      "Text": " What telnet has is strings that start with FF, a byte with all ones, followed by either"
    },
    {
      "Time_Start": 2303.86,
      "Time_End": 2305.86,
      "Text": " one or two bytes of the option code."
    },
    {
      "Time_Start": 2305.86,
      "Time_End": 2310.86,
      "Text": " And the telnet usage is really complex, you can negotiate which terminal you are, what"
    },
    {
      "Time_Start": 2310.86,
      "Time_End": 2314.86,
      "Text": " your backspace character is going to be, and a lot of other stuff."
    },
    {
      "Time_Start": 2314.86,
      "Time_End": 2319.86,
      "Text": " In the normal telnet environment, the issue is so bad, you can basically avoid any IDS"
    },
    {
      "Time_Start": 2319.86,
      "Time_End": 2321.86,
      "Text": " detection on the telnet channel."
    },
    {
      "Time_Start": 2321.86,
      "Time_End": 2325.86,
      "Text": " You can reconfigure your backspace character to be Q or something like that."
    },
    {
      "Time_Start": 2325.86,
      "Time_End": 2331.86,
      "Text": " So your IDS is seeing a string of Qs, but the target system is seeing a string of backspaces."
    },
    {
      "Time_Start": 2331.86,
      "Time_End": 2335.86,
      "Text": " But in the FTP case, none of that can be negotiated."
    },
    {
      "Time_Start": 2335.86,
      "Time_End": 2339.86,
      "Text": " All they can negotiate is whether to use the abort option, the abort telnet option code."
    },
    {
      "Time_Start": 2339.86,
      "Time_End": 2341.86,
      "Text": " Everything else is a null option."
    },
    {
      "Time_Start": 2341.86,
      "Time_End": 2347.86,
      "Text": " So an FF followed by any other byte is pretty much ignored in the FTP command channel."
    },
    {
      "Time_Start": 2347.86,
      "Time_End": 2354.86,
      "Text": " So when you log on as, in this case, user Rob, you can put in that FF and then another byte."
    },
    {
      "Time_Start": 2354.86,
      "Time_End": 2357.86,
      "Text": " The F1 is the telnet no op code."
    },
    {
      "Time_Start": 2357.86,
      "Time_End": 2361.86,
      "Text": " But any byte will do, because it will strip it out and ignore it."
    },
    {
      "Time_Start": 2361.86,
      "Time_End": 2368.86,
      "Text": " So instead of seeing user Rob, you see this user garbage Rob, and it's pass like garbage and foo."
    },
    {
      "Time_Start": 2368.86,
      "Time_End": 2372.86,
      "Text": " And this is a lot like, conceptually like RPC."
    },
    {
      "Time_Start": 2372.86,
      "Time_End": 2375.86,
      "Text": " It's at the presentation layer of the OSI model."
    },
    {
      "Time_Start": 2375.86,
      "Time_End": 2379.86,
      "Text": " I'm changing how I'm formatting this stuff."
    },
    {
      "Time_Start": 2379.86,
      "Time_End": 2387.86,
      "Text": " So you think through all of the exploits that FTP can do, they're all pretty much run across the control channel."
    },
    {
      "Time_Start": 2387.86,
      "Time_End": 2394.86,
      "Text": " Like bounce scans, the tar compress, execute bug, buffer overflows, change working directory to root,"
    },
    {
      "Time_Start": 2394.86,
      "Time_End": 2399.86,
      "Text": " logging on with username and password, site exec, there's been a lot of site exec holes lately,"
    },
    {
      "Time_Start": 2399.86,
      "Time_End": 2403.86,
      "Text": " printf style format bugs, shell characters and so forth."
    },
    {
      "Time_Start": 2403.86,
      "Time_End": 2408.86,
      "Text": " Now as I was working on this and testing it out, I found a number of problems."
    },
    {
      "Time_Start": 2408.86,
      "Time_End": 2414.86,
      "Text": " Unix supports this three character do, don't command negotiation."
    },
    {
      "Time_Start": 2414.86,
      "Time_End": 2418.86,
      "Text": " Where the client logs on and says, I want to do something or other."
    },
    {
      "Time_Start": 2418.86,
      "Time_End": 2422.86,
      "Text": " And the server comes back and says, no I don't support that, or I do support it."
    },
    {
      "Time_Start": 2423.86,
      "Time_End": 2427.86,
      "Text": " And the cool thing about that is, is you can desynchronize an IDS,"
    },
    {
      "Time_Start": 2427.86,
      "Time_End": 2432.86,
      "Text": " because you can start up and say, send the do command, FTP comes back and says won't."
    },
    {
      "Time_Start": 2432.86,
      "Time_End": 2436.86,
      "Text": " The FTP by the way, the specification now with host requirements RFC,"
    },
    {
      "Time_Start": 2436.86,
      "Time_End": 2441.86,
      "Text": " says that it should respond with won't for everything, because it shouldn't really support Telnet."
    },
    {
      "Time_Start": 2441.86,
      "Time_End": 2447.86,
      "Text": " So you can send, you can pepper your code with these, like you can send a command like user password,"
    },
    {
      "Time_Start": 2447.86,
      "Time_End": 2450.86,
      "Text": " and in the middle of that user string, send the do command,"
    },
    {
      "Time_Start": 2450.86,
      "Time_End": 2455.86,
      "Text": " and you'll get back to this don't command, and it'll really confuse the IDS."
    },
    {
      "Time_Start": 2455.86,
      "Time_End": 2459.86,
      "Text": " Unfortunately, Windows FTP implementation from Microsoft,"
    },
    {
      "Time_Start": 2459.86,
      "Time_End": 2464.86,
      "Text": " doesn't support the three character code, only the two character evasion stuff."
    },
    {
      "Time_Start": 2464.86,
      "Time_End": 2469.86,
      "Text": " It also has that same null problem as Whisker does with the string copy."
    },
    {
      "Time_Start": 2469.86,
      "Time_End": 2472.86,
      "Text": " So you can send a null to it, prefixed by the option code,"
    },
    {
      "Time_Start": 2472.86,
      "Time_End": 2477.86,
      "Text": " then it'll stop processing the string, and anything after it won't be interpreted by the server."
    },
    {
      "Time_Start": 2477.86,
      "Time_End": 2481.86,
      "Text": " Now if the IDS interprets that string, it will no longer figure out what the user,"
    },
    {
      "Time_Start": 2481.86,
      "Time_End": 2483.86,
      "Text": " or the hacker is really doing."
    },
    {
      "Time_Start": 2483.86,
      "Time_End": 2486.86,
      "Text": " But of course if it does do the same logic as the Windows NT stuff,"
    },
    {
      "Time_Start": 2486.86,
      "Time_End": 2491.86,
      "Text": " then it will no longer be able to detect all the attacks against the Unix FTP server."
    },
    {
      "Time_Start": 2491.86,
      "Time_End": 2496.86,
      "Text": " Now there's also the problem that a lot of Windows FTP servers you might download off the web,"
    },
    {
      "Time_Start": 2496.86,
      "Time_End": 2499.86,
      "Text": " don't support any of this option stuff at all."
    },
    {
      "Time_Start": 2499.86,
      "Time_End": 2502.86,
      "Text": " So what you really need to do is to profile the target,"
    },
    {
      "Time_Start": 2502.86,
      "Time_End": 2505.86,
      "Text": " and figure out what kind of FTP server is the target running,"
    },
    {
      "Time_Start": 2505.86,
      "Time_End": 2510.86,
      "Text": " and adjust your IDS algorithms accordingly."
    },
    {
      "Time_Start": 2510.86,
      "Time_End": 2514.86,
      "Text": " Also, if you're writing the exploit scripts, you equally have to profile the target."
    },
    {
      "Time_Start": 2514.86,
      "Time_End": 2518.86,
      "Text": " For example, a lot of scripts run across the anonymous authentication,"
    },
    {
      "Time_Start": 2518.86,
      "Time_End": 2520.86,
      "Text": " so the first thing you should do is encode the user string."
    },
    {
      "Time_Start": 2520.86,
      "Time_End": 2523.86,
      "Text": " If you get back an error, you know it's not handling the option code."
    },
    {
      "Time_Start": 2523.86,
      "Time_End": 2526.86,
      "Text": " If you say, okay, anonymous is allowed to log in,"
    },
    {
      "Time_Start": 2526.86,
      "Time_End": 2528.86,
      "Text": " or guest account is allowed to log in,"
    },
    {
      "Time_Start": 2528.86,
      "Time_End": 2531.86,
      "Text": " then you know that it did accept the option code,"
    },
    {
      "Time_Start": 2531.86,
      "Time_End": 2533.86,
      "Text": " and you should use the option codes from then on."
    },
    {
      "Time_Start": 2533.86,
      "Time_End": 2536.86,
      "Text": " You can use the same technique back used in the RPC record fragging,"
    },
    {
      "Time_Start": 2536.86,
      "Time_End": 2538.86,
      "Text": " is randomize the whole thing."
    },
    {
      "Time_Start": 2538.86,
      "Time_End": 2541.86,
      "Text": " Like just every character is either randomly the original character,"
    },
    {
      "Time_Start": 2541.86,
      "Time_End": 2547.86,
      "Text": " or one prefixed by the option evasion stuff."
    },
    {
      "Time_Start": 2547.86,
      "Time_End": 2552.86,
      "Text": " So here's an example of where I do the change current working directory to root."
    },
    {
      "Time_Start": 2552.86,
      "Time_End": 2557.86,
      "Text": " I log on as anonymous, and I send that corruption in the user string,"
    },
    {
      "Time_Start": 2557.86,
      "Time_End": 2560.86,
      "Text": " but the server supports FTP, or telnet options,"
    },
    {
      "Time_Start": 2560.86,
      "Time_End": 2565.86,
      "Text": " and says, great, guest account login okay, continue on."
    },
    {
      "Time_Start": 2565.86,
      "Time_End": 2569.86,
      "Text": " I then do the exploit, change current working directory to root,"
    },
    {
      "Time_Start": 2569.86,
      "Time_End": 2571.86,
      "Text": " and I insert my little option codes in there,"
    },
    {
      "Time_Start": 2571.86,
      "Time_End": 2574.86,
      "Text": " so it doesn't look anything like change current working directory to root,"
    },
    {
      "Time_Start": 2574.86,
      "Time_End": 2578.86,
      "Text": " and indeed, all the other IDSs fail to detect this."
    },
    {
      "Time_Start": 2578.86,
      "Time_End": 2581.86,
      "Text": " Though on the server, I got back 250 success,"
    },
    {
      "Time_Start": 2581.86,
      "Time_End": 2584.86,
      "Text": " meaning I actually was able to change my current working directory to root,"
    },
    {
      "Time_Start": 2584.86,
      "Time_End": 2590.86,
      "Text": " and I can grab any file off the server I want."
    },
    {
      "Time_Start": 2590.86,
      "Time_End": 2595.86,
      "Text": " A similar technique, using sort of the presentation formatting of the data,"
    },
    {
      "Time_Start": 2595.86,
      "Time_End": 2597.86,
      "Text": " is within DNS."
    },
    {
      "Time_Start": 2597.86,
      "Time_End": 2600.86,
      "Text": " First of all, you have a case sensitivity issue."
    },
    {
      "Time_Start": 2600.86,
      "Time_End": 2606.86,
      "Text": " I noticed that a lot of IDSs assume that the case will be either all uppercase or all lowercase."
    },
    {
      "Time_Start": 2606.86,
      "Time_End": 2610.86,
      "Text": " The second thing is, is that DNS supports this name compression thing,"
    },
    {
      "Time_Start": 2610.86,
      "Time_End": 2616.86,
      "Text": " where it splits up names in order to compress responses and requests."
    },
    {
      "Time_Start": 2616.86,
      "Time_End": 2620.86,
      "Text": " This has long been used to crash IDSs and to crash sniffers,"
    },
    {
      "Time_Start": 2620.86,
      "Time_End": 2624.86,
      "Text": " because you can cause it to reference itself in an infinite loop."
    },
    {
      "Time_Start": 2624.86,
      "Time_End": 2628.86,
      "Text": " The way this compression works is that you have like one name,"
    },
    {
      "Time_Start": 2628.86,
      "Time_End": 2632.86,
      "Text": " maybe I try to reference www.yahoo.com,"
    },
    {
      "Time_Start": 2632.86,
      "Time_End": 2637.86,
      "Text": " it comes back and says, well actually there's lots of servers that are www.yahoo.com,"
    },
    {
      "Time_Start": 2637.86,
      "Time_End": 2640.86,
      "Text": " they're like www1, www2, and so forth."
    },
    {
      "Time_Start": 2640.86,
      "Time_End": 2643.86,
      "Text": " Now, in order to compress that DNS response,"
    },
    {
      "Time_Start": 2643.86,
      "Time_End": 2646.86,
      "Text": " the first one says the full yahoo.com,"
    },
    {
      "Time_Start": 2646.86,
      "Time_End": 2648.86,
      "Text": " and the second ones have a pointer saying,"
    },
    {
      "Time_Start": 2648.86,
      "Time_End": 2653.86,
      "Text": " continue on now with the rest of the original yahoo.com."
    },
    {
      "Time_Start": 2653.86,
      "Time_End": 2656.86,
      "Text": " So when you look at the text decode of it, you see something that looks a lot like this."
    },
    {
      "Time_Start": 2656.86,
      "Time_End": 2662.86,
      "Text": " You see in the clear text, the first name followed by a lot of other fractions of the name."
    },
    {
      "Time_Start": 2662.86,
      "Time_End": 2666.86,
      "Text": " And this is where you can crash an IDS or a sniffer,"
    },
    {
      "Time_Start": 2666.86,
      "Time_End": 2669.86,
      "Text": " is where you make that self-referential loop,"
    },
    {
      "Time_Start": 2669.86,
      "Time_End": 2671.86,
      "Text": " saying reference myself and continue here,"
    },
    {
      "Time_Start": 2671.86,
      "Time_End": 2674.86,
      "Text": " and it will continue to continue here and hang."
    },
    {
      "Time_Start": 2674.86,
      "Time_End": 2680.86,
      "Text": " Or you can tell it to point off to Never Never Land where it will crash."
    },
    {
      "Time_Start": 2680.86,
      "Time_End": 2683.86,
      "Text": " Oops."
    },
    {
      "Time_Start": 2683.86,
      "Time_End": 2686.86,
      "Text": " So I wrote a little version bind scanner."
    },
    {
      "Time_Start": 2686.86,
      "Time_End": 2689.86,
      "Text": " In the bind Berkeley Internet Name Game,"
    },
    {
      "Time_Start": 2689.86,
      "Time_End": 2692.86,
      "Text": " which services like 90% of all name requests on the internet,"
    },
    {
      "Time_Start": 2692.86,
      "Time_End": 2695.86,
      "Text": " you can query which version of the software is running."
    },
    {
      "Time_Start": 2695.86,
      "Time_End": 2700.86,
      "Text": " And you have a special record called a text record that's in the chaos class"
    },
    {
      "Time_Start": 2700.86,
      "Time_End": 2703.86,
      "Text": " with the string that you're looking up, version.bind."
    },
    {
      "Time_Start": 2703.86,
      "Time_End": 2707.86,
      "Text": " And that's like hard-coded to the code as an Easter egg that returns what version it's running,"
    },
    {
      "Time_Start": 2707.86,
      "Time_End": 2713.86,
      "Text": " like 8.22 or 4.31 or something like that."
    },
    {
      "Time_Start": 2713.86,
      "Time_End": 2717.86,
      "Text": " Well, a lot of IDSs detect this because it's a common scanning thing you do"
    },
    {
      "Time_Start": 2717.86,
      "Time_End": 2719.86,
      "Text": " when you're attacking a DNS server."
    },
    {
      "Time_Start": 2719.86,
      "Time_End": 2721.86,
      "Text": " So I did two evasions here,"
    },
    {
      "Time_Start": 2721.86,
      "Time_End": 2726.86,
      "Text": " one of which is I changed the name to be capital V and small version,"
    },
    {
      "Time_Start": 2726.86,
      "Time_End": 2729.86,
      "Text": " capital B and small ind."
    },
    {
      "Time_Start": 2729.86,
      "Time_End": 2732.86,
      "Text": " And I played around with this for a couple of days."
    },
    {
      "Time_Start": 2732.86,
      "Time_End": 2735.86,
      "Text": " I used all sorts of different arrangements by using this name compression"
    },
    {
      "Time_Start": 2735.86,
      "Time_End": 2739.86,
      "Text": " by taking the second part of the name and pointing it off somewhere else in the packet."
    },
    {
      "Time_Start": 2739.86,
      "Time_End": 2742.86,
      "Text": " And I finally came down to the only way I could figure out how to get it to work,"
    },
    {
      "Time_Start": 2742.86,
      "Time_End": 2745.86,
      "Text": " by going to the source code of bind, of course,"
    },
    {
      "Time_Start": 2745.86,
      "Time_End": 2753.86,
      "Text": " was to put the .bind after the logical end of the DNS portion of the packet."
    },
    {
      "Time_Start": 2753.86,
      "Time_End": 2757.86,
      "Text": " So that I see version, where you see that plus here in the text decode,"
    },
    {
      "Time_Start": 2757.86,
      "Time_End": 2761.86,
      "Text": " it's actually specifying the offset where to find bind."
    },
    {
      "Time_Start": 2761.86,
      "Time_End": 2764.86,
      "Text": " And the web server will paste this back together to version.bind"
    },
    {
      "Time_Start": 2764.86,
      "Time_End": 2766.86,
      "Text": " and return you the correct string."
    },
    {
      "Time_Start": 2766.86,
      "Time_End": 2768.86,
      "Text": " But if you're looking for version.bind in the packet,"
    },
    {
      "Time_Start": 2768.86,
      "Time_End": 2774.86,
      "Text": " you're not going to see that as a contiguous signature that you can trigger on."
    },
    {
      "Time_Start": 2774.86,
      "Time_End": 2780.86,
      "Text": " So we post that DNS scanner to my website as an example after Defcon."
    },
    {
      "Time_Start": 2780.86,
      "Time_End": 2783.86,
      "Text": " The problem is I couldn't get it to quite work on Linux."
    },
    {
      "Time_Start": 2783.86,
      "Time_End": 2786.86,
      "Text": " There's a clock, I throttle it for like bulk scanning"
    },
    {
      "Time_Start": 2786.86,
      "Time_End": 2788.86,
      "Text": " and the clock function on Linux wasn't quite working."
    },
    {
      "Time_Start": 2788.86,
      "Time_End": 2794.86,
      "Text": " I don't know why it would stop incrementing after a while."
    },
    {
      "Time_Start": 2794.86,
      "Time_End": 2798.86,
      "Text": " All these evasion techniques, which I discovered after I wrote the presentation here,"
    },
    {
      "Time_Start": 2798.86,
      "Time_End": 2801.86,
      "Text": " are at the OSI presentation layer."
    },
    {
      "Time_Start": 2801.86,
      "Time_End": 2804.86,
      "Text": " HTTP, RPC, FTP, DNS, they're all changing how the data is formatted"
    },
    {
      "Time_Start": 2804.86,
      "Time_End": 2808.86,
      "Text": " but not the meaning of the data."
    },
    {
      "Time_Start": 2808.86,
      "Time_End": 2813.86,
      "Text": " So I decided that it would be kind of cool to actually add these directly into NMAP"
    },
    {
      "Time_Start": 2813.86,
      "Time_End": 2817.86,
      "Text": " so that NMAP's FTP bounce scans will automatically evade"
    },
    {
      "Time_Start": 2817.86,
      "Time_End": 2827.86,
      "Text": " and RPC null proc stuff it does to detect RPC services will also evade the IDS."
    },
    {
      "Time_Start": 2827.86,
      "Time_End": 2834.86,
      "Text": " So today's networks, the most popular way you can exploit a site is through DNS, through BIND."
    },
    {
      "Time_Start": 2834.86,
      "Time_End": 2836.86,
      "Text": " A huge number of BIND exploits over the past year."
    },
    {
      "Time_Start": 2836.86,
      "Time_End": 2840.86,
      "Text": " FTP, there's a new one discovered every week."
    },
    {
      "Time_Start": 2840.86,
      "Time_End": 2842.86,
      "Text": " A new exploit into FTP."
    },
    {
      "Time_Start": 2842.86,
      "Time_End": 2850.86,
      "Text": " RPC services, Sun Solaris machines and Linux boxes have been exploited with RPC a lot in the last few years."
    },
    {
      "Time_Start": 2850.86,
      "Time_End": 2853.86,
      "Text": " Of course HTTP with all this CGI stuff will never end."
    },
    {
      "Time_Start": 2853.86,
      "Time_End": 2855.86,
      "Text": " You'll always be able to break into boxes with that."
    },
    {
      "Time_Start": 2855.86,
      "Time_End": 2857.86,
      "Text": " And of course Trojan horses."
    },
    {
      "Time_Start": 2857.86,
      "Time_End": 2862.86,
      "Text": " So these are the most popular ways that people are actually hacking into systems today."
    },
    {
      "Time_Start": 2862.86,
      "Time_End": 2868.86,
      "Text": " And of course the easiest way of evading IDSs are using those protocols that I just demonstrated."
    },
    {
      "Time_Start": 2868.86,
      "Time_End": 2870.86,
      "Text": " I like to do this, you know, back and forth."
    },
    {
      "Time_Start": 2870.86,
      "Time_End": 2877.86,
      "Text": " Along with the frag and the flood and the jam techniques of either fragmenting any attack with fragmentation"
    },
    {
      "Time_Start": 2877.86,
      "Time_End": 2882.86,
      "Text": " or flooding or jamming the IDS sensor and bringing it down."
    },
    {
      "Time_Start": 2882.86,
      "Time_End": 2892.86,
      "Text": " So the idea of evading IDSs with protocols is still not a widely researched topic in the hacker community."
    },
    {
      "Time_Start": 2892.86,
      "Time_End": 2896.86,
      "Text": " I've been just working on a few protocols because they're the most commonly used"
    },
    {
      "Time_Start": 2896.86,
      "Time_End": 2901.86,
      "Text": " and found I can easily add to these protocols the ability to evade IDSs."
    },
    {
      "Time_Start": 2901.86,
      "Time_End": 2905.86,
      "Text": " Including black ice, which is why I fixed it so it no longer works."
    },
    {
      "Time_Start": 2906.86,
      "Time_End": 2914.86,
      "Text": " Lots of protocols are vulnerable to these presentation layer attacks or application layer evasion."
    },
    {
      "Time_Start": 2914.86,
      "Time_End": 2920.86,
      "Text": " And the reason I'm presenting it is because a lot of the competitors still haven't dealt with fragmentation,"
    },
    {
      "Time_Start": 2920.86,
      "Time_End": 2922.86,
      "Text": " which is like really, really old."
    },
    {
      "Time_Start": 2922.86,
      "Time_End": 2926.86,
      "Text": " They really need to be kicking the pants and saying you need to add these to your products."
    },
    {
      "Time_Start": 2926.86,
      "Time_End": 2931.86,
      "Text": " As I started with the presentation here, the IDS vendors are selling you a tank"
    },
    {
      "Time_Start": 2931.86,
      "Time_End": 2936.86,
      "Text": " that some oddball can walk up behind with a grenade and blow it up."
    },
    {
      "Time_Start": 2936.86,
      "Time_End": 2940.86,
      "Text": " And this is not a really good state of the industry right now."
    },
    {
      "Time_Start": 2942.86,
      "Time_End": 2944.86,
      "Text": " So this is the end of the presentation."
    },
    {
      "Time_Start": 2944.86,
      "Time_End": 2949.86,
      "Text": " I'll be posting the slides to this URL at my own personal website."
    },
    {
      "Time_Start": 2949.86,
      "Time_End": 2954.86,
      "Text": " I've got a FAQ on generic network intrusion detection stuff at my website."
    },
    {
      "Time_Start": 2954.86,
      "Time_End": 2957.86,
      "Text": " And we'll be coming out with a Linux version a lot of you might be interested in."
    },
    {
      "Time_Start": 2957.86,
      "Time_End": 2958.86,
      "Text": " Beta in about a month."
    },
    {
      "Time_Start": 2958.86,
      "Time_End": 2960.86,
      "Text": " Are there any questions?"
    },
    {
      "Time_Start": 2961.86,
      "Time_End": 2962.86,
      "Text": " There."
    }
  ]
}