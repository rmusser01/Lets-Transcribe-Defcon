{"segments": [{"Time_Start": 0.0, "Time_End": 16.32, "Text": " The ICMP."}, {"Time_Start": 16.32, "Time_End": 27.18, "Text": " Before you all leave the room and go away because you're saying, hey, ICMP, you'll not see something interesting here."}, {"Time_Start": 27.18, "Time_End": 40.76, "Text": " Let me just say, using one to four packets only, with speeds like 200 milliseconds to 350 milliseconds, this is what my tool does."}, {"Time_Start": 41.06, "Time_End": 44.58, "Text": " So I think the guys that went to go away will now stay."}, {"Time_Start": 48.4, "Time_End": 52.9, "Text": " Basically, what we will be talking about is some theoretical analysis."}, {"Time_Start": 53.14, "Time_End": 57.16, "Text": " I changed that from Blackhead, so we'll have real-world examples."}, {"Time_Start": 57.18, "Time_End": 69.5, "Text": " examples. Along the talk, we will have some interesting sites that I've been scanning in the last three days."}, {"Time_Start": 69.5, "Time_End": 85.86, "Text": " So at the end, we will see some Chinese website. Actually, pretty cool websites, and there will be some surprises to see what they are using."}, {"Time_Start": 85.86, "Time_End": 91.1, "Text": " Some of them are government, so."}, {"Time_Start": 91.1, "Time_End": 99.92, "Text": " X is a logic, developed again from the various active voice fingerprinting system methods I have discovered using my research."}, {"Time_Start": 99.92, "Time_End": 107.68, "Text": " X-Prob is the tool that actually was released at Black Hat two days ago, and is available from our website."}, {"Time_Start": 107.68, "Time_End": 115.84, "Text": " It was written along with Fyodor Yurrachin, is from the Snor development team, is not the same further from EnMAP, so there are different"}, {"Time_Start": 115.86, "Time_End": 118.86, "Text": " a few others in the world, I guess."}, {"Time_Start": 118.86, "Time_End": 120.86, "Text": " The tool automates X."}, {"Time_Start": 120.86, "Time_End": 124.86, "Text": " It's version 0.0.1. It works."}, {"Time_Start": 124.86, "Time_End": 128.86, "Text": " I'll talk about the limitation later and what will be the future."}, {"Time_Start": 128.86, "Time_End": 135.86, "Text": " The logic and the, well, the tool is simple, fast, and efficient,"}, {"Time_Start": 135.86, "Time_End": 141.86, "Text": " which I think every tool should be, it's still a proof of concept."}, {"Time_Start": 141.86, "Time_End": 145.84, "Text": " And in the future, this tool will have some kind of artificial"}, {"Time_Start": 145.86, "Time_End": 152.86, "Text": " intelligence and failover mechanism, say, you started scanning using some method,"}, {"Time_Start": 152.86, "Time_End": 160.86, "Text": " and you failed, it will fail over automatically to another logic, and eventually it will intelligently"}, {"Time_Start": 160.86, "Time_End": 162.86, "Text": " identify the operating system."}, {"Time_Start": 162.86, "Time_End": 168.86, "Text": " The problem with some tools today, especially the open source one, when you do scanning,"}, {"Time_Start": 168.86, "Time_End": 172.86, "Text": " that sometimes you get inaccurate and inconsistent results."}, {"Time_Start": 172.86, "Time_End": 174.86, "Text": " And I'll show some examples."}, {"Time_Start": 174.86, "Time_End": 180.86, "Text": " This is true especially with Windows-based operating systems with TCP."}, {"Time_Start": 180.86, "Time_End": 187.86, "Text": " And I will be showing examples with NMAP, for example, and how X can solve this thing."}, {"Time_Start": 187.86, "Time_End": 192.86, "Text": " So basically, it is all depends where you sit."}, {"Time_Start": 192.86, "Time_End": 197.86, "Text": " If you are a penetration tester, you sit inside an internal network."}, {"Time_Start": 197.86, "Time_End": 202.86, "Text": " You want to see which operating system you have, this is one thing."}, {"Time_Start": 202.86, "Time_End": 214.86, "Text": " If you're an attacker and you sit outside somewhere in the internet, say, outside of firewall, sit here, this is another thing."}, {"Time_Start": 214.86, "Time_End": 222.86, "Text": " So you may be having to use some different protocols or some different probs or some different techniques."}, {"Time_Start": 222.86, "Time_End": 224.86, "Text": " It depends where you sit."}, {"Time_Start": 224.86, "Time_End": 231.86, "Text": " Sure, it depends on the firewall and what you let's in, but eventually you'll need to use something intelligently."}, {"Time_Start": 231.86, "Time_End": 237.86, "Text": " intelligently. For example, if you have a firewall, you will not expect to see"}, {"Time_Start": 237.86, "Time_End": 245.86, "Text": " traffic flying in for UDP ports which are not used on targets inside the internal networks,"}, {"Time_Start": 245.86, "Time_End": 251.86, "Text": " or you will be filtering heavily if you're doing it good."}, {"Time_Start": 251.86, "Time_End": 254.86, "Text": " But if you are inside a network, it changes the picture."}, {"Time_Start": 254.86, "Time_End": 261.86, "Text": " And usually between internal segments, you can use ICMP because, you're"}, {"Time_Start": 261.86, "Time_End": 267.86, "Text": " management or IT management need to see the availability of for producting systems"}, {"Time_Start": 267.86, "Time_End": 275.86, "Text": " because they are lazy to get their fat assets from the seats and go up to Mrs. Robinson up in the 9th floor"}, {"Time_Start": 275.86, "Time_End": 280.86, "Text": " just to see she plugged off her Ethernet cable."}, {"Time_Start": 280.86, "Time_End": 290.86, "Text": " About the license, license in GNU, the code is available, but all material is for non-profit educational use only."}, {"Time_Start": 290.86, "Time_End": 297.86, "Text": " only. So if you want to use this for commercial stuff, you need to talk to me."}, {"Time_Start": 297.86, "Time_End": 305.86, "Text": " If you guys want to use that and you're not using it for commercial usage, and if it's education,"}, {"Time_Start": 305.86, "Time_End": 310.86, "Text": " you can download it for my website."}, {"Time_Start": 310.86, "Time_End": 319.86, "Text": " Again, the tool uses one to four packets and I'll show you how it does it."}, {"Time_Start": 319.86, "Time_End": 320.86, "Text": " Okay."}, {"Time_Start": 320.86, "Time_End": 329.86, "Text": " The logic starts with a UDP datagram sent to definitely closed UDP port."}, {"Time_Start": 329.86, "Time_End": 334.68, "Text": " I sent some data inside the data portion of the packet."}, {"Time_Start": 334.68, "Time_End": 339.46000000000004, "Text": " It is up to 70 bytes of data inside the offending packet."}, {"Time_Start": 339.46000000000004, "Time_End": 342.26, "Text": " Why definitely close UDP port?"}, {"Time_Start": 342.26, "Time_End": 345.40000000000003, "Text": " Definitely closed so I can get the port unreachable."}, {"Time_Start": 345.40000000000003, "Time_End": 348.16, "Text": " So how can pick, definitely close UDP port?"}, {"Time_Start": 348.16, "Time_End": 350.84000000000003, "Text": " One of the examples will be"}, {"Time_Start": 350.86, "Time_End": 359.86, "Text": " Go to the YANLIST for assigned ports and get yourself some ports and then randomly,"}, {"Time_Start": 359.86, "Time_End": 364.86, "Text": " when you use the tool, use random ports that are eventually needs to be closed."}, {"Time_Start": 364.86, "Time_End": 368.86, "Text": " Now, it closed UDP port, send you a port unreachable."}, {"Time_Start": 368.86, "Time_End": 372.86, "Text": " If you don't get the port and reachable, you understand there is a firewall filtering you"}, {"Time_Start": 372.86, "Time_End": 376.86, "Text": " and you may fail over to another logic."}, {"Time_Start": 376.86, "Time_End": 380.84000000000003, "Text": " We will see an example when we will talk about Windows"}, {"Time_Start": 380.86, "Time_End": 386.18, "Text": " those based operating systems, Jeff Moss let me play with DAFCON.org."}, {"Time_Start": 386.18, "Time_End": 394.44, "Text": " So you can see how I can do failover and identify DEFCON.org using a failover mechanism."}, {"Time_Start": 394.44, "Time_End": 404.42, "Text": " So we have a way to identify firewall presence and if we receive back a reply, we play."}, {"Time_Start": 404.42, "Time_End": 410.42, "Text": " We will be using a nice fingerprinting thing with"}, {"Time_Start": 410.42, "Time_End": 414.42, "Text": " some operating systems and networking devices."}, {"Time_Start": 414.42, "Time_End": 417.42, "Text": " When they send an error message, they send the preceding bits,"}, {"Time_Start": 417.42, "Time_End": 421.42, "Text": " which is part of the type of service byte, as you can see here,"}, {"Time_Start": 421.42, "Time_End": 426.42, "Text": " set to the value of six decimal, which is C0 hex."}, {"Time_Start": 426.42, "Time_End": 431.42, "Text": " This means that Linux play the role of a router, like RFC 1812 states,"}, {"Time_Start": 431.42, "Time_End": 434.42, "Text": " that router has to do."}, {"Time_Start": 434.42, "Time_End": 439.42, "Text": " Well, I don't know why Linux does that, but if we want to"}, {"Time_Start": 439.42, "Time_End": 450.42, "Text": " to differentiate between Linux-Gronel-2-2-24 and Cisco routers and extreme network switches,"}, {"Time_Start": 450.42, "Time_End": 455.42, "Text": " we will look at echoing integrity problems inside the echo data."}, {"Time_Start": 455.42, "Time_End": 460.42, "Text": " I don't know how many of you know, but with an ICMP error message,"}, {"Time_Start": 460.42, "Time_End": 465.42, "Text": " certain amount of data from the offending package is getting echoed back with the error."}, {"Time_Start": 465.42, "Time_End": 468.42, "Text": " So you can understand which packet caused the error."}, {"Time_Start": 468.42, "Time_End": 474.42, "Text": " the IP header and at least 8 databases are echoed back."}, {"Time_Start": 474.42, "Time_End": 479.42, "Text": " There are some operating systems and networking devices that will echo more."}, {"Time_Start": 479.42, "Time_End": 481.42, "Text": " For example, we have here Linux."}, {"Time_Start": 481.42, "Time_End": 487.42, "Text": " We'll see that in the next slide that echoes nearly everything that will give him."}, {"Time_Start": 487.42, "Time_End": 491.42, "Text": " And in the other hand, we have Cisco and Extreme Networks"}, {"Time_Start": 491.42, "Time_End": 494.42, "Text": " that echoes only a database."}, {"Time_Start": 494.42, "Time_End": 497.42, "Text": " So basically using another internal test, not that's a database,"}, {"Time_Start": 497.42, "Time_End": 500.42, "Text": " Not the test that I need to repeat."}, {"Time_Start": 500.42, "Time_End": 504.42, "Text": " I can differentiate between the Linux bunch and the Cisco and Extreme Network punch."}, {"Time_Start": 504.42, "Time_End": 509.42, "Text": " If I want to differentiate furthermore between Cisco and Extreme Networks,"}, {"Time_Start": 509.42, "Time_End": 518.4200000000001, "Text": " I can look at the UDP checksum header, 40 header with the Extreme Networks that will be 0."}, {"Time_Start": 518.4200000000001, "Time_End": 520.4200000000001, "Text": " With Cisco, it will be echoed correctly."}, {"Time_Start": 520.4200000000001, "Time_End": 526.4200000000001, "Text": " So basically, using one datagram, I'm able to identify Cisco routers using iOS 11x to 12x."}, {"Time_Start": 526.42, "Time_End": 530.42, "Text": " 12x and extreme network switches."}, {"Time_Start": 530.42, "Time_End": 538.42, "Text": " If I look at the Linux bunch, I will be defining it according to the IP time to refill value."}, {"Time_Start": 538.42, "Time_End": 542.42, "Text": " Linux 2.0 uses 64, the others using 255."}, {"Time_Start": 542.42, "Time_End": 548.42, "Text": " And using another query, which makes two queries to the Linux 2.2 and 2.4,"}, {"Time_Start": 548.42, "Time_End": 556.42, "Text": " I can look if we are having IPID set to 0, which is a common"}, {"Time_Start": 556.42, "Time_End": 561.42, "Text": " problem with IPID with Linux 2.40 to 2.44,"}, {"Time_Start": 561.42, "Time_End": 567.42, "Text": " and therefore I can differentiate between Linux kernel 2.2 and 2.45 to Linux"}, {"Time_Start": 567.42, "Time_End": 570.42, "Text": " Cornell 2.40 to 2.44."}, {"Time_Start": 570.42, "Time_End": 575.42, "Text": " So using only two datagrams, I was able to get"}, {"Time_Start": 575.42, "Time_End": 579.42, "Text": " Linux 2.2Xs and 2.4 axis."}, {"Time_Start": 579.42, "Time_End": 583.42, "Text": " Using one datagram was able to get the Cisco, the extreme networks,"}, {"Time_Start": 583.42, "Time_End": 585.42, "Text": " and the Linux 2.02."}, {"Time_Start": 585.42, "Time_End": 587.42, "Text": " Linux 2.0."}, {"Time_Start": 587.42, "Time_End": 592.42, "Text": " Now if you will look at the real world example, look here, it's a real IPs."}, {"Time_Start": 592.42, "Time_End": 595.42, "Text": " Port scanning is legal."}, {"Time_Start": 595.42, "Time_End": 599.42, "Text": " And I would like to thank Jennifer Grannick for the legal advice."}, {"Time_Start": 599.42, "Time_End": 602.42, "Text": " Yeah, well."}, {"Time_Start": 602.42, "Time_End": 604.42, "Text": " We can see the first query."}, {"Time_Start": 604.42, "Time_End": 608.42, "Text": " First parameter to check is the preceding beats set to C0 here."}, {"Time_Start": 608.42, "Time_End": 614.42, "Text": " We can see that the data portion, well, the data echoed, sorry,"}, {"Time_Start": 614.42, "Time_End": 616.42, "Text": " Sorry, it's a mistake here."}, {"Time_Start": 616.42, "Time_End": 617.42, "Text": " No, sorry."}, {"Time_Start": 617.42, "Time_End": 620.42, "Text": " This is the data echoed really from this point."}, {"Time_Start": 620.42, "Time_End": 623.42, "Text": " We can see that everything that was sent inside"}, {"Time_Start": 623.42, "Time_End": 627.42, "Text": " the data portion of the offending packet got echoed here."}, {"Time_Start": 627.42, "Time_End": 630.42, "Text": " And you see the time to leave is 255."}, {"Time_Start": 630.42, "Time_End": 634.42, "Text": " So we're basically differentiated as 2.2 or 2.4."}, {"Time_Start": 634.42, "Time_End": 637.42, "Text": " And we send another ICMP echo request."}, {"Time_Start": 637.42, "Time_End": 639.42, "Text": " The IPID is not zero."}, {"Time_Start": 639.42, "Time_End": 643.42, "Text": " Then this is 2.2X or 2.45."}, {"Time_Start": 643.42, "Time_End": 644.4, "Text": " Now, we will."}, {"Time_Start": 644.42, "Time_End": 647.42, "Text": " use a foo bar, right? He'll not believe me."}, {"Time_Start": 647.42, "Time_End": 651.42, "Text": " So this is redhat.com."}, {"Time_Start": 651.42, "Time_End": 656.42, "Text": " And now I might be getting more acceptance."}, {"Time_Start": 656.42, "Time_End": 660.42, "Text": " Wait until you see the Chinese sites."}, {"Time_Start": 660.42, "Time_End": 663.42, "Text": " This is actually X running."}, {"Time_Start": 663.42, "Time_End": 666.42, "Text": " You can see first test here, first test here."}, {"Time_Start": 666.42, "Time_End": 671.42, "Text": " All the trees are like internal tests that I showed you before."}, {"Time_Start": 671.42, "Time_End": 673.42, "Text": " And it identifies at 2.2x to do all."}, {"Time_Start": 673.42, "Time_End": 680.42, "Text": " to 2.45. Now, if I use NMAP, I get the same results."}, {"Time_Start": 680.42, "Time_End": 689.42, "Text": " I get more packet sent 3 seconds, and I get 2.2.12 to 2.2.19."}, {"Time_Start": 689.42, "Time_End": 700.42, "Text": " Here, I was using, to look closely, nearly 300 milliseconds to get the same results."}, {"Time_Start": 700.42, "Time_End": 702.42, "Text": " So if we go back now,"}, {"Time_Start": 702.42, "Time_End": 710.26, "Text": " So if we go back now to the main branch of the tree, we can now look at another parameter."}, {"Time_Start": 710.26, "Time_End": 713.3199999999999, "Text": " How much echoing data is given with error message?"}, {"Time_Start": 713.3199999999999, "Time_End": 721.14, "Text": " We have three groups, the groups that echo back 8 databases, a group that echo only 64 by default,"}, {"Time_Start": 721.14, "Time_End": 723.02, "Text": " and a group that echo everything."}, {"Time_Start": 723.02, "Time_End": 724.02, "Text": " Here is Linux."}, {"Time_Start": 724.02, "Time_End": 732.38, "Text": " He echoes everything like the other networking devices and boxes here, but we identify it again."}, {"Time_Start": 732.42, "Time_End": 741.42, "Text": " like if we have some kind of a shaping device and is placed with the preceding beats."}, {"Time_Start": 741.42, "Time_End": 746.42, "Text": " And if he fails to identify Linux in the first stage, then we'll identify Linux here as well."}, {"Time_Start": 746.42, "Time_End": 752.42, "Text": " Let's look at the main branch here at Sensselaeris HPUX and Mac OS."}, {"Time_Start": 752.42, "Time_End": 755.42, "Text": " Again, very simple test to differentiate between them."}, {"Time_Start": 755.42, "Time_End": 761.42, "Text": " And if you didn't know that, MacOS 7X to 9x, X like HPUX 11X."}, {"Time_Start": 761.42, "Time_End": 766.42, "Text": " So they both bought the TCP code, I guess, from the same company."}, {"Time_Start": 766.42, "Time_End": 769.42, "Text": " Not wise thing to do."}, {"Time_Start": 769.42, "Time_End": 773.42, "Text": " I was able to play with MacOS 9-1 at Blackhead,"}, {"Time_Start": 773.42, "Time_End": 777.42, "Text": " and I would like to thank Chris from Seagate for letting me abusing his box."}, {"Time_Start": 777.42, "Time_End": 782.42, "Text": " Now, if I'm having false results here,"}, {"Time_Start": 782.42, "Time_End": 785.42, "Text": " if the timestamp here is blocked on the sandshole,"}, {"Time_Start": 785.42, "Time_End": 788.42, "Text": " I was sure it will be identified at HBUX11."}, {"Time_Start": 788.42, "Time_End": 791.4, "Text": " Still, it's just 0.0.0."}, {"Time_Start": 791.4200000000001, "Time_End": 797.4200000000001, "Text": " one. So in the future we'll have better firewalling test with other queries as well."}, {"Time_Start": 797.4200000000001, "Time_End": 801.4200000000001, "Text": " Here is an example with Sam Salaris 2.7."}, {"Time_Start": 801.4200000000001, "Time_End": 806.4200000000001, "Text": " We can look the, here's the offending packet, here's the error message."}, {"Time_Start": 806.4200000000001, "Time_End": 810.4200000000001, "Text": " We don't see the proceeding bits here, so we are at the main branch."}, {"Time_Start": 810.4200000000001, "Time_End": 815.4200000000001, "Text": " The data portion echoed, if you will count the 58, it will give you 56,"}, {"Time_Start": 815.4200000000001, "Time_End": 819.4200000000001, "Text": " and here's the UDP header, another 8 database, give you 64."}, {"Time_Start": 819.4200000000001, "Time_End": 826.4200000000001, "Text": " If you now look at the second packet sand, you see that again, I get timestamp reply,"}, {"Time_Start": 826.4200000000001, "Time_End": 832.4200000000001, "Text": " so it was identified sensor layers 2.3 to 2.8."}, {"Time_Start": 832.4200000000001, "Time_End": 837.4200000000001, "Text": " To play really cool tricks with other printing systems,"}, {"Time_Start": 837.4200000000001, "Time_End": 846.4200000000001, "Text": " I'm using echoing integrity problems, mainly using some fields inside the IP header."}, {"Time_Start": 846.4200000000001, "Time_End": 848.4200000000001, "Text": " I have a couple of fields I can play with."}, {"Time_Start": 848.4200000000001, "Time_End": 864.4200000000001, "Text": " I can play with. I have the IP total length field value, which sometimes might be with 20 bytes less or 20 bytes higher than the original IP ID because of beat order problems might be flipped."}, {"Time_Start": 864.4200000000001, "Time_End": 869.4200000000001, "Text": " The IP header checksum might be miscalculated or zero."}, {"Time_Start": 869.4200000000001, "Time_End": 877.4200000000001, "Text": " The three-beat flags and offset field values. If I set the DFB bit with my request or with my offending packet, it might be flipped."}, {"Time_Start": 877.4200000000001, "Time_End": 884.4200000000001, "Text": " So I might be seeing an error message stating I send a fragmented thing and get the error for."}, {"Time_Start": 884.4200000000001, "Time_End": 886.4200000000001, "Text": " So we'll see how we can use that."}, {"Time_Start": 886.4200000000001, "Time_End": 890.4200000000001, "Text": " And the UDP checks and might be miscalculated to zero."}, {"Time_Start": 890.4200000000001, "Time_End": 893.4200000000001, "Text": " So as you can see, we have a lot of parameters to work with."}, {"Time_Start": 893.4200000000001, "Time_End": 899.4200000000001, "Text": " So how can we use that to slice and dice this correctly?"}, {"Time_Start": 899.4200000000001, "Time_End": 905.4200000000001, "Text": " The first parameter we will be using is the IP total length field value."}, {"Time_Start": 905.4200000000001, "Time_End": 911.4200000000001, "Text": " Here we can see that we have three groups."}, {"Time_Start": 911.4200000000001, "Time_End": 917.4200000000001, "Text": " The one that echoes the field value with 20 bytes higher than was in the original."}, {"Time_Start": 917.4200000000001, "Time_End": 921.4200000000001, "Text": " Here it's less with 20 bytes and here it's okay."}, {"Time_Start": 921.4200000000001, "Time_End": 924.4200000000001, "Text": " Let's look at the AIX machines."}, {"Time_Start": 924.4200000000001, "Time_End": 931.4200000000001, "Text": " We can see that we have here AIX BSDI, older net BSDs, and Mac OSX server."}, {"Time_Start": 931.4200000000001, "Time_End": 934.4200000000001, "Text": " Well, if you think about them, they are all sharing the same base."}, {"Time_Start": 934.4200000000001, "Time_End": 938.4200000000001, "Text": " base code at least the BSDI and at BSDs in Mac OSX."}, {"Time_Start": 938.4200000000001, "Time_End": 942.4200000000001, "Text": " They're all using the same base code for TCPIP."}, {"Time_Start": 942.4200000000001, "Time_End": 945.4200000000001, "Text": " Again, using some echoing integrity checks,"}, {"Time_Start": 945.4200000000001, "Time_End": 948.4200000000001, "Text": " we can differentiate between the X machine here,"}, {"Time_Start": 948.4200000000001, "Time_End": 951.4200000000001, "Text": " which miscalculated the IP header checksum"}, {"Time_Start": 951.4200000000001, "Time_End": 956.4200000000001, "Text": " to the one, the other operating system, we just send zero here as the IP header checksum"}, {"Time_Start": 956.4200000000001, "Time_End": 959.4200000000001, "Text": " and differentiate between this group a bit more,"}, {"Time_Start": 959.4200000000001, "Time_End": 964.4000000000001, "Text": " having one group with little Andean problems and the other group with big and"}, {"Time_Start": 964.4200000000001, "Time_End": 965.4200000000001, "Text": " the end problems."}, {"Time_Start": 965.4200000000001, "Time_End": 973.4200000000001, "Text": " So again, this is only one packet sent and you can get a range of networking devices,"}, {"Time_Start": 973.4200000000001, "Time_End": 978.4200000000001, "Text": " sorry, operating systems that's using the same base TCPAP code"}, {"Time_Start": 978.4200000000001, "Time_End": 981.4200000000001, "Text": " after you sent one packet to get the results."}, {"Time_Start": 981.4200000000001, "Time_End": 987.4200000000001, "Text": " Here, we might have more networking devices, but the reason I didn't include them,"}, {"Time_Start": 987.4200000000001, "Time_End": 993.4200000000001, "Text": " it was like your grandmother's printer from 9085,"}, {"Time_Start": 993.4200000000001, "Time_End": 997.4200000000001, "Text": " So if you really know what your target is,"}, {"Time_Start": 997.4200000000001, "Time_End": 1001.4200000000001, "Text": " you understand that if you're targeting host or networking devices,"}, {"Time_Start": 1001.4200000000001, "Time_End": 1004.4200000000001, "Text": " and in the future we'll add everything up."}, {"Time_Start": 1004.4200000000001, "Time_End": 1009.4200000000001, "Text": " So if you look again at the example, it's not a real world,"}, {"Time_Start": 1009.4200000000001, "Time_End": 1015.4200000000001, "Text": " but I have more of these, sent against an AIX 3.2 base machine,"}, {"Time_Start": 1015.4200000000001, "Time_End": 1019.4200000000001, "Text": " see one query sent, a UDP query, got the error message,"}, {"Time_Start": 1019.4200000000001, "Time_End": 1022.4200000000001, "Text": " check for the IP total length, got the data,"}, {"Time_Start": 1022.4200000000001, "Time_End": 1027.42, "Text": " Got the base groups of operating systems,"}, {"Time_Start": 1027.42, "Time_End": 1031.42, "Text": " got the IP header check, got it miscalculated, got an AIX,"}, {"Time_Start": 1031.42, "Time_End": 1036.42, "Text": " well, how much time was used,"}, {"Time_Start": 1036.42, "Time_End": 1040.42, "Text": " 290 milliseconds to get the results, one packet cents,"}, {"Time_Start": 1040.42, "Time_End": 1044.42, "Text": " just processing the reply, and I get the operating system."}, {"Time_Start": 1044.42, "Time_End": 1048.42, "Text": " So you can see here, proceedings checked,"}, {"Time_Start": 1048.42, "Time_End": 1051.42, "Text": " amount of data bytes echo checked,"}, {"Time_Start": 1051.42, "Time_End": 1060.42, "Text": " checked, IP total length fill checked, the echoed value 118, and it was only 98."}, {"Time_Start": 1060.42, "Time_End": 1067.42, "Text": " So one packet, 290 milliseconds, you get AIX."}, {"Time_Start": 1067.42, "Time_End": 1073.42, "Text": " Someone got any question until that point, until this point?"}, {"Time_Start": 1073.42, "Time_End": 1076.42, "Text": " Yeah."}, {"Time_Start": 1076.42, "Time_End": 1080.42, "Text": " The implementation is publicly available, yeah."}, {"Time_Start": 1081.42, "Time_End": 1088.42, "Text": " So here's a way how we can identify OpenBSD 2.6 to 2.9 quite easily with one packet as well."}, {"Time_Start": 1088.42, "Time_End": 1096.42, "Text": " From 2.6 with OpenBSD, the IP total length code is less with 20 bytes than the original."}, {"Time_Start": 1096.42, "Time_End": 1100.42, "Text": " I don't know why they are doing it, but it's a problem."}, {"Time_Start": 1100.42, "Time_End": 1104.42, "Text": " There are some other reporting systems and networking devices doing so."}, {"Time_Start": 1104.42, "Time_End": 1108.42, "Text": " We look at another echoing integrity check."}, {"Time_Start": 1108.42, "Time_End": 1110.42, "Text": " Here's the UDP checks again."}, {"Time_Start": 1110.42, "Time_End": 1117.42, "Text": " Again, we get here NFR IDS appliance, which basically is open BSD with some minor changes."}, {"Time_Start": 1117.42, "Time_End": 1123.42, "Text": " It echoes the UDP checks in badly. We can identify it here."}, {"Time_Start": 1123.42, "Time_End": 1129.42, "Text": " We have basically two programming systems here, which can we do another echoing integrity test"}, {"Time_Start": 1129.42, "Time_End": 1134.42, "Text": " and get the open BSD 2.602.9 quite fast."}, {"Time_Start": 1134.42, "Time_End": 1139.42, "Text": " So if we look at another example, we can see that, again, one test here."}, {"Time_Start": 1139.42, "Time_End": 1144.42, "Text": " and some internal test for the reply I'm getting."}, {"Time_Start": 1144.42, "Time_End": 1149.42, "Text": " So pretty fast I'm getting open BSD 2.649."}, {"Time_Start": 1149.42, "Time_End": 1152.42, "Text": " Here is the example."}, {"Time_Start": 1152.42, "Time_End": 1157.42, "Text": " 310 milliseconds after sending the request."}, {"Time_Start": 1157.42, "Time_End": 1160.42, "Text": " I get the reply. You can see proceeding zero."}, {"Time_Start": 1160.42, "Time_End": 1163.42, "Text": " Amount of data by say code here."}, {"Time_Start": 1163.42, "Time_End": 1166.42, "Text": " IP headers, checks them, and UDPR are correct."}, {"Time_Start": 1166.42, "Time_End": 1169.4, "Text": " And the only parameter which is bad is the"}, {"Time_Start": 1169.42, "Time_End": 1173.42, "Text": " total length field value. So again gives you pretty fast,"}, {"Time_Start": 1173.42, "Time_End": 1178.42, "Text": " gives you the open BSD 2.8 to the group of 2.602.9."}, {"Time_Start": 1182.42, "Time_End": 1190.42, "Text": " So I was looking to do other tests with some good methods."}, {"Time_Start": 1190.42, "Time_End": 1195.42, "Text": " Again, one good method is three beats flags and off a set field value."}, {"Time_Start": 1195.42, "Time_End": 1199.4, "Text": " If you set it to a certain field value, it will flip between them with"}, {"Time_Start": 1199.42, "Time_End": 1206.42, "Text": " free BSD 2.2x, 241, and NetBST 13X group."}, {"Time_Start": 1206.42, "Time_End": 1213.42, "Text": " For example, here, if we are going to check what will be done here,"}, {"Time_Start": 1213.42, "Time_End": 1216.42, "Text": " you can see that this group will flip the beat order,"}, {"Time_Start": 1216.42, "Time_End": 1218.42, "Text": " and ULTRA just sends zero."}, {"Time_Start": 1218.42, "Time_End": 1220.42, "Text": " We can see a demonstration here."}, {"Time_Start": 1220.42, "Time_End": 1223.42, "Text": " It's a free VSD 4O machine."}, {"Time_Start": 1223.42, "Time_End": 1224.42, "Text": " We send one datagram."}, {"Time_Start": 1224.42, "Time_End": 1226.42, "Text": " It passes all our checks."}, {"Time_Start": 1226.42, "Time_End": 1228.42, "Text": " We see that the frag beats are flipped."}, {"Time_Start": 1228.42, "Time_End": 1232.42, "Text": " frag beats are flipped and we are doing another internal test, which basically involves"}, {"Time_Start": 1232.42, "Time_End": 1240.42, "Text": " looking at the IP header checksum echoed, which is zero with all free BSDs, and we get free BSD very fast."}, {"Time_Start": 1240.42, "Time_End": 1246.42, "Text": " Again, 350 milliseconds, one packet sent, internal test, and you get 3BSD 2.2X to 4.1."}, {"Time_Start": 1250.42, "Time_End": 1258.42, "Text": " Basically, with your reply, it's like looking at us fragmented package you have sent with your"}, {"Time_Start": 1258.42, "Time_End": 1263.42, "Text": " offending packet. What this basically was the DFB was set here, it was flipped,"}, {"Time_Start": 1263.42, "Time_End": 1266.42, "Text": " so it's parsed differently with the TCP dump."}, {"Time_Start": 1266.42, "Time_End": 1272.42, "Text": " Now this is what causes the UDP checks and, sorry, the IP header checks them,"}, {"Time_Start": 1272.42, "Time_End": 1276.42, "Text": " to be bad as well, if you can see it from the TCP dump trace."}, {"Time_Start": 1276.42, "Time_End": 1283.42, "Text": " So until now, we just quickly went through the"}, {"Time_Start": 1283.42, "Time_End": 1287.42, "Text": " most basic Unix printing systems."}, {"Time_Start": 1287.42, "Time_End": 1297.42, "Text": " systems. We saw that with one or with two packets we are able to identify pretty fast"}, {"Time_Start": 1297.42, "Time_End": 1304.42, "Text": " operating systems. Just as a reminder, this is also automated with the tool."}, {"Time_Start": 1304.42, "Time_End": 1310.42, "Text": " Now I needed an ultimate test to differentiate between Microsoft based operating systems"}, {"Time_Start": 1310.42, "Time_End": 1316.42, "Text": " to unique based operating systems. This was actually my first post-back about ICMP stuff."}, {"Time_Start": 1316.42, "Time_End": 1318.42, "Text": " about ICMP stuff."}, {"Time_Start": 1318.42, "Time_End": 1323.92, "Text": " What happens with Microsoft based is if you set the code field,"}, {"Time_Start": 1323.92, "Time_End": 1329.92, "Text": " there are type field and code field, which defines the type of ICMP message you are sending"}, {"Time_Start": 1329.92, "Time_End": 1336.42, "Text": " or receiving, if you play with a code field and you send a field value, which is different"}, {"Time_Start": 1336.42, "Time_End": 1341.76, "Text": " than zero, with your request, with your ICMP echo request, the reply with Microsoft"}, {"Time_Start": 1341.76, "Time_End": 1347.76, "Text": " base of operating systems will set the this field to zero."}, {"Time_Start": 1347.76, "Time_End": 1356.76, "Text": " Now the RFC states that you only have to change the type, recalculate the checksum, and send the error message back."}, {"Time_Start": 1356.76, "Time_End": 1360.76, "Text": " Well, I guess at Microsoft, they wanted to play God."}, {"Time_Start": 1360.76, "Time_End": 1366.76, "Text": " So they changed that to zero and send back the echo reply."}, {"Time_Start": 1366.76, "Time_End": 1370.76, "Text": " So we are able to identify each and every Microsoft based operating system."}, {"Time_Start": 1370.76, "Time_End": 1377.76, "Text": " system according to this little fingerprinting mechanism."}, {"Time_Start": 1377.76, "Time_End": 1385.76, "Text": " I loaded up another test with it, which uses preceding bits."}, {"Time_Start": 1385.76, "Time_End": 1388.76, "Text": " I will refer it a bit later and the DFB."}, {"Time_Start": 1388.76, "Time_End": 1392.76, "Text": " Let's look at the Microsoft branch."}, {"Time_Start": 1392.76, "Time_End": 1399.76, "Text": " After understanding from the ICMP echo reply that this belongs to Microsoft"}, {"Time_Start": 1399.76, "Time_End": 1404.76, "Text": " I have some unique test identifying this."}, {"Time_Start": 1404.76, "Time_End": 1407.76, "Text": " We'll look at the IPTTTL."}, {"Time_Start": 1407.76, "Time_End": 1416.76, "Text": " With Microsoft Windows 95, they are using 32 as the default field value for that field when the"}, {"Time_Start": 1416.76, "Time_End": 1417.76, "Text": " Sandy Echo Reply."}, {"Time_Start": 1417.76, "Time_End": 1421.76, "Text": " It is unique between the Microsoft based operating systems."}, {"Time_Start": 1421.76, "Time_End": 1424.76, "Text": " And others are using 128."}, {"Time_Start": 1424.76, "Time_End": 1429.76, "Text": " Now you will remember, I put the value inside the preceding bits with my"}, {"Time_Start": 1429.76, "Time_End": 1433.76, "Text": " ICMP echo request. What will happen is that there are some operating systems"}, {"Time_Start": 1433.76, "Time_End": 1439.76, "Text": " that will not echo back my preceding beats which I have set it with my request."}, {"Time_Start": 1439.76, "Time_End": 1441.76, "Text": " What will happen is, guess what?"}, {"Time_Start": 1441.76, "Time_End": 1447.76, "Text": " Microsoft Win 2K, SP1 and SP2 will not echo this field value."}, {"Time_Start": 1447.76, "Time_End": 1453.76, "Text": " So what will happen, it will allow us to identify Win 2K versions quite easily"}, {"Time_Start": 1453.76, "Time_End": 1457.76, "Text": " just after two packets and looking at the TTL,"}, {"Time_Start": 1457.76, "Time_End": 1458.76, "Text": " look at the code field, TTL."}, {"Time_Start": 1458.76, "Time_End": 1464.76, "Text": " TTL, preceding beats are zero, here we go with 2K of 2 packets."}, {"Time_Start": 1464.76, "Time_End": 1468.76, "Text": " The other Microsoft based running system, which are the older one,"}, {"Time_Start": 1468.76, "Time_End": 1472.76, "Text": " and I'm not referring to Microsoft Windows for Workgroups,"}, {"Time_Start": 1472.76, "Time_End": 1481.76, "Text": " 95, sorry, 98, 98, s e, M, T, and TSP 3 and LES, and now"}, {"Time_Start": 1481.76, "Time_End": 1486.76, "Text": " NT4, and T4, sorry, NT4, SP4 and above are here."}, {"Time_Start": 1486.76, "Time_End": 1488.76, "Text": " So we can differentiate with Windows."}, {"Time_Start": 1488.76, "Time_End": 1492.76, "Text": " as well, but let's look at the example with Win 2K."}, {"Time_Start": 1492.76, "Time_End": 1497.76, "Text": " This is a real, well example with Win 2K SP2."}, {"Time_Start": 1497.76, "Time_End": 1503.76, "Text": " You can see here, proceedings checked,"}, {"Time_Start": 1503.76, "Time_End": 1507.76, "Text": " amount of data echo checked, total length is fine,"}, {"Time_Start": 1507.76, "Time_End": 1513.76, "Text": " and we play another, we check another criteria here."}, {"Time_Start": 1513.76, "Time_End": 1517.76, "Text": " The DFBT is not echoed at all with our reply and is not flipped"}, {"Time_Start": 1517.76, "Time_End": 1523.76, "Text": " and is not flipped here you can see that so basically we need to send another packet"}, {"Time_Start": 1523.76, "Time_End": 1531.2, "Text": " if we're now sending it you can see where is that here that I set a certain"}, {"Time_Start": 1531.2, "Time_End": 1536.52, "Text": " field value inside the code field and I got back zero and I set a certain feel value"}, {"Time_Start": 1536.52, "Time_End": 1543.32, "Text": " for the preceding beats here it's sex hex and I didn't rip well I didn't see it back"}, {"Time_Start": 1543.32, "Time_End": 1547.32, "Text": " with the reply it wasn't echoed so"}, {"Time_Start": 1547.76, "Time_End": 1552.76, "Text": " This was Wimbledon.org. I wanted to see Anna Karnikova."}, {"Time_Start": 1555.76, "Time_End": 1559.76, "Text": " So I went to Wimbledon.org, yeah, go tennis."}, {"Time_Start": 1559.76, "Time_End": 1565.76, "Text": " And this is what I got there when using Wyn2K up there."}, {"Time_Start": 1565.76, "Time_End": 1572.76, "Text": " Here you can see the actual X running on Wimbledon.org, two tests."}, {"Time_Start": 1572.76, "Time_End": 1576.76, "Text": " All the internal tests gets you Windows 2K pretty fast."}, {"Time_Start": 1576.76, "Time_End": 1583.76, "Text": " fast. If we do banner grabbing, just to prove you guys that this is Windows 2000,"}, {"Time_Start": 1583.76, "Time_End": 1589.76, "Text": " here you get a great application running there called IIS 50."}, {"Time_Start": 1589.76, "Time_End": 1596.76, "Text": " And just type GoTennis, a couple of enters, and you get that."}, {"Time_Start": 1596.76, "Time_End": 1603.76, "Text": " So I wanted to differentiate between the entire group of Microsoft based on running systems."}, {"Time_Start": 1603.76, "Time_End": 1605.76, "Text": " Basically, we're out dependent here."}, {"Time_Start": 1605.76, "Time_End": 1611.76, "Text": " are out-dependent here upon our replies we are getting from our hosts."}, {"Time_Start": 1611.76, "Time_End": 1618.76, "Text": " As you will see in the next two examples, well, they give us what we need."}, {"Time_Start": 1618.76, "Time_End": 1625.76, "Text": " Here we send an ICMP timestamp request, differentiated between two groups, the NT4 and"}, {"Time_Start": 1625.76, "Time_End": 1627.76, "Text": " 98-90-E and ME."}, {"Time_Start": 1627.76, "Time_End": 1634.76, "Text": " For another address mask, I am able with a reply to identify 98-98-S-E and ME, which does not reply."}, {"Time_Start": 1634.76, "Time_End": 1637.76, "Text": " With the second address mask for the anti-box,"}, {"Time_Start": 1637.76, "Time_End": 1643.76, "Text": " I am able to differentiate between NTSP 3 minus and NTSP 4 plus."}, {"Time_Start": 1643.76, "Time_End": 1646.76, "Text": " So let's see some examples."}, {"Time_Start": 1646.76, "Time_End": 1648.76, "Text": " Skip."}, {"Time_Start": 1648.76, "Time_End": 1653.76, "Text": " Okay. Let's see that example. I will not skip it."}, {"Time_Start": 1653.76, "Time_End": 1657.76, "Text": " I have four tests here, as you can see."}, {"Time_Start": 1657.76, "Time_End": 1660.76, "Text": " And internal logic is being used here."}, {"Time_Start": 1660.76, "Time_End": 1664.74, "Text": " Identify the Microsoft Windows family TCPA"}, {"Time_Start": 1664.76, "Time_End": 1672.76, "Text": " stack and gives me NTSP 4 plus. As you can see from the trace, this is again, I'm"}, {"Time_Start": 1672.76, "Time_End": 1676.76, "Text": " looking, I see that I don't qualify for any of the test I'm using."}, {"Time_Start": 1676.76, "Time_End": 1681.76, "Text": " I'm using an echo request, set the code to 1-2-3,"}, {"Time_Start": 1681.76, "Time_End": 1688.76, "Text": " get the code 0, set the type of service to 6, get the type of service back."}, {"Time_Start": 1688.76, "Time_End": 1691.76, "Text": " This means this is not Win 2K machine."}, {"Time_Start": 1691.76, "Time_End": 1693.76, "Text": " Sending a timestamp request and address mask request."}, {"Time_Start": 1693.76, "Time_End": 1700.76, "Text": " an address request doesn't get any reply. So this is Winn-T4, SP4 and above."}, {"Time_Start": 1700.76, "Time_End": 1710.76, "Text": " So if you guys will not like my talk, I might join the French Foreign Legion and ran away for a couple of years."}, {"Time_Start": 1710.76, "Time_End": 1719.76, "Text": " So if you just look at what I got after I type triple W French foreign legend.org, I got a nice ur message."}, {"Time_Start": 1719.76, "Time_End": 1722.76, "Text": " That ASP, well, I guess what this is."}, {"Time_Start": 1722.76, "Time_End": 1729.76, "Text": " If you give us your name, an email address, we might call you for duty."}, {"Time_Start": 1729.76, "Time_End": 1731.76, "Text": " Okay, yeah, right."}, {"Time_Start": 1731.76, "Time_End": 1737.76, "Text": " So here is actual screenshot."}, {"Time_Start": 1737.76, "Time_End": 1741.76, "Text": " You can see X running on my box, French foreign legend,"}, {"Time_Start": 1741.76, "Time_End": 1745.76, "Text": " running Windows, NT4, SP4 and above."}, {"Time_Start": 1745.76, "Time_End": 1751.76, "Text": " Now, if you don't believe me, this is NMAPE."}, {"Time_Start": 1751.76, "Time_End": 1758.76, "Text": " this is NMAP. I was trying to do OS fingerprinting and give actually an open port"}, {"Time_Start": 1758.76, "Time_End": 1765.76, "Text": " that I can tell NMAP to use less traffic initiation to identify that machine."}, {"Time_Start": 1765.76, "Time_End": 1769.76, "Text": " But guess what? This didn't help in this case."}, {"Time_Start": 1769.76, "Time_End": 1772.76, "Text": " And I didn't get anything back."}, {"Time_Start": 1772.76, "Time_End": 1776.76, "Text": " So I was actually telling NMAP, okay, do whatever you want to."}, {"Time_Start": 1776.76, "Time_End": 1780.76, "Text": " And here, after 1,500 packets."}, {"Time_Start": 1780.76, "Time_End": 1786.76, "Text": " after I can get basically problematic results, as you can see."}, {"Time_Start": 1786.76, "Time_End": 1797.76, "Text": " NT4 or Win95 or Win98 or Winn24 SP3 or Winnet4 SP3 or Winnet4 server SP5 and the hot fixes."}, {"Time_Start": 1797.76, "Time_End": 1806.76, "Text": " This is not accurate, but if I can, for example, this is a good example to understand that if we can tell the tool"}, {"Time_Start": 1806.76, "Time_End": 1809.76, "Text": " that we are going to a web server, then Port 80 is open."}, {"Time_Start": 1809.76, "Time_End": 1816.76, "Text": " then port AD is open. I don't need it to port scan the operating system if I, for example, want to use an IIS exploit."}, {"Time_Start": 1816.76, "Time_End": 1818.76, "Text": " Right?"}, {"Time_Start": 1818.76, "Time_End": 1823.76, "Text": " So, I told you I'll get to Defcom.org."}, {"Time_Start": 1823.76, "Time_End": 1826.76, "Text": " Thanks to Jeff for letting me do that."}, {"Time_Start": 1826.76, "Time_End": 1829.76, "Text": " I like to design."}, {"Time_Start": 1829.76, "Time_End": 1839.76, "Text": " Defcon.org, basically what it gives me is the ability to show you why I need a failover magazine."}, {"Time_Start": 1839.76, "Time_End": 1847.76, "Text": " Well, because I'm sending a UDP datagram to closed port and I need the ICMP port and reachable,"}, {"Time_Start": 1847.76, "Time_End": 1851.76, "Text": " Jeff kindly, I'll close down the UDP stuff."}, {"Time_Start": 1851.76, "Time_End": 1855.76, "Text": " I want to thank him for giving me hard life here."}, {"Time_Start": 1855.76, "Time_End": 1863.76, "Text": " But if I'm just using the Windows portion of the tree as a query-only-only mechanism,"}, {"Time_Start": 1863.76, "Time_End": 1867.76, "Text": " this means, let's go back a bit."}, {"Time_Start": 1867.76, "Time_End": 1882.76, "Text": " If, for example, I start and use the, yeah, I've been here, I send the code field set to zero, set to a value different than zero, and I get a reply with the code zero."}, {"Time_Start": 1882.76, "Time_End": 1886.76, "Text": " And I can play only with the Microsoft base tree."}, {"Time_Start": 1886.76, "Time_End": 1889.76, "Text": " Now I have to get back."}, {"Time_Start": 1889.76, "Time_End": 1893.76, "Text": " Oh, I didn't think it's frightening the kid."}, {"Time_Start": 1897.76, "Time_End": 1901.76, "Text": " Okay."}, {"Time_Start": 1901.76, "Time_End": 1904.76, "Text": " I'm struggling here."}, {"Time_Start": 1904.76, "Time_End": 1905.76, "Text": " Okay."}, {"Time_Start": 1905.76, "Time_End": 1914.76, "Text": " So if I'm doing the same test, I'm able to state that Mr. Moss is running anti-4 SB 4 and above,"}, {"Time_Start": 1914.76, "Time_End": 1917.76, "Text": " and it actually was shut up."}, {"Time_Start": 1917.76, "Time_End": 1920.76, "Text": " And it was actually cross-referent with Jeff."}, {"Time_Start": 1920.76, "Time_End": 1924.76, "Text": " Yeah, if you try to play on that website, you'll have to deal with me."}, {"Time_Start": 1924.76, "Time_End": 1927.76, "Text": " So, as a courtesy,"}, {"Time_Start": 1927.76, "Time_End": 1931.56, "Text": " Jeff here are the traces."}, {"Time_Start": 1931.56, "Time_End": 1936.04, "Text": " You can see code fill is not echoed, proceedings are echoed."}, {"Time_Start": 1936.04, "Time_End": 1941.4, "Text": " So basically it gives you the other Microsoft based operating systems."}, {"Time_Start": 1941.4, "Time_End": 1946.2, "Text": " It doesn't answer timestem requests or address mask requests, which are allowed on the box."}, {"Time_Start": 1946.2, "Time_End": 1950.3, "Text": " And this is NT4, SB4 and above."}, {"Time_Start": 1950.3, "Time_End": 1956.8, "Text": " This is NMAP, again, trying to give MAMP a port to work with, and it gives me Winn-N-N-T-4,"}, {"Time_Start": 1956.8, "Time_End": 1969.5, "Text": " 95-198 trying to not to give any port and it generates in two minutes here this result, well,"}, {"Time_Start": 1969.5, "Time_End": 1973.46, "Text": " you saw that before."}, {"Time_Start": 1973.46, "Time_End": 1979.04, "Text": " So basically it's sure it tells me its Windows, but it doesn't let me understand what is the Windows"}, {"Time_Start": 1979.04, "Time_End": 1986.34, "Text": " I'm attacking or probing or auditing."}, {"Time_Start": 1986.3400000000001, "Time_End": 1989.0000000000002, "Text": " So we can do a lot of stuff more than that."}, {"Time_Start": 1989.0000000000002, "Time_End": 1993.88, "Text": " If we're going back to the main branch, we can do a lot of other tests."}, {"Time_Start": 1993.88, "Time_End": 2001.3600000000001, "Text": " I have set the DFBIT inside the echo request, and I'm expecting several operating systems when"}, {"Time_Start": 2001.3600000000001, "Time_End": 2007.3400000000001, "Text": " they generate the ICMP echo reply to put the DFB there, even though if they are not usually"}, {"Time_Start": 2007.3400000000001, "Time_End": 2008.7200000000003, "Text": " doing so."}, {"Time_Start": 2008.7200000000003, "Time_End": 2013.2200000000003, "Text": " This means that if I send the ICMP echo request without the DFB, the DFB will not be set with"}, {"Time_Start": 2013.2200000000003, "Time_End": 2014.1000000000001, "Text": " the reply."}, {"Time_Start": 2014.1000000000001, "Time_End": 2016.3200000000002, "Text": " So there are some operating systems with just, you know,"}, {"Time_Start": 2016.3400000000001, "Time_End": 2024.2200000000003, "Text": " flip around the IP addresses, do their recalculating, change the type, recalculate"}, {"Time_Start": 2024.2200000000003, "Time_End": 2027.16, "Text": " checksum, and send back the results."}, {"Time_Start": 2027.16, "Time_End": 2034.66, "Text": " There are some other operating systems which are more intelligent and will build up a new packet."}, {"Time_Start": 2034.66, "Time_End": 2041.2600000000002, "Text": " I don't know if no Vail or World Tricks are that intelligent, but here they didn't echo DDS"}, {"Time_Start": 2041.2600000000002, "Time_End": 2045.44, "Text": " bit and we are able to identify them both because of the TTL."}, {"Time_Start": 2045.44, "Time_End": 2054.2000000000003, "Text": " can do other tests like this with the error with the DFB to identify net BSD, the newer"}, {"Time_Start": 2054.2000000000003, "Time_End": 2059.48, "Text": " versions, and 2.4, 2.5, open BSD, and older open BSD as well."}, {"Time_Start": 2059.48, "Time_End": 2064.16, "Text": " So basically this is still here is two packets."}, {"Time_Start": 2064.16, "Time_End": 2069.16, "Text": " With the NT4 stuff, it was up to four packets, with Wintuket was two packets."}, {"Time_Start": 2069.16, "Time_End": 2071.76, "Text": " With Win 95, it was two packets."}, {"Time_Start": 2071.76, "Time_End": 2075.42, "Text": " So very small amount of packet sand."}, {"Time_Start": 2075.44, "Time_End": 2079.94, "Text": " and you see how fast the replies getting back and the calculation is being done."}, {"Time_Start": 2082.78, "Time_End": 2101.2400000000002, "Text": " If I still on the main branch, I can send NICP information request and try to identify DGUX, for example, different DGUX as HBOX 10X and open VMS."}, {"Time_Start": 2101.2400000000002, "Time_End": 2105.1, "Text": " I will not go through that because you all can read that from my website."}, {"Time_Start": 2105.44, "Time_End": 2108.2000000000003, "Text": " I want to show the examples."}, {"Time_Start": 2108.2000000000003, "Time_End": 2121.2400000000002, "Text": " Now, this is an example with DGUX 5.6, we have three datagrams sense here."}, {"Time_Start": 2121.2400000000002, "Time_End": 2128.9, "Text": " One is UDPC, closed port, ICNPECA request with various tests and information request, which is"}, {"Time_Start": 2128.9, "Time_End": 2134.04, "Text": " getting a response for that, and we can see another test and gets it as a DGUX."}, {"Time_Start": 2135.44, "Time_End": 2144.44, "Text": " Again, we do our magic here and here, and here, and here, and here, and here."}, {"Time_Start": 2144.44, "Time_End": 2148.44, "Text": " And basically get the results."}, {"Time_Start": 2148.44, "Time_End": 2160.44, "Text": " It's 632, yeah, basically 600 milliseconds after three packets and all the process."}, {"Time_Start": 2160.44, "Time_End": 2164.44, "Text": " So 600 milliseconds, you get DGUX 5.16."}, {"Time_Start": 2165.44, "Time_End": 2176.44, "Text": " So the rest of the three, so I can say I cover FreeBSD 4.125, might be unreliable according to our target."}, {"Time_Start": 2176.44, "Time_End": 2181.44, "Text": " If we are targeting an operating system and we know that we are targeting the operating system,"}, {"Time_Start": 2181.44, "Time_End": 2194.44, "Text": " for example, if we target, well, our next nice example would be a known website, we know that we are not targeting a networking device, which might be giving us faults."}, {"Time_Start": 2194.44, "Time_End": 2200.44, "Text": " us false results here. So basically, if we will follow the logic here and here,"}, {"Time_Start": 2200.44, "Time_End": 2211.44, "Text": " we'll be might be able to look at the 3BSDs now. If you didn't know, 3BSD 5O changed its IPTTTL field value with the replies to 64."}, {"Time_Start": 2211.44, "Time_End": 2217.44, "Text": " Guess, some didn't know that. So, you all know NESIS, right?"}, {"Time_Start": 2217.44, "Time_End": 2223.44, "Text": " Who doesn't know NES? Okay. This main Nes site."}, {"Time_Start": 2223.44, "Time_End": 2233.28, "Text": " basically what the tool gives me here is that I checked all the logic and this is some kind"}, {"Time_Start": 2233.28, "Time_End": 2240.44, "Text": " of a yinix the logic goes and stops at that point because of accuracy problem with"}, {"Time_Start": 2240.44, "Time_End": 2242.44, "Text": " the networking devices."}, {"Time_Start": 2242.44, "Time_End": 2250.68, "Text": " Now if you look closely at what we have received back, we can see that we have the"}, {"Time_Start": 2250.68, "Time_End": 2253.42, "Text": " UDP header checks on set to zero here and the"}, {"Time_Start": 2253.44, "Time_End": 2261.48, "Text": " time to live 64 was set to 64 initially here now if we'll go to the logic we can see"}, {"Time_Start": 2261.48, "Time_End": 2268.54, "Text": " that the IP header was okay the IP ID ID was okay we go down the udp checksum"}, {"Time_Start": 2268.54, "Time_End": 2276.3, "Text": " header was zero and the ttl was 64 so it needs to give us free BSD 5 oh now this"}, {"Time_Start": 2276.3, "Time_End": 2283.28, "Text": " is an map I guess it needs to feel it needs to insert the TTL thingy gives a freebSD 4.3"}, {"Time_Start": 2283.44, "Time_End": 2295.44, "Text": " Questions until this point? No questions. Yeah."}, {"Time_Start": 2295.44, "Time_End": 2298.44, "Text": " Yeah."}, {"Time_Start": 2298.44, "Time_End": 2309.44, "Text": " To have this example working, I have it's hard-coded."}, {"Time_Start": 2309.44, "Time_End": 2313.44, "Text": " But it's hard-coded, which is scheduled?"}, {"Time_Start": 2313.44, "Time_End": 2319.44, "Text": " we'll have its own fingerprinting database and a logic that will work dynamically"}, {"Time_Start": 2319.44, "Time_End": 2322.44, "Text": " with some nifty tricks in the database."}, {"Time_Start": 2322.44, "Time_End": 2326.44, "Text": " So what we'll have to do only is to put more fingerprinting inside a tool"}, {"Time_Start": 2326.44, "Time_End": 2329.44, "Text": " and run it independently."}, {"Time_Start": 2329.44, "Time_End": 2333.44, "Text": " Sure."}, {"Time_Start": 2339.44, "Time_End": 2342.44, "Text": " So people can tell, can send me fingerprints."}, {"Time_Start": 2342.44, "Time_End": 2349.44, "Text": " fingerprints. Yeah, well, if you'll be at the end of the slides, there are slides about this."}, {"Time_Start": 2349.44, "Time_End": 2352.44, "Text": " Thank you for reminding me this."}, {"Time_Start": 2352.44, "Time_End": 2359.44, "Text": " So I was thinking what websites can be interesting for myself to look and might interest you guys."}, {"Time_Start": 2359.44, "Time_End": 2365.44, "Text": " I went for one of the American favorite nations."}, {"Time_Start": 2365.44, "Time_End": 2371.44, "Text": " The nation that deny of service, the Navy, China."}, {"Time_Start": 2371.44, "Time_End": 2373.44, "Text": " China."}, {"Time_Start": 2373.44, "Time_End": 2382.44, "Text": " So in order to look what is so good at China and to see if they need some thick guys,"}, {"Time_Start": 2382.44, "Time_End": 2389.44, "Text": " I went to the Communist Party newspaper."}, {"Time_Start": 2389.44, "Time_End": 2393.44, "Text": " I went to People's Daily."}, {"Time_Start": 2393.44, "Time_End": 2397.44, "Text": " Now, what is so now is so now is about the Chinese newspaper"}, {"Time_Start": 2397.44, "Time_End": 2400.44, "Text": " is that everything is so cool in the world."}, {"Time_Start": 2400.44, "Time_End": 2401.44, "Text": " Here you see."}, {"Time_Start": 2401.44, "Time_End": 2408.44, "Text": " Chinese NBA player doing some good stuff and all the news are so good and"}, {"Time_Start": 2408.44, "Time_End": 2411.44, "Text": " everything is cool, so cool in the world."}, {"Time_Start": 2411.44, "Time_End": 2414.44, "Text": " Okay."}, {"Time_Start": 2414.44, "Time_End": 2419.44, "Text": " So I sent, I fired away X on People's Daily."}, {"Time_Start": 2419.44, "Time_End": 2427.44, "Text": " One packet got me back, People's Daily using OpenBSD, something between 2.6 to 2.9."}, {"Time_Start": 2427.44, "Time_End": 2431.44, "Text": " Okay, they weren't wise enough to use OpenBSD, but"}, {"Time_Start": 2431.44, "Time_End": 2435.44, "Text": " why not firewall UDP?"}, {"Time_Start": 2435.44, "Time_End": 2442.44, "Text": " You can see here why this traced back to OpenBSD,"}, {"Time_Start": 2442.44, "Time_End": 2446.44, "Text": " the IP total length field value is 20 bytes less"}, {"Time_Start": 2446.44, "Time_End": 2450.44, "Text": " than it was with the offending packet echoed 20 byte less"}, {"Time_Start": 2450.44, "Time_End": 2452.44, "Text": " and the other fields are okay."}, {"Time_Start": 2452.44, "Time_End": 2456.44, "Text": " So this is OpenBSD 2.6249, one packet's hand."}, {"Time_Start": 2456.44, "Time_End": 2459.44, "Text": " And you see the link to China, man."}, {"Time_Start": 2459.44, "Time_End": 2461.42, "Text": " I now understand why they"}, {"Time_Start": 2461.44, "Time_End": 2463.44, "Text": " denial of service in the Navy."}, {"Time_Start": 2463.44, "Time_End": 2467.44, "Text": " This is, look at how many milliseconds,"}, {"Time_Start": 2467.44, "Time_End": 2471.44, "Text": " it took like 360 milliseconds it took the reply to get back"}, {"Time_Start": 2471.44, "Time_End": 2475.44, "Text": " and for me to identify people'sdaily.com.c."}, {"Time_Start": 2475.44, "Time_End": 2479.44, "Text": " So, after looking at the newspaper,"}, {"Time_Start": 2479.44, "Time_End": 2483.44, "Text": " I was thinking, if it's so damn nice,"}, {"Time_Start": 2483.44, "Time_End": 2487.44, "Text": " let's get us something cool at Beijing."}, {"Time_Start": 2487.44, "Time_End": 2490.44, "Text": " Why not buying some mics?"}, {"Time_Start": 2490.44, "Time_End": 2497.44, "Text": " microphone stored Beijing but before that try to do the same thing with NMAP"}, {"Time_Start": 2497.44, "Time_End": 2502.44, "Text": " failed nine minutes after"}, {"Time_Start": 2502.44, "Time_End": 2504.44, "Text": " didn't get any results"}, {"Time_Start": 2504.44, "Time_End": 2509.44, "Text": " so it shows you that sometimes TCP is not enough"}, {"Time_Start": 2509.44, "Time_End": 2512.44, "Text": " and we need to fail over or use something else"}, {"Time_Start": 2512.44, "Time_End": 2516.44, "Text": " so I went to Beijing 7-iron audio"}, {"Time_Start": 2516.44, "Time_End": 2519.44, "Text": " I wanted that mics man"}, {"Time_Start": 2519.44, "Time_End": 2526.44, "Text": " So there is some kind of a microphone here, dynamic microphone,"}, {"Time_Start": 2526.44, "Time_End": 2531.44, "Text": " wireless microphone and other pro audio devices out of Beijing."}, {"Time_Start": 2531.44, "Time_End": 2537.44, "Text": " So I bet they have some kind of online orders form."}, {"Time_Start": 2537.44, "Time_End": 2544.44, "Text": " I went and tried to identify what it ran on and gave me Linux 2.2 or 2.4"}, {"Time_Start": 2544.44, "Time_End": 2548.44, "Text": " two packets here. You can see very nice."}, {"Time_Start": 2548.44, "Time_End": 2550.44, "Text": " for a audio shop."}, {"Time_Start": 2550.44, "Time_End": 2555.44, "Text": " Here is the same results with ANMAP"}, {"Time_Start": 2555.44, "Time_End": 2558.44, "Text": " gives the accurate results."}, {"Time_Start": 2558.44, "Time_End": 2561.44, "Text": " But again, the amount of packets I have to invest"}, {"Time_Start": 2561.44, "Time_End": 2564.44, "Text": " in order to get results is about 1,500"}, {"Time_Start": 2564.44, "Time_End": 2566.44, "Text": " if I don't specify the open ports."}, {"Time_Start": 2566.44, "Time_End": 2570.44, "Text": " It was so damn nice."}, {"Time_Start": 2570.44, "Time_End": 2575.44, "Text": " I was so satisfied with the microphones."}, {"Time_Start": 2575.44, "Time_End": 2577.44, "Text": " So I wanted to buy myself a car."}, {"Time_Start": 2577.44, "Time_End": 2582.44, "Text": " car was I mean the car car guy that combs."}, {"Time_Start": 2582.44, "Time_End": 2583.44, "Text": " ."}, {"Time_Start": 2583.44, "Time_End": 2585.44, "Text": " Why don't we have a Ferrari here?"}, {"Time_Start": 2585.44, "Time_End": 2588.44, "Text": " We just, we have this engine car."}, {"Time_Start": 2588.44, "Time_End": 2590.44, "Text": " I don't get it."}, {"Time_Start": 2590.44, "Time_End": 2594.44, "Text": " But there was a super awesome cool animation here"}, {"Time_Start": 2594.44, "Time_End": 2598.44, "Text": " that you don't see that gave it away as a"}, {"Time_Start": 2598.44, "Time_End": 2600.44, "Text": " you'll see what it is."}, {"Time_Start": 2600.44, "Time_End": 2606.44, "Text": " As a Microsoft Windows NTSP4 Plus based box."}, {"Time_Start": 2606.44, "Time_End": 2610.44, "Text": " box. The animation was so ugly, so I spare you."}, {"Time_Start": 2613.44, "Time_End": 2615.44, "Text": " Four packets, sent."}, {"Time_Start": 2615.44, "Time_End": 2617.44, "Text": " Really fast."}, {"Time_Start": 2617.44, "Time_End": 2620.44, "Text": " Identify it as Winn and TSP4."}, {"Time_Start": 2620.44, "Time_End": 2624.44, "Text": " Here again, sorry for the comparison with ANMA,"}, {"Time_Start": 2624.44, "Time_End": 2628.44, "Text": " but it's the tool that nearly everybody uses."}, {"Time_Start": 2628.44, "Time_End": 2632.44, "Text": " Here again, I get several results"}, {"Time_Start": 2632.44, "Time_End": 2635.44, "Text": " which the tool is not able to identify different TCP stuff"}, {"Time_Start": 2635.44, "Time_End": 2638.44, "Text": " stuff between Microsoft-based burning system."}, {"Time_Start": 2638.44, "Time_End": 2642.44, "Text": " It's not just NMAP, it's other tools that are based on TCP-only,"}, {"Time_Start": 2642.44, "Time_End": 2644.44, "Text": " nearly TCP-only stuff."}, {"Time_Start": 2644.44, "Time_End": 2649.44, "Text": " After all, I was sort of satisfied with my car."}, {"Time_Start": 2649.44, "Time_End": 2651.44, "Text": " I went to buy a trailer."}, {"Time_Start": 2651.44, "Time_End": 2658.44, "Text": " Look at that trailer, awesome trailer."}, {"Time_Start": 2658.44, "Time_End": 2663.44, "Text": " So I didn't understand anything, but I bet they need you to deposit something"}, {"Time_Start": 2663.44, "Time_End": 2664.44, "Text": " before you buy something."}, {"Time_Start": 2664.44, "Time_End": 2666.44, "Text": " thing."}, {"Time_Start": 2666.44, "Time_End": 2673.44, "Text": " So, Chinatrailer.com uses Linux 2.2 org 2.45."}, {"Time_Start": 2673.44, "Time_End": 2676.44, "Text": " 2.45."}, {"Time_Start": 2676.44, "Time_End": 2680.44, "Text": " Again, pretty fast."}, {"Time_Start": 2680.44, "Time_End": 2684.44, "Text": " You have to send two packets and you get the results."}, {"Time_Start": 2684.44, "Time_End": 2686.44, "Text": " This is accurate results."}, {"Time_Start": 2686.44, "Time_End": 2688.44, "Text": " It takes more time, more packets invested."}, {"Time_Start": 2688.44, "Time_End": 2693.44, "Text": " What is so nice with, this is my train stuff."}, {"Time_Start": 2693.44, "Time_End": 2694.44, "Text": " What is so,"}, {"Time_Start": 2694.44, "Time_End": 2700.44, "Text": " nice with X, you basically are very still because you don't understand what the hell hit you"}, {"Time_Start": 2700.44, "Time_End": 2703.44, "Text": " and you cannot understand that you've been mapped."}, {"Time_Start": 2703.44, "Time_End": 2707.44, "Text": " And now, if in the future and this is planned,"}, {"Time_Start": 2707.44, "Time_End": 2713.44, "Text": " I will add like real data portion information of a real application."}, {"Time_Start": 2713.44, "Time_End": 2716.44, "Text": " Say I identify DNS service of the organization."}, {"Time_Start": 2716.44, "Time_End": 2718.44, "Text": " I know where there are."}, {"Time_Start": 2718.44, "Time_End": 2723.44, "Text": " And I send this offending packet to UDP 53 and I steal some code for Manus Lookup."}, {"Time_Start": 2723.44, "Time_End": 2730.44, "Text": " and I do lookups and send them to the IP address, which is my target."}, {"Time_Start": 2730.44, "Time_End": 2733.44, "Text": " So what are the admins might say?"}, {"Time_Start": 2733.44, "Time_End": 2735.44, "Text": " Oh, look at that retard scrup kitty."}, {"Time_Start": 2735.44, "Time_End": 2737.44, "Text": " Thank you guy. I just mapped you."}, {"Time_Start": 2737.44, "Time_End": 2739.44, "Text": " I don't need anything back from you."}, {"Time_Start": 2739.44, "Time_End": 2748.44, "Text": " So adding some real world data portion to these scans might do much more still stuff."}, {"Time_Start": 2748.44, "Time_End": 2752.44, "Text": " And if you can play with the, you say, I want to send my UDP stuff with you"}, {"Time_Start": 2752.44, "Time_End": 2761.44, "Text": " OTP stuff with this and that application or randomize that, nobody will understand what you're doing."}, {"Time_Start": 2761.44, "Time_End": 2767.44, "Text": " So, after I was so satisfied with my trailer, I went to buy a train."}, {"Time_Start": 2767.44, "Time_End": 2773.44, "Text": " Up in Mongolia, there is a website called IM1MGT.com."}, {"Time_Start": 2773.44, "Time_End": 2778.44, "Text": " That's the end, which basically bids you, build you a train."}, {"Time_Start": 2778.44, "Time_End": 2781.44, "Text": " I was so impressed."}, {"Time_Start": 2782.44, "Time_End": 2786.44, "Text": " running on Win 2K, SP1, or SP2."}, {"Time_Start": 2786.44, "Time_End": 2791.44, "Text": " Again, two packets and I get the Win 2K Identifier."}, {"Time_Start": 2791.44, "Time_End": 2796.44, "Text": " Well, look at that."}, {"Time_Start": 2796.44, "Time_End": 2802.44, "Text": " You want to buy a train or you want to owe the world?"}, {"Time_Start": 2802.44, "Time_End": 2808.44, "Text": " If you look down, this is quite amazing because, hey, we are running black guys here."}, {"Time_Start": 2808.44, "Time_End": 2811.44, "Text": " And we're our old."}, {"Time_Start": 2811.44, "Time_End": 2816.44, "Text": " And we're ultra cool with all these open ports."}, {"Time_Start": 2816.44, "Time_End": 2820.44, "Text": " We have FTP, HTTP, HTTP, HDPS."}, {"Time_Start": 2820.44, "Time_End": 2823.44, "Text": " We play Doom here, man."}, {"Time_Start": 2823.44, "Time_End": 2827.44, "Text": " Does your management know that?"}, {"Time_Start": 2827.44, "Time_End": 2835.44, "Text": " So basically, I try to map these websites with NMAP as well."}, {"Time_Start": 2835.44, "Time_End": 2840.44, "Text": " I guess I'll chat with you other about giving some other kind of intelligence inside NMAP"}, {"Time_Start": 2840.44, "Time_End": 2841.44, "Text": " so we can."}, {"Time_Start": 2841.44, "Time_End": 2845.44, "Text": " can easily identify some Microsoft-based printing"}, {"Time_Start": 2845.44, "Time_End": 2848.44, "Text": " system because if you are using the default thing with NMAP,"}, {"Time_Start": 2848.44, "Time_End": 2850.44, "Text": " it sends echo request."}, {"Time_Start": 2850.44, "Time_End": 2853.44, "Text": " So if we play with some parameters,"}, {"Time_Start": 2853.44, "Time_End": 2857.44, "Text": " I might be doing that a bit better,"}, {"Time_Start": 2857.44, "Time_End": 2862.44, "Text": " and we can have the results better than that."}, {"Time_Start": 2862.44, "Time_End": 2865.44, "Text": " So here you can see that this is IIS5, Win 2K,"}, {"Time_Start": 2865.44, "Time_End": 2870.44, "Text": " so you can just believe me that it is the train stuff."}, {"Time_Start": 2870.44, "Time_End": 2871.44, "Text": " Okay."}, {"Time_Start": 2871.44, "Time_End": 2875.44, "Text": " after the train, I saw that stuff in China is so cool."}, {"Time_Start": 2875.44, "Time_End": 2880.44, "Text": " So I wanted to see how many childs I can have in China if I want to move there."}, {"Time_Start": 2884.44, "Time_End": 2887.44, "Text": " Statefamilyplanning.com!"}, {"Time_Start": 2887.44, "Time_End": 2889.44, "Text": " Look at that awesome view!"}, {"Time_Start": 2889.44, "Time_End": 2891.44, "Text": " This is what you see from your room when you..."}, {"Time_Start": 2891.44, "Time_End": 2893.44, "Text": " Okay, well, stop here."}, {"Time_Start": 2893.44, "Time_End": 2896.44, "Text": " Okay, so while they are running."}, {"Time_Start": 2896.44, "Time_End": 2900.44, "Text": " Oh, Windows 2000."}, {"Time_Start": 2900.44, "Time_End": 2901.44, "Text": " Windows 2000."}, {"Time_Start": 2901.44, "Time_End": 2904.44, "Text": " I guess they know their shit, I mean."}, {"Time_Start": 2906.44, "Time_End": 2908.44, "Text": " Oh, yeah."}, {"Time_Start": 2915.44, "Time_End": 2917.44, "Text": " This is FTP, SMTP."}, {"Time_Start": 2919.44, "Time_End": 2921.44, "Text": " Well, IRC."}, {"Time_Start": 2921.44, "Time_End": 2922.44, "Text": " But, dude."}, {"Time_Start": 2922.44, "Time_End": 2925.44, "Text": " He's IRC in the world with a server."}, {"Time_Start": 2925.44, "Time_End": 2930.44, "Text": " So everybody from the world can ask the same question and get real-time answers."}, {"Time_Start": 2930.44, "Time_End": 2937.44, "Text": " Um, again, Enma really failed to differentiate between 2000 M.E."}, {"Time_Start": 2937.44, "Time_End": 2945.44, "Text": " Um, so after I saw China is so damn cool."}, {"Time_Start": 2945.44, "Time_End": 2948.44, "Text": " I can have whatever child I want."}, {"Time_Start": 2948.44, "Time_End": 2949.44, "Text": " Yeah, sure."}, {"Time_Start": 2949.44, "Time_End": 2951.44, "Text": " I can buy my trailer, my truck."}, {"Time_Start": 2951.44, "Time_End": 2953.44, "Text": " I can buy a train."}, {"Time_Start": 2953.44, "Time_End": 2956.44, "Text": " I can buy my microphone cheap."}, {"Time_Start": 2956.44, "Time_End": 2959.44, "Text": " And I can have my favorite communist newspaper on the web."}, {"Time_Start": 2959.44, "Time_End": 2964.44, "Text": " on the web, I wanted to go to China so bad."}, {"Time_Start": 2964.44, "Time_End": 2967.44, "Text": " So my last example."}, {"Time_Start": 2967.44, "Time_End": 2973.44, "Text": " If I wanted to go to China, I need to get myself a visa right."}, {"Time_Start": 2973.44, "Time_End": 2976.44, "Text": " So I went to China Foreign Office."}, {"Time_Start": 2976.44, "Time_End": 2981.44, "Text": " This is the English side of the China Foreign Office,"}, {"Time_Start": 2981.44, "Time_End": 2985.44, "Text": " which tells you that what was there?"}, {"Time_Start": 2985.44, "Time_End": 2988.44, "Text": " Um, yeah, we met with President President."}, {"Time_Start": 2988.44, "Time_End": 2992.44, "Text": " we met with President Bush. Yeah, it's so cool."}, {"Time_Start": 2992.44, "Time_End": 2999.44, "Text": " And we just had a visit or calling power."}, {"Time_Start": 2999.44, "Time_End": 3004.44, "Text": " We visited and blah, blah, blah, blah, and a bunch of stuff that really helps you get to China."}, {"Time_Start": 3004.44, "Time_End": 3009.44, "Text": " And they really update their website, July 10."}, {"Time_Start": 3009.44, "Time_End": 3012.44, "Text": " Okay. Leave them alone."}, {"Time_Start": 3012.44, "Time_End": 3016.44, "Text": " I guess they run in Windows 2000."}, {"Time_Start": 3016.44, "Time_End": 3017.44, "Text": " You want to see what point?"}, {"Time_Start": 3017.44, "Time_End": 3019.44, "Text": " You want to see what ports are open?"}, {"Time_Start": 3021.44, "Time_End": 3022.44, "Text": " Here you go."}, {"Time_Start": 3029.44, "Time_End": 3033.44, "Text": " But just as a reminder, this is a byproduct of the NMAP scan."}, {"Time_Start": 3033.44, "Time_End": 3037.44, "Text": " The real cool thing is that I scan it with two packets, man."}, {"Time_Start": 3037.44, "Time_End": 3041.44, "Text": " Just to see the ports, the NetBio's SSN stuff."}, {"Time_Start": 3041.44, "Time_End": 3045.44, "Text": " Well, gee, don't we need updates from home?"}, {"Time_Start": 3045.44, "Time_End": 3050.44, "Text": " And PC anywhere."}, {"Time_Start": 3050.44, "Time_End": 3058.44, "Text": " You know, if someone really important comes to China and we need to update it immediately."}, {"Time_Start": 3058.44, "Time_End": 3064.44, "Text": " I hope the admin will stay alive after this talk."}, {"Time_Start": 3064.44, "Time_End": 3074.44, "Text": " So, I guess my name will be up up front on the list of the people who will not visit China in the next couple of years."}, {"Time_Start": 3074.44, "Time_End": 3075.44, "Text": " a few years."}, {"Time_Start": 3075.44, "Time_End": 3080.44, "Text": " And I will need to get a visa to get to China."}, {"Time_Start": 3080.44, "Time_End": 3086.44, "Text": " So these were just port scans and scans with my tool."}, {"Time_Start": 3086.44, "Time_End": 3089.44, "Text": " Just to show you up that in order to get accurate results,"}, {"Time_Start": 3089.44, "Time_End": 3091.44, "Text": " you don't need to puke in the network."}, {"Time_Start": 3091.44, "Time_End": 3093.44, "Text": " You can do it wisely."}, {"Time_Start": 3093.44, "Time_End": 3095.44, "Text": " Now how wisely you can do that."}, {"Time_Start": 3095.44, "Time_End": 3100.44, "Text": " For all the operating systems, it is listing here."}, {"Time_Start": 3100.44, "Time_End": 3103.44, "Text": " One query, two queries, three queries, four queries,"}, {"Time_Start": 3103.44, "Time_End": 3108.44, "Text": " queries and the tool is just 0.0.1 without a failover mechanism."}, {"Time_Start": 3108.44, "Time_End": 3111.44, "Text": " So I guess it's pretty cool."}, {"Time_Start": 3111.44, "Time_End": 3115.44, "Text": " What do I have to do next or what do I have to implement them?"}, {"Time_Start": 3115.44, "Time_End": 3116.44, "Text": " I'll do that fast."}, {"Time_Start": 3116.44, "Time_End": 3125.44, "Text": " I need to put some firewall checks, more firewall checks,"}, {"Time_Start": 3125.44, "Time_End": 3132.44, "Text": " and I need to do the logic thing, and I need to add DB support and"}, {"Time_Start": 3132.44, "Time_End": 3133.44, "Text": " fingerprinting DB."}, {"Time_Start": 3133.44, "Time_End": 3137.44, "Text": " more logic, failovers, artificial intelligence."}, {"Time_Start": 3137.44, "Time_End": 3139.44, "Text": " And you saw that this is working."}, {"Time_Start": 3139.44, "Time_End": 3142.44, "Text": " So, oh, well, what will happen with O.O2?"}, {"Time_Start": 3142.44, "Time_End": 3145.44, "Text": " This is an Operson's project."}, {"Time_Start": 3145.44, "Time_End": 3148.44, "Text": " In the next couple of days, there will be a page stating"}, {"Time_Start": 3148.44, "Time_End": 3152.44, "Text": " if you want to send me some information or fingerprints"}, {"Time_Start": 3152.44, "Time_End": 3154.44, "Text": " about the stuff you want to show me"}, {"Time_Start": 3154.44, "Time_End": 3158.44, "Text": " or you want to donate hardware because I have only two boxes."}, {"Time_Start": 3158.44, "Time_End": 3162.44, "Text": " And when installing 15 operating systems in four hours"}, {"Time_Start": 3162.44, "Time_End": 3163.44, "Text": " to just check some."}, {"Time_Start": 3163.44, "Time_End": 3170.44, "Text": " it's not that nice. If you'll go to my website, you can go and download the tool."}, {"Time_Start": 3170.44, "Time_End": 3177.44, "Text": " This is the last thing I added between Blackhead and DefCon."}, {"Time_Start": 3177.44, "Time_End": 3181.44, "Text": " Everybody is doing host detection, port scanning, then OS fingerprinting, and then exploiting."}, {"Time_Start": 3181.44, "Time_End": 3187.44, "Text": " This is dumb. Why? Because if I'm doing the OS fingerprinting in my style,"}, {"Time_Start": 3187.44, "Time_End": 3193.44, "Text": " if, for example, I'm using Win2K and I need to exploit IIS, and I'm not endorsing it in any"}, {"Time_Start": 3193.44, "Time_End": 3203.44, "Text": " anyway. No, really. So I can understand that I have Win 2K in two packets."}, {"Time_Start": 3203.44, "Time_End": 3210.44, "Text": " And for example, if I know what is my target, for example, web server, I can send the exploit right away."}, {"Time_Start": 3210.44, "Time_End": 3214.44, "Text": " So in three or four packets, I owe the box."}, {"Time_Start": 3214.44, "Time_End": 3222.44, "Text": " And this is really cool because with the other stuff that is being done today, you only scan to understand your burning system, which"}, {"Time_Start": 3222.44, "Time_End": 3228.44, "Text": " which you send a lot of packets, and basically it's not still."}, {"Time_Start": 3228.44, "Time_End": 3231.44, "Text": " But if you do the opposite way, using the stuff I showed you here,"}, {"Time_Start": 3231.44, "Time_End": 3233.44, "Text": " three to four packets you owe the box."}, {"Time_Start": 3233.44, "Time_End": 3236.44, "Text": " So just think about it."}, {"Time_Start": 3236.44, "Time_End": 3239.44, "Text": " Access available from my website."}, {"Time_Start": 3239.44, "Time_End": 3244.44, "Text": " Soon, there will be a page for XProb on SourceForge."}, {"Time_Start": 3244.44, "Time_End": 3246.44, "Text": " It will be a daily CVS."}, {"Time_Start": 3246.44, "Time_End": 3252.44, "Text": " Well, 0.0.0.2 will be unreliable for a lot of time until we'll stay."}, {"Time_Start": 3252.44, "Time_End": 3257.44, "Text": " it and it will be available from Feodorirachin website as well."}, {"Time_Start": 3257.44, "Time_End": 3260.44, "Text": " So we'll have four mirrors for that."}, {"Time_Start": 3260.44, "Time_End": 3265.44, "Text": " The failover mechanism was implemented by a simple nomad."}, {"Time_Start": 3265.44, "Time_End": 3272.44, "Text": " I didn't check, verified it until the end, so I might write that part again."}, {"Time_Start": 3272.44, "Time_End": 3276.44, "Text": " Acknowledgement, and this is important."}, {"Time_Start": 3276.44, "Time_End": 3278.44, "Text": " So bear with me."}, {"Time_Start": 3278.44, "Time_End": 3282.42, "Text": " I'd like to thank DT here for having me for the last year at that"}, {"Time_Start": 3282.44, "Time_End": 3284.44, "Text": " Black Hat World Tour."}, {"Time_Start": 3284.44, "Time_End": 3290.44, "Text": " J.D. Glaser, who was pressuring me to do the window thing,"}, {"Time_Start": 3290.44, "Time_End": 3291.44, "Text": " and it's evolved from there."}, {"Time_Start": 3291.44, "Time_End": 3295.44, "Text": " Simple Nomad and Todd Sabin for the time."}, {"Time_Start": 3295.44, "Time_End": 3298.44, "Text": " They gave me last year here at DAFCON who talked to me"}, {"Time_Start": 3298.44, "Time_End": 3302.44, "Text": " and basically listened to all my mumbo-jumbo"}, {"Time_Start": 3302.44, "Time_End": 3306.44, "Text": " when I did not have really stuff in hand."}, {"Time_Start": 3306.44, "Time_End": 3309.44, "Text": " Father Roachin for helping implement the stuff."}, {"Time_Start": 3309.44, "Time_End": 3311.44, "Text": " Marty Roach from Snort for"}, {"Time_Start": 3311.44, "Time_End": 3315.44, "Text": " for putting stuff at North."}, {"Time_Start": 3315.44, "Time_End": 3319.44, "Text": " Jennifer Granich for the legal advice."}, {"Time_Start": 3319.44, "Time_End": 3325.44, "Text": " The people that send me emails and help me out with my research."}, {"Time_Start": 3325.44, "Time_End": 3330.44, "Text": " And basically, you people for attending here."}, {"Time_Start": 3330.44, "Time_End": 3332.44, "Text": " Again, thank you, DT, for having me."}, {"Time_Start": 3332.44, "Time_End": 3334.44, "Text": " Thank you, guys."}]}