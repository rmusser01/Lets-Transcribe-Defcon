{"segments": [{"Time_Start": 0.0, "Time_End": 7.0, "Text": " Hello."}, {"Time_Start": 7.0, "Time_End": 29.900000000000002, "Text": " I'm Raven Alder and I'm here to talk to you guys about denial of service and distributed denial of service attacks and a handy"}, {"Time_Start": 30.0, "Time_End": 35.12, "Text": " little pearl script that I've written to track them through major ISP backbones."}, {"Time_Start": 35.12, "Time_End": 39.34, "Text": " Now I know most of you are probably pretty familiar with this, but just a quick background"}, {"Time_Start": 39.34, "Time_End": 43.92, "Text": " on denial of service and what we normally see to let you know what the problem is with"}, {"Time_Start": 43.92, "Time_End": 49.379999999999995, "Text": " ISPs and why a lot of them don't slash can't address it."}, {"Time_Start": 49.379999999999995, "Time_End": 54.22, "Text": " A lot of denial of service attacks that we're seeing are, beg pardon?"}, {"Time_Start": 54.22, "Time_End": 57.22, "Text": " Can you hear?"}, {"Time_Start": 57.22, "Time_End": 58.22, "Text": " Okay."}, {"Time_Start": 58.22, "Time_End": 59.22, "Text": " Better?"}, {"Time_Start": 59.22, "Time_End": 59.980000000000004, "Text": " Yes."}, {"Time_Start": 60.0, "Time_End": 61.0, "Text": " All right."}, {"Time_Start": 61.0, "Time_End": 67.28, "Text": " There are two major types of denial of service attacks that we see at my job."}, {"Time_Start": 67.28, "Time_End": 69.28, "Text": " I work for a major ISP."}, {"Time_Start": 69.28, "Time_End": 73.82, "Text": " We'll see denial of service attacks where they're just coming from maybe one or two clients"}, {"Time_Start": 73.82, "Time_End": 78.28, "Text": " with the source IP address is spoofed, or we'll see denial of service attacks that are coming"}, {"Time_Start": 78.28, "Time_End": 83.9, "Text": " from like 200 clients with legitimate IP addresses."}, {"Time_Start": 83.9, "Time_End": 88.56, "Text": " There was actually a script called DOS tracker that someone at MCI wrote a couple of years"}, {"Time_Start": 88.56, "Time_End": 89.56, "Text": " ago."}, {"Time_Start": 89.56, "Time_End": 93.66, "Text": " tracked the distributed denial of service attacks, but it only tracked one IP address"}, {"Time_Start": 93.66, "Time_End": 98.46000000000001, "Text": " at a time, so you'd have to run it repeatedly in order to get anything approaching tracking"}, {"Time_Start": 98.46000000000001, "Time_End": 99.74000000000001, "Text": " for modern DDoS attacks."}, {"Time_Start": 100.64, "Time_End": 106.38, "Text": " Now, the script that I've written is called Eyeball, and you can find it on SourceForge,"}, {"Time_Start": 106.58, "Time_End": 113.86, "Text": " source.net slash projects slash eyeball, and it's capable of tracking many IPs."}, {"Time_Start": 114.52000000000001, "Time_End": 117.0, "Text": " It's also capable of tracking spoofed addresses."}, {"Time_Start": 117.88, "Time_End": 119.54, "Text": " Currently, it only works on"}, {"Time_Start": 119.56, "Time_End": 125.22, "Text": " Cisco platforms. It does work okay on GSRs. We hope to add support for Juniper and Zebra"}, {"Time_Start": 125.22, "Time_End": 126.32000000000001, "Text": " routers in the near future."}, {"Time_Start": 129.32, "Time_End": 135.32, "Text": " www.source.net slash projects slash eyeball."}, {"Time_Start": 138.28, "Time_End": 143.74, "Text": " And the script, as you can happily see, is open source, so you're totally free to take the source"}, {"Time_Start": 143.74, "Time_End": 147.48000000000002, "Text": " code, modify it, change it. If you find any bugs or problems, please let me know."}, {"Time_Start": 149.56, "Time_End": 157.0, "Text": " You can also send email to me at Ravengeek at sours."}, {"Time_Start": 157.0, "Time_End": 158.12, "Text": " Sours.s.net."}, {"Time_Start": 158.12, "Time_End": 164.94, "Text": " Now, the problem that most ISPs have in dealing with denial of service attacks is that actually"}, {"Time_Start": 164.94, "Time_End": 168.88, "Text": " tracking down anything with a spoofed address takes absolute ages."}, {"Time_Start": 168.88, "Time_End": 173.04, "Text": " You have to log into each router in the path, so you usually start at the router closest to the"}, {"Time_Start": 173.04, "Time_End": 174.88, "Text": " customer being attacked."}, {"Time_Start": 174.88, "Time_End": 179.12, "Text": " You can log in, throw an access list on there on the Cisco platform with the log-in,"}, {"Time_Start": 179.12, "Time_End": 184.12, "Text": " log input keyword, which will log where the actual source interface is of the traffic"}, {"Time_Start": 184.12, "Time_End": 190.12, "Text": " coming into the router and then track it back. Most links are point-to-point, so you don't really"}, {"Time_Start": 190.12, "Time_End": 194.12, "Text": " have a lot of problems figuring out what's on the other side of that link."}, {"Time_Start": 194.12, "Time_End": 203.12, "Text": " Now, doing this manually takes hours. Doing this manually when you have 200 source addresses,"}, {"Time_Start": 203.12, "Time_End": 209.1, "Text": " most ISPs won't even bother. And this script obviously is not going to change that. What"}, {"Time_Start": 209.12, "Time_End": 213.68, "Text": " What it can do is automate the process and give you a list of, here are the IPs at which"}, {"Time_Start": 213.68, "Time_End": 216.68, "Text": " this attack traffic entered your network."}, {"Time_Start": 216.68, "Time_End": 228.36, "Text": " All right, so licensing for the script we covered already, it's GPL, have at it."}, {"Time_Start": 228.36, "Time_End": 233.12, "Text": " Also a quick thank you to Ben Stern, Tiffany Mork, Steve Ains, and most of all, my husband Raven"}, {"Time_Start": 233.12, "Time_End": 238.66, "Text": " Black, for much help in getting this up and running and tested and all that."}, {"Time_Start": 238.66, "Time_End": 238.68, "Text": " All right."}, {"Time_Start": 238.68, "Time_End": 240.6, "Text": " In order to run this script, it's a Perl script."}, {"Time_Start": 240.6, "Time_End": 243.6, "Text": " You obviously need a Perl environment wherever you're set up."}, {"Time_Start": 243.6, "Time_End": 247.36, "Text": " You will have to set up little access files with your username and passwords."}, {"Time_Start": 247.36, "Time_End": 254.06, "Text": " On Cisco's, you will usually require a regular password to just log on via Telnet, your VTY"}, {"Time_Start": 254.06, "Time_End": 258.96000000000004, "Text": " passwords, and enable password or enable secret."}, {"Time_Start": 258.96000000000004, "Time_End": 264.44, "Text": " The file that you'll set up can handle TACX or things where you have an actual username, whether"}, {"Time_Start": 264.44, "Time_End": 268.66, "Text": " it's just TACX for the login and then regular local database password."}, {"Time_Start": 268.68, "Time_End": 271.68, "Text": " for the enable or whether it's TACX the whole way."}, {"Time_Start": 271.68, "Time_End": 275.92, "Text": " If you have your router set up so that you can have more than one authentication method, i.e."}, {"Time_Start": 275.92, "Time_End": 280.54, "Text": " Attack X server and then fall back to local bases, you just run the little script to set up"}, {"Time_Start": 280.54, "Time_End": 285.62, "Text": " your file twice and then append the second onto there."}, {"Time_Start": 285.62, "Time_End": 291.06, "Text": " Bundled with the package, which you can get on SourceForge, is a script called Router Access"}, {"Time_Start": 291.06, "Time_End": 292.8, "Text": " and code."}, {"Time_Start": 292.8, "Time_End": 298.66, "Text": " You invoke that with output, the little angle bracket output, towards a file called Router"}, {"Time_Start": 298.68, "Time_End": 302.92, "Text": " Router Access-Default. DotRouter Access-Default."}, {"Time_Start": 302.92, "Time_End": 309.26, "Text": " And it will prompt you for your username, your login password, and your Enable password."}, {"Time_Start": 309.26, "Time_End": 314.26, "Text": " This uses the NetTelnet Cisco module and Perl, which will intelligently handle logins."}, {"Time_Start": 314.26, "Time_End": 318.42, "Text": " So if you give it a username and the router happens to be configured to only authenticate"}, {"Time_Start": 318.42, "Time_End": 322.86, "Text": " from a local database and doesn't use usernames, then it won't return the username for the password"}, {"Time_Start": 322.86, "Time_End": 323.86, "Text": " or anything like that."}, {"Time_Start": 323.86, "Time_End": 325.26, "Text": " It should work just fine."}, {"Time_Start": 325.26, "Time_End": 328.66, "Text": " If you have a backup method, run script twice, but the second time, you can't use."}, {"Time_Start": 328.68, "Time_End": 335.08, "Text": " append the output to .rater access dash default and that will put in, if it fails"}, {"Time_Start": 335.08, "Time_End": 340.0, "Text": " on the first authentication, try again with the second set of username and passwords."}, {"Time_Start": 340.0, "Time_End": 340.96000000000004, "Text": " This should handle radius."}, {"Time_Start": 340.96000000000004, "Time_End": 345.36, "Text": " I haven't tried it with that, but it works okay on TACX and local passwords."}, {"Time_Start": 345.36, "Time_End": 347.44, "Text": " All right."}, {"Time_Start": 347.44, "Time_End": 353.64, "Text": " Now, once you've set up this script there, the dotrider access default file has to be located"}, {"Time_Start": 353.64, "Time_End": 356.5, "Text": " in your home directory to actually work."}, {"Time_Start": 356.5, "Time_End": 358.66, "Text": " All these files that Eyeball uses should."}, {"Time_Start": 358.68, "Time_End": 361.96, "Text": " should be located in the same directory, but that doesn't matter whether it's your"}, {"Time_Start": 361.96, "Time_End": 362.8, "Text": " home directory or not."}, {"Time_Start": 362.8, "Time_End": 367.3, "Text": " The only thing that has to be in your home directory is the dot router access default."}, {"Time_Start": 367.3, "Time_End": 373.3, "Text": " Also, the encryption that's done on the dot router access default is really, really weak."}, {"Time_Start": 373.3, "Time_End": 376.88, "Text": " It's almost like the, you know, rot 13 or something."}, {"Time_Start": 376.88, "Time_End": 381.8, "Text": " So it's only there to prevent a casual observer who happens to, you know, look at your console"}, {"Time_Start": 381.8, "Time_End": 383.8, "Text": " or something from knowing your passwords."}, {"Time_Start": 383.8, "Time_End": 388.24, "Text": " Do not store this with permission so that anyone else can read it because they can decrypt"}, {"Time_Start": 388.24, "Time_End": 393.24, "Text": " and decrypted with a napkin and a pen."}, {"Time_Start": 393.24, "Time_End": 395.42, "Text": " All right."}, {"Time_Start": 395.42, "Time_End": 402.92, "Text": " So after you have created the proper router access and default file, you will also have to set"}, {"Time_Start": 402.92, "Time_End": 407.36, "Text": " an environment variable for the eyeball access list."}, {"Time_Start": 407.36, "Time_End": 411.62, "Text": " Now, the way that this script works is it will go into each router in your network and create"}, {"Time_Start": 411.62, "Time_End": 413.62, "Text": " an access list with the same number."}, {"Time_Start": 413.62, "Time_End": 417.96000000000004, "Text": " The way that Cisco does access lists, they have their access list grouped by number and the number"}, {"Time_Start": 417.96000000000004, "Time_End": 420.04, "Text": " represents the type of access list it is."}, {"Time_Start": 420.04, "Time_End": 424.20000000000005, "Text": " So anything between 101 and 199 is going to be an extended IP access list."}, {"Time_Start": 424.20000000000005, "Time_End": 425.40000000000003, "Text": " That's what you want to use."}, {"Time_Start": 425.40000000000003, "Time_End": 430.40000000000003, "Text": " You have to make sure that this access list is not used on any other router in your network."}, {"Time_Start": 430.40000000000003, "Time_End": 434.46000000000004, "Text": " Otherwise, when the script logs in, tries to create the access list, depending on the version"}, {"Time_Start": 434.46000000000004, "Time_End": 438.92, "Text": " of iOS and the bugs they're in, it may overwrite, it may change, it may just totally delete"}, {"Time_Start": 438.92, "Time_End": 441.40000000000003, "Text": " your other access list and screw up your routing otherwise."}, {"Time_Start": 441.40000000000003, "Time_End": 442.8, "Text": " So bad idea."}, {"Time_Start": 442.8, "Time_End": 447.70000000000005, "Text": " The script, if you do not have this set, will actually kick up an error message and say you need"}, {"Time_Start": 447.7, "Time_End": 451.64, "Text": " to set an environment variable for eyeball access list."}, {"Time_Start": 451.64, "Time_End": 455.08, "Text": " So just find an unused number between 101 and 199."}, {"Time_Start": 455.08, "Time_End": 457.94, "Text": " You're all set."}, {"Time_Start": 457.94, "Time_End": 462.82, "Text": " Also, one of the things that was originally somewhat challenging"}, {"Time_Start": 462.82, "Time_End": 466.65999999999997, "Text": " is the router needs to know what is on your network."}, {"Time_Start": 466.65999999999997, "Time_End": 469.82, "Text": " Assuming that you're a ISP or a provider, otherwise,"}, {"Time_Start": 469.82, "Time_End": 472.94, "Text": " you don't want the script attempting to log into the routers"}, {"Time_Start": 472.94, "Time_End": 474.28, "Text": " of your peers, et cetera, et cetera."}, {"Time_Start": 474.28, "Time_End": 476.8, "Text": " So just crawling through the network and going interface by interface"}, {"Time_Start": 476.8, "Time_End": 481.40000000000003, "Text": " until your passwords fail is not really a good idea and tends to annoy people."}, {"Time_Start": 481.40000000000003, "Time_End": 487.36, "Text": " So you have to create a list of IP addresses or of host names that you own, essentially,"}, {"Time_Start": 487.36, "Time_End": 490.44, "Text": " that the script is allowed to attempt to log into."}, {"Time_Start": 490.44, "Time_End": 496.52, "Text": " And we've also included here a script that will create that list for you."}, {"Time_Start": 496.52, "Time_End": 501.08000000000004, "Text": " Most ISPs that I know have a list of their routers, so that when they want to make some sort"}, {"Time_Start": 501.08000000000004, "Time_End": 504.92, "Text": " of policy change, they can just go through a script to change to all the routers."}, {"Time_Start": 504.92, "Time_End": 506.32, "Text": " So the eyeball make-induced."}, {"Time_Start": 506.32, "Time_End": 508.59999999999997, "Text": " make interface list.pl script."}, {"Time_Start": 509.26, "Time_End": 510.36, "Text": " We'll take care of that for you."}, {"Time_Start": 510.4, "Time_End": 517.1, "Text": " It takes the list of your routers as input, and you have to direct the output to a file called"}, {"Time_Start": 517.1, "Time_End": 518.42, "Text": " eyeball valid routers."}, {"Time_Start": 518.42, "Time_End": 519.12, "Text": " dot text."}, {"Time_Start": 520.52, "Time_End": 524.6, "Text": " If you are constantly adding things to your network and removing things in your network,"}, {"Time_Start": 524.7, "Time_End": 530.3199999999999, "Text": " you may want to chron the script so you run it, you know, once a day, at night, during your off-peak hours,"}, {"Time_Start": 530.4, "Time_End": 535.34, "Text": " whenever, so that you always have a current list of IP addresses that your routers, that the script"}, {"Time_Start": 535.34, "Time_End": 536.3, "Text": " can log into for your"}, {"Time_Start": 536.32, "Time_End": 537.32, "Text": " routers."}, {"Time_Start": 537.32, "Time_End": 543.32, "Text": " Myelbrouter list.text there is just whatever you call your input list."}, {"Time_Start": 543.32, "Time_End": 549.12, "Text": " All right, so once you've run these two scripts, you'll have everything to set up, set"}, {"Time_Start": 549.12, "Time_End": 551.72, "Text": " the environment variable for eyeball access list."}, {"Time_Start": 551.72, "Time_End": 555.7600000000001, "Text": " Oh, one other thing that should be set."}, {"Time_Start": 555.7600000000001, "Time_End": 558.6400000000001, "Text": " The eyeball wait time variable."}, {"Time_Start": 558.6400000000001, "Time_End": 563.46, "Text": " It's set to default to 10 seconds, and it's just how long that access list will remain on the router"}, {"Time_Start": 563.46, "Time_End": 565.0200000000001, "Text": " before being pulled off."}, {"Time_Start": 565.0200000000001, "Time_End": 566.12, "Text": " So how long it'll be there."}, {"Time_Start": 566.12, "Time_End": 569.54, "Text": " trying to log the attack packets."}, {"Time_Start": 569.54, "Time_End": 574.5, "Text": " 10 seconds is a default, but if your routers run any sort of fast switching, Cisco Express"}, {"Time_Start": 574.5, "Time_End": 579.68, "Text": " forwarding, things like that, we have seen problems with Cisco's implementation because fast"}, {"Time_Start": 579.68, "Time_End": 584.36, "Text": " switch packets do not get written into the system log."}, {"Time_Start": 584.36, "Time_End": 588.5, "Text": " So if you're dealing with an attack where it's like one packet a minute or something, then you'll"}, {"Time_Start": 588.5, "Time_End": 593.44, "Text": " want to expand the highball wait time variable to leave the list on there for maybe two minutes"}, {"Time_Start": 593.44, "Time_End": 594.88, "Text": " or something to catch each packet."}, {"Time_Start": 594.88, "Time_End": 596.1, "Text": " Now, this is going to slow down."}, {"Time_Start": 596.12, "Time_End": 600.44, "Text": " the run of the script because every router you log into, you'll have to wait that much"}, {"Time_Start": 600.44, "Time_End": 604.74, "Text": " time for it to catch the packets as well as all the logging in, chewing through the output,"}, {"Time_Start": 604.74, "Time_End": 608.54, "Text": " time, et cetera."}, {"Time_Start": 608.54, "Time_End": 615.36, "Text": " There are two more debug variables that you can set if you want to actually see output."}, {"Time_Start": 615.36, "Time_End": 618.8, "Text": " Eyeball Ultra Debug and Eyeball Insane Debug."}, {"Time_Start": 618.8, "Time_End": 625.22, "Text": " Iball UltraDug, if you just set it to one, it will turn on debugging output so that you can see what the commands"}, {"Time_Start": 625.22, "Time_End": 626.1, "Text": " you put into each run."}, {"Time_Start": 626.12, "Time_End": 630.12, "Text": " router are. You can also see some helpful comments that I've thrown in the script."}, {"Time_Start": 630.12, "Time_End": 635.12, "Text": " I've all insane debug will turn on what the router sends back to you. That's a whole lot of output."}, {"Time_Start": 635.12, "Time_End": 641.12, "Text": " It's like a show log of each router that you go through. You'll see the show ins in the show frame"}, {"Time_Start": 641.12, "Time_End": 647.12, "Text": " or show frame of the map, et cetera, et cetera, lots and lots of stuff."}, {"Time_Start": 647.12, "Time_End": 656.1, "Text": " So that pretty much covers the prerequisites. Oh, also, on your routers for this to work. Most people do, but you will have to have logging"}, {"Time_Start": 656.12, "Time_End": 660.12, "Text": " buffered debugging or logging buffered informational turned on so that there is a local"}, {"Time_Start": 660.12, "Time_End": 662.96, "Text": " syslog on the router for the script to write to."}, {"Time_Start": 662.96, "Time_End": 666.88, "Text": " If there isn't, it does not go out to your syslog demon and parse through the logs or any such"}, {"Time_Start": 666.88, "Time_End": 668.88, "Text": " things."}, {"Time_Start": 668.88, "Time_End": 672.88, "Text": " All right."}, {"Time_Start": 672.88, "Time_End": 677.94, "Text": " Using the script itself, it takes as command line arguments, the router that you want to start"}, {"Time_Start": 677.94, "Time_End": 683.04, "Text": " tracking on, which will almost always be the router right next to the customer being attacked."}, {"Time_Start": 683.04, "Time_End": 684.88, "Text": " The IP address that is being attacked."}, {"Time_Start": 684.88, "Time_End": 686.1, "Text": " Currently, the script only support."}, {"Time_Start": 686.12, "Time_End": 691.88, "Text": " one IP address being attacked at a time could expand that in the future."}, {"Time_Start": 691.88, "Time_End": 698.98, "Text": " And you can also specify the type of traffic, IP, TCP, ICMP, UDP, what have you."}, {"Time_Start": 698.98, "Time_End": 703.88, "Text": " We will probably be including, specifying the port numbers in future, but the script doesn't"}, {"Time_Start": 703.88, "Time_End": 709.0, "Text": " do that at the moment."}, {"Time_Start": 709.0, "Time_End": 713.5600000000001, "Text": " IP is the default type of attack traffic if you do not specify this."}, {"Time_Start": 713.5600000000001, "Time_End": 716.1, "Text": " This has caused problems in some implementations if the kind of"}, {"Time_Start": 716.12, "Time_End": 720.12, "Text": " is being ping flooded and you just look for IP traffic."}, {"Time_Start": 720.12, "Time_End": 724.12, "Text": " Oh, thank you."}, {"Time_Start": 724.12, "Time_End": 728.12, "Text": " So if it's a ping flood attack, make sure you set it to ICMP."}, {"Time_Start": 728.12, "Time_End": 732.12, "Text": " All right, while the script is running, you should be seeing messages printed to your display,"}, {"Time_Start": 732.12, "Time_End": 736.12, "Text": " letting you know which routers that the script is logging into, what it's seeing in the output,"}, {"Time_Start": 736.12, "Time_End": 740.12, "Text": " whether it's found packets or not, and what the routers that it's going through."}, {"Time_Start": 740.12, "Time_End": 741.12, "Text": " The script's multi-threaded."}, {"Time_Start": 741.12, "Time_End": 746.1, "Text": " So if you are coming in through several different places off of one router, it will branch at that"}, {"Time_Start": 746.12, "Time_End": 754.12, "Text": " and start running the script or rather start logging into the several routers from each individual point."}, {"Time_Start": 754.12, "Time_End": 759.12, "Text": " Oh, and blame for this is mine."}, {"Time_Start": 759.12, "Time_End": 763.12, "Text": " So comments, questions, suggestions, bug reports, etc."}, {"Time_Start": 763.12, "Time_End": 766.12, "Text": " Send to Ravengeek at user sourceforge.net."}, {"Time_Start": 766.12, "Time_End": 775.12, "Text": " All right, let's get to the script."}, {"Time_Start": 775.12, "Time_End": 779.0600000000001, "Text": " All right, let's get to the script."}, {"Time_Start": 779.0600000000001, "Time_End": 784.12, "Text": " It uses a module called router access, which is included with the distribution of the script,"}, {"Time_Start": 784.12, "Time_End": 789.96, "Text": " and all that router access does is throws the login functions on there."}, {"Time_Start": 789.96, "Time_End": 794.8, "Text": " You'll see them called a bit later."}, {"Time_Start": 794.8, "Time_End": 799.02, "Text": " It will take the router the attacked address and the packet type is arguments, and you can"}, {"Time_Start": 799.02, "Time_End": 801.0600000000001, "Text": " specify the wait time as an environment variable."}, {"Time_Start": 801.0600000000001, "Time_End": 803.64, "Text": " It does not check that from the command line."}, {"Time_Start": 803.64, "Time_End": 805.1, "Text": " You'll get an error message there."}, {"Time_Start": 805.12, "Time_End": 810.12, "Text": " if you don't have eyeball access list set as an environment variable."}, {"Time_Start": 810.12, "Time_End": 821.12, "Text": " You can see we have a function here to actually throw on, or rather a array there, to throw on the access lists on the router and to remove it."}, {"Time_Start": 821.12, "Time_End": 824.12, "Text": " Simple Cisco commands that you guys are probably really familiar with."}, {"Time_Start": 824.12, "Time_End": 827.12, "Text": " You'll notice the host keyword in the access list."}, {"Time_Start": 827.12, "Time_End": 832.12, "Text": " This is because it only goes through one attacked IP address at a time."}, {"Time_Start": 832.12, "Time_End": 835.1, "Text": " If you have several addresses,"}, {"Time_Start": 835.12, "Time_End": 839.76, "Text": " being attacked, then I would suggest running it, at least until we put support in for"}, {"Time_Start": 839.76, "Time_End": 845.12, "Text": " that, running it once for each IP being attacked. The script will output to eyeball output."}, {"Time_Start": 845.12, "Time_End": 849.62, "Text": " .text in the directory that you have invoked it from with all your eyeball stuff in it."}, {"Time_Start": 849.62, "Time_End": 854.62, "Text": " I would move that after I have done each individual address being attacked, so it doesn't"}, {"Time_Start": 854.62, "Time_End": 856.12, "Text": " overwrite a pen to any such thing."}, {"Time_Start": 865.12, "Time_End": 869.12, "Text": " the array here to actually take commands off the router."}, {"Time_Start": 873.12, "Time_End": 879.12, "Text": " Now, when it first tries to log into a router, it will print an error message to the console if it actually can't log into the router."}, {"Time_Start": 879.12, "Time_End": 885.12, "Text": " Otherwise, we'll give you, I've logged in, it took this many seconds to this particular router."}, {"Time_Start": 885.12, "Time_End": 890.62, "Text": " It uses the Shover command to distinguish between a regular Cisco router and a Cisco"}, {"Time_Start": 890.62, "Time_End": 895.1, "Text": " GIG switch router because the logging format and a couple of other things are different on the GIGGG"}, {"Time_Start": 895.12, "Time_End": 899.38, "Text": " switch routers. If you actually look at the show log on the output for a gig switch"}, {"Time_Start": 899.38, "Time_End": 905.12, "Text": " router, you will see at the beginning of the line, slot 7, and then later on pause 0 for"}, {"Time_Start": 905.12, "Time_End": 913.72, "Text": " pause 0 on a line card. So, Schover identifies the difference between the gig switch router"}, {"Time_Start": 913.72, "Time_End": 918.8, "Text": " and a regular one. I believe that I'm not real savvy with Juniper's, but I've been told"}, {"Time_Start": 918.8, "Time_End": 922.5600000000001, "Text": " that Chauver will also work on a juniper, so when we start including those in, we'll"}, {"Time_Start": 922.5600000000001, "Time_End": 924.96, "Text": " probably also differentiate via Juniper's that way."}, {"Time_Start": 925.12, "Time_End": 934.0600000000001, "Text": " So, now in order to determine which way the, which interface the attack traffic is going"}, {"Time_Start": 934.0600000000001, "Time_End": 939.9, "Text": " out, it will do a show IP route on the address that's being attacked."}, {"Time_Start": 939.9, "Time_End": 944.0, "Text": " If this is not something directly connected, then it will just do a show IP route on the next"}, {"Time_Start": 944.0, "Time_End": 947.48, "Text": " hop repeatedly until it gets to something that is directly connected."}, {"Time_Start": 947.48, "Time_End": 952.22, "Text": " This is because when we put the access list on the interface, we're going to apply the access list"}, {"Time_Start": 952.22, "Time_End": 955.1, "Text": " outbound on the interface that is facing the access list."}, {"Time_Start": 955.12, "Time_End": 961.2, "Text": " router being attacked. We can use the log input command on there to log where it's coming in from."}, {"Time_Start": 961.5, "Time_End": 966.74, "Text": " This gives you a relatively foolproof way of tracing spoofed packets. The script does treat every"}, {"Time_Start": 966.74, "Time_End": 972.02, "Text": " packet that it looks for as a spoof packet, so it doesn't attempt to determine whether the packet header"}, {"Time_Start": 972.02, "Time_End": 977.7, "Text": " is spoofed or not. It'll just do a show IP route and log input on that interface regardless."}, {"Time_Start": 985.12, "Time_End": 995.08, "Text": " All right, here we see the access list actually being applied, IP access group, the"}, {"Time_Start": 995.08, "Time_End": 997.14, "Text": " access list number to the interface."}, {"Time_Start": 997.14, "Time_End": 1001.04, "Text": " It will sleep for whatever the wait time is set to, which is whatever you set your eyeball"}, {"Time_Start": 1001.04, "Time_End": 1007.46, "Text": " wait time environment variable to defaults to 10 otherwise."}, {"Time_Start": 1007.46, "Time_End": 1014.52, "Text": " One thing that you may want to look at, if you do not have fast switching available, if you"}, {"Time_Start": 1014.52, "Time_End": 1015.1, "Text": " have a packet."}, {"Time_Start": 1015.12, "Time_End": 1019.6, "Text": " sniff or anywhere near the guy being attacked, or you can just throw an access list that permits"}, {"Time_Start": 1019.6, "Time_End": 1025.86, "Text": " IP any any or permits ICMP any in logs. Try and diagnose before you actually run eyeball the type"}, {"Time_Start": 1025.86, "Time_End": 1030.48, "Text": " of traffic that's coming through and how often you're seeing it. It won't really help you very much"}, {"Time_Start": 1030.48, "Time_End": 1035.42, "Text": " to use the default wait time of 10 seconds if you're only getting a packet a minute. You've got,"}, {"Time_Start": 1035.42, "Time_End": 1038.78, "Text": " you know, one in six chance of your 10 seconds being that 10 seconds."}, {"Time_Start": 1041.98, "Time_End": 1045.1, "Text": " One bug that we have encountered, what you should be seen,"}, {"Time_Start": 1045.1200000000001, "Time_End": 1049.7800000000002, "Text": " In the show log of your router, after you've run the script, in each router that the script"}, {"Time_Start": 1049.7800000000002, "Time_End": 1055.4, "Text": " passes through, you will see three configured from whatever interface you've come in on, whether"}, {"Time_Start": 1055.4, "Time_End": 1060.44, "Text": " it's console or VTY or what have you, by username, if you have TACX or anything with the"}, {"Time_Start": 1060.44, "Time_End": 1063.24, "Text": " username enabled, three separate times."}, {"Time_Start": 1063.24, "Time_End": 1068.3400000000001, "Text": " Now, the way that the script works is it will log into the router, create the access list,"}, {"Time_Start": 1068.3400000000001, "Time_End": 1073.38, "Text": " get out of global config mode, go back into global config mode, apply the access list to the interface"}, {"Time_Start": 1073.38, "Time_End": 1075.1000000000001, "Text": " with access group, whatever out."}, {"Time_Start": 1075.1200000000001, "Time_End": 1080.6000000000001, "Text": " wait for the eyeball wait time, remove the access list, get out of global config mode,"}, {"Time_Start": 1080.96, "Time_End": 1085.92, "Text": " and then later gets back into global config mode to remove the access list from the router entirely,"}, {"Time_Start": 1086.14, "Time_End": 1092.1000000000001, "Text": " and then it gets out again. So you should see three configured from console by Raven, et cetera."}, {"Time_Start": 1092.2600000000002, "Time_End": 1097.2800000000002, "Text": " And the packets that are logged should be after the second iteration of that."}, {"Time_Start": 1098.5600000000002, "Time_End": 1104.6200000000001, "Text": " There seems to be some problem with the timing of this by Cisco, and I've talked to their attack about this."}, {"Time_Start": 1105.1200000000001, "Time_End": 1108.8200000000002, "Text": " but there are a good number of times where you'll see configured from console,"}, {"Time_Start": 1108.92, "Time_End": 1112.9, "Text": " configured from console, configured from console, anything that happened for the next minute or so,"}, {"Time_Start": 1113.24, "Time_End": 1114.5600000000002, "Text": " and then all the logged packets."}, {"Time_Start": 1116.66, "Time_End": 1121.8200000000002, "Text": " So it appears that the packets are being logged after the access list has not only been removed"}, {"Time_Start": 1121.8200000000002, "Time_End": 1124.6000000000001, "Text": " from the interface, but has been removed from the router entirely."}, {"Time_Start": 1124.7600000000002, "Time_End": 1125.5200000000002, "Text": " It's kind of strange."}, {"Time_Start": 1126.5800000000002, "Time_End": 1132.88, "Text": " So we put an extra little sleep function in there so that if the access list is removed,"}, {"Time_Start": 1132.88, "Time_End": 1135.1000000000001, "Text": " you still wait a bit before you actually check the log."}, {"Time_Start": 1135.1200000000001, "Time_End": 1140.8600000000001, "Text": " to see if anything happens. If you have this problem recurring, then check your version"}, {"Time_Start": 1140.8600000000001, "Time_End": 1146.7800000000002, "Text": " of iOS. It was happening a good bit in 12016 but seems to be fixed in 12.016 STI."}, {"Time_Start": 1147.3200000000002, "Time_End": 1151.44, "Text": " You may also want to talk to Cisco about it. They are aware that the script exists."}, {"Time_Start": 1157.8400000000001, "Time_End": 1165.1000000000001, "Text": " All right, here's the log parsing bit. The SEC6 IP access, you should see in anything"}, {"Time_Start": 1165.1200000000001, "Time_End": 1168.24, "Text": " that is reporting the logged packets."}, {"Time_Start": 1168.24, "Time_End": 1173.68, "Text": " You'll see the access list number there and the interface that it came in on."}, {"Time_Start": 1173.68, "Time_End": 1181.5800000000002, "Text": " And, pardon."}, {"Time_Start": 1181.5800000000002, "Time_End": 1184.98, "Text": " You will also see the interface info on there."}, {"Time_Start": 1184.98, "Time_End": 1191.1000000000001, "Text": " So if you have an ATM interface, then you may see VPI, VCI information."}, {"Time_Start": 1191.1000000000001, "Time_End": 1193.68, "Text": " If you have a frame relay interface, you'll see DILSI, things like that."}, {"Time_Start": 1193.68, "Time_End": 1195.1000000000001, "Text": " All that gets pulled by the script."}, {"Time_Start": 1195.1200000000001, "Time_End": 1201.92, "Text": " The dreaded error message that you see all too often if you have fast switching"}, {"Time_Start": 1201.92, "Time_End": 1204.5600000000002, "Text": " and so all packets are not being logged."}, {"Time_Start": 1204.5600000000002, "Time_End": 1206.72, "Text": " No packets seen in router."}, {"Time_Start": 1206.72, "Time_End": 1210.68, "Text": " If this happens, the script will just stop at that router and not attempt to search anything further"}, {"Time_Start": 1210.68, "Time_End": 1213.68, "Text": " upstream. It wouldn't know where to look."}, {"Time_Start": 1213.68, "Time_End": 1219.16, "Text": " The only fix that I have found so far for that, if the fast switching is enabled and so all packets"}, {"Time_Start": 1219.16, "Time_End": 1224.92, "Text": " aren't being logged, is you can try and run the script again, or you can increase the wait"}, {"Time_Start": 1224.92, "Time_End": 1233.68, "Text": " time sometimes that helps it will then do a look up on the correspondence"}, {"Time_Start": 1233.68, "Time_End": 1238.66, "Text": " between the IP address and the ATM or frame relay address is there it"}, {"Time_Start": 1238.66, "Time_End": 1244.42, "Text": " defaults to getting all sorts of layer two information regardless of what is"}, {"Time_Start": 1244.42, "Time_End": 1247.64, "Text": " actually on the router it's a lot easier than actually trying to determine okay"}, {"Time_Start": 1247.64, "Time_End": 1250.52, "Text": " this is an ATM interface will treat it like that just gets all the information"}, {"Time_Start": 1250.52, "Time_End": 1254.9, "Text": " so if you see lines in your output of show ATM map and there's"}, {"Time_Start": 1254.92, "Time_End": 1258.16, "Text": " an erroneous command because you haven't got any ATM interfaces on that particular"}, {"Time_Start": 1258.16, "Time_End": 1266.14, "Text": " router, that's okay, it's in the script that's supposed to happen."}, {"Time_Start": 1266.14, "Time_End": 1272.42, "Text": " And it will then log out of the router and move on to the next one."}, {"Time_Start": 1272.42, "Time_End": 1279.3600000000001, "Text": " Now I've done some testing of this script and it seems to work fairly well but the fast switching"}, {"Time_Start": 1279.3600000000001, "Time_End": 1284.42, "Text": " is the biggest problem that we have. If any of you got, it has to be run by someone with enable"}, {"Time_Start": 1284.42, "Time_End": 1291.04, "Text": " access to the backbone obviously because you need the enable scripts to be put into the input file."}, {"Time_Start": 1291.04, "Time_End": 1293.88, "Text": " This means that end users cannot run this script."}, {"Time_Start": 1293.88, "Time_End": 1298.6000000000001, "Text": " Pretty much only ISPs are capable of doing that."}, {"Time_Start": 1298.6000000000001, "Time_End": 1306.22, "Text": " If any of you feel like giving it a try, please let me know how it works, what happens, etc., etc."}, {"Time_Start": 1306.22, "Time_End": 1310.8600000000001, "Text": " I have tested this on Linux platforms and on Solaris platforms."}, {"Time_Start": 1310.8600000000001, "Time_End": 1314.4, "Text": " Everything works okay on both of those as long as you have the proper Pro modules installed."}, {"Time_Start": 1314.42, "Time_End": 1317.42, "Text": " I haven't tried it under the Windows implementation of Pearl."}, {"Time_Start": 1317.42, "Time_End": 1321.42, "Text": " I'm not much of a Windows check, but it should, in theory, work."}, {"Time_Start": 1321.42, "Time_End": 1326.42, "Text": " Any questions?"}, {"Time_Start": 1326.42, "Time_End": 1342.42, "Text": " Yeah."}, {"Time_Start": 1342.42, "Time_End": 1347.42, "Text": " You mean if your customer is multi-homed from one particular router?"}, {"Time_Start": 1347.42, "Time_End": 1356.42, "Text": " Yeah."}, {"Time_Start": 1356.42, "Time_End": 1363.42, "Text": " If the customer has multiple links into your core, then you should run eyeball twice or"}, {"Time_Start": 1363.42, "Time_End": 1368.42, "Text": " for as many times as each link they have starting at each router that they have a link to you on."}, {"Time_Start": 1368.42, "Time_End": 1371.42, "Text": " So if they have two T1s out of one router in, you in, you have you."}, {"Time_Start": 1371.42, "Time_End": 1380.42, "Text": " in, you can start it on that one router and it will be fine. If they have two T1s into different routers, run it once starting at each of those different routers, and it should pick up everything."}, {"Time_Start": 1401.42, "Time_End": 1409.72, "Text": " Well, the output in the log will tell you that packets are going to the customer's"}, {"Time_Start": 1409.72, "Time_End": 1414.42, "Text": " IP address. You don't give it the customer's Mac address or anything like that."}, {"Time_Start": 1414.42, "Time_End": 1419.3000000000002, "Text": " So if you have multiple routes to the customer from your one particular network, it doesn't"}, {"Time_Start": 1419.3000000000002, "Time_End": 1424.9, "Text": " matter which one, it will just do show IP route and determine the interface there."}, {"Time_Start": 1424.9, "Time_End": 1429.3000000000002, "Text": " BGP gets kind of strange there because if you're using BGP, which like most everyone on the internet"}, {"Time_Start": 1429.3000000000002, "Time_End": 1431.4, "Text": " is, then BGP will only see what."}, {"Time_Start": 1431.42, "Time_End": 1436.04, "Text": " one quote-to-quote best path, and it will see, but that's the path that the traffic would be taking."}, {"Time_Start": 1436.54, "Time_End": 1438.92, "Text": " So I don't think it's a huge problem there."}, {"Time_Start": 1442.22, "Time_End": 1443.42, "Text": " Any other questions?"}, {"Time_Start": 1444.8200000000002, "Time_End": 1445.18, "Text": " Yes."}, {"Time_Start": 1445.18, "Time_End": 1453.42, "Text": " Aren't you being concerned about having your entire network for quality as well as your enable passwords playing around and almost playing that?"}, {"Time_Start": 1453.42, "Time_End": 1461.4, "Text": " Well, having the enable passwords, obviously you shouldn't have this sitting around on your home machine, sending, you know,"}, {"Time_Start": 1461.42, "Time_End": 1464.42, "Text": " things via totally unencrypted telnet over the internet."}, {"Time_Start": 1464.42, "Time_End": 1468.8600000000001, "Text": " Cisco, unfortunately, doesn't support secure shell yet, but it's very important to protect"}, {"Time_Start": 1468.8600000000001, "Time_End": 1474.0600000000002, "Text": " the file that has your, the router access default, et cetera."}, {"Time_Start": 1474.0600000000002, "Time_End": 1479.26, "Text": " You should set it so that its permissions if you're on a Unix system are only readable to you."}, {"Time_Start": 1479.26, "Time_End": 1483.26, "Text": " It is a concern of mine, yeah."}, {"Time_Start": 1483.26, "Time_End": 1489.26, "Text": " As far as the entire network topology is not actually saved in the eyeball valid routers, it's just"}, {"Time_Start": 1489.26, "Time_End": 1490.26, "Text": " the list of IP addresses."}, {"Time_Start": 1490.26, "Time_End": 1491.38, "Text": " It doesn't tell you what connection."}, {"Time_Start": 1491.42, "Time_End": 1498.42, "Text": " to what? It just says, these are the IP addresses that I am allowed to try and connect to."}, {"Time_Start": 1498.42, "Time_End": 1501.42, "Text": " Yes."}, {"Time_Start": 1501.42, "Time_End": 1507.42, "Text": " Are you running the problems with the interface of the option being overrun without being able to"}, {"Time_Start": 1507.42, "Time_End": 1510.42, "Text": " remove the access list for the same telnet set?"}, {"Time_Start": 1510.42, "Time_End": 1512.42, "Text": " No, I haven't had that come up."}, {"Time_Start": 1512.42, "Time_End": 1518.42, "Text": " The question was, have you run into problems where you are unable to remove the access list in the same Telnet session?"}, {"Time_Start": 1518.42, "Time_End": 1520.42, "Text": " It may be an iOS specific thing, but it seems."}, {"Time_Start": 1520.42, "Time_End": 1527.42, "Text": " it seems like if it actually manages to log into the router, it can throw on the access list,"}, {"Time_Start": 1527.42, "Time_End": 1528.42, "Text": " look for traffic."}, {"Time_Start": 1528.42, "Time_End": 1532.42, "Text": " The biggest problem I've seen is when it doesn't actually log any packets because of the fast switching stuff."}, {"Time_Start": 1532.42, "Time_End": 1535.42, "Text": " But I've never actually had it die, like mid-session."}, {"Time_Start": 1535.42, "Time_End": 1541.42, "Text": " If it does, though, one of the things that would be fairly helpful is with the output that it puts to the screen,"}, {"Time_Start": 1541.42, "Time_End": 1547.42, "Text": " you can see which routers it's logging into, and you will have one particular access list that you would only use for this."}, {"Time_Start": 1547.42, "Time_End": 1549.42, "Text": " That's why it needs the eyeball access list variable."}, {"Time_Start": 1549.42, "Time_End": 1554.42, "Text": " So you could, worse comes to worst, go back through the routers that's output on the screen,"}, {"Time_Start": 1554.42, "Time_End": 1558.42, "Text": " and make sure that those IP access lists have been removed from the routers."}, {"Time_Start": 1558.42, "Time_End": 1563.42, "Text": " No, I haven't seen that. The output is that's too much volume about what you do to block up the console next."}, {"Time_Start": 1563.42, "Time_End": 1578.42, "Text": " No, I haven't seen that. The output..."}, {"Time_Start": 1578.42, "Time_End": 1584.42, "Text": " This is console on the Cisco or console on your Unix box on the Cisco?"}, {"Time_Start": 1584.42, "Time_End": 1588.42, "Text": " Because the script is run from a Unix box and just does the telnet into each."}, {"Time_Start": 1588.42, "Time_End": 1592.42, "Text": " So it doesn't display, like, the entire output on your console."}, {"Time_Start": 1592.42, "Time_End": 1599.42, "Text": " Hopefully, all it would do is, if you have a particular, like, length of your log buffer on the router,"}, {"Time_Start": 1599.42, "Time_End": 1603.42, "Text": " then it can just, it would, worse comes to worst, it gets wrapped."}, {"Time_Start": 1603.42, "Time_End": 1607.42, "Text": " Does that, is that what you're saying, freezes up your TTY?"}, {"Time_Start": 1607.42, "Time_End": 1611.42, "Text": " Okay, so you're not using terminal monitoring at all."}, {"Time_Start": 1611.42, "Time_End": 1616.42, "Text": " You just do the show log, you parse whatever's in the log, so if it's overwritten its log buffer 18 times,"}, {"Time_Start": 1616.42, "Time_End": 1619.42, "Text": " you're only going to get that last screen of information."}, {"Time_Start": 1619.42, "Time_End": 1623.42, "Text": " So in case of like a truly massive DDoS attack or something like that,"}, {"Time_Start": 1623.42, "Time_End": 1627.42, "Text": " then you probably have to take that list that you've got of the attacking addresses,"}, {"Time_Start": 1627.42, "Time_End": 1632.42, "Text": " try and deal with those, whether calling up your ISPs and you're peering ISPs and telling them about them,"}, {"Time_Start": 1632.42, "Time_End": 1635.42, "Text": " shutting off those that are your customers if you are the ISP, etc.,"}, {"Time_Start": 1635.42, "Time_End": 1637.4, "Text": " and then running the script again to get the"}, {"Time_Start": 1637.42, "Time_End": 1642.42, "Text": " the next lump of them because it's only going to pull what's in the CIS log or rather what's in the buffered log."}, {"Time_Start": 1642.42, "Time_End": 1647.42, "Text": " Well, in that situation, the only problem will have is when the graphics actually"}, {"Time_Start": 1647.42, "Time_End": 1650.42, "Text": " go alone in the processor traffic is going into the router."}, {"Time_Start": 1650.42, "Time_End": 1651.42, "Text": " Yeah."}, {"Time_Start": 1651.42, "Time_End": 1652.42, "Text": " Yeah."}, {"Time_Start": 1652.42, "Time_End": 1656.42, "Text": " If it gets to the point that it's killing your router, then the script will not,"}, {"Time_Start": 1656.42, "Time_End": 1661.42, "Text": " will probably aid in your router's death slightly, but you're already killed."}, {"Time_Start": 1661.42, "Time_End": 1667.42, "Text": " We did try running it on some routers that were short on memory, and it"}, {"Time_Start": 1667.42, "Time_End": 1672.92, "Text": " indeed in one of the initial sketches out for the layout of the script, I was going to have"}, {"Time_Start": 1672.92, "Time_End": 1677.92, "Text": " it do like a couple of show runs, pull out secondary IP addresses for the interfaces so that if"}, {"Time_Start": 1677.92, "Time_End": 1681.8200000000002, "Text": " you had an Ethernet interface with two IPs assigned to it, it would include both of those"}, {"Time_Start": 1681.8200000000002, "Time_End": 1688.46, "Text": " in the allowed list. As it is now, it will only include whatever is in a show IP interface brief."}, {"Time_Start": 1688.46, "Time_End": 1692.72, "Text": " So that's only the primary IP address on any interface, but it will get IPs of sub-interfaces"}, {"Time_Start": 1692.72, "Time_End": 1697.4, "Text": " and such. But we have a couple of routers in the network."}, {"Time_Start": 1697.42, "Time_End": 1706.42, "Text": " that I was testing on that are very short on memory and so avoiding doing a show run was generally a good idea so as to avoid causing malic failures."}, {"Time_Start": 1706.42, "Time_End": 1722.42, "Text": " It does do the RAP addresses."}, {"Time_Start": 1722.42, "Time_End": 1727.42, "Text": " It does do the RAP addresses. That's why it pulls the show frame relay map, et cetera, et cetera, et cetera."}, {"Time_Start": 1727.42, "Time_End": 1732.42, "Text": " to get the ARP, and then when it goes through the logging, it pulls the, both the interface"}, {"Time_Start": 1732.42, "Time_End": 1738.42, "Text": " number and the interface type, so it'll get DILC, VPI, VCI, what have you."}, {"Time_Start": 1738.42, "Time_End": 1745.42, "Text": " That part, the, I haven't actually tried it on any multi-point links."}, {"Time_Start": 1745.42, "Time_End": 1747.42, "Text": " It works fine pulling the information."}, {"Time_Start": 1747.42, "Time_End": 1753.42, "Text": " I get the information there, but the network that I tested it on only has point-to-points in its core."}, {"Time_Start": 1753.42, "Time_End": 1757.4, "Text": " So if anyone has multi-point links, you know, some sort of funky ATM set up,"}, {"Time_Start": 1757.42, "Time_End": 1761.42, "Text": " or what have you. I would love to hear how it works. Yes."}, {"Time_Start": 1765.42, "Time_End": 1770.42, "Text": " I don't have it with me, but it's really simple looking. It's just a list of IP addresses"}, {"Time_Start": 1770.42, "Time_End": 1777.42, "Text": " and the interface on your router where it came from. So new line separated text file. Yes."}, {"Time_Start": 1787.42, "Time_End": 1793.24, "Text": " Good traffic and bad traffic? Yeah. That's all in the creation of the initial"}, {"Time_Start": 1793.24, "Time_End": 1798.02, "Text": " access list, which is why I was saying if you can possibly try and figure out what type of attack"}, {"Time_Start": 1798.02, "Time_End": 1802.0600000000002, "Text": " traffic they're sending, and that's one of the reasons why I want to include a port"}, {"Time_Start": 1802.0600000000002, "Time_End": 1806.5600000000002, "Text": " filtering in the future. The access list that's created is just a two-line access list."}, {"Time_Start": 1806.5600000000002, "Time_End": 1812.3200000000002, "Text": " The first one will be permit traffic of the traffic type that you've specified, so if you said"}, {"Time_Start": 1812.3200000000002, "Time_End": 1817.4, "Text": " TCP, then it will only look for TCP, et cetera. And then it will look for companies."}, {"Time_Start": 1817.42, "Time_End": 1821.8000000000002, "Text": " from anywhere to the attacked address and it will log the input."}, {"Time_Start": 1821.8000000000002, "Time_End": 1827.8600000000001, "Text": " So yeah, this does mean that if you have a server that is being attacked on its web port and"}, {"Time_Start": 1827.8600000000001, "Time_End": 1831.92, "Text": " legitimate users trying to FTP to it, then you are going to get those legitimate users'"}, {"Time_Start": 1831.92, "Time_End": 1834.7, "Text": " FTP traffic reported in there."}, {"Time_Start": 1834.7, "Time_End": 1839.0600000000002, "Text": " So the port filtering will be out in version 0.4."}, {"Time_Start": 1847.42, "Time_End": 1866.42, "Text": " Yes. Well, I haven't seen like any performance problems with it. It seems to work"}, {"Time_Start": 1866.42, "Time_End": 1870.66, "Text": " okay, but it hasn't been extensively tested yet, so."}, {"Time_Start": 1877.42, "Time_End": 1884.42, "Text": " Okay."}, {"Time_Start": 1907.42, "Time_End": 1923.74, "Text": " Okay, so if the router is one of our routers, then it will open up a temp file."}, {"Time_Start": 1923.74, "Time_End": 1931.5, "Text": " If it can't open a temp file, it dies with an error message, and it will go through, it will fork"}, {"Time_Start": 1931.5, "Time_End": 1935.54, "Text": " and create children processes for each, bless you, individual router."}, {"Time_Start": 1935.54, "Time_End": 1952.6599999999999, "Text": " and it will just create a separate little session for each one of those."}, {"Time_Start": 1952.6599999999999, "Time_End": 1955.82, "Text": " It will wait to actually close out the whole process."}, {"Time_Start": 1955.82, "Time_End": 1960.62, "Text": " It counts how many children processes it has at any given point, and it will wait for that"}, {"Time_Start": 1960.62, "Time_End": 1964.96, "Text": " to close out the whole thing, but essentially I am not the queen of Maltese writing."}, {"Time_Start": 1964.96, "Time_End": 1967.28, "Text": " This is essentially the only way that I know how to do it."}, {"Time_Start": 1967.32, "Time_End": 1969.16, "Text": " I know more about routers than I do about Perl."}, {"Time_Start": 1969.56, "Time_End": 1976.26, "Text": " So if you have a suggestion to approve efficiency or technical performance, then, you know, send it to me an email."}, {"Time_Start": 1980.42, "Time_End": 1981.28, "Text": " Anyone else?"}, {"Time_Start": 1985.3600000000001, "Time_End": 1985.88, "Text": " Yes."}, {"Time_Start": 1994.96, "Time_End": 2001.96, "Text": " Well, I've tested it on routers that have interfaces up to OC-48 speeds that were at about,"}, {"Time_Start": 2001.96, "Time_End": 2007.96, "Text": " the OC-48s were on 20% utilization, but on the same routers we also had OC-3s that were at like 80% or 90% utilization,"}, {"Time_Start": 2007.96, "Time_End": 2012.96, "Text": " and it didn't seem to cause a noticeable performance lag on the routers or anything."}, {"Time_Start": 2012.96, "Time_End": 2013.96, "Text": " Thank you."}, {"Time_Start": 2013.96, "Time_End": 2024.94, "Text": " As far as attack traffic volumes, I haven't seen anything above about, let's see, I didn't tested it with high-level traffic volumes with more than about"}, {"Time_Start": 2024.96, "Time_End": 2029.8600000000001, "Text": " 200 attacking addresses in the last couple of versions of the script simply because"}, {"Time_Start": 2029.8600000000001, "Time_End": 2034.72, "Text": " the ISP that I work for has not had an attack of that level going through it in the later versions"}, {"Time_Start": 2034.72, "Time_End": 2035.92, "Text": " of the script."}, {"Time_Start": 2035.92, "Time_End": 2040.72, "Text": " It seemed to work all right in earlier versions, but a good number of things have been changed."}, {"Time_Start": 2040.72, "Time_End": 2048.86, "Text": " I've gone up to about 10, 15, attacking hosts sending about 100 megs of traffic or so to"}, {"Time_Start": 2048.86, "Time_End": 2053.28, "Text": " the attacked address, and the script handled that okay."}, {"Time_Start": 2054.96, "Time_End": 2061.96, "Text": " Other questions?"}, {"Time_Start": 2061.96, "Time_End": 2065.96, "Text": " All right, we're done early."}]}