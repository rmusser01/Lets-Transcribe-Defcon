{"segments": [{"Time_Start": 0.0, "Time_End": 20.0, "Text": " Hi, my name is Mark Grimes, also known as Obitian."}, {"Time_Start": 20.0, "Time_End": 23.0, "Text": " Some of you may or may not know me."}, {"Time_Start": 23.0, "Time_End": 29.0, "Text": " I'm basically here to present a specification and a tool called Intrasion"}, {"Time_Start": 29.0, "Time_End": 35.5, "Text": " tool called intravenous. We're going to talk a little bit at the beginning about marrying"}, {"Time_Start": 35.5, "Time_End": 45.760000000000005, "Text": " artificial intelligence with TCP IP because the areas of research that you can explore"}, {"Time_Start": 45.760000000000005, "Time_End": 54.68, "Text": " with raw sockets and how to obtain next packet injection are very important. Everybody"}, {"Time_Start": 54.68, "Time_End": 58.980000000000004, "Text": " knows that you can just connect client server through BSD sockets and we want to"}, {"Time_Start": 59.0, "Time_End": 64.64, "Text": " explore the arena of actually taking raw sockets to, especially with Windows carrying"}, {"Time_Start": 64.64, "Time_End": 70.12, "Text": " raw sockets in the next version by default. I want to explore the arena of producing"}, {"Time_Start": 70.12, "Time_End": 78.02, "Text": " next packet injection with connection integrity with respect to time is the goal."}, {"Time_Start": 78.02, "Time_End": 85.52, "Text": " We don't really care about payload, but we'll start getting into this year."}, {"Time_Start": 85.52, "Time_End": 88.98, "Text": " First thing we want to cover is packet injection. Some of you may"}, {"Time_Start": 89.0, "Time_End": 95.72, "Text": " or may not know that I'm responsible for a tool called Nemesis. It is a nine protocol"}, {"Time_Start": 95.72, "Time_End": 102.44, "Text": " packet injection suite. It is based on Mike Schiffman's lip net, which makes it extremely"}, {"Time_Start": 102.44, "Time_End": 107.76, "Text": " portable between operating systems. I've even had reports that this works on"}, {"Time_Start": 107.76, "Time_End": 116.0, "Text": " on Sons or trusted Solaris. We've got node integrity evasion testing. I mean, these are"}, {"Time_Start": 116.0, "Time_End": 118.56, "Text": " the common uses that this tool is used for."}, {"Time_Start": 119.0, "Time_End": 127.46000000000001, "Text": " The emails I've gotten in regards to Nemesis, I was kind of creating this on a whim for studying"}, {"Time_Start": 127.46000000000001, "Time_End": 131.62, "Text": " for a test called the CCNA."}, {"Time_Start": 131.62, "Time_End": 136.82, "Text": " And I don't really believe in theory without testing the practical."}, {"Time_Start": 136.82, "Time_End": 142.32, "Text": " And it's nice to read a bunch of Cisco books that are written by, you know, yada,"}, {"Time_Start": 142.32, "Time_End": 148.98, "Text": " a PhD. But it would be nice to actually see these packets."}, {"Time_Start": 149.0, "Time_End": 155.24, "Text": " go across the wire and actually work as suggested in the system reading material."}, {"Time_Start": 155.24, "Time_End": 161.24, "Text": " So the three top uses are node integrity and evasion testing of routers, and firewalls, IES,"}, {"Time_Start": 161.24, "Time_End": 162.64, "Text": " and then stack integrity."}, {"Time_Start": 162.64, "Time_End": 169.44, "Text": " So we use it to test malform packets on the network wire."}, {"Time_Start": 169.44, "Time_End": 175.8, "Text": " Router congestion management is also another real good aspect of it because the tools or the tool"}, {"Time_Start": 175.8, "Time_End": 178.98, "Text": " is used for throwing like gigabyte foot or gigabyte."}, {"Time_Start": 179.0, "Time_End": 188.38, "Text": " UGB files across the wire as payload to test a particular protocol and see where the router chokes."}, {"Time_Start": 188.38, "Time_End": 190.18, "Text": " It can also be used for covert channels."}, {"Time_Start": 190.18, "Time_End": 197.06, "Text": " I've actually done a little demo where I had, I was testing, sending a 35K text file through"}, {"Time_Start": 197.06, "Time_End": 204.5, "Text": " ARP since, you know, like nobody looks at the payload of ARP in an IDS, and I sent the read"}, {"Time_Start": 204.5, "Time_End": 208.98, "Text": " me file for Nemesis across the wire and just like dummied up a little program to collect"}, {"Time_Start": 209.0, "Time_End": 212.42, "Text": " the packets and collect it on the other end and you know a hundred art"}, {"Time_Start": 212.42, "Time_End": 219.2, "Text": " packets later not that that would be noticed or anything but it made it to through"}, {"Time_Start": 219.2, "Time_End": 222.92, "Text": " and it collected it at the other end and it was a it was a little nice covert"}, {"Time_Start": 222.92, "Time_End": 228.02, "Text": " channel and obviously it can be used for spoofing the last version I did give"}, {"Time_Start": 228.02, "Time_End": 235.28, "Text": " nemesis to Jeff Nathan of that stake who presented at Black Hat this year and"}, {"Time_Start": 235.28, "Time_End": 238.56, "Text": " also used the tool in his demonstration"}, {"Time_Start": 238.56, "Time_End": 242.66, "Text": " The tool is actively being worked on again."}, {"Time_Start": 242.66, "Time_End": 247.06, "Text": " I kind of lost the passion for working on this because it's kind of like just plugging in more protocols."}, {"Time_Start": 247.06, "Time_End": 251.66, "Text": " It's at this point it seems like esoteric assembly line work."}, {"Time_Start": 251.66, "Time_End": 256.96, "Text": " I talked to Mike at Black Cat to see what the future of Libnet is going to hold."}, {"Time_Start": 256.96, "Time_End": 260.96, "Text": " it looks promising and it looks like Jeff is going to have an interesting project ahead of them."}, {"Time_Start": 260.96, "Time_End": 268.46, "Text": " I wanted to focus my research on intravenous and it can also be used for evasion, of course, because if you're, you know,"}, {"Time_Start": 268.56, "Time_End": 272.56, "Text": " if you've mapped your IDS and understand what the IDS is alerting from"}, {"Time_Start": 272.56, "Time_End": 279.56, "Text": " because perhaps they're running an insecure X server and you're able to pull the screen that there's been many."}, {"Time_Start": 279.56, "Time_End": 288.56, "Text": " I work in for SCIC Corporation and I'm the technical lead of network penetration and data forensics."}, {"Time_Start": 288.56, "Time_End": 297.56, "Text": " And although this research is not a part of SCIC, this is stuff I've done on my own time,"}, {"Time_Start": 297.56, "Time_End": 304.56, "Text": " Anything that's said today is basically pointed at me and not at my corporation."}, {"Time_Start": 304.56, "Time_End": 308.56, "Text": " The tool has been demonstrated."}, {"Time_Start": 308.56, "Time_End": 311.56, "Text": " It has reached a lot of media attention, actually."}, {"Time_Start": 311.56, "Time_End": 316.56, "Text": " Sons has covered a lot of articles choking on Naptha."}, {"Time_Start": 316.56, "Time_End": 323.56, "Text": " Napha, I believe, was a type of attack that was coined by Bindview."}, {"Time_Start": 323.56, "Time_End": 326.56, "Text": " And there's an article from February 2001."}, {"Time_Start": 326.56, "Time_End": 331.1, "Text": " There's all kinds of articles protecting the network infrastructure."}, {"Time_Start": 331.1, "Time_End": 343.32, "Text": " There was a November GIAC Detect report that was, that was, that was promoted through sons."}, {"Time_Start": 343.32, "Time_End": 349.6, "Text": " And it pits nemesis versus Cisco picks, and they were actually able to send IP packets that"}, {"Time_Start": 349.6, "Time_End": 353.8, "Text": " didn't log IP addresses, which is not exactly a great thing."}, {"Time_Start": 353.8, "Time_End": 359.90000000000003, "Text": " Theodore has listed Nemesis in the top 50 security tools of all time."}, {"Time_Start": 359.90000000000003, "Time_End": 366.26, "Text": " And it's available at www.pocketNinja.net if you'd already known about that domain."}, {"Time_Start": 366.26, "Time_End": 369.24, "Text": " We reach artificial intelligence."}, {"Time_Start": 369.24, "Time_End": 372.38, "Text": " And a lot of you are probably coming in here with the misconception that we're creating"}, {"Time_Start": 372.38, "Time_End": 379.04, "Text": " sci-fi material, like if you've seen the movie."}, {"Time_Start": 379.04, "Time_End": 383.78000000000003, "Text": " But what we're actually creating is intelligent software, software that"}, {"Time_Start": 383.8, "Time_End": 387.8, "Text": " is based on the, thank you very much, software that is based on the,"}, {"Time_Start": 387.8, "Time_End": 389.8, "Text": " um, hold on one second."}, {"Time_Start": 389.8, "Time_End": 401.8, "Text": " Software that is based on, um, artificial intelligent design, um,"}, {"Time_Start": 401.8, "Time_End": 408.8, "Text": " the different types of packet, um, or data structures that are indicative of expert systems"}, {"Time_Start": 408.8, "Time_End": 409.8, "Text": " and machine learning."}, {"Time_Start": 409.8, "Time_End": 413.78000000000003, "Text": " Intelligence is defined, I, I looked this up on dictionary."}, {"Time_Start": 413.8, "Time_End": 417.8, "Text": " was kind of intrigued that when I looked this up right before I finished the presentation,"}, {"Time_Start": 417.8, "Time_End": 419.8, "Text": " they had changed the definitions."}, {"Time_Start": 419.8, "Time_End": 426.8, "Text": " But intelligence is defined as the capacity to acquire and apply knowledge"}, {"Time_Start": 426.8, "Time_End": 433.8, "Text": " and the faculty of thought and reason, both of which can be defined in software."}, {"Time_Start": 433.8, "Time_End": 438.8, "Text": " You can have something automated that takes care of a human function that we're normally."}, {"Time_Start": 438.8, "Time_End": 443.78000000000003, "Text": " We would be doing, like if you're doing a pen test and you are exploring the boundary"}, {"Time_Start": 443.8, "Time_End": 448.8, "Text": " of some network host-based exploitation."}, {"Time_Start": 448.8, "Time_End": 450.8, "Text": " We can automate that process."}, {"Time_Start": 450.8, "Time_End": 452.8, "Text": " Like if you're scanning a network, you do a ping scan,"}, {"Time_Start": 452.8, "Time_End": 454.8, "Text": " you do a port scan, you do a reverse DNS."}, {"Time_Start": 454.8, "Time_End": 456.8, "Text": " I mean, all that can be automated."}, {"Time_Start": 456.8, "Time_End": 459.8, "Text": " If we can write it down on a piece of paper, we can automate it."}, {"Time_Start": 459.8, "Time_End": 465.8, "Text": " The third definition of intelligence is where human bias becomes a factor."}, {"Time_Start": 465.8, "Time_End": 470.8, "Text": " We have super powers of the mind, or superior powers of the mind."}, {"Time_Start": 470.8, "Time_End": 472.8, "Text": " And mind is defined as the human consciousness."}, {"Time_Start": 472.8, "Time_End": 477.40000000000003, "Text": " human consciousness that originates in the brain, of course not dolphins, but humans."}, {"Time_Start": 477.40000000000003, "Time_End": 483.24, "Text": " And it's manifested in thought, perception, emotion, will, memory, and imagination."}, {"Time_Start": 483.24, "Time_End": 488.76, "Text": " This is the point where the definition skews and we really are having a problem in the artificial"}, {"Time_Start": 488.76, "Time_End": 494.66, "Text": " intelligence arena of defining intelligence in regards to perhaps some of you that are not"}, {"Time_Start": 494.66, "Time_End": 500.98, "Text": " really engaged in artificial intelligence study are perhaps thinking that artificial"}, {"Time_Start": 500.98, "Time_End": 502.78000000000003, "Text": " intelligence is taking things to a different level."}, {"Time_Start": 502.8, "Time_End": 509.8, "Text": " And it's not really, it's just really automating human interaction and in an automated fashion."}, {"Time_Start": 509.8, "Time_End": 514.8, "Text": " An intelligent program, this is a common definition that's been seen in a number of AI text."}, {"Time_Start": 514.8, "Time_End": 521.8, "Text": " An intelligent program is one that exhibits behavior similar to that of a human when confronted with a similar problem."}, {"Time_Start": 521.8, "Time_End": 527.8, "Text": " It's not necessary that the program actually solves or attempts to solve the problem in the same way a human would."}, {"Time_Start": 527.8, "Time_End": 531.8, "Text": " So our goal is we work on performance measures, we tell"}, {"Time_Start": 531.8, "Time_End": 537.8, "Text": " when we get a port scan and it comes up with port 80 and we assume it's an HTTP server"}, {"Time_Start": 537.8, "Time_End": 540.8, "Text": " and we probe for HTTP vulnerabilities."}, {"Time_Start": 540.8, "Time_End": 546.8, "Text": " We assume that this is a proper performance measure, a positive rather than a negative decrement."}, {"Time_Start": 546.8, "Time_End": 551.8, "Text": " And the agent understands that it's doing the right thing, moving forward."}, {"Time_Start": 551.8, "Time_End": 557.8, "Text": " This is basically defined in our environment."}, {"Time_Start": 557.8, "Time_End": 561.78, "Text": " An artificial intelligent program is defined by the environment, which is the network"}, {"Time_Start": 561.8000000000001, "Time_End": 565.8000000000001, "Text": " traffic that passes over the wire, sensors."}, {"Time_Start": 565.8000000000001, "Time_End": 572.8000000000001, "Text": " The sensors are obviously a packet capture filter that would narrow down the traffic that we want to see on the wire"}, {"Time_Start": 572.8000000000001, "Time_End": 574.8000000000001, "Text": " with port exclusion."}, {"Time_Start": 574.8000000000001, "Time_End": 579.8000000000001, "Text": " And we'll get into this when we start talking about the actual live artificial intelligent agent"}, {"Time_Start": 579.8000000000001, "Time_End": 582.8000000000001, "Text": " that I'm producing for OpenBSD."}, {"Time_Start": 582.8000000000001, "Time_End": 586.8000000000001, "Text": " Static capture rules and to categorize traffic."}, {"Time_Start": 586.8000000000001, "Time_End": 590.8000000000001, "Text": " We have effectors, effectors of the injection engine, essentially."}, {"Time_Start": 590.8000000000001, "Time_End": 591.7800000000001, "Text": " For the course of the system,"}, {"Time_Start": 591.8000000000001, "Time_End": 596.5600000000001, "Text": " this mission, we're doing stateful packet injection, which is something that's not commonly done."}, {"Time_Start": 596.5600000000001, "Time_End": 600.5600000000001, "Text": " We always look at things from an IDS, from a defense standpoint."}, {"Time_Start": 600.5600000000001, "Time_End": 603.0000000000001, "Text": " This is an offensive tool."}, {"Time_Start": 603.0000000000001, "Time_End": 610.6400000000001, "Text": " This is attempt to create a disease so that we can create an antidote on how we can"}, {"Time_Start": 610.6400000000001, "Time_End": 617.32, "Text": " perceive distributed an aisle of service from the arena of, imagine you have a typical DDoS attack"}, {"Time_Start": 617.32, "Time_End": 621.7800000000001, "Text": " and you set a packet crafter on the end of each note."}, {"Time_Start": 621.8000000000001, "Time_End": 624.96, "Text": " instead of a particular distributed and all service attack."}, {"Time_Start": 625.0400000000001, "Time_End": 630.0000000000001, "Text": " And then you're able to communicate with these different agents as to what specific traffic"}, {"Time_Start": 630.0000000000001, "Time_End": 630.6600000000001, "Text": " you want to hit."}, {"Time_Start": 631.0600000000001, "Time_End": 636.2600000000001, "Text": " You strategically place them on the inside and the outside of firewalls on different points of a land"}, {"Time_Start": 636.2600000000001, "Time_End": 642.82, "Text": " or an attack where you have two different endpoints, say you wanted to ARP spoof in two directions"}, {"Time_Start": 642.82, "Time_End": 648.2400000000001, "Text": " so that you could bring two VLands together or closer together so you have a distributed sniffer component."}, {"Time_Start": 650.46, "Time_End": 651.7800000000001, "Text": " Examples of agents."}, {"Time_Start": 651.8000000000001, "Time_End": 656.8000000000001, "Text": " for host-based vulnerabilities would be like ASC gear or binary fingerprint target"}, {"Time_Start": 656.8000000000001, "Time_End": 658.8000000000001, "Text": " analysis or target response."}, {"Time_Start": 658.8000000000001, "Time_End": 669.8000000000001, "Text": " Recently, well not too recently, Scott of Teso created binary fingerprints in ASCII or printable ASCII"}, {"Time_Start": 669.8000000000001, "Time_End": 678.8000000000001, "Text": " that could basically detect finger responses and there were a couple other tools that they created in this arena."}, {"Time_Start": 678.8000000000001, "Time_End": 681.7800000000001, "Text": " I mean obviously we don't want to stay confined to just a different."}, {"Time_Start": 681.8000000000001, "Time_End": 682.8000000000001, "Text": " ASCII printable characters."}, {"Time_Start": 682.8000000000001, "Time_End": 687.36, "Text": " I want to go to extended ASCII and just make a binary fingerprint as to what we can print"}, {"Time_Start": 687.36, "Time_End": 692.5000000000001, "Text": " on the screen and then store that to a file just as SCET has done."}, {"Time_Start": 692.5000000000001, "Time_End": 695.3000000000001, "Text": " If you want to see more of them, you can head up to test those websites."}, {"Time_Start": 695.3000000000001, "Time_End": 698.5600000000001, "Text": " I'm sure most of you know where that's on."}, {"Time_Start": 698.5600000000001, "Time_End": 702.7400000000001, "Text": " Intelligent shell code offset alignment analysis."}, {"Time_Start": 702.7400000000001, "Time_End": 704.0400000000001, "Text": " We have a knowledge base."}, {"Time_Start": 704.0400000000001, "Time_End": 708.8800000000001, "Text": " A knowledge base is the foundation or one integral part of an expert system."}, {"Time_Start": 708.8800000000001, "Time_End": 711.32, "Text": " We can define OS major and minor versions."}, {"Time_Start": 711.32, "Time_End": 713.82, "Text": " And we can do process context recognition."}, {"Time_Start": 713.82, "Time_End": 714.9200000000001, "Text": " We can look at banners."}, {"Time_Start": 714.9200000000001, "Time_End": 721.2, "Text": " We can look at things that would be indicative of a particular exploit and attempt to exploit that."}, {"Time_Start": 721.2, "Time_End": 724.1400000000001, "Text": " I mean, what's the biggest problem with third-party scanners today?"}, {"Time_Start": 724.1400000000001, "Time_End": 725.1400000000001, "Text": " They're doing fingerprinting."}, {"Time_Start": 725.1400000000001, "Time_End": 729.0, "Text": " They're saying, oh, if you're running a particular version, that must be exploitable."}, {"Time_Start": 729.0, "Time_End": 735.36, "Text": " Well, later when a particular vendor software came back with Solaris exploits for NT, that didn't"}, {"Time_Start": 735.36, "Time_End": 740.0, "Text": " really work out too well in our reports that we were handing off to the customer."}, {"Time_Start": 740.0, "Time_End": 747.54, "Text": " So SCIC has developed a, we've developed a 500 megabyte toolkit that comprises"}, {"Time_Start": 747.54, "Time_End": 755.08, "Text": " a lot of tools for, that are standard, you know, packet storm, some private, some not,"}, {"Time_Start": 755.08, "Time_End": 761.18, "Text": " that we can go out and assess and exploit or access a vulnerability to where it is truly exploitable"}, {"Time_Start": 761.18, "Time_End": 764.66, "Text": " and not just a fingerprint match."}, {"Time_Start": 764.66, "Time_End": 769.52, "Text": " Network vulnerabilities, we've got default passwords, clear text, protocols, dynamic ARP caches."}, {"Time_Start": 769.52, "Time_End": 769.98, "Text": " There's a ton of."}, {"Time_Start": 770.0, "Time_End": 777.3, "Text": " of areas that we can define agents for making an expert system where you just map everything"}, {"Time_Start": 777.3, "Time_End": 781.12, "Text": " and say, okay, well, if we're hitting a Cisco device, we're going to try these password combinations."}, {"Time_Start": 781.12, "Time_End": 784.38, "Text": " We're hitting this SNMT, so we're going to hit these combinations."}, {"Time_Start": 784.38, "Time_End": 788.76, "Text": " There's no reason that we have to take ADM SNMP and grind on passwords that we already know"}, {"Time_Start": 788.76, "Time_End": 791.8, "Text": " are not default passwords on that device."}, {"Time_Start": 791.8, "Time_End": 793.88, "Text": " You can actually map them by device."}, {"Time_Start": 793.88, "Time_End": 797.04, "Text": " It's just one layer deeper."}, {"Time_Start": 797.04, "Time_End": 799.04, "Text": " Net BIOS, of course, is a nice network vulnerability."}, {"Time_Start": 799.04, "Time_End": 805.4399999999999, "Text": " the replacement for that, of course, by Microsoft is, well, we don't own the protocol."}, {"Time_Start": 805.62, "Time_End": 806.3199999999999, "Text": " We just use it."}, {"Time_Start": 807.0799999999999, "Time_End": 811.36, "Text": " Use IPSEC, which of course means you have to run Witten 2K."}, {"Time_Start": 812.4399999999999, "Time_End": 816.98, "Text": " And it's attached to dial-up networking for VBPNN, so we all know what's going on there."}, {"Time_Start": 818.1999999999999, "Time_End": 820.76, "Text": " Stack integrity, Malform packets."}, {"Time_Start": 822.98, "Time_End": 828.62, "Text": " Obviously, this would be another thing, just like Nemesis has proved that certain devices can drop."}, {"Time_Start": 829.04, "Time_End": 834.16, "Text": " like a rock to particular malform packets through RASOC."}, {"Time_Start": 834.16, "Time_End": 835.16, "Text": " We've got covert channels."}, {"Time_Start": 835.16, "Time_End": 838.36, "Text": " We can look at OSRFC deficiencies."}, {"Time_Start": 838.36, "Time_End": 845.2199999999999, "Text": " There are many vendors that ignore must be zero bits and use reserved bits to store whatever."}, {"Time_Start": 845.2199999999999, "Time_End": 851.86, "Text": " I'm not so sure that some of these commercial vendors are actually reading the RFCs."}, {"Time_Start": 851.86, "Time_End": 857.4, "Text": " We've got, I mean, you can have an unbelievable amount of covert channels, but the reason"}, {"Time_Start": 857.4, "Time_End": 858.8, "Text": " why I've tuned a particular amount of covert channels."}, {"Time_Start": 858.8000000000001, "Time_End": 862.36, "Text": " particular intelligent agent to one operating system as opposed to making a portable"}, {"Time_Start": 862.36, "Time_End": 869.2, "Text": " intelligent agent is because we can't trust the operating systems packets that are coming back"}, {"Time_Start": 869.2, "Time_End": 869.9200000000001, "Text": " on the end of the wire."}, {"Time_Start": 869.9200000000001, "Time_End": 871.48, "Text": " We all know Lenox drops packets."}, {"Time_Start": 871.48, "Time_End": 877.86, "Text": " We all know that what you see is not what you get when it's coming back from particular operating"}, {"Time_Start": 877.86, "Time_End": 878.36, "Text": " systems."}, {"Time_Start": 878.36, "Time_End": 882.7400000000001, "Text": " We're going to have crafted payload and non-standard protocols."}, {"Time_Start": 882.7400000000001, "Time_End": 888.3800000000001, "Text": " And this crafted protocol or crafted payload could be directed payload could be directed or indirected"}, {"Time_Start": 888.38, "Time_End": 894.74, "Text": " indirected. We could be sending this to, I don't know, there was a talk last year about"}, {"Time_Start": 894.74, "Time_End": 899.4399999999999, "Text": " IDS and about how you should be looking at things that are on your network as opposed to things"}, {"Time_Start": 899.4399999999999, "Time_End": 906.62, "Text": " that are not running on your network. This is great if we have sane data. We do not"}, {"Time_Start": 906.62, "Time_End": 909.7, "Text": " have seen data out there. We have a bunch of hackers throwing packets everywhere. Look"}, {"Time_Start": 909.7, "Time_End": 918.22, "Text": " at FNED. If we send a packet to a non-existent host and an IDS isn't going to catch this,"}, {"Time_Start": 918.38, "Time_End": 924.42, "Text": " Then we can pick this up on the other end if we're looking for packets somewhere else"}, {"Time_Start": 924.42, "Time_End": 929.6, "Text": " on that segment destined to that host."}, {"Time_Start": 929.6, "Time_End": 935.18, "Text": " And we can actually have communication running back and forth that an IDS has no awareness of."}, {"Time_Start": 935.18, "Time_End": 943.06, "Text": " So although yes, for optimization reasons, it's important to scale your IDS to your network"}, {"Time_Start": 943.06, "Time_End": 948.2, "Text": " topology, you're also going to miss a whole hell of a lot."}, {"Time_Start": 948.2, "Time_End": 954.3000000000001, "Text": " scrubbing was a suggested alternative. And I'm all for this. Doug Song, I believe, was pointed"}, {"Time_Start": 954.3000000000001, "Time_End": 960.0600000000001, "Text": " out his last year to have been working on this. I've seen the stubs go into OpenBSDPF. For"}, {"Time_Start": 960.0600000000001, "Time_End": 965.1600000000001, "Text": " those of you that are not familiar, Darren has pretty much not given us permission to use IPF."}, {"Time_Start": 965.1600000000001, "Time_End": 976.32, "Text": " And his license violates our open standards. So we are moving towards OpenBSDPF, which is a product"}, {"Time_Start": 976.32, "Time_End": 985.0400000000001, "Text": " of Dan Hartmeier, the OpenBSD development team. He has produced a wonderful set of initial"}, {"Time_Start": 985.0400000000001, "Time_End": 992.38, "Text": " code to start from with some optimizations that I think Darren kind of missed the boat on. As far"}, {"Time_Start": 992.38, "Time_End": 998.9200000000001, "Text": " as a firewall, he's got some IDS implications to what he had put into his firewall, such as keep"}, {"Time_Start": 998.9200000000001, "Time_End": 1005.8000000000001, "Text": " frags. We'll get to this more later when we discuss TCB fragmentation assembly and MTEU."}, {"Time_Start": 1006.32, "Time_End": 1015.5200000000001, "Text": " We have assessment codes. Today, our code is singular and disjoint. We have an IDS that detects."}, {"Time_Start": 1015.5200000000001, "Time_End": 1020.5400000000001, "Text": " We have a scanner that scans and a sniffer that sniffs. I mean, this is really, really backwards."}, {"Time_Start": 1020.5400000000001, "Time_End": 1025.64, "Text": " We have a security consultant that sits in the middle and mitigates this risk."}, {"Time_Start": 1025.64, "Time_End": 1033.44, "Text": " Tomorrow, or today, we're going to have conditional response. We're having intelligent tool suites"}, {"Time_Start": 1033.44, "Time_End": 1039.0800000000002, "Text": " that are able to use agents to talk with each other so that we have centralized"}, {"Time_Start": 1039.0800000000002, "Time_End": 1045.56, "Text": " or decentralized reporting. We can use these tools for the, so if a scanner on one tier"}, {"Time_Start": 1045.56, "Time_End": 1054.0, "Text": " of a network infrastructure detects username Joe, password Bob, logging into a network,"}, {"Time_Start": 1054.0, "Time_End": 1060.6200000000001, "Text": " we can report that to the network scanner so that it can detect the presence of that username"}, {"Time_Start": 1060.6200000000001, "Time_End": 1061.94, "Text": " and password on other nodes."}, {"Time_Start": 1061.94, "Time_End": 1072.48, "Text": " so those counts could maybe shut out if we detect that this intrusion was across an anomalous time,"}, {"Time_Start": 1072.56, "Time_End": 1076.8200000000002, "Text": " three o'clock in the morning from the secretary. The secretary has no dial-up access or anything."}, {"Time_Start": 1078.26, "Time_End": 1084.88, "Text": " We can use these tools to basically secure the environment until the knock has a chance to report the problem,"}, {"Time_Start": 1084.88, "Time_End": 1086.8200000000002, "Text": " and they can get people dispatched."}, {"Time_Start": 1088.9, "Time_End": 1091.92, "Text": " We have agent usage. I'm kind of moving through the environment."}, {"Time_Start": 1091.94, "Time_End": 1096.1200000000001, "Text": " these slides. I've been asked to hurry up a little bit since we're kind of on a off-skew here"}, {"Time_Start": 1096.1200000000001, "Time_End": 1102.3200000000002, "Text": " on time. We have automated response. We have replay attack, session hijacking, sniff"}, {"Time_Start": 1102.3200000000002, "Time_End": 1108.26, "Text": " to compromise. That's a nice little term that would mainly mean that you would sniff a packet"}, {"Time_Start": 1108.26, "Time_End": 1112.9, "Text": " like using D-sniff. You get a username and password combination and immediately use that against the"}, {"Time_Start": 1112.9, "Time_End": 1119.5800000000002, "Text": " host that you have sniffed the traffic on without anybody being present. So if somebody"}, {"Time_Start": 1119.5800000000002, "Time_End": 1121.92, "Text": " came back, they could report that that that was actually a successful."}, {"Time_Start": 1121.94, "Time_End": 1124.94, "Text": " login and wasn't a bogus packet or something like that."}, {"Time_Start": 1124.94, "Time_End": 1128.94, "Text": " I mean, we've got sniffers out there that will report anything based on what you send as a crafted packet."}, {"Time_Start": 1128.94, "Time_End": 1136.94, "Text": " If I can dummy up any packet nemesis and trigger any sniffer to believe what I want it to believe,"}, {"Time_Start": 1136.94, "Time_End": 1142.94, "Text": " you're not necessarily getting information that's indicative of what's really out there on your network."}, {"Time_Start": 1142.94, "Time_End": 1145.94, "Text": " We can use distributed agents and autonomous nodes."}, {"Time_Start": 1145.94, "Time_End": 1150.94, "Text": " This kind of reaches the area of where Ender was talking about autonomous nodes and using them to,"}, {"Time_Start": 1150.94, "Time_End": 1156.94, "Text": " each have their own control, each have no knowledge of each other."}, {"Time_Start": 1156.94, "Time_End": 1159.94, "Text": " They just have their own tasks that are mandated on the wire."}, {"Time_Start": 1159.94, "Time_End": 1163.94, "Text": " And this is basically the future of enterprise security solutions."}, {"Time_Start": 1163.94, "Time_End": 1167.94, "Text": " I mean, we are taking information on a network wire,"}, {"Time_Start": 1167.94, "Time_End": 1170.94, "Text": " we are producing a report, and we are walking out of the corporation"}, {"Time_Start": 1170.94, "Time_End": 1172.94, "Text": " with a snapshot of the corporation."}, {"Time_Start": 1172.94, "Time_End": 1175.94, "Text": " And, you know, two minutes later, as we drive off the parking lot,"}, {"Time_Start": 1175.94, "Time_End": 1179.94, "Text": " if they move one box that actual,"}, {"Time_Start": 1179.94, "Time_End": 1183.94, "Text": " actual engagement has completely been obsoleted."}, {"Time_Start": 1185.94, "Time_End": 1189.94, "Text": " And obviously this can stem with distributed agents to intelligent viral infection,"}, {"Time_Start": 1189.94, "Time_End": 1192.94, "Text": " DDOS attacks, and intersegment sniffers."}, {"Time_Start": 1192.94, "Time_End": 1197.94, "Text": " And what I mean by intersegment is by having two different agents on two different endpoints,"}, {"Time_Start": 1197.94, "Time_End": 1202.94, "Text": " both ARP spoofing across the routers, both collecting information and then sorting out"}, {"Time_Start": 1202.94, "Time_End": 1205.94, "Text": " which ones have the exact same packets."}, {"Time_Start": 1205.94, "Time_End": 1209.94, "Text": " And putting together a nice network topology,"}, {"Time_Start": 1209.94, "Time_End": 1212.94, "Text": " that you would normally get from a fully switched environment."}, {"Time_Start": 1214.94, "Time_End": 1217.94, "Text": " The problem with agents, though, is that it can't think outside the box."}, {"Time_Start": 1217.94, "Time_End": 1221.94, "Text": " When you're there doing a network penetration, you've got other risks to worry about."}, {"Time_Start": 1221.94, "Time_End": 1222.94, "Text": " You've got policy."}, {"Time_Start": 1222.94, "Time_End": 1226.94, "Text": " You've got social, political, and economic risks to the corporation"}, {"Time_Start": 1226.94, "Time_End": 1230.94, "Text": " that won't maybe not be so intelligible for a program to figure out"}, {"Time_Start": 1230.94, "Time_End": 1234.94, "Text": " through looking at files that may be of a proprietary format."}, {"Time_Start": 1234.94, "Time_End": 1238.94, "Text": " So, obviously, there's a means to an answer."}, {"Time_Start": 1238.94, "Time_End": 1243.94, "Text": " There's a means to an end and taking this to the electronic level,"}, {"Time_Start": 1243.94, "Time_End": 1249.94, "Text": " but we're going to miss a whole hell of a lot from the actual risk in a corporation if somebody's doing laundering or"}, {"Time_Start": 1249.94, "Time_End": 1255.94, "Text": " somebody is doing something that possibly may not be seen just through electronic traffic alone,"}, {"Time_Start": 1255.94, "Time_End": 1262.94, "Text": " or we would never reach that solution based on looking at that electronic data alone,"}, {"Time_Start": 1262.94, "Time_End": 1267.94, "Text": " and that we would have to be crossing to a level of looking at other documents in the corporation."}, {"Time_Start": 1267.94, "Time_End": 1270.94, "Text": " So now we reach intravenous."}, {"Time_Start": 1270.94, "Time_End": 1278.94, "Text": " The prior slides were just telling along the lines of marrying agents up with TCPIP."}, {"Time_Start": 1278.94, "Time_End": 1284.94, "Text": " This is the actual live intelligent agent that I'm working on currently."}, {"Time_Start": 1284.94, "Time_End": 1290.94, "Text": " I handed off the Nemesis source code to Jeff Nathan of AdStake because I don't have time to work on it anymore."}, {"Time_Start": 1290.94, "Time_End": 1293.94, "Text": " This is all stuff coming out of my free time."}, {"Time_Start": 1293.94, "Time_End": 1296.94, "Text": " And I'm looking at marrying"}, {"Time_Start": 1296.94, "Time_End": 1303.94, "Text": " at marrying an intelligent agent up with a host and network so that we can have"}, {"Time_Start": 1303.94, "Time_End": 1309.94, "Text": " network and host-based assertation as far as what we can look at."}, {"Time_Start": 1309.94, "Time_End": 1310.94, "Text": " Hold on."}, {"Time_Start": 1310.94, "Time_End": 1312.94, "Text": " Client server design."}, {"Time_Start": 1312.94, "Time_End": 1319.94, "Text": " Our agent design criteria for this project intravenous is we've got ammunition here, so this"}, {"Time_Start": 1319.94, "Time_End": 1323.94, "Text": " is only got to talk to Jennifer Granick for about an hour yesterday at our day before yesterday"}, {"Time_Start": 1323.94, "Time_End": 1325.94, "Text": " or yesterday, Black Hat."}, {"Time_Start": 1325.94, "Time_End": 1328.94, "Text": " And we're using blowfish internally."}, {"Time_Start": 1328.94, "Time_End": 1330.94, "Text": " I'm not making plugins."}, {"Time_Start": 1330.94, "Time_End": 1336.94, "Text": " I'm not going to scale this down because US crypto law is restricting exportation."}, {"Time_Start": 1336.94, "Time_End": 1341.94, "Text": " We're all, hopefully, well, there's a lot of people here from other countries."}, {"Time_Start": 1341.94, "Time_End": 1343.94, "Text": " We're going to do what we can."}, {"Time_Start": 1343.94, "Time_End": 1346.94, "Text": " If somebody else can help, write a plugin, that would be great."}, {"Time_Start": 1346.94, "Time_End": 1350.94, "Text": " I want to marry this to open BSD, so if we can find some other solutions, that would be great,"}, {"Time_Start": 1350.94, "Time_End": 1354.94, "Text": " but I'd like to use the internal blowfish functions."}, {"Time_Start": 1354.94, "Time_End": 1361.94, "Text": " So we've got a strongly connected, or strongly authenticated as well a strongly connected client server model."}, {"Time_Start": 1361.94, "Time_End": 1369.94, "Text": " What we mean by this is that we authenticate the Blowfish password and then we have configuration files that are stored at both ends."}, {"Time_Start": 1369.94, "Time_End": 1378.94, "Text": " And we do a Shaw 1 hash and a challenge response to verify that the information stored about who the client IP addresses are"}, {"Time_Start": 1378.94, "Time_End": 1382.94, "Text": " is sane on both the client and the server."}, {"Time_Start": 1382.94, "Time_End": 1386.94, "Text": " Oh, screw up in the slides."}, {"Time_Start": 1386.94, "Time_End": 1392.94, "Text": " We have a sensor, which is modeled after OpenBSTPF, and it's scaled to user land."}, {"Time_Start": 1392.94, "Time_End": 1395.94, "Text": " So we bring this out to stateful packet inspection."}, {"Time_Start": 1395.94, "Time_End": 1397.94, "Text": " We have to take care of TCP fragment handling."}, {"Time_Start": 1397.94, "Time_End": 1404.94, "Text": " We have static filtering rules that are broken up into two categories called intrastate and extra state."}, {"Time_Start": 1404.94, "Time_End": 1411.94, "Text": " We have an expert system, which has knowledge bases in both the arenas of TCP IP."}, {"Time_Start": 1411.94, "Time_End": 1412.94, "Text": " So we actually essentially,"}, {"Time_Start": 1412.94, "Time_End": 1417.98, "Text": " they have three expert systems, three minor expert systems rolled into one."}, {"Time_Start": 1417.98, "Time_End": 1423.8, "Text": " The attack and the defense of, or the attack and defense expert systems, because the inference"}, {"Time_Start": 1423.8, "Time_End": 1428.28, "Text": " engines provide lookup functions to the knowledge bases, are essentially packet steps"}, {"Time_Start": 1428.28, "Time_End": 1431.1200000000001, "Text": " for the, or function steps for the moment."}, {"Time_Start": 1431.1200000000001, "Time_End": 1434.78, "Text": " We're trying to concentrate on next packet injection over raw socket, so we'll be focusing"}, {"Time_Start": 1434.78, "Time_End": 1438.54, "Text": " on TCP IP expert systems."}, {"Time_Start": 1438.54, "Time_End": 1442.92, "Text": " We have an injection engine, these being the three components."}, {"Time_Start": 1442.94, "Time_End": 1452.02, "Text": " components of intravenous, which is simply a user-defined injection, and we have some sort"}, {"Time_Start": 1452.02, "Time_End": 1456.9, "Text": " of automated injection which is going to be looked at across the expert system to see if we've"}, {"Time_Start": 1456.9, "Time_End": 1458.64, "Text": " actually gotten packets."}, {"Time_Start": 1458.64, "Time_End": 1462.9, "Text": " We're trying to do this from the standpoint of allowing or not allowing hackers to be able"}, {"Time_Start": 1462.9, "Time_End": 1470.98, "Text": " to dump or craft packets with nemesis or some other tool to corrupt the state table"}, {"Time_Start": 1470.98, "Time_End": 1472.92, "Text": " of interstate traffic, which is the most important."}, {"Time_Start": 1472.94, "Time_End": 1477.9, "Text": " important state or stateful information that's kept on the wire."}, {"Time_Start": 1477.9, "Time_End": 1479.78, "Text": " Our model sort of looks like this."}, {"Time_Start": 1479.78, "Time_End": 1481.38, "Text": " This is all designed to open BSD."}, {"Time_Start": 1481.38, "Time_End": 1484.76, "Text": " This is using DIA."}, {"Time_Start": 1484.76, "Time_End": 1486.68, "Text": " We have packets that come in."}, {"Time_Start": 1486.68, "Time_End": 1489.44, "Text": " We've got the client that connects to a server."}, {"Time_Start": 1489.44, "Time_End": 1491.48, "Text": " The server rules are configured."}, {"Time_Start": 1491.48, "Time_End": 1497.28, "Text": " We've got three systems, the sensors, the injection engine, and the expert system made up"}, {"Time_Start": 1497.28, "Time_End": 1499.78, "Text": " of the knowledge basis in the inference engine."}, {"Time_Start": 1499.78, "Time_End": 1502.92, "Text": " Packets arrive to the packet filter."}, {"Time_Start": 1502.94, "Time_End": 1508.38, "Text": " brought through the sensor are checked with the injection table to make sure that the"}, {"Time_Start": 1508.38, "Time_End": 1513.14, "Text": " user that connected to the server actually injected this packet."}, {"Time_Start": 1513.14, "Time_End": 1518.0, "Text": " We don't want the, we kind of care less about the extra state table getting fairly corrupted"}, {"Time_Start": 1518.0, "Time_End": 1522.44, "Text": " because we're keeping, we're keeping very minimal state when it comes to extra state"}, {"Time_Start": 1522.44, "Time_End": 1523.44, "Text": " information."}, {"Time_Start": 1523.44, "Time_End": 1525.74, "Text": " We'll get to the definitions in just a second."}, {"Time_Start": 1525.74, "Time_End": 1527.74, "Text": " Interstate is the core component of this."}, {"Time_Start": 1527.74, "Time_End": 1531.74, "Text": " It's all you need to be aware of for at this moment."}, {"Time_Start": 1531.74, "Time_End": 1532.74, "Text": " The problem."}, {"Time_Start": 1532.94, "Time_End": 1536.4, "Text": " with Nemesis was that we have static injection,"}, {"Time_Start": 1537.0, "Time_End": 1540.3200000000002, "Text": " that if we launch one particular packet over and over and over again,"}, {"Time_Start": 1540.4, "Time_End": 1542.92, "Text": " we are basically simulating a sin flood."}, {"Time_Start": 1544.76, "Time_End": 1546.88, "Text": " We send out, we have a sequence number of 100,"}, {"Time_Start": 1547.04, "Time_End": 1548.76, "Text": " an acknowledgement number set to zero,"}, {"Time_Start": 1548.92, "Time_End": 1550.0800000000002, "Text": " we send that to the target."}, {"Time_Start": 1550.5800000000002, "Time_End": 1552.88, "Text": " Target responds with the sequence number of 200,"}, {"Time_Start": 1553.24, "Time_End": 1554.3200000000002, "Text": " acknowledgement number of 101,"}, {"Time_Start": 1554.54, "Time_End": 1556.56, "Text": " which is the next packet that's expecting to send out."}, {"Time_Start": 1557.28, "Time_End": 1559.2, "Text": " However, Nemesis sends out the same packet again,"}, {"Time_Start": 1559.28, "Time_End": 1560.88, "Text": " so we have another sin that doesn't get answered,"}, {"Time_Start": 1561.68, "Time_End": 1562.92, "Text": " and we simply have."}, {"Time_Start": 1562.94, "Time_End": 1563.64, "Text": " no handshake."}, {"Time_Start": 1565.22, "Time_End": 1570.0, "Text": " Nobody has really explored the arena of conducting three-way handshakes through"}, {"Time_Start": 1570.0, "Time_End": 1578.3, "Text": " raw so this is, this agent is all about handling this ongoing connection past the three-way"}, {"Time_Start": 1578.3, "Time_End": 1583.04, "Text": " handshake for as long as period of time as we can possibly stay on the connection up."}, {"Time_Start": 1583.44, "Time_End": 1587.74, "Text": " Through hackers throwing reset floods across the wire to try to drop our connection,"}, {"Time_Start": 1589.8400000000001, "Time_End": 1592.92, "Text": " the general common chaos that goes."}, {"Time_Start": 1592.94, "Time_End": 1597.66, "Text": " on the network wire on a network that is full of maybe untrusted employees,"}, {"Time_Start": 1598.38, "Time_End": 1602.64, "Text": " maybe just a public network like here, where you're going to have a lot of people running amok"}, {"Time_Start": 1602.64, "Time_End": 1607.64, "Text": " on the wireless land, testing out everything that was presented at a black hat."}, {"Time_Start": 1609.64, "Time_End": 1612.3200000000002, "Text": " We have a sin packet that goes in through intravenous."}, {"Time_Start": 1613.44, "Time_End": 1618.52, "Text": " Same thing, sequence number of 100, acknowledgement number is set to zero, target comes back, 200101."}, {"Time_Start": 1619.3200000000002, "Time_End": 1622.92, "Text": " The only difference is is because we're interpreting the packet that comes"}, {"Time_Start": 1622.94, "Time_End": 1628.8400000000001, "Text": " back from the target's intravenous, we can actually have a knowledge base that consists"}, {"Time_Start": 1628.8400000000001, "Time_End": 1634.18, "Text": " of relative value changes based on a major and minor protocol version, which we'll get to"}, {"Time_Start": 1634.18, "Time_End": 1640.9, "Text": " in a little bit, that we'll discuss how we can perform that next packet injection, which the"}, {"Time_Start": 1640.9, "Time_End": 1643.44, "Text": " next packet will answer back from the target."}, {"Time_Start": 1643.44, "Time_End": 1647.28, "Text": " And this keeps this ongoing connection, regardless of payload."}, {"Time_Start": 1647.28, "Time_End": 1652.92, "Text": " Because what we'll come to see is that there are many protocols which are used today, such as"}, {"Time_Start": 1652.94, "Time_End": 1657.6200000000001, "Text": " 70% of the internet being web traffic, that are simply clear text."}, {"Time_Start": 1658.16, "Time_End": 1659.3, "Text": " We have like a new line appended."}, {"Time_Start": 1659.96, "Time_End": 1664.1200000000001, "Text": " And when you've got clear text, you can just read payload from a file just like you did with Nemesis."}, {"Time_Start": 1665.06, "Time_End": 1668.72, "Text": " And you can have each packet pulling one line per one line of payload,"}, {"Time_Start": 1669.22, "Time_End": 1675.3200000000002, "Text": " and each packet that goes out does the next packet injection such as Unicode."}, {"Time_Start": 1675.48, "Time_End": 1676.3600000000001, "Text": " Unicode. Unicode is a great example."}, {"Time_Start": 1676.46, "Time_End": 1681.98, "Text": " You could walk a file system with intravenus, searching for a particular file through a string,"}, {"Time_Start": 1681.98, "Time_End": 1682.92, "Text": " reg Xx combination."}, {"Time_Start": 1682.94, "Time_End": 1686.46, "Text": " We have a client server model."}, {"Time_Start": 1687.96, "Time_End": 1692.68, "Text": " IV, intravenous, not to be confused with VI, if you're typoing."}, {"Time_Start": 1693.7, "Time_End": 1696.88, "Text": " So, yeah, change your CSH shell so that it doesn't detect typos."}, {"Time_Start": 1698.02, "Time_End": 1705.6200000000001, "Text": " Ivy, the client has a configuration file called at slash Etsyiv.com, which contains only the IP addresses of the clients."}, {"Time_Start": 1707.2, "Time_End": 1712.88, "Text": " I say clients here because you may have two foreign powers that want to both join in"}, {"Time_Start": 1712.94, "Time_End": 1716.54, "Text": " the same game of playing with packets across the network."}, {"Time_Start": 1716.7, "Time_End": 1720.18, "Text": " And you can set this up beforehand where you have delegated IP addresses."}, {"Time_Start": 1720.3200000000002, "Time_End": 1722.8, "Text": " And this is what the Shaw 1 hash is computed against."}, {"Time_Start": 1723.74, "Time_End": 1729.4, "Text": " So if a hacker had managed to acquire somehow, I mean, you've got to be a route to run the client."}, {"Time_Start": 1729.9, "Time_End": 1732.02, "Text": " Well, you've got to be a user to run the client."}, {"Time_Start": 1732.1000000000001, "Time_End": 1736.3600000000001, "Text": " You've got to be a route to run the actual agent itself because it's doing the raw packet injection."}, {"Time_Start": 1737.66, "Time_End": 1741.88, "Text": " The client just stands up a blowfish encrypted tunnel to the agent."}, {"Time_Start": 1742.02, "Time_End": 1742.92, "Text": " The agent is the only."}, {"Time_Start": 1742.94, "Time_End": 1744.3200000000002, "Text": " only one doing the packet injection."}, {"Time_Start": 1745.28, "Time_End": 1749.18, "Text": " This is not set up like distributed denial service where you have actually three hops,"}, {"Time_Start": 1749.68, "Time_End": 1752.4, "Text": " where you have a client going to a master and the master's going to the slaves."}, {"Time_Start": 1752.9, "Time_End": 1758.3, "Text": " And the slaves hit me attacks so that when the forensics and analysis is done of the slaves,"}, {"Time_Start": 1758.72, "Time_End": 1762.92, "Text": " the worst that they could do is point back to the master, which can't point back necessarily to the client"}, {"Time_Start": 1762.92, "Time_End": 1765.54, "Text": " unless they do data forensics on the master."}, {"Time_Start": 1766.6000000000001, "Time_End": 1770.7, "Text": " So the whole reason that this was set up on a three tier for distributed analysis service"}, {"Time_Start": 1770.7, "Time_End": 1777.7, "Text": " was to maintain anonymity when conducting a denial service attack."}, {"Time_Start": 1777.7, "Time_End": 1785.0, "Text": " Although this is an offensive tool to explore the defensive applications that could be implemented"}, {"Time_Start": 1785.0, "Time_End": 1791.2, "Text": " with AI, this tool is also meant to be installed in open BSD, and it's also meant that"}, {"Time_Start": 1791.2, "Time_End": 1792.98, "Text": " you have root access on all these agents."}, {"Time_Start": 1792.98, "Time_End": 1796.68, "Text": " So it's assumed that you have control over all the nodes that are attached to this network"}, {"Time_Start": 1796.68, "Time_End": 1798.04, "Text": " diagram."}, {"Time_Start": 1798.04, "Time_End": 1800.68, "Text": " So it makes little sense to play the anonymity game when you have a little sense."}, {"Time_Start": 1800.7, "Time_End": 1805.74, "Text": " you are not just compromising a host and sending packets over the wire."}, {"Time_Start": 1806.94, "Time_End": 1812.3600000000001, "Text": " We initially talked about that this was going to be used with Nemesis and that we were going to use"}, {"Time_Start": 1812.3600000000001, "Time_End": 1814.66, "Text": " Nemesis to actually do the injection threads."}, {"Time_Start": 1815.16, "Time_End": 1823.02, "Text": " The problem with that is that I have had some difficulty coordinating LibNet development"}, {"Time_Start": 1823.02, "Time_End": 1824.4, "Text": " with Nemesis development."}, {"Time_Start": 1824.7, "Time_End": 1829.28, "Text": " At the beginning, Nemesis was developed just fine because we hadn't reached the endpoints of"}, {"Time_Start": 1829.28, "Time_End": 1830.68, "Text": " Libnet of where we're at now."}, {"Time_Start": 1830.7, "Time_End": 1838.88, "Text": " And Libnet has been getting a little airplay these days as far as design on itself."}, {"Time_Start": 1838.88, "Time_End": 1846.7, "Text": " And I spent more time, after talking with Ophir, to get some ICMP obsolete packet types and"}, {"Time_Start": 1846.7, "Time_End": 1852.66, "Text": " codes in place, that these were not being produced as a part of LibNet."}, {"Time_Start": 1852.66, "Time_End": 1855.32, "Text": " And so I produced, you know, some more like ICMP Search Quench."}, {"Time_Start": 1855.32, "Time_End": 1860.68, "Text": " And honestly, I got bored of developing LibNet when Nemesis was the tool."}, {"Time_Start": 1860.7, "Time_End": 1861.42, "Text": " I was developing."}, {"Time_Start": 1862.46, "Time_End": 1868.28, "Text": " So I decided to bring this in-house so that we can explore the arena of host-based analysis"}, {"Time_Start": 1868.28, "Time_End": 1873.44, "Text": " and what we can do with host-based control if we know the operating system that we're on."}, {"Time_Start": 1873.8600000000001, "Time_End": 1878.32, "Text": " The white paper that will be released after this proceeding goes into quite a bit more detail"}, {"Time_Start": 1878.32, "Time_End": 1884.26, "Text": " as to why we described or why we are using OpenBSD as a platform as opposed to another operating"}, {"Time_Start": 1884.26, "Time_End": 1884.68, "Text": " system."}, {"Time_Start": 1886.38, "Time_End": 1890.6000000000001, "Text": " The server is IVD, Ivy Damon."}, {"Time_Start": 1890.7, "Time_End": 1896.02, "Text": " which is the agent, and I'm really, really fascinated with KQ."}, {"Time_Start": 1896.82, "Time_End": 1902.3600000000001, "Text": " I recently tossed Apache to the wayside and threw up THCTD on PacketNinja.net."}, {"Time_Start": 1902.9, "Time_End": 1909.3, "Text": " Because I noticed that my load was going up to a point where I couldn't use the box anymore that the web server was running on"}, {"Time_Start": 1909.3, "Time_End": 1911.1200000000001, "Text": " when there were a lot of simultaneous connections."}, {"Time_Start": 1912.56, "Time_End": 1919.64, "Text": " KQ is some remarkable work that came out of free BSD and has been brought over to OpenBSD."}, {"Time_Start": 1920.7, "Time_End": 1933.92, "Text": " And so we're going to use that to help create the concurrency in case there were lots of people on different agents coming from different regions that wanted to make multiple simultaneous connections to the server so they can manage this a lot better."}, {"Time_Start": 1935.16, "Time_End": 1943.28, "Text": " So we have EtsyivD.com, which contains the IP addresses of this should be servers or the agents."}, {"Time_Start": 1944.0, "Time_End": 1950.46, "Text": " It is aware of the actual other agents that are on the network wire because as you'll see later,"}, {"Time_Start": 1950.7, "Time_End": 1956.0800000000002, "Text": " We're actually going to do an extra state analysis of the other remote agents that are on the wire."}, {"Time_Start": 1957.64, "Time_End": 1968.6200000000001, "Text": " This helps us in being able to see what's going on and what packets are being injected into other agents while we are still connected with yet another agent, which would be considered our local agent."}, {"Time_Start": 1969.4, "Time_End": 1980.68, "Text": " And our max connections are allocated through at civD.com so that we maintain some sanity and we don't have lagging connections between packet injections so that it can keep up."}, {"Time_Start": 1980.7, "Time_End": 1981.7, "Text": " with the interstate engine."}, {"Time_Start": 1981.7, "Time_End": 1993.56, "Text": " As you'll see, we've modeled the interstate engine to use as least clock time or CPU time, I should say, as possible."}, {"Time_Start": 1993.56, "Time_End": 2003.72, "Text": " And this is done through work, through open BSD, PF, through understanding how PF handles TCP fragmentary assembly at minimal cost."}, {"Time_Start": 2003.72, "Time_End": 2010.68, "Text": " And it also has to do with, I lost that thought, both the client and the agent"}, {"Time_Start": 2010.7, "Time_End": 2017.46, "Text": " use IV.comf and IVD.comf. They both have copies of each other. One-way hashes and"}, {"Time_Start": 2017.46, "Time_End": 2026.26, "Text": " strong perm checking of the files. We have basically root-owned file 4-00. We maintain sanity"}, {"Time_Start": 2026.26, "Time_End": 2030.94, "Text": " of IV and IVD by assuming that we are the only ones that have root access to the box"}, {"Time_Start": 2030.94, "Time_End": 2035.76, "Text": " or the ones that do have root access to the box we have knowledge about. So by marrying this to open BSD"}, {"Time_Start": 2035.76, "Time_End": 2040.68, "Text": " and being the secure by default paradigm and the fact that there have been no remote of only"}, {"Time_Start": 2040.7, "Time_End": 2045.7, "Text": " is discovered in the last four years publicly."}, {"Time_Start": 2045.7, "Time_End": 2055.7, "Text": " Yeah, Theo, actually, Theo and the rest of the core development team."}, {"Time_Start": 2055.7, "Time_End": 2059.7, "Text": " I mostly work on ports, but they have a lot of respect on my end."}, {"Time_Start": 2059.7, "Time_End": 2064.7, "Text": " Authentication is successful with password and hash compliance."}, {"Time_Start": 2064.7, "Time_End": 2069.7, "Text": " So we use both these components to do a one and a two-part authentication."}, {"Time_Start": 2069.7, "Time_End": 2085.7, "Text": " This makes sure that if somehow somebody says, hey Bob, you know, talking over the phone on AT&T or whatever, and they're like, here's my password for the agent and it gets tapped somehow because they're using a cordless phone with analog cordless phone or analog cell phone."}, {"Time_Start": 2085.7, "Time_End": 2091.7, "Text": " And we sniff that over our F or we tap their wire or whatever."}, {"Time_Start": 2091.7, "Time_End": 2094.7, "Text": " And we acquire that password through not having root access to that box."}, {"Time_Start": 2094.7, "Time_End": 2099.68, "Text": " We could still, if we just did password authentication, we could still log into that agent and we could still come"}, {"Time_Start": 2099.7, "Time_End": 2108.7, "Text": " control it. But by doing this hash compliance, we assume that the attacker knows the IP addresses that are configured as the clients."}, {"Time_Start": 2108.7, "Time_End": 2118.7, "Text": " If the hacker has no knowledge, no prior knowledge of the client IP addresses, and of course we can just, we've got comments, we use pound for comments, just like shell scripts."}, {"Time_Start": 2118.7, "Time_End": 2129.68, "Text": " We can just throw in garbage into comments, which just obviously helps pump up the hash so that if one client was assigned to IBD.com and somehow that information"}, {"Time_Start": 2129.7, "Time_End": 2135.7, "Text": " got transmitted over a telephone or by word of mouth across the cubicle farm."}, {"Time_Start": 2135.7, "Time_End": 2143.7, "Text": " The password and knowledge of the IVD.com or the, I.B.comf, the actual client IP address,"}, {"Time_Start": 2143.7, "Time_End": 2148.7, "Text": " having one IP address in there alone and doing a Shaw 1 is completely pointless since that could be replicated."}, {"Time_Start": 2148.7, "Time_End": 2151.7, "Text": " And both parts of that authentication could be broken."}, {"Time_Start": 2151.7, "Time_End": 2156.7, "Text": " Our sensors are obviously running in promiscuous modes."}, {"Time_Start": 2156.7, "Time_End": 2159.68, "Text": " Since we're already root, we might as well be running in promiscuous."}, {"Time_Start": 2159.7, "Time_End": 2189.2, "Text": " mode with filtering. We use a standard PCAP for this filter. And we're filtering by what's set up in the configuration file. So what we have are stateful user-defined connection filters, which are delegated as intrastate or defined as intrastate traffic. And we have stateless. It's actually really not stateless. It's minimal state. We keep track of the source, destination IP addresses, and the ports of applicable by protocol."}, {"Time_Start": 2189.7000000000003, "Time_End": 2192.26, "Text": " And that's stored in an extra state table."}, {"Time_Start": 2194.26, "Time_End": 2196.5600000000004, "Text": " The agent is a PCAP filter again."}, {"Time_Start": 2197.0000000000005, "Time_End": 2203.1600000000003, "Text": " It stores the agent IP addresses plus a set of local exclusion ports."}, {"Time_Start": 2203.9, "Time_End": 2210.1600000000003, "Text": " And what we mean by that is we want to be able to set up an agent that can run on a web server"}, {"Time_Start": 2210.1600000000003, "Time_End": 2212.6600000000003, "Text": " that's already communicating with the outside world."}, {"Time_Start": 2213.1000000000004, "Time_End": 2217.94, "Text": " So if we want to set up an agent on a web server, we don't want to be sniffing traffic that is"}, {"Time_Start": 2217.94, "Time_End": 2219.6800000000003, "Text": " legitimately inbound for that web server."}, {"Time_Start": 2219.7000000000003, "Time_End": 2225.4600000000005, "Text": " server. We're not developing an IDS. There are other tools to do that. We want to maintain,"}, {"Time_Start": 2226.5000000000005, "Time_End": 2233.42, "Text": " we want to actually maintain state on packets that are unexpected, coming to the same node that"}, {"Time_Start": 2233.42, "Time_End": 2241.7200000000003, "Text": " the agent's running on. And we want to do information gathering across these remote port, or we want"}, {"Time_Start": 2241.7200000000003, "Time_End": 2247.8, "Text": " to do remote. The ones that are not exempted, we want to do information gathering of. We want to do information gathering of."}, {"Time_Start": 2247.8, "Time_End": 2253.76, "Text": " We have interest date. We reached the definitions. This is the scope of user-injected response."}, {"Time_Start": 2254.1600000000003, "Time_End": 2260.6400000000003, "Text": " These are the tables based of splay trees after talking with Marty about splay trees and also talking"}, {"Time_Start": 2260.6400000000003, "Time_End": 2266.84, "Text": " with Dan Hartmeier. Currently, OpenBSDPF uses AVL trees with a single rotation."}, {"Time_Start": 2267.86, "Time_End": 2271.6000000000004, "Text": " We've discussed possibly dumping splay trees in here. Why?"}, {"Time_Start": 2272.26, "Time_End": 2277.78, "Text": " When we get to the definitions of trees, you'll find that splay trees more adhere to the way that packets move"}, {"Time_Start": 2277.8, "Time_End": 2282.8, "Text": " across the wire that we can actually simulate caching by bringing each expected"}, {"Time_Start": 2282.8, "Time_End": 2290.4, "Text": " node up to root rather than having to have each node of a tree be maintaining height balanced"}, {"Time_Start": 2290.4, "Time_End": 2299.6000000000004, "Text": " of plus or minus one to maintain a nice balanced tree. We use layer three for this obviously"}, {"Time_Start": 2299.6000000000004, "Time_End": 2304.04, "Text": " because we can't anticipate necessarily that all our packets are arriving through"}, {"Time_Start": 2304.04, "Time_End": 2304.0600000000004, "Text": " data link on the on the local land. And we use layer three for this obviously because we can't anticipate necessarily that all our packets are arriving through"}, {"Time_Start": 2304.06, "Time_End": 2309.88, "Text": " data link on the on the local land and we sort the display tree by source"}, {"Time_Start": 2309.88, "Time_End": 2315.62, "Text": " IP addresses so incoming packet source IP addresses because all obviously the"}, {"Time_Start": 2315.62, "Time_End": 2320.14, "Text": " destination IP address will always be one that has been either one of the other"}, {"Time_Start": 2320.14, "Time_End": 2324.34, "Text": " agent IPs or the local agent IP that the promiscuous filter is running on or"}, {"Time_Start": 2324.34, "Time_End": 2331.42, "Text": " the promiscuous sniff is running on and we also maintain a local state of the routing"}, {"Time_Start": 2331.42, "Time_End": 2334.04, "Text": " table here we start dipping"}, {"Time_Start": 2334.06, "Time_End": 2339.5, "Text": " our first finger into why we're marrying this to a particular operating system and"}, {"Time_Start": 2339.5, "Time_End": 2345.94, "Text": " are not just using any operating system. We would only be able to actually maintain user"}, {"Time_Start": 2345.94, "Time_End": 2352.2999999999997, "Text": " define or slash Etsy host slash Etsyresolve.com. We would only be able to use very, very"}, {"Time_Start": 2352.2999999999997, "Time_End": 2358.18, "Text": " clearly Unix compliant files that are used across all operating systems. As you can"}, {"Time_Start": 2358.18, "Time_End": 2364.04, "Text": " tell I'm a big Linux fan. We have Linux. TCP IP as headers have been rewritten very"}, {"Time_Start": 2364.06, "Time_End": 2370.0, "Text": " ways to make them completely incompatible at low level."}, {"Time_Start": 2370.0, "Time_End": 2371.44, "Text": " And so we have tools out there."}, {"Time_Start": 2371.44, "Time_End": 2379.06, "Text": " The reason we have tools out there like LibNet and LibMUA, which ZH is making as a component"}, {"Time_Start": 2379.06, "Time_End": 2382.92, "Text": " that is like LibNet, an alternative to LibNet."}, {"Time_Start": 2382.92, "Time_End": 2394.04, "Text": " We have Lib Event, which is a open, well, it's basically an abstracted KQ method."}, {"Time_Start": 2394.06, "Time_End": 2400.12, "Text": " that other operating systems like Linux that don't implement KQs can use tools that"}, {"Time_Start": 2400.12, "Time_End": 2405.2, "Text": " like Niels Provost has come up with, vomit, which actually sniffs. I don't know if you guys have"}, {"Time_Start": 2405.2, "Time_End": 2412.62, "Text": " seen this. It's worth checking out. Vomit actually is a sniffer that will basically reassemble wave"}, {"Time_Start": 2412.62, "Time_End": 2422.24, "Text": " files of voice over IP connections since Cisco chose not to encrypt this, these connections."}, {"Time_Start": 2422.24, "Time_End": 2424.04, "Text": " We have intrastate rules."}, {"Time_Start": 2424.06, "Time_End": 2443.56, "Text": " These are the rules, the static rules. Once the traffic makes it through the initial packet filter, the PCAP filter, the agent IP addresses, and the local exclusion or local exempted ports, we have a set of rules that go beyond that, that are statically defined to define what interest date is and what extra state is."}, {"Time_Start": 2443.56, "Time_End": 2449.06, "Text": " The packet must have a local agent destination IP address."}, {"Time_Start": 2449.06, "Time_End": 2453.06, "Text": " The packet also must have a protocol match."}, {"Time_Start": 2453.06, "Time_End": 2460.88, "Text": " So we have a little bit mask, a little U-short type that keeps track of the protocols that are already current in the intrastate table."}, {"Time_Start": 2462.38, "Time_End": 2481.92, "Text": " These interests, the protocols that are already been either user-defined injections or following a user-defined injection through continual injection after the user has made the initial sin packet, we have a flow that goes back and forth across the agent that is supposedly or hopefully automated."}, {"Time_Start": 2483.06, "Time_End": 2496.34, "Text": " that this matches up with the protocol that's already a part of the interstate table so that we are not actually getting a protocol thrown on the wire that is not indicative of something that has not already been a part of the interstate engine."}, {"Time_Start": 2496.88, "Time_End": 2506.14, "Text": " Part of the reason for this is we don't want to hack or crafting packets, again, that can saturate our table, make it a mess to sort."}, {"Time_Start": 2508.1, "Time_End": 2512.94, "Text": " A good example, is there are certain tools out there that do, with that name and names."}, {"Time_Start": 2513.06, "Time_End": 2517.06, "Text": " that do passive OS identification, fingerprinting."}, {"Time_Start": 2517.06, "Time_End": 2519.06, "Text": " And they use hash tables."}, {"Time_Start": 2519.06, "Time_End": 2523.06, "Text": " We chose not to use hash tables because hash tables are inherently vulnerable."}, {"Time_Start": 2523.06, "Time_End": 2525.06, "Text": " Why are they vulnerable?"}, {"Time_Start": 2525.06, "Time_End": 2529.06, "Text": " Well, if a hacker knows, I should say attacker, hackers aren't all bad."}, {"Time_Start": 2529.06, "Time_End": 2536.06, "Text": " If an attacker knows that what to inject on the wire to produce state,"}, {"Time_Start": 2536.06, "Time_End": 2539.06, "Text": " the hacker can fill up that hash table."}, {"Time_Start": 2539.06, "Time_End": 2543.04, "Text": " Early days of a particular tool,"}, {"Time_Start": 2543.06, "Time_End": 2550.06, "Text": " I'm thinking of, used a hash to the currently publicly available one, uses a hash table of size 10,000."}, {"Time_Start": 2550.06, "Time_End": 2557.06, "Text": " If I inject a whole bunch of packets from random IP addresses to fill up that 10,000,"}, {"Time_Start": 2557.06, "Time_End": 2565.06, "Text": " that passive OS fingerprinting no longer happens because there isn't a mechanism that was implicit in that"}, {"Time_Start": 2565.06, "Time_End": 2571.06, "Text": " code that would actually do a copy of the old hash table into a bigger hash table,"}, {"Time_Start": 2571.06, "Time_End": 2572.68, "Text": " which is a mess on the big-o."}, {"Time_Start": 2572.7999999999997, "Time_End": 2574.62, "Text": " Everybody here knows Big O notation."}, {"Time_Start": 2575.96, "Time_End": 2578.34, "Text": " And it takes Big O of N."}, {"Time_Start": 2579.34, "Time_End": 2583.7599999999998, "Text": " And if you've got 10,000, that's a hell of a lot of time to recopy that hash table."}, {"Time_Start": 2585.46, "Time_End": 2591.96, "Text": " So we wanted to use in splay trees or trees to keep a pointer-based reference"}, {"Time_Start": 2591.96, "Time_End": 2595.5, "Text": " that we can continually expand until we exhaust available resources,"}, {"Time_Start": 2597.1, "Time_End": 2600.62, "Text": " which we're marrying up because we're using OpenBSD as"}, {"Time_Start": 2600.62, "Time_End": 2602.66, "Text": " an operating system of choice."}, {"Time_Start": 2602.8199999999997, "Time_End": 2613.74, "Text": " We've got a few areas of APIs that we can use, such as pool underscore star, and the pool resources"}, {"Time_Start": 2613.74, "Time_End": 2620.38, "Text": " are a kernel resource pool manager, which basically allows the ability for an application"}, {"Time_Start": 2620.38, "Time_End": 2626.58, "Text": " to not drop like a rock when the box is hammered, and the colonels having enough difficulty"}, {"Time_Start": 2626.58, "Time_End": 2627.5, "Text": " trying to keep up."}, {"Time_Start": 2628.94, "Time_End": 2630.5, "Text": " So we do other things."}, {"Time_Start": 2630.62, "Time_End": 2636.24, "Text": " We do packet prediction, which will, all this will become very apparent and is discussed"}, {"Time_Start": 2636.24, "Time_End": 2639.8599999999997, "Text": " in extreme detail in the white paper."}, {"Time_Start": 2639.8599999999997, "Time_End": 2644.64, "Text": " Packet prediction is the core component of the expert system."}, {"Time_Start": 2644.64, "Time_End": 2647.38, "Text": " We have injection state."}, {"Time_Start": 2647.38, "Time_End": 2650.74, "Text": " We're doing staple packet injection, so we want to make sure that if the user says, I want"}, {"Time_Start": 2650.74, "Time_End": 2656.8199999999997, "Text": " inject a sin to port 80 of this host, that that is a part of the injection state and that when"}, {"Time_Start": 2656.8199999999997, "Time_End": 2660.6, "Text": " the next packet is coming back in, we marry that up with the expert system."}, {"Time_Start": 2660.62, "Time_End": 2667.46, "Text": " relative value changes, and we know that that's a valid packet, and it's not a spoof packet."}, {"Time_Start": 2667.46, "Time_End": 2674.3199999999997, "Text": " And we check this against the expert system tables, which the inference engine uses against the"}, {"Time_Start": 2674.3199999999997, "Time_End": 2676.54, "Text": " knowledge base for lookup."}, {"Time_Start": 2676.54, "Time_End": 2679.44, "Text": " Extra state is the information gathering component."}, {"Time_Start": 2679.44, "Time_End": 2683.54, "Text": " Layer 3, layer 2 is assumed."}, {"Time_Start": 2683.54, "Time_End": 2688.5, "Text": " Layer 3 conducts, is also on a splay tree, it keeps minimal state."}, {"Time_Start": 2688.5, "Time_End": 2690.6, "Text": " We have a link list that keeps track of"}, {"Time_Start": 2690.62, "Time_End": 2693.9, "Text": " IP MAC address relationships on the local land."}, {"Time_Start": 2693.9, "Time_End": 2701.2599999999998, "Text": " For use later, for later purposes of doing either attack or defensive-based research using"}, {"Time_Start": 2701.2599999999998, "Time_End": 2706.2599999999998, "Text": " these packet anomalies that you'll see coming up later."}, {"Time_Start": 2706.2599999999998, "Time_End": 2711.66, "Text": " The extra state rules are that we have a local agent destination with an unknown protocol."}, {"Time_Start": 2711.66, "Time_End": 2716.5, "Text": " We have a local agent destination or we have a local agent destination with an unknown"}, {"Time_Start": 2716.5, "Time_End": 2718.5, "Text": " source IP address."}, {"Time_Start": 2718.5, "Time_End": 2720.6, "Text": " We have a remote agent destination, strategic."}, {"Time_Start": 2720.62, "Time_End": 2726.02, "Text": " So if you set your agents up on two different sides of a land where you may"}, {"Time_Start": 2726.02, "Time_End": 2730.88, "Text": " predict that attacks may be coming from, you can guarantee that one of those agents is going"}, {"Time_Start": 2730.88, "Time_End": 2738.5, "Text": " to be on the same network segment as the attacker, which means that we can do some sort of stateful"}, {"Time_Start": 2738.5, "Time_End": 2741.08, "Text": " analysis from that agent."}, {"Time_Start": 2741.08, "Time_End": 2746.42, "Text": " And with a minimal state, we can keep track of it with the other remote agents."}, {"Time_Start": 2746.42, "Time_End": 2749.5, "Text": " And it also keeps track of layer two and layer three broadcast."}, {"Time_Start": 2749.5, "Time_End": 2752.94, "Text": " TCP IP header versus MTO."}, {"Time_Start": 2752.94, "Time_End": 2758.86, "Text": " This is going to get into why we are handling TCP fragment reassembly cheaply."}, {"Time_Start": 2758.86, "Time_End": 2763.9, "Text": " The largest packet I've seen on a wire, sending out numerous, numerous packets with"}, {"Time_Start": 2763.9, "Time_End": 2771.82, "Text": " Nemesis and other tools, is a TCP sin and a Sync, which sends out 64 bytes because of a 25-byte"}, {"Time_Start": 2771.82, "Time_End": 2774.76, "Text": " set of TCP options."}, {"Time_Start": 2774.76, "Time_End": 2779.48, "Text": " And we have ARP that follows 28 bytes, the RIP base for extended"}, {"Time_Start": 2779.5, "Time_End": 2783.5, "Text": " RIP options is 24 bytes and an OSPF hello packet is 24 bytes."}, {"Time_Start": 2783.5, "Time_End": 2788.56, "Text": " That's kind of like the top four of the tools that are already used in Nemesis as to the"}, {"Time_Start": 2788.56, "Time_End": 2791.48, "Text": " max values I've seen on the network wire."}, {"Time_Start": 2791.48, "Time_End": 2799.1, "Text": " So what happens if we get a packet that's sent to us that is less than 64 bytes in length and"}, {"Time_Start": 2799.1, "Time_End": 2799.8, "Text": " we don't have a full header?"}, {"Time_Start": 2799.8, "Time_End": 2805.88, "Text": " Well, the minimal MTAU I've seen is 572, which is indicative of a PPP."}, {"Time_Start": 2806.88, "Time_End": 2809.4, "Text": " I have never seen an MTO that has gone below."}, {"Time_Start": 2809.5, "Time_End": 2818.5, "Text": " 64 bytes. So the best way that we can handle TCP fragment handling is to simply"}, {"Time_Start": 2818.5, "Time_End": 2825.74, "Text": " drop the first frag. If the full protocol header is not contained because we're"}, {"Time_Start": 2825.74, "Time_End": 2830.8, "Text": " filtering based on this protocol header. Otherwise, we just filter on the first fragment"}, {"Time_Start": 2830.8, "Time_End": 2839.06, "Text": " only. Whereas, Darren Reed's IPF, it keeps frags. Why? I'm not really sure."}, {"Time_Start": 2839.06, "Time_End": 2843.42, "Text": " If we don't have a first frag combination and we let the other frags pass through, we don't"}, {"Time_Start": 2843.42, "Time_End": 2847.2999999999997, "Text": " have a first frag to match up with the rest of the fragments when doing reassembly."}, {"Time_Start": 2847.2999999999997, "Time_End": 2851.4, "Text": " Therefore, we don't have a full attack taking place."}, {"Time_Start": 2851.4, "Time_End": 2854.38, "Text": " The header's missing, or part of the header's missing."}, {"Time_Start": 2854.38, "Time_End": 2855.88, "Text": " So the packets get dropped."}, {"Time_Start": 2855.88, "Time_End": 2856.88, "Text": " So why do we keep fax?"}, {"Time_Start": 2856.88, "Time_End": 2862.38, "Text": " I've been talking with Dan about this a number of times, Dan Hartmire, the guy, P.F."}, {"Time_Start": 2862.38, "Time_End": 2865.94, "Text": " And we haven't been able to come up with real legitimate reasons for doing this."}, {"Time_Start": 2865.94, "Time_End": 2869.04, "Text": " Now I can understand doing this for IDS purposes because we're trying to"}, {"Time_Start": 2869.06, "Time_End": 2875.9, "Text": " match up protocol finger or we're trying to match up anonymous attacks exploitation"}, {"Time_Start": 2875.9, "Time_End": 2879.2599999999998, "Text": " fingerprinting we're trying to match this up with signatures so we want to make sure that we"}, {"Time_Start": 2879.2599999999998, "Time_End": 2882.62, "Text": " get the full header along with the payloads so that we can actually put assign this to"}, {"Time_Start": 2882.62, "Time_End": 2887.0, "Text": " rules and we have some sort of a knowledge as to what the hacker is doing rather than"}, {"Time_Start": 2887.0, "Time_End": 2890.2999999999997, "Text": " just a bunch of random packets going over the wire which doesn't do anybody any"}, {"Time_Start": 2890.2999999999997, "Time_End": 2897.02, "Text": " good and creates a lot of hell going through TCP down otherwise we filter the first"}, {"Time_Start": 2897.02, "Time_End": 2899.04, "Text": " fragment only complete header and the"}, {"Time_Start": 2899.06, "Time_End": 2902.46, "Text": " The next packet injection depends only on the header."}, {"Time_Start": 2902.46, "Time_End": 2904.54, "Text": " So again, we don't care about the payload."}, {"Time_Start": 2904.54, "Time_End": 2910.58, "Text": " If we're only caring about the next header or the complete header, we can just drop all the packets."}, {"Time_Start": 2910.58, "Time_End": 2913.66, "Text": " And obviously there are many reasons for doing fragmentation."}, {"Time_Start": 2913.66, "Time_End": 2919.34, "Text": " A classical example is IP over IP tunneling, increases the size."}, {"Time_Start": 2919.34, "Time_End": 2926.62, "Text": " Our MTEU is set to, oops, is set to Ethernet."}, {"Time_Start": 2926.62, "Time_End": 2928.62, "Text": " We got 1,500 bytes on an Ethernet."}, {"Time_Start": 2928.62, "Time_End": 2931.56, "Text": " and with ICCI, different header combinations,"}, {"Time_Start": 2931.56, "Time_End": 2933.2999999999997, "Text": " we have 1492."}, {"Time_Start": 2933.2999999999997, "Time_End": 2936.8599999999997, "Text": " An IP over IP tunnel would drag that size up"}, {"Time_Start": 2936.8599999999997, "Time_End": 2939.58, "Text": " to where it would be greater than the Ethernet MTEU."}, {"Time_Start": 2939.58, "Time_End": 2941.62, "Text": " So we'd have fragmentation across all these packets."}, {"Time_Start": 2941.62, "Time_End": 2943.5, "Text": " Now, of course, this would be better handled"}, {"Time_Start": 2943.5, "Time_End": 2944.96, "Text": " if we did even distribution."}, {"Time_Start": 2944.96, "Time_End": 2948.8199999999997, "Text": " And we understood ahead of time that we're doing IP over IP tunneling"}, {"Time_Start": 2948.8199999999997, "Time_End": 2951.74, "Text": " so that we could bump the MTA up and make sure"}, {"Time_Start": 2951.74, "Time_End": 2953.38, "Text": " that we were having needless fragmenting,"}, {"Time_Start": 2953.38, "Time_End": 2958.6, "Text": " because this can produce twice the cost doing fragmenting on each packet."}, {"Time_Start": 2958.62, "Time_End": 2966.94, "Text": " So our definite, our possible performance increase and decrease is based on this MTO."}, {"Time_Start": 2966.94, "Time_End": 2971.98, "Text": " And then of course, hackers fragment these packets, either very large, oversized packets"}, {"Time_Start": 2971.98, "Time_End": 2977.44, "Text": " are very small, usually typically, for denial of service, evasion, or compromise."}, {"Time_Start": 2977.44, "Time_End": 2982.24, "Text": " We have our state tables, our interstate table."}, {"Time_Start": 2982.24, "Time_End": 2986.02, "Text": " The updates are consistent or consistent addition and deletion."}, {"Time_Start": 2986.02, "Time_End": 2986.94, "Text": " We have rapid deletion."}, {"Time_Start": 2986.94, "Time_End": 2988.14, "Text": " This is why we don't use hash tables."}, {"Time_Start": 2988.14, "Time_End": 2991.68, "Text": " It's an expensive cost to have to keep updating a table and deleting entries from it."}, {"Time_Start": 2992.16, "Time_End": 2998.1, "Text": " It's just easier to make a prime hash table and to use linear probing, quadratic probing."}, {"Time_Start": 2998.7599999999998, "Time_End": 3003.92, "Text": " There's all types of methods that you can use for trying to avoid collisions and hash tables."}, {"Time_Start": 3004.8399999999997, "Time_End": 3008.3799999999997, "Text": " Frequent use, it's a very expensive operation."}, {"Time_Start": 3009.14, "Time_End": 3012.5, "Text": " This is the most expensive operation is keeping state on this table."}, {"Time_Start": 3013.24, "Time_End": 3014.64, "Text": " So we need an optimal data structure."}, {"Time_Start": 3015.58, "Time_End": 3018.12, "Text": " We need an extra state table, which just update."}, {"Time_Start": 3018.14, "Time_End": 3022.3399999999997, "Text": " it's consistent on addition, and we'll remove the stuff over a timeout."}, {"Time_Start": 3022.46, "Time_End": 3027.6, "Text": " I mean, there's really no reason to just keep removing stuff over and over and over and over again"}, {"Time_Start": 3027.6, "Time_End": 3032.56, "Text": " like we've done with the interest date because we're only trying to keep track of the current packet"}, {"Time_Start": 3032.56, "Time_End": 3034.7799999999997, "Text": " that's on the wire so that we can inject the next packet out."}, {"Time_Start": 3035.2999999999997, "Time_End": 3039.6, "Text": " We don't want to have to sort protocol dependent fields so we can figure out which packet was the latest"}, {"Time_Start": 3039.6, "Time_End": 3040.66, "Text": " packet that was sent over the wire."}, {"Time_Start": 3040.7599999999998, "Time_End": 3042.4, "Text": " There's just too much information to keep track of."}, {"Time_Start": 3042.9, "Time_End": 3045.0, "Text": " Oh, which sequence number is the latest sequence number."}, {"Time_Start": 3045.6, "Time_End": 3046.3199999999997, "Text": " It's a mess."}, {"Time_Start": 3046.3199999999997, "Time_End": 3048.12, "Text": " So we're doing updating."}, {"Time_Start": 3048.14, "Time_End": 3052.02, "Text": " dates with the interstate table with rapid addition and rapid deletion."}, {"Time_Start": 3053.16, "Time_End": 3053.8599999999997, "Text": " How's my time here?"}, {"Time_Start": 3056.18, "Time_End": 3056.98, "Text": " How's my time?"}, {"Time_Start": 3056.98, "Time_End": 3066.1, "Text": " Thank you so much."}, {"Time_Start": 3067.38, "Time_End": 3068.14, "Text": " All right."}, {"Time_Start": 3069.5, "Time_End": 3071.9, "Text": " Speed is important, but not at the expense of security."}, {"Time_Start": 3075.06, "Time_End": 3076.88, "Text": " Hash Tables versus search trees."}, {"Time_Start": 3077.38, "Time_End": 3079.58, "Text": " Why we don't use hash tables and why we use search trees?"}, {"Time_Start": 3080.46, "Time_End": 3083.56, "Text": " Hash tables can create, destroy, insert, delete, and find."}, {"Time_Start": 3083.56, "Time_End": 3086.96, "Text": " We have a static array and it's expensive tree sizes talked before."}, {"Time_Start": 3086.98, "Time_End": 3089.08, "Text": " Our worst case is big O of log-in."}, {"Time_Start": 3089.16, "Time_End": 3091.7, "Text": " Our average case is big O of 1 if we don't have collisions."}, {"Time_Start": 3092.68, "Time_End": 3096.72, "Text": " We do collision handling by giving that prime hash table size."}, {"Time_Start": 3096.84, "Time_End": 3098.42, "Text": " We do up in addressing and chaining."}, {"Time_Start": 3098.66, "Time_End": 3099.72, "Text": " You can read up on hash tables."}, {"Time_Start": 3099.84, "Time_End": 3100.8, "Text": " We're really interested in this."}, {"Time_Start": 3101.34, "Time_End": 3103.58, "Text": " This is better if we're doing things like, I don't know,"}, {"Time_Start": 3103.64, "Time_End": 3105.96, "Text": " some symbol tables like when you're compiling something,"}, {"Time_Start": 3106.46, "Time_End": 3109.2400000000002, "Text": " things where you're not going to be like removing things as you compile"}, {"Time_Start": 3109.2400000000002, "Time_End": 3111.66, "Text": " because you want to maintain state on those symbols."}, {"Time_Start": 3113.12, "Time_End": 3116.4, "Text": " It's better if you just have additions and you don't have deletions."}, {"Time_Start": 3116.98, "Time_End": 3126.16, "Text": " Our search trees can also create, destroy, insert, delete, and find."}, {"Time_Start": 3126.16, "Time_End": 3130.6, "Text": " A typical search tree is height balance at each node."}, {"Time_Start": 3130.6, "Time_End": 3136.14, "Text": " This can be an expensive operation if your hash table, or if your search tree is very big."}, {"Time_Start": 3136.14, "Time_End": 3138.3, "Text": " Balance is maintained through rotations."}, {"Time_Start": 3138.3, "Time_End": 3143.98, "Text": " AVL trees are commonly fined as single and double rotations, which are commonly called zigzag,"}, {"Time_Start": 3143.98, "Time_End": 3146.5, "Text": " zig, zig, zig, zig, zig, and zigzag."}, {"Time_Start": 3146.98, "Time_End": 3154.98, "Text": " OpenBSDPF implements solely single rotations at the moment, but we're still filling out."}, {"Time_Start": 3154.98, "Time_End": 3160.54, "Text": " This is still early in the development of it, but hopefully everything will be in place and"}, {"Time_Start": 3160.54, "Time_End": 3169.5, "Text": " we'll actually have all the state tables solidified for PF by OpenBSD30 this December."}, {"Time_Start": 3169.5, "Time_End": 3175.86, "Text": " We have a linked structure representation rather than a static array that we've defined for a hash table."}, {"Time_Start": 3175.86, "Time_End": 3178.54, "Text": " So our resize is just adding more pointers."}, {"Time_Start": 3179.8, "Time_End": 3182.96, "Text": " Our worst case is Big O of log-in on a height balance tree."}, {"Time_Start": 3184.9, "Time_End": 3189.1400000000003, "Text": " We decided to use splay trees over AVL trees after many discussions."}, {"Time_Start": 3190.48, "Time_End": 3194.86, "Text": " I'm pretty aware that Dragos, I'm not sure if he actually implemented the code."}, {"Time_Start": 3194.96, "Time_End": 3197.1800000000003, "Text": " I know he was involved with it, according to Dan."}, {"Time_Start": 3198.6, "Time_End": 3201.84, "Text": " Marty Royce, you just left at 1 o'clock today, unfortunately."}, {"Time_Start": 3201.84, "Time_End": 3203.1400000000003, "Text": " He could probably confirm that."}, {"Time_Start": 3203.6400000000003, "Time_End": 3205.8, "Text": " But splay trees are used all over the place."}, {"Time_Start": 3205.86, "Time_End": 3211.8, "Text": " start. They can perform faster operations than AVL trees, given a good"}, {"Time_Start": 3211.8, "Time_End": 3216.84, "Text": " splaying algorithm. They're self-adjusting binary trees. There's no height data"}, {"Time_Start": 3216.84, "Time_End": 3223.1, "Text": " stored, unlike AVL, so we get faster searches. But we rotate each access to root."}, {"Time_Start": 3223.1, "Time_End": 3230.6400000000003, "Text": " So basically, the reason this works better for TCP IP is if we're doing interstate"}, {"Time_Start": 3230.6400000000003, "Time_End": 3235.84, "Text": " analysis of a packet, we have source IP to destination IP and vice versa, going back"}, {"Time_Start": 3235.86, "Time_End": 3238.82, "Text": " and forth over and over and over and again."}, {"Time_Start": 3238.82, "Time_End": 3247.6200000000003, "Text": " If we, on the first rotation or into the splay tree, we bump that value up to root of the tree."}, {"Time_Start": 3247.6200000000003, "Time_End": 3253.86, "Text": " We have a big O of one worst case scenario for each additional packet that comes across the"}, {"Time_Start": 3253.86, "Time_End": 3260.98, "Text": " wire until we get a packet that is going to get rotated interest state because the user is defining"}, {"Time_Start": 3260.98, "Time_End": 3264.38, "Text": " that he wants to send a packet to an HTTP server and then another packet to an SMTP server and then another"}, {"Time_Start": 3264.38, "Time_End": 3270.38, "Text": " packet to an SMTP server on yet another box. As these stagger back and forth,"}, {"Time_Start": 3270.38, "Time_End": 3277.38, "Text": " we obviously are going to have probably a worse cost of about the cost of an AVL tree. If anybody"}, {"Time_Start": 3277.38, "Time_End": 3282.42, "Text": " can argue that point with me later, that'd be great. I'd really like to hear that AVL works better"}, {"Time_Start": 3282.42, "Time_End": 3288.88, "Text": " than SPLA, but so far I'm not convinced. The amortized retrieval is big O of log-in on average."}, {"Time_Start": 3288.88, "Time_End": 3294.36, "Text": " Our worst case is a tree that kind of pretty much looks like, if I'm drawn"}, {"Time_Start": 3294.38, "Time_End": 3298.6600000000003, "Text": " this backwards, straight line that goes across, it's all in order."}, {"Time_Start": 3298.6600000000003, "Time_End": 3307.54, "Text": " By definition, a splay tree will never be big O of L, or big O of N for more than one insert"}, {"Time_Start": 3307.54, "Time_End": 3309.3, "Text": " into the splay tree."}, {"Time_Start": 3309.3, "Time_End": 3314.38, "Text": " We bump that up to root, we have a little bit more balance, and things are happy."}, {"Time_Start": 3314.38, "Time_End": 3320.54, "Text": " We have a splay tree algorithm which does double rotations and does this zigzag, which is"}, {"Time_Start": 3320.54, "Time_End": 3324.36, "Text": " indicative of a left branch and a zag is indicative of a right branch. This is also expressed"}, {"Time_Start": 3324.38, "Time_End": 3326.38, "Text": " more detail in the white paper."}, {"Time_Start": 3326.38, "Time_End": 3328.38, "Text": " Expert systems."}, {"Time_Start": 3328.38, "Time_End": 3332.38, "Text": " We have an unbiased, maximum performance, lacks personality."}, {"Time_Start": 3332.38, "Time_End": 3337.38, "Text": " Mycin, which is probably the first commercial expert system,"}, {"Time_Start": 3337.38, "Time_End": 3346.38, "Text": " mapped bacterial infections, and how doctors could basically take a look at symptoms"}, {"Time_Start": 3346.38, "Time_End": 3351.38, "Text": " that a particular patient has across a number of bacteria."}, {"Time_Start": 3351.38, "Time_End": 3353.38, "Text": " And to try to pinpoint this to what might be."}, {"Time_Start": 3353.38, "Time_End": 3357.38, "Text": " to what might be the cause of this person's illness."}, {"Time_Start": 3357.38, "Time_End": 3362.38, "Text": " Obviously, anybody in this room, everybody's got their proficiency."}, {"Time_Start": 3362.38, "Time_End": 3364.38, "Text": " Some people are Linux kernel coders."}, {"Time_Start": 3364.38, "Time_End": 3366.38, "Text": " Some people are Linux user land coders."}, {"Time_Start": 3366.38, "Time_End": 3367.38, "Text": " Some people are Windows people."}, {"Time_Start": 3367.38, "Time_End": 3369.38, "Text": " Everybody's got a proficiency."}, {"Time_Start": 3369.38, "Time_End": 3373.38, "Text": " But if you have an expert system that is matched to, like in Misen's case,"}, {"Time_Start": 3373.38, "Time_End": 3378.38, "Text": " that is mapped against all known bacteria infection types,"}, {"Time_Start": 3378.38, "Time_End": 3382.38, "Text": " we can deduce what the plausible bacteria types are"}, {"Time_Start": 3382.38, "Time_End": 3383.38, "Text": " with human interventions."}, {"Time_Start": 3383.38, "Time_End": 3390.38, "Text": " to make sure that we have a possible match so we don't give someone in the wrong prescription or something."}, {"Time_Start": 3390.38, "Time_End": 3392.38, "Text": " Knowledge basis."}, {"Time_Start": 3392.38, "Time_End": 3396.38, "Text": " We have a TCPIP rule base, an attack row base, a defense rule base."}, {"Time_Start": 3396.38, "Time_End": 3398.38, "Text": " TCPA rule base is the most important."}, {"Time_Start": 3398.38, "Time_End": 3401.38, "Text": " It is indicative of a dictionary."}, {"Time_Start": 3401.38, "Time_End": 3406.38, "Text": " Dictionary of protocols by major and minor version"}, {"Time_Start": 3406.38, "Time_End": 3412.38, "Text": " with the respective dependent fields that need to be altered to maintain the"}, {"Time_Start": 3412.38, "Time_End": 3414.38, "Text": " to maintain this next packet injection."}, {"Time_Start": 3414.38, "Time_End": 3418.38, "Text": " And again, we have inference engines that match up to these knowledge bases."}, {"Time_Start": 3418.38, "Time_End": 3423.38, "Text": " The inference engines pretty much tell how to sort the knowledge bases in as little time as possible."}, {"Time_Start": 3423.38, "Time_End": 3428.38, "Text": " Our TCP IP rule base consists of a list of rules by protocol."}, {"Time_Start": 3428.38, "Time_End": 3432.38, "Text": " We inject TCP sin across destination port 80."}, {"Time_Start": 3432.38, "Time_End": 3434.38, "Text": " So we make an injection table addition."}, {"Time_Start": 3434.38, "Time_End": 3438.38, "Text": " We sniff the next incoming TCP Syn Act packet."}, {"Time_Start": 3438.38, "Time_End": 3441.38, "Text": " We reverse the injection state match."}, {"Time_Start": 3441.38, "Time_End": 3442.38, "Text": " So we reverse the injection state match."}, {"Time_Start": 3442.38, "Time_End": 3446.38, "Text": " the source with the destination IP address and the ports,"}, {"Time_Start": 3446.38, "Time_End": 3449.38, "Text": " and we say, hey, that was already injected by the user."}, {"Time_Start": 3449.38, "Time_End": 3451.38, "Text": " So this must be a valid sniff."}, {"Time_Start": 3451.38, "Time_End": 3454.38, "Text": " We add that to the interest state table."}, {"Time_Start": 3454.38, "Time_End": 3458.38, "Text": " And the rules represent the minimal state change, connection integrity."}, {"Time_Start": 3458.38, "Time_End": 3460.38, "Text": " Here's an example. We have a packet prediction."}, {"Time_Start": 3460.38, "Time_End": 3462.38, "Text": " We have a CNAQ going to an AC."}, {"Time_Start": 3462.38, "Time_End": 3464.38, "Text": " So we sniff the CINAC."}, {"Time_Start": 3464.38, "Time_End": 3467.38, "Text": " We want to send out an ACC as the next packet."}, {"Time_Start": 3467.38, "Time_End": 3470.38, "Text": " We sniff an ACN number of the incoming packet,"}, {"Time_Start": 3470.38, "Time_End": 3471.38, "Text": " and we make that the new sequence number."}, {"Time_Start": 3471.38, "Time_End": 3473.38, "Text": " number of the outgoing packet."}, {"Time_Start": 3473.38, "Time_End": 3476.38, "Text": " We sniff the sequence number of the incoming packet,"}, {"Time_Start": 3476.38, "Time_End": 3479.38, "Text": " and we make that the act number plus one of the outgoing packet."}, {"Time_Start": 3479.38, "Time_End": 3483.38, "Text": " Hence, we keep the connection going through raw packets."}, {"Time_Start": 3483.38, "Time_End": 3484.38, "Text": " We add a payload."}, {"Time_Start": 3484.38, "Time_End": 3487.38, "Text": " This makes clear text protocols really easy."}, {"Time_Start": 3487.38, "Time_End": 3490.38, "Text": " You got Unicode and you've got all these other little attacks that,"}, {"Time_Start": 3490.38, "Time_End": 3493.38, "Text": " you always see these people running them against your Unix boxes,"}, {"Time_Start": 3493.38, "Time_End": 3496.38, "Text": " like they did any sort of information gathering."}, {"Time_Start": 3496.38, "Time_End": 3499.38, "Text": " You can do heads slash HTTP."}, {"Time_Start": 3499.38, "Time_End": 3500.38, "Text": " You could just dump this into a file."}, {"Time_Start": 3500.38, "Time_End": 3503.38, "Text": " file and if you're maintaining this packet prediction,"}, {"Time_Start": 3503.38, "Time_End": 3506.38, "Text": " next packet injection, you pull the next file from the payload file,"}, {"Time_Start": 3506.38, "Time_End": 3507.38, "Text": " and boom."}, {"Time_Start": 3507.38, "Time_End": 3511.38, "Text": " You've got a head, you've done a stateful connection back and forth,"}, {"Time_Start": 3511.38, "Time_End": 3514.38, "Text": " three-way handshake, and you've actually simulated doing"}, {"Time_Start": 3514.38, "Time_End": 3517.38, "Text": " information gathering through head using raw sockets alone"}, {"Time_Start": 3517.38, "Time_End": 3521.38, "Text": " with no client server-based connection"}, {"Time_Start": 3521.38, "Time_End": 3526.38, "Text": " through standard networking sockets, like BSD sockets, etc."}, {"Time_Start": 3526.38, "Time_End": 3529.38, "Text": " Exploitation, here's a famous one."}, {"Time_Start": 3529.38, "Time_End": 3531.38, "Text": " famous one."}, {"Time_Start": 3531.38, "Time_End": 3533.38, "Text": " Ooh, IDFVision."}, {"Time_Start": 3533.38, "Time_End": 3538.38, "Text": " We can use this, and we can actually use this to map the directory structure."}, {"Time_Start": 3538.38, "Time_End": 3541.38, "Text": " All we have to do is change the payload at the end of here,"}, {"Time_Start": 3541.38, "Time_End": 3544.38, "Text": " and we can actually walk a file system and just have it dump"}, {"Time_Start": 3544.38, "Time_End": 3547.38, "Text": " all the packet payload that's coming back on the wire to a file."}, {"Time_Start": 3547.38, "Time_End": 3550.38, "Text": " I mean, really, the goal here is not to have the agent take over"}, {"Time_Start": 3550.38, "Time_End": 3552.38, "Text": " the human's interaction."}, {"Time_Start": 3552.38, "Time_End": 3556.38, "Text": " It's just to help out with the information gathering so that the human isn't doing all these"}, {"Time_Start": 3556.38, "Time_End": 3557.38, "Text": " esoteric moves."}, {"Time_Start": 3557.38, "Time_End": 3558.38, "Text": " You go do a network penetration test."}, {"Time_Start": 3558.38, "Time_End": 3559.38, "Text": " network penetration test."}, {"Time_Start": 3559.38, "Time_End": 3561.38, "Text": " All right, I've got to do a ping scan."}, {"Time_Start": 3561.38, "Time_End": 3562.38, "Text": " All I got to do a port scan."}, {"Time_Start": 3562.38, "Time_End": 3568.0, "Text": " I mean, all this is just so hummed around that it would be nice if we could actually automate some"}, {"Time_Start": 3568.0, "Time_End": 3571.1400000000003, "Text": " of these attacks and just bring the information that we want back."}, {"Time_Start": 3571.1400000000003, "Time_End": 3577.26, "Text": " I mean, after all, we're assessing the organization for economic risk and not necessarily"}, {"Time_Start": 3577.26, "Time_End": 3584.26, "Text": " assessing an organization for the exploit of the day, for Solaris."}, {"Time_Start": 3584.26, "Time_End": 3588.1600000000003, "Text": " We've got bouncing and stealth."}, {"Time_Start": 3588.38, "Time_End": 3593.52, "Text": " connect to a proxy and we can send tool you know payload after we've made this"}, {"Time_Start": 3593.52, "Time_End": 3600.92, "Text": " connection and we can basically masquerade our IP address our attack rules we're going to go"}, {"Time_Start": 3600.92, "Time_End": 3604.38, "Text": " through this real quick because these are stubs right now they maintain exploitation"}, {"Time_Start": 3604.38, "Time_End": 3609.1400000000003, "Text": " signatures and denial service signatures all these are are taking the TCP rule"}, {"Time_Start": 3609.1400000000003, "Time_End": 3612.98, "Text": " base we're the reason why these are stubs right now is we need a rule-based language"}, {"Time_Start": 3612.98, "Time_End": 3617.86, "Text": " for maintaining packets and their dependent protocol values"}, {"Time_Start": 3617.86, "Time_End": 3623.46, "Text": " What we mean that is we need a way that we can say, okay, we want to send out this packet"}, {"Time_Start": 3623.46, "Time_End": 3629.1, "Text": " and then this packet with these fields, then the next packet, and that's indicative of yada yada"}, {"Time_Start": 3629.1, "Time_End": 3630.82, "Text": " denial service attack."}, {"Time_Start": 3630.82, "Time_End": 3632.32, "Text": " So we do this at the protocol layer."}, {"Time_Start": 3632.32, "Time_End": 3638.82, "Text": " We aren't calling it Smurf, we aren't calling it JP, we aren't calling it other names for denial"}, {"Time_Start": 3638.82, "Time_End": 3642.98, "Text": " service attacks, but the idea here is that we don't want to make a network attack engine that"}, {"Time_Start": 3642.98, "Time_End": 3643.98, "Text": " can only do one thing."}, {"Time_Start": 3643.98, "Time_End": 3647.84, "Text": " I want to make a packet crafter that can launch."}, {"Time_Start": 3647.86, "Time_End": 3652.52, "Text": " a whole bunch of these attacks given the knowledge in the rule base through the inference"}, {"Time_Start": 3652.52, "Time_End": 3658.98, "Text": " engine lookups of how we can actually launch each one of these attacks and define them by individual"}, {"Time_Start": 3658.98, "Time_End": 3661.1, "Text": " packets that get us sent across the wire."}, {"Time_Start": 3661.1, "Time_End": 3664.98, "Text": " I mean, keep in mind that we have full control over the protocol headers by not using standard"}, {"Time_Start": 3664.98, "Time_End": 3667.04, "Text": " networking I.O."}, {"Time_Start": 3667.04, "Time_End": 3669.88, "Text": " So we can pretty much do anything here."}, {"Time_Start": 3669.88, "Time_End": 3673.6800000000003, "Text": " The defensive rule base, the reason we're keeping this to open BSD, we want to marry"}, {"Time_Start": 3673.6800000000003, "Time_End": 3677.42, "Text": " this up with open BSDPF through I.O. control."}, {"Time_Start": 3677.42, "Time_End": 3686.58, "Text": " Wouldn't it be cool if you had an agent on a multi-tiered host and you as a user connecting"}, {"Time_Start": 3686.58, "Time_End": 3690.6, "Text": " to these agents knew that these multi-helmed hosts were connected to two different peers across"}, {"Time_Start": 3690.6, "Time_End": 3696.86, "Text": " two different interfaces, two different ISP peers, let's say, or upstream?"}, {"Time_Start": 3696.86, "Time_End": 3699.92, "Text": " And attack started coming in through a particular interface and then we could automatically drop"}, {"Time_Start": 3699.92, "Time_End": 3705.3, "Text": " that attack by dynamically adding a firewall rule to restrict any or dynamically adding a route,"}, {"Time_Start": 3705.3, "Time_End": 3707.4, "Text": " a black hole route that would drop all those parts."}, {"Time_Start": 3707.42, "Time_End": 3712.98, "Text": " it's on the wire until somebody got a chance to come and assess the damage that was happening on the network."}, {"Time_Start": 3713.08, "Time_End": 3718.46, "Text": " I mean, if nobody's getting to the server anyway because it was a denial service attack, we might as well keep the stuff from flooding the network."}, {"Time_Start": 3718.82, "Time_End": 3724.8, "Text": " Because if you've got IDS sensors deployed across your network, and you're doing information gathering based on your topology,"}, {"Time_Start": 3724.92, "Time_End": 3734.58, "Text": " just like every good speaker has told you so far, you are actually collecting a ton of state that keeps coming in, banging your boxes,"}, {"Time_Start": 3734.58, "Time_End": 3743.44, "Text": " you keep getting sensors probing or you keep getting sensor alerts that will keep going until somebody responds."}, {"Time_Start": 3743.54, "Time_End": 3748.18, "Text": " And it would be nice if we could keep the rest of the information gathering on the network sane"}, {"Time_Start": 3748.18, "Time_End": 3754.3199999999997, "Text": " and that we only detected it once and we just say that it's maintaining this until somebody can get to the box"}, {"Time_Start": 3754.3199999999997, "Time_End": 3758.02, "Text": " to figure out what's going on and do some data forensics analysis."}, {"Time_Start": 3759.2999999999997, "Time_End": 3762.8199999999997, "Text": " So we marry this up with both OpenBSDPF and the routing tables."}, {"Time_Start": 3762.82, "Time_End": 3766.7000000000003, "Text": " We have a TCP IP engine, tack engine, and defense engine."}, {"Time_Start": 3767.5, "Time_End": 3770.46, "Text": " We do deterministic prediction, predict with certainty."}, {"Time_Start": 3771.5800000000004, "Time_End": 3774.26, "Text": " There are many ways of doing inference engines."}, {"Time_Start": 3774.5, "Time_End": 3779.32, "Text": " There are pretty much three ways. There's forward chaining, backward chaining, and rule value."}, {"Time_Start": 3779.6000000000004, "Time_End": 3782.26, "Text": " Real value is a optimized version of backward chaining."}, {"Time_Start": 3783.3, "Time_End": 3786.6000000000004, "Text": " And basically, forward chaining is a data-driven search."}, {"Time_Start": 3786.98, "Time_End": 3788.4, "Text": " Backward chaining is a goal-driven search."}, {"Time_Start": 3788.4, "Time_End": 3792.8, "Text": " We've got one to predict with certainty across the TCP-IP."}, {"Time_Start": 3792.82, "Time_End": 3797.52, "Text": " rule-based and inference engine. We don't want to send the next packet if we don't know exactly"}, {"Time_Start": 3797.52, "Time_End": 3801.98, "Text": " what we want to send next. We don't want to hose the interest-state connections. That's the whole"}, {"Time_Start": 3801.98, "Time_End": 3806.8, "Text": " goal here. If we can't maintain because we're missing, we've got three unknowns and we can't decide"}, {"Time_Start": 3806.8, "Time_End": 3811.28, "Text": " what two of the unknowns are going to have to map to, we just drop the packet. TCP is very forgiving."}, {"Time_Start": 3811.42, "Time_End": 3814.9, "Text": " If you don't respond and there's already a, through a handshake going, it'll gladly send you another"}, {"Time_Start": 3814.9, "Time_End": 3821.02, "Text": " packet and tell you more about what it needs. We do probabilistic prediction for the attack and defense."}, {"Time_Start": 3821.02, "Time_End": 3822.08, "Text": " we predict with uncertainty."}, {"Time_Start": 3822.84, "Time_End": 3825.2, "Text": " This is mostly used for user-defined injection."}, {"Time_Start": 3825.56, "Time_End": 3827.5, "Text": " I want to do a smurf attack, send across the wire."}, {"Time_Start": 3828.66, "Time_End": 3830.92, "Text": " So we remove greatest uncertainty, minimal cost."}, {"Time_Start": 3831.34, "Time_End": 3831.52, "Text": " Oops."}, {"Time_Start": 3833.88, "Time_End": 3839.06, "Text": " Major protocol, TCP, ICMP, minor protocol, TCMP, minor protocol, TCP, CNAC, ICMP redirect."}, {"Time_Start": 3839.6, "Time_End": 3842.72, "Text": " Rule value means that we remove the greatest uncertainty at a minimal cost."}, {"Time_Start": 3843.2, "Time_End": 3845.64, "Text": " So if the next packet comes across the wire is a TCP packet,"}, {"Time_Start": 3846.04, "Time_End": 3849.96, "Text": " we can instantly narrow the scope down to the knowledge base to just TCP packets."}, {"Time_Start": 3851.02, "Time_End": 3859.2599999999998, "Text": " And then we can, again, based on the TCP flags that come across the wire, we can narrow that down to an even finer grain scope of what the minor protocol is."}, {"Time_Start": 3860.46, "Time_End": 3866.0, "Text": " So we go, now we're only looking at what the next relative injections are for a particular event of TCP."}, {"Time_Start": 3867.06, "Time_End": 3869.56, "Text": " So we have protocol connection dependent relative field values."}, {"Time_Start": 3870.46, "Time_End": 3875.64, "Text": " Add plus one to this field, set this to a default value."}, {"Time_Start": 3876.7, "Time_End": 3879.96, "Text": " We just grab the minimal state required to make the next connection out."}, {"Time_Start": 3879.96, "Time_End": 3886.54, "Text": " We have actually what, for most packets and my research of gluing various pieces of code together,"}, {"Time_Start": 3887.26, "Time_End": 3888.2, "Text": " it's a constant value."}, {"Time_Start": 3888.26, "Time_End": 3890.06, "Text": " It's like Big O3, Big O4."}, {"Time_Start": 3890.26, "Time_End": 3894.92, "Text": " We usually need to change about three or four values to keep a protocol or to keep a connection moving."}, {"Time_Start": 3897.46, "Time_End": 3897.78, "Text": " Ah."}, {"Time_Start": 3899.7, "Time_End": 3900.1, "Text": " Shit."}, {"Time_Start": 3900.86, "Time_End": 3901.7400000000002, "Text": " User defined injection."}, {"Time_Start": 3903.7200000000003, "Time_End": 3904.7400000000002, "Text": " Can anybody read that?"}, {"Time_Start": 3907.38, "Time_End": 3908.92, "Text": " User Defined Injection?"}, {"Time_Start": 3909.96, "Time_End": 3926.36, "Text": " With interstate, we can't, we aren't allowing any packets to move across the wire that are brought in through the PCAP filter and through the interstate, extra state, static rule base, without the user injecting the packet first."}, {"Time_Start": 3927.1, "Time_End": 3928.54, "Text": " So we inject and we add to the table."}, {"Time_Start": 3928.84, "Time_End": 3932.26, "Text": " And then we have automated injection, which injection is the next packet if the criteria is met."}, {"Time_Start": 3932.92, "Time_End": 3936.76, "Text": " We have stateful packet injection. The usage is sensor sniffs the packets."}, {"Time_Start": 3936.76, "Time_End": 3940.5800000000004, "Text": " Interstate checks the reverses of the addresses and the ports."}, {"Time_Start": 3941.7200000000003, "Time_End": 3942.98, "Text": " Checks injection table."}, {"Time_Start": 3943.2400000000002, "Time_End": 3943.5400000000004, "Text": " Present?"}, {"Time_Start": 3943.82, "Time_End": 3945.0, "Text": " We send to the expert system."}, {"Time_Start": 3945.1200000000003, "Time_End": 3948.96, "Text": " If it's not present, we update the extra state and we drop the state."}, {"Time_Start": 3949.2000000000003, "Time_End": 3950.2000000000003, "Text": " We drop state."}, {"Time_Start": 3950.6800000000003, "Time_End": 3959.2200000000003, "Text": " So we want to drop all that state we've been keeping on the packet and move it into extra state if it's not important to what the user is already defined is what they want to do across the wire."}, {"Time_Start": 3961.1000000000004, "Time_End": 3962.26, "Text": " Thank you very much."}, {"Time_Start": 3963.2200000000003, "Time_End": 3966.7400000000002, "Text": " This is the actual key to unlock the white paper that I will."}, {"Time_Start": 3966.76, "Time_End": 3968.4, "Text": " upload to the site later."}, {"Time_Start": 3969.28, "Time_End": 3973.38, "Text": " I did this just to give you guys a little value added and flavor."}, {"Time_Start": 3974.0400000000004, "Time_End": 3979.2000000000003, "Text": " And I've had like all these people on IRC like, are you going to release the paper early?"}, {"Time_Start": 3980.2000000000003, "Time_End": 3983.76, "Text": " No, but if you attended the conference, which a lot of you did."}, {"Time_Start": 3985.76, "Time_End": 3990.98, "Text": " Cognitive science is the key and it will be mapped to that key and that should encrypt it and decrypt it."}, {"Time_Start": 3991.9, "Time_End": 3992.82, "Text": " And that's it."}, {"Time_Start": 3993.42, "Time_End": 3994.4, "Text": " So anybody have any questions?"}, {"Time_Start": 3995.1200000000003, "Time_End": 3996.7400000000002, "Text": " I know you have a lot, but this white,"}, {"Time_Start": 3996.76, "Time_End": 3997.76, "Text": " paper will clear it a lot."}, {"Time_Start": 3997.76, "Time_End": 4000.76, "Text": " Is it case sensitive?"}, {"Time_Start": 4000.76, "Time_End": 4002.76, "Text": " Is it a case?"}, {"Time_Start": 4002.76, "Time_End": 4007.76, "Text": " The presentation wasn't, but what did you mean by case sensitive?"}, {"Time_Start": 4007.76, "Time_End": 4010.76, "Text": " Oh yeah, it is case sensitive, yes."}, {"Time_Start": 4010.76, "Time_End": 4015.76, "Text": " What's the oral?"}, {"Time_Start": 4015.76, "Time_End": 4018.76, "Text": " www.packet ninja.net.net.net.net.net."}, {"Time_Start": 4018.76, "Time_End": 4022.76, "Text": " You'll find both nemesis and you'll find intravenous."}, {"Time_Start": 4022.76, "Time_End": 4025.76, "Text": " I kind of pulled off all the kitty code that I used to write off the site."}, {"Time_Start": 4025.76, "Time_End": 4032.0800000000004, "Text": " the site. I'm trying to get more deeper into open BSD. I currently maintain about 15"}, {"Time_Start": 4032.0800000000004, "Time_End": 4040.38, "Text": " ports for open BSD and I want to start delving more into the kernel. And this is kind of a, I'm"}, {"Time_Start": 4040.38, "Time_End": 4045.1400000000003, "Text": " providing this for open BSD for reasons that will be outlaid on the white paper as being very"}, {"Time_Start": 4045.1400000000003, "Time_End": 4050.94, "Text": " sane reasons for making this choice. But I'll admit to you all right now that I'm being a little"}, {"Time_Start": 4050.94, "Time_End": 4055.1400000000003, "Text": " selfish and that I want to be able to research the open BSD kernel at a more intricate"}, {"Time_Start": 4055.14, "Time_End": 4062.3799999999997, "Text": " level at the same time I'm producing the intelligent agent."}, {"Time_Start": 4062.3799999999997, "Time_End": 4066.46, "Text": " Anything else?"}, {"Time_Start": 4066.46, "Time_End": 4068.2599999999998, "Text": " Thank you very much for attending."}]}