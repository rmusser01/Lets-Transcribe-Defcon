{
  "segments": [
    {
      "Time_Start": 0.0,
      "Time_End": 2.82,
      "Text": "This text was transcribed using whisper model: large-v2\n\n So the title is From Feature to Weapon,"
    },
    {
      "Time_Start": 2.82,
      "Time_End": 5.42,
      "Text": " Breaking Microsoft Teams and SharePoint Integrity."
    },
    {
      "Time_Start": 6.4,
      "Time_End": 10.68,
      "Text": " So hello, I'm Nestori, Dr. Nestori Sunilainen"
    },
    {
      "Time_Start": 10.68,
      "Time_End": 12.26,
      "Text": " from Finland, obviously."
    },
    {
      "Time_Start": 12.26,
      "Time_End": 15.0,
      "Text": " This is our national team hockey shirt."
    },
    {
      "Time_Start": 15.0,
      "Time_End": 16.68,
      "Text": " We are good at that."
    },
    {
      "Time_Start": 16.68,
      "Time_End": 17.96,
      "Text": " And that's pretty much it."
    },
    {
      "Time_Start": 17.96,
      "Time_End": 21.240000000000002,
      "Text": " And I work for SecureWorks"
    },
    {
      "Time_Start": 21.240000000000002,
      "Time_End": 23.52,
      "Text": " as a Senior Principal Security Researcher."
    },
    {
      "Time_Start": 23.52,
      "Time_End": 27.14,
      "Text": " I've been doing that job for three and a half years now."
    },
    {
      "Time_Start": 27.14,
      "Time_End": 29.84,
      "Text": " I'm on, well, social media."
    },
    {
      "Time_Start": 29.84,
      "Time_End": 32.7,
      "Text": " So Dr. Azuray is the handle,"
    },
    {
      "Time_Start": 32.7,
      "Time_End": 34.5,
      "Text": " so please follow me if you want to."
    },
    {
      "Time_Start": 34.5,
      "Time_End": 36.62,
      "Text": " I might have like 15,000 followers"
    },
    {
      "Time_Start": 36.62,
      "Time_End": 39.46,
      "Text": " if you do that, or even more."
    },
    {
      "Time_Start": 39.46,
      "Time_End": 42.019999999999996,
      "Text": " Okay, I'm also Microsoft MVP."
    },
    {
      "Time_Start": 42.019999999999996,
      "Time_End": 43.58,
      "Text": " Who knows what is MVP?"
    },
    {
      "Time_Start": 44.6,
      "Time_End": 49.06,
      "Text": " Yeah, so I'm MVP on security category, obviously."
    },
    {
      "Time_Start": 49.06,
      "Time_End": 50.34,
      "Text": " That's why I'm here."
    },
    {
      "Time_Start": 50.34,
      "Time_End": 53.46,
      "Text": " And I'm also Microsoft's most valuable researcher."
    },
    {
      "Time_Start": 53.46,
      "Time_End": 55.900000000000006,
      "Text": " So I was able to secure that place"
    },
    {
      "Time_Start": 55.900000000000006,
      "Time_End": 57.58,
      "Text": " like a third time in a row."
    },
    {
      "Time_Start": 58.519999999999996,
      "Time_End": 63.519999999999996,
      "Text": " And it's a nice bunch of people to be a member of."
    },
    {
      "Time_Start": 63.839999999999996,
      "Time_End": 68.84,
      "Text": " Okay, so I think quite a lot of you know best me"
    },
    {
      "Time_Start": 68.96,
      "Time_End": 70.6,
      "Text": " from my tool, A8 Internals."
    },
    {
      "Time_Start": 70.6,
      "Time_End": 71.56,
      "Text": " Who has used that?"
    },
    {
      "Time_Start": 72.67999999999999,
      "Time_End": 75.48,
      "Text": " Okay, are you working for APT29?"
    },
    {
      "Time_Start": 77.44,
      "Time_End": 79.12,
      "Text": " Because they have done that too."
    },
    {
      "Time_Start": 79.12,
      "Time_End": 82.88,
      "Text": " And yeah, so basically it's just an admin hacking toolkit"
    },
    {
      "Time_Start": 82.88,
      "Time_End": 85.2,
      "Text": " for Azure AD."
    },
    {
      "Time_Start": 85.2,
      "Time_End": 87.44,
      "Text": " So that's the name, A8 Internals,"
    },
    {
      "Time_Start": 88.22,
      "Time_End": 89.22,
      "Text": " which is funny because they changed the name."
    },
    {
      "Time_Start": 89.22,
      "Time_End": 91.82,
      "Text": " So it's now EntroID."
    },
    {
      "Time_Start": 91.82,
      "Time_End": 93.53999999999999,
      "Text": " So it's fucking great for a guy"
    },
    {
      "Time_Start": 93.53999999999999,
      "Time_End": 96.94,
      "Text": " who handles Dr. Azure AD and toolkit is A8 Internals."
    },
    {
      "Time_Start": 98.38,
      "Time_End": 102.46,
      "Text": " Okay, yes, so today I'm gonna demonstrate this tool"
    },
    {
      "Time_Start": 102.46,
      "Time_End": 106.5,
      "Text": " to show some of the things I found."
    },
    {
      "Time_Start": 106.5,
      "Time_End": 107.74,
      "Text": " But let's start."
    },
    {
      "Time_Start": 107.74,
      "Time_End": 111.7,
      "Text": " So when my friend heard that I'm gonna speak in DEF CON,"
    },
    {
      "Time_Start": 111.7,
      "Time_End": 113.97999999999999,
      "Text": " he said that you need to have memes."
    },
    {
      "Time_Start": 113.97999999999999,
      "Time_End": 115.66,
      "Text": " I was like, what is meme?"
    },
    {
      "Time_Start": 115.8,
      "Time_End": 120.16,
      "Text": " And then he explained me, okay, so let's try."
    },
    {
      "Time_Start": 120.16,
      "Time_End": 125.16,
      "Text": " So this is me speaking in, what was the,"
    },
    {
      "Time_Start": 125.8,
      "Time_End": 127.12,
      "Text": " it was Cloud Identity Summit, yes,"
    },
    {
      "Time_Start": 127.12,
      "Time_End": 130.28,
      "Text": " like last year in Germany."
    },
    {
      "Time_Start": 130.28,
      "Time_End": 133.2,
      "Text": " I was pointing some nice, really nice setting."
    },
    {
      "Time_Start": 133.2,
      "Time_End": 136.48,
      "Text": " And this picture is taken by another MVP."
    },
    {
      "Time_Start": 136.48,
      "Time_End": 139.56,
      "Text": " And then yet another MVP friend of mine saw that."
    },
    {
      "Time_Start": 139.56,
      "Time_End": 141.98,
      "Text": " Is Olaf, by the way, here?"
    },
    {
      "Time_Start": 141.98,
      "Time_End": 142.82,
      "Text": " No?"
    },
    {
      "Time_Start": 142.82,
      "Time_End": 145.82,
      "Text": " And he said that that's a nice tip"
    },
    {
      "Time_Start": 145.82,
      "Time_End": 147.64,
      "Text": " and also very good for meme."
    },
    {
      "Time_Start": 148.6,
      "Time_End": 150.42,
      "Text": " And then the guy said that we need"
    },
    {
      "Time_Start": 150.42,
      "Time_End": 151.9,
      "Text": " to actually do the meme about this."
    },
    {
      "Time_Start": 151.9,
      "Time_End": 154.0,
      "Text": " And now I have my own meme."
    },
    {
      "Time_Start": 154.0,
      "Time_End": 157.38,
      "Text": " So now I can point things."
    },
    {
      "Time_Start": 157.38,
      "Time_End": 160.66,
      "Text": " Okay, let's see, do I point anything today?"
    },
    {
      "Time_Start": 160.66,
      "Time_End": 163.98,
      "Text": " Okay, so contents of the talk."
    },
    {
      "Time_Start": 163.98,
      "Time_End": 167.01999999999998,
      "Text": " So who knows what is SharePoint?"
    },
    {
      "Time_Start": 168.64,
      "Time_End": 171.82,
      "Text": " Okay, that's nice."
    },
    {
      "Time_Start": 171.82,
      "Time_End": 173.06,
      "Text": " Very untypical."
    },
    {
      "Time_Start": 178.06,
      "Time_End": 183.06,
      "Text": " Yes, so for short, it's a thing that you put documents."
    },
    {
      "Time_Start": 184.34,
      "Time_End": 185.78,
      "Text": " You can do other things about that,"
    },
    {
      "Time_Start": 185.78,
      "Time_End": 188.29999999999998,
      "Text": " but usually it's used for storing documents."
    },
    {
      "Time_Start": 188.29999999999998,
      "Time_End": 192.01999999999998,
      "Text": " And it's one of the services in Microsoft 365,"
    },
    {
      "Time_Start": 192.01999999999998,
      "Time_End": 194.18,
      "Text": " so it's just SharePoint Online."
    },
    {
      "Time_Start": 194.18,
      "Time_End": 199.18,
      "Text": " But how many knew that also Teams is using SharePoint?"
    },
    {
      "Time_Start": 199.98000000000002,
      "Time_End": 202.64000000000001,
      "Text": " Okay, that's also very untypical."
    },
    {
      "Time_Start": 203.6,
      "Time_End": 207.68,
      "Text": " Because yes, Teams, when you put a document in Teams,"
    },
    {
      "Time_Start": 207.68,
      "Time_End": 209.06,
      "Text": " it actually goes to SharePoint."
    },
    {
      "Time_Start": 209.06,
      "Time_End": 212.58,
      "Text": " So it's kind of a background service to store documents."
    },
    {
      "Time_Start": 212.58,
      "Time_End": 215.88,
      "Text": " And also OneDrive is based on SharePoint technically."
    },
    {
      "Time_Start": 215.88,
      "Time_End": 220.38,
      "Text": " So everything like SharePoint, then OneDrive,"
    },
    {
      "Time_Start": 220.38,
      "Time_End": 223.3,
      "Text": " and then Teams, they are using the same thing"
    },
    {
      "Time_Start": 223.3,
      "Time_End": 225.54000000000002,
      "Text": " like a technology on the background."
    },
    {
      "Time_Start": 225.54000000000002,
      "Time_End": 227.66,
      "Text": " So what I'm gonna talk about today is that,"
    },
    {
      "Time_Start": 227.66,
      "Time_End": 228.82,
      "Text": " well, you know the CIA."
    },
    {
      "Time_Start": 229.66,
      "Time_End": 232.1,
      "Text": " So triage, so we have the confidentiality,"
    },
    {
      "Time_Start": 232.1,
      "Time_End": 234.34,
      "Text": " we have the availability, and then the integrity."
    },
    {
      "Time_Start": 234.34,
      "Time_End": 235.85999999999999,
      "Text": " And I'm gonna show you how you can break"
    },
    {
      "Time_Start": 235.85999999999999,
      "Time_End": 240.57999999999998,
      "Text": " the integrity part of that triad with SharePoint."
    },
    {
      "Time_Start": 240.57999999999998,
      "Time_End": 242.98,
      "Text": " It's nice, and I can see a couple of guys from Microsoft,"
    },
    {
      "Time_Start": 242.98,
      "Time_End": 246.45999999999998,
      "Text": " so they are like doing this all the time, so hi."
    },
    {
      "Time_Start": 247.35999999999999,
      "Time_End": 249.82,
      "Text": " But you know this already, so nothing new here."
    },
    {
      "Time_Start": 249.82,
      "Time_End": 253.82,
      "Text": " Okay, and yes, so I'm presenting a stuff"
    },
    {
      "Time_Start": 253.82,
      "Time_End": 256.74,
      "Text": " I found about six or seven months ago."
    },
    {
      "Time_Start": 256.74,
      "Time_End": 259.22,
      "Text": " So I was doing a research project"
    },
    {
      "Time_Start": 259.22,
      "Time_End": 261.42,
      "Text": " where I was trying to check all the different"
    },
    {
      "Time_Start": 261.42,
      "Time_End": 266.1,
      "Text": " migration options you have to Microsoft 365,"
    },
    {
      "Time_Start": 266.1,
      "Time_End": 268.14,
      "Text": " like SharePoint, like files,"
    },
    {
      "Time_Start": 268.14,
      "Time_End": 270.42,
      "Text": " and then also like emails and stuff."
    },
    {
      "Time_Start": 270.42,
      "Time_End": 272.88,
      "Text": " But I didn't find anything interesting anywhere else"
    },
    {
      "Time_Start": 272.88,
      "Time_End": 276.42,
      "Text": " but from SharePoint."
    },
    {
      "Time_Start": 276.42,
      "Time_End": 279.1,
      "Text": " So that's what we're gonna cover today."
    },
    {
      "Time_Start": 279.1,
      "Time_End": 280.36,
      "Text": " And let's start."
    },
    {
      "Time_Start": 280.36,
      "Time_End": 283.1,
      "Text": " So SharePoint Online, migration options."
    },
    {
      "Time_Start": 283.1,
      "Time_End": 285.3,
      "Text": " So because I was studying migration,"
    },
    {
      "Time_Start": 285.3,
      "Time_End": 286.78000000000003,
      "Text": " it's nice to have some options,"
    },
    {
      "Time_Start": 286.78000000000003,
      "Time_End": 290.1,
      "Text": " and we have three currently, what I know of."
    },
    {
      "Time_Start": 290.1,
      "Time_End": 292.42,
      "Text": " And first is like Migration Manager."
    },
    {
      "Time_Start": 292.42,
      "Time_End": 295.82,
      "Text": " And that's like a portal where you can,"
    },
    {
      "Time_Start": 295.82,
      "Time_End": 298.1,
      "Text": " well, manage migrations."
    },
    {
      "Time_Start": 298.1,
      "Time_End": 300.42,
      "Text": " And what you are managing is actually an agent"
    },
    {
      "Time_Start": 300.42,
      "Time_End": 301.66,
      "Text": " that is installed somewhere."
    },
    {
      "Time_Start": 301.66,
      "Time_End": 304.22,
      "Text": " It's on server or whatever."
    },
    {
      "Time_Start": 304.22,
      "Time_End": 306.06,
      "Text": " It depends what you are trying to migrate."
    },
    {
      "Time_Start": 306.06,
      "Time_End": 308.52,
      "Text": " And technically, that is using the same code base"
    },
    {
      "Time_Start": 308.52,
      "Time_End": 311.36,
      "Text": " as the second option called SharePoint Migration Tool."
    },
    {
      "Time_Start": 311.36,
      "Time_End": 315.68,
      "Text": " So those two are using the same agent to do the migration."
    },
    {
      "Time_Start": 315.68,
      "Time_End": 318.44,
      "Text": " And that's SPMT for short."
    },
    {
      "Time_Start": 318.44,
      "Time_End": 320.56,
      "Text": " And the third one is Cross-Tenant OneDrive Migration,"
    },
    {
      "Time_Start": 320.56,
      "Time_End": 321.8,
      "Text": " which I don't know anything about."
    },
    {
      "Time_Start": 321.8,
      "Time_End": 324.28000000000003,
      "Text": " So basically, you should say that I want migrate this"
    },
    {
      "Time_Start": 324.28000000000003,
      "Time_End": 327.12,
      "Text": " to the other tenant, hit the enter, and magic happens."
    },
    {
      "Time_Start": 328.8,
      "Time_End": 332.0,
      "Text": " But today, we are talking about the middle one,"
    },
    {
      "Time_Start": 332.0,
      "Time_End": 334.28000000000003,
      "Text": " which is that SharePoint Migration Tool."
    },
    {
      "Time_Start": 334.28000000000003,
      "Time_End": 335.72,
      "Text": " And what is it?"
    },
    {
      "Time_Start": 335.72,
      "Time_End": 338.52000000000004,
      "Text": " So it's a free, easy-to-use option"
    },
    {
      "Time_Start": 338.56,
      "Time_End": 341.08,
      "Text": " to help you migrate stuff to cloud."
    },
    {
      "Time_Start": 342.71999999999997,
      "Time_End": 344.59999999999997,
      "Text": " And it supports migration to three things,"
    },
    {
      "Time_Start": 344.59999999999997,
      "Time_End": 347.28,
      "Text": " so SharePoint Online and OneDrive and Teams."
    },
    {
      "Time_Start": 348.64,
      "Time_End": 351.64,
      "Text": " And where you can migrate from, well, of course,"
    },
    {
      "Time_Start": 351.64,
      "Time_End": 353.76,
      "Text": " different kind of SharePoint servers."
    },
    {
      "Time_Start": 353.76,
      "Time_End": 357.0,
      "Text": " But usually, people are migrating network shares."
    },
    {
      "Time_Start": 357.0,
      "Time_End": 358.79999999999995,
      "Text": " But of course, if you have some team site,"
    },
    {
      "Time_Start": 358.79999999999995,
      "Time_End": 360.59999999999997,
      "Text": " you might want to, in on-prem,"
    },
    {
      "Time_Start": 360.59999999999997,
      "Time_End": 363.4,
      "Text": " you might want to migrate that also to,"
    },
    {
      "Time_Start": 363.4,
      "Time_End": 365.96,
      "Text": " like, Teams or SharePoint Online."
    },
    {
      "Time_Start": 366.96,
      "Time_End": 369.52,
      "Text": " Okay, now, what's the process then?"
    },
    {
      "Time_Start": 369.52,
      "Time_End": 372.0,
      "Text": " So first, you need to install the tool."
    },
    {
      "Time_Start": 372.0,
      "Time_End": 374.44,
      "Text": " Then you create a migration task."
    },
    {
      "Time_Start": 374.44,
      "Time_End": 376.23999999999995,
      "Text": " And then you can monitor how it goes."
    },
    {
      "Time_Start": 376.23999999999995,
      "Time_End": 378.2,
      "Text": " And then finally, you will see the report"
    },
    {
      "Time_Start": 378.2,
      "Time_End": 380.0,
      "Text": " that what was migrated and whatnot."
    },
    {
      "Time_Start": 382.08,
      "Time_End": 383.84,
      "Text": " So let's see how that works."
    },
    {
      "Time_Start": 383.84,
      "Time_End": 387.2,
      "Text": " So has anybody used this ever?"
    },
    {
      "Time_Start": 387.2,
      "Time_End": 388.88,
      "Text": " SPMT?"
    },
    {
      "Time_Start": 388.88,
      "Time_End": 390.35999999999996,
      "Text": " Yeah, okay, some of you."
    },
    {
      "Time_Start": 391.4,
      "Time_End": 393.79999999999995,
      "Text": " So this is no news to you."
    },
    {
      "Time_Start": 393.79999999999995,
      "Time_End": 394.64,
      "Text": " So how this works?"
    },
    {
      "Time_Start": 394.64,
      "Time_End": 397.47999999999996,
      "Text": " So, sorry, the print might be a bit small,"
    },
    {
      "Time_Start": 397.47999999999996,
      "Time_End": 399.44,
      "Text": " but I'll just walk it through."
    },
    {
      "Time_Start": 399.44,
      "Time_End": 401.44,
      "Text": " So basically, you start the tool,"
    },
    {
      "Time_Start": 401.44,
      "Time_End": 405.2,
      "Text": " and you choose from where you want to copy stuff."
    },
    {
      "Time_Start": 405.2,
      "Time_End": 406.68,
      "Text": " And we choose files there."
    },
    {
      "Time_Start": 406.68,
      "Time_End": 409.03999999999996,
      "Text": " Then you provide the share."
    },
    {
      "Time_Start": 409.03999999999996,
      "Time_End": 411.96,
      "Text": " And do you want to migrate everything or just that one?"
    },
    {
      "Time_Start": 411.96,
      "Time_End": 416.96,
      "Text": " So it can also do the subfolders and the content."
    },
    {
      "Time_Start": 417.68,
      "Time_End": 420.0,
      "Text": " And then where you want to copy stuff."
    },
    {
      "Time_Start": 420.0,
      "Time_End": 421.2,
      "Text": " In this case, Teams."
    },
    {
      "Time_Start": 421.2,
      "Time_End": 423.2,
      "Text": " Now we select which team."
    },
    {
      "Time_Start": 423.24,
      "Time_End": 424.64,
      "Text": " You can select which team."
    },
    {
      "Time_Start": 424.64,
      "Time_End": 427.03999999999996,
      "Text": " And you can also select which channel"
    },
    {
      "Time_Start": 427.03999999999996,
      "Time_End": 428.92,
      "Text": " where you want to put things."
    },
    {
      "Time_Start": 428.92,
      "Time_End": 433.52,
      "Text": " And then you review, choose some options."
    },
    {
      "Time_Start": 433.52,
      "Time_End": 435.2,
      "Text": " And finally, you just wait."
    },
    {
      "Time_Start": 436.56,
      "Time_End": 438.96,
      "Text": " Usually a lot of time."
    },
    {
      "Time_Start": 438.96,
      "Time_End": 442.59999999999997,
      "Text": " Yeah, so this is how the tool looks like."
    },
    {
      "Time_Start": 442.59999999999997,
      "Time_End": 444.32,
      "Text": " And when the tool is working,"
    },
    {
      "Time_Start": 444.32,
      "Time_End": 449.32,
      "Text": " it creates some temp files to AppData,"
    },
    {
      "Time_Start": 449.32,
      "Time_End": 451.91999999999996,
      "Text": " roaming Microsoft Migration Tool Storage."
    },
    {
      "Time_Start": 452.88,
      "Time_End": 453.72,
      "Text": " And what do we have here?"
    },
    {
      "Time_Start": 453.72,
      "Time_End": 457.76,
      "Text": " We have the domain name of the target migration user."
    },
    {
      "Time_Start": 457.76,
      "Time_End": 459.52000000000004,
      "Text": " We have a work folder."
    },
    {
      "Time_Start": 459.52000000000004,
      "Time_End": 461.72,
      "Text": " There are some files."
    },
    {
      "Time_Start": 461.72,
      "Time_End": 463.08000000000004,
      "Text": " We have migration task,"
    },
    {
      "Time_Start": 463.08000000000004,
      "Time_End": 466.48,
      "Text": " and then some database index files."
    },
    {
      "Time_Start": 466.48,
      "Time_End": 469.28000000000003,
      "Text": " And finally, the interesting stuff is here."
    },
    {
      "Time_Start": 469.28000000000003,
      "Time_End": 472.28000000000003,
      "Text": " So the stuff that is actually going to be sent to cloud"
    },
    {
      "Time_Start": 472.28000000000003,
      "Time_End": 473.20000000000005,
      "Text": " is right there."
    },
    {
      "Time_Start": 474.48,
      "Time_End": 477.68,
      "Text": " And if we open that folder, that's on the left side."
    },
    {
      "Time_Start": 477.68,
      "Time_End": 480.48,
      "Text": " And then on the right side is the actual share folder."
    },
    {
      "Time_Start": 480.48,
      "Time_End": 482.88,
      "Text": " We can see, well, I can see, you can't see,"
    },
    {
      "Time_Start": 482.88,
      "Time_End": 484.24,
      "Text": " it's a small print."
    },
    {
      "Time_Start": 484.24,
      "Time_End": 487.48,
      "Text": " But the file sizes are exactly the same,"
    },
    {
      "Time_Start": 487.48,
      "Time_End": 489.44,
      "Text": " but the file names are different."
    },
    {
      "Time_Start": 489.44,
      "Time_End": 491.56,
      "Text": " So on the right side, we can see,"
    },
    {
      "Time_Start": 491.56,
      "Time_End": 492.88,
      "Text": " well, there's some application file."
    },
    {
      "Time_Start": 492.88,
      "Time_End": 496.6,
      "Text": " And the left side, it's just a guid.dat."
    },
    {
      "Time_Start": 498.12,
      "Time_End": 501.16,
      "Text": " And those files are encrypted."
    },
    {
      "Time_Start": 503.68,
      "Time_End": 505.84000000000003,
      "Text": " And when they are sent to cloud,"
    },
    {
      "Time_Start": 505.84000000000003,
      "Time_End": 508.28000000000003,
      "Text": " you also send the, well, actually,"
    },
    {
      "Time_Start": 508.28000000000003,
      "Time_End": 511.76000000000005,
      "Text": " before you are, technically, how this tool works is that"
    },
    {
      "Time_Start": 511.76000000000005,
      "Time_End": 515.0400000000001,
      "Text": " it adds from SharePoint, give me an encryption key,"
    },
    {
      "Time_Start": 515.0400000000001,
      "Time_End": 516.6,
      "Text": " and then it will encrypt stuff."
    },
    {
      "Time_Start": 516.6,
      "Time_End": 519.1600000000001,
      "Text": " And then when they are sent back to cloud,"
    },
    {
      "Time_Start": 519.1600000000001,
      "Time_End": 521.84,
      "Text": " cloud can then decrypt those with that key."
    },
    {
      "Time_Start": 521.84,
      "Time_End": 523.52,
      "Text": " But anyways, they are encrypted."
    },
    {
      "Time_Start": 524.52,
      "Time_End": 527.48,
      "Text": " And that was the data, the actual files."
    },
    {
      "Time_Start": 527.48,
      "Time_End": 529.0400000000001,
      "Text": " But then there's also metadata."
    },
    {
      "Time_Start": 530.84,
      "Time_End": 534.44,
      "Text": " And the most important file is manifest."
    },
    {
      "Time_Start": 534.44,
      "Time_End": 535.28,
      "Text": " Can you see it?"
    },
    {
      "Time_Start": 535.28,
      "Time_End": 536.76,
      "Text": " It's right there."
    },
    {
      "Time_Start": 536.76,
      "Time_End": 541.76,
      "Text": " And what is inside the manifest?"
    },
    {
      "Time_Start": 542.24,
      "Time_End": 543.52,
      "Text": " So basically, you have two things"
    },
    {
      "Time_Start": 543.52,
      "Time_End": 546.08,
      "Text": " that you send to cloud, so the files,"
    },
    {
      "Time_Start": 546.08,
      "Time_End": 548.08,
      "Text": " and then the manifest, or metadata."
    },
    {
      "Time_Start": 548.08,
      "Time_End": 550.52,
      "Text": " And the manifest is the most important one."
    },
    {
      "Time_Start": 550.52,
      "Time_End": 552.0,
      "Text": " And what is inside that?"
    },
    {
      "Time_Start": 553.08,
      "Time_End": 554.28,
      "Text": " Well, it's an XML."
    },
    {
      "Time_Start": 554.28,
      "Time_End": 555.6,
      "Text": " Who loves XML?"
    },
    {
      "Time_Start": 555.6,
      "Time_End": 557.2,
      "Text": " Yeah!"
    },
    {
      "Time_Start": 557.2,
      "Time_End": 558.04,
      "Text": " Nobody."
    },
    {
      "Time_Start": 561.12,
      "Time_End": 564.48,
      "Text": " But okay, so we have the SP file object here."
    },
    {
      "Time_Start": 565.48,
      "Time_End": 567.96,
      "Text": " And then we have the reference to that content file,"
    },
    {
      "Time_Start": 567.96,
      "Time_End": 569.8000000000001,
      "Text": " so that DAT file."
    },
    {
      "Time_Start": 570.8000000000001,
      "Time_End": 573.08,
      "Text": " Then we have a initialization vector"
    },
    {
      "Time_Start": 573.08,
      "Time_End": 575.72,
      "Text": " for decrypting the file content, right?"
    },
    {
      "Time_Start": 576.76,
      "Time_End": 577.9200000000001,
      "Text": " And what else we have?"
    },
    {
      "Time_Start": 577.9200000000001,
      "Time_End": 580.8000000000001,
      "Text": " Well, we have a matching SP list item."
    },
    {
      "Time_Start": 580.8000000000001,
      "Time_End": 584.48,
      "Text": " So those who know how SharePoint works,"
    },
    {
      "Time_Start": 584.48,
      "Time_End": 586.0,
      "Text": " they usually also list items."
    },
    {
      "Time_Start": 586.0,
      "Time_End": 589.88,
      "Text": " But for the rest of you, it doesn't matter."
    },
    {
      "Time_Start": 589.88,
      "Time_End": 593.0,
      "Text": " We are not interested in that one."
    },
    {
      "Time_Start": 593.0,
      "Time_End": 595.2,
      "Text": " But what else we can see here?"
    },
    {
      "Time_Start": 595.2,
      "Time_End": 596.52,
      "Text": " We can see timestamps."
    },
    {
      "Time_Start": 598.16,
      "Time_End": 601.52,
      "Text": " So that's metadata, which is sent to cloud,"
    },
    {
      "Time_Start": 601.52,
      "Time_End": 603.72,
      "Text": " and it contains timestamps."
    },
    {
      "Time_Start": 603.72,
      "Time_End": 605.64,
      "Text": " But it also contains author."
    },
    {
      "Time_Start": 607.2,
      "Time_End": 608.16,
      "Text": " Okay?"
    },
    {
      "Time_Start": 608.16,
      "Time_End": 611.64,
      "Text": " So at this point, what I did was"
    },
    {
      "Time_Start": 611.64,
      "Time_End": 614.6,
      "Text": " that I implemented the same protocol to my tool,"
    },
    {
      "Time_Start": 614.6,
      "Time_End": 619.6,
      "Text": " A8 internals, and because I'm sending those files,"
    },
    {
      "Time_Start": 620.32,
      "Time_End": 621.96,
      "Text": " those files which I selected,"
    },
    {
      "Time_Start": 621.96,
      "Time_End": 625.24,
      "Text": " but also this metadata, which I have full control of,"
    },
    {
      "Time_Start": 625.24,
      "Time_End": 627.88,
      "Text": " it means that I have full control of metadata."
    },
    {
      "Time_Start": 628.84,
      "Time_End": 629.6800000000001,
      "Text": " And I was like,"
    },
    {
      "Time_Start": 631.64,
      "Time_End": 632.5600000000001,
      "Text": " excellent."
    },
    {
      "Time_Start": 634.36,
      "Time_End": 637.52,
      "Text": " So what this means that I can create documents"
    },
    {
      "Time_Start": 637.52,
      "Time_End": 640.96,
      "Text": " as any person to that target site,"
    },
    {
      "Time_Start": 640.96,
      "Time_End": 644.08,
      "Text": " whether it's Teams or OneDrive or SharePoint,"
    },
    {
      "Time_Start": 644.08,
      "Time_End": 646.4000000000001,
      "Text": " and I can also replace files"
    },
    {
      "Time_Start": 648.2,
      "Time_End": 651.76,
      "Text": " and just make up the user who did that and the timestamp."
    },
    {
      "Time_Start": 652.52,
      "Time_End": 653.76,
      "Text": " So I have full control over that."
    },
    {
      "Time_Start": 653.76,
      "Time_End": 655.48,
      "Text": " There's just one catch."
    },
    {
      "Time_Start": 655.48,
      "Time_End": 656.68,
      "Text": " You need to be an admin."
    },
    {
      "Time_Start": 658.52,
      "Time_End": 661.6,
      "Text": " And actually, you need to be a site collection admin."
    },
    {
      "Time_Start": 661.6,
      "Time_End": 664.3199999999999,
      "Text": " Now, it turns out that,"
    },
    {
      "Time_Start": 664.3199999999999,
      "Time_End": 668.08,
      "Text": " well, who of you have ever created a Teams"
    },
    {
      "Time_Start": 668.08,
      "Time_End": 670.12,
      "Text": " or team or whatever that's called?"
    },
    {
      "Time_Start": 670.12,
      "Time_End": 671.6,
      "Text": " Okay?"
    },
    {
      "Time_Start": 671.6,
      "Time_End": 673.0,
      "Text": " So you are that admin."
    },
    {
      "Time_Start": 674.72,
      "Time_End": 676.64,
      "Text": " So the person who creates Teams"
    },
    {
      "Time_Start": 676.64,
      "Time_End": 679.3199999999999,
      "Text": " have those permissions required to do this."
    },
    {
      "Time_Start": 679.3199999999999,
      "Time_End": 680.56,
      "Text": " And it's quite nice, for instance,"
    },
    {
      "Time_Start": 680.5600000000001,
      "Time_End": 682.96,
      "Text": " so let's imagine that my boss would tell me that,"
    },
    {
      "Time_Start": 682.96,
      "Time_End": 684.8000000000001,
      "Text": " hey, Nestori, why don't you create a Teams site"
    },
    {
      "Time_Start": 684.8000000000001,
      "Time_End": 687.2,
      "Text": " with our company traveling policy?"
    },
    {
      "Time_Start": 687.2,
      "Time_End": 688.32,
      "Text": " And it's okay."
    },
    {
      "Time_Start": 688.32,
      "Time_End": 690.5600000000001,
      "Text": " Then I will create that and create a document"
    },
    {
      "Time_Start": 691.5600000000001,
      "Time_End": 693.8000000000001,
      "Text": " as our CEO who said that"
    },
    {
      "Time_Start": 693.8000000000001,
      "Time_End": 695.6,
      "Text": " I can always travel in first class."
    },
    {
      "Time_Start": 696.6800000000001,
      "Time_End": 697.7600000000001,
      "Text": " That would be nice, right?"
    },
    {
      "Time_Start": 697.7600000000001,
      "Time_End": 698.6,
      "Text": " Okay."
    },
    {
      "Time_Start": 698.6,
      "Time_End": 700.6400000000001,
      "Text": " So I have a demo for you."
    },
    {
      "Time_Start": 700.6400000000001,
      "Time_End": 702.44,
      "Text": " So let's see how this works."
    },
    {
      "Time_Start": 704.0000000000001,
      "Time_End": 706.48,
      "Text": " So this is actually quite easy."
    },
    {
      "Time_Start": 706.48,
      "Time_End": 710.48,
      "Text": " So we just create a new team."
    },
    {
      "Time_Start": 711.28,
      "Time_End": 712.52,
      "Text": " I always say teams, but team."
    },
    {
      "Time_Start": 712.52,
      "Time_End": 715.28,
      "Text": " And let's create it from scratch."
    },
    {
      "Time_Start": 718.48,
      "Time_End": 720.0,
      "Text": " And we select private one,"
    },
    {
      "Time_Start": 720.0,
      "Time_End": 722.84,
      "Text": " so we don't invite anyone here."
    },
    {
      "Time_Start": 722.84,
      "Time_End": 725.4,
      "Text": " And then I'm gonna give it a name."
    },
    {
      "Time_Start": 727.36,
      "Time_End": 728.8000000000001,
      "Text": " And then I create the team."
    },
    {
      "Time_Start": 736.4,
      "Time_End": 738.2,
      "Text": " And we don't wanna, for demo,"
    },
    {
      "Time_Start": 738.2,
      "Time_End": 740.12,
      "Text": " we don't wanna invite anyone."
    },
    {
      "Time_Start": 740.6,
      "Time_End": 742.28,
      "Text": " So now if we go to files"
    },
    {
      "Time_Start": 743.28,
      "Time_End": 747.5600000000001,
      "Text": " and select the root folder here,"
    },
    {
      "Time_Start": 747.5600000000001,
      "Time_End": 750.36,
      "Text": " because at that time when I recorded this video,"
    },
    {
      "Time_Start": 750.36,
      "Time_End": 751.5600000000001,
      "Text": " that was the only option."
    },
    {
      "Time_Start": 751.5600000000001,
      "Time_End": 753.36,
      "Text": " So we can see that this folder general"
    },
    {
      "Time_Start": 753.36,
      "Time_End": 755.0,
      "Text": " was created by Diego Siciliani."
    },
    {
      "Time_Start": 755.0,
      "Time_End": 756.0,
      "Text": " Well, maybe you can't see,"
    },
    {
      "Time_Start": 756.0,
      "Time_End": 759.08,
      "Text": " but trust me, it's Diego Siciliani"
    },
    {
      "Time_Start": 759.08,
      "Time_End": 761.52,
      "Text": " who was the guy who created this."
    },
    {
      "Time_Start": 761.52,
      "Time_End": 763.76,
      "Text": " And now I open it in SharePoint"
    },
    {
      "Time_Start": 763.76,
      "Time_End": 768.08,
      "Text": " so that I can copy the URL, also known as site."
    },
    {
      "Time_Start": 768.08,
      "Time_End": 770.5600000000001,
      "Text": " And now I put this information in my tool,"
    },
    {
      "Time_Start": 770.5600000000001,
      "Time_End": 773.84,
      "Text": " and I am gonna create the file as another user"
    },
    {
      "Time_Start": 773.84,
      "Time_End": 776.48,
      "Text": " called Nestor W or Nestor Wilki."
    },
    {
      "Time_Start": 776.48,
      "Time_End": 780.96,
      "Text": " And the date should be 10 year past, in the past."
    },
    {
      "Time_Start": 780.96,
      "Time_End": 785.0400000000001,
      "Text": " And when you upload this, it doesn't take that long,"
    },
    {
      "Time_Start": 785.0400000000001,
      "Time_End": 786.6,
      "Text": " but when you start the job,"
    },
    {
      "Time_Start": 786.6,
      "Time_End": 788.8000000000001,
      "Text": " it can take anything from 10 seconds to 10 minutes."
    },
    {
      "Time_Start": 788.8000000000001,
      "Time_End": 792.2800000000001,
      "Text": " So I have clipped a bit of this video."
    },
    {
      "Time_Start": 792.2800000000001,
      "Time_End": 796.8000000000001,
      "Text": " So now when I go back, back here,"
    },
    {
      "Time_Start": 796.8000000000001,
      "Time_End": 801.1600000000001,
      "Text": " I refresh this and then go back to documents,"
    },
    {
      "Time_Start": 801.1600000000001,
      "Time_End": 802.72,
      "Text": " there should be another file"
    },
    {
      "Time_Start": 802.72,
      "Time_End": 804.4000000000001,
      "Text": " created by a totally different person"
    },
    {
      "Time_Start": 804.4000000000001,
      "Time_End": 805.7600000000001,
      "Text": " and with a different time."
    },
    {
      "Time_Start": 806.9200000000001,
      "Time_End": 809.84,
      "Text": " So this means that I can spoof documents,"
    },
    {
      "Time_Start": 810.96,
      "Time_End": 814.5600000000001,
      "Text": " and I can also tamper with existing documents."
    },
    {
      "Time_Start": 814.5600000000001,
      "Time_End": 816.44,
      "Text": " And this kind of totally breaks the integration"
    },
    {
      "Time_Start": 816.44,
      "Time_End": 821.0000000000001,
      "Text": " of the, well, every service that is based on SharePoint."
    },
    {
      "Time_Start": 822.1600000000001,
      "Time_End": 825.44,
      "Text": " Now, the most funniest part is this."
    },
    {
      "Time_Start": 825.44,
      "Time_End": 830.24,
      "Text": " So if you are creating file using SharePoint online,"
    },
    {
      "Time_Start": 830.24,
      "Time_End": 832.24,
      "Text": " it will be stored in the back-end database"
    },
    {
      "Time_Start": 832.24,
      "Time_End": 835.6800000000001,
      "Text": " with, well, at least a couple of..."
    },
    {
      "Time_Start": 835.6800000000001,
      "Time_End": 838.7600000000001,
      "Text": " Well, 20 years ago, it used to be Microsoft SQL Server,"
    },
    {
      "Time_Start": 838.7600000000001,
      "Time_End": 841.8800000000001,
      "Text": " and also there will be entry and unified audit log."
    },
    {
      "Time_Start": 841.8800000000001,
      "Time_End": 843.72,
      "Text": " But if you use this technique,"
    },
    {
      "Time_Start": 843.72,
      "Time_End": 846.6800000000001,
      "Text": " you send it only to the back-end database."
    },
    {
      "Time_Start": 846.6800000000001,
      "Time_End": 849.2,
      "Text": " So there's no logging whatsoever."
    },
    {
      "Time_Start": 849.2,
      "Time_End": 850.6,
      "Text": " It's also quite interesting."
    },
    {
      "Time_Start": 851.72,
      "Time_End": 853.6800000000001,
      "Text": " So let's, I'll say it again."
    },
    {
      "Time_Start": 853.6800000000001,
      "Time_End": 857.72,
      "Text": " So you can spoof and tamper with, and there's no logs."
    },
    {
      "Time_Start": 857.72,
      "Time_End": 859.32,
      "Text": " Sounds nice, right?"
    },
    {
      "Time_Start": 860.36,
      "Time_End": 865.36,
      "Text": " So I reported this to Microsoft in November last year,"
    },
    {
      "Time_Start": 866.24,
      "Time_End": 871.1600000000001,
      "Text": " and I told exactly this, so that I found a way"
    },
    {
      "Time_Start": 871.1600000000001,
      "Time_End": 875.84,
      "Text": " that such a normal guy who creates a team can do this."
    },
    {
      "Time_Start": 875.84,
      "Time_End": 878.2800000000001,
      "Text": " And I kind of reported that it would be nice"
    },
    {
      "Time_Start": 878.2800000000001,
      "Time_End": 882.5600000000001,
      "Text": " that the name of that guy who actually uploaded that file"
    },
    {
      "Time_Start": 882.5600000000001,
      "Time_End": 883.8000000000001,
      "Text": " would be there somewhere."
    },
    {
      "Time_Start": 884.9200000000001,
      "Time_End": 888.6800000000001,
      "Text": " But somehow, it seemed to me that they understood"
    },
    {
      "Time_Start": 888.6800000000001,
      "Time_End": 892.44,
      "Text": " that I was criticizing that migration API."
    },
    {
      "Time_Start": 892.44,
      "Time_End": 894.7600000000001,
      "Text": " But no, it's working as intended."
    },
    {
      "Time_Start": 894.7600000000001,
      "Time_End": 896.7600000000001,
      "Text": " So that was not my purpose."
    },
    {
      "Time_Start": 896.7600000000001,
      "Time_End": 900.32,
      "Text": " But it's a working, normal feature works as it should be,"
    },
    {
      "Time_Start": 900.32,
      "Time_End": 902.9200000000001,
      "Text": " but you can do bad things about that."
    },
    {
      "Time_Start": 902.9200000000001,
      "Time_End": 905.6800000000001,
      "Text": " And they said that customers want to preserve metadata."
    },
    {
      "Time_Start": 905.6800000000001,
      "Time_End": 908.44,
      "Text": " Yes, I understand that, but there's no logging whatsoever."
    },
    {
      "Time_Start": 908.44,
      "Time_End": 912.32,
      "Text": " So you can't know who did that, actually."
    },
    {
      "Time_Start": 912.96,
      "Time_End": 914.5200000000001,
      "Text": " And the last thing is that only SharePoint"
    },
    {
      "Time_Start": 914.5200000000001,
      "Time_End": 917.2800000000001,
      "Text": " site collection admin can do this."
    },
    {
      "Time_Start": 917.2800000000001,
      "Time_End": 920.32,
      "Text": " And they should, they probably know what they are doing,"
    },
    {
      "Time_Start": 920.32,
      "Time_End": 923.5600000000001,
      "Text": " and that's what I'm afraid of,"
    },
    {
      "Time_Start": 923.5600000000001,
      "Time_End": 926.8000000000001,
      "Text": " that they actually now know that."
    },
    {
      "Time_Start": 926.8000000000001,
      "Time_End": 931.8000000000001,
      "Text": " But this is like by design, which in micro terminology"
    },
    {
      "Time_Start": 932.72,
      "Time_End": 934.6800000000001,
      "Text": " means that they are not gonna fix that."
    },
    {
      "Time_Start": 934.6800000000001,
      "Time_End": 936.44,
      "Text": " So now you can do that also."
    },
    {
      "Time_Start": 936.44,
      "Time_End": 939.6400000000001,
      "Text": " I am publishing my toolkit, the newest version,"
    },
    {
      "Time_Start": 939.6400000000001,
      "Time_End": 942.2,
      "Text": " when I have a decent internet connection,"
    },
    {
      "Time_Start": 943.08,
      "Time_End": 943.9200000000001,
      "Text": " which I don't have here."
    },
    {
      "Time_Start": 943.9200000000001,
      "Time_End": 946.6800000000001,
      "Text": " So maybe on Monday when I'm back in Finland."
    },
    {
      "Time_Start": 946.6800000000001,
      "Time_End": 948.24,
      "Text": " So that was that."
    },
    {
      "Time_Start": 948.24,
      "Time_End": 951.2,
      "Text": " So now you can do that also quite easily."
    },
    {
      "Time_Start": 951.2,
      "Time_End": 953.8000000000001,
      "Text": " So you can try this at home."
    },
    {
      "Time_Start": 953.8000000000001,
      "Time_End": 956.76,
      "Text": " And let's see what people who are doing auditing,"
    },
    {
      "Time_Start": 956.76,
      "Time_End": 958.88,
      "Text": " they might not like that."
    },
    {
      "Time_Start": 958.88,
      "Time_End": 961.24,
      "Text": " We can create files without no traces whatsoever."
    },
    {
      "Time_Start": 961.24,
      "Time_End": 964.6,
      "Text": " So it's gonna be interesting, let's say, in this way."
    },
    {
      "Time_Start": 965.6800000000001,
      "Time_End": 967.6,
      "Text": " Okay, but that's not all."
    },
    {
      "Time_Start": 967.6,
      "Time_End": 969.12,
      "Text": " Let's go to next generation."
    },
    {
      "Time_Start": 969.12,
      "Time_End": 973.48,
      "Text": " So I continued studying this."
    },
    {
      "Time_Start": 973.48,
      "Time_End": 974.92,
      "Text": " So what can I do with this?"
    },
    {
      "Time_Start": 974.92,
      "Time_End": 977.64,
      "Text": " So is it just uploading files and replacing ones?"
    },
    {
      "Time_Start": 977.64,
      "Time_End": 980.4,
      "Text": " Well, it is, but bear with me."
    },
    {
      "Time_Start": 981.68,
      "Time_End": 984.12,
      "Text": " So Google, who loves Google?"
    },
    {
      "Time_Start": 984.12,
      "Time_End": 984.96,
      "Text": " I do."
    },
    {
      "Time_Start": 985.88,
      "Time_End": 986.72,
      "Text": " Who use Bing?"
    },
    {
      "Time_Start": 987.96,
      "Time_End": 988.8,
      "Text": " Okay."
    },
    {
      "Time_Start": 990.08,
      "Time_End": 992.36,
      "Text": " Because one of my friends, Sami Lahia,"
    },
    {
      "Time_Start": 992.36,
      "Time_End": 994.92,
      "Text": " used to say that you use Bing for searching stuff"
    },
    {
      "Time_Start": 994.92,
      "Time_End": 996.4,
      "Text": " and Google for finding stuff."
    },
    {
      "Time_Start": 999.4,
      "Time_End": 1002.92,
      "Text": " So actually, I was able to find a documentation about this."
    },
    {
      "Time_Start": 1002.92,
      "Time_End": 1007.12,
      "Text": " So I just Googled the tag names of that manifest file,"
    },
    {
      "Time_Start": 1007.12,
      "Time_End": 1009.8,
      "Text": " and I found that there's a documentation."
    },
    {
      "Time_Start": 1009.8,
      "Time_End": 1012.44,
      "Text": " And I saw that that applies to SharePoint Online,"
    },
    {
      "Time_Start": 1012.44,
      "Time_End": 1014.4,
      "Text": " but also like on-prem SharePoint,"
    },
    {
      "Time_Start": 1014.4,
      "Time_End": 1018.88,
      "Text": " 2016, 2019, 2013, whatever they are."
    },
    {
      "Time_Start": 1018.88,
      "Time_End": 1021.76,
      "Text": " And not many of you might know that,"
    },
    {
      "Time_Start": 1021.76,
      "Time_End": 1026.56,
      "Text": " but I heard Dark passed as a SharePoint admin."
    },
    {
      "Time_Start": 1026.6,
      "Time_End": 1030.3999999999999,
      "Text": " So this is actually dates from 2009."
    },
    {
      "Time_Start": 1030.3999999999999,
      "Time_End": 1032.56,
      "Text": " So it's like 15 years ago."
    },
    {
      "Time_Start": 1033.8799999999999,
      "Time_End": 1036.52,
      "Text": " So I passed two certifications."
    },
    {
      "Time_Start": 1036.52,
      "Time_End": 1040.8,
      "Text": " So I'm certified on-prem SharePoint admin"
    },
    {
      "Time_Start": 1040.8,
      "Time_End": 1042.44,
      "Text": " for server version 2007."
    },
    {
      "Time_Start": 1042.44,
      "Time_End": 1046.0,
      "Text": " But the first one I ever worked with was from 2003."
    },
    {
      "Time_Start": 1046.0,
      "Time_End": 1048.32,
      "Text": " So that's like 20 years ago."
    },
    {
      "Time_Start": 1048.32,
      "Time_End": 1051.24,
      "Text": " Some of you weren't even born at that time."
    },
    {
      "Time_Start": 1051.24,
      "Time_End": 1052.32,
      "Text": " So I'm that old."
    },
    {
      "Time_Start": 1054.6399999999999,
      "Time_End": 1056.52,
      "Text": " Okay, so what did I do?"
    },
    {
      "Time_Start": 1057.36,
      "Time_End": 1061.04,
      "Text": " I installed, of course, SharePoint server on-prem."
    },
    {
      "Time_Start": 1061.96,
      "Time_End": 1064.6399999999999,
      "Text": " Have any of you done that before?"
    },
    {
      "Time_Start": 1064.6399999999999,
      "Time_End": 1065.96,
      "Text": " It takes a while."
    },
    {
      "Time_Start": 1067.84,
      "Time_End": 1068.8799999999999,
      "Text": " But yeah, I managed to do that."
    },
    {
      "Time_Start": 1068.8799999999999,
      "Time_End": 1072.76,
      "Text": " So luckily, Microsoft has not put any money"
    },
    {
      "Time_Start": 1072.76,
      "Time_End": 1075.96,
      "Text": " on updating SharePoint like on-prem."
    },
    {
      "Time_Start": 1075.96,
      "Time_End": 1080.96,
      "Text": " So it still looks like the same, like almost 20 years ago."
    },
    {
      "Time_Start": 1081.0,
      "Time_End": 1085.84,
      "Text": " And I also knew that that documentation I found,"
    },
    {
      "Time_Start": 1085.84,
      "Time_End": 1090.4399999999998,
      "Text": " it was describing the XML of granular backup."
    },
    {
      "Time_Start": 1092.4399999999998,
      "Time_End": 1097.12,
      "Text": " And which means that if you have the on-prem site,"
    },
    {
      "Time_Start": 1097.12,
      "Time_End": 1099.12,
      "Text": " you can export a site or list."
    },
    {
      "Time_Start": 1099.12,
      "Time_End": 1100.24,
      "Text": " And that's what I did here."
    },
    {
      "Time_Start": 1100.24,
      "Time_End": 1103.84,
      "Text": " So I chose export site."
    },
    {
      "Time_Start": 1103.84,
      "Time_End": 1105.9599999999998,
      "Text": " And in the upper right-hand corner,"
    },
    {
      "Time_Start": 1105.9599999999998,
      "Time_End": 1108.0,
      "Text": " there's the site collection, which I wanted to export."
    },
    {
      "Time_Start": 1108.0,
      "Time_End": 1112.4399999999998,
      "Text": " And then you need to enter a name of that backup file."
    },
    {
      "Time_Start": 1112.4399999999998,
      "Time_End": 1114.6799999999998,
      "Text": " So the original file extension,"
    },
    {
      "Time_Start": 1114.68,
      "Time_End": 1116.28,
      "Text": " what it's proposing is CMP."
    },
    {
      "Time_Start": 1116.28,
      "Time_End": 1117.64,
      "Text": " I don't know what that means."
    },
    {
      "Time_Start": 1117.64,
      "Time_End": 1121.48,
      "Text": " But technically, it is CAB or cabinet file."
    },
    {
      "Time_Start": 1121.48,
      "Time_End": 1124.44,
      "Text": " It's an Asian technology from 1990s."
    },
    {
      "Time_Start": 1124.44,
      "Time_End": 1126.44,
      "Text": " So it's a kind of archive."
    },
    {
      "Time_Start": 1126.44,
      "Time_End": 1128.3600000000001,
      "Text": " So you just rename that to CAB,"
    },
    {
      "Time_Start": 1128.3600000000001,
      "Time_End": 1131.28,
      "Text": " and then you can open that with Windows Explorer."
    },
    {
      "Time_Start": 1132.6000000000001,
      "Time_End": 1134.0800000000002,
      "Text": " And here it is."
    },
    {
      "Time_Start": 1134.0800000000002,
      "Time_End": 1134.92,
      "Text": " Nice."
    },
    {
      "Time_Start": 1134.92,
      "Time_End": 1136.96,
      "Text": " So we have teamsite.cab."
    },
    {
      "Time_Start": 1136.96,
      "Time_End": 1139.64,
      "Text": " And when I open that up, we can see stuff."
    },
    {
      "Time_Start": 1141.0800000000002,
      "Time_End": 1143.52,
      "Text": " And we can see DAT files."
    },
    {
      "Time_Start": 1144.96,
      "Time_End": 1148.44,
      "Text": " So that's stuff to be restored from this backup."
    },
    {
      "Time_Start": 1148.44,
      "Time_End": 1150.5600000000002,
      "Text": " And we can also see that there's metadata."
    },
    {
      "Time_Start": 1152.68,
      "Time_End": 1156.4,
      "Text": " And when I now open the manifest.xml,"
    },
    {
      "Time_Start": 1156.4,
      "Time_End": 1159.2,
      "Text": " I saw that, well, it looks pretty much same."
    },
    {
      "Time_Start": 1159.2,
      "Time_End": 1160.92,
      "Text": " So we have the SP file here."
    },
    {
      "Time_Start": 1161.8400000000001,
      "Time_End": 1164.2,
      "Text": " But I also noticed that there's a file"
    },
    {
      "Time_Start": 1164.2,
      "Time_End": 1167.3600000000001,
      "Text": " called editform.aspx."
    },
    {
      "Time_Start": 1167.3600000000001,
      "Time_End": 1171.92,
      "Text": " Now, ASPX is 20 years old technology also."
    },
    {
      "Time_Start": 1171.92,
      "Time_End": 1174.72,
      "Text": " It's called ActiveServe Pages Extended"
    },
    {
      "Time_Start": 1174.72,
      "Time_End": 1175.88,
      "Text": " or something like that."
    },
    {
      "Time_Start": 1176.8400000000001,
      "Time_End": 1179.68,
      "Text": " Has anybody used that?"
    },
    {
      "Time_Start": 1179.68,
      "Time_End": 1180.96,
      "Text": " Some of you, yeah."
    },
    {
      "Time_Start": 1180.96,
      "Time_End": 1183.1200000000001,
      "Text": " So yeah, so I was like, okay,"
    },
    {
      "Time_Start": 1183.1200000000001,
      "Time_End": 1187.48,
      "Text": " you can actually restore these design elements."
    },
    {
      "Time_Start": 1189.0800000000002,
      "Time_End": 1190.64,
      "Text": " And I was like, okay."
    },
    {
      "Time_Start": 1191.92,
      "Time_End": 1192.96,
      "Text": " Me likey."
    },
    {
      "Time_Start": 1194.44,
      "Time_End": 1198.5600000000002,
      "Text": " And conclusions and hypotheses about this finding"
    },
    {
      "Time_Start": 1198.56,
      "Time_End": 1201.6799999999998,
      "Text": " was that SPMT is actually using"
    },
    {
      "Time_Start": 1201.6799999999998,
      "Time_End": 1204.04,
      "Text": " this granular backup, technically."
    },
    {
      "Time_Start": 1205.0,
      "Time_End": 1208.44,
      "Text": " And it also allows you to import any site content,"
    },
    {
      "Time_Start": 1208.44,
      "Time_End": 1210.32,
      "Text": " including those ASPX files."
    },
    {
      "Time_Start": 1210.32,
      "Time_End": 1212.08,
      "Text": " So that was my hypothesis."
    },
    {
      "Time_Start": 1212.08,
      "Time_End": 1215.08,
      "Text": " And therefore, we can replace design files using this API."
    },
    {
      "Time_Start": 1216.8799999999999,
      "Time_End": 1219.32,
      "Text": " And yeah, and we could actually do that."
    },
    {
      "Time_Start": 1220.28,
      "Time_End": 1223.06,
      "Text": " However, in SharePoint Online,"
    },
    {
      "Time_Start": 1223.06,
      "Time_End": 1225.32,
      "Text": " there's a thing called custom script."
    },
    {
      "Time_Start": 1225.32,
      "Time_End": 1230.32,
      "Text": " So as an admin, you can edit those pages also,"
    },
    {
      "Time_Start": 1230.96,
      "Time_End": 1232.9199999999998,
      "Text": " if you have permission to do that."
    },
    {
      "Time_Start": 1232.9199999999998,
      "Time_End": 1235.8799999999999,
      "Text": " Or you can insert a, what is called,"
    },
    {
      "Time_Start": 1235.8799999999999,
      "Time_End": 1238.36,
      "Text": " script editor web part on a page,"
    },
    {
      "Time_Start": 1238.36,
      "Time_End": 1240.84,
      "Text": " and then you can add script there."
    },
    {
      "Time_Start": 1240.84,
      "Time_End": 1244.86,
      "Text": " However, as it says that those are very bad things"
    },
    {
      "Time_Start": 1244.86,
      "Time_End": 1247.28,
      "Text": " because that script can access everything"
    },
    {
      "Time_Start": 1247.28,
      "Time_End": 1249.4399999999998,
      "Text": " the user who is visiting that site can do."
    },
    {
      "Time_Start": 1250.28,
      "Time_End": 1255.28,
      "Text": " Even beyond the SharePoint or Microsoft Graph integration."
    },
    {
      "Time_Start": 1257.0,
      "Time_End": 1260.24,
      "Text": " And for that reason, it is blocked by default."
    },
    {
      "Time_Start": 1260.24,
      "Time_End": 1263.3,
      "Text": " So you can't add any scripts there."
    },
    {
      "Time_Start": 1264.56,
      "Time_End": 1268.8400000000001,
      "Text": " So tenant level, which means the whole environment,"
    },
    {
      "Time_Start": 1268.8400000000001,
      "Time_End": 1273.28,
      "Text": " it's prevented, and also by each site collection,"
    },
    {
      "Time_Start": 1273.28,
      "Time_End": 1274.28,
      "Text": " it's also prevented."
    },
    {
      "Time_Start": 1275.4,
      "Time_End": 1278.04,
      "Text": " And to turn those on, you need to be global admin,"
    },
    {
      "Time_Start": 1278.8799999999999,
      "Time_End": 1282.08,
      "Text": " which is next to the guard in Microsoft's cloud."
    },
    {
      "Time_Start": 1283.1599999999999,
      "Time_End": 1288.1599999999999,
      "Text": " Okay, so anyway, so if I still would be able"
    },
    {
      "Time_Start": 1288.32,
      "Time_End": 1292.76,
      "Text": " to enter script there, could I do cross-site scripting?"
    },
    {
      "Time_Start": 1292.76,
      "Time_End": 1294.36,
      "Text": " Maybe."
    },
    {
      "Time_Start": 1294.36,
      "Time_End": 1299.36,
      "Text": " So modern browsers really don't allow doing this."
    },
    {
      "Time_Start": 1300.78,
      "Time_End": 1302.76,
      "Text": " So basically it means that, like here,"
    },
    {
      "Time_Start": 1302.76,
      "Time_End": 1306.8999999999999,
      "Text": " so if you are getting a script, like JavaScript file,"
    },
    {
      "Time_Start": 1306.9,
      "Time_End": 1309.8600000000001,
      "Text": " from this address, like SharePoint.com,"
    },
    {
      "Time_Start": 1309.8600000000001,
      "Time_End": 1314.18,
      "Text": " you can only call APIs in the same domain."
    },
    {
      "Time_Start": 1315.38,
      "Time_End": 1318.9,
      "Text": " So you can make calls outside that, like to Outlook.com,"
    },
    {
      "Time_Start": 1318.9,
      "Time_End": 1321.26,
      "Text": " even though that the user would have been locked in"
    },
    {
      "Time_Start": 1321.26,
      "Time_End": 1324.1000000000001,
      "Text": " in another browser session, but no."
    },
    {
      "Time_Start": 1324.1000000000001,
      "Time_End": 1325.6200000000001,
      "Text": " Well, actually, technically you can,"
    },
    {
      "Time_Start": 1325.6200000000001,
      "Time_End": 1328.5400000000002,
      "Text": " but if you do that, there's no session information"
    },
    {
      "Time_Start": 1328.5400000000002,
      "Time_End": 1329.42,
      "Text": " or no cookies or anything,"
    },
    {
      "Time_Start": 1329.42,
      "Time_End": 1331.46,
      "Text": " so they would be anonymous calls."
    },
    {
      "Time_Start": 1332.5400000000002,
      "Time_End": 1335.26,
      "Text": " But I knew that SharePoint, when you are accessing SharePoint"
    },
    {
      "Time_Start": 1335.26,
      "Time_End": 1337.82,
      "Text": " it can access your email, for instance,"
    },
    {
      "Time_Start": 1337.82,
      "Time_End": 1339.58,
      "Text": " and calendar and that kind of stuff."
    },
    {
      "Time_Start": 1339.58,
      "Time_End": 1341.78,
      "Text": " And I was like, how that works then?"
    },
    {
      "Time_Start": 1341.78,
      "Time_End": 1344.7,
      "Text": " Because there's that same origin header"
    },
    {
      "Time_Start": 1344.7,
      "Time_End": 1349.7,
      "Text": " which prevents JavaScript accessing other domains."
    },
    {
      "Time_Start": 1349.86,
      "Time_End": 1353.78,
      "Text": " So it turned out that there's an internal API"
    },
    {
      "Time_Start": 1353.78,
      "Time_End": 1358.02,
      "Text": " in each SharePoint site called sp.oauth.token"
    },
    {
      "Time_Start": 1358.02,
      "Time_End": 1361.94,
      "Text": " slash acquire, where you can get access tokens."
    },
    {
      "Time_Start": 1361.94,
      "Time_End": 1365.02,
      "Text": " But as you can see, it said that you should not"
    },
    {
      "Time_Start": 1365.82,
      "Time_End": 1367.98,
      "Text": " communicate it directly with your solution."
    },
    {
      "Time_Start": 1369.46,
      "Time_End": 1370.86,
      "Text": " But what if I do?"
    },
    {
      "Time_Start": 1373.66,
      "Time_End": 1376.58,
      "Text": " Well, it turned out that you can just ask"
    },
    {
      "Time_Start": 1377.86,
      "Time_End": 1380.9,
      "Text": " access token to any resource which it is supporting,"
    },
    {
      "Time_Start": 1380.9,
      "Time_End": 1381.94,
      "Text": " like here."
    },
    {
      "Time_Start": 1381.94,
      "Time_End": 1384.18,
      "Text": " Can I have a token for graph.microsoft.com?"
    },
    {
      "Time_Start": 1384.18,
      "Time_End": 1385.02,
      "Text": " Yes, you can."
    },
    {
      "Time_Start": 1385.02,
      "Time_End": 1386.22,
      "Text": " Here it is."
    },
    {
      "Time_Start": 1386.22,
      "Time_End": 1389.22,
      "Text": " So that actually allowed me to do,"
    },
    {
      "Time_Start": 1389.22,
      "Time_End": 1390.8799999999999,
      "Text": " well, whatever I wanted to."
    },
    {
      "Time_Start": 1390.8799999999999,
      "Time_End": 1394.68,
      "Text": " Whatever graph API allows users to do."
    },
    {
      "Time_Start": 1395.3400000000001,
      "Time_End": 1399.0,
      "Text": " And if that user who will get this site"
    },
    {
      "Time_Start": 1399.0,
      "Time_End": 1401.8400000000001,
      "Text": " would be like global admin, you own the domain."
    },
    {
      "Time_Start": 1404.02,
      "Time_End": 1408.68,
      "Text": " Okay, well, you own the Azure AD, not the domain, but yes."
    },
    {
      "Time_Start": 1408.68,
      "Time_End": 1413.68,
      "Text": " Okay, but I found out that if you have prevented"
    },
    {
      "Time_Start": 1413.76,
      "Time_End": 1416.28,
      "Text": " using the custom script, you can do that"
    },
    {
      "Time_Start": 1416.28,
      "Time_End": 1419.18,
      "Text": " using SharePoint Online, no SharePoint Designer,"
    },
    {
      "Time_Start": 1419.18,
      "Time_End": 1423.8400000000001,
      "Text": " which is a designer from 10 years ago, but it still works."
    },
    {
      "Time_Start": 1424.96,
      "Time_End": 1427.26,
      "Text": " But with this, you can bypass that."
    },
    {
      "Time_Start": 1427.26,
      "Time_End": 1429.88,
      "Text": " So you can prevent that."
    },
    {
      "Time_Start": 1431.64,
      "Time_End": 1432.76,
      "Text": " And that's also funny."
    },
    {
      "Time_Start": 1437.5600000000002,
      "Time_End": 1441.5600000000002,
      "Text": " Okay, so a little story before the demo."
    },
    {
      "Time_Start": 1441.5600000000002,
      "Time_End": 1446.5600000000002,
      "Text": " So when I was recording demos for this talk,"
    },
    {
      "Time_Start": 1447.92,
      "Time_End": 1450.72,
      "Text": " I noticed that it didn't work anymore."
    },
    {
      "Time_Start": 1450.72,
      "Time_End": 1453.4,
      "Text": " So I had to use, well, I thought that it didn't work,"
    },
    {
      "Time_Start": 1453.4,
      "Time_End": 1456.72,
      "Text": " actually, it did work, but I thought that it didn't."
    },
    {
      "Time_Start": 1456.72,
      "Time_End": 1459.3600000000001,
      "Text": " So I actually had to use a video,"
    },
    {
      "Time_Start": 1459.3600000000001,
      "Time_End": 1463.3200000000002,
      "Text": " which I actually originally sent to MSRC."
    },
    {
      "Time_Start": 1463.3200000000002,
      "Time_End": 1466.7,
      "Text": " So it's very fine print, and there's even me talking,"
    },
    {
      "Time_Start": 1466.7,
      "Time_End": 1470.16,
      "Text": " but I covered myself with the pirate flag,"
    },
    {
      "Time_Start": 1470.16,
      "Time_End": 1472.44,
      "Text": " so you don't see me."
    },
    {
      "Time_Start": 1472.44,
      "Time_End": 1475.68,
      "Text": " But I'm gonna walk you through what happens here."
    },
    {
      "Time_Start": 1475.68,
      "Time_End": 1480.68,
      "Text": " So in this demo, I modify the ASPX file"
    },
    {
      "Time_Start": 1480.72,
      "Time_End": 1484.04,
      "Text": " of Documents folder, and I insert code there,"
    },
    {
      "Time_Start": 1484.04,
      "Time_End": 1487.16,
      "Text": " and what the code does is, well, you'll see."
    },
    {
      "Time_Start": 1487.16,
      "Time_End": 1489.3200000000002,
      "Text": " So let's start."
    },
    {
      "Time_Start": 1489.3200000000002,
      "Time_End": 1491.52,
      "Text": " I hope this demo works now, yes."
    },
    {
      "Time_Start": 1491.52,
      "Time_End": 1496.18,
      "Text": " So on the upper right-hand side, we have the attacker,"
    },
    {
      "Time_Start": 1497.44,
      "Time_End": 1499.64,
      "Text": " who has created a team site,"
    },
    {
      "Time_Start": 1499.64,
      "Time_End": 1501.48,
      "Text": " and his name is Diego Siciliani."
    },
    {
      "Time_Start": 1505.52,
      "Time_End": 1510.52,
      "Text": " And then we have the victim below that."
    },
    {
      "Time_Start": 1511.3200000000002,
      "Time_End": 1513.0800000000002,
      "Text": " And he's Nestor Wilke, or Wilke,"
    },
    {
      "Time_Start": 1513.0800000000002,
      "Time_End": 1515.24,
      "Text": " I don't know how do you pronounce that."
    },
    {
      "Time_Start": 1515.24,
      "Time_End": 1516.96,
      "Text": " Even though I've done this for years,"
    },
    {
      "Time_Start": 1516.96,
      "Time_End": 1519.48,
      "Text": " but I still don't know how to pronounce that name."
    },
    {
      "Time_Start": 1520.8,
      "Time_End": 1525.0800000000002,
      "Text": " But you can pronounce mine, so it's a fair deal."
    },
    {
      "Time_Start": 1525.0800000000002,
      "Time_End": 1525.92,
      "Text": " Okay."
    },
    {
      "Time_Start": 1526.8,
      "Time_End": 1530.5600000000002,
      "Text": " So this is just to show that we are"
    },
    {
      "Time_Start": 1530.5600000000002,
      "Time_End": 1533.2,
      "Text": " at the same team currently."
    },
    {
      "Time_Start": 1533.2,
      "Time_End": 1535.6000000000001,
      "Text": " And now what we need to do is that we first need"
    },
    {
      "Time_Start": 1535.6000000000001,
      "Time_End": 1538.0,
      "Text": " to have the site collection name,"
    },
    {
      "Time_Start": 1538.0,
      "Time_End": 1540.16,
      "Text": " so I'm gonna open this in SharePoint."
    },
    {
      "Time_Start": 1542.72,
      "Time_End": 1545.24,
      "Text": " And now what we're gonna do is that we're gonna replace"
    },
    {
      "Time_Start": 1545.24,
      "Time_End": 1548.32,
      "Text": " that allitems.aspx file."
    },
    {
      "Time_Start": 1552.24,
      "Time_End": 1556.64,
      "Text": " But for that, I need that site name."
    },
    {
      "Time_Start": 1557.88,
      "Time_End": 1559.4,
      "Text": " And that site name is actually quite boring,"
    },
    {
      "Time_Start": 1559.4,
      "Time_End": 1561.2,
      "Text": " it's a very long URL."
    },
    {
      "Time_Start": 1562.08,
      "Time_End": 1564.16,
      "Text": " And then I'm gonna start my tool here."
    },
    {
      "Time_Start": 1565.1200000000001,
      "Time_End": 1568.24,
      "Text": " And first I need to get an access token to use that,"
    },
    {
      "Time_Start": 1568.24,
      "Time_End": 1571.92,
      "Text": " so I'm gonna type there, get paid access token"
    },
    {
      "Time_Start": 1571.92,
      "Time_End": 1573.0,
      "Text": " for that service."
    },
    {
      "Time_Start": 1574.92,
      "Time_End": 1577.72,
      "Text": " Sorry, this is gonna take a little time,"
    },
    {
      "Time_Start": 1577.72,
      "Time_End": 1582.72,
      "Text": " but there's a lot of typos and stuff, but yes."
    },
    {
      "Time_Start": 1584.88,
      "Time_End": 1587.1200000000001,
      "Text": " So it pops up a window where I just need"
    },
    {
      "Time_Start": 1587.1200000000001,
      "Time_End": 1590.1200000000001,
      "Text": " to type my credentials, the attacker's credentials."
    },
    {
      "Time_Start": 1590.1200000000001,
      "Time_End": 1592.0400000000002,
      "Text": " And again, this is just a standard user"
    },
    {
      "Time_Start": 1592.04,
      "Time_End": 1594.36,
      "Text": " who created the team, so no admin rights here."
    },
    {
      "Time_Start": 1608.68,
      "Time_End": 1610.96,
      "Text": " And then we're gonna provide the password."
    },
    {
      "Time_Start": 1610.96,
      "Time_End": 1613.0,
      "Text": " And just for demonstration purposes, there's no MFA,"
    },
    {
      "Time_Start": 1613.0,
      "Time_End": 1614.72,
      "Text": " but you should always enable that."
    },
    {
      "Time_Start": 1615.76,
      "Time_End": 1618.08,
      "Text": " And now we have the access token, and then first thing"
    },
    {
      "Time_Start": 1618.08,
      "Time_End": 1620.44,
      "Text": " what we need to do is to download that file,"
    },
    {
      "Time_Start": 1620.44,
      "Time_End": 1622.4,
      "Text": " that aspx file, and that's also neat"
    },
    {
      "Time_Start": 1622.4,
      "Time_End": 1624.4,
      "Text": " that you can actually download design elements"
    },
    {
      "Time_Start": 1624.4,
      "Time_End": 1626.24,
      "Text": " from SharePoint online."
    },
    {
      "Time_Start": 1626.24,
      "Time_End": 1627.48,
      "Text": " I don't know what's the purpose of that,"
    },
    {
      "Time_Start": 1627.48,
      "Time_End": 1628.52,
      "Text": " but you can do that."
    },
    {
      "Time_Start": 1629.44,
      "Time_End": 1634.44,
      "Text": " So there's a comment for that, we provide the site name."
    },
    {
      "Time_Start": 1635.0,
      "Time_End": 1638.16,
      "Text": " And then, well, you can see under that,"
    },
    {
      "Time_Start": 1638.16,
      "Time_End": 1640.1200000000001,
      "Text": " or behind that, download all our items."
    },
    {
      "Time_Start": 1641.3200000000002,
      "Time_End": 1646.0,
      "Text": " Stuff, but then you're gonna provide the path of that file."
    },
    {
      "Time_Start": 1646.0,
      "Time_End": 1647.96,
      "Text": " So site name, and then the file name"
    },
    {
      "Time_Start": 1647.96,
      "Time_End": 1649.8400000000001,
      "Text": " inside that site collection."
    },
    {
      "Time_Start": 1650.44,
      "Time_End": 1655.44,
      "Text": " And that should do it."
    },
    {
      "Time_Start": 1659.3600000000001,
      "Time_End": 1662.3600000000001,
      "Text": " And now it says that file saved to all items.aspx,"
    },
    {
      "Time_Start": 1662.3600000000001,
      "Time_End": 1665.44,
      "Text": " and then you can open that file in your favorite editor,"
    },
    {
      "Time_Start": 1665.44,
      "Time_End": 1667.2,
      "Text": " and mine is Notepad++."
    },
    {
      "Time_Start": 1669.04,
      "Time_End": 1672.56,
      "Text": " So that's the file, and I just drop it in Notepad."
    },
    {
      "Time_Start": 1673.68,
      "Time_End": 1676.1200000000001,
      "Text": " And here you can see, well, it's a fine print,"
    },
    {
      "Time_Start": 1676.1200000000001,
      "Time_End": 1678.8,
      "Text": " but it's just an aspx file, so it's pretty much"
    },
    {
      "Time_Start": 1678.8,
      "Time_End": 1681.84,
      "Text": " a template file referring other template files, and so on."
    },
    {
      "Time_Start": 1681.84,
      "Time_End": 1686.72,
      "Text": " But I can paste code here, so my attacker code's right here."
    },
    {
      "Time_Start": 1686.72,
      "Time_End": 1689.84,
      "Text": " I'm gonna paste that, save that,"
    },
    {
      "Time_Start": 1689.84,
      "Time_End": 1691.76,
      "Text": " and then I'm gonna send it back."
    },
    {
      "Time_Start": 1693.8,
      "Time_End": 1696.2,
      "Text": " And it's actually interesting that when you download"
    },
    {
      "Time_Start": 1696.2,
      "Time_End": 1697.68,
      "Text": " that file, there will be a log entry,"
    },
    {
      "Time_Start": 1697.68,
      "Time_End": 1699.72,
      "Text": " but when you update that, there's none."
    },
    {
      "Time_Start": 1702.8799999999999,
      "Time_End": 1705.8,
      "Text": " So pretty much same thing, but a different direction."
    },
    {
      "Time_Start": 1705.8,
      "Time_End": 1710.52,
      "Text": " So I need to update aad.spo file."
    },
    {
      "Time_Start": 1715.24,
      "Time_End": 1717.48,
      "Text": " And again, when this starts, it can take anything"
    },
    {
      "Time_Start": 1717.48,
      "Time_End": 1719.72,
      "Text": " from 10 seconds to 10 minutes."
    },
    {
      "Time_Start": 1719.72,
      "Time_End": 1721.8799999999999,
      "Text": " So that's also one thing I don't wanna do this"
    },
    {
      "Time_Start": 1721.8799999999999,
      "Time_End": 1724.68,
      "Text": " like as a live demo, because it might take"
    },
    {
      "Time_Start": 1724.68,
      "Time_End": 1728.76,
      "Text": " an hour or 10 minutes, so it's better this way."
    },
    {
      "Time_Start": 1728.76,
      "Time_End": 1731.1599999999999,
      "Text": " Okay, so now I'll just hit Enter,"
    },
    {
      "Time_Start": 1731.1599999999999,
      "Time_End": 1733.36,
      "Text": " and you can see some stuff going on in there."
    },
    {
      "Time_Start": 1733.3600000000001,
      "Time_End": 1738.0000000000002,
      "Text": " So it sent the files, created the metadata file,"
    },
    {
      "Time_Start": 1738.0000000000002,
      "Time_End": 1741.44,
      "Text": " and then it's gonna start pulling that"
    },
    {
      "Time_Start": 1741.44,
      "Time_End": 1744.2,
      "Text": " when the job is done, and it took like six"
    },
    {
      "Time_Start": 1744.2,
      "Time_End": 1746.7600000000002,
      "Text": " or seven minutes in this case, and now it's there."
    },
    {
      "Time_Start": 1746.7600000000002,
      "Time_End": 1749.48,
      "Text": " And the next thing is that now we need"
    },
    {
      "Time_Start": 1749.48,
      "Time_End": 1751.3600000000001,
      "Text": " to get the victim to visit that site."
    },
    {
      "Time_Start": 1753.8000000000002,
      "Time_End": 1758.8000000000002,
      "Text": " So let's do that, but let's move the attacker window"
    },
    {
      "Time_Start": 1759.5200000000002,
      "Time_End": 1762.1200000000001,
      "Text": " to the left before that, and then I'm gonna open"
    },
    {
      "Time_Start": 1762.1200000000001,
      "Time_End": 1766.0800000000002,
      "Text": " the Outlook tab so that we can see if there's any email."
    },
    {
      "Time_Start": 1768.7600000000002,
      "Time_End": 1773.7600000000002,
      "Text": " Yeah, and now we're gonna choose the other window"
    },
    {
      "Time_Start": 1773.7600000000002,
      "Time_End": 1774.8000000000002,
      "Text": " and emulate that."
    },
    {
      "Time_Start": 1774.8000000000002,
      "Time_End": 1777.92,
      "Text": " Now we have somehow lured the victim to visit our site."
    },
    {
      "Time_Start": 1779.5600000000002,
      "Time_End": 1783.0800000000002,
      "Text": " And actually, my POC, it kind of broke this"
    },
    {
      "Time_Start": 1784.1200000000001,
      "Time_End": 1785.6000000000001,
      "Text": " because it says that you can't read that,"
    },
    {
      "Time_Start": 1785.6000000000001,
      "Time_End": 1787.0800000000002,
      "Text": " but actually you can, you just need"
    },
    {
      "Time_Start": 1787.0800000000002,
      "Time_End": 1789.16,
      "Text": " to type in the correct URL."
    },
    {
      "Time_Start": 1793.1200000000001,
      "Time_End": 1793.96,
      "Text": " Okay."
    },
    {
      "Time_Start": 1796.2800000000002,
      "Time_End": 1797.96,
      "Text": " Like that."
    },
    {
      "Time_Start": 1797.96,
      "Time_End": 1801.8400000000001,
      "Text": " And now when the victim visits the documents,"
    },
    {
      "Time_Start": 1801.8400000000001,
      "Time_End": 1804.8000000000002,
      "Text": " it runs the code, and what the code does,"
    },
    {
      "Time_Start": 1804.8000000000002,
      "Time_End": 1808.8400000000001,
      "Text": " it gets first the access token to Graph API,"
    },
    {
      "Time_Start": 1808.8400000000001,
      "Time_End": 1813.8400000000001,
      "Text": " and then it loops through all the victim's"
    },
    {
      "Time_Start": 1814.0000000000002,
      "Time_End": 1818.3200000000002,
      "Text": " OneDrive documents and shares them with the attacker."
    },
    {
      "Time_Start": 1818.3200000000002,
      "Time_End": 1821.8400000000001,
      "Text": " And now they should be dropping like mails"
    },
    {
      "Time_Start": 1822.5600000000002,
      "Time_End": 1823.96,
      "Text": " in attacker mailbox that, hey, this guy shared"
    },
    {
      "Time_Start": 1823.96,
      "Time_End": 1825.92,
      "Text": " the file with you."
    },
    {
      "Time_Start": 1825.92,
      "Time_End": 1828.2400000000002,
      "Text": " So this way you can get access to pretty much"
    },
    {
      "Time_Start": 1828.2400000000002,
      "Time_End": 1830.3200000000002,
      "Text": " any documentation you want to."
    },
    {
      "Time_Start": 1830.3200000000002,
      "Time_End": 1832.2800000000002,
      "Text": " So everybody who visits that page,"
    },
    {
      "Time_Start": 1832.2800000000002,
      "Time_End": 1834.2,
      "Text": " you can run that code as that user."
    },
    {
      "Time_Start": 1834.2,
      "Time_End": 1835.8400000000001,
      "Text": " So quite neat, right?"
    },
    {
      "Time_Start": 1837.44,
      "Time_End": 1840.64,
      "Text": " And yes, so that was the demo."
    },
    {
      "Time_Start": 1840.64,
      "Time_End": 1843.4,
      "Text": " So you could actually use the same technique"
    },
    {
      "Time_Start": 1843.4,
      "Time_End": 1847.0400000000002,
      "Text": " so that you can run whatever code you want to,"
    },
    {
      "Time_Start": 1847.0400000000002,
      "Time_End": 1850.7600000000002,
      "Text": " and you can also use like Graph API,"
    },
    {
      "Time_Start": 1851.2,
      "Time_End": 1853.08,
      "Text": " so not just the SharePoint."
    },
    {
      "Time_Start": 1854.52,
      "Time_End": 1856.52,
      "Text": " So quite nice, right?"
    },
    {
      "Time_Start": 1856.52,
      "Time_End": 1859.6,
      "Text": " So I reported this to Microsoft,"
    },
    {
      "Time_Start": 1859.6,
      "Time_End": 1863.08,
      "Text": " and just to recap, I reported that you can"
    },
    {
      "Time_Start": 1863.08,
      "Time_End": 1865.12,
      "Text": " spoof documentation or documents,"
    },
    {
      "Time_Start": 1865.12,
      "Time_End": 1868.56,
      "Text": " you can tamper with them, and they were in design."
    },
    {
      "Time_Start": 1868.56,
      "Time_End": 1871.28,
      "Text": " And now when I was reporting this XSS attack,"
    },
    {
      "Time_Start": 1871.28,
      "Time_End": 1873.56,
      "Text": " they said that, okay, that's spoofing."
    },
    {
      "Time_Start": 1874.56,
      "Time_End": 1876.48,
      "Text": " And I was like, what the hell is this?"
    },
    {
      "Time_Start": 1876.48,
      "Time_End": 1878.0,
      "Text": " But we had a discussion with them,"
    },
    {
      "Time_Start": 1878.0,
      "Time_End": 1880.52,
      "Text": " and at that time they were just categorizing"
    },
    {
      "Time_Start": 1881.28,
      "Time_End": 1882.12,
      "Text": " everything like this, spoofing."
    },
    {
      "Time_Start": 1882.12,
      "Time_End": 1883.16,
      "Text": " Now it's a bit different."
    },
    {
      "Time_Start": 1884.0,
      "Time_End": 1884.84,
      "Text": " Okay."
    },
    {
      "Time_Start": 1885.8,
      "Time_End": 1887.08,
      "Text": " Okay, now back to the story."
    },
    {
      "Time_Start": 1887.08,
      "Time_End": 1892.08,
      "Text": " So when I was starting to record demos for this talk,"
    },
    {
      "Time_Start": 1892.44,
      "Time_End": 1894.96,
      "Text": " I noticed that it didn't work anymore."
    },
    {
      "Time_Start": 1894.96,
      "Time_End": 1896.96,
      "Text": " And this is the error I got, so I was not able"
    },
    {
      "Time_Start": 1896.96,
      "Time_End": 1900.4,
      "Text": " to get an access token anymore from that API, I told."
    },
    {
      "Time_Start": 1900.4,
      "Time_End": 1904.56,
      "Text": " That was part of every SharePoint site collection,"
    },
    {
      "Time_Start": 1904.56,
      "Time_End": 1907.12,
      "Text": " and it says that you are missing refresh token."
    },
    {
      "Time_Start": 1907.2,
      "Time_End": 1911.2,
      "Text": " Well, actually, that wasn't the fix at all."
    },
    {
      "Time_Start": 1911.2,
      "Time_End": 1914.2,
      "Text": " So, but anyway, I asked from Microsoft,"
    },
    {
      "Time_Start": 1914.2,
      "Time_End": 1916.68,
      "Text": " what is the status of this fix, so is it already fixed?"
    },
    {
      "Time_Start": 1916.68,
      "Time_End": 1919.88,
      "Text": " Because I saw something that it could be,"
    },
    {
      "Time_Start": 1919.88,
      "Time_End": 1922.4,
      "Text": " and they said, yeah, it's actually fixed."
    },
    {
      "Time_Start": 1922.4,
      "Time_End": 1924.0000000000002,
      "Text": " I was okay, fine."
    },
    {
      "Time_Start": 1925.3200000000002,
      "Time_End": 1928.0000000000002,
      "Text": " But when I was playing around, it turned out that"
    },
    {
      "Time_Start": 1928.0000000000002,
      "Time_End": 1930.8400000000001,
      "Text": " I just had to visit some other SharePoint page"
    },
    {
      "Time_Start": 1930.8400000000001,
      "Time_End": 1933.96,
      "Text": " before going there, and then there was that refresh token."
    },
    {
      "Time_Start": 1933.96,
      "Time_End": 1936.3600000000001,
      "Text": " So this wasn't the fix."
    },
    {
      "Time_Start": 1936.3600000000001,
      "Time_End": 1938.3200000000002,
      "Text": " So two weeks ago, roughly two weeks ago,"
    },
    {
      "Time_Start": 1938.3200000000002,
      "Time_End": 1940.72,
      "Text": " I asked Microsoft that, hey, I have a DEF CON talk,"
    },
    {
      "Time_Start": 1940.72,
      "Time_End": 1943.2800000000002,
      "Text": " and this attack still works, so can you tell me"
    },
    {
      "Time_Start": 1943.2800000000002,
      "Time_End": 1945.48,
      "Text": " what did you fix so that I can tell you guys"
    },
    {
      "Time_Start": 1945.48,
      "Time_End": 1947.68,
      "Text": " what is the real situation?"
    },
    {
      "Time_Start": 1947.68,
      "Time_End": 1951.6000000000001,
      "Text": " And it turned out that they had fixed that,"
    },
    {
      "Time_Start": 1951.6000000000001,
      "Time_End": 1953.2,
      "Text": " but that didn't work."
    },
    {
      "Time_Start": 1954.3200000000002,
      "Time_End": 1957.68,
      "Text": " So last Sunday, I was already here, so yesterday Sunday,"
    },
    {
      "Time_Start": 1957.68,
      "Time_End": 1961.68,
      "Text": " I had a meeting with MSRC, or Microsoft Security"
    },
    {
      "Time_Start": 1961.68,
      "Time_End": 1964.8000000000002,
      "Text": " Response Center, and SharePoint Engineering,"
    },
    {
      "Time_Start": 1964.8,
      "Time_End": 1966.68,
      "Text": " and we walked through what happened,"
    },
    {
      "Time_Start": 1966.68,
      "Time_End": 1969.6399999999999,
      "Text": " and it turned out that, yes, they had fixed that,"
    },
    {
      "Time_Start": 1969.6399999999999,
      "Time_End": 1974.6399999999999,
      "Text": " that you can upload files, and they used that"
    },
    {
      "Time_Start": 1975.36,
      "Time_End": 1977.2,
      "Text": " based on their own specification,"
    },
    {
      "Time_Start": 1977.2,
      "Time_End": 1981.8,
      "Text": " how that XML should be formed, and they never used"
    },
    {
      "Time_Start": 1981.8,
      "Time_End": 1984.76,
      "Text": " my tool to verify that, because my tool only used"
    },
    {
      "Time_Start": 1984.76,
      "Time_End": 1987.84,
      "Text": " minimum amount of any data to get it work,"
    },
    {
      "Time_Start": 1987.84,
      "Time_End": 1991.1599999999999,
      "Text": " so it was missing one attribute, XML attribute,"
    },
    {
      "Time_Start": 1991.1599999999999,
      "Time_End": 1993.1599999999999,
      "Text": " so that bypasses that."
    },
    {
      "Time_Start": 1993.2,
      "Time_End": 1998.2,
      "Text": " So, now I'm very, let's say, proud of Microsoft in this,"
    },
    {
      "Time_Start": 1998.3600000000001,
      "Time_End": 2000.8000000000002,
      "Text": " so they were able to fix that in, like, Tuesday,"
    },
    {
      "Time_Start": 2000.8000000000002,
      "Time_End": 2004.4,
      "Text": " and they enrolled, or deployed that globally in 24 hours,"
    },
    {
      "Time_Start": 2004.4,
      "Time_End": 2006.28,
      "Text": " so now it's fixed, actually."
    },
    {
      "Time_Start": 2006.28,
      "Time_End": 2008.8000000000002,
      "Text": " So now I'm able to release the tool to you"
    },
    {
      "Time_Start": 2008.8000000000002,
      "Time_End": 2011.2,
      "Text": " so that you can play it around."
    },
    {
      "Time_Start": 2011.2,
      "Time_End": 2012.64,
      "Text": " But yes, that was the story."
    },
    {
      "Time_Start": 2012.64,
      "Time_End": 2014.92,
      "Text": " So I found a nice stuff that you can do,"
    },
    {
      "Time_Start": 2014.92,
      "Time_End": 2017.3600000000001,
      "Text": " you can still do that spoofing and tampering with,"
    },
    {
      "Time_Start": 2017.3600000000001,
      "Time_End": 2020.24,
      "Text": " you can't do these XSS attacks anymore,"
    },
    {
      "Time_Start": 2020.24,
      "Time_End": 2022.76,
      "Text": " but you never know, now that you have the tools,"
    },
    {
      "Time_Start": 2023.4,
      "Time_End": 2024.56,
      "Text": " maybe some other research to find another way"
    },
    {
      "Time_Start": 2024.56,
      "Time_End": 2026.32,
      "Text": " to do something with that."
    },
    {
      "Time_Start": 2027.6,
      "Time_End": 2030.36,
      "Text": " But so, with that, thank you."
    },
    {
      "Time_Start": 2030.36,
      "Time_End": 2035.36,
      "Text": " And now, if there's any questions, I have plenty of time."
    },
    {
      "Time_Start": 2044.56,
      "Time_End": 2046.44,
      "Text": " Do we have any mics to go?"
    },
    {
      "Time_Start": 2046.44,
      "Time_End": 2048.04,
      "Text": " Yeah, okay."
    },
    {
      "Time_Start": 2048.04,
      "Time_End": 2049.96,
      "Text": " Okay, so there are mics on the aisles,"
    },
    {
      "Time_Start": 2049.96,
      "Time_End": 2052.2,
      "Text": " so if you have any questions, feel free to ask,"
    },
    {
      "Time_Start": 2052.2,
      "Time_End": 2054.68,
      "Text": " and otherwise I'll be hanging around, so."
    }
  ]
}