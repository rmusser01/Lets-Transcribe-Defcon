{
  "segments": [
    {
      "Time_Start": 0.0,
      "Time_End": 2.36,
      "Text": "This text was transcribed using whisper model: large-v2\n\n So hey, everyone."
    },
    {
      "Time_Start": 2.36,
      "Time_End": 4.64,
      "Text": " I'm very excited to be here."
    },
    {
      "Time_Start": 4.64,
      "Time_End": 8.32,
      "Text": " And for this talk, I hope you have nerves of steel,"
    },
    {
      "Time_Start": 8.32,
      "Time_End": 12.96,
      "Text": " because today's story is a ghost story."
    },
    {
      "Time_Start": 12.96,
      "Time_End": 15.68,
      "Text": " OK, so this story is not your average ghost story."
    },
    {
      "Time_Start": 15.68,
      "Time_End": 19.6,
      "Text": " It's not about a haunted house or a deserted mental hospital."
    },
    {
      "Time_Start": 19.6,
      "Time_End": 22.28,
      "Text": " This one is scary for hackers specifically."
    },
    {
      "Time_Start": 22.28,
      "Time_End": 26.84,
      "Text": " It's about apps having invisible access to your Google account."
    },
    {
      "Time_Start": 26.84,
      "Time_End": 30.88,
      "Text": " So it all started a bit over a year ago in June 2022."
    },
    {
      "Time_Start": 30.88,
      "Time_End": 34.28,
      "Text": " And while I was playing around with Google apps,"
    },
    {
      "Time_Start": 34.28,
      "Time_End": 36.480000000000004,
      "Text": " I discovered the Ghost Token vulnerability,"
    },
    {
      "Time_Start": 36.480000000000004,
      "Time_End": 38.68,
      "Text": " which basically allows attackers to create"
    },
    {
      "Time_Start": 38.68,
      "Time_End": 41.2,
      "Text": " apps that are invisible while still having access"
    },
    {
      "Time_Start": 41.2,
      "Time_End": 43.2,
      "Text": " to your Google account."
    },
    {
      "Time_Start": 43.2,
      "Time_End": 45.36,
      "Text": " And this vulnerability is pretty unique."
    },
    {
      "Time_Start": 45.36,
      "Time_End": 47.74,
      "Text": " It's not an XSS or a CSRF."
    },
    {
      "Time_Start": 47.74,
      "Time_End": 51.0,
      "Text": " And it doesn't even fall into any of the cloud vulnerability"
    },
    {
      "Time_Start": 51.0,
      "Time_End": 52.68,
      "Text": " categories either."
    },
    {
      "Time_Start": 52.68,
      "Time_End": 55.08,
      "Text": " And I think it makes it especially interesting"
    },
    {
      "Time_Start": 55.08,
      "Time_End": 57.879999999999995,
      "Text": " to understand why the vulnerability happened."
    },
    {
      "Time_Start": 57.879999999999995,
      "Time_End": 60.08,
      "Text": " And I think that we have a lot to learn from it,"
    },
    {
      "Time_Start": 60.08,
      "Time_End": 61.879999999999995,
      "Text": " looking into the future, which is something"
    },
    {
      "Time_Start": 61.879999999999995,
      "Time_End": 65.24,
      "Text": " that we'll explore at the end of the story."
    },
    {
      "Time_Start": 65.24,
      "Time_End": 68.03999999999999,
      "Text": " So before we begin, a little bit about myself."
    },
    {
      "Time_Start": 68.03999999999999,
      "Time_End": 69.2,
      "Text": " So my name is Tal."
    },
    {
      "Time_Start": 69.2,
      "Time_End": 71.4,
      "Text": " And in the past decade, I was involved"
    },
    {
      "Time_Start": 71.4,
      "Time_End": 73.52,
      "Text": " in hacking in all sorts of ways."
    },
    {
      "Time_Start": 73.52,
      "Time_End": 76.52,
      "Text": " In my previous job, I hacked vehicle computers"
    },
    {
      "Time_Start": 76.52,
      "Time_End": 78.8,
      "Text": " on a daily basis."
    },
    {
      "Time_Start": 78.8,
      "Time_End": 81.48,
      "Text": " In 2016, maybe it's finally time to confess that,"
    },
    {
      "Time_Start": 81.48,
      "Time_End": 84.4,
      "Text": " I was part of the team that broke Pokemon's Go"
    },
    {
      "Time_Start": 84.44000000000001,
      "Time_End": 85.92,
      "Text": " anti-cheating system."
    },
    {
      "Time_Start": 85.92,
      "Time_End": 87.76,
      "Text": " And I also have a master's degree"
    },
    {
      "Time_Start": 87.76,
      "Time_End": 89.88000000000001,
      "Text": " in theoretical computer science."
    },
    {
      "Time_Start": 89.88000000000001,
      "Time_End": 93.16000000000001,
      "Text": " And right now, I work as a senior security researcher"
    },
    {
      "Time_Start": 93.16000000000001,
      "Time_End": 96.12,
      "Text": " and a team lead at Asterix Security,"
    },
    {
      "Time_Start": 96.12,
      "Time_End": 99.22,
      "Text": " where among other things, I look at how different providers"
    },
    {
      "Time_Start": 99.22,
      "Time_End": 103.92,
      "Text": " implement machine-to-machine and non-human identities"
    },
    {
      "Time_Start": 103.92,
      "Time_End": 106.24000000000001,
      "Text": " authorization between each other."
    },
    {
      "Time_Start": 106.24000000000001,
      "Time_End": 107.56,
      "Text": " And these are my socials."
    },
    {
      "Time_Start": 107.56,
      "Time_End": 108.72,
      "Text": " Feel free to contact me."
    },
    {
      "Time_Start": 108.72,
      "Time_End": 111.2,
      "Text": " I will be happy to talk about anything"
    },
    {
      "Time_Start": 111.2,
      "Time_End": 112.80000000000001,
      "Text": " that I did in this talk."
    },
    {
      "Time_Start": 112.8,
      "Time_End": 115.56,
      "Text": " And you can also approach me after the talk."
    },
    {
      "Time_Start": 115.56,
      "Time_End": 119.36,
      "Text": " OK, so we're finally ready to start our story."
    },
    {
      "Time_Start": 119.36,
      "Time_End": 121.6,
      "Text": " The Go Stock and Vulnerability is"
    },
    {
      "Time_Start": 121.6,
      "Time_End": 124.28,
      "Text": " related to how Google designed and implemented"
    },
    {
      "Time_Start": 124.28,
      "Time_End": 127.52,
      "Text": " an authorization framework named OAuth."
    },
    {
      "Time_Start": 127.52,
      "Time_End": 130.4,
      "Text": " First, then, we need to understand what is OAuth,"
    },
    {
      "Time_Start": 130.4,
      "Time_End": 132.56,
      "Text": " why it's needed, and how it works."
    },
    {
      "Time_Start": 132.56,
      "Time_End": 137.28,
      "Text": " So let me start by going into the past, the year of 2007,"
    },
    {
      "Time_Start": 137.28,
      "Time_End": 138.92,
      "Text": " before OAuth existed."
    },
    {
      "Time_Start": 138.92,
      "Time_End": 141.84,
      "Text": " And the first iPhone was just released, as you can see here."
    },
    {
      "Time_Start": 141.84,
      "Time_End": 143.12,
      "Text": " And everyone wanted one."
    },
    {
      "Time_Start": 143.12,
      "Time_End": 146.08,
      "Text": " And whoever had one probably went and posted about it"
    },
    {
      "Time_Start": 146.08,
      "Time_End": 147.68,
      "Text": " on Facebook."
    },
    {
      "Time_Start": 147.68,
      "Time_End": 150.28,
      "Text": " So enter a developer named Anne."
    },
    {
      "Time_Start": 150.28,
      "Time_End": 152.12,
      "Text": " And Anne has a brilliant idea."
    },
    {
      "Time_Start": 152.12,
      "Time_End": 155.84,
      "Text": " She will create an app in which she will scan your email"
    },
    {
      "Time_Start": 155.84,
      "Time_End": 158.36,
      "Text": " contacts and look for them on Facebook"
    },
    {
      "Time_Start": 158.36,
      "Time_End": 160.4,
      "Text": " so you can connect to each other and brag"
    },
    {
      "Time_Start": 160.4,
      "Time_End": 162.0,
      "Text": " about having an iPhone."
    },
    {
      "Time_Start": 162.0,
      "Time_End": 163.32,
      "Text": " So she does create an app."
    },
    {
      "Time_Start": 163.32,
      "Time_End": 167.2,
      "Text": " You give this app your email address and your password,"
    },
    {
      "Time_Start": 167.2,
      "Time_End": 168.84,
      "Text": " and it will scan your contacts."
    },
    {
      "Time_Start": 168.84,
      "Time_End": 170.64000000000001,
      "Text": " Great."
    },
    {
      "Time_Start": 171.32000000000002,
      "Time_End": 172.12,
      "Text": " What?"
    },
    {
      "Time_Start": 172.12,
      "Time_End": 175.84,
      "Text": " So actually, this is how the world looked like without OAuth."
    },
    {
      "Time_Start": 175.84,
      "Time_End": 177.96,
      "Text": " If you wanted to use any third-party application"
    },
    {
      "Time_Start": 177.96,
      "Time_End": 180.16000000000003,
      "Text": " and give it access to your Google account,"
    },
    {
      "Time_Start": 180.16000000000003,
      "Time_End": 182.44000000000003,
      "Text": " you actually needed to give it your email address"
    },
    {
      "Time_Start": 182.44000000000003,
      "Time_End": 184.8,
      "Text": " and your password."
    },
    {
      "Time_Start": 184.8,
      "Time_End": 186.84,
      "Text": " And I guess we were fine with it."
    },
    {
      "Time_Start": 186.84,
      "Time_End": 188.88000000000002,
      "Text": " And today, I guess it's pretty clear to you"
    },
    {
      "Time_Start": 188.88000000000002,
      "Time_End": 190.60000000000002,
      "Text": " why it's not very good."
    },
    {
      "Time_Start": 190.60000000000002,
      "Time_End": 192.68,
      "Text": " But let me state the glaring issues."
    },
    {
      "Time_Start": 192.68,
      "Time_End": 195.16000000000003,
      "Text": " So the first one is, while the app only"
    },
    {
      "Time_Start": 195.16000000000003,
      "Time_End": 198.72000000000003,
      "Text": " needed partial access to your account, for instance,"
    },
    {
      "Time_Start": 198.76,
      "Time_End": 201.8,
      "Text": " in Anne's case, it only needed access to your contact,"
    },
    {
      "Time_Start": 201.8,
      "Time_End": 204.48,
      "Text": " it actually got full access to your Google account."
    },
    {
      "Time_Start": 204.48,
      "Time_End": 206.96,
      "Text": " Second problem is, if you wanted to remove access"
    },
    {
      "Time_Start": 206.96,
      "Time_End": 208.56,
      "Text": " to this account after you used it,"
    },
    {
      "Time_Start": 208.56,
      "Time_End": 209.68,
      "Text": " you needed to change your password."
    },
    {
      "Time_Start": 209.68,
      "Time_End": 211.56,
      "Text": " This was the only way you can get rid of it."
    },
    {
      "Time_Start": 211.56,
      "Time_End": 213.64,
      "Text": " But then, all other apps you give an access to"
    },
    {
      "Time_Start": 213.64,
      "Time_End": 215.84,
      "Text": " also lose access."
    },
    {
      "Time_Start": 215.84,
      "Time_End": 219.12,
      "Text": " The third point is, most people, and especially back then,"
    },
    {
      "Time_Start": 219.12,
      "Time_End": 222.0,
      "Text": " probably used the same password for their online banking"
    },
    {
      "Time_Start": 222.0,
      "Time_End": 222.76,
      "Text": " accounts."
    },
    {
      "Time_Start": 222.76,
      "Time_End": 225.0,
      "Text": " So you don't want to go around and give your password"
    },
    {
      "Time_Start": 225.0,
      "Time_End": 227.0,
      "Text": " to anyone."
    },
    {
      "Time_Start": 227.0,
      "Time_End": 228.76,
      "Text": " And this is where OAuth comes in."
    },
    {
      "Time_Start": 228.76,
      "Time_End": 231.36,
      "Text": " And in fact, the problem was identified in 2006."
    },
    {
      "Time_Start": 231.36,
      "Time_End": 233.76,
      "Text": " And a working group that was created to solve it"
    },
    {
      "Time_Start": 233.76,
      "Time_End": 236.4,
      "Text": " released a final draft of the open authorization,"
    },
    {
      "Time_Start": 236.4,
      "Time_End": 237.64,
      "Text": " which it shortened to OAuth."
    },
    {
      "Time_Start": 237.64,
      "Time_End": 240.72,
      "Text": " I'm just going to call it OAuth from now on."
    },
    {
      "Time_Start": 240.72,
      "Time_End": 243.24,
      "Text": " And three years later, it was released as an RFC,"
    },
    {
      "Time_Start": 243.24,
      "Time_End": 245.48,
      "Text": " the first version of OAuth."
    },
    {
      "Time_Start": 245.48,
      "Time_End": 249.8,
      "Text": " And in the very nice analogy of one of OAuth co-creators,"
    },
    {
      "Time_Start": 249.8,
      "Time_End": 255.16,
      "Text": " Ron Hammer, gives a brief outline of how OAuth works."
    },
    {
      "Time_Start": 255.24,
      "Time_End": 259.08,
      "Text": " So luxury cars today come with a special valet key."
    },
    {
      "Time_Start": 259.08,
      "Time_End": 262.52,
      "Text": " It's a special key that will not allow whoever has it"
    },
    {
      "Time_Start": 262.52,
      "Time_End": 264.96,
      "Text": " to drive more than a few miles."
    },
    {
      "Time_Start": 264.96,
      "Time_End": 267.04,
      "Text": " Some valet key will not open the trunk."
    },
    {
      "Time_Start": 267.04,
      "Time_End": 270.56,
      "Text": " Others will block access to your on-board cell phone address."
    },
    {
      "Time_Start": 270.56,
      "Time_End": 272.2,
      "Text": " And the idea here is very clever."
    },
    {
      "Time_Start": 272.2,
      "Time_End": 275.28,
      "Text": " So you give someone a special key"
    },
    {
      "Time_Start": 275.28,
      "Time_End": 278.56,
      "Text": " with limited access to your car, while using a regular key"
    },
    {
      "Time_Start": 278.56,
      "Time_End": 280.6,
      "Text": " to use everything, to unlock everything."
    },
    {
      "Time_Start": 280.6,
      "Time_End": 286.76000000000005,
      "Text": " And this idea translates almost directly to OAuth."
    },
    {
      "Time_Start": 286.76000000000005,
      "Time_End": 289.56,
      "Text": " Actually, two years after the first version,"
    },
    {
      "Time_Start": 289.56,
      "Time_End": 293.16,
      "Text": " the second version of OAuth was released as an RFC,"
    },
    {
      "Time_Start": 293.16,
      "Time_End": 295.20000000000005,
      "Text": " greatly extending the use cases of OAuth"
    },
    {
      "Time_Start": 295.20000000000005,
      "Time_End": 299.32000000000005,
      "Text": " and simplifying the protocol inside of it."
    },
    {
      "Time_Start": 299.32000000000005,
      "Time_End": 301.68,
      "Text": " And as you notice, I highlighted that they decided"
    },
    {
      "Time_Start": 301.68,
      "Time_End": 303.36,
      "Text": " to call it the OAuth framework."
    },
    {
      "Time_Start": 303.36,
      "Time_End": 306.72,
      "Text": " So as opposed to other maybe protocols or standard,"
    },
    {
      "Time_Start": 306.72,
      "Time_End": 311.20000000000005,
      "Text": " OAuth 2.0 lays out the basic foundation"
    },
    {
      "Time_Start": 311.20000000000005,
      "Time_End": 313.6,
      "Text": " of how the protocol works."
    },
    {
      "Time_Start": 313.6,
      "Time_End": 317.68,
      "Text": " But it leaves a lot of places for the implementers of OAuth"
    },
    {
      "Time_Start": 317.68,
      "Time_End": 319.16,
      "Text": " to decide how to do."
    },
    {
      "Time_Start": 319.16,
      "Time_End": 321.88000000000005,
      "Text": " And this, you'll see in a few slides,"
    },
    {
      "Time_Start": 321.88000000000005,
      "Time_End": 325.04,
      "Text": " was one of the main reasons that the ghost token vulnerability"
    },
    {
      "Time_Start": 325.04,
      "Time_End": 327.40000000000003,
      "Text": " existed in the first place."
    },
    {
      "Time_Start": 327.40000000000003,
      "Time_End": 330.08000000000004,
      "Text": " Now it's an excellent time to go back to the present."
    },
    {
      "Time_Start": 330.08000000000004,
      "Time_End": 332.92,
      "Text": " And today, let me tell you that OAuth is everywhere."
    },
    {
      "Time_Start": 332.92,
      "Time_End": 335.28000000000003,
      "Text": " Every time you see an app, a machine-to-machine"
    },
    {
      "Time_Start": 335.32000000000005,
      "Time_End": 337.56,
      "Text": " authorization, anything related to authorization"
    },
    {
      "Time_Start": 337.56,
      "Time_End": 340.96000000000004,
      "Text": " without using a password, it is done based on OAuth 2.0."
    },
    {
      "Time_Start": 340.96000000000004,
      "Time_End": 343.88000000000005,
      "Text": " You also have public marketplaces"
    },
    {
      "Time_Start": 343.88000000000005,
      "Time_End": 348.04,
      "Text": " offering millions of apps used by millions of people."
    },
    {
      "Time_Start": 348.04,
      "Time_End": 350.6,
      "Text": " Here you can see Slack, Google, and Microsoft"
    },
    {
      "Time_Start": 350.6,
      "Time_End": 353.04,
      "Text": " public marketplaces."
    },
    {
      "Time_Start": 353.04,
      "Time_End": 356.68,
      "Text": " OK, so now we know why we needed OAuth and how it's used."
    },
    {
      "Time_Start": 356.68,
      "Time_End": 358.92,
      "Text": " But let's see how it works."
    },
    {
      "Time_Start": 358.92,
      "Time_End": 360.64000000000004,
      "Text": " So this is how the framework looks"
    },
    {
      "Time_Start": 360.64000000000004,
      "Time_End": 362.72,
      "Text": " like in a very simplified view."
    },
    {
      "Time_Start": 362.72,
      "Time_End": 366.06,
      "Text": " We have Anne, who hasn't aged a day since 2007."
    },
    {
      "Time_Start": 366.06,
      "Time_End": 368.88000000000005,
      "Text": " And now she wants to use OAuth to create her app."
    },
    {
      "Time_Start": 368.88000000000005,
      "Time_End": 372.68,
      "Text": " So the first thing she does is approach Google and register"
    },
    {
      "Time_Start": 372.68,
      "Time_End": 373.56,
      "Text": " her app."
    },
    {
      "Time_Start": 373.56,
      "Time_End": 376.04,
      "Text": " And Google, in return, gives Anne"
    },
    {
      "Time_Start": 376.04,
      "Time_End": 379.0,
      "Text": " two values, a unique identifier called the client ID, which"
    },
    {
      "Time_Start": 379.0,
      "Time_End": 382.36,
      "Text": " identifies her app, and a second secret value."
    },
    {
      "Time_Start": 382.36,
      "Time_End": 384.96000000000004,
      "Text": " Now, sometimes later, a user named Vikram"
    },
    {
      "Time_Start": 384.96000000000004,
      "Time_End": 386.6,
      "Text": " wants to use Anne's app."
    },
    {
      "Time_Start": 386.6,
      "Time_End": 390.36,
      "Text": " So Anne sends Vikram to Google alongside the client ID"
    },
    {
      "Time_Start": 390.36,
      "Time_End": 393.0,
      "Text": " identifying her app and a list of permissions"
    },
    {
      "Time_Start": 393.0,
      "Time_End": 395.04,
      "Text": " that the app needs to operate."
    },
    {
      "Time_Start": 395.04,
      "Time_End": 397.84000000000003,
      "Text": " Google, in response, shows Vikram"
    },
    {
      "Time_Start": 397.84000000000003,
      "Time_End": 399.24,
      "Text": " what's called a consent page."
    },
    {
      "Time_Start": 399.24,
      "Time_End": 401.56,
      "Text": " It's a page where Vikram can see the name of the app,"
    },
    {
      "Time_Start": 401.56,
      "Time_End": 403.96000000000004,
      "Text": " in this case, Example App, and the list of permissions"
    },
    {
      "Time_Start": 403.96000000000004,
      "Time_End": 405.92,
      "Text": " that it needs to operate."
    },
    {
      "Time_Start": 405.92,
      "Time_End": 409.0,
      "Text": " And Vikram has the ability to either consent"
    },
    {
      "Time_Start": 409.0,
      "Time_End": 410.8,
      "Text": " to this authorization or not."
    },
    {
      "Time_Start": 410.8,
      "Time_End": 412.76,
      "Text": " Let's say that Vikram wants to use the app,"
    },
    {
      "Time_Start": 412.76,
      "Time_End": 417.16,
      "Text": " and he consents to this app."
    },
    {
      "Time_Start": 417.16,
      "Time_End": 420.76000000000005,
      "Text": " Then what happens is Google generates a one-time code"
    },
    {
      "Time_Start": 420.76000000000005,
      "Time_End": 424.28000000000003,
      "Text": " and sends it through Vikram to Anne."
    },
    {
      "Time_Start": 424.28000000000003,
      "Time_End": 427.12,
      "Text": " As a final step, Anne takes this one-time code generated"
    },
    {
      "Time_Start": 427.12,
      "Time_End": 430.68,
      "Text": " by Google and the secret value she got in the first step,"
    },
    {
      "Time_Start": 430.68,
      "Time_End": 434.44000000000005,
      "Text": " approaches Google, exchanges these two values for a token."
    },
    {
      "Time_Start": 434.44000000000005,
      "Time_End": 437.28000000000003,
      "Text": " And this token is used to access Vikram's data."
    },
    {
      "Time_Start": 437.28000000000003,
      "Time_End": 441.0,
      "Text": " So what happens is that Anne holds a special token"
    },
    {
      "Time_Start": 441.0,
      "Time_End": 443.56,
      "Text": " with a limited permission to Vikram's account."
    },
    {
      "Time_Start": 443.56,
      "Time_End": 445.6,
      "Text": " In this case, you only ask for the email address."
    },
    {
      "Time_Start": 445.6,
      "Time_End": 448.6,
      "Text": " So this token has only access to this."
    },
    {
      "Time_Start": 448.6,
      "Time_End": 456.32000000000005,
      "Text": " OK, so this is how OAuth is laid out in the framework."
    },
    {
      "Time_Start": 456.32000000000005,
      "Time_End": 458.32000000000005,
      "Text": " However, I'm actually going to focus not"
    },
    {
      "Time_Start": 458.32000000000005,
      "Time_End": 460.24,
      "Text": " on this part of OAuth, but actually"
    },
    {
      "Time_Start": 460.24,
      "Time_End": 462.16,
      "Text": " the things that were unsaid."
    },
    {
      "Time_Start": 462.16,
      "Time_End": 465.24,
      "Text": " So I'm going to call it the OAuth missing pieces."
    },
    {
      "Time_Start": 465.24,
      "Time_End": 468.28000000000003,
      "Text": " There are two missing pieces that were basically"
    },
    {
      "Time_Start": 468.28000000000003,
      "Time_End": 471.36,
      "Text": " kind of the source of the ghost token vulnerability."
    },
    {
      "Time_Start": 471.36,
      "Time_End": 473.64000000000004,
      "Text": " The first one, I glanced over it very quickly,"
    },
    {
      "Time_Start": 473.64000000000004,
      "Time_End": 475.44,
      "Text": " but it's the process of arbitration."
    },
    {
      "Time_Start": 476.28,
      "Time_End": 478.71999999999997,
      "Text": " So I just said, Anne goes to Google, she registers an app,"
    },
    {
      "Time_Start": 478.71999999999997,
      "Time_End": 480.0,
      "Text": " and everyone is happy."
    },
    {
      "Time_Start": 480.0,
      "Time_End": 484.16,
      "Text": " But in fact, this is how it is laid out in the RFC itself."
    },
    {
      "Time_Start": 484.16,
      "Time_End": 486.36,
      "Text": " So besides two technical things that Anne"
    },
    {
      "Time_Start": 486.36,
      "Time_End": 490.28,
      "Text": " needs to provide Google, then the last thing,"
    },
    {
      "Time_Start": 490.28,
      "Time_End": 492.08,
      "Text": " which is I think the most important thing,"
    },
    {
      "Time_Start": 492.08,
      "Time_End": 495.84,
      "Text": " like information about Anne and her app,"
    },
    {
      "Time_Start": 495.84,
      "Time_End": 497.36,
      "Text": " is actually completely up to Google"
    },
    {
      "Time_Start": 497.36,
      "Time_End": 498.56,
      "Text": " to decide how to implement."
    },
    {
      "Time_Start": 498.56,
      "Time_End": 501.24,
      "Text": " So the framework really doesn't deal with all of that."
    },
    {
      "Time_Start": 501.24,
      "Time_End": 503.24,
      "Text": " And there are many questions where there's still"
    },
    {
      "Time_Start": 503.24,
      "Time_End": 503.88,
      "Text": " an answer here."
    },
    {
      "Time_Start": 504.64,
      "Time_End": 506.96,
      "Text": " Exactly what information is required for Anne"
    },
    {
      "Time_Start": 506.96,
      "Time_End": 509.36,
      "Text": " to provide when she registers her app?"
    },
    {
      "Time_Start": 509.36,
      "Time_End": 513.08,
      "Text": " And maybe more importantly, what part of this information"
    },
    {
      "Time_Start": 513.08,
      "Time_End": 517.28,
      "Text": " is verified and showed to Vikram when Vikram comes and wants"
    },
    {
      "Time_Start": 517.28,
      "Time_End": 520.0,
      "Text": " to authorize this app?"
    },
    {
      "Time_Start": 520.0,
      "Time_End": 522.72,
      "Text": " The second missing piece is the part"
    },
    {
      "Time_Start": 522.72,
      "Time_End": 526.64,
      "Text": " of what I call the user's app management feature."
    },
    {
      "Time_Start": 526.64,
      "Time_End": 528.96,
      "Text": " And you notice there's nothing from the RFC here,"
    },
    {
      "Time_Start": 528.96,
      "Time_End": 532.16,
      "Text": " because the RFC doesn't talk about it at all."
    },
    {
      "Time_Start": 532.16,
      "Time_End": 536.04,
      "Text": " So let's say Vikram installs 10 different apps."
    },
    {
      "Time_Start": 536.04,
      "Time_End": 538.48,
      "Text": " Now Vikram wants to see a list of his apps,"
    },
    {
      "Time_Start": 538.48,
      "Time_End": 541.24,
      "Text": " what permission they got, and maybe remove their access."
    },
    {
      "Time_Start": 541.24,
      "Time_End": 544.9599999999999,
      "Text": " So the RFC doesn't really mind all of that"
    },
    {
      "Time_Start": 544.9599999999999,
      "Time_End": 549.7199999999999,
      "Text": " and doesn't say if this thing must be implemented."
    },
    {
      "Time_Start": 549.7199999999999,
      "Time_End": 554.04,
      "Text": " And even most providers today do give this management feature."
    },
    {
      "Time_Start": 554.04,
      "Time_End": 558.48,
      "Text": " And you have a list of apps where you can decide to remove."
    },
    {
      "Time_Start": 558.48,
      "Time_End": 560.4,
      "Text": " But there's still questions here,"
    },
    {
      "Time_Start": 560.4,
      "Time_End": 562.92,
      "Text": " like what information is displayed?"
    },
    {
      "Time_Start": 562.92,
      "Time_End": 565.52,
      "Text": " Can I see the last time the app accessed my data?"
    },
    {
      "Time_Start": 565.52,
      "Time_End": 567.24,
      "Text": " Which data was accessed?"
    },
    {
      "Time_Start": 567.24,
      "Time_End": 569.6,
      "Text": " And indeed, both of these questions"
    },
    {
      "Time_Start": 569.6,
      "Time_End": 571.6,
      "Text": " and all the questions about the app registration"
    },
    {
      "Time_Start": 571.6,
      "Time_End": 573.8,
      "Text": " basically go unanswered in the RFC,"
    },
    {
      "Time_Start": 573.8,
      "Time_End": 576.36,
      "Text": " leading to different providers implementing them"
    },
    {
      "Time_Start": 576.36,
      "Time_End": 577.3199999999999,
      "Text": " very differently."
    },
    {
      "Time_Start": 577.3199999999999,
      "Time_End": 580.0799999999999,
      "Text": " There's a big gap in how each provider implemented"
    },
    {
      "Time_Start": 580.0799999999999,
      "Time_End": 581.16,
      "Text": " these things."
    },
    {
      "Time_Start": 581.16,
      "Time_End": 583.68,
      "Text": " And for our case, for the ghost token vulnerability,"
    },
    {
      "Time_Start": 583.68,
      "Time_End": 587.1999999999999,
      "Text": " let's look at how Google decided to implement them."
    },
    {
      "Time_Start": 587.1999999999999,
      "Time_End": 589.56,
      "Text": " So for the app registration process,"
    },
    {
      "Time_Start": 589.5600000000001,
      "Time_End": 590.84,
      "Text": " it used to be very simple."
    },
    {
      "Time_Start": 590.84,
      "Time_End": 593.5200000000001,
      "Text": " You just go to Google, say, hi, hello, my name is Tal."
    },
    {
      "Time_Start": 593.5200000000001,
      "Time_End": 594.6400000000001,
      "Text": " I want to register an app."
    },
    {
      "Time_Start": 594.6400000000001,
      "Time_End": 596.6800000000001,
      "Text": " And you get the client ID and secret you needed."
    },
    {
      "Time_Start": 596.6800000000001,
      "Time_End": 597.84,
      "Text": " Everyone was happy."
    },
    {
      "Time_Start": 597.84,
      "Time_End": 600.6,
      "Text": " But about six years ago, Google made a move"
    },
    {
      "Time_Start": 600.6,
      "Time_End": 604.8000000000001,
      "Text": " in which they made app being contained inside Google Cloud"
    },
    {
      "Time_Start": 604.8000000000001,
      "Time_End": 606.48,
      "Text": " Platform project."
    },
    {
      "Time_Start": 606.48,
      "Time_End": 609.96,
      "Text": " So as a developer that wants to use to make a new app,"
    },
    {
      "Time_Start": 609.96,
      "Time_End": 611.7600000000001,
      "Text": " the first thing you actually need to do"
    },
    {
      "Time_Start": 611.7600000000001,
      "Time_End": 614.84,
      "Text": " is register for Google Cloud Platform, GCP,"
    },
    {
      "Time_Start": 614.84,
      "Time_End": 616.9000000000001,
      "Text": " and then create a GCP project."
    },
    {
      "Time_Start": 616.9,
      "Time_End": 620.18,
      "Text": " Once you have a GCP project, inside this project,"
    },
    {
      "Time_Start": 620.18,
      "Time_End": 621.9399999999999,
      "Text": " you can set up your consent screen, which"
    },
    {
      "Time_Start": 621.9399999999999,
      "Time_End": 623.86,
      "Text": " means providing some values, most of them"
    },
    {
      "Time_Start": 623.86,
      "Time_End": 626.5799999999999,
      "Text": " are optional, about your app."
    },
    {
      "Time_Start": 626.5799999999999,
      "Time_End": 629.42,
      "Text": " And then, only then, you can get your client ID and secret"
    },
    {
      "Time_Start": 629.42,
      "Time_End": 631.38,
      "Text": " that you needed."
    },
    {
      "Time_Start": 631.38,
      "Time_End": 635.14,
      "Text": " So I mean, my guess is basically maybe Google"
    },
    {
      "Time_Start": 635.14,
      "Time_End": 637.3,
      "Text": " made this move in order to sway developers"
    },
    {
      "Time_Start": 637.3,
      "Time_End": 639.78,
      "Text": " into using one of the services contained inside GCP"
    },
    {
      "Time_Start": 639.78,
      "Time_End": 641.9399999999999,
      "Text": " because they're already registered"
    },
    {
      "Time_Start": 641.9399999999999,
      "Time_End": 644.54,
      "Text": " and they have to do that in order to create an app."
    },
    {
      "Time_Start": 644.54,
      "Time_End": 647.5799999999999,
      "Text": " So this is how app registration works today in Google."
    },
    {
      "Time_Start": 647.5799999999999,
      "Time_End": 651.18,
      "Text": " For the second missing piece, the management page for users,"
    },
    {
      "Time_Start": 651.18,
      "Time_End": 653.02,
      "Text": " actually, there is a designated setting page"
    },
    {
      "Time_Start": 653.02,
      "Time_End": 655.78,
      "Text": " in each of one of your Google account"
    },
    {
      "Time_Start": 655.78,
      "Time_End": 658.06,
      "Text": " on which you can see all apps you've given access to"
    },
    {
      "Time_Start": 658.06,
      "Time_End": 659.86,
      "Text": " and what kind of permission you gave them."
    },
    {
      "Time_Start": 659.86,
      "Time_End": 662.42,
      "Text": " And you have the ability to remove their access."
    },
    {
      "Time_Start": 662.42,
      "Time_End": 664.98,
      "Text": " And it's important to know for the rest of the talk"
    },
    {
      "Time_Start": 664.98,
      "Time_End": 667.38,
      "Text": " that there's no other place in which you can manage apps."
    },
    {
      "Time_Start": 667.38,
      "Time_End": 669.14,
      "Text": " This is the sole page where you can"
    },
    {
      "Time_Start": 669.14,
      "Time_End": 672.62,
      "Text": " see all the apps you've given access to and can remove them."
    },
    {
      "Time_Start": 672.62,
      "Time_End": 674.66,
      "Text": " And if you want, you can scan this QR code"
    },
    {
      "Time_Start": 674.66,
      "Time_End": 676.54,
      "Text": " and go to your settings page and see"
    },
    {
      "Time_Start": 676.54,
      "Time_End": 678.14,
      "Text": " all apps you've given access to."
    },
    {
      "Time_Start": 678.14,
      "Time_End": 680.7,
      "Text": " But if you don't really like scanning QR codes,"
    },
    {
      "Time_Start": 680.7,
      "Time_End": 684.66,
      "Text": " I also provided an image of how this app looks like."
    },
    {
      "Time_Start": 684.66,
      "Time_End": 687.78,
      "Text": " And you can see a number of apps I've given access to."
    },
    {
      "Time_Start": 687.78,
      "Time_End": 689.54,
      "Text": " And if I click on one of these apps,"
    },
    {
      "Time_Start": 689.54,
      "Time_End": 692.14,
      "Text": " I can see the permission that I gave them."
    },
    {
      "Time_Start": 692.14,
      "Time_End": 694.26,
      "Text": " For instance, this AI mail assistance"
    },
    {
      "Time_Start": 694.26,
      "Time_End": 696.1,
      "Text": " has access to my email, but doesn't"
    },
    {
      "Time_Start": 696.1,
      "Time_End": 697.42,
      "Text": " have access to my drive."
    },
    {
      "Time_Start": 697.42,
      "Time_End": 699.0600000000001,
      "Text": " And I also have a button on which"
    },
    {
      "Time_Start": 699.0600000000001,
      "Time_End": 703.22,
      "Text": " I can click and remove the access of this app."
    },
    {
      "Time_Start": 703.22,
      "Time_End": 708.5000000000001,
      "Text": " OK, so we've seen why we need OAuth, how it works,"
    },
    {
      "Time_Start": 708.5000000000001,
      "Time_End": 710.3000000000001,
      "Text": " and the missing pieces of OAuth, and how they"
    },
    {
      "Time_Start": 710.3000000000001,
      "Time_End": 712.46,
      "Text": " were implemented in Google."
    },
    {
      "Time_Start": 712.46,
      "Time_End": 716.0200000000001,
      "Text": " Now we're finally ready to see some ghosts."
    },
    {
      "Time_Start": 716.0200000000001,
      "Time_End": 718.4200000000001,
      "Text": " So the discovery of the ghost token vulnerability"
    },
    {
      "Time_Start": 718.4200000000001,
      "Time_End": 720.1400000000001,
      "Text": " happened like many other vulnerabilities."
    },
    {
      "Time_Start": 720.1400000000001,
      "Time_End": 722.1,
      "Text": " It was very unexpected."
    },
    {
      "Time_Start": 722.1,
      "Time_End": 725.1,
      "Text": " So at my job, we do a routine analysis"
    },
    {
      "Time_Start": 725.1,
      "Time_End": 728.1,
      "Text": " of Google environments of different customers."
    },
    {
      "Time_Start": 728.1,
      "Time_End": 731.1,
      "Text": " And in one customer, we noticed something weird."
    },
    {
      "Time_Start": 731.1,
      "Time_End": 733.74,
      "Text": " We noticed an app whose name was suddenly"
    },
    {
      "Time_Start": 733.74,
      "Time_End": 735.4200000000001,
      "Text": " changed to be its identifier."
    },
    {
      "Time_Start": 735.4200000000001,
      "Time_End": 738.86,
      "Text": " Usually, we see app names that are human-readable."
    },
    {
      "Time_Start": 738.86,
      "Time_End": 740.74,
      "Text": " And suddenly, it was changed to the same thing"
    },
    {
      "Time_Start": 740.74,
      "Time_End": 742.94,
      "Text": " as the unique ID given to the app."
    },
    {
      "Time_Start": 742.94,
      "Time_End": 744.98,
      "Text": " And we didn't really know what happened."
    },
    {
      "Time_Start": 744.98,
      "Time_End": 747.34,
      "Text": " But we speculated that this happens"
    },
    {
      "Time_Start": 747.34,
      "Time_End": 750.66,
      "Text": " if the app is being deleted by the developer of the app."
    },
    {
      "Time_Start": 750.66,
      "Time_End": 753.46,
      "Text": " So the back end in Google gets confused"
    },
    {
      "Time_Start": 753.46,
      "Time_End": 755.5,
      "Text": " and doesn't know where to take the app name from."
    },
    {
      "Time_Start": 755.5,
      "Time_End": 758.18,
      "Text": " So it defaults to this ID."
    },
    {
      "Time_Start": 758.18,
      "Time_End": 761.22,
      "Text": " So we tested it, like good researchers do."
    },
    {
      "Time_Start": 761.22,
      "Time_End": 762.98,
      "Text": " We created a GCP project."
    },
    {
      "Time_Start": 762.98,
      "Time_End": 764.5,
      "Text": " Within, we created an app."
    },
    {
      "Time_Start": 764.5,
      "Time_End": 766.38,
      "Text": " We installed it on some test users."
    },
    {
      "Time_Start": 766.38,
      "Time_End": 768.06,
      "Text": " And then we went into this project"
    },
    {
      "Time_Start": 768.06,
      "Time_End": 771.74,
      "Text": " and deleted the client ID that we generated for this app."
    },
    {
      "Time_Start": 771.74,
      "Time_End": 774.22,
      "Text": " And once we did, the following things happened."
    },
    {
      "Time_Start": 774.22,
      "Time_End": 776.86,
      "Text": " So first, the name of the app became its client ID."
    },
    {
      "Time_Start": 776.86,
      "Time_End": 779.46,
      "Text": " So we were able to reproduce this weirdness."
    },
    {
      "Time_Start": 779.46,
      "Time_End": 782.78,
      "Text": " But as, again, good researchers do, we didn't stop there."
    },
    {
      "Time_Start": 782.78,
      "Time_End": 784.42,
      "Text": " And we tried to abuse this."
    },
    {
      "Time_Start": 784.4200000000001,
      "Time_End": 787.46,
      "Text": " So we took the client ID we just deleted and tried to use it."
    },
    {
      "Time_Start": 787.46,
      "Time_End": 789.1400000000001,
      "Text": " And we got this error, which says"
    },
    {
      "Time_Start": 789.1400000000001,
      "Time_End": 791.0600000000001,
      "Text": " that the client ID is deleted."
    },
    {
      "Time_Start": 791.0600000000001,
      "Time_End": 794.58,
      "Text": " And also, all tokens previously given by Google"
    },
    {
      "Time_Start": 794.58,
      "Time_End": 797.0600000000001,
      "Text": " authorizing the app stopped working."
    },
    {
      "Time_Start": 797.0600000000001,
      "Time_End": 798.46,
      "Text": " So we couldn't use them anymore."
    },
    {
      "Time_Start": 798.46,
      "Time_End": 800.5000000000001,
      "Text": " The developer couldn't use them anymore."
    },
    {
      "Time_Start": 800.5000000000001,
      "Time_End": 803.58,
      "Text": " And also, the app disappeared from the management pages"
    },
    {
      "Time_Start": 803.58,
      "Time_End": 806.46,
      "Text": " of all users who installed it."
    },
    {
      "Time_Start": 806.46,
      "Time_End": 808.6200000000001,
      "Text": " So now you look at this and you say, well,"
    },
    {
      "Time_Start": 808.6200000000001,
      "Time_End": 810.1400000000001,
      "Text": " that seems reasonable, right?"
    },
    {
      "Time_Start": 810.1400000000001,
      "Time_End": 811.6600000000001,
      "Text": " The app is deleted."
    },
    {
      "Time_Start": 811.6600000000001,
      "Time_End": 813.7,
      "Text": " I expect it to be completely removed"
    },
    {
      "Time_Start": 813.7,
      "Time_End": 816.74,
      "Text": " from everywhere it was."
    },
    {
      "Time_Start": 816.74,
      "Time_End": 818.34,
      "Text": " But I want you to recall that I said"
    },
    {
      "Time_Start": 818.34,
      "Time_End": 820.98,
      "Text": " that today, app registration in Google,"
    },
    {
      "Time_Start": 820.98,
      "Time_End": 822.5,
      "Text": " when you create a client ID, it's"
    },
    {
      "Time_Start": 822.5,
      "Time_End": 825.62,
      "Text": " actually contained within a GCP project."
    },
    {
      "Time_Start": 825.62,
      "Time_End": 827.62,
      "Text": " So this begs the question, what if instead"
    },
    {
      "Time_Start": 827.62,
      "Time_End": 832.58,
      "Text": " of deleting the client ID, we deleted the entire GCP project?"
    },
    {
      "Time_Start": 832.58,
      "Time_End": 834.62,
      "Text": " So we went ahead and tried that."
    },
    {
      "Time_Start": 834.62,
      "Time_End": 837.3000000000001,
      "Text": " So we went to some project in GCP"
    },
    {
      "Time_Start": 837.3000000000001,
      "Time_End": 840.5400000000001,
      "Text": " that had an app inside of it that some users installed."
    },
    {
      "Time_Start": 840.5400000000001,
      "Time_End": 841.7,
      "Text": " And we deleted it."
    },
    {
      "Time_Start": 841.7,
      "Time_End": 843.22,
      "Text": " And once you delete a GCP project,"
    },
    {
      "Time_Start": 843.22,
      "Time_End": 845.6600000000001,
      "Text": " it enters a special limbo state."
    },
    {
      "Time_Start": 845.6600000000001,
      "Time_End": 849.38,
      "Text": " They call it a pending deletion state."
    },
    {
      "Time_Start": 849.38,
      "Time_End": 852.22,
      "Text": " And once the project was in pending deletion state,"
    },
    {
      "Time_Start": 852.22,
      "Time_End": 854.62,
      "Text": " the app contained within this project"
    },
    {
      "Time_Start": 854.62,
      "Time_End": 858.86,
      "Text": " behaved similarly to when it was deleted directly."
    },
    {
      "Time_Start": 858.86,
      "Time_End": 860.94,
      "Text": " So the client ID couldn't be used anymore."
    },
    {
      "Time_Start": 860.94,
      "Time_End": 864.1800000000001,
      "Text": " All tokens previously given to the app stopped working."
    },
    {
      "Time_Start": 864.1800000000001,
      "Time_End": 867.1400000000001,
      "Text": " And also, the app disappeared from the user management pages"
    },
    {
      "Time_Start": 867.1400000000001,
      "Time_End": 869.0200000000001,
      "Text": " who installed it."
    },
    {
      "Time_Start": 869.0200000000001,
      "Time_End": 871.0200000000001,
      "Text": " But as you can see on the image here,"
    },
    {
      "Time_Start": 871.02,
      "Time_End": 873.34,
      "Text": " you have a button to restore projects."
    },
    {
      "Time_Start": 873.34,
      "Time_End": 875.38,
      "Text": " So once you delete a project in GCP,"
    },
    {
      "Time_Start": 875.38,
      "Time_End": 878.1,
      "Text": " you have 30 days to regret your decision deleting it"
    },
    {
      "Time_Start": 878.1,
      "Time_End": 880.66,
      "Text": " and actually restore it to a previous state."
    },
    {
      "Time_Start": 880.66,
      "Time_End": 884.14,
      "Text": " So what would happen to the tokens of the app"
    },
    {
      "Time_Start": 884.14,
      "Time_End": 886.06,
      "Text": " if we restored the project?"
    },
    {
      "Time_Start": 886.06,
      "Time_End": 888.8199999999999,
      "Text": " So you might have guessed it, or not, I don't know."
    },
    {
      "Time_Start": 888.8199999999999,
      "Time_End": 892.14,
      "Text": " But actually, all tokens given previously to the app"
    },
    {
      "Time_Start": 892.14,
      "Time_End": 896.02,
      "Text": " started working again once we restored the project."
    },
    {
      "Time_Start": 896.02,
      "Time_End": 898.18,
      "Text": " Do you notice the ghost?"
    },
    {
      "Time_Start": 898.18,
      "Time_End": 900.8199999999999,
      "Text": " So let's recap what just happened."
    },
    {
      "Time_Start": 900.82,
      "Time_End": 903.1400000000001,
      "Text": " Let's say our developer from before, Anne,"
    },
    {
      "Time_Start": 903.1400000000001,
      "Time_End": 906.0600000000001,
      "Text": " decided to turn evil and become an attacker."
    },
    {
      "Time_Start": 906.0600000000001,
      "Time_End": 908.1800000000001,
      "Text": " So we call her Evil Anne."
    },
    {
      "Time_Start": 908.1800000000001,
      "Time_End": 912.5,
      "Text": " So let's say Vikram installs one of Anne's apps."
    },
    {
      "Time_Start": 912.5,
      "Time_End": 915.86,
      "Text": " Now, if Anne combines the fact that once she deletes"
    },
    {
      "Time_Start": 915.86,
      "Time_End": 918.58,
      "Text": " the project associated with the app,"
    },
    {
      "Time_Start": 918.58,
      "Time_End": 921.1800000000001,
      "Text": " the user Vikram can't see the app anymore"
    },
    {
      "Time_Start": 921.1800000000001,
      "Time_End": 922.82,
      "Text": " and remove its access."
    },
    {
      "Time_Start": 922.82,
      "Time_End": 925.34,
      "Text": " But when Anne restores the project associated"
    },
    {
      "Time_Start": 925.34,
      "Time_End": 928.58,
      "Text": " with the app, the token belonging to Vikram"
    },
    {
      "Time_Start": 928.58,
      "Time_End": 931.82,
      "Text": " starts working again, and Anne can access Vikram's data."
    },
    {
      "Time_Start": 931.82,
      "Time_End": 934.5400000000001,
      "Text": " What she can do is actually keep the project"
    },
    {
      "Time_Start": 934.5400000000001,
      "Time_End": 935.9000000000001,
      "Text": " in a pending deletion state."
    },
    {
      "Time_Start": 935.9000000000001,
      "Time_End": 938.0200000000001,
      "Text": " And whenever she wants to access Vikram's data,"
    },
    {
      "Time_Start": 938.0200000000001,
      "Time_End": 941.26,
      "Text": " she restores it, access the data, and then removes it again."
    },
    {
      "Time_Start": 941.26,
      "Time_End": 943.74,
      "Text": " So Vikram can't remove her app."
    },
    {
      "Time_Start": 943.74,
      "Time_End": 947.74,
      "Text": " And in essence, Anne holds some kind of a ghost token"
    },
    {
      "Time_Start": 947.74,
      "Time_End": 951.86,
      "Text": " to Vikram's data that Vikram cannot get rid of."
    },
    {
      "Time_Start": 951.86,
      "Time_End": 953.22,
      "Text": " So you can relax."
    },
    {
      "Time_Start": 953.22,
      "Time_End": 954.62,
      "Text": " The vulnerability is patched now."
    },
    {
      "Time_Start": 954.62,
      "Time_End": 957.1800000000001,
      "Text": " I will talk about it in a few slides."
    },
    {
      "Time_Start": 957.1800000000001,
      "Time_End": 959.5000000000001,
      "Text": " But unfortunately, it means there's no live demo."
    },
    {
      "Time_Start": 959.5000000000001,
      "Time_End": 962.94,
      "Text": " I did pre-record the demo of me exploiting this"
    },
    {
      "Time_Start": 962.94,
      "Time_End": 963.9000000000001,
      "Text": " on a victim account."
    },
    {
      "Time_Start": 963.9000000000001,
      "Time_End": 966.22,
      "Text": " So let's see it."
    },
    {
      "Time_Start": 966.22,
      "Time_End": 969.22,
      "Text": " So here we have a victim that is convinced"
    },
    {
      "Time_Start": 969.22,
      "Time_End": 970.94,
      "Text": " to install my totally innocent app."
    },
    {
      "Time_Start": 970.94,
      "Time_End": 973.9000000000001,
      "Text": " And I promised you it was totally innocent at the time."
    },
    {
      "Time_Start": 973.9000000000001,
      "Time_End": 975.82,
      "Text": " So this is how the consent screen looks like."
    },
    {
      "Time_Start": 975.82,
      "Time_End": 980.3000000000001,
      "Text": " And the victim gives access to their drive files."
    },
    {
      "Time_Start": 980.3000000000001,
      "Time_End": 983.1,
      "Text": " And once they do it, this is the attacker point of view."
    },
    {
      "Time_Start": 983.1,
      "Time_End": 986.1,
      "Text": " I immediately get the token belonging to the victim."
    },
    {
      "Time_Start": 986.1,
      "Time_End": 989.38,
      "Text": " And then I quickly run over to the GCP project associated"
    },
    {
      "Time_Start": 989.38,
      "Time_End": 990.34,
      "Text": " with the app."
    },
    {
      "Time_Start": 990.34,
      "Time_End": 992.1,
      "Text": " And I delete it."
    },
    {
      "Time_Start": 992.1,
      "Time_End": 995.12,
      "Text": " And once I do, it enters a pending deletion state."
    },
    {
      "Time_Start": 995.12,
      "Time_End": 996.58,
      "Text": " And this can happen automatically."
    },
    {
      "Time_Start": 996.58,
      "Time_End": 999.0400000000001,
      "Text": " You can even write a two-line script that does it for you."
    },
    {
      "Time_Start": 999.0400000000001,
      "Time_End": 1002.74,
      "Text": " You don't have to do it manually if you're lazy like me."
    },
    {
      "Time_Start": 1002.74,
      "Time_End": 1004.74,
      "Text": " And let's go back to the victim's point of view."
    },
    {
      "Time_Start": 1004.74,
      "Time_End": 1006.66,
      "Text": " You can see this is the victim because of the V"
    },
    {
      "Time_Start": 1006.66,
      "Time_End": 1008.34,
      "Text": " on the top right there."
    },
    {
      "Time_Start": 1008.34,
      "Time_End": 1013.02,
      "Text": " And this is the list of all apps the victim given access to."
    },
    {
      "Time_Start": 1013.02,
      "Time_End": 1015.46,
      "Text": " As you can notice, totally innocent app"
    },
    {
      "Time_Start": 1015.5400000000001,
      "Time_End": 1017.3000000000001,
      "Text": " is not present on this list."
    },
    {
      "Time_Start": 1017.3000000000001,
      "Time_End": 1019.7800000000001,
      "Text": " So the victim, at any point in time,"
    },
    {
      "Time_Start": 1019.7800000000001,
      "Time_End": 1021.22,
      "Text": " cannot do anything about it."
    },
    {
      "Time_Start": 1021.22,
      "Time_End": 1023.14,
      "Text": " The victim can't even know that the app"
    },
    {
      "Time_Start": 1023.14,
      "Time_End": 1026.3400000000001,
      "Text": " is installed on their account."
    },
    {
      "Time_Start": 1026.3400000000001,
      "Time_End": 1029.94,
      "Text": " But notice that this is back to the attacker point of view."
    },
    {
      "Time_Start": 1029.94,
      "Time_End": 1033.14,
      "Text": " At any time that I want to, I can restore the GCP project"
    },
    {
      "Time_Start": 1033.14,
      "Time_End": 1033.82,
      "Text": " that I deleted."
    },
    {
      "Time_Start": 1037.7,
      "Time_End": 1039.82,
      "Text": " So at any time, we can restore the GCP project"
    },
    {
      "Time_Start": 1039.82,
      "Time_End": 1043.3400000000001,
      "Text": " that we deleted before and then use the same token"
    },
    {
      "Time_Start": 1043.4199999999998,
      "Time_End": 1046.98,
      "Text": " we received before to access the user's drive files."
    },
    {
      "Time_Start": 1046.98,
      "Time_End": 1048.34,
      "Text": " This is what happens here."
    },
    {
      "Time_Start": 1048.34,
      "Time_End": 1050.62,
      "Text": " And once we do that, we can immediately,"
    },
    {
      "Time_Start": 1050.62,
      "Time_End": 1053.5,
      "Text": " after getting the victim's files,"
    },
    {
      "Time_Start": 1053.5,
      "Time_End": 1055.34,
      "Text": " we can shut down the project again"
    },
    {
      "Time_Start": 1055.34,
      "Time_End": 1057.8999999999999,
      "Text": " and restore it to its deleted state,"
    },
    {
      "Time_Start": 1057.8999999999999,
      "Time_End": 1063.06,
      "Text": " pending deletion state, so the victim cannot remove it."
    },
    {
      "Time_Start": 1063.06,
      "Time_End": 1064.98,
      "Text": " So we reported the vulnerability to Google"
    },
    {
      "Time_Start": 1064.98,
      "Time_End": 1066.1799999999998,
      "Text": " when we discovered it."
    },
    {
      "Time_Start": 1066.1799999999998,
      "Time_End": 1068.58,
      "Text": " And we worked together on a fix, which wasn't as simple"
    },
    {
      "Time_Start": 1068.58,
      "Time_End": 1071.1399999999999,
      "Text": " because it involved some deep infrastructure"
    },
    {
      "Time_Start": 1071.14,
      "Time_End": 1073.6200000000001,
      "Text": " changes to Google."
    },
    {
      "Time_Start": 1073.6200000000001,
      "Time_End": 1077.5,
      "Text": " So you can read more about what the patch did exactly"
    },
    {
      "Time_Start": 1077.5,
      "Time_End": 1080.7,
      "Text": " to solve this vulnerability, as well as some little details"
    },
    {
      "Time_Start": 1080.7,
      "Time_End": 1082.42,
      "Text": " about the research that I didn't have time"
    },
    {
      "Time_Start": 1082.42,
      "Time_End": 1085.1000000000001,
      "Text": " to go through here in the blog post I wrote about it."
    },
    {
      "Time_Start": 1085.1000000000001,
      "Time_End": 1088.38,
      "Text": " Just search it online, ghost token, you'll find it."
    },
    {
      "Time_Start": 1088.38,
      "Time_End": 1092.3000000000002,
      "Text": " OK, so we've seen the ghost token vulnerability."
    },
    {
      "Time_Start": 1092.3000000000002,
      "Time_End": 1096.26,
      "Text": " Let's discuss some takeaways of this vulnerability."
    },
    {
      "Time_Start": 1096.26,
      "Time_End": 1099.3400000000001,
      "Text": " OK, so first, the vulnerability, in my opinion,"
    },
    {
      "Time_Start": 1099.34,
      "Time_End": 1101.06,
      "Text": " has probably been open ever since Google"
    },
    {
      "Time_Start": 1101.06,
      "Time_End": 1104.62,
      "Text": " made the move to contain apps inside GCP, which"
    },
    {
      "Time_Start": 1104.62,
      "Time_End": 1106.62,
      "Text": " happened around six years ago."
    },
    {
      "Time_Start": 1106.62,
      "Time_End": 1110.54,
      "Text": " And actually, because the management page of the users"
    },
    {
      "Time_Start": 1110.54,
      "Time_End": 1114.02,
      "Text": " is so severely lacking in audit of who accesses your data"
    },
    {
      "Time_Start": 1114.02,
      "Time_End": 1117.4399999999998,
      "Text": " and when, it's basically impossible to know if someone"
    },
    {
      "Time_Start": 1117.4399999999998,
      "Time_End": 1119.1799999999998,
      "Text": " exploited this vulnerability."
    },
    {
      "Time_Start": 1119.1799999999998,
      "Time_End": 1121.74,
      "Text": " Let's imagine one of the developers having"
    },
    {
      "Time_Start": 1121.74,
      "Time_End": 1123.3,
      "Text": " one of the million of apps."
    },
    {
      "Time_Start": 1123.3,
      "Time_End": 1126.1,
      "Text": " One developer was bad and decided"
    },
    {
      "Time_Start": 1126.1000000000001,
      "Time_End": 1129.3000000000002,
      "Text": " to exploit his vulnerability."
    },
    {
      "Time_Start": 1129.3000000000002,
      "Time_End": 1130.38,
      "Text": " Would we even notice?"
    },
    {
      "Time_Start": 1130.38,
      "Time_End": 1131.9,
      "Text": " Would anyone know that?"
    },
    {
      "Time_Start": 1131.9,
      "Time_End": 1133.0600000000002,
      "Text": " There's no way to know that."
    },
    {
      "Time_Start": 1133.0600000000002,
      "Time_End": 1134.44,
      "Text": " And I think this makes the threat"
    },
    {
      "Time_Start": 1134.44,
      "Time_End": 1136.7,
      "Text": " potential of ghost token pretty huge."
    },
    {
      "Time_Start": 1136.7,
      "Time_End": 1141.5800000000002,
      "Text": " We have no idea if it was ever exploited."
    },
    {
      "Time_Start": 1141.5800000000002,
      "Time_End": 1145.0200000000002,
      "Text": " The second takeaway is actually, if you recall back"
    },
    {
      "Time_Start": 1145.0200000000002,
      "Time_End": 1147.14,
      "Text": " to the two missing pieces, so the fact"
    },
    {
      "Time_Start": 1147.14,
      "Time_End": 1151.5400000000002,
      "Text": " that Google made it so apps are contained inside GCP project,"
    },
    {
      "Time_Start": 1151.5400000000002,
      "Time_End": 1154.7,
      "Text": " together with the fact that they have not enough audit logs"
    },
    {
      "Time_Start": 1154.7,
      "Time_End": 1157.38,
      "Text": " related to how apps access your data,"
    },
    {
      "Time_Start": 1157.38,
      "Time_End": 1161.18,
      "Text": " together made two mistakes made the vulnerability happen."
    },
    {
      "Time_Start": 1161.18,
      "Time_End": 1163.94,
      "Text": " And these mistakes, I don't hold it against Google."
    },
    {
      "Time_Start": 1163.94,
      "Time_End": 1166.18,
      "Text": " It's actually things that are not mentioned in the RFC"
    },
    {
      "Time_Start": 1166.18,
      "Time_End": 1166.7,
      "Text": " at all."
    },
    {
      "Time_Start": 1166.7,
      "Time_End": 1168.7,
      "Text": " So maybe this is a message to you."
    },
    {
      "Time_Start": 1168.7,
      "Time_End": 1170.82,
      "Text": " If you're ever involved in implementing"
    },
    {
      "Time_Start": 1170.82,
      "Time_End": 1172.54,
      "Text": " OAuth in your organization, you need"
    },
    {
      "Time_Start": 1172.54,
      "Time_End": 1174.5800000000002,
      "Text": " to put special attention actually"
    },
    {
      "Time_Start": 1174.5800000000002,
      "Time_End": 1176.54,
      "Text": " on the things that are not written in RFC,"
    },
    {
      "Time_Start": 1176.54,
      "Time_End": 1178.42,
      "Text": " how you implement them and make sure there's"
    },
    {
      "Time_Start": 1178.42,
      "Time_End": 1181.6200000000001,
      "Text": " no such vulnerability in them as well."
    },
    {
      "Time_Start": 1181.6200000000001,
      "Time_End": 1183.9,
      "Text": " The third point is directed at researchers"
    },
    {
      "Time_Start": 1183.9,
      "Time_End": 1186.7,
      "Text": " in the cloud, which I think are most of you here."
    },
    {
      "Time_Start": 1186.7,
      "Time_End": 1190.7800000000002,
      "Text": " So I've been doing stuff related to all vulnerabilities"
    },
    {
      "Time_Start": 1190.7800000000002,
      "Time_End": 1192.42,
      "Text": " in the past five years or so."
    },
    {
      "Time_Start": 1192.42,
      "Time_End": 1196.8600000000001,
      "Text": " And whenever I read information regarding vulnerabilities,"
    },
    {
      "Time_Start": 1196.8600000000001,
      "Time_End": 1199.7,
      "Text": " it's always very confusing and convoluted."
    },
    {
      "Time_Start": 1199.7,
      "Time_End": 1203.5400000000002,
      "Text": " And I hope this one was a bit clearer regarding OAuth."
    },
    {
      "Time_Start": 1203.5400000000002,
      "Time_End": 1206.7800000000002,
      "Text": " But I see many researchers shy away"
    },
    {
      "Time_Start": 1206.7800000000002,
      "Time_End": 1209.66,
      "Text": " from looking at these areas of OAuth."
    },
    {
      "Time_Start": 1209.66,
      "Time_End": 1213.14,
      "Text": " I think that actually because OAuth is just a framework"
    },
    {
      "Time_Start": 1213.14,
      "Time_End": 1217.26,
      "Text": " and the implementation differs a lot between providers,"
    },
    {
      "Time_Start": 1217.26,
      "Time_End": 1220.3000000000002,
      "Text": " it's actually very good rich surface vulnerability research."
    },
    {
      "Time_Start": 1220.3000000000002,
      "Time_End": 1224.7800000000002,
      "Text": " And I implore you to look at it at your next research."
    },
    {
      "Time_Start": 1224.7800000000002,
      "Time_End": 1226.98,
      "Text": " To wrap up this talk, I would like"
    },
    {
      "Time_Start": 1226.98,
      "Time_End": 1230.3000000000002,
      "Text": " to finally look into the future."
    },
    {
      "Time_Start": 1230.3000000000002,
      "Time_End": 1233.5,
      "Text": " And I would like to give some sort of a vision of how"
    },
    {
      "Time_Start": 1233.5,
      "Time_End": 1236.7,
      "Text": " I see the next iteration of OAuth."
    },
    {
      "Time_Start": 1236.7,
      "Time_End": 1240.18,
      "Text": " So the first thing I want to see is a change"
    },
    {
      "Time_Start": 1240.18,
      "Time_End": 1244.54,
      "Text": " of how we register apps in different platforms."
    },
    {
      "Time_Start": 1244.54,
      "Time_End": 1247.1000000000001,
      "Text": " So today, you need to go to each individual platform"
    },
    {
      "Time_Start": 1247.1000000000001,
      "Time_End": 1250.78,
      "Text": " you want to make an app for, to GitHub, to Slack, to Google,"
    },
    {
      "Time_Start": 1250.78,
      "Time_End": 1251.5800000000002,
      "Text": " et cetera."
    },
    {
      "Time_Start": 1251.5800000000002,
      "Time_End": 1253.46,
      "Text": " And you need to register your app separately."
    },
    {
      "Time_Start": 1253.46,
      "Time_End": 1255.5800000000002,
      "Text": " And each of them has a completely separate way"
    },
    {
      "Time_Start": 1255.5800000000002,
      "Time_End": 1258.7,
      "Text": " to verify and do this whole registration process."
    },
    {
      "Time_Start": 1258.7,
      "Time_End": 1261.18,
      "Text": " And I imagine a consolidated, centralized platform"
    },
    {
      "Time_Start": 1261.18,
      "Time_End": 1265.6200000000001,
      "Text": " where developers can one time register their app."
    },
    {
      "Time_Start": 1265.6200000000001,
      "Time_End": 1267.9,
      "Text": " And it will be immediately available in all platforms"
    },
    {
      "Time_Start": 1267.9,
      "Time_End": 1269.5,
      "Text": " they want it to be."
    },
    {
      "Time_Start": 1269.5,
      "Time_End": 1271.18,
      "Text": " Additionally, while they register,"
    },
    {
      "Time_Start": 1271.18,
      "Time_End": 1273.02,
      "Text": " they can either be completely anonymous"
    },
    {
      "Time_Start": 1273.02,
      "Time_End": 1275.98,
      "Text": " and basically don't give any information about their app."
    },
    {
      "Time_Start": 1275.98,
      "Time_End": 1278.38,
      "Text": " Or maybe they are a very well-respected company"
    },
    {
      "Time_Start": 1278.38,
      "Time_End": 1280.82,
      "Text": " who has no problem verifying a lot of information"
    },
    {
      "Time_Start": 1280.82,
      "Time_End": 1281.78,
      "Text": " about themselves."
    },
    {
      "Time_Start": 1281.78,
      "Time_End": 1283.46,
      "Text": " And they can give all this information"
    },
    {
      "Time_Start": 1283.46,
      "Time_End": 1285.42,
      "Text": " to this centralized platform."
    },
    {
      "Time_Start": 1285.42,
      "Time_End": 1287.26,
      "Text": " Of course, the important thing here"
    },
    {
      "Time_Start": 1287.26,
      "Time_End": 1290.98,
      "Text": " is that when a user comes to authorize an app,"
    },
    {
      "Time_Start": 1290.98,
      "Time_End": 1293.74,
      "Text": " all this information would be fully transparent and shown"
    },
    {
      "Time_Start": 1293.74,
      "Time_End": 1297.74,
      "Text": " to the user, helping user make way better decisions when"
    },
    {
      "Time_Start": 1297.74,
      "Time_End": 1300.42,
      "Text": " deciding whether to allow or deny access"
    },
    {
      "Time_Start": 1300.42,
      "Time_End": 1303.54,
      "Text": " to apps they want to use."
    },
    {
      "Time_Start": 1303.54,
      "Time_End": 1305.9,
      "Text": " The second part is about the user management page."
    },
    {
      "Time_Start": 1305.9,
      "Time_End": 1309.58,
      "Text": " So indeed, today, all providers that I have looked at"
    },
    {
      "Time_Start": 1309.58,
      "Time_End": 1312.22,
      "Text": " provide a list of all apps you've given access to"
    },
    {
      "Time_Start": 1312.22,
      "Time_End": 1313.78,
      "Text": " and the ability to remove it."
    },
    {
      "Time_Start": 1313.78,
      "Time_End": 1315.34,
      "Text": " But I think that's still lacking."
    },
    {
      "Time_Start": 1315.34,
      "Time_End": 1319.14,
      "Text": " I, as a user, would like to know which app accessed my data,"
    },
    {
      "Time_Start": 1319.14,
      "Time_End": 1321.5,
      "Text": " which data was accessed, and maybe more identify"
    },
    {
      "Time_Start": 1321.5,
      "Time_End": 1325.9,
      "Text": " details about the access, like IP address or user agent."
    },
    {
      "Time_Start": 1325.9,
      "Time_End": 1329.22,
      "Text": " So I can be more in control of where my data is"
    },
    {
      "Time_Start": 1329.22,
      "Time_End": 1331.8200000000002,
      "Text": " and who is accessing it."
    },
    {
      "Time_Start": 1331.8200000000002,
      "Time_End": 1333.94,
      "Text": " These two fixes, by the way, would also"
    },
    {
      "Time_Start": 1333.94,
      "Time_End": 1338.1000000000001,
      "Text": " fix the problem with the ghost token vulnerability."
    },
    {
      "Time_Start": 1338.1000000000001,
      "Time_End": 1340.5,
      "Text": " The last part of the vision is a bit of a smaller one."
    },
    {
      "Time_Start": 1340.5,
      "Time_End": 1343.26,
      "Text": " So OAuth has many use cases today in the RFC."
    },
    {
      "Time_Start": 1343.26,
      "Time_End": 1346.8600000000001,
      "Text": " And even three years ago, another use case was added."
    },
    {
      "Time_Start": 1346.8600000000001,
      "Time_End": 1351.3400000000001,
      "Text": " I think there are many parts, many use cases still present"
    },
    {
      "Time_Start": 1351.3400000000001,
      "Time_End": 1354.26,
      "Text": " today in the OAuth RFC that are a bit outdated."
    },
    {
      "Time_Start": 1354.5,
      "Time_End": 1356.02,
      "Text": " Nobody really uses them anymore."
    },
    {
      "Time_Start": 1356.02,
      "Time_End": 1358.46,
      "Text": " And I would be happy to see them gone."
    },
    {
      "Time_Start": 1358.46,
      "Time_End": 1360.9,
      "Text": " I don't like backwards compatibility."
    },
    {
      "Time_Start": 1360.9,
      "Time_End": 1364.3,
      "Text": " Additionally, one of the most promising use cases"
    },
    {
      "Time_Start": 1364.3,
      "Time_End": 1366.66,
      "Text": " that we see everywhere today is machine-to-machine"
    },
    {
      "Time_Start": 1366.66,
      "Time_End": 1367.78,
      "Text": " authorization."
    },
    {
      "Time_Start": 1367.78,
      "Time_End": 1369.9,
      "Text": " Right now, people implementing machine-to-machine"
    },
    {
      "Time_Start": 1369.9,
      "Time_End": 1374.18,
      "Text": " authorization use OAuth in some weird backwards way"
    },
    {
      "Time_Start": 1374.18,
      "Time_End": 1375.46,
      "Text": " in order to implement that."
    },
    {
      "Time_Start": 1375.46,
      "Time_End": 1378.94,
      "Text": " And I would be happy to see a specific use case in the OAuth"
    },
    {
      "Time_Start": 1378.94,
      "Time_End": 1384.3400000000001,
      "Text": " RFC designed to lay the foundation of how"
    },
    {
      "Time_Start": 1384.3400000000001,
      "Time_End": 1387.38,
      "Text": " machine-to-machine authorization works."
    },
    {
      "Time_Start": 1387.38,
      "Time_End": 1391.26,
      "Text": " So to wrap up this talk, I presented a full overview"
    },
    {
      "Time_Start": 1391.26,
      "Time_End": 1394.66,
      "Text": " of a unique vulnerability in Google OAuth's design."
    },
    {
      "Time_Start": 1394.66,
      "Time_End": 1397.94,
      "Text": " We analyzed how maybe the insufficient OAuth framework"
    },
    {
      "Time_Start": 1397.94,
      "Time_End": 1400.42,
      "Text": " was partly to blame for this bug."
    },
    {
      "Time_Start": 1400.42,
      "Time_End": 1402.5,
      "Text": " And finally, we discussed some ways"
    },
    {
      "Time_Start": 1402.5,
      "Time_End": 1404.9,
      "Text": " that we as a community should make in order"
    },
    {
      "Time_Start": 1404.9,
      "Time_End": 1407.8600000000001,
      "Text": " to change how OAuth looks like and prevent"
    },
    {
      "Time_Start": 1407.8600000000001,
      "Time_End": 1409.98,
      "Text": " from potentially having these kind"
    },
    {
      "Time_Start": 1409.98,
      "Time_End": 1413.5000000000002,
      "Text": " of catastrophic vulnerabilities in the future."
    },
    {
      "Time_Start": 1413.5000000000002,
      "Time_End": 1415.2600000000002,
      "Text": " Thank you all for listening."
    },
    {
      "Time_Start": 1415.2600000000002,
      "Time_End": 1416.2600000000002,
      "Text": " I have had the pleasure."
    },
    {
      "Time_Start": 1416.26,
      "Time_End": 1418.02,
      "Text": " Thank you."
    }
  ]
}