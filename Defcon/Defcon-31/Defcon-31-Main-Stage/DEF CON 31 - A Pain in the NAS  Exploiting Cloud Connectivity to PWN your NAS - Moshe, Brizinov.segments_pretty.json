{
  "segments": [
    {
      "Time_Start": 0.0,
      "Time_End": 5.0,
      "Text": "This text was transcribed using whisper model: large-v2\n\n Okay hello everybody and welcome to our DefCon talk a pain in the NAS exploiting cloud"
    },
    {
      "Time_Start": 9.08,
      "Time_End": 14.84,
      "Text": " connectivity to porn your NAS devices. So my name is Noah Moshe I'm a vulnerability"
    },
    {
      "Time_Start": 14.84,
      "Time_End": 20.18,
      "Text": " researcher in Clarity Team 82 uh and with me today is Sharon Brezinov our director of"
    },
    {
      "Time_Start": 20.18,
      "Time_End": 25.66,
      "Text": " research and as you can see behind us this is our playground this is where we have fun. We"
    },
    {
      "Time_Start": 25.66,
      "Time_End": 32.06,
      "Text": " mainly look at IOT and OT products uh be it PLCs, HMIs and of course like I'm gonna"
    },
    {
      "Time_Start": 32.06,
      "Time_End": 37.66,
      "Text": " showcase to you today NAS devices. And our job is basically breaking them and looking for"
    },
    {
      "Time_Start": 37.66,
      "Time_End": 42.64,
      "Text": " cool vulnerabilities which let's say it's heaven in life. And of course we'd like to make"
    },
    {
      "Time_Start": 42.64,
      "Time_End": 47.58,
      "Text": " huge thanks to the other Team 82 researchers that helped us in this research. Uri Katz and"
    },
    {
      "Time_Start": 47.58,
      "Time_End": 53.42,
      "Text": " Vera Mance huge thanks to you and you guys rock. So let's talk about what we're gonna"
    },
    {
      "Time_Start": 53.42,
      "Time_End": 59.78,
      "Text": " showcase to you today. You see I have a NAS at home where I store all of my spicy content"
    },
    {
      "Time_Start": 59.78,
      "Time_End": 65.86,
      "Text": " like for example my documents, the of course government stuff and some kind of pictures"
    },
    {
      "Time_Start": 65.86,
      "Time_End": 71.86,
      "Text": " let's say. And that way that's why when Pwn2Own competition in Toronto last year decided"
    },
    {
      "Time_Start": 71.86,
      "Time_End": 77.1,
      "Text": " to do the NAS category where the goal was to hack and exploit a remote code execution"
    },
    {
      "Time_Start": 77.1,
      "Time_End": 81.94,
      "Text": " vulnerabilities on these NAS devices that which one of which I actually own I said yeah"
    },
    {
      "Time_Start": 81.96,
      "Time_End": 87.7,
      "Text": " let's do it and let's go all in and let's spawn both of these devices. You see we try to"
    },
    {
      "Time_Start": 87.7,
      "Time_End": 93.2,
      "Text": " look at kind of esoteric features because both of these NAS devices were quite old and"
    },
    {
      "Time_Start": 93.2,
      "Time_End": 97.88,
      "Text": " looked at by different researcher groups uh over the years so we try to look to what kind"
    },
    {
      "Time_Start": 97.88,
      "Time_End": 103.38,
      "Text": " of interesting stuff can we look at that maybe other researchers less likely put the effort"
    },
    {
      "Time_Start": 103.38,
      "Time_End": 108.75999999999999,
      "Text": " and time into. And that's when we realized that actually both of these NAS platforms have a"
    },
    {
      "Time_Start": 108.78,
      "Time_End": 113.78,
      "Text": " cloud platforms allowing users to actually access and use their NAS remotely through the"
    },
    {
      "Time_Start": 113.78,
      "Time_End": 118.86,
      "Text": " cloud. In the case of Western Digital it is what my cloud OS5 and in the case of"
    },
    {
      "Time_Start": 118.86,
      "Time_End": 125.86000000000001,
      "Text": " Synology it is we connect uh cloud services. Now I asked myself what's the use case here?"
    },
    {
      "Time_Start": 125.86000000000001,
      "Time_End": 131.0,
      "Text": " Why should I enable my cloud uh my device to connect to the cloud? And actually that's the"
    },
    {
      "Time_Start": 131.0,
      "Time_End": 137.48000000000002,
      "Text": " reason you see. My NAS sits at home where I save all my important stuff to it and I am out"
    },
    {
      "Time_Start": 137.5,
      "Time_End": 142.16,
      "Text": " and about. I could be at work, I could be on vacation etc. However I want to access my"
    },
    {
      "Time_Start": 142.16,
      "Time_End": 148.48,
      "Text": " files now. So that way through the cloud application I am trying and requesting my files"
    },
    {
      "Time_Start": 148.48,
      "Time_End": 153.98,
      "Text": " and fetching them remotely. But when I saw that this is the use case in business logic I"
    },
    {
      "Time_Start": 153.98,
      "Time_End": 160.01999999999998,
      "Text": " thought to myself hey maybe we can use it somehow and have attackers access the files we"
    },
    {
      "Time_Start": 160.01999999999998,
      "Time_End": 165.92,
      "Text": " save on our NAS through the cloud not requiring direct access. Somehow they can request"
    },
    {
      "Time_Start": 165.94000000000003,
      "Time_End": 171.70000000000002,
      "Text": " and fetch the files and get hold to my sensitive data. And that is exactly the kind of"
    },
    {
      "Time_Start": 171.70000000000002,
      "Time_End": 177.28000000000003,
      "Text": " ability we gained in the months leading to Pwn2Own competition where we were able to"
    },
    {
      "Time_Start": 177.28000000000003,
      "Time_End": 184.44000000000003,
      "Text": " access, read and write every file that was stored on a NAS device worldwide. And you can"
    },
    {
      "Time_Start": 184.44000000000003,
      "Time_End": 189.42000000000002,
      "Text": " imagine the catastrophic uh implications of it. I shouldn't say seeing sensitive files of"
    },
    {
      "Time_Start": 189.42000000000002,
      "Time_End": 194.52,
      "Text": " course and maybe altering them somehow. However we thought to ourselves yeah that's cool"
    },
    {
      "Time_Start": 194.52,
      "Time_End": 199.9,
      "Text": " however what could be cooler? I mean fetching files is cool however the holy grail is"
    },
    {
      "Time_Start": 199.9,
      "Time_End": 206.10000000000002,
      "Text": " actually executing code on the NAS devices through the cloud. Meaning somehow I am able to"
    },
    {
      "Time_Start": 206.10000000000002,
      "Time_End": 211.78,
      "Text": " access people's home network through the cloud application. And as it turns out this is"
    },
    {
      "Time_Start": 211.78,
      "Time_End": 217.28,
      "Text": " exactly the kind of vulnerability chain we exploited in the Pwn2Own competition netting"
    },
    {
      "Time_Start": 217.28,
      "Time_End": 224.12,
      "Text": " us 40k uh dollars and of course chaining 5 different vulnerabilities to attack cloud the"
    },
    {
      "Time_Start": 224.12,
      "Time_End": 229.96,
      "Text": " NAS devices. However since our attack leveraged the cloud we were able to not attack just"
    },
    {
      "Time_Start": 229.96,
      "Time_End": 236.0,
      "Text": " one device but instead we could attack any cloud connected device giving us access to"
    },
    {
      "Time_Start": 236.0,
      "Time_End": 241.14000000000001,
      "Text": " billions, millions and millions of different devices worldwide. And actually the"
    },
    {
      "Time_Start": 241.14000000000001,
      "Time_End": 247.44,
      "Text": " vulnerabilities we uncovered were so severe that Western Digital had to boot off devices"
    },
    {
      "Time_Start": 247.44,
      "Time_End": 252.98000000000002,
      "Text": " running old firmwares from their cloud access. Meaning if you are not patched and is and no"
    },
    {
      "Time_Start": 252.98000000000002,
      "Time_End": 256.68,
      "Text": " longer vulnerable to the vulnerabilities we discovered you can no longer access your"
    },
    {
      "Time_Start": 256.68,
      "Time_End": 262.06,
      "Text": " device through the cloud. This is because we identified some architecture flaws that had to"
    },
    {
      "Time_Start": 262.06,
      "Time_End": 267.96000000000004,
      "Text": " be changed meaning old devices can no longer connect to the cloud services. Well that is"
    },
    {
      "Time_Start": 267.96000000000004,
      "Time_End": 272.76,
      "Text": " the gist of our research so I hope you intrigued you but let's deep dive and see how we"
    },
    {
      "Time_Start": 272.76,
      "Time_End": 276.6,
      "Text": " uncovered all of these vulnerabilities and what kind of vulnerabilities we actually"
    },
    {
      "Time_Start": 276.6,
      "Time_End": 282.54,
      "Text": " managed to achieve. So let's start with Western Digital. In the Pwn2Own competition we"
    },
    {
      "Time_Start": 282.54,
      "Time_End": 287.54,
      "Text": " looked at Western Digital PR4100. This is the the QT right there uh and it is actually a"
    },
    {
      "Time_Start": 289.84000000000003,
      "Time_End": 294.84000000000003,
      "Text": " custom Linux based machine uh running x86 64 bit processor and inside this machine many"
    },
    {
      "Time_Start": 298.06,
      "Time_End": 303.72,
      "Text": " services are running. Of course we have the usual suspect, the web management port where"
    },
    {
      "Time_Start": 303.72,
      "Time_End": 309.06,
      "Text": " most of the prior vulnerabilities were discovered. However since it is a NAS device a lot of"
    },
    {
      "Time_Start": 309.12,
      "Time_End": 315.72,
      "Text": " file fetching and file accessing services also exist like SMB, FTP and of course accessing"
    },
    {
      "Time_Start": 315.72,
      "Time_End": 322.6,
      "Text": " the files over the uh HTTP requests. Well the first thing I did was order the device however I"
    },
    {
      "Time_Start": 322.6,
      "Time_End": 327.5,
      "Text": " am a very impatient man meaning I could not wait for the postal service to get my device to"
    },
    {
      "Time_Start": 327.5,
      "Time_End": 332.64,
      "Text": " me. That's why I went to Western Digital's website and looked for a firmware download in"
    },
    {
      "Time_Start": 332.64,
      "Time_End": 337.28,
      "Text": " the sub in in when trying to emulate my device and getting access to it even before it"
    },
    {
      "Time_Start": 337.3,
      "Time_End": 342.74,
      "Text": " arrives. Usually when we work with firmwares there are two options. Either the firmware is"
    },
    {
      "Time_Start": 342.74,
      "Time_End": 347.42,
      "Text": " encrypted meaning everything is encrypted somehow and the device decrypts it during run"
    },
    {
      "Time_Start": 347.42,
      "Time_End": 352.52000000000004,
      "Text": " time and during the upgrading process or it is simply unencrypted and containing all of the"
    },
    {
      "Time_Start": 352.52000000000004,
      "Time_End": 357.16,
      "Text": " different sections within the firmware. Luckily for us Western Digital chose to not encrypt"
    },
    {
      "Time_Start": 357.16,
      "Time_End": 361.86,
      "Text": " their firmware meaning we add access to all of the different files, file system, binaries,"
    },
    {
      "Time_Start": 361.88,
      "Time_End": 368.76,
      "Text": " configurations, etc. that are running inside our NAS device. Sadly this firmware was not a"
    },
    {
      "Time_Start": 368.76,
      "Time_End": 374.8,
      "Text": " full on uh file system meaning we had to pick and choose and reconstruct the file system"
    },
    {
      "Time_Start": 374.8,
      "Time_End": 379.0,
      "Text": " from the different sections. That is because all of the different sections contain different"
    },
    {
      "Time_Start": 379.0,
      "Time_End": 385.24,
      "Text": " files for the file system however they were not organized and not in the corresponding places."
    },
    {
      "Time_Start": 385.24,
      "Time_End": 390.18,
      "Text": " Luckily for us we looked at the few files inside the firmware and we found an init script"
    },
    {
      "Time_Start": 390.2,
      "Time_End": 395.88,
      "Text": " that actually reconstructed the firmware for us. This script is being ran whenever a"
    },
    {
      "Time_Start": 395.88,
      "Time_End": 401.08,
      "Text": " firmware upgrade procedure happens and then using a virtual machine and a true device we"
    },
    {
      "Time_Start": 401.08,
      "Time_End": 406.48,
      "Text": " were able to reconstruct and rebuild the firmware and run the web services. We now had"
    },
    {
      "Time_Start": 406.48,
      "Time_End": 411.52,
      "Text": " access to the NAS device even without ordering it and this actually gave us two main"
    },
    {
      "Time_Start": 411.52,
      "Time_End": 416.36,
      "Text": " benefits. First of all I was more well versed. I knew what kind of services were running,"
    },
    {
      "Time_Start": 416.38,
      "Time_End": 421.46000000000004,
      "Text": " what where are the configuration files, what binaries are actually being executed and even"
    },
    {
      "Time_Start": 421.46000000000004,
      "Time_End": 426.26,
      "Text": " more important I had a playground that I could break. I tend to break devices that I look at"
    },
    {
      "Time_Start": 426.26,
      "Time_End": 430.66,
      "Text": " and my boss has to reorder ones and he gets mad at me especially when they are super"
    },
    {
      "Time_Start": 430.66,
      "Time_End": 436.54,
      "Text": " expensive. So now I have a playground, I can just do whatever I want if I delete the whole"
    },
    {
      "Time_Start": 436.54,
      "Time_End": 442.24,
      "Text": " file system by accident which I did in a few researches in the past, no problem I'll just boot"
    },
    {
      "Time_Start": 442.26,
      "Time_End": 448.86,
      "Text": " up to the latest snapshot. Well let's take a look at the first part we looked at, the web"
    },
    {
      "Time_Start": 448.86,
      "Time_End": 453.8,
      "Text": " management architecture. This is the gist of it and let me explain to you. As I told you"
    },
    {
      "Time_Start": 453.8,
      "Time_End": 459.44,
      "Text": " before this was the main focus of researchers in the past where multiple vulnerabilities in"
    },
    {
      "Time_Start": 459.44,
      "Time_End": 464.28000000000003,
      "Text": " the PHP and CGI scripts were found and identified and actually exploited in the"
    },
    {
      "Time_Start": 464.28000000000003,
      "Time_End": 470.58,
      "Text": " Pwn2Own competition. In order to remediate that Western Digital had a genius idea of just"
    },
    {
      "Time_Start": 470.62,
      "Time_End": 476.0,
      "Text": " wrapping it all up in a Golang binary that actually authenticates and authorizes all any"
    },
    {
      "Time_Start": 476.0,
      "Time_End": 481.76,
      "Text": " request performed to the backends. This meant that even though we did and yeah we did find a"
    },
    {
      "Time_Start": 481.76,
      "Time_End": 485.94,
      "Text": " few vulnerabilities and remote code execution vulnerabilities in the web server, since"
    },
    {
      "Time_Start": 485.94,
      "Time_End": 490.79999999999995,
      "Text": " every request had to be authenticated it was not that useful in the Pwn2Own competition"
    },
    {
      "Time_Start": 490.79999999999995,
      "Time_End": 496.94,
      "Text": " because every request, every exploit should be unauthenticated. This meant that we had to"
    },
    {
      "Time_Start": 496.94,
      "Time_End": 502.02,
      "Text": " scrap this entire lead and look for new leads somewhere else and that's when we turned our"
    },
    {
      "Time_Start": 502.02,
      "Time_End": 507.21999999999997,
      "Text": " heads into the cloud features of the system. You see the cloud features especially in"
    },
    {
      "Time_Start": 507.21999999999997,
      "Time_End": 514.06,
      "Text": " Western Digital uh case are very very opted in and and prompted to users to enable them. It"
    },
    {
      "Time_Start": 514.06,
      "Time_End": 519.1,
      "Text": " is actually in the name of the device, my cloud and a lot most of the users actually enable"
    },
    {
      "Time_Start": 519.1,
      "Time_End": 524.08,
      "Text": " this feature and are able to access their files through the cloud services. All you need to"
    },
    {
      "Time_Start": 524.08,
      "Time_End": 528.48,
      "Text": " do is enable this tick and box right here which you are encouraged to do by Western Digital"
    },
    {
      "Time_Start": 528.48,
      "Time_End": 534.4000000000001,
      "Text": " user ex- user interface and then using uh an account, a cloud account you are able to"
    },
    {
      "Time_Start": 534.4000000000001,
      "Time_End": 539.0,
      "Text": " associate your account with your NAS device and now are able to access it through either the"
    },
    {
      "Time_Start": 539.0,
      "Time_End": 545.24,
      "Text": " mobile application or the web application of your choice. However when we realized that we"
    },
    {
      "Time_Start": 545.24,
      "Time_End": 550.7800000000001,
      "Text": " thought to ourselves how the hell does this magic happens? How am I navigated and routed to"
    },
    {
      "Time_Start": 550.78,
      "Time_End": 556.62,
      "Text": " my NAS device? Well like I've told you before whenever I'm using the Western Digital"
    },
    {
      "Time_Start": 556.62,
      "Time_End": 562.56,
      "Text": " application I am authenticated to my account and before I create my account I associate it"
    },
    {
      "Time_Start": 562.56,
      "Time_End": 569.56,
      "Text": " with my NAS device. Now each NAS device is identified by a unique GUID uh installation and"
    },
    {
      "Time_Start": 569.56,
      "Time_End": 575.5,
      "Text": " that way whenever I try to let's say access files I specify my GUID to Western Digital's"
    },
    {
      "Time_Start": 575.5,
      "Time_End": 581.44,
      "Text": " well cloud services and then behind the scenes somehow they route my request to my"
    },
    {
      "Time_Start": 581.44,
      "Time_End": 588.08,
      "Text": " corresponding NAS device and this tunnel is created. However we thought to ourselves what"
    },
    {
      "Time_Start": 588.08,
      "Time_End": 593.94,
      "Text": " would happen if some attacker knew my device's GUID and would try to use the API routes"
    },
    {
      "Time_Start": 593.94,
      "Time_End": 598.96,
      "Text": " and URLs to access my NAS device. Well we tried that and it didn't work so it's not that easy."
    },
    {
      "Time_Start": 599.4200000000001,
      "Time_End": 604.4200000000001,
      "Text": " However since we tried it on our device we opened TCP dump in the background and we"
    },
    {
      "Time_Start": 607.12,
      "Time_End": 613.1600000000001,
      "Text": " noticed something weird. You see the request was made to our device meaning we reached it"
    },
    {
      "Time_Start": 613.1600000000001,
      "Time_End": 619.34,
      "Text": " and instead of being blocked by the cloud application we were blocked by the NAS meaning we"
    },
    {
      "Time_Start": 619.34,
      "Time_End": 625.6800000000001,
      "Text": " actually reached one of its internal ports. Now this is quite crazy because my NAS sits at"
    },
    {
      "Time_Start": 625.7,
      "Time_End": 631.34,
      "Text": " home. It is not internet exposed, doesn't I didn't open any ports in the firewall and it"
    },
    {
      "Time_Start": 631.34,
      "Time_End": 636.72,
      "Text": " doesn't have an external IP address. Meaning somehow through Western Digital's servers I"
    },
    {
      "Time_Start": 636.72,
      "Time_End": 642.1200000000001,
      "Text": " was able to access my home network, my LAN home network and access one of the internal"
    },
    {
      "Time_Start": 642.1200000000001,
      "Time_End": 648.72,
      "Text": " services that are running there in my NAS device. When we realized that our game plan was"
    },
    {
      "Time_Start": 648.72,
      "Time_End": 654.5600000000001,
      "Text": " quite simple. I mean all we need to do is just know a device's GUID which is 128 random"
    },
    {
      "Time_Start": 654.58,
      "Time_End": 659.58,
      "Text": " bit uh GUID find somehow some authentication by bypasses and exploit some vulnerabilities to"
    },
    {
      "Time_Start": 662.2600000000001,
      "Time_End": 667.2600000000001,
      "Text": " run code on our device. Yeah pretty easy. So let's try and understand what is the use case"
    },
    {
      "Time_Start": 669.46,
      "Time_End": 675.44,
      "Text": " once again. You see this is the regular use case in the NAS architecture. It's a user trying"
    },
    {
      "Time_Start": 675.44,
      "Time_End": 680.5400000000001,
      "Text": " to access their NAS from anywhere around the world. However Western Digital also thought"
    },
    {
      "Time_Start": 680.56,
      "Time_End": 685.66,
      "Text": " about another use case. What happens when the user sits at home? Like so for example"
    },
    {
      "Time_Start": 685.66,
      "Time_End": 691.8,
      "Text": " sitting on couch and wanting to access their spicy movies. Well if they were able to"
    },
    {
      "Time_Start": 691.8,
      "Time_End": 697.0,
      "Text": " access if they needed to actually fetch the files over the cloud it means that there will be a"
    },
    {
      "Time_Start": 697.0,
      "Time_End": 702.74,
      "Text": " lot of latency and bad user experience and that's not actually very smart. So instead Western"
    },
    {
      "Time_Start": 702.74,
      "Time_End": 707.48,
      "Text": " Digital implemented this procedure right here. Whenever a user sits at home they are"
    },
    {
      "Time_Start": 707.52,
      "Time_End": 714.32,
      "Text": " redirected to their NAS device and then fetch files locally over the LAN access. However"
    },
    {
      "Time_Start": 714.32,
      "Time_End": 720.16,
      "Text": " somehow Western Digital had to make sure that the users were accessing a real the real"
    },
    {
      "Time_Start": 720.16,
      "Time_End": 726.28,
      "Text": " device and not let's say an attacker. How did they do that? Well in order to do that Western"
    },
    {
      "Time_Start": 726.28,
      "Time_End": 732.02,
      "Text": " Digital actually issued a unique certificate to each device and that way whenever I try to"
    },
    {
      "Time_Start": 732.02,
      "Time_End": 737.76,
      "Text": " access it I am able to make sure and check that I am indeed accessing my real device."
    },
    {
      "Time_Start": 737.76,
      "Time_End": 742.96,
      "Text": " However the keen eyed in you probably noticed something weird. What is that? As you can"
    },
    {
      "Time_Start": 742.96,
      "Time_End": 749.54,
      "Text": " see embedded in the certificate here it lies my device's GUID. This means that by simply"
    },
    {
      "Time_Start": 749.54,
      "Time_End": 756.0799999999999,
      "Text": " fetching and accessing my device through the HTTPS services I am able to get the device's"
    },
    {
      "Time_Start": 756.08,
      "Time_End": 761.08,
      "Text": " certificate and carve out the GUID through it. While this was pretty cool sadly our attack"
    },
    {
      "Time_Start": 763.96,
      "Time_End": 768.5200000000001,
      "Text": " scenario involves not being able to access the device meaning we want to access it through"
    },
    {
      "Time_Start": 768.5200000000001,
      "Time_End": 774.82,
      "Text": " the cloud so it's not pretty practical but maybe somehow we can improve it. Well that's when"
    },
    {
      "Time_Start": 774.82,
      "Time_End": 780.1,
      "Text": " we turn our heads and realized and try to realize how the hell does this redirect work? I"
    },
    {
      "Time_Start": 780.1,
      "Time_End": 785.34,
      "Text": " mean how does this message happens? Well you see Western Digital actually added a DNS"
    },
    {
      "Time_Start": 785.36,
      "Time_End": 791.14,
      "Text": " name for each NAS device and that way whenever I'm in local network it tries to access this"
    },
    {
      "Time_Start": 791.14,
      "Time_End": 796.14,
      "Text": " DNS name and this DNS name actually maps to an internal IP address of my device. That as"
    },
    {
      "Time_Start": 798.24,
      "Time_End": 803.9200000000001,
      "Text": " you can see I can use NS lookup on my device's name and that way when the result I see the"
    },
    {
      "Time_Start": 803.9200000000001,
      "Time_End": 809.4200000000001,
      "Text": " internal IP address of my device and that way I'm able to access it locally through the LAN"
    },
    {
      "Time_Start": 809.44,
      "Time_End": 815.5200000000001,
      "Text": " interface. However this meant that a DNS record was created and because it was created of"
    },
    {
      "Time_Start": 815.5200000000001,
      "Time_End": 822.1800000000001,
      "Text": " course we can exploit it and that's why using passive DNS servers we were able to retrieve old"
    },
    {
      "Time_Start": 822.1800000000001,
      "Time_End": 828.6600000000001,
      "Text": " DNS queries. You see some DNS servers actually sell the metadata of user requests uh that are"
    },
    {
      "Time_Start": 828.6600000000001,
      "Time_End": 834.1600000000001,
      "Text": " performed to their DNS servers to the highest bidder and sadly in the internet there are a"
    },
    {
      "Time_Start": 834.18,
      "Time_End": 840.38,
      "Text": " lot of APIs and servers that allow users to search for old DNS queries user performed uh in"
    },
    {
      "Time_Start": 840.38,
      "Time_End": 845.38,
      "Text": " order to basically get access to what kind of DNS queries user used. And because we the"
    },
    {
      "Time_Start": 848.26,
      "Time_End": 854.5,
      "Text": " GUID is in this DNS record we are able to retrieve it. And as you can see it's not a one off,"
    },
    {
      "Time_Start": 854.5,
      "Time_End": 860.0,
      "Text": " we actually see tens of thousands of different DNS records meaning we now had access to"
    },
    {
      "Time_Start": 860.02,
      "Time_End": 865.02,
      "Text": " tens of thousands uh uh GUIDs. Sadly when we tried accessing uh actually accessing this GUID"
    },
    {
      "Time_Start": 867.62,
      "Time_End": 872.46,
      "Text": " through Western Digital's cloud most of them were already dead and disconnected. That's"
    },
    {
      "Time_Start": 872.46,
      "Time_End": 877.04,
      "Text": " because we don't know when the re DNS record was created and there were no login"
    },
    {
      "Time_Start": 877.04,
      "Time_End": 882.34,
      "Text": " coordinated anyways. Uh this meant we no didn't actually have ten thousand records. However"
    },
    {
      "Time_Start": 882.34,
      "Time_End": 887.34,
      "Text": " we had a good lead into actually improving the amount of the uh GUIDs we know of. That's"
    },
    {
      "Time_Start": 888.08,
      "Time_End": 894.5600000000001,
      "Text": " when we realized that because the certificate is issued to every device, every connected"
    },
    {
      "Time_Start": 894.5600000000001,
      "Time_End": 899.76,
      "Text": " device and this certificate contains the device GUID maybe we can use what's called"
    },
    {
      "Time_Start": 899.76,
      "Time_End": 904.9,
      "Text": " certificate harvesting. Similar to the passive DNS servers there are a lot of servers"
    },
    {
      "Time_Start": 904.9,
      "Time_End": 910.7,
      "Text": " offering the ability of you to users to look for say certificates they encounter and look"
    },
    {
      "Time_Start": 910.7,
      "Time_End": 915.88,
      "Text": " for patterns uh in the certificate name. For example we use census which boasts they have"
    },
    {
      "Time_Start": 915.88,
      "Time_End": 921.02,
      "Text": " over 6 billion certificates in their databases allowing users to query and fetch these"
    },
    {
      "Time_Start": 921.02,
      "Time_End": 926.7,
      "Text": " certificates. When we tried and grabbed for Western Digital pattern we realized something"
    },
    {
      "Time_Start": 926.7,
      "Time_End": 932.34,
      "Text": " shocking. There was over 1.5 million devices just in the last 3 months and now we had the"
    },
    {
      "Time_Start": 932.34,
      "Time_End": 936.68,
      "Text": " knowledge of every one of these devices GUID meaning we were able to access them through"
    },
    {
      "Time_Start": 936.68,
      "Time_End": 942.78,
      "Text": " Western Digital's uh cloud platforms. However sadly in the Pwn2Own competition you have to"
    },
    {
      "Time_Start": 942.78,
      "Time_End": 948.66,
      "Text": " do it live meaning we cannot uh know the GUID in advance and our devices connected in real"
    },
    {
      "Time_Start": 948.66,
      "Time_End": 955.4,
      "Text": " time. This meant we had to somehow get access to GUID and get knowledge of GUIDs in real time."
    },
    {
      "Time_Start": 955.4,
      "Time_End": 959.56,
      "Text": " That's when we discovered something pretty cool which I wasn't aware of in the past which"
    },
    {
      "Time_Start": 959.56,
      "Time_End": 965.6999999999999,
      "Text": " called which is called CTL. Certificate Transparency Log. You see there was kind of a"
    },
    {
      "Time_Start": 965.6999999999999,
      "Time_End": 970.3199999999999,
      "Text": " specification called CTL in the internet uh with the goal of improving security and"
    },
    {
      "Time_Start": 970.32,
      "Time_End": 976.22,
      "Text": " visibility in the internet. What CTL means is that whenever a cert certificate authority a"
    },
    {
      "Time_Start": 976.22,
      "Time_End": 982.7,
      "Text": " CA issues a new certificate it sends the metadata about this certificate to a live public"
    },
    {
      "Time_Start": 982.7,
      "Time_End": 987.7,
      "Text": " feed allowing users to simply subscribe to this feed and get knowledge of the certificate"
    },
    {
      "Time_Start": 987.7,
      "Time_End": 994.34,
      "Text": " being issued. Issued mainly the certificate CN and of course the validity date et cetera."
    },
    {
      "Time_Start": 994.34,
      "Time_End": 1000.74,
      "Text": " Luckily for us the there are many tools that enable us to subscribe to the CTL feed and using"
    },
    {
      "Time_Start": 1000.74,
      "Time_End": 1006.1800000000001,
      "Text": " them we were able to subscribe to the CTL feed and grab for Western Digital pattern and that"
    },
    {
      "Time_Start": 1006.1800000000001,
      "Time_End": 1011.62,
      "Text": " way we were able to get a device's GUIDs whenever they actually connected to the uh network"
    },
    {
      "Time_Start": 1011.62,
      "Time_End": 1016.46,
      "Text": " in the first time. Meaning we had the ability to leak GUID and leak the knowledge of the"
    },
    {
      "Time_Start": 1016.46,
      "Time_End": 1022.76,
      "Text": " device's GUID in real time whenever it connected. And we simply did it for a few days and we"
    },
    {
      "Time_Start": 1022.76,
      "Time_End": 1027.52,
      "Text": " actually got amazing results getting us tens of thousands of different device's GUIDs which"
    },
    {
      "Time_Start": 1027.52,
      "Time_End": 1033.2,
      "Text": " we were able to access through the loophole and through the exposed APIs in Western Digital's"
    },
    {
      "Time_Start": 1033.2,
      "Time_End": 1039.2,
      "Text": " cloud services. Cool. That meant that instead of breaking a device's GUID we simply leaked"
    },
    {
      "Time_Start": 1039.2,
      "Time_End": 1045.04,
      "Text": " all of them and we now had the knowledge of every device GUID worldwide. The next thing we"
    },
    {
      "Time_Start": 1045.04,
      "Time_End": 1050.04,
      "Text": " had to do is find some kind of an out bypass. Well since we are a community in O'Rourke we"
    },
    {
      "Time_Start": 1050.2,
      "Time_End": 1057.7,
      "Text": " simply asked someone hey can we uh can we use your device? We promised not to break it and"
    },
    {
      "Time_Start": 1057.7,
      "Time_End": 1063.74,
      "Text": " luckily we didn't uh so we didn't have to buy him a new one. Uh so we tried basically"
    },
    {
      "Time_Start": 1063.74,
      "Time_End": 1069.28,
      "Text": " accessing the device's GUID using our own authenticated account. So all we did was simply"
    },
    {
      "Time_Start": 1069.28,
      "Time_End": 1075.22,
      "Text": " open up our web browser connecting to our account and simply stop the request and change the"
    },
    {
      "Time_Start": 1075.24,
      "Time_End": 1081.84,
      "Text": " device's GUID from our own to the GUID we wanted to test our theories on. And that's when we"
    },
    {
      "Time_Start": 1081.84,
      "Time_End": 1088.56,
      "Text": " realized that some API routes actually worked. As you can see here we are fetching a file ID"
    },
    {
      "Time_Start": 1088.56,
      "Time_End": 1094.16,
      "Text": " of a device we do not own and are not associated with. All we did was simply change the GUID"
    },
    {
      "Time_Start": 1094.16,
      "Time_End": 1100.0,
      "Text": " and some API routes just worked. That's pretty crazy and pretty lucky. As it turns out Western"
    },
    {
      "Time_Start": 1100.02,
      "Time_End": 1105.28,
      "Text": " Digital only checked for authentication instead of authorization. Meaning as long as I have a"
    },
    {
      "Time_Start": 1105.28,
      "Time_End": 1112.22,
      "Text": " valid user session and is connected to my account I can access anyone NAS through some API"
    },
    {
      "Time_Start": 1112.22,
      "Time_End": 1117.6,
      "Text": " routes by simply changing the device's GUID. That meant we now had access to everyone's"
    },
    {
      "Time_Start": 1117.6,
      "Time_End": 1123.3,
      "Text": " sensitive files. We could for example view them, change them, leak them, do whatever we want"
    },
    {
      "Time_Start": 1123.3,
      "Time_End": 1126.84,
      "Text": " and that's pretty cool."
    },
    {
      "Time_Start": 1126.84,
      "Time_End": 1131.84,
      "Text": " Yeah that's pretty lucky. However sadly around 2 months, 2 weeks before the competitions I"
    },
    {
      "Time_Start": 1140.02,
      "Time_End": 1146.8,
      "Text": " tried my scripts which worked perfectly I swear and they stopped working. Something changed"
    },
    {
      "Time_Start": 1146.8,
      "Time_End": 1152.6399999999999,
      "Text": " in Western Digital backends and the authorization check was added which was pretty sad because"
    },
    {
      "Time_Start": 1152.64,
      "Time_End": 1158.3400000000001,
      "Text": " it took uh many months of uh work down the drain and we just had to find some new"
    },
    {
      "Time_Start": 1158.3400000000001,
      "Time_End": 1163.3400000000001,
      "Text": " vulnerabilities. That's when I said oh fuck I'll have to do some overnights and yeah let's go"
    },
    {
      "Time_Start": 1165.1200000000001,
      "Time_End": 1170.1200000000001,
      "Text": " again. Well since I exhausted the API routes lead I thought to myself yeah I need to go back"
    },
    {
      "Time_Start": 1172.8200000000002,
      "Time_End": 1178.4,
      "Text": " to the source and look for the main binary handling cloud connection. In Western Digital"
    },
    {
      "Time_Start": 1178.4,
      "Time_End": 1183.96,
      "Text": " case it was a binary called REST SDK. This binary actually binded on the device and"
    },
    {
      "Time_Start": 1183.96,
      "Time_End": 1189.5,
      "Text": " connected to Western Digital proxy servers and handled most of the cloud functionality like"
    },
    {
      "Time_Start": 1189.5,
      "Time_End": 1195.5800000000002,
      "Text": " fetching files, changing files, et cetera. Sadly this binary is written in Golang which I"
    },
    {
      "Time_Start": 1195.5800000000002,
      "Time_End": 1200.38,
      "Text": " personally hate because it's huge. It has tons of different functions and tons of different"
    },
    {
      "Time_Start": 1200.38,
      "Time_End": 1205.92,
      "Text": " layers of instruction making reverse engineering pretty sad and boring. Uh and of course"
    },
    {
      "Time_Start": 1205.94,
      "Time_End": 1210.3400000000001,
      "Text": " since it's written in Golang there is less attack surface cause the memory is managed by"
    },
    {
      "Time_Start": 1210.3400000000001,
      "Time_End": 1215.3600000000001,
      "Text": " Golang itself. A lot of APIs are secure by default uh and there's less uh error place for"
    },
    {
      "Time_Start": 1217.6200000000001,
      "Time_End": 1222.6200000000001,
      "Text": " developers to make mistakes. So in order to avoid reverse engineering as much as possible"
    },
    {
      "Time_Start": 1224.96,
      "Time_End": 1229.94,
      "Text": " all I had to do was simply create a man in the middle setup between me and the device,"
    },
    {
      "Time_Start": 1229.94,
      "Time_End": 1234.5,
      "Text": " between the device and the cloud. Meaning whenever the cloud uh tries to interact with my"
    },
    {
      "Time_Start": 1234.52,
      "Time_End": 1240.06,
      "Text": " device or vice versa I will be able to view the traffic uh and see what's happening"
    },
    {
      "Time_Start": 1240.06,
      "Time_End": 1244.72,
      "Text": " behind the scenes. We did it through many methods, mainly uh adding a certificate"
    },
    {
      "Time_Start": 1244.72,
      "Time_End": 1250.3,
      "Text": " authority uh CA that we control on the device locally and that way we could basically"
    },
    {
      "Time_Start": 1250.3,
      "Time_End": 1255.44,
      "Text": " man in the middle HTTPS requests just making the device trust our CA and issuing device"
    },
    {
      "Time_Start": 1255.44,
      "Time_End": 1261.84,
      "Text": " certificates on the fly. However that way we were able to view and see the requests in real"
    },
    {
      "Time_Start": 1261.8799999999999,
      "Time_End": 1268.52,
      "Text": " time and see what's happening at any time whatsoever. And when we through when we had this"
    },
    {
      "Time_Start": 1268.52,
      "Time_End": 1274.6599999999999,
      "Text": " ability our first goal was simply understanding how the hell does the tunnel pre proxy"
    },
    {
      "Time_Start": 1274.6599999999999,
      "Time_End": 1280.9399999999998,
      "Text": " creation happens. How my device connects to the cloud and informs it hey I'm this and that"
    },
    {
      "Time_Start": 1280.9399999999998,
      "Time_End": 1286.28,
      "Text": " device please redirect users to me. And through the process of man in the middle and"
    },
    {
      "Time_Start": 1286.28,
      "Time_End": 1291.62,
      "Text": " reverse engineering we reached this conclusion. The first thing happen that happens is my"
    },
    {
      "Time_Start": 1291.6200000000001,
      "Time_End": 1297.6000000000001,
      "Text": " device connecting to western digital proxy servers over TLS connection. The minute the"
    },
    {
      "Time_Start": 1297.6000000000001,
      "Time_End": 1303.8000000000002,
      "Text": " device connects the cloud says hey cool I want to create a proxy connection and fetches"
    },
    {
      "Time_Start": 1303.8000000000002,
      "Time_End": 1308.8200000000002,
      "Text": " in HTTP2 an API route on my device. The API my device then says yeah okay I'm ready to"
    },
    {
      "Time_Start": 1311.48,
      "Time_End": 1317.96,
      "Text": " connect and simply hands over the device's GUIDs saying hey I'm GUID please connect me."
    },
    {
      "Time_Start": 1317.96,
      "Time_End": 1324.7,
      "Text": " Then the cloud says great let's connect and the tunnel is created. Now the minute we saw"
    },
    {
      "Time_Start": 1324.7,
      "Time_End": 1330.68,
      "Text": " that we were like wait what the fuck? Where the hell are the secrets? I mean the end all the"
    },
    {
      "Time_Start": 1330.68,
      "Time_End": 1337.18,
      "Text": " end all the things that my device sent to the cloud was my device's GUID which like I've"
    },
    {
      "Time_Start": 1337.18,
      "Time_End": 1342.58,
      "Text": " showcased to you before is god damn public knowledge meaning it is actually exposed on my"
    },
    {
      "Time_Start": 1342.58,
      "Time_End": 1348.8799999999999,
      "Text": " device's certificate. This meant that by simply knowing a device's GUID we could try and"
    },
    {
      "Time_Start": 1348.8799999999999,
      "Time_End": 1354.4199999999998,
      "Text": " impersonate it and that is exactly what we did. Meaning we went to western digital proxy"
    },
    {
      "Time_Start": 1354.4199999999998,
      "Time_End": 1360.32,
      "Text": " servers and simply connected saying hey I'd like to connect I am this and that GUID. And the"
    },
    {
      "Time_Start": 1360.32,
      "Time_End": 1366.24,
      "Text": " minute we did that the server actually trusted that and said yeah I'm ready to uh initiate"
    },
    {
      "Time_Start": 1366.24,
      "Time_End": 1371.6799999999998,
      "Text": " the connection and disconnected the real device. Meaning that whenever a user tries to"
    },
    {
      "Time_Start": 1371.68,
      "Time_End": 1376.68,
      "Text": " connect to a to their device now they would be redirected to us. That is pretty crazy"
    },
    {
      "Time_Start": 1379.0800000000002,
      "Time_End": 1385.16,
      "Text": " because now we were able to impersonate a device and act as it. However what was even crazier"
    },
    {
      "Time_Start": 1385.16,
      "Time_End": 1391.92,
      "Text": " was what happened next. You see the minute we authenticated and created a tunnel this"
    },
    {
      "Time_Start": 1391.92,
      "Time_End": 1398.1000000000001,
      "Text": " request reached us. As you can see this is an HTTP request from the client saying hey I"
    },
    {
      "Time_Start": 1398.1200000000001,
      "Time_End": 1403.22,
      "Text": " want to refresh the volumes on my NAS device. However what's crazy is that it actually"
    },
    {
      "Time_Start": 1403.22,
      "Time_End": 1409.7,
      "Text": " contains the user authentication token. We didn't we were actually pretty stumped at first"
    },
    {
      "Time_Start": 1409.7,
      "Time_End": 1415.18,
      "Text": " saying yeah we didn't make this request. However upon further investigation we realized that"
    },
    {
      "Time_Start": 1415.18,
      "Time_End": 1420.42,
      "Text": " in order to make sure everything is up to date and uh users have bad good user experience"
    },
    {
      "Time_Start": 1420.42,
      "Time_End": 1426.0600000000002,
      "Text": " western digital performs background app refresh. Meaning constantly in the background the"
    },
    {
      "Time_Start": 1426.08,
      "Time_End": 1431.6799999999998,
      "Text": " API the client connects to the NAS and says hey please refresh the files and give me access"
    },
    {
      "Time_Start": 1431.6799999999998,
      "Time_End": 1437.52,
      "Text": " to my newer files. And because of that a new request is made every ten seconds or so. This"
    },
    {
      "Time_Start": 1437.52,
      "Time_End": 1443.56,
      "Text": " meant that whenever the minute we stole a device's tunnel uh we got a request from the user"
    },
    {
      "Time_Start": 1443.56,
      "Time_End": 1447.8,
      "Text": " containing the user token and this actually meant that the minute we stole the device's"
    },
    {
      "Time_Start": 1447.8,
      "Time_End": 1454.1799999999998,
      "Text": " tunnel we have authenti- authenticated administrative tokens to that device. This meant"
    },
    {
      "Time_Start": 1454.2,
      "Time_End": 1459.7,
      "Text": " that once again by impersonating the device we could access everyone's file around the world"
    },
    {
      "Time_Start": 1459.7,
      "Time_End": 1464.7,
      "Text": " giving us full administrative access to every NAS device western digital implodes."
    },
    {
      "Time_Start": 1464.7,
      "Time_End": 1469.7,
      "Text": " Thank you. Yeah that we actually did it we actually got this access twice in 2 months which I"
    },
    {
      "Time_Start": 1474.8200000000002,
      "Time_End": 1479.8200000000002,
      "Text": " think is a personal record for me. So after we gained administrative access the next step"
    },
    {
      "Time_Start": 1479.8999999999999,
      "Time_End": 1484.8999999999999,
      "Text": " was simply finding an RCE which Sharon will present to you now. Great uh so just let let's"
    },
    {
      "Time_Start": 1491.3999999999999,
      "Time_End": 1496.8799999999999,
      "Text": " reiterate real quick uh we were able to leak all the GUIDs all the device identifications"
    },
    {
      "Time_Start": 1496.8799999999999,
      "Time_End": 1503.82,
      "Text": " from every western digital uh cloud connected device and we used it um because of a flaw in"
    },
    {
      "Time_Start": 1503.82,
      "Time_End": 1510.74,
      "Text": " their archi- cloud architecture we we used it uh to basically find a bypass to their"
    },
    {
      "Time_Start": 1510.74,
      "Time_End": 1515.74,
      "Text": " authentication and reach the devices. So we first impersonated the devices once we"
    },
    {
      "Time_Start": 1518.28,
      "Time_End": 1524.9399999999998,
      "Text": " impersonated the devices we got redirection and uh we got requests from real users with"
    },
    {
      "Time_Start": 1524.9399999999998,
      "Time_End": 1529.96,
      "Text": " their tokens and we now were able to impersonate the users. So basically uh we had admin"
    },
    {
      "Time_Start": 1530.96,
      "Time_End": 1535.96,
      "Text": " access in while impersonating users we had admin access to their devices uh because"
    },
    {
      "Time_Start": 1539.8400000000001,
      "Time_End": 1545.54,
      "Text": " after we created the tunnel impersonate the real the devices we got the tokens and we"
    },
    {
      "Time_Start": 1545.54,
      "Time_End": 1551.72,
      "Text": " disconnected our tunnel and we were able to connect to the the real device tunnel. But"
    },
    {
      "Time_Start": 1551.72,
      "Time_End": 1556.92,
      "Text": " sadly we wanted remote code execution and admin access admin web access does not mean"
    },
    {
      "Time_Start": 1556.92,
      "Time_End": 1561.92,
      "Text": " remote code execution. So we had to come up with new ways to leverage our admin access to"
    },
    {
      "Time_Start": 1565.3000000000002,
      "Time_End": 1570.3000000000002,
      "Text": " remote code execution. So we turned out we turned to the REST SDK uh binary once again and"
    },
    {
      "Time_Start": 1573.5,
      "Time_End": 1578.8000000000002,
      "Text": " we had a lot of new surface to research now because we were fully authenticated."
    },
    {
      "Time_Start": 1578.8000000000002,
      "Time_End": 1584.42,
      "Text": " Previously when we researched this binary we looked only on pre-authenticated routes and"
    },
    {
      "Time_Start": 1584.42,
      "Time_End": 1589.92,
      "Text": " APIs and as Noah mentioned this was a Golang so it was very difficult and uh time consuming"
    },
    {
      "Time_Start": 1589.92,
      "Time_End": 1594.92,
      "Text": " to to go over all the functions um but we now had new uh new vector uh authenticated vector"
    },
    {
      "Time_Start": 1597.3600000000001,
      "Time_End": 1604.04,
      "Text": " so it was very important for us to cover more APIs and more routes. Uh the first one of the"
    },
    {
      "Time_Start": 1604.04,
      "Time_End": 1610.3000000000002,
      "Text": " first routes we looked at uh was the shares, shares and mounts. So we're talking about a NAS"
    },
    {
      "Time_Start": 1610.32,
      "Time_End": 1615.32,
      "Text": " device now. Obviously a NAS device uh main goal is to store your your files and make sure you"
    },
    {
      "Time_Start": 1617.6599999999999,
      "Time_End": 1623.54,
      "Text": " have the ability to read those files and write those files. So basically when you open the"
    },
    {
      "Time_Start": 1623.54,
      "Time_End": 1629.3799999999999,
      "Text": " the platform the web platform or the mobile application you see uh directories from your"
    },
    {
      "Time_Start": 1629.3799999999999,
      "Time_End": 1634.98,
      "Text": " hard drives inside the NAS. And obviously the goal of the NAS again is to let you the ability"
    },
    {
      "Time_Start": 1635.0,
      "Time_End": 1641.4,
      "Text": " to read and write files from these directories. What we discovered by reverse engineering"
    },
    {
      "Time_Start": 1641.4,
      "Time_End": 1646.4,
      "Text": " these routes is behind the scene the NAS operating system has SIM links to directories inside"
    },
    {
      "Time_Start": 1648.98,
      "Time_End": 1655.24,
      "Text": " the hard drives so whenever you see for example pub public directory in the web interface or"
    },
    {
      "Time_Start": 1655.24,
      "Time_End": 1661.92,
      "Text": " the mobile application basically shows you the content of slash HD slash HD whatever and"
    },
    {
      "Time_Start": 1661.96,
      "Time_End": 1666.96,
      "Text": " then public. So we thought what happens if we had the capability to switch this SIM link to"
    },
    {
      "Time_Start": 1670.04,
      "Time_End": 1675.88,
      "Text": " for example slash. This means that we will see on the web interface which you have access to"
    },
    {
      "Time_Start": 1675.88,
      "Time_End": 1680.88,
      "Text": " because we're now user authenticated we will see files from slash and indeed we find a way"
    },
    {
      "Time_Start": 1683.42,
      "Time_End": 1688.42,
      "Text": " undocumented way to modify change um the routes the mounting points on the device simply"
    },
    {
      "Time_Start": 1688.9,
      "Time_End": 1693.9,
      "Text": " by using the the file system API. We could now change directories change their their"
    },
    {
      "Time_Start": 1698.6000000000001,
      "Time_End": 1704.4,
      "Text": " mounting points to different directories and we actually tried it and it worked. So for"
    },
    {
      "Time_Start": 1704.4,
      "Time_End": 1711.1200000000001,
      "Text": " example here we created a new share which is mapped to slash temp and we simply saw files"
    },
    {
      "Time_Start": 1711.1200000000001,
      "Time_End": 1715.88,
      "Text": " and directories from slash temp on the device. Previously we could not do this because"
    },
    {
      "Time_Start": 1715.88,
      "Time_End": 1721.7600000000002,
      "Text": " these files and directories uh were not allowed to be accessed from the mobile application"
    },
    {
      "Time_Start": 1721.7600000000002,
      "Time_End": 1727.3600000000001,
      "Text": " or or obviously the mobile application the web web interface only wanted to show you files"
    },
    {
      "Time_Start": 1727.3600000000001,
      "Time_End": 1733.8400000000001,
      "Text": " that you can interact with from your hard drive. So it was pretty crazy because we had"
    },
    {
      "Time_Start": 1733.8400000000001,
      "Time_End": 1740.0400000000002,
      "Text": " write read and write primitive because we just had access to any directory we wanted on the"
    },
    {
      "Time_Start": 1740.04,
      "Time_End": 1745.04,
      "Text": " device. The truth is we did not have unlimited read and write access uh because the file"
    },
    {
      "Time_Start": 1748.28,
      "Time_End": 1753.76,
      "Text": " system had some restrictions to where files can be written uh some directories and some"
    },
    {
      "Time_Start": 1753.76,
      "Time_End": 1760.26,
      "Text": " mounting points were read only so for example we could not overwrite binaries on the device"
    },
    {
      "Time_Start": 1760.26,
      "Time_End": 1765.26,
      "Text": " uh so we had to be very creative to think how can we leverage this primitive read and write"
    },
    {
      "Time_Start": 1765.26,
      "Time_End": 1771.16,
      "Text": " primitive into a remote code execution. For example one of the things we thought of is maybe"
    },
    {
      "Time_Start": 1771.16,
      "Time_End": 1777.5,
      "Text": " we could we could download the device configuration modify it for example to change uh where"
    },
    {
      "Time_Start": 1777.5,
      "Time_End": 1783.58,
      "Text": " the device downloads the firmware from and then rewrite the configuration. However we found"
    },
    {
      "Time_Start": 1783.58,
      "Time_End": 1788.58,
      "Text": " an easier way. One of the routes we also looked at is the do reboot. So users western"
    },
    {
      "Time_Start": 1789.08,
      "Time_End": 1794.08,
      "Text": " digital users can go to their uh cloud platform and reboot their devices remotely. So since we"
    },
    {
      "Time_Start": 1798.58,
      "Time_End": 1804.96,
      "Text": " had the user token we could do this on behalf of the user so we could basically initiate uh a"
    },
    {
      "Time_Start": 1804.96,
      "Time_End": 1810.76,
      "Text": " reboot process on the device. Now what we found out is the reboot process is not that"
    },
    {
      "Time_Start": 1810.76,
      "Time_End": 1817.0,
      "Text": " straightforward on the devices so it's not just doing reboot it actually activating a"
    },
    {
      "Time_Start": 1817.02,
      "Time_End": 1822.02,
      "Text": " specific binary called do reboot. And as it turned out this binary does more things than just"
    },
    {
      "Time_Start": 1824.8,
      "Time_End": 1829.8,
      "Text": " rebooting the device. For example it reads files from the slash temp directory and it parses"
    },
    {
      "Time_Start": 1832.5,
      "Time_End": 1838.28,
      "Text": " them and uses the parsed data somehow. Western digital did this because there are many"
    },
    {
      "Time_Start": 1838.28,
      "Time_End": 1844.98,
      "Text": " ways uh or many uh many times you'll the device will want to do reboot based on different"
    },
    {
      "Time_Start": 1845.0,
      "Time_End": 1851.04,
      "Text": " states. For example it wants to initiate auto reboot whenever there is a firmware upgrade. So"
    },
    {
      "Time_Start": 1851.04,
      "Time_End": 1856.04,
      "Text": " it needs to read these uh states from somewhere and they decided to use files on slash temp."
    },
    {
      "Time_Start": 1858.52,
      "Time_End": 1865.32,
      "Text": " So what we did is we investigated these uh code path in the binary and we found that we can"
    },
    {
      "Time_Start": 1865.32,
      "Time_End": 1872.32,
      "Text": " write a file to slash temp in a way that will give us some injection point into a system"
    },
    {
      "Time_Start": 1872.34,
      "Time_End": 1879.1399999999999,
      "Text": " command which will be which will get executed. So now we have the ability to execute code on"
    },
    {
      "Time_Start": 1879.1399999999999,
      "Time_End": 1884.1399999999999,
      "Text": " the device if we are authenticated which we were um and we had our chain complete. So I would"
    },
    {
      "Time_Start": 1886.4199999999998,
      "Time_End": 1892.4199999999998,
      "Text": " like to go over uh the the full chain. Basically it starts with us leaking GUIDs of all the"
    },
    {
      "Time_Start": 1892.4199999999998,
      "Time_End": 1898.9199999999998,
      "Text": " devices in the world uh and we can even do this real time as now mentioned by getting the"
    },
    {
      "Time_Start": 1898.96,
      "Time_End": 1903.96,
      "Text": " CTL feed and we used it to impersonate real device and get user tokens whenever they auto"
    },
    {
      "Time_Start": 1908.6000000000001,
      "Time_End": 1915.04,
      "Text": " reconnect to the tunnel. Then we're using the user token to connect to the real tunnel to the"
    },
    {
      "Time_Start": 1915.04,
      "Time_End": 1921.24,
      "Text": " real device and we're creating new mounting points and then we're writing file to the slash"
    },
    {
      "Time_Start": 1921.24,
      "Time_End": 1927.1200000000001,
      "Text": " temp and getting uh and doing reboot and getting code execution. So let's see it uh full"
    },
    {
      "Time_Start": 1927.1200000000001,
      "Time_End": 1932.1200000000001,
      "Text": " scale. Now the user first of all the real user is connected to the device and we as attackers"
    },
    {
      "Time_Start": 1934.3600000000001,
      "Time_End": 1939.3600000000001,
      "Text": " want to get their uh device so we're impersonating the device by telling the cloud hey we're"
    },
    {
      "Time_Start": 1941.7600000000002,
      "Time_End": 1947.4,
      "Text": " this device identification the GUID and at the moment we're doing this the cloud will"
    },
    {
      "Time_Start": 1947.4,
      "Time_End": 1952.42,
      "Text": " disconnect the real tunnel and connect us. Whenever it happens the user auto reconnects either"
    },
    {
      "Time_Start": 1953.3600000000001,
      "Time_End": 1958.3600000000001,
      "Text": " using their tokens to our device to the our impersonated device and now we can impersonate"
    },
    {
      "Time_Start": 1962.2,
      "Time_End": 1968.14,
      "Text": " the user. So we're cancelling the tunnel and waiting for the real device to issue new"
    },
    {
      "Time_Start": 1968.14,
      "Time_End": 1974.74,
      "Text": " tunnel and we're using the token to actually connect to the real device. Next we're uh"
    },
    {
      "Time_Start": 1974.74,
      "Time_End": 1980.72,
      "Text": " creating new mounting point to point at slash temp and we are writing our file which will be"
    },
    {
      "Time_Start": 1980.72,
      "Time_End": 1985.72,
      "Text": " parsed and be used in the reboot process finally giving us a reverse shell. And and this is"
    },
    {
      "Time_Start": 1996.0,
      "Time_End": 2002.88,
      "Text": " exactly what we did in Pwn2Own so we got uh on top of the reverse shell we got also 40K so it"
    },
    {
      "Time_Start": 2002.88,
      "Time_End": 2007.88,
      "Text": " was nice. Uh we we used it to hack a device in Pwn2Own but basically we used it to hack"
    },
    {
      "Time_Start": 2010.72,
      "Time_End": 2016.66,
      "Text": " we were not limited to just Pwn2Own or or a single device. We could exploit any device that"
    },
    {
      "Time_Start": 2016.66,
      "Time_End": 2023.26,
      "Text": " we know the its device identification the GUID and we had thousands of of them maybe maybe"
    },
    {
      "Time_Start": 2023.26,
      "Time_End": 2030.16,
      "Text": " millions so it was a great power and with great power comes great responsibility so uh"
    },
    {
      "Time_Start": 2030.16,
      "Time_End": 2034.3,
      "Text": " obviously we reported this to Western Digital and we worked with them until everything was"
    },
    {
      "Time_Start": 2034.32,
      "Time_End": 2039.32,
      "Text": " resolved. Now we uh we had a concept in our hands so basically uh we had the concept of"
    },
    {
      "Time_Start": 2043.7,
      "Time_End": 2049.5,
      "Text": " impersonating an IOT device and using and leverage this impersonation to do something on"
    },
    {
      "Time_Start": 2049.5,
      "Time_End": 2054.38,
      "Text": " behalf of the device. In this case in the Western Digital case it was impersonating a device"
    },
    {
      "Time_Start": 2054.38,
      "Time_End": 2061.08,
      "Text": " and waiting to get the user token to use it. But since we competed in Pwn2Own we wanted to"
    },
    {
      "Time_Start": 2061.1,
      "Time_End": 2066.7599999999998,
      "Text": " leverage this for Synology as well. So let's go over in real quick uh what we did in"
    },
    {
      "Time_Start": 2066.7599999999998,
      "Time_End": 2071.7799999999997,
      "Text": " Synology. So for Synology we researched the DS920 uh this is very similar device uh to the"
    },
    {
      "Time_Start": 2074.18,
      "Time_End": 2079.18,
      "Text": " WAD uh it's also Linux based with 86 architecture 64 bit uh and it had um a really fully"
    },
    {
      "Time_Start": 2083.3199999999997,
      "Time_End": 2088.3199999999997,
      "Text": " featured web interface uh running CGI's written in C++. Um behind the scene the web"
    },
    {
      "Time_Start": 2088.7000000000003,
      "Time_End": 2093.7000000000003,
      "Text": " server is Nginx and it has a very rich configuration that we could play with uh but we"
    },
    {
      "Time_Start": 2096.7000000000003,
      "Time_End": 2102.48,
      "Text": " could not find any straight forward pre-authenticated uh remote code execution uh chains"
    },
    {
      "Time_Start": 2102.48,
      "Time_End": 2107.48,
      "Text": " so we turned out to the cloud. Now similar to previous uh device with Synology has uh a"
    },
    {
      "Time_Start": 2110.38,
      "Time_End": 2115.86,
      "Text": " fully featured cloud called Quick Connect so basically if anyone wants to reach their"
    },
    {
      "Time_Start": 2115.86,
      "Time_End": 2120.86,
      "Text": " device they'll go to quickconnect.to and will enter their device alias. How do you get"
    },
    {
      "Time_Start": 2123.28,
      "Time_End": 2128.28,
      "Text": " your device alias? You first need to authenticate on the device itself and associate the"
    },
    {
      "Time_Start": 2130.6800000000003,
      "Time_End": 2136.6200000000003,
      "Text": " device with your Synology user. Whenever you do this uh in the web configuration on the"
    },
    {
      "Time_Start": 2136.6200000000003,
      "Time_End": 2143.06,
      "Text": " device itself you uh basically exchange a couple of uh tokens and API's on the device and"
    },
    {
      "Time_Start": 2143.06,
      "Time_End": 2149.4,
      "Text": " now the device is capable to connect to the cloud uh and be associated with the alias you"
    },
    {
      "Time_Start": 2149.4,
      "Time_End": 2154.4,
      "Text": " give it. So very simply how it works whenever a user go goes to quick connect um and wants"
    },
    {
      "Time_Start": 2157.74,
      "Time_End": 2162.74,
      "Text": " to initiate uh connection to their device they will they will go to alias.quickconnect.to"
    },
    {
      "Time_Start": 2165.42,
      "Time_End": 2170.42,
      "Text": " and the cloud will relay uh the request to the device and basically will tell the device"
    },
    {
      "Time_Start": 2171.42,
      "Time_End": 2176.42,
      "Text": " to open a VPN tunnel. So whenever the Synology quick connect cloud receives the request it"
    },
    {
      "Time_Start": 2178.86,
      "Time_End": 2183.86,
      "Text": " will initiate a tunnel open VPN tunnel with the device uh and now the user can reach their"
    },
    {
      "Time_Start": 2185.8,
      "Time_End": 2190.8,
      "Text": " device through this uh relay point inside the VPN tunnel. Now if you noticed uh we're also"
    },
    {
      "Time_Start": 2193.84,
      "Time_End": 2198.84,
      "Text": " using here subdomains so we could also harvest all the aliases of all Synology devices"
    },
    {
      "Time_Start": 2200.6800000000003,
      "Time_End": 2206.16,
      "Text": " in the world uh and yeah we did the same so we had a list of uh thousands of maybe millions"
    },
    {
      "Time_Start": 2206.16,
      "Time_End": 2211.16,
      "Text": " of subdomains basically aliases of devices of Synology devices. But we wanted more"
    },
    {
      "Time_Start": 2212.96,
      "Time_End": 2218.66,
      "Text": " obviously we wanted to understand how does the device what type of tokens or secrets does"
    },
    {
      "Time_Start": 2218.66,
      "Time_End": 2225.34,
      "Text": " the device use to connect to quick quick connect cloud platform and uh to initiate the VPN"
    },
    {
      "Time_Start": 2225.34,
      "Time_End": 2230.34,
      "Text": " tunnel. So we researched this process for a very long time uh because it it is a long"
    },
    {
      "Time_Start": 2232.78,
      "Time_End": 2237.78,
      "Text": " process um and if we summarize all the digital elements or the tokens or the secrets whatever"
    },
    {
      "Time_Start": 2240.1200000000003,
      "Time_End": 2245.1200000000003,
      "Text": " you want to call it um eh we made a quick list for this. So for example the device needs to"
    },
    {
      "Time_Start": 2247.42,
      "Time_End": 2253.26,
      "Text": " know it's MAC address, serial number, device module, some tokens in order to connect to the"
    },
    {
      "Time_Start": 2253.28,
      "Time_End": 2259.36,
      "Text": " quick connect cloud platform and start and initiate this tunnel. So if we wanted to"
    },
    {
      "Time_Start": 2259.36,
      "Time_End": 2265.96,
      "Text": " impersonate a device we had to have these identifiers. And if you look at it some of the"
    },
    {
      "Time_Start": 2265.96,
      "Time_End": 2271.4,
      "Text": " identifiers are quite straight forward for example the MAC address is very easy to get but"
    },
    {
      "Time_Start": 2271.4,
      "Time_End": 2276.84,
      "Text": " also the serial number and the device module are are easy to get. Uh apparently Synology"
    },
    {
      "Time_Start": 2276.84,
      "Time_End": 2282.84,
      "Text": " this has this discovery utility so whenever you buy a new device you can activate the"
    },
    {
      "Time_Start": 2282.86,
      "Time_End": 2289.3,
      "Text": " discovery utility and search for devices around you on the local network. So we basically"
    },
    {
      "Time_Start": 2289.3,
      "Time_End": 2295.7000000000003,
      "Text": " implemented this protocol to get the basic identifiers such as serial number, module and"
    },
    {
      "Time_Start": 2295.7000000000003,
      "Time_End": 2300.7200000000003,
      "Text": " MAC. So now we had the first uh elements that we needed uh for uh the first element that we"
    },
    {
      "Time_Start": 2304.08,
      "Time_End": 2309.08,
      "Text": " needed to impersonate the device. By the way the DS token uh is some kind of uh"
    },
    {
      "Time_Start": 2309.1,
      "Time_End": 2314.1,
      "Text": " deterministic um algorithm that based on the serial number so whenever we had the serial"
    },
    {
      "Time_Start": 2317.84,
      "Time_End": 2322.84,
      "Text": " number we could now calculate this uh DS token. Um next we had to get the API key which is"
    },
    {
      "Time_Start": 2325.72,
      "Time_End": 2332.16,
      "Text": " the device quick connect key. This token and also the authentication token are tokens that"
    },
    {
      "Time_Start": 2332.16,
      "Time_End": 2337.16,
      "Text": " are being generated whenever the user associates their their Synology user on the device. So"
    },
    {
      "Time_Start": 2339.46,
      "Time_End": 2345.6,
      "Text": " we thought it could be impossible to get those because it only happens once on the device"
    },
    {
      "Time_Start": 2345.6,
      "Time_End": 2352.64,
      "Text": " and then they're not being exchanged anymore. But after researching a lot of different"
    },
    {
      "Time_Start": 2352.64,
      "Time_End": 2357.58,
      "Text": " endpoints and routes on the cloud platform and also researching and reverse engineering"
    },
    {
      "Time_Start": 2357.58,
      "Time_End": 2362.58,
      "Text": " different binaries and uh other endpoints on the device itself we figured uh there is a"
    },
    {
      "Time_Start": 2363.2599999999998,
      "Time_End": 2368.2599999999998,
      "Text": " bug uh apparently what seems to be a bug on the cloud platform. So apparently if we try we"
    },
    {
      "Time_Start": 2372.7,
      "Time_End": 2377.7,
      "Text": " ask nicely the cloud to register for us a new API token and just giving it a serial number"
    },
    {
      "Time_Start": 2380.24,
      "Time_End": 2386.24,
      "Text": " it will be enough to generate a new valid API token on behalf of the device. So just by"
    },
    {
      "Time_Start": 2386.24,
      "Time_End": 2391.18,
      "Text": " knowing the serial number and the MAC address and also the mod model we could actually"
    },
    {
      "Time_Start": 2391.18,
      "Time_End": 2396.16,
      "Text": " generate new API token for the device and use it. That was crazy. Next we needed the"
    },
    {
      "Time_Start": 2398.16,
      "Time_End": 2404.3599999999997,
      "Text": " uh authentication key uh which was very similar. It's another token uh but also a"
    },
    {
      "Time_Start": 2404.3599999999997,
      "Time_End": 2409.8999999999996,
      "Text": " different a token that we needed to get access to. Uh and we thought we were very lucky in"
    },
    {
      "Time_Start": 2409.8999999999996,
      "Time_End": 2415.74,
      "Text": " the first time so there is no way we were able to get this the second time but we were able"
    },
    {
      "Time_Start": 2415.7400000000002,
      "Time_End": 2420.7400000000002,
      "Text": " to get this uh due to another bug in another feature uh of uh DNS uh DD and dynamic DNS"
    },
    {
      "Time_Start": 2424.28,
      "Time_End": 2430.38,
      "Text": " feature of the devices. Uh so basically again they forgot to do some stronger authentication"
    },
    {
      "Time_Start": 2430.38,
      "Time_End": 2436.1600000000003,
      "Text": " and again we were able to get this token that we needed to impersonate a device. Now that we"
    },
    {
      "Time_Start": 2436.1600000000003,
      "Time_End": 2442.6000000000004,
      "Text": " had both tokens and all the basic identifiers we basically could receive any information we"
    },
    {
      "Time_Start": 2442.6,
      "Time_End": 2448.46,
      "Text": " want on the device and we had our list completed. So we had all the information we need in"
    },
    {
      "Time_Start": 2448.46,
      "Time_End": 2453.48,
      "Text": " order to impersonate any Synology device that we want. That's crazy. So what we did with it?"
    },
    {
      "Time_Start": 2457.18,
      "Time_End": 2462.18,
      "Text": " We now were in the context of a real uh device. We impersonated a real device and we thought"
    },
    {
      "Time_Start": 2464.98,
      "Time_End": 2471.3199999999997,
      "Text": " how can we leverage this into a remote remote code execution. So the first thing that we did"
    },
    {
      "Time_Start": 2471.34,
      "Time_End": 2476.34,
      "Text": " was telling the cloud hey we're this real device for real. Please change the IP address that you"
    },
    {
      "Time_Start": 2480.48,
      "Time_End": 2487.1000000000004,
      "Text": " think I'm at to a different one. Basically what we were trying to do is to make the cloud"
    },
    {
      "Time_Start": 2487.1000000000004,
      "Time_End": 2492.1000000000004,
      "Text": " platform to relay users instead of the real device to our CNC. And it worked because we"
    },
    {
      "Time_Start": 2494.7400000000002,
      "Time_End": 2499.34,
      "Text": " fully impersonated the device and the cloud fully trusted us. We had all the secrets. We had"
    },
    {
      "Time_Start": 2499.36,
      "Time_End": 2503.1000000000004,
      "Text": " the tokens. We had the serial number. We had the MAC address. We had everything that we need."
    },
    {
      "Time_Start": 2503.1000000000004,
      "Time_End": 2508.1000000000004,
      "Text": " And the server really relayed users to our CNC and again we got their tokens and we were able to"
    },
    {
      "Time_Start": 2511.48,
      "Time_End": 2516.48,
      "Text": " access uh the real device. Thank you. Uh so just to sum up real quick. Users wants to"
    },
    {
      "Time_Start": 2517.14,
      "Time_End": 2522.14,
      "Text": " connect to their devices. But because of a couple of flaws and vulnerabilities we uncovered"
    },
    {
      "Time_Start": 2535.02,
      "Time_End": 2540.02,
      "Text": " in the cloud architecture we were able to redirect users to our impersonated device. Once we"
    },
    {
      "Time_Start": 2540.38,
      "Time_End": 2545.38,
      "Text": " were getting the user tokens we used these tokens and impersonated the users so we"
    },
    {
      "Time_Start": 2550.22,
      "Time_End": 2555.22,
      "Text": " basically connected on behalf of the users to their real device. Now to sum up. Cloud"
    },
    {
      "Time_Start": 2557.6,
      "Time_End": 2563.8,
      "Text": " services focus on strong user authentication. It's very difficult these days to bypass user"
    },
    {
      "Time_Start": 2563.8,
      "Time_End": 2570.0,
      "Text": " authentication. But we believe that device authentication is a bit overlooked. So we"
    },
    {
      "Time_Start": 2570.96,
      "Time_End": 2575.96,
      "Text": " in many cases we've seen IOT architectures using weak or public knowledge identifiers to"
    },
    {
      "Time_Start": 2578.76,
      "Time_End": 2584.2,
      "Text": " authenticate devices. So obviously this needs to be changed and we already contacted a"
    },
    {
      "Time_Start": 2584.2,
      "Time_End": 2589.74,
      "Text": " couple of big vendors uh that we found bugs in. So maybe we'll be here next week, next year."
    },
    {
      "Time_Start": 2589.74,
      "Time_End": 2594.74,
      "Text": " Uh and we really want to change this and emphasize that impersonated devices can be real"
    },
    {
      "Time_Start": 2594.96,
      "Time_End": 2597.86,
      "Text": " danger. Thank you."
    },
    {
      "Time_Start": 2597.86,
      "Time_End": 2602.86,
      "Text": " >>[applause and cheers from audience and audience members in the background."
    },
    {
      "Time_Start": 2602.86,
      "Time_End": 2607.86,
      "Text": " So I'm not sure about questions. Should we do questions here? Okay. You're invited to follow us"
    },
    {
      "Time_Start": 2615.6000000000004,
      "Time_End": 2617.1800000000003,
      "Text": " wherever you go. Thank you."
    }
  ]
}