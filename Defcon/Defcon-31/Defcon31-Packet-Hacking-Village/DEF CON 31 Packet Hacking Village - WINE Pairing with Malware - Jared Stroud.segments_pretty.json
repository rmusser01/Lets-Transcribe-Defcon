{
  "segments": [
    {
      "Time_Start": 0.0,
      "Time_End": 11.56,
      "Text": "This text was transcribed using whisper model: large-v2\n\n Good afternoon everyone. It is 3 p.m. at DEF CON 31. Welcome to Village Talks. This next talk is"
    },
    {
      "Time_Start": 11.56,
      "Time_End": 17.86,
      "Text": " presented by the Packet Hacking Village. The Packet Hacking Village talk, the whole"
    },
    {
      "Time_Start": 17.86,
      "Time_End": 24.62,
      "Text": " premise is, is to give information and content that people can grasp and use"
    },
    {
      "Time_Start": 24.62,
      "Time_End": 33.1,
      "Text": " immediately. This next talk that we're going to present, remember when we did the"
    },
    {
      "Time_Start": 33.1,
      "Time_End": 43.38,
      "Text": " CFP for this, and it caught our attention right away. And Riverside said, we have to"
    },
    {
      "Time_Start": 43.38,
      "Time_End": 49.02,
      "Text": " accept this talk. This talk looks really, really good. And it is my pleasure to"
    },
    {
      "Time_Start": 49.02,
      "Time_End": 56.34,
      "Text": " introduce to you someone who I've gotten to, gotten to know pretty well within the"
    },
    {
      "Time_Start": 56.34,
      "Time_End": 66.82000000000001,
      "Text": " last, what, 24, 48 hours. Jared Stroud, who is a security lead at the MITRE Corporation."
    },
    {
      "Time_Start": 66.82000000000001,
      "Time_End": 71.94,
      "Text": " And one of the things is, is that I will want to let everyone know here, who here, is this"
    },
    {
      "Time_Start": 71.94,
      "Time_End": 80.58,
      "Text": " is your first DEF CON. If this is your first DEF CON, welcome and please take advantage of"
    },
    {
      "Time_Start": 80.58,
      "Time_End": 87.25999999999999,
      "Text": " your learning opportunities. But I also warn each and every one of you as well too. And"
    },
    {
      "Time_Start": 87.25999999999999,
      "Time_End": 94.42,
      "Text": " Jared is, sir, gave, served as a really, really good warning. I don't know if you all know,"
    },
    {
      "Time_Start": 94.42,
      "Time_End": 100.86,
      "Text": " but the tech and the secure, the tech and especially the security community is extremely"
    },
    {
      "Time_Start": 100.86,
      "Time_End": 105.74000000000001,
      "Text": " small. Do you know how they said, what is that thing that they said about the, uh, the six"
    },
    {
      "Time_Start": 105.74000000000001,
      "Time_End": 112.5,
      "Text": " degrees of Kevin Bacon? Is it, is that what it's called? Something like that? Here, if you're at"
    },
    {
      "Time_Start": 112.5,
      "Time_End": 119.74000000000001,
      "Text": " DEF CON, like the degree of separation is not even six. It's like more like one or two. And"
    },
    {
      "Time_Start": 119.74000000000001,
      "Time_End": 128.46,
      "Text": " it is just absolutely crazy to hear, you know, that former students and friends have while"
    },
    {
      "Time_Start": 128.46,
      "Time_End": 134.78,
      "Text": " working with Jared. And it's just like, absolutely. And this is, and I've been at DEF CON"
    },
    {
      "Time_Start": 134.78,
      "Time_End": 140.98000000000002,
      "Text": " for many, many years and this has been, it just happened each and every year when I'm here. So"
    },
    {
      "Time_Start": 140.98000000000002,
      "Time_End": 146.70000000000002,
      "Text": " just to let you know is that, you know, you don't even, chances are you'll probably know who"
    },
    {
      "Time_Start": 146.70000000000002,
      "Time_End": 150.3,
      "Text": " you're going to be talking to, or you probably have, you know, a little bit about the person"
    },
    {
      "Time_Start": 150.3,
      "Time_End": 155.34000000000003,
      "Text": " next to you. So just be careful that the degree of separation is extremely small. But"
    },
    {
      "Time_Start": 155.34000000000003,
      "Time_End": 160.74,
      "Text": " nonetheless, it is my pleasure to introduce to you, Jared Stroud, who's going to talk about"
    },
    {
      "Time_Start": 160.74,
      "Time_End": 164.70000000000002,
      "Text": " wine pairing with malware. Take it away."
    },
    {
      "Time_Start": 170.02,
      "Time_End": 174.58,
      "Text": " All right. Well, thank you Ming and thank you Packet Hacking Village for having me. DEF CON,"
    },
    {
      "Time_Start": 174.58,
      "Time_End": 180.46,
      "Text": " this is awesome. Uh, that was a really nice introduction. Hope this doesn't suck. So how's"
    },
    {
      "Time_Start": 180.46,
      "Time_End": 187.58,
      "Text": " everybody doing today? All right. Not hung over at all. Exciting. Cool. So my name is Jared"
    },
    {
      "Time_Start": 187.58,
      "Time_End": 192.26000000000002,
      "Text": " Stroud. On the internet, I am DLL Cool J. And today we're going to be talking about wine"
    },
    {
      "Time_Start": 192.26000000000002,
      "Time_End": 198.06,
      "Text": " pairing with malware and some fun we can have across the way. So fun disclaimer, but since"
    },
    {
      "Time_Start": 198.06,
      "Time_End": 203.9,
      "Text": " it's DEF CON, we don't read those. Uh, I am a lead security engineer at the MITRE Corporation."
    },
    {
      "Time_Start": 203.9,
      "Time_End": 209.18,
      "Text": " I'm also an adjunct lecturer at the Rochester Institute of Technology. Go Tigers. And"
    },
    {
      "Time_Start": 209.18,
      "Time_End": 214.66,
      "Text": " additionally, recently I actually just was a finalist in the Sentinel One and VX Underground"
    },
    {
      "Time_Start": 214.66,
      "Time_End": 219.62,
      "Text": " Malware Analyst Competition. And that's where a lot of the talk is going to come from. Some of"
    },
    {
      "Time_Start": 219.62,
      "Time_End": 225.02,
      "Text": " the side work that I do at home in my home lab and some interesting things around malware."
    },
    {
      "Time_Start": 225.02,
      "Time_End": 229.46,
      "Text": " And additionally, after this, come swing by the contest village. I'm helping run a contest"
    },
    {
      "Time_Start": 229.46,
      "Time_End": 236.06,
      "Text": " called Battle of the Bots. Also Hack Fortress. Would love to chat more later. Cool. So why are"
    },
    {
      "Time_Start": 236.06,
      "Time_End": 240.26000000000002,
      "Text": " we here, right? And again, thank you all for coming. We're going to talk about what wine is."
    },
    {
      "Time_Start": 240.26000000000002,
      "Time_End": 245.42000000000002,
      "Text": " So if you've never heard of wine, don't worry. But out of curiosity, how many people have heard"
    },
    {
      "Time_Start": 245.42000000000002,
      "Time_End": 252.70000000000002,
      "Text": " of wine? Awesome. A lot of hands. Also out of curiosity, how many people have had issues with"
    },
    {
      "Time_Start": 252.70000000000002,
      "Time_End": 259.18,
      "Text": " wine? Somehow more hands went up. I'm a little confused about that, but excellent. Hopefully I"
    },
    {
      "Time_Start": 259.18,
      "Time_End": 263.94,
      "Text": " can shed some light into this. So we're going to talk about how wine works and why we care about"
    },
    {
      "Time_Start": 263.94,
      "Time_End": 269.18,
      "Text": " using wine for both offensive and defensive purposes. And my big goal is to get you to walk"
    },
    {
      "Time_Start": 269.18,
      "Time_End": 274.22,
      "Text": " away with some actionable evidence today that makes sense for both, again, offensive and"
    },
    {
      "Time_Start": 274.22,
      "Time_End": 281.78000000000003,
      "Text": " decent things. Cool. So this all got started because again, I have a home lab that I'm super"
    },
    {
      "Time_Start": 281.78000000000003,
      "Time_End": 286.66,
      "Text": " passionate about and I call that ArchCloud Labs. I blog about silly things related to malware."
    },
    {
      "Time_Start": 286.66,
      "Time_End": 292.5,
      "Text": " Now more than ever, anyone can go and grab APT samples from a VX underground or a mal share and"
    },
    {
      "Time_Start": 292.5,
      "Time_End": 297.14000000000004,
      "Text": " start digging in and doing their own reverse engineering, their own blue team work or red team"
    },
    {
      "Time_Start": 297.14000000000004,
      "Time_End": 301.86,
      "Text": " work where they're trying to emulate threats, right? That's really cool. Never has that happened"
    },
    {
      "Time_Start": 301.86,
      "Time_End": 307.58000000000004,
      "Text": " before. And along with releases like Ghidra and various other open source tools with Yara, you"
    },
    {
      "Time_Start": 307.58000000000004,
      "Time_End": 313.22,
      "Text": " can really build your own blue team D for home lab and get those skills up for whether it be like"
    },
    {
      "Time_Start": 313.22,
      "Time_End": 319.02000000000004,
      "Text": " contests or employments, whatever the case may be. But something that I was running into my"
    },
    {
      "Time_Start": 319.02000000000004,
      "Time_End": 324.22,
      "Text": " home lab, right? If you get like a big old batch of malware, uh, going in executing this to get"
    },
    {
      "Time_Start": 324.22,
      "Time_End": 330.46000000000004,
      "Text": " those initial artifacts is a super big pain, right? I want DNS requests. I want outbound TCP and"
    },
    {
      "Time_Start": 330.46000000000004,
      "Time_End": 334.94000000000005,
      "Text": " UDP. I want all that good data, but I don't want the overhead of actually managing that"
    },
    {
      "Time_Start": 334.94000000000005,
      "Time_End": 339.70000000000005,
      "Text": " infrastructure. I don't want to have to run an ESXI cluster and then install cuckoo and manage"
    },
    {
      "Time_Start": 339.7,
      "Time_End": 345.14,
      "Text": " my base images and then after I run the malware, take snapshots, store those snapshots, and at"
    },
    {
      "Time_Start": 345.14,
      "Time_End": 348.94,
      "Text": " some point I finally get the PCAP and go, oh, okay, here's the domain that this cobalt strike"
    },
    {
      "Time_Start": 348.94,
      "Time_End": 353.38,
      "Text": " beacon was calling out to, right? This seems like too much. This is all too much. I want initial"
    },
    {
      "Time_Start": 353.38,
      "Time_End": 359.53999999999996,
      "Text": " artifacts that I can immediately start digging into. So with that, I started to take a look at"
    },
    {
      "Time_Start": 359.53999999999996,
      "Time_End": 364.65999999999997,
      "Text": " wine, right? And again, seems like a lot of people in here know wine. I'm going to take a shot in"
    },
    {
      "Time_Start": 364.66,
      "Time_End": 370.12,
      "Text": " the dark and say that some people may know that from Valve, uh, and Steam and and their fork of"
    },
    {
      "Time_Start": 370.12,
      "Time_End": 374.86,
      "Text": " it called Proton. But if you've never heard of wine before, wine is a recursive acronym that"
    },
    {
      "Time_Start": 374.86,
      "Time_End": 380.70000000000005,
      "Text": " stands for wine is not an emulator. It does not do emulation of Win32 API calls. It does"
    },
    {
      "Time_Start": 380.70000000000005,
      "Time_End": 385.88,
      "Text": " translation from whatever is happening in the Windows world and DLLs and kernels and so on and"
    },
    {
      "Time_Start": 385.88,
      "Time_End": 391.24,
      "Text": " so forth into deposit calls equivalent. So it's actually executing him on uh the underlying"
    },
    {
      "Time_Start": 391.26,
      "Time_End": 397.74,
      "Text": " Linux kernel. So this is really cool, right? So with this, it's a uh open source project that's"
    },
    {
      "Time_Start": 397.74,
      "Time_End": 402.74,
      "Text": " labeled or that's under the GPL license and there's a couple of commercial backers. Notably"
    },
    {
      "Time_Start": 402.74,
      "Time_End": 407.98,
      "Text": " Valve and their Proton uh release of that which is really just focused around some fixes of"
    },
    {
      "Time_Start": 407.98,
      "Time_End": 414.12,
      "Text": " uh uh graphics drivers and and uh more intense things to run AAA games. And then there's also"
    },
    {
      "Time_Start": 414.12,
      "Time_End": 419.16,
      "Text": " CodeWeavers and CodeWeavers uh has a tool called Crossover and Crossover's just trying to help"
    },
    {
      "Time_Start": 419.18,
      "Time_End": 425.92,
      "Text": " you run whatever your Windows software of choice is on Linux a little bit easier. That being"
    },
    {
      "Time_Start": 425.92,
      "Time_End": 431.70000000000005,
      "Text": " said, the core of wine is a free open source product that is getting all of these contributions"
    },
    {
      "Time_Start": 431.70000000000005,
      "Time_End": 436.84000000000003,
      "Text": " rolling in all the time. There's 3 different staging branches of uh or excuse me, there's 3"
    },
    {
      "Time_Start": 436.84000000000003,
      "Time_End": 440.5,
      "Text": " different branches of wine. You have your staging branches where some bug fixes are coming in."
    },
    {
      "Time_Start": 440.5,
      "Time_End": 445.18,
      "Text": " It's not quite stable. You have stable and you have some release candidates as well. So this is a"
    },
    {
      "Time_Start": 445.2,
      "Time_End": 450.38,
      "Text": " very active project that's constantly getting new patches submitted upstream and this example"
    },
    {
      "Time_Start": 450.38,
      "Time_End": 454.6,
      "Text": " that I have on the screen here is just to show hey, folks from Valve are submitting their"
    },
    {
      "Time_Start": 454.6,
      "Time_End": 458.88,
      "Text": " upstreams, folks from Crossover are submitting their upstream patches and overall that wine"
    },
    {
      "Time_Start": 458.88,
      "Time_End": 464.62,
      "Text": " project keeps getting better and better over time. So with this, let's go ahead and take a look"
    },
    {
      "Time_Start": 464.62,
      "Time_End": 469.32,
      "Text": " at how wine actually works underneath the hood and how we can start thinking about ways that we"
    },
    {
      "Time_Start": 469.34,
      "Time_End": 475.84,
      "Text": " can use it for our workflows. So when you run wine and then whatever exe like malware.exe or"
    },
    {
      "Time_Start": 475.84,
      "Time_End": 480.98,
      "Text": " MicrosoftOffice.exe, what's happening underneath the hood is a separate service is getting spun"
    },
    {
      "Time_Start": 480.98,
      "Time_End": 485.68,
      "Text": " up, excuse me, a separate process called wine server. Wine server is going to go ahead and"
    },
    {
      "Time_Start": 485.68,
      "Time_End": 491.02,
      "Text": " create a Unix socket that your main process is going to talk to it over. This wine server is"
    },
    {
      "Time_Start": 491.02,
      "Time_End": 496.06,
      "Text": " then going to load its DLLs which are really just Linux shared objects that are going to do all"
    },
    {
      "Time_Start": 496.06,
      "Time_End": 503.14,
      "Text": " that uh translation to the underlying uh Linux API calls from the Windows 32 calls. As an"
    },
    {
      "Time_Start": 503.14,
      "Time_End": 509.78000000000003,
      "Text": " example, up here to my right, we see the MSDN documentation for git native system info. It's"
    },
    {
      "Time_Start": 509.78000000000003,
      "Time_End": 514.46,
      "Text": " going to go ahead and take in some pointer to some struct, populate that data and return it"
    },
    {
      "Time_Start": 514.46,
      "Time_End": 519.52,
      "Text": " to you and then the Linux or excuse me, the wine equivalent over here, you take in some"
    },
    {
      "Time_Start": 519.52,
      "Time_End": 526.16,
      "Text": " struct of sysinfo, you start populating it as we go down the uh path. So all of the magic of"
    },
    {
      "Time_Start": 526.16,
      "Time_End": 530.52,
      "Text": " that actual translation where that's occurring is in these DLLs. And that's going to be an"
    },
    {
      "Time_Start": 530.52,
      "Time_End": 534.76,
      "Text": " important thing to keep in mind that we'll circle back on later how we can use that to our"
    },
    {
      "Time_Start": 534.76,
      "Time_End": 541.3,
      "Text": " advantage. So at this point, we're thinking alright, that's pretty cool. We can start seeing"
    },
    {
      "Time_Start": 541.3,
      "Time_End": 546.38,
      "Text": " like you can execute you know maybe a uh meterpreter uh set uh shirt shell or something like"
    },
    {
      "Time_Start": 546.4,
      "Time_End": 551.88,
      "Text": " that to to uh on a Linux system and start getting those artifacts. But uh you know naturally"
    },
    {
      "Time_Start": 551.88,
      "Time_End": 555.92,
      "Text": " I'm not the first person to think of this. Doing a little bit of deep dive in both the"
    },
    {
      "Time_Start": 555.92,
      "Time_End": 561.32,
      "Text": " academic and open source research, the earliest document I could find was from 2005 and it"
    },
    {
      "Time_Start": 561.32,
      "Time_End": 568.12,
      "Text": " was a Linux.com article talking about running Windows viruses on Linux. And this was all"
    },
    {
      "Time_Start": 568.12,
      "Time_End": 575.0,
      "Text": " getting done via wine. But the overall result was hey this sucks. We uh don't have the you"
    },
    {
      "Time_Start": 575.02,
      "Time_End": 578.56,
      "Text": " know the spammers aren't spamming. The worms aren't worming. Uh it looks like you know"
    },
    {
      "Time_Start": 578.56,
      "Time_End": 584.0,
      "Text": " Linux wins again. Right? And that was kind of all you saw for a pretty long time. Then excuse"
    },
    {
      "Time_Start": 584.0,
      "Time_End": 589.0,
      "Text": " me. But it but it does pose the question of as uh wine got better over time, does Windows"
    },
    {
      "Time_Start": 592.98,
      "Time_End": 599.18,
      "Text": " malware pose a threat to Linux servers? Right? Now any Linux admin or Linux user over"
    },
    {
      "Time_Start": 599.18,
      "Time_End": 603.08,
      "Text": " there is probably thinking right now well wine's not installed by default. I'm not super"
    },
    {
      "Time_Start": 603.1,
      "Time_End": 607.94,
      "Text": " concerned about that. But that is a lot of the angles that academia take of hey can we run"
    },
    {
      "Time_Start": 607.94,
      "Time_End": 613.88,
      "Text": " these Windows samples on a Linux machine if wine is installed and will the damage uh uh be"
    },
    {
      "Time_Start": 613.88,
      "Time_End": 620.38,
      "Text": " equivalent? And the overall result from these papers was maybe and a lot of that came out"
    },
    {
      "Time_Start": 620.38,
      "Time_End": 624.2800000000001,
      "Text": " from the samples that they were picking. And when I say samples I'm referring to malware"
    },
    {
      "Time_Start": 624.2800000000001,
      "Time_End": 629.26,
      "Text": " samples. Largely this was just an arbitrary selection of whatever malware dump the"
    },
    {
      "Time_Start": 629.28,
      "Time_End": 633.22,
      "Text": " researcher had to them at the time. And a lot of situations the malware that they were"
    },
    {
      "Time_Start": 633.22,
      "Time_End": 638.92,
      "Text": " executing was dependent on external services that wine did not spawn. For example with"
    },
    {
      "Time_Start": 638.92,
      "Time_End": 643.86,
      "Text": " Mimikatz there is no LSAS process. So if you have some kind of precompiled binary that's"
    },
    {
      "Time_Start": 643.86,
      "Time_End": 647.8,
      "Text": " going to try to dump from LSAS it's immediately going to fail. That's not the fault of wine"
    },
    {
      "Time_Start": 647.8,
      "Time_End": 651.76,
      "Text": " that's just the service doesn't exist. Same thing to be said about trying to poke at an"
    },
    {
      "Time_Start": 651.76,
      "Time_End": 655.64,
      "Text": " Active Directory server. You know you can go from there with the other dependencies that"
    },
    {
      "Time_Start": 655.64,
      "Time_End": 661.1,
      "Text": " may exist. Additionally a lot of these academic research projects were using open source"
    },
    {
      "Time_Start": 661.1,
      "Time_End": 666.0,
      "Text": " projects that wrapped wine but did not use wine directly themselves. And these open source"
    },
    {
      "Time_Start": 666.0,
      "Time_End": 671.58,
      "Text": " projects were largely abandonware. A paper from 2018 was leveraging something that wasn't"
    },
    {
      "Time_Start": 671.58,
      "Time_End": 676.58,
      "Text": " last updated from 2013. But I'm here to talk to you today about saying not all hope is lost."
    },
    {
      "Time_Start": 678.92,
      "Time_End": 684.56,
      "Text": " We can actually build our own execution environment with thinly wrapped wine wrappers to"
    },
    {
      "Time_Start": 684.58,
      "Time_End": 690.6600000000001,
      "Text": " execute malware. So this is where my talk title actually kind of comes full circle here. This is"
    },
    {
      "Time_Start": 690.6600000000001,
      "Time_End": 696.36,
      "Text": " the wine pairing with malware. We have to pick our samples appropriately to make sure that"
    },
    {
      "Time_Start": 696.36,
      "Time_End": 700.3000000000001,
      "Text": " we're not going to be dependent on some kind of foreign service that isn't going to run in"
    },
    {
      "Time_Start": 700.3000000000001,
      "Time_End": 706.74,
      "Text": " wine. Now that doesn't mean you need an aged cobalt strike to pair with a newer release of"
    },
    {
      "Time_Start": 706.74,
      "Time_End": 712.98,
      "Text": " wine. You can just go ahead and grab the latest version of wine off the website and execute"
    },
    {
      "Time_Start": 713.0,
      "Time_End": 719.48,
      "Text": " it against the samples that you have today. Looking at the threat trends we're seeing from a"
    },
    {
      "Time_Start": 719.48,
      "Time_End": 724.14,
      "Text": " Sophos report released about last month. We're seeing that Meterpreter and Metasploit and"
    },
    {
      "Time_Start": 724.14,
      "Time_End": 729.88,
      "Text": " its associated projects and payloads are kind of on the rise right. To the surprise of no one"
    },
    {
      "Time_Start": 729.88,
      "Time_End": 734.38,
      "Text": " right. Criminal groups and APT actors alike. Maybe a shellcode runner is different but"
    },
    {
      "Time_Start": 734.38,
      "Time_End": 739.26,
      "Text": " Metasploit gets used a lot. It's very scriptable. It's very easy to make to use into whatever"
    },
    {
      "Time_Start": 739.28,
      "Time_End": 746.48,
      "Text": " offensive workflow you have. Looking at a 2013 report from Red Canary. They said that"
    },
    {
      "Time_Start": 746.48,
      "Time_End": 750.92,
      "Text": " Cobalt Strike and Metasploit continue to be the most popular C2 framework with a couple of"
    },
    {
      "Time_Start": 750.92,
      "Time_End": 756.3199999999999,
      "Text": " other open source and commercial vendors on the rise. Those include Brute Radle, Sliver and"
    },
    {
      "Time_Start": 756.3199999999999,
      "Time_End": 761.36,
      "Text": " Mythic. But again we're seeing the usual suspects here right. We're not surprised at what we're"
    },
    {
      "Time_Start": 761.36,
      "Time_End": 765.4,
      "Text": " seeing. We're seeing Metasploit. We're seeing Cobalt Strike and a handful of offensive"
    },
    {
      "Time_Start": 765.4,
      "Time_End": 770.98,
      "Text": " frameworks. So with that why grab all of these random old ransomware samples or old malware"
    },
    {
      "Time_Start": 770.98,
      "Time_End": 775.66,
      "Text": " samples. Why not test what is likely going to end up at some point in the ticket queue for your"
    },
    {
      "Time_Start": 775.66,
      "Time_End": 781.86,
      "Text": " sock. And then what can you do with that information. So for my research I picked these"
    },
    {
      "Time_Start": 781.86,
      "Time_End": 789.3,
      "Text": " three frameworks largely because of their ubiquitousness in the APT and crimeware world as"
    },
    {
      "Time_Start": 789.3,
      "Time_End": 794.54,
      "Text": " well as the ability to kind of make a little lab for everybody to test out afterwards with"
    },
    {
      "Time_Start": 794.54,
      "Time_End": 800.18,
      "Text": " Metasploit right. So Cobalt Strike no surprise there. Human operated ransomware groups"
    },
    {
      "Time_Start": 800.18,
      "Time_End": 805.48,
      "Text": " continue to use this. Same thing with APT groups. Empire is getting picked up more by APT"
    },
    {
      "Time_Start": 805.48,
      "Time_End": 810.56,
      "Text": " groups and notably it has C sharp functionality. So that's a nice little twist. And Metasploit"
    },
    {
      "Time_Start": 810.56,
      "Time_End": 817.0999999999999,
      "Text": " because again Metasploit. So let's go ahead and start talking about why we're using Wine and"
    },
    {
      "Time_Start": 817.0999999999999,
      "Time_End": 821.8,
      "Text": " not just spinning up a Windows VM to actually do this execution right. We love Linux because"
    },
    {
      "Time_Start": 821.8000000000001,
      "Time_End": 825.9000000000001,
      "Text": " of its flexibility. We want to pipe set and all can grep our way to victory. We want to get"
    },
    {
      "Time_Start": 825.9000000000001,
      "Time_End": 830.5400000000001,
      "Text": " those initial shared objects. Again I don't want to have to instrument a whole ESXI workflow to"
    },
    {
      "Time_Start": 830.5400000000001,
      "Time_End": 836.94,
      "Text": " get these artifacts. And what we're having shown here is a very very very simple example of"
    },
    {
      "Time_Start": 836.94,
      "Time_End": 841.6200000000001,
      "Text": " instrumenting this execution with a container. I go ahead and spin up a container that simply"
    },
    {
      "Time_Start": 841.6200000000001,
      "Time_End": 847.48,
      "Text": " copies my malware over, runs Wine and then on the underlying host I'm capturing that data"
    },
    {
      "Time_Start": 847.5,
      "Time_End": 851.98,
      "Text": " with Wireshark, a TCP dump, whatever you may have you. And then also I'm getting the rest of"
    },
    {
      "Time_Start": 851.98,
      "Time_End": 856.98,
      "Text": " the host based artifacts in what's known as a Wine prefix. Looking at uh you know scaling"
    },
    {
      "Time_Start": 861.28,
      "Time_End": 867.26,
      "Text": " this execution we can go ahead and actually take uh our container with uh Podman and"
    },
    {
      "Time_Start": 867.26,
      "Time_End": 872.3000000000001,
      "Text": " generate the YAML to get it to execute in Kubernetes as well. So while we're doing basic"
    },
    {
      "Time_Start": 872.3000000000001,
      "Time_End": 876.5,
      "Text": " example execution with just one sample that's not to say that you can't actually scale this"
    },
    {
      "Time_Start": 876.5,
      "Time_End": 880.66,
      "Text": " to handle all of the daily dump that you're getting from virus total mal share or VX"
    },
    {
      "Time_Start": 880.66,
      "Time_End": 885.9,
      "Text": " underground. But I talked about a Wine prefix a moment ago and we're going to dive deeper"
    },
    {
      "Time_Start": 885.9,
      "Time_End": 891.7,
      "Text": " into that. Your Wine prefix is effectively your C drive um or a wrapper for the C drive for"
    },
    {
      "Time_Start": 891.7,
      "Time_End": 897.04,
      "Text": " the underlying Wine environment. Here we see DOS devices end up being your com objects,"
    },
    {
      "Time_Start": 897.04,
      "Time_End": 902.32,
      "Text": " drive C is the C drive and then you have a handful of registry files that get created as"
    },
    {
      "Time_Start": 902.34,
      "Time_End": 907.88,
      "Text": " well. When you're executing a malware sample with Wine you can go ahead and create a unique"
    },
    {
      "Time_Start": 907.88,
      "Time_End": 913.9200000000001,
      "Text": " Wine prefix per sample. Suddenly you have N number of Wine prefixes for N number of samples"
    },
    {
      "Time_Start": 913.9200000000001,
      "Time_End": 918.5200000000001,
      "Text": " and again you can sed, awk and grep your way for those artifacts and start looking at what's"
    },
    {
      "Time_Start": 918.5200000000001,
      "Time_End": 923.5200000000001,
      "Text": " going on there. Looking at the 2 uh files that we have here of userdef.reg and user.reg these"
    },
    {
      "Time_Start": 926.6600000000001,
      "Time_End": 931.5400000000001,
      "Text": " are the uh or excuse me the difference here is that userdef.reg is the default registry"
    },
    {
      "Time_Start": 931.56,
      "Time_End": 937.0,
      "Text": " keys that get created and user.reg are the registry keys that get created after execution."
    },
    {
      "Time_Start": 937.0,
      "Time_End": 941.9399999999999,
      "Text": " So if a malware sample goes and creates registry keys and is trying to do a UAC bypass you can"
    },
    {
      "Time_Start": 941.9399999999999,
      "Time_End": 947.68,
      "Text": " easily diff these files and see the changes. That's pretty sweet compared to using redshot,"
    },
    {
      "Time_Start": 947.68,
      "Time_End": 952.38,
      "Text": " taking snapshots and reverting. That's very fast. That shortens your workflow for basic"
    },
    {
      "Time_Start": 952.38,
      "Time_End": 959.12,
      "Text": " samples that you may be pulling in from uh a virus total or or what have you. Looking at"
    },
    {
      "Time_Start": 959.14,
      "Time_End": 963.54,
      "Text": " this in a slightly different light, if we went ahead and got our meterpreter session through"
    },
    {
      "Time_Start": 963.54,
      "Time_End": 968.72,
      "Text": " Wine, we start executing commands and dumping data to files like we see here at 1 right."
    },
    {
      "Time_Start": 968.72,
      "Time_End": 974.32,
      "Text": " Malware does a thing, I'm just echoing pwn to pwn dot text and at line 2 we're just simply"
    },
    {
      "Time_Start": 974.32,
      "Time_End": 979.2,
      "Text": " listing the contents of a directory. We can actually jump down to the host machine. In that"
    },
    {
      "Time_Start": 979.2,
      "Time_End": 984.7,
      "Text": " Wine prefix we can grab whatever files are getting dropped. So again, that Wine prefix ends"
    },
    {
      "Time_Start": 984.72,
      "Time_End": 989.4200000000001,
      "Text": " up being a pretty neat thing that we can tar up and move uh to a file system without having to"
    },
    {
      "Time_Start": 989.4200000000001,
      "Time_End": 994.4200000000001,
      "Text": " juggle VMDKs and any big uh virtual disk images. That's pretty neat. The same can be said"
    },
    {
      "Time_Start": 996.7,
      "Time_End": 1002.94,
      "Text": " about the registry. Uh as I as I stated earlier, we just go ahead and uh can cat uh user dot"
    },
    {
      "Time_Start": 1002.94,
      "Time_End": 1009.1400000000001,
      "Text": " reg, pipe grep for HKCU and start looking at newly created registry keys. Up at the top"
    },
    {
      "Time_Start": 1009.1400000000001,
      "Time_End": 1014.4200000000001,
      "Text": " here I'm simply using a post exploitation module from Metasploit to create a run once"
    },
    {
      "Time_Start": 1014.44,
      "Time_End": 1019.84,
      "Text": " key so on boot I will get my session restored. Nothing super crazy but a demonstration of"
    },
    {
      "Time_Start": 1019.84,
      "Time_End": 1026.04,
      "Text": " how this could be beneficial to you. Cool. So you didn't just come here for me to tell you"
    },
    {
      "Time_Start": 1026.04,
      "Time_End": 1030.92,
      "Text": " hey run Wine and then evil dot exe and get your IOCs right? That's that's not why we're here."
    },
    {
      "Time_Start": 1030.92,
      "Time_End": 1037.26,
      "Text": " The real magic is in the DLLs as I said earlier. What you can do is effectively build your"
    },
    {
      "Time_Start": 1037.26,
      "Time_End": 1042.42,
      "Text": " own DLLs to get loaded at run time and then start instrumenting your execution. What do I"
    },
    {
      "Time_Start": 1042.46,
      "Time_End": 1047.3400000000001,
      "Text": " mean by that? Well if there's specific API calls you want to capture more data on"
    },
    {
      "Time_Start": 1047.3400000000001,
      "Time_End": 1052.74,
      "Text": " dynamically you can go ahead and grab that data, send it to a sim, write it to a file or"
    },
    {
      "Time_Start": 1052.74,
      "Time_End": 1057.38,
      "Text": " otherwise ingest it into your workflow to start gathering more valuable intelligence"
    },
    {
      "Time_Start": 1057.38,
      "Time_End": 1062.38,
      "Text": " information. Additionally Wine has the equivalent of an LD preload where you can say hey look"
    },
    {
      "Time_Start": 1064.42,
      "Time_End": 1069.5800000000002,
      "Text": " here for my uh shared objects. So you don't need to recompile Wine every time you want to"
    },
    {
      "Time_Start": 1069.58,
      "Time_End": 1074.3799999999999,
      "Text": " suddenly get say registry keys like I have on the screen. You can simply have a directory"
    },
    {
      "Time_Start": 1074.3799999999999,
      "Time_End": 1078.52,
      "Text": " for your custom shared objects, load them when you need them to get that data and then"
    },
    {
      "Time_Start": 1078.52,
      "Time_End": 1083.76,
      "Text": " otherwise execute Wine normally. So this is super powerful especially when you start"
    },
    {
      "Time_Start": 1083.76,
      "Time_End": 1088.74,
      "Text": " thinking about altering return values and and really controlling the execution of malware"
    },
    {
      "Time_Start": 1088.74,
      "Time_End": 1093.74,
      "Text": " as a whole. But it's not perfect. Wine again is trying its best to uh go ahead and provide a"
    },
    {
      "Time_Start": 1094.3,
      "Time_End": 1099.3,
      "Text": " one to one translation for these calls. But when things go awry you can't just say oh this is"
    },
    {
      "Time_Start": 1101.54,
      "Time_End": 1105.32,
      "Text": " broken this isn't good you have to dig a little bit deeper and look at the source code. For"
    },
    {
      "Time_Start": 1105.32,
      "Time_End": 1109.6200000000001,
      "Text": " example the anti-malware scan interface at the time of this recording of this talk if we go"
    },
    {
      "Time_Start": 1109.6200000000001,
      "Time_End": 1114.86,
      "Text": " ahead and look all this simply does is return hey there's no malware here everything's good"
    },
    {
      "Time_Start": 1114.86,
      "Time_End": 1119.76,
      "Text": " just go ahead and execute that. So this is an example of where you need to dive deeper and"
    },
    {
      "Time_Start": 1119.76,
      "Time_End": 1124.22,
      "Text": " understand what these return values are going to be from Wine. But the neat thing about this"
    },
    {
      "Time_Start": 1124.22,
      "Time_End": 1129.8,
      "Text": " also is that well if AMSI is always returning hey this isn't malware maybe this is an"
    },
    {
      "Time_Start": 1129.8,
      "Time_End": 1134.8,
      "Text": " opportunity to start looking at fuzzing targets and playing around with other Windows software"
    },
    {
      "Time_Start": 1134.8,
      "Time_End": 1139.8,
      "Text": " that leverages AMSI right? Could be a neat thing to uh explore. But for my red team focus"
    },
    {
      "Time_Start": 1139.8,
      "Time_End": 1144.8,
      "Text": " friends there's also hope for you as well. If we go ahead and take a look at a example uh"
    },
    {
      "Time_Start": 1150.44,
      "Time_End": 1155.48,
      "Text": " offensive development life cycle up here right? Maybe you leave Defcon you're on Twitter or"
    },
    {
      "Time_Start": 1155.48,
      "Time_End": 1160.54,
      "Text": " X or Mastodon pick your social media site and you get a new idea for some blog or some talk"
    },
    {
      "Time_Start": 1160.54,
      "Time_End": 1164.08,
      "Text": " post and you're like hey this is a pretty cool thing I want to integrate into my offensive"
    },
    {
      "Time_Start": 1164.08,
      "Time_End": 1168.46,
      "Text": " workflow and I want to start messing around with it right? So then you start developing that"
    },
    {
      "Time_Start": 1168.48,
      "Time_End": 1173.42,
      "Text": " POC integrating it with whatever offensive framework you get. Then you test in your range, you"
    },
    {
      "Time_Start": 1173.42,
      "Time_End": 1178.3600000000001,
      "Text": " test in your VM so on and so forth. Double check all the things then you finally get to the stage"
    },
    {
      "Time_Start": 1178.3600000000001,
      "Time_End": 1182.9,
      "Text": " where you're ready to go and use that in an engagement. All of this is a fairly long cycle"
    },
    {
      "Time_Start": 1182.9,
      "Time_End": 1187.54,
      "Text": " right? You don't want to get caught as a red teamer. Well I'm here to talk to you about"
    },
    {
      "Time_Start": 1187.54,
      "Time_End": 1192.54,
      "Text": " shortening that churn zone by having faster feedback loops right? Don't SCP or uh file share"
    },
    {
      "Time_Start": 1192.6,
      "Time_End": 1198.96,
      "Text": " your your malware sample copies over you can kind of execute everything on one host. So that's"
    },
    {
      "Time_Start": 1198.96,
      "Time_End": 1203.94,
      "Text": " pretty powerful when you start thinking about shellcode runners um or or uh looking at making"
    },
    {
      "Time_Start": 1203.94,
      "Time_End": 1208.08,
      "Text": " sure that your tunnels are uh uh working the way that you expect them to. Simply running"
    },
    {
      "Time_Start": 1208.08,
      "Time_End": 1212.04,
      "Text": " line and then whatever you're building making sure that those tunnels exist and uh you're"
    },
    {
      "Time_Start": 1212.04,
      "Time_End": 1218.72,
      "Text": " getting those callbacks is a is a quick way to uh avoid issues down the road. Additionally it"
    },
    {
      "Time_Start": 1218.74,
      "Time_End": 1224.14,
      "Text": " allows for much easier adoption for CICD for shellcode runners. If I can go ahead and not"
    },
    {
      "Time_Start": 1224.14,
      "Time_End": 1228.48,
      "Text": " have to spin up and maintain and patch and host a Windows service or a Windows machine excuse"
    },
    {
      "Time_Start": 1228.48,
      "Time_End": 1234.18,
      "Text": " me. I can go ahead and just leverage a docker container run wine with my shellcode runner"
    },
    {
      "Time_Start": 1234.18,
      "Time_End": 1239.1200000000001,
      "Text": " verify that the output said hey you got a shell or you got execution and go on for there. And"
    },
    {
      "Time_Start": 1239.1200000000001,
      "Time_End": 1242.56,
      "Text": " this is how you can start adopting software engineering practices into your offensive"
    },
    {
      "Time_Start": 1242.56,
      "Time_End": 1246.72,
      "Text": " workflow. That's super powerful when you start considering maybe you want to play around"
    },
    {
      "Time_Start": 1246.76,
      "Time_End": 1250.1000000000001,
      "Text": " with different frameworks or seeing how other frameworks are going to integrate. There's"
    },
    {
      "Time_Start": 1250.1000000000001,
      "Time_End": 1253.84,
      "Text": " always a new thing written in Rust or whatever the framework of the day is. Last year at"
    },
    {
      "Time_Start": 1253.84,
      "Time_End": 1258.58,
      "Text": " Defcon NIM was the hotness. This allows for a little bit easier integration and repeatability."
    },
    {
      "Time_Start": 1258.58,
      "Time_End": 1263.58,
      "Text": " And then looking for my friends that are leveraging uh more in memory execution talking"
    },
    {
      "Time_Start": 1265.88,
      "Time_End": 1270.48,
      "Text": " about beacon object files. If you're unfamiliar with beacon object files they're made popular"
    },
    {
      "Time_Start": 1270.48,
      "Time_End": 1275.6200000000001,
      "Text": " by Cobalt Strike. Effectively what they are is a way to execute what a a payload in memory"
    },
    {
      "Time_Start": 1275.6200000000001,
      "Time_End": 1282.0000000000002,
      "Text": " without writing to disk. However they're tricky to write. They have a limited C uh API. And"
    },
    {
      "Time_Start": 1282.0000000000002,
      "Time_End": 1285.74,
      "Text": " uh if if something goes wrong and they crash well you lose your beacon cause it's executing"
    },
    {
      "Time_Start": 1285.74,
      "Time_End": 1292.1000000000001,
      "Text": " in the process of beacon. That being said Metasploit has its own beacon object file loader"
    },
    {
      "Time_Start": 1292.1000000000001,
      "Time_End": 1296.92,
      "Text": " and because we can execute Metasploit generated payloads with wine we can suddenly create a"
    },
    {
      "Time_Start": 1296.92,
      "Time_End": 1302.42,
      "Text": " feedback loop of writing a potentially complicated or maybe it's new to you boff file"
    },
    {
      "Time_Start": 1302.42,
      "Time_End": 1307.3200000000002,
      "Text": " executing that in the uh meterpreter session via wine and ensuring that you're getting the"
    },
    {
      "Time_Start": 1307.3200000000002,
      "Time_End": 1313.1000000000001,
      "Text": " output that you expect. So here with my meterpreter session I'm leveraging trusted sex uh"
    },
    {
      "Time_Start": 1313.1000000000001,
      "Time_End": 1318.54,
      "Text": " cough uh loader and their situational awareness boffs to go and get the ARP information of the"
    },
    {
      "Time_Start": 1318.54,
      "Time_End": 1324.68,
      "Text": " host that I'm executing on. Pretty neat. Furthermore you can grab all of this output"
    },
    {
      "Time_Start": 1324.68,
      "Time_End": 1328.8400000000001,
      "Text": " through Metasploit because of its easy scriptability features making sure that you can or"
    },
    {
      "Time_Start": 1328.84,
      "Time_End": 1334.8999999999999,
      "Text": " excuse me allowing you to integrate it into your CI CD workflows. But again the world isn't"
    },
    {
      "Time_Start": 1334.8999999999999,
      "Time_End": 1339.58,
      "Text": " perfect it does fall short right? I'm not suggesting you go and blow away all your Windows VMs"
    },
    {
      "Time_Start": 1339.58,
      "Time_End": 1344.6799999999998,
      "Text": " and just go hey wine's great let's do that from here on out. But this does shorten that uh"
    },
    {
      "Time_Start": 1344.6799999999998,
      "Time_End": 1349.6799999999998,
      "Text": " initial proof of concept phase to get to the point to go and text closest to tar- or to test as"
    },
    {
      "Time_Start": 1349.6799999999998,
      "Time_End": 1355.1999999999998,
      "Text": " close to the target host as possible. Some of the issues that I've personally uh found is"
    },
    {
      "Time_Start": 1355.22,
      "Time_End": 1360.16,
      "Text": " anything in kernel land so doing like direct sys calls that's not a great time. And again we"
    },
    {
      "Time_Start": 1360.16,
      "Time_End": 1364.8600000000001,
      "Text": " have uh some issues with everything not being one to one with our API call implementations. For"
    },
    {
      "Time_Start": 1364.8600000000001,
      "Time_End": 1368.7,
      "Text": " example with those AMSI returns we're always returning hey this isn't malware this isn't a"
    },
    {
      "Time_Start": 1368.7,
      "Time_End": 1375.98,
      "Text": " problem. So taking some time to look at uh the code base is super important. And wine by itself"
    },
    {
      "Time_Start": 1375.98,
      "Time_End": 1381.18,
      "Text": " does not provide any sandboxing uh capabilities. So you still need a dedicated machine to"
    },
    {
      "Time_Start": 1381.2,
      "Time_End": 1385.74,
      "Text": " execute malware on and then isolate it appropriately making sure that uh you know you're"
    },
    {
      "Time_Start": 1385.74,
      "Time_End": 1390.5800000000002,
      "Text": " you're not about to run something on your host machine or machine you carry about. Additionally"
    },
    {
      "Time_Start": 1390.5800000000002,
      "Time_End": 1394.64,
      "Text": " for the folks that are interested in this from a how do I detect or evade this there's a lot of"
    },
    {
      "Time_Start": 1394.64,
      "Time_End": 1399.88,
      "Text": " very key artifacts that would show that you're running in a wine environment. Such as the name"
    },
    {
      "Time_Start": 1399.88,
      "Time_End": 1406.66,
      "Text": " being such as some of the process names being wine. Um additionally uh wine for this is"
    },
    {
      "Time_Start": 1406.68,
      "Time_End": 1412.14,
      "Text": " executing x86 and 64 bit PE files. So if you have some kind of like old DOS binary or"
    },
    {
      "Time_Start": 1412.14,
      "Time_End": 1415.98,
      "Text": " something like that uh that's where you're gonna start looking at DOS box and your results may"
    },
    {
      "Time_Start": 1415.98,
      "Time_End": 1421.26,
      "Text": " vary there. And again it is an evolving project there are bugs so there are unknown unknowns"
    },
    {
      "Time_Start": 1421.26,
      "Time_End": 1425.8600000000001,
      "Text": " that you may run into. But for the vast majority of malware that is getting reported on by"
    },
    {
      "Time_Start": 1425.8600000000001,
      "Time_End": 1431.1000000000001,
      "Text": " these threat intel companies as the most commonly seen you can easily instrument an execution"
    },
    {
      "Time_Start": 1431.1000000000001,
      "Time_End": 1435.3000000000002,
      "Text": " environment for the situations where maybe you don't want to upload that sample to virus"
    },
    {
      "Time_Start": 1435.3,
      "Time_End": 1440.84,
      "Text": " total. Or maybe you don't have a cuckoo or the equivalent uh uh execution environment"
    },
    {
      "Time_Start": 1440.84,
      "Time_End": 1447.4199999999998,
      "Text": " locally. So with all that being said I will have a handful of key takeaways that I want you"
    },
    {
      "Time_Start": 1447.4199999999998,
      "Time_End": 1451.1599999999999,
      "Text": " to to go away from this talk right? Cause Packet Hacking Village is very much structured"
    },
    {
      "Time_Start": 1451.1599999999999,
      "Time_End": 1457.4199999999998,
      "Text": " around actionable uh uh talks and being able to to take something from them. Wine can"
    },
    {
      "Time_Start": 1457.4199999999998,
      "Time_End": 1463.0,
      "Text": " execute trending malware in 2023. Absolutely a fact. You can go grab some uh Cobalt Strike"
    },
    {
      "Time_Start": 1463.0,
      "Time_End": 1468.46,
      "Text": " off the shelf uh uh mess plate or grab some Cobalt off the shelf uh artifact from"
    },
    {
      "Time_Start": 1468.46,
      "Time_End": 1473.54,
      "Text": " MalShared execute it to get those DNS and host artifacts. You can also build custom DLLs"
    },
    {
      "Time_Start": 1473.54,
      "Time_End": 1478.34,
      "Text": " to instrument your execution. Grab additional artifacts or maybe some uh neat uh"
    },
    {
      "Time_Start": 1478.34,
      "Time_End": 1482.52,
      "Text": " instrumentation that you're looking to do. And then Wine can also shorten the red team"
    },
    {
      "Time_Start": 1482.52,
      "Time_End": 1486.86,
      "Text": " testing for our friends that are looking to do proof of concept stuff related to uh new"
    },
    {
      "Time_Start": 1486.86,
      "Time_End": 1491.5,
      "Text": " ideas. I really want to give a shout out to everybody coming here to watch this. This"
    },
    {
      "Time_Start": 1491.5,
      "Time_End": 1495.3,
      "Text": " means the world to me so thank you very much. And then if any of this was interesting or"
    },
    {
      "Time_Start": 1495.3,
      "Time_End": 1499.4,
      "Text": " you're looking at recreating this on your own, go ahead and take a screenshot of this. The"
    },
    {
      "Time_Start": 1499.4,
      "Time_End": 1504.24,
      "Text": " slides and then some walk through examples of leveraging Podman and Docker for creating"
    },
    {
      "Time_Start": 1504.24,
      "Time_End": 1509.08,
      "Text": " these environments and doing the execution. They're all on GitHub as of about an hour ago."
    },
    {
      "Time_Start": 1509.08,
      "Time_End": 1513.82,
      "Text": " So definitely check these out. Create Git issues if you run into them. Uh and I'll be around"
    },
    {
      "Time_Start": 1513.82,
      "Time_End": 1517.48,
      "Text": " after this talk to chat more. Thank you all so much. I really appreciate it."
    },
    {
      "Time_Start": 1517.74,
      "Time_End": 1518.74,
      "Text": " Thank you."
    },
    {
      "Time_Start": 1524.74,
      "Time_End": 1529.18,
      "Text": " Thank you Jared. Uh I can tell you right now I can tell you're a good teacher. I can just"
    },
    {
      "Time_Start": 1529.18,
      "Time_End": 1534.22,
      "Text": " tell I was watching this whole thing. Now uh if anyone actually have any questions for Jared"
    },
    {
      "Time_Start": 1534.22,
      "Time_End": 1540.3,
      "Text": " uh you can feel free to uh use the microphone uh yeah. If anyone will have a question for"
    },
    {
      "Time_Start": 1540.3,
      "Time_End": 1543.8,
      "Text": " Jared you can feel free to use the mic feel free yeah it should be open."
    },
    {
      "Time_Start": 1547.8,
      "Time_End": 1548.8,
      "Text": " Hey thanks for the"
    },
    {
      "Time_Start": 1550.54,
      "Time_End": 1554.84,
      "Text": " thanks for the talk. Um just wondering in your experience have you as you mentioned it's"
    },
    {
      "Time_Start": 1554.84,
      "Time_End": 1560.08,
      "Text": " not a new thing to run it under wine. Have you have you seen malware that's either looking"
    },
    {
      "Time_Start": 1560.08,
      "Time_End": 1565.38,
      "Text": " for wine to um do something benign instead of its true payload? Or have you seen uh things"
    },
    {
      "Time_Start": 1565.38,
      "Time_End": 1568.1200000000001,
      "Text": " that are actually looking to actively burn it down?"
    },
    {
      "Time_Start": 1571.76,
      "Time_End": 1575.44,
      "Text": " Hello. Okay. Great question. So the question was have I seen any malware samples that are"
    },
    {
      "Time_Start": 1575.46,
      "Time_End": 1580.8400000000001,
      "Text": " looking for any wine uh artifacts that uh then do something different. I have not. Um I"
    },
    {
      "Time_Start": 1580.8400000000001,
      "Time_End": 1586.7,
      "Text": " think largely uh you know a lot of socks have the ability to throw data to a virus total or"
    },
    {
      "Time_Start": 1586.7,
      "Time_End": 1590.28,
      "Text": " equivalent. But for the situations such as home lab enthusiasts or people just getting"
    },
    {
      "Time_Start": 1590.28,
      "Time_End": 1594.04,
      "Text": " started wine provides a pretty neat opportunity to execute those payloads."
    },
    {
      "Time_Start": 1597.18,
      "Time_End": 1602.42,
      "Text": " Um I'm quite lazy and don't like running my own uh uh instrumentation or compiling my own"
    },
    {
      "Time_Start": 1602.44,
      "Time_End": 1608.04,
      "Text": " stuff. Would you recommend any like L-trace or S-trace equivalents built into wine doing the"
    },
    {
      "Time_Start": 1608.04,
      "Time_End": 1609.74,
      "Text": " dynamic instrumentation you recommend?"
    },
    {
      "Time_Start": 1612.24,
      "Time_End": 1616.22,
      "Text": " Alright I think I heard you. I think you said that uh you're looking for uh any kind of L-trace"
    },
    {
      "Time_Start": 1616.22,
      "Time_End": 1621.0600000000002,
      "Text": " or S-trace equivalents built into wine. Cool. So wine does have a debugger that you can use to"
    },
    {
      "Time_Start": 1621.0600000000002,
      "Time_End": 1625.46,
      "Text": " go just like GDB or or WinDebug that you can go forth and start poking at memory addresses to"
    },
    {
      "Time_Start": 1625.46,
      "Time_End": 1630.8000000000002,
      "Text": " dump it. Um your results may vary on the success that you have there. But uh also in the in the"
    },
    {
      "Time_Start": 1630.82,
      "Time_End": 1635.08,
      "Text": " same vein of things um because all of those uh syscalls are getting translated to the POSIX"
    },
    {
      "Time_Start": 1635.08,
      "Time_End": 1639.72,
      "Text": " equivalent trusted syscalls you could check out S-trace. Furthermore two years ago I actually"
    },
    {
      "Time_Start": 1639.72,
      "Time_End": 1644.4199999999998,
      "Text": " gave a talk on leveraging S-trace for Linux binary analysis at Packing Hacking Village that you"
    },
    {
      "Time_Start": 1644.4199999999998,
      "Time_End": 1647.76,
      "Text": " will also find on that GitHub. So definitely check that out."
    },
    {
      "Time_Start": 1651.2,
      "Time_End": 1658.2,
      "Text": " Hi. Similar vein of question. How easy is it to like compile the shared libraries or oh."
    },
    {
      "Time_Start": 1659.0800000000002,
      "Time_End": 1664.0800000000002,
      "Text": " Hello? Hello? Okay. Um how easy is it to compile the like shared libraries for wine to like do"
    },
    {
      "Time_Start": 1667.8400000000001,
      "Time_End": 1672.92,
      "Text": " any kind of analysis on the things you. I'm sorry I cannot hear you. Oh I think I'm backing away."
    },
    {
      "Time_Start": 1672.92,
      "Time_End": 1677.92,
      "Text": " Okay. For for yeah for the shared libraries. Yeah. Is it like you compile it and it's like a Linux"
    },
    {
      "Time_Start": 1680.8,
      "Time_End": 1686.0,
      "Text": " shared library that wine then loads or. Yeah great question. So yes it absolutely is a Linux"
    },
    {
      "Time_Start": 1686.04,
      "Time_End": 1690.44,
      "Text": " shared library. Um and then you can get it to execute or return data or whatever you want to do."
    },
    {
      "Time_Start": 1690.44,
      "Time_End": 1695.44,
      "Text": " Yes. Hi. Thanks for the talk. So you tried it out on Metasploit and Empire. These are both pretty"
    },
    {
      "Time_Start": 1700.72,
      "Time_End": 1705.72,
      "Text": " uh well supported uh malware uh well malware or red red team tooling uh project. Have you"
    },
    {
      "Time_Start": 1709.86,
      "Time_End": 1715.96,
      "Text": " tried this out on just random samples on VX underground for example that are often uh"
    },
    {
      "Time_Start": 1715.96,
      "Time_End": 1720.96,
      "Text": " less or those samples are uh support less uh Windows versions for example. Oh. Alright"
    },
    {
      "Time_Start": 1723.66,
      "Time_End": 1727.66,
      "Text": " yes those are great questions. The question was tried it out on Metasploit, Empire, Cobalt"
    },
    {
      "Time_Start": 1727.66,
      "Time_End": 1731.64,
      "Text": " Strike. Have you tried it with other samples uh that you just kind of grab off of uh VX"
    },
    {
      "Time_Start": 1731.64,
      "Time_End": 1736.3400000000001,
      "Text": " underground? So going back to kind of the home lab story here. I pull in daily dumps from"
    },
    {
      "Time_Start": 1736.3400000000001,
      "Time_End": 1741.14,
      "Text": " MalShare. Those MalShare samples end up largely being Cobalt Strike or Meterpreter uh uh"
    },
    {
      "Time_Start": 1741.16,
      "Time_End": 1747.6000000000001,
      "Text": " samples. So my big target base is that. I haven't tested it on all or or or a bunch of VX"
    },
    {
      "Time_Start": 1747.6000000000001,
      "Time_End": 1753.18,
      "Text": " underground samples but I have thrown in some random things that uh uh are are kind of"
    },
    {
      "Time_Start": 1753.18,
      "Time_End": 1759.22,
      "Text": " custom built and I've had success. But your results may vary. Alright thank you. Sounds"
    },
    {
      "Time_Start": 1759.22,
      "Time_End": 1764.22,
      "Text": " cool. I'm going to try it out. Alright so you've made a bunch of changes to the wine source"
    },
    {
      "Time_Start": 1764.98,
      "Time_End": 1769.98,
      "Text": " code um to do various things. Have you sent anything back upstream? And if so how did that"
    },
    {
      "Time_Start": 1773.82,
      "Time_End": 1779.72,
      "Text": " go? Yes so that's a great question. So uh the question was you've made changes to the wine"
    },
    {
      "Time_Start": 1779.72,
      "Time_End": 1783.26,
      "Text": " source code. Have you submitted anything back upstream? So most of the changes that I've made"
    },
    {
      "Time_Start": 1783.26,
      "Time_End": 1787.44,
      "Text": " have been to capture specific parameters that are getting passed in to say like a reg query"
    },
    {
      "Time_Start": 1787.44,
      "Time_End": 1792.04,
      "Text": " to to then log off to the side. So these changes don't improve the overall functionality or"
    },
    {
      "Time_Start": 1792.06,
      "Time_End": 1797.56,
      "Text": " support of Wine. WineHQ.com has an excellent breakdown on how to submit upstream patches."
    },
    {
      "Time_Start": 1797.56,
      "Time_End": 1801.1399999999999,
      "Text": " How to double check their bug tracker. So on and so forth of of everything related to"
    },
    {
      "Time_Start": 1801.1399999999999,
      "Time_End": 1805.34,
      "Text": " development. And I would highly encourage you to check that out. Um but for the small"
    },
    {
      "Time_Start": 1805.34,
      "Time_End": 1808.34,
      "Text": " samples and or excuse me for the small changes that I've made it has been nothing"
    },
    {
      "Time_Start": 1808.34,
      "Time_End": 1813.34,
      "Text": " substantial to go forth and and contribute upstream. Alright so I'm going to go ahead and"
    },
    {
      "Time_Start": 1822.12,
      "Time_End": 1827.12,
      "Text": " close the Q&A. Anyone else? Um. If I may then uh sure if there's time. So how easy is it to"
    },
    {
      "Time_Start": 1834.5,
      "Time_End": 1840.2,
      "Text": " uh make changes to uh wine in such a way that it behaves like a sandbox? Because many"
    },
    {
      "Time_Start": 1840.2,
      "Time_End": 1845.94,
      "Text": " sandboxes do not only have the functionality of being a Windows box but also making memory"
    },
    {
      "Time_Start": 1845.94,
      "Time_End": 1850.94,
      "Text": " dumps. Taking uh the dumps of the network traffic. Stuff like that. So how easy is it to"
    },
    {
      "Time_Start": 1852.04,
      "Time_End": 1857.06,
      "Text": " make changes to the underlying Wine source code? Did I hear you correctly? Yeah so either"
    },
    {
      "Time_Start": 1863.7,
      "Time_End": 1868.7,
      "Text": " the source codes or just uh setting up. Sure. Just all of the things. Sure sure sure. So cool."
    },
    {
      "Time_Start": 1870.8,
      "Time_End": 1875.24,
      "Text": " So like let's run through that really quick. So one of the things in the uh the like lab repo"
    },
    {
      "Time_Start": 1875.24,
      "Time_End": 1879.3999999999999,
      "Text": " thing that I have up here is I'm leveraging Podman over Docker. And the reason for that is"
    },
    {
      "Time_Start": 1879.4,
      "Time_End": 1885.0400000000002,
      "Text": " you can actually pause containers when you're executing uh uh uh containers with Podman. So"
    },
    {
      "Time_Start": 1885.0400000000002,
      "Time_End": 1889.2800000000002,
      "Text": " with that if we're running a malware sample in Wine in a container with Podman and I pause"
    },
    {
      "Time_Start": 1889.2800000000002,
      "Time_End": 1892.68,
      "Text": " that execution we can go ahead and dump that memory and start taking a look at those"
    },
    {
      "Time_Start": 1892.68,
      "Time_End": 1897.0800000000002,
      "Text": " artifacts that may get decrypted uh decompressed so on and so forth right? Same example for a"
    },
    {
      "Time_Start": 1897.0800000000002,
      "Time_End": 1902.7,
      "Text": " packed or encrypted sample or region of memory. Uh for the situation of how easy is it to"
    },
    {
      "Time_Start": 1902.7,
      "Time_End": 1907.0600000000002,
      "Text": " capture Wireshark data uh it's as easy as uh literally spinning up Wireshark and"
    },
    {
      "Time_Start": 1907.06,
      "Time_End": 1910.52,
      "Text": " selecting the interface and capturing it from there. Um but again and I just want to double"
    },
    {
      "Time_Start": 1910.52,
      "Time_End": 1914.6599999999999,
      "Text": " stomp this uh you know Wine doesn't provide any kind of sandboxing features so you still"
    },
    {
      "Time_Start": 1914.6599999999999,
      "Time_End": 1919.3,
      "Text": " need that host to making uh that that host hardening and and uh uh sanitization process to"
    },
    {
      "Time_Start": 1919.3,
      "Time_End": 1922.6,
      "Text": " make sure that you're not about to run malware on a on a host you care about."
    },
    {
      "Time_Start": 1922.6,
      "Time_End": 1927.6,
      "Text": " Good job everyone. Have a drink."
    }
  ]
}